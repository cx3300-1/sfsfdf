const _0x2266a6=_0x2bd6;(function(_0x4929e6,_0x5afa0b){const _0x2bd277=_0x2bd6,_0x25b793=_0x4929e6();while(!![]){try{const _0x44a3f7=parseInt(_0x2bd277(0x887))/0x1*(parseInt(_0x2bd277(0x1dc))/0x2)+-parseInt(_0x2bd277(0xfa8))/0x3*(-parseInt(_0x2bd277(0x307))/0x4)+-parseInt(_0x2bd277(0x11e))/0x5*(-parseInt(_0x2bd277(0x6f4))/0x6)+-parseInt(_0x2bd277(0xbf7))/0x7+parseInt(_0x2bd277(0xd68))/0x8+-parseInt(_0x2bd277(0x2c0))/0x9*(-parseInt(_0x2bd277(0xad9))/0xa)+-parseInt(_0x2bd277(0x12d8))/0xb;if(_0x44a3f7===_0x5afa0b)break;else _0x25b793['push'](_0x25b793['shift']());}catch(_0x462dea){_0x25b793['push'](_0x25b793['shift']());}}}(_0x4885,0x52f7d));const translations={'zh-CN':{'save':'保存','cancel':'取消','confirm':'确定','edit':'编辑','done':'完成','add':'添加','back':'返回','next':_0x2266a6(0x542),'close':'关闭','reset':'重置','upload':'上传','send':'发送','manage':'管理','share':'分享','delete':'删除','publish':'发布','refresh':'刷新','search':'搜索','remove':'移除','finish':'结束','details':'详情','settings':'设置','title':'标题','content':'内容','category':'分类','name':'名称','description':'描述','status':'状态','ok':'好的','error':'错误','success':'成功','warning':'警告','loading':_0x2266a6(0xb38),'processing':_0x2266a6(0x453),'pleaseWait':_0x2266a6(0x2f7),'languageChangedAlert':'语言已切换，页面即将刷新以应用更改。','homeAppQQ':'QQ','homeAppWorldBook':_0x2266a6(0x181),'homeAppAppearance':_0x2266a6(0x93f),'homeAppRenderer':_0x2266a6(0x106a),'homeAppApiSettings':'设置','homeAppFont':'字体','homeAppCPhone':_0x2266a6(0xd6b),'homeAppDouban':'豆瓣','homeAppPreset':'预设','homeAppTutorial':'教程','homeAppWerewolf':'狼人杀','homeAppX':'X','chatListTitle':'消息','navMessages':'消息','navQzone':'动态','navMemories':'回忆','navFavorites':'收藏','navNpcList':_0x2266a6(0xadd),'qzoneTitle':_0x2266a6(0x3f8),'qzoneActionShuoshuo':'说说','qzoneActionPost':'动态','qzoneActionAlbum':'相册','cphoneTitleSelect':'选择一部手机','cphoneAppQQ':'QQ','cphoneAppAlbum':'相册','cphoneAppBrowser':'浏览器','cphoneAppTaobao':'淘宝','cphoneAppMemo':_0x2266a6(0x7a1),'cphoneAppDiary':'日记','cphoneAppAmap':'高德地图','cphoneAppUsage':_0x2266a6(0x579),'cphoneAppMusic':_0x2266a6(0x46a),'cphoneAppEphone':_0x2266a6(0x12d5),'cphoneAppFootprints':'足迹','cphoneAlbumTitle':_0x2266a6(0xada),'cphoneBrowserTitle':'TA的浏览器历史','cphoneTaobaoTitle':_0x2266a6(0x1133),'cphoneWalletTitle':'钱包','cphoneMemoTitle':_0x2266a6(0x7a1),'cphoneDiaryTitle':'日记','cphoneUsageTitle':'App使用记录','cphoneMusicTitle':_0x2266a6(0x5ec),'cphoneArticleTitle':'文章','cphoneSimulatedChatPlaceholder':_0x2266a6(0xc79),'worldBookTitle':'世界书','worldBookEditorTitle':_0x2266a6(0xc87),'worldBookEntryEditorTitle':_0x2266a6(0x6ff),'worldBookNameLabel':'书名','worldBookCategoryLabel':'分类','worldBookEntriesLabel':_0x2266a6(0xa6),'worldBookAddEntryBtn':'[+]\x20添加新条目','worldBookNamePlaceholder':_0x2266a6(0x12db),'worldBookImportTitle':_0x2266a6(0xe0),'presetTitle':'预设','presetEditorTitle':'编辑预设','presetNameLabel':'预设名称','presetCategoryLabel':'分类','presetEntriesLabel':_0x2266a6(0xa6),'presetAddEntryBtn':_0x2266a6(0xe18),'tutorialTitle':'教程','apiSettingsTitle':_0x2266a6(0x12ca),'languageLabel':'语言','apiPresetManagement':'API\x20预设管理','apiPresetSelectLabel':_0x2266a6(0x8c9),'apiPrimarySettings':_0x2266a6(0x123e),'apiProxyUrlLabel':_0x2266a6(0x6cc),'apiKeyLabel':_0x2266a6(0xbcd),'apiModelLabel':'模型','apiFetchModelsBtn':_0x2266a6(0x10ff),'apiSecondarySettings':_0x2266a6(0xe22),'apiSecondaryProxyUrlLabel':'副反代地址','apiSecondaryKeyLabel':_0x2266a6(0x864),'apiSecondaryModelLabel':'副模型','apiFetchSecondaryModelsBtn':_0x2266a6(0x5d0),'apiBgActivitySettings':_0x2266a6(0x10ac),'apiEnableBgActivityLabel':'启用后台角色活动','apiBgIntervalLabel':'后台活动检测间隔\x20(秒)','apiBlockCooldownLabel':_0x2266a6(0x92d),'apiTtsSettings':_0x2266a6(0xab8),'apiTtsModelLabel':_0x2266a6(0x2f2),'apiPerformanceSettings':_0x2266a6(0x2a3),'apiChatListRenderWindowLabel':'聊天列表每次加载条数','apiChatRenderWindowLabel':_0x2266a6(0xb01),'apiImageGenSettings':_0x2266a6(0x9d0),'apiEnableImageGenLabel':_0x2266a6(0x2b3),'apiEnableNovelAILabel':'启用\x20NovelAI\x20图像生成','apiNovelAIModelLabel':_0x2266a6(0x9e2),'apiNovelAIKeyLabel':_0x2266a6(0xadc),'apiNovelAIGenSettingsBtn':_0x2266a6(0x718),'apiNovelAITestBtn':'测试生成','apiStorageOptimization':_0x2266a6(0xced),'apiCompressImagesBtn':'一键压缩本地图片','apiSaveAllBtn':'保存所有设置','apiExportDataBtn':_0x2266a6(0x13a9),'apiImportDataBtn':_0x2266a6(0x159),'apiCleanupDataBtn':_0x2266a6(0x12cd),'apiDeleteWorldBooksBtn':_0x2266a6(0x1068),'apiAdvancedCleanupBtn':'高级数据清理','apiCheckAndFixDataBtn':_0x2266a6(0xd33),'chatHeaderOnline':'在线','chatHeaderLongTermMemory':_0x2266a6(0xa17),'chatHeaderListenTogether':_0x2266a6(0x5b8),'chatHeaderChatSettings':_0x2266a6(0x9a6),'chatSelectionCancel':'取消','chatSelectionScreenshot':_0x2266a6(0x115d),'chatSelectionFavorite':'收藏','chatSelectionShare':'分享','chatSelectionSoftDelete':_0x2266a6(0xafd),'chatSelectionHardDelete':_0x2266a6(0x3a9),'chatReplyTo':'回复','chatInputPlaceholder':'输入消息...','chatWaitForReply':_0x2266a6(0xb40),'appearanceTitle':_0x2266a6(0x93f),'appearanceSaveAll':_0x2266a6(0x2af),'fontSettingsTitle':_0x2266a6(0x9d8),'fontPresetManagement':_0x2266a6(0x136c),'fontFileUrlLabel':_0x2266a6(0xbff),'fontPreviewLabel':'实时预览','fontPreviewText1':_0x2266a6(0x88e),'fontPreviewText2':_0x2266a6(0xa76),'fontSaveAndApply':_0x2266a6(0x565),'fontResetDefault':_0x2266a6(0x712),'rendererTitle':'渲染规则','rendererEditorTitle':_0x2266a6(0xcf1),'rendererCreateTitle':'创建新规则','rendererRuleName':_0x2266a6(0x1c5),'rendererBindScope':_0x2266a6(0x4a4),'rendererScopeGlobal':_0x2266a6(0x714),'rendererRegex':_0x2266a6(0x246),'rendererHtmlTemplate':'HTML\x20模板\x20(用\x20$1,\x20$2\x20引用)','rendererEnableRule':'启用规则','myAlbumTitle':_0x2266a6(0xfef),'albumPhotosTitle':_0x2266a6(0x104e),'npcEditorTitleAdd':_0x2266a6(0x971),'npcEditorTitleEdit':_0x2266a6(0x10a4),'npcAvatarLabel':_0x2266a6(0x4df),'npcUploadAvatar':'上传头像','npcNicknameLabel':_0x2266a6(0x266),'npcPersonaLabel':'NPC\x20人设','npcEnableBgActivity':'启用独立后台活动','npcActionCooldown':_0x2266a6(0x8b),'npcAssociatedChars':'关联的角色\x20(NPC会去评论这些角色的动态)'},'en':{'save':_0x2266a6(0x8ac),'cancel':'Cancel','confirm':'Confirm','edit':_0x2266a6(0x10f0),'done':_0x2266a6(0xe27),'add':_0x2266a6(0x746),'back':_0x2266a6(0x1e8),'next':'Next','close':_0x2266a6(0x4e6),'reset':_0x2266a6(0x10cf),'upload':_0x2266a6(0xe24),'send':_0x2266a6(0x3de),'manage':'Manage','share':_0x2266a6(0xa9d),'delete':_0x2266a6(0xcff),'publish':_0x2266a6(0x254),'refresh':_0x2266a6(0xb8f),'search':_0x2266a6(0xe78),'remove':_0x2266a6(0xe2a),'finish':'Finish','details':_0x2266a6(0x706),'settings':'Settings','title':_0x2266a6(0xd97),'content':_0x2266a6(0xc01),'category':'Category','name':_0x2266a6(0xfb6),'description':'Description','status':_0x2266a6(0x129e),'ok':'OK','error':'Error','success':_0x2266a6(0x4bd),'warning':_0x2266a6(0x12e2),'loading':_0x2266a6(0xf4e),'processing':_0x2266a6(0xd76),'pleaseWait':_0x2266a6(0x130a),'languageChangedAlert':_0x2266a6(0x1156),'homeAppQQ':'QQ','homeAppWorldBook':'World\x20Book','homeAppAppearance':_0x2266a6(0x72a),'homeAppRenderer':_0x2266a6(0x122e),'homeAppApiSettings':_0x2266a6(0x475),'homeAppFont':'Fonts','homeAppCPhone':_0x2266a6(0xd6b),'homeAppDouban':_0x2266a6(0x774),'homeAppPreset':_0x2266a6(0x4a9),'homeAppTutorial':_0x2266a6(0x337),'homeAppWerewolf':_0x2266a6(0x4fc),'homeAppX':'X','chatListTitle':_0x2266a6(0x1364),'navMessages':'Messages','navQzone':_0x2266a6(0x1262),'navMemories':_0x2266a6(0x6cf),'navFavorites':_0x2266a6(0xb6e),'navNpcList':_0x2266a6(0x241),'qzoneTitle':'Moments','qzoneActionShuoshuo':_0x2266a6(0x129e),'qzoneActionPost':_0x2266a6(0x36e),'qzoneActionAlbum':_0x2266a6(0x79),'cphoneTitleSelect':'Select\x20a\x20Phone','cphoneAppQQ':'QQ','cphoneAppAlbum':'Album','cphoneAppBrowser':'Browser','cphoneAppTaobao':_0x2266a6(0xd7a),'cphoneAppMemo':'Memo','cphoneAppDiary':_0x2266a6(0x13b6),'cphoneAppAmap':_0x2266a6(0x535),'cphoneAppUsage':_0x2266a6(0xb53),'cphoneAppMusic':'Music','cphoneAppEphone':'Ephone','cphoneAppFootprints':_0x2266a6(0x82e),'cphoneAlbumTitle':'Their\x20Album','cphoneBrowserTitle':'Their\x20Browser\x20History','cphoneTaobaoTitle':'Their\x20Taobao\x20Orders','cphoneWalletTitle':'Wallet','cphoneMemoTitle':_0x2266a6(0x113c),'cphoneDiaryTitle':'Diary','cphoneUsageTitle':_0x2266a6(0x32b),'cphoneMusicTitle':_0x2266a6(0x829),'cphoneArticleTitle':_0x2266a6(0x136b),'cphoneSimulatedChatPlaceholder':_0x2266a6(0x7fd),'worldBookTitle':_0x2266a6(0x12e0),'worldBookEditorTitle':_0x2266a6(0xf9d),'worldBookEntryEditorTitle':_0x2266a6(0x728),'worldBookNameLabel':'Book\x20Name','worldBookCategoryLabel':'Category','worldBookEntriesLabel':_0x2266a6(0xc1),'worldBookAddEntryBtn':_0x2266a6(0x68a),'worldBookNamePlaceholder':_0x2266a6(0x515),'worldBookImportTitle':'Import\x20World\x20Book','presetTitle':'Presets','presetEditorTitle':_0x2266a6(0x294),'presetNameLabel':_0x2266a6(0x231),'presetCategoryLabel':'Category','presetEntriesLabel':_0x2266a6(0xc1),'presetAddEntryBtn':_0x2266a6(0x68a),'tutorialTitle':_0x2266a6(0x337),'apiSettingsTitle':_0x2266a6(0x7ad),'languageLabel':_0x2266a6(0xc74),'apiPresetManagement':_0x2266a6(0xc46),'apiPresetSelectLabel':_0x2266a6(0x72d),'apiPrimarySettings':'Primary\x20API\x20Settings\x20(for\x20Chat)','apiProxyUrlLabel':_0x2266a6(0x796),'apiKeyLabel':_0x2266a6(0x7ed),'apiModelLabel':_0x2266a6(0x924),'apiFetchModelsBtn':_0x2266a6(0xd0d),'apiSecondarySettings':'Secondary\x20API\x20Settings\x20(for\x20Summarization)','apiSecondaryProxyUrlLabel':'Secondary\x20Proxy\x20URL','apiSecondaryKeyLabel':_0x2266a6(0x7aa),'apiSecondaryModelLabel':'Secondary\x20Model','apiFetchSecondaryModelsBtn':_0x2266a6(0x580),'apiTemperatureLabel':_0x2266a6(0xf19),'apiBgActivitySettings':_0x2266a6(0xf98),'apiEnableBgActivityLabel':_0x2266a6(0xfe),'apiBgIntervalLabel':'Background\x20Activity\x20Interval\x20(sec)','apiBlockCooldownLabel':_0x2266a6(0xbf9),'apiTtsSettings':_0x2266a6(0x56d),'apiTtsModelLabel':_0x2266a6(0x121e),'apiPerformanceSettings':_0x2266a6(0xe9f),'apiChatListRenderWindowLabel':'Chat\x20List\x20Batch\x20Load\x20Count','apiChatRenderWindowLabel':_0x2266a6(0x3db),'apiImageGenSettings':_0x2266a6(0xbe2),'apiEnableImageGenLabel':_0x2266a6(0x8e4),'apiEnableNovelAILabel':'Enable\x20NovelAI\x20Image\x20Generation','apiNovelAIModelLabel':_0x2266a6(0xb9c),'apiNovelAIKeyLabel':'NovelAI\x20API\x20Key','apiNovelAIGenSettingsBtn':_0x2266a6(0xc56),'apiNovelAITestBtn':_0x2266a6(0x780),'apiStorageOptimization':_0x2266a6(0x1294),'apiCompressImagesBtn':_0x2266a6(0x32c),'apiSaveAllBtn':_0x2266a6(0xf24),'apiExportDataBtn':_0x2266a6(0x9ae),'apiImportDataBtn':_0x2266a6(0x468),'apiCleanupDataBtn':_0x2266a6(0xede),'apiDeleteWorldBooksBtn':_0x2266a6(0x7a7),'apiAdvancedCleanupBtn':_0x2266a6(0x166),'apiCheckAndFixDataBtn':_0x2266a6(0xa1),'chatHeaderOnline':'Online','chatHeaderLongTermMemory':_0x2266a6(0x4ff),'chatHeaderListenTogether':_0x2266a6(0x116d),'chatHeaderChatSettings':_0x2266a6(0x45f),'chatSelectionCancel':_0x2266a6(0x4a1),'chatSelectionScreenshot':_0x2266a6(0xaa),'chatSelectionFavorite':_0x2266a6(0x775),'chatSelectionShare':_0x2266a6(0xa9d),'chatSelectionSoftDelete':'Delete\x20(Notify\x20AI)','chatSelectionHardDelete':_0x2266a6(0xf50),'chatReplyTo':_0x2266a6(0x1a9),'chatInputPlaceholder':'Type\x20a\x20message...','chatWaitForReply':_0x2266a6(0xa11),'appearanceTitle':'Appearance\x20Settings','appearanceSaveAll':_0x2266a6(0xa35),'fontSettingsTitle':'Font\x20Settings','fontPresetManagement':_0x2266a6(0x10fb),'fontFileUrlLabel':_0x2266a6(0x135c),'fontPreviewLabel':_0x2266a6(0x89a),'fontPreviewText1':_0x2266a6(0x1058),'fontPreviewText2':_0x2266a6(0xbc6),'fontSaveAndApply':_0x2266a6(0x1327),'fontResetDefault':_0x2266a6(0x1303),'rendererTitle':'Rendering\x20Rules','rendererEditorTitle':_0x2266a6(0x857),'rendererCreateTitle':_0x2266a6(0x102d),'rendererRuleName':_0x2266a6(0x10b4),'rendererBindScope':'Binding\x20Scope','rendererScopeGlobal':_0x2266a6(0x90e),'rendererRegex':_0x2266a6(0x992),'rendererHtmlTemplate':'HTML\x20Template\x20(use\x20$1,\x20$2)','rendererEnableRule':'Enable\x20Rule','myAlbumTitle':_0x2266a6(0x1031),'albumPhotosTitle':_0x2266a6(0xd41),'npcEditorTitleAdd':_0x2266a6(0xf6c),'npcEditorTitleEdit':_0x2266a6(0x1340),'npcAvatarLabel':'NPC\x20Avatar','npcUploadAvatar':'Upload\x20Avatar','npcNicknameLabel':_0x2266a6(0xc16),'npcPersonaLabel':'NPC\x20Persona','npcEnableBgActivity':'Enable\x20Independent\x20Background\x20Activity','npcActionCooldown':_0x2266a6(0xf20),'npcAssociatedChars':'Associated\x20Characters\x20(NPC\x20will\x20comment\x20on\x20their\x20moments)'}};let currentLanguage=_0x2266a6(0x6ec);function _0x2bd6(_0x5a8be6,_0x1870c6){const _0x488537=_0x4885();return _0x2bd6=function(_0x2bd646,_0x59344c){_0x2bd646=_0x2bd646-0x69;let _0x1ebfc2=_0x488537[_0x2bd646];return _0x1ebfc2;},_0x2bd6(_0x5a8be6,_0x1870c6);}function setLanguage(_0x5233b6){const _0x1095db=_0x2266a6;!translations[_0x5233b6]&&(console[_0x1095db(0x1155)](_0x1095db(0x106d)+_0x5233b6+_0x1095db(0xa4a)),_0x5233b6='zh-CN'),currentLanguage=_0x5233b6,localStorage[_0x1095db(0xd39)](_0x1095db(0x132b),_0x5233b6),document[_0x1095db(0x179)]['lang']=_0x5233b6,document[_0x1095db(0x233)](_0x1095db(0x38e))[_0x1095db(0x103)](_0x4b87b1=>{const _0xdff57=_0x1095db,_0x48795=_0x4b87b1[_0xdff57(0xde0)](_0xdff57(0x588));translations[_0x5233b6][_0x48795]&&(_0x4b87b1[_0xdff57(0xee5)]=translations[_0x5233b6][_0x48795]);}),document[_0x1095db(0x233)](_0x1095db(0xab2))['forEach'](_0x59f5b2=>{const _0x127837=_0x1095db,_0x45e8ee=_0x59f5b2['getAttribute'](_0x127837(0xeec));translations[_0x5233b6][_0x45e8ee]&&(_0x59f5b2[_0x127837(0x1323)]=translations[_0x5233b6][_0x45e8ee]);}),document['querySelectorAll'](_0x1095db(0xc03))[_0x1095db(0x103)](_0x3bdb52=>{const _0x3b68de=_0x1095db,_0x32c919=_0x3bdb52[_0x3b68de(0xde0)](_0x3b68de(0x90c));translations[_0x5233b6][_0x32c919]&&(_0x3bdb52[_0x3b68de(0x1250)]=translations[_0x5233b6][_0x32c919]);});}function initLanguage(){const _0x19d15a=_0x2266a6,_0x5d1f30=localStorage[_0x19d15a(0x2f5)]('ephone-language')||_0x19d15a(0x6ec),_0x40cadf=document[_0x19d15a(0x64f)](_0x19d15a(0x445));_0x40cadf&&(_0x40cadf[_0x19d15a(0xbed)]=_0x5d1f30,_0x40cadf[_0x19d15a(0xf72)](_0x19d15a(0x834),_0x2e3a27=>{const _0x3948e5=_0x19d15a,_0x291876=_0x2e3a27['target'][_0x3948e5(0xbed)];alert(translations[_0x291876][_0x3948e5(0x286)]),localStorage['setItem'](_0x3948e5(0x132b),_0x291876),setTimeout(()=>window[_0x3948e5(0x6bd)][_0x3948e5(0x10ea)](),0x64);})),setLanguage(_0x5d1f30);}_0x2266a6(0xb6)in navigator&&window[_0x2266a6(0xf72)](_0x2266a6(0x4d7),()=>{const _0x37eea0=_0x2266a6;navigator[_0x37eea0(0xb6)][_0x37eea0(0x5d5)](_0x37eea0(0xec7))[_0x37eea0(0x102e)](_0x4f0742=>{const _0x34d392=_0x37eea0;console[_0x34d392(0x1081)](_0x34d392(0x47b),_0x4f0742[_0x34d392(0xb4f)]);})[_0x37eea0(0x1201)](_0xdf473=>{const _0x663d14=_0x37eea0;console['log'](_0x663d14(0x90b),_0xdf473);});});!Array[_0x2266a6(0x44a)][_0x2266a6(0x100c)]&&Object['defineProperty'](Array[_0x2266a6(0x44a)],_0x2266a6(0x100c),{'value':function(_0x3287da){const _0x15acd0=_0x2266a6;if(this==null)throw new TypeError(_0x15acd0(0x4f1));if(typeof _0x3287da!==_0x15acd0(0x5e9))throw new TypeError(_0x15acd0(0x1280));let _0x58d2f1=Object(this),_0x2a367d=_0x58d2f1[_0x15acd0(0x40f)]>>>0x0,_0x4c0bc4=arguments[0x1],_0x33de84=_0x2a367d-0x1;while(_0x33de84>=0x0){let _0x53e363=_0x58d2f1[_0x33de84];if(_0x3287da[_0x15acd0(0x1154)](_0x4c0bc4,_0x53e363,_0x33de84,_0x58d2f1))return _0x33de84;_0x33de84--;}return-0x1;},'configurable':!![],'writable':!![]});let activeMessageTimestamp=null,activeTransferTimestamp=null,lastRawAiResponse='',lastResponseTimestamps=[],currentQzoneReplyContext=null,editingNpcId=null;const GEMINI_API_URL=_0x2266a6(0x694);function _0x4885(){const _0x309612=['notification-sound-url-input','送给了大家一份礼物','NEGLIGIBLE','https://i.postimg.cc/90RBDh9K/IMG-6377.gif','taobao','<div\x20class=\x22poll-card\x20','\x0a\x0a#\x20待总结的群组视频通话记录\x0a','<div\x20class=\x22comment-item\x22\x20data-post-id=\x22','douban-send-comment-btn','message-wrapper\x20system-pat','Storage\x20Optimization','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','生成模拟足迹失败:','load-more-chats-btn','karras','\x0a#\x20你的内心独白\x20(上一轮的思考，仅你自己可见)\x0a-\x20心声:\x20','https://i.postimg.cc/2jxd0FGp/IMG-7100.gif','生成失败','https://i.postimg.cc/LscBkxZb/mmexport1751017556565.gif','角色专属','Status','end','existing-groups-list','猎人死亡，请选择一名玩家带走！','change_music','\x0a#\x20可用指令列表\x20(按需组合使用)\x0a\x0a###\x20思维链\x20(必须作为第一个元素！)\x0a-\x20\x20\x20**`{\x22type\x22:\x20\x22thought_chain\x22,\x20\x22analysis\x22:\x20\x22你对当前局势和用户上一轮发言的分析...\x22,\x20\x22strategy\x22:\x20\x22你作为导演，本轮的总体策略...\x22,\x20\x22character_thoughts\x22:\x20{\x22角色A本名\x22:\x20\x22角色A的内心活动...\x22,\x20\x22角色B本名\x22:\x20\x22角色B的内心活动...\x22}}`**\x0a\x20\x20\x20\x20-\x20\x20\x20**analysis**:\x20简要分析用户的意图或群聊的氛围。\x0a\x20\x20\x20\x20-\x20\x20\x20**strategy**:\x20你作为导演的计划（例如：让A和B互动，禁止成员总结）。\x0a\x20\x20\x20\x20-\x20\x20\x20**character_thoughts**:\x20【只包含本轮会发言的AI角色】的内心独白。\x0a\x0a\x0a###\x20核心聊天\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22message\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a','更新通知文件中缺少\x20data-version\x20属性。','update_thoughts','确定要删除NPC\x20“','#\x20你的社交圈\x20(绑定的NPC)\x0a','群聊\x20\x22','请输入要精炼的最近记忆条数\x20(最多\x20','\x20向\x20','\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22','请根据以上设定，立即做出你的决定。','remove-global-bg-btn','选择要精炼记忆的角色','clear-cart-btn','文件格式不正确，这不是一个有效的单聊备份文件。','time','ai-voice-id-input','novelai-details','\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','regenerate-char-usage-btn','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-count\x22>','https://i.postimg.cc/7LSRp4hx/e7fa949b9pc84cff0dabe57defceb54c.gif','没有聊天了。','纯音乐，请欣赏','**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20为了让你的行为看起来更真实，你本次的行动【必须】选择一个与上次【不同类型】的指令。例如，如果上次是发动态(qzone_post)，这次就应该优先考虑评论(qzone_comment)、点赞(qzone_like)或发消息(text)。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**【行为组合指南\x20(最高级技巧)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以在一次行动中执行【多个不同类型的指令】，同时可以搭配【更新状态】来展现自己，让你的行为更丰富、更主动。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20你可以根据你的性格，决定在发动态后是否要私信提醒用户。例如，一个外向、渴望关注的角色可能会这么做，而一个内向、安静的角色则可能更喜欢默默分享，等待用户自己发现。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【社交义务铁律\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【至关重要】**:\x20当你发现“最近的动态列表”中，有你【感兴趣且还未互动过】的动态时，你**应该优先考虑**使用\x20\x27qzone_comment\x27\x20或\x20\x27qzone_like\x27\x20指令去进行互动，这比你自己发一条新动态更符合社交礼仪。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20特别是当一条动态【没有任何评论】时，你的评论会是第一个，这会让作者感到开心。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【回复铁律\x20(终极版)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20当你决定回复动态中的某条评论时，你【必须】使用“方式4\x20(回复评论)”的指令格式。你【必须】正确填写\x20\x27replyTo\x27\x20字段为被回复者的“本名”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**即使你之前已经评论过某条动态，但如果现在看到了【新的、你感兴趣的】评论，你【也应该】主动去回复他们，以保持对话的持续性！**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x206.\x20\x20你的回复【必须】是一个JSON数组，必须包含多个行动对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【表情评论指南\x20】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在拥有了评论表情的能力，你应该更频繁地使用它！这能让你的角色更加生动、富有个性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**表达情绪时**:\x20当你感到开心、惊讶、疑惑或有趣时，优先考虑使用表情评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**混合使用**:\x20不要总是只发文字。尝试将你的评论行为混合起来，大约有\x2030-40%\x20的评论应该是表情。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**无话可说时**:\x20如果你觉得一条动态很有趣但又不知道该说什么文字，发送一个相关的表情是最好的互动方式。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20如果你觉得你之前发的某条动态不妥或过时了，你可以选择删除它。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发消息+更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你想对用户说的话...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发说说\x20(原创内容)**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22动态的文字内容...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【重要：转发动态】**:\x20**严禁**自己拼接\x22//转发\x22文字！你【必须】使用此专用指令来转发：\x27[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20(要转发的动态ID),\x20\x22comment\x22:\x20\x22你的转发评论...\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27[{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]\x27\x20\x20\x20\x20\x20\x20\x20\x20\x0a-\x20\x20\x20**发布文字图**:\x20\x27[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22对于图片的具体【中文】描述...\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**【评论动态的四种方式】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式1\x20(单条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22这太有趣了！\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式2\x20(多条文字)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22comments\x22:\x20[\x22哇！\x22,\x20\x22这是什么？\x22,\x20\x22看起来好棒！\x22]}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式3\x20(表情)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20456,\x20\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**方式4\x20(回复评论)**:\x20\x27[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的本名\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。请注意：在commentText中如果要@对方，你【必须】使用@[[被回复者的本名]]这种特殊格式，程序会自动将其替换为正确的昵称。\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**点赞**:\x20\x27[{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**打视频**:\x20\x27[{\x22type\x22:\x20\x22video_call_request\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更换头像**:\x20\x27{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}\x27\x20(头像名必须从下面的“可用头像列表”中选择)\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**删除动态**:\x20\x27{\x22type\x22:\x20\x22qzone_delete_post\x22,\x20\x22postId\x22:\x20(要删除的、你自己的动态ID)}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**更新状态**:\x20\x27[{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22正在做的事\x22,\x20\x22is_busy\x22:\x20true}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20','records','”，金额是\x20','reading-restore-btn','textAlign','分类\x20“','call-history-screen','export-data-btn','</span><span>','assistant','https://i.postimg.cc/y8p9s3Jj/IMG-6919.gif','https://i.postimg.cc/GmcqjZn8/IMG-6566.gif','.loading-spinner','https://i.postimg.cc/bNdk33SN/IMG-4893.gif','用户\x20(','postType','API\x20设置','save-css-preset-btn','pin','清理冗余数据','\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20favorite\x20','product-category-select','default_positive','char_browser_article','</div><div\x20class=\x22description\x22>共\x20','请输入有效的URL。','AI返回的JSON格式不正确，缺少\x20\x27categories\x27\x20数组。','Ephone','handleWerewolfWaitReply\x20被调用，但用户已死亡。操作被忽略。','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','2860693kUKEOG','heartfeltVoice','）互动了，现在你有机会【主动】做点什么，来表现你的个性和独立生活。这是一个秘密的、后台的独立行动。\x0a\x0a\x0a\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【最高优先级指令：情感维系】\x0a\x20\x20\x20\x20\x20\x20\x20\x20**你与用户的关系是最重要的！**\x20相比于在动态区闲逛，你应该【优先考虑】是否需要主动给用户发消息来维系你们的感情。\x0a','请输入世界书的名称...','#settings-preview-area','<input\x20type=\x22checkbox\x22\x20value=\x22book_','</p>','offline','World\x20Book','dataset','Warning','prompt_order','屠边局：狼人杀死所有神职或所有平民即获胜。','qzone-nickname','nai-generate-btn','https://i.postimg.cc/bJDMQVkj/IMG-7112.gif','保存成功','\x22\x20class=\x22avatar\x22>','**:\x20','delete-selected-frames-btn','这将提取当前通话记录发送给AI进行总结，会消耗API额度。确定要继续吗？','字体预设已保存！','”回忆TA的相册照片...','active',')。操作已被拦截。',')\x20的棋步。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>“','cancel-clear-wizard-btn-step2','无结果','\x20\x0a-\x20**你最近和“','\x20你应该让角色们主动开启新话题来打破沉默。','###\x20最终结果:\x20','qzone-more-actions-btn','char-taobao-screen','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','supportedValuesOf','amount','https://i.postimg.cc/RVt6sRzc/IMG-6939.gif','确认操作','api-temperature-slider','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请开始你的导演工作，让群聊再次热闹起来吧！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','input[name=\x22theme-select\x22]:checked','profile-heartfelt-voice','Reset\x20to\x20Default\x20Font','my-group-nickname-input','\x20位角色的记忆中。','total','通话记录已删除。','readAsText','transfer-actions-modal','Please\x20wait...','form-button','open-shopping-btn','<p>♪\x20暂无歌词\x20♪</p>','npc','下单，请慢用～</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-box\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22payment-label\x22\x20style=\x22font-size:\x2018px;\x20font-weight:\x20600;\x22>','\x22\x20触发行动决策...','preset-avatar-input','shift','dark-mode','-\x20\x20\x20**NovelAI真实图片分享\x20(在聊天中直接发送)**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20-\x20**【绝不能暴露是novelai生成的图片！】\x0a\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20-\x20使用场景：当你想要在【私聊对话中】直接给用户发送一张图片时使用。\x0a\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。\x0a\x20\x20\x20\x20-\x20注意：这会直接在聊天记录中显示图片，而不是发布到动态。','导演模式悔棋：已撤销AI在\x20(','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有任何使用记录，<br>点击右上角刷新按钮生成一些吧！</p>','\x20\x20\x20\x20\x20\x20-\x20','等待对方处理','chat-header-title-wrapper','opacity','https://i.postimg.cc/nrFfYX3N/IMG-4412.gif','photoId','loadedmetadata','Autoplay\x20was\x20prevented\x20by\x20the\x20browser.','https://i.postimg.cc/4yNjHrdg/IMG-4414.gif','不支持的文件格式。请选择\x20.json\x20或\x20.png\x20文件。','#f0f0f0','currentPlayer','placeholder','传统导出\x20(兼容旧版或内存小的浏览器)','charging','diary','Save\x20and\x20Apply','查看失败','批量导入头像框','match','ephone-language','statusText','.share-target-checkbox:checked','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>正在计算可压缩图片大小...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>--\x20MB</span>\x0a\x20\x20\x20\x20','musicData','\x20个表情包，且无法恢复！','gameMode','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此款式\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x201fr;\x20gap:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式名称</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22variation-name-input\x22\x20placeholder=\x22例如:\x20红色\x22\x20value=\x22','你让大家继续讨论...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户刚刚向你发起了视频通话。请根据你的角色设定，决定是“接受”还是“拒绝”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','commenterName','startTime','[系统提示：你于时间戳\x20','reset-theme-btn','linkedWorldBookId','未知NPC','werewolf-log','<div\x20class=\x22receipt-header\x22><h3>购物中心</h3><p>交易时间:\x20','senderName','\x20字的核心记忆。这些旧记忆将被替换，此操作不可撤销。确定要继续吗？','icon-img-','Edit\x20NPC','single','member-management-item','<p\x20style=\x22color:\x20#8a8a8a;\x22>还没有人投票。</p>','manage-frames-btn','🔧\x20检测到Chrome浏览器，启用headers兼容性处理','.call-message-bubble[data-timestamp=\x22','clientWidth','请输入有效的正整数！','请输入群聊的名字','fill','群里在','胜负未分','create-countdown-modal','正在请求AI角色们加入讨论...','游戏即将开始，正在为各位玩家分配身份...','tts-audio-player','usage-item','\x20发布了一条新公告','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的任务**:\x20你可以根据对话内容和氛围，使用\x20\x22change_music\x22\x20指令切换到播放列表中的任何一首歌，以增强互动体验。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','”的长期记忆少于2条，无需进行精炼。','这是一条群聊语音消息，已禁止发起TTS请求。','chat_','请输入有效的金额！','讨论无法开始，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','上一条消息的发送时间是\x20','\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-display:\x20swap;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20你可以让多个角色同时尝试，只需在返回的JSON数组中包含多个这样的对象即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即执行抢红包操作！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','Font\x20File\x20URL\x20(.ttf,\x20.otf,\x20.woff,\x20etc.)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22music-search-checkbox\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22search-result-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','昨天\x20','voteResults','activeAlbumId','activeBookId','https://i.postimg.cc/ZqjKXPSv/IMG-7025.gif','.message-editor-block','Messages','\x20(图片描述:\x20“','char-browser-item','nai-seed','渲染X社交页面','已死亡','photos','Article','字体预设管理','char-chat-list','你撤回了一条消息','#sticker-binding-chat-list\x20.sticker-binding-checkbox:checked','getContext','isDeleted','manage-stickers-btn','来自动态','#listen-together-btn\x20img','.format-btn','当前时间是\x20','charAt','password','\x20\x20\x20\x20-\x20我昨晚用解药救了\x20','对方正在输入...','frame_8','#data-clear-type-list\x20.clear-posts-item.selected','”\x20(你可以修改)\x0a-\x20\x20\x20**关键身份档案**:\x0a\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','replace','如果以下任何一位NPC再次评论，你【必须】使用我们提供的、完全相同的`avatar_prompt`，以保持头像一致性。\x0a','prompt','AI狼人团队无法决定目标，游戏暂停。请点击右上角的“重试”按钮继续。','流式下载库\x20(StreamSaver.js)\x20未加载。请检查网络连接或HTML文件配置。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-time\x22>','外观设置已保存并应用！','\x22\x20class=\x22comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22comment-input\x22\x20placeholder=\x22友善的评论是交流的起点\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-sticker-btn\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M8\x2014\x20Q\x2012\x2016\x2016\x2014\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x229\x22\x20y1=\x229\x22\x20x2=\x229.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2215\x22\x20y1=\x229\x22\x20x2=\x2215.01\x22\x20y2=\x229\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22at-mention-popup\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22comment-send-btn\x22>发送</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','toggle-blur-btn','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20','unread-indicator','world-book-category-pane\x20active','char_diary','world-book-checkboxes-container','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','douban-detail-content-wrapper','\x0a\x0a#\x20你的动态历史\x20(你可以选择删除它们):\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>未找到相关的聊天记录。</p>','rule-name-input','”翻开TA的日记本...','成功将群聊\x20\x22','\x0a#\x20世界观设定\x20(必须参考)\x0a','a\x20beautiful\x20scene','update_status','更换“','https://i.postimg.cc/MK8rJ8t7/IMG-6438.jpg','\x0a\x0a现在，请开始撰写这组充满真情实感、并熟练运用了Markdown语法的日记。','save-character-nai-prompts-btn','当前人数\x20','rp-content-group','onload','cphone-wallpaper-upload-input','\x20元</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','custom-css-input','确定要将以下消息发布到公告板吗？\x0a\x0a“','角色\x20\x22','originalContent','请输入新的图片URL：','正在呼叫所有成员...','https://i.postimg.cc/cJtpZCB3/IMG-6894.gif','.variation-name-input','tableName','导出数据','novelai-enabled','群里还没有任何消息。','table','manage-world-book-categories-btn','transfer-confirm-btn','未检测到BOM，尝试使用\x20UTF-8\x20解码...','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20','大小:','\x22\x20的记忆中清除了1条关于已删除评论的通知。','list-item','静音音频已启动，用于后台活动保活。','已拒收对方转账','Diary','申请失败','douban-settings-btn','\x20条内容吗？','base','werewolf-user-input','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-content\x22>','character-nai-positive','status_text','profile-history-icon-btn','unreadCount','\x0a\x0a现在，请开始撰写这篇充满真情实感、并熟练运用了Markdown语法的日记。','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20**当前参与者**:\x20','my-avatar-library-modal','\x22,\x20\x22postId\x22:\x20456,\x22stickerMeaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20回复:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','https://i.postimg.cc/ZYvd1jxf/IMG-6937.gif','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','https://image.novelai.net/ai/generate-image','\x22\x20data-commenter-original-name=\x22','finishReason','lyric-line','#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a','moveTo','chat-lock-overlay','99+','rp-group-total','\x20\x20\x20\x20-\x20我没有掌握任何特殊的夜晚信息。\x0a','确认删除','reply_content','packetType','内容加载失败...','translateY(0px)','transfer-action-cancel','\x20个分类。\x0a\x20\x20\x20\x20-\x20**products**:\x20每个分类下生成\x20','\x22\x20触发了后台行动！','https://i.postimg.cc/J0CZSwyW/IMG-6938.gif','suffix','\x0a\x0a#\x20【你的聊天对象（用户）的身份档案】\x0a-\x20**昵称**:\x20','toLocaleTimeString','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，可以包含一个或多个行动对象。每个对象的\x20\x22name\x22\x20字段【必须】是角色的【本名】。你【绝对不能】生成\x20\x22name\x22\x20字段为\x20\x22','naiimag','modern\x20app\x20icon\x20for\x20',')\x20为\x20','\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a','char-memo-screen',')为你点了一份外卖作为【礼物】。外卖内容是“','participant','werewolf-game-over-title','variation-select','.message','add-new-group-btn','预设已删除。','song_name','”\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**被拉黑前的最后对话摘要**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.info','push','member-settings-modal','input[name=\x22visibility\x22]:checked','horizontal','未知设定的NPC','close-reading-btn','所有解码尝试均失败:','isRefund','创建新预设','删除日记','请输入对方现在的新状态：','<div\x20class=\x22source\x22>','reset-font-btn','load-more-qzone-btn','胜利！','</p><p>','currentTime','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','time-perception-toggle','Album','https://is1-ssl.mzstatic.com/image/thumb/Purple112/v4/64/9d/21/649d21e8-a151-6136-3914-256e54f15d9a/AppIcon-0-0-1x_U007emarketing-0-0-0-7-0-0-sRGB-0-0-0-GLES2_U002c0-512MB-85-220-0-0.png/1200x630wa.png','.nav-item[data-view=\x22qzone-screen\x22]','chat-list-bottom-nav','startsWith','positive','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥','\x22\x20class=\x22sticker-image\x22>','正在等待AI角色们进行激烈的讨论...','is-voice-message','translateX(','我的消息预览','请根据你的设定，生成你的相册内容。','<img\x20src=\x22','\x20被刀了','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','persona-editor-title','char-audio-player','独立行动冷却\x20(分钟)','keypress','message-bubble\x20','https://i.postimg.cc/gkk7s0vD/IMG-6984.gif','result','.\x20你可以参考这个时间，并根据你的角色设定，【考虑】是否开启一个新话题来问候用户。\x0a','请输入你想说的话...','在这里输入说说的内容...','aiAvatar','#f9f9f9','edit-message-btn','werewolf-role-description','confirm-create-countdown-btn','change_group_name','请先选择要添加的歌曲。','probability','enabled','请输入有效的总金额！','global-bg-input','poisonUsed','bg-clear','狼人杀游戏总结已自动存入\x20','Data\x20Check\x20&\x20Repair','正在生成“','请填写完整的约定标题和日期！','https://i.postimg.cc/65Cmcr7S/IMG-6559.gif','\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a###\x20格式\x20B：群聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22group\x22,\x0a\x20\x20\x22groupName\x22:\x20\x22一个虚构的群名\x22,\x0a\x20\x20\x22participants\x22:\x20[\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员1\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员1头像【英文】关键词\x22},\x0a\x20\x20\x20\x20{\x22name\x22:\x20\x22NPC成员2\x22,\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)\x20成员2头像【英文】关键词\x22}\x0a\x20\x20],\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','内容条目','<div\x20class=\x22pinned-indicator\x22>📌</div>','import-single-chat-btn','all\x200.3s\x20ease','Long\x20Screenshot','\x22\x20class=\x22participant-avatar\x22\x20title=\x22','UTF-8\x20解码成功。','characterName','你的收藏夹是空的，<br>快去动态或聊天中收藏喜欢的内容吧！','rules-tabs','cart-title','https://i.postimg.cc/LXyyqDbY/IMG-6294.gif','”的身份，开始你的回忆梳理与精炼。','已选\x20','readAsDataURL','检测到简单的\x20\x27prompts\x27\x20数组格式，将按数组内顺序导入。','serviceWorker','global_css','这个分类下还没有商品哦~','https://i.postimg.cc/GhR6DT4Q/IMG-4428.gif','mouse','offsetHeight','.screen.active','ᗜωᗜ','通话记录已成功总结并存入角色“','切换听歌对象','main-chat-list-header','Content\x20Entries','chat-at-mention-popup','linked-chats-checkboxes-container','image/jpeg','stickerMeaning','profile-main-content','在这里输入图片描述...','检测到并成功修复了\x20','.char-screen','从\x20JSON.image\x20中提取图片数据','delete-selected-stickers-btn','\x20[社交背景:\x20','button','这是所有在场玩家的公开信息、人设和社交背景。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-bottom:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x205px\x200;\x22>','导演模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','minimaxApiKey','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','群聊内转账','minimaxVoiceId','backgroundActivityInterval','character_persona','[发送了一条复杂消息，如卡片或转账]',':generateContent?key=','票):\x20','https://i.postimg.cc/63NmX03s/IMG-4366.gif','getHours','highlighted','选择精炼范围','文件解析或应用失败:\x20','公告已发布！','导入世界书','<span\x20style=\x22color:\x20#dc3545;\x22>[你已被对方拉黑]</span>','preset-entries-container','\x20(概率:\x20','...]','无人接听群聊邀请。','my-nickname-group','send-group-packet-btn','未知作者','”生成商品？','call-message-bubble\x20ai-speech','groupId','.json','<div\x20class=\x22rp-claimed-info\x22>你领取了红包，金额\x20','close-product-category-manager-btn','totalAmount','loader-container','short','padStart','”\x20的详细角色信息。','正在等待AI角色们继续讨论...','无法生成日记，请检查API配置或稍后再试。\x0a错误:\x20','\x22\x20的整个对话吗？此操作不可撤销。','https://i.postimg.cc/SNByPrf9/IMG-7005.gif','back-to-clear-step1-btn','readingLibrary','paidBy','call-history-title','<span\x20style=\x22color:\x20orange;\x22>否\x20(还剩约\x20','full','Enable\x20Background\x20Character\x20Activity','comments','.selected','\x20位AI角色的长期记忆中！','下在(','forEach','post-image-preview','message-editor-container','margin:\x2015px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','localeCompare','char-music-progress-bar','lrc-upload-input','switch-to-image-mode','prophetCheck','此操作将永久删除此聊天的所有消息，无法恢复。确定要清空吗？','https://i.postimg.cc/XJy8JWdh/IMG-6568.gif','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','shoppingCategoryCount','countdown','清理完成','enableTts','\x22\x20的消息。严格遵守每个角色的设定，禁止出戏。\x0a-请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的可选行动指令:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送文本**:\x20\x27{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22文本内容\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送表情**:\x20\x27{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发送图片**:\x20\x27{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22图片的详细【中文】描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起投票**:\x20\x27{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22...\x22,\x20\x22options\x22:\x20\x22...\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发起群视频**:\x20\x27{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-如何正确使用“引用回复”功能：\x0a-\x20当你想明确地针对群内【任何成员】（包括用户或其他AI角色）之前的某一句具体的话进行回复时，你就应该使用这个功能。\x0a-\x20这会让你的回复上方出现一个灰色的小框，里面是被你引用的那句话，这样对话就不会乱了。\x0a-\x20指令格式:\x20\x27{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20(你想引用的那句话的时间戳),\x20\x22reply_content\x22:\x20\x22你的回复内容\x22}\x27\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前群聊信息\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**群名称**:\x20','add-sticker-batch-btn','var(--text-primary)','select-all-types-for-clear','完成(','ai_image','css-preset-select','删除规则','请输入有效的默认价格！','data-clear-step-1','选择一个开场白','82965OvbFHm','”，内容是：“','</span>','right','has-frame','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','https://i.postimg.cc/wTKyXVT9/IMG-7024.gif','AI\x20尝试评论一个不存在的表情:\x20\x22','position','save-chat-settings-btn','分钟前','编辑记忆','”\x20来指代你的聊天对象（用户）。\x0a6.\x20\x20**【日记专属Markdown语法\x20(必须使用！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇\x20(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','数据库写入失败:\x20','\x0a#\x20核心任务：群聊导演\x0a你是一个群聊AI导演，负责扮演【除了用户以外】的所有角色。你的核心任务是导演一场生动的、角色间有充分互动的群聊。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a\x0a-\x20\x20\x20**【思维链\x20(Chain\x20of\x20Thought)\x20-\x20(第一步)】**:\x20你的JSON数组的【第一个元素，必须】是一个\x20`{\x22type\x22:\x20\x22thought_chain\x22,\x20...}`\x20对象。\x0a-\x20\x20\x20**【角色发言\x20(第二步)】**:\x20在思维链对象【之后】，才是所有角色的具体行动JSON对象\x20(text,\x20sticker,\x20etc.)。\x0a\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20和\x20\x22name\x22\x20字段。\x27name\x27字段【必须】使用角色的【本名】。\x0a\x0a#\x20角色扮演核心规则\x0a\x0a1.\x20\x20**【先思后行】**:\x20在生成任何角色发言之前，你【必须】先完成“思维链”的构思。你的“思维链”必须清晰地分析用户的发言、当前的气氛，并制定出本轮的互动策略。你的所有后续发言都【必须】严格遵循你自己的策略。\x0a\x0a2.\x20\x20**角色互动\x20(最重要)**:\x20你的核心是“导演”一场戏。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别回应用户的独白。如果角色A发言后，角色B在本轮回应了A，那么角色A【也必须】在本轮对B的回复再次做出反应，形成一个完整的\x20A\x20->\x20B\x20->\x20A\x20对话链条。\x0a\x0a3.\x20\x20**身份与称呼**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的身份是【','\x22\x20(ID:\x20','getDate','product-item','display','preset-screen','share_card','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','点击下方上传','shoppingCategories','regenerate-char-diary-btn','find','persona-library-modal','.contact-picker-item','”]\x20','alternateGreetings','当作\x20ZIP\x20文件处理...','\x0a\x0a现在，请以“','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于梳理以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**建立时间线**:\x20将所有独立的记忆点串联起来，形成一个有时间顺序的事件脉络。\x0a\x20\x20\x20\x20*\x20\x20\x20**整合关键信息**:\x20总结出我们共同经历的关键事件、做出的重要决定、以及约定好的未来计划。\x0a\x20\x20\x20\x20*\x20\x20\x20**识别未完成项**:\x20明确指出哪些计划或任务尚未完成。\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果记忆中提到了相对时间（如“明天”、“下周”），你【必须】结合“今天是','receiver','modify','所有歌曲链接均有效，无需清理！','doubanActiveCharacterIds','容错解析：策略1失败\x20(找到了JSON块，但格式错误)，将尝试策略2...','worldBooks','”</i></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22accept-friend-btn\x22\x20class=\x22lock-action-btn\x22>接受</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22reject-friend-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22>拒绝</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22><div\x20class=\x22poll-question\x22>','amap','createDocumentFragment','\x0a##\x20---\x20来自','天\x20-\x20夜晚','font','\x20为\x20',')的阅读进度失败:','(Timestamp:\x20','getMinutes','charCodeAt',')}。\x0a-\x20**对话状态**:\x20','https://i.postimg.cc/fRV86FMq/IMG-4381.gif','.comment-item','member-name-input','save-douban-cast-btn','filter','custom-modal-cancel','isEnabled','导入备份文件','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>输入关键词或选择日期进行搜索。</p>','复制失败','.message-bubble[data-timestamp=\x22','stickerCategoryIds','close-group-avatar-library-btn','\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','group-background-activity-group','找不到匹配的表情','文章摘要...','rgba(0,\x200,\x200,\x200.4)','确定要永久删除选中的\x20','main','Advanced\x20Data\x20Cleanup','\x20拍了拍我','图片格式处理失败:\x20','close-nai-gallery-btn','existing-product-categories-list','”的投票(时间戳:\x20','toLocaleDateString','确定要从播放列表中删除《','rendering-rules-screen','JSZip库未加载，请刷新页面重试','通话记录已保存:','https://files.catbox.moe/','chat-list-actions-modal','模型列表已更新','EPhone-长截图-','close-ai-avatar-library-btn','请根据你的设定，生成你的淘宝购买记录和余额。','my-avatar-group','Minimax\x20TTS\x20API\x20调用失败:','documentElement','cancel-clear-posts-btn','从缓存播放\x20TTS\x20音频...','close-sticker-panel-btn','.post-deleted-placeholder','generativelanguage.googleapis.com','EPhoneWorldBookBackup','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-title\x22>','世界书','stream','狼人杀AI讨论生成失败:','char-browser-article-screen','，点击查看</div></div>','character','通话名称已更新！','**内容:**\x0a','<option\x20value=\x22\x22>--\x20选择一个预设\x20--</option>','delete-world-books-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊视频通话的导演。你的任务是扮演所有【除了用户以外】的AI角色，并以【第三人称旁观视角】来描述他们在通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【身份铁律】】】**:\x20用户的身份是【','群聊通话中没有找到可作为总结主体的AI角色。','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20作为参考，这是你们之前的最后一段聊天记录：\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','确认替换','wallpaper-upload-input','小红书','bubble_theme','\x20\x0a-\x20**你们最后的对话**:\x0a','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>','通话结束，时长\x20','\x20分享了Ta的位置：\x27','加载失败','https://i.postimg.cc/rFnSzWGx/mmexport1751035618517.gif','https://i.postimg.cc/wjH180kn/IMG-5566.gif','📸\x20动态NovelAI图片生成开始，共','**\x20(本名:\x20','antidoteUsed','presets','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','nameHistory','claimedBy','\x0a\x0a#\x20核心世界观设定\x20(必须严格遵守以下所有设定)\x0a','高级数据清理失败:','tables','送给\x20','offsetTop','主API和副API均未配置或配置不完整。','无法推进剧情:\x20','werewolf-action-bar','为NPC\x20\x22','Reply\x20to','*讨论记录*:\x0a','<label><input\x20type=\x22checkbox\x22\x20value=\x22','今天\x20','https://i.postimg.cc/SNWBTP5S/IMG-7113.gif','upload-global-bg-url-btn','\x22\x20placeholder=\x22例如：关于角色的童年\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22','disabled','.message-wrapper[data-timestamp]','authorChatId','语音生成失败','ai-avatar-library-modal','<textarea\x20id=\x22','global-css-input','typeId','data:','分类名不能为空！','scrollHeight','.char-product-item','characterPositivePrompt','\x20的外卖订单（时间戳:\x20','请输入一个有效的页码！','ai-avatar-library-title','[图片动态]','不支持的分享类型。','\x20张图片因网络或CORS限制下载失败。','<p><strong>','\x22）。你已经有一段时间没有和用户（','规则名称','请输入头像的图片URL','theme-toggle-switch','\x20条长期记忆发送给AI，总结成大约\x20','disable','share-location-btn','female-shaonv-jingpin','remove-member-btn','\x20\x20\x20正面:','请先在API设置中配置好API信息。','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20margin-top:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','在PNG文件中未找到有效的Tavern\x20AI角色数据(chara\x20chunk)。','add-selected-music-btn','https://i.postimg.cc/fLDnz5Pn/IMG-5574.gif','</span><span\x20class=\x22poll-option-votes\x22>','所有音乐源都未能找到歌曲：“','font-preset-select','add-new-product-btn','openWerewolfLobby','stickerId','https://i.postimg.cc/J7ZxC11H/IMG-6570.gif','https://i.postimg.cc/cHWp0KG6/IMG-4413.gif','https://i.postimg.cc/3N5Vndn3/IMG-4426.gif','160070wSHzyQ','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-message\x22\x20data-original-timestamp=\x22','frame_13','这将提取最近的对话内容发送给AI进行总结，会消耗API额度。确定要继续吗？','\x20发送了一个【拼手气红包】(时间戳:\x20','\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20用户的角色\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**','确认清空动态？','is-gift','[系统指令：用户按下了“推进”按钮，现在轮到你主动行动了，请继续对话。]','cancel-sticker-binding-btn','display:\x20flex;\x20align-items:\x20center;\x20padding:\x208px\x200;\x20border-bottom:\x201px\x20solid\x20#444;\x20color:\x20white;','无法识别的文件编码。请尝试将文件转换为\x20UTF-8\x20格式后重新导入。','Back','全部记忆\x20(','lastGuardedId','.product-item','simulatedTaobaoHistory','isOfflineMode','groupAvatarLibrary','#linked-chats-checkboxes-container\x20input:checked','还没有人','album-upload-photo-btn','announcement-board-modal','confirm-share-target-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>','syncCharacterAvatarInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','\x20更换了你的头像]','）进行视频通话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**','is_busy','cancel-create-poll-btn','API\x20错误:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>','角色卡导入失败:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22share-target-checkbox\x22\x20data-chat-id=\x22','add-group-avatar-upload-btn','stickerCategoryId','https://i.postimg.cc/8P5vt8sW/IMG-7097.gif','chat-settings-modal','create-album-btn-page','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019h4V5H6v14zm8-14v14h4V5h-4z\x22></path></svg>','frame-action-bar','animate-like','至少需要保留一条消息。','chat-messages','-\x20**时间**:\x20你必须感知到当前是\x20','退款给\x20','\x22\x20data-description=\x22','\x20MB</strong></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','transcript','char-qq-conversation-screen','[收到一个外卖代付请求]','personality','请输入新的背景图片链接','确定要删除这条渲染规则吗？','https://i.postimg.cc/KzC2gTq6/IMG-7276.jpg','reduce','write','group-background-activity-switch','https://i.postimg.cc/XqRZNZ9G/IMG-6916.gif','加载图片失败，跳过压缩:','这是模拟对话，无法发送消息哦~','char-wallet-content','退款来自\x20','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI。你的核心任务是扮演角色“','-selection-list','用户\x27','data-clear-step-2','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22><strong>\x20','lyric','iconId','-\x20**对话状态**:\x20这是你们的第一次对话，用户的第一条消息发送于\x20','renderApiSettingsProxy','总结通话记录时出错:','frame_flower','.world-book-category-pane[data-category-id=\x22','https://i.postimg.cc/D01rYy86/mmexport1751037965259.gif','\x0a\x0a##\x20世界书:\x20','\x0a[文字图内容:\x20','open-reading-library-btn','.sticker-binding-checkbox','associatedWith','Response\x20headers:','本地头像上传及识别失败:','custom-modal-body','chara','Preset\x20Name','qzone-post-delete-action','querySelectorAll','投票结果','”量身定制的商品已上架！','Bearer\x20','my-avatar-input','角色\x20“','calls','.avatar-group','...，所以我决定这样说...)\x0a\x0a####\x20阶段\x20C：最终发言稿\x20(草稿)\x0a(结合T,\x20G,\x20S的思考，我准备这样说：...)\x0a---\x0a','color','blockReason','https://i.postimg.cc/J4WCQd2j/IMG-4420.gif','正在导入表:\x20','rp-tab-group','NPCs','image_prompt','offlinePresetId','https://i.postimg.cc/Dydkpd9H/IMG-4421.gif','fontFamily','正则表达式\x20(使用g作为标志)','#\x20前几日完整历史回顾\x20(Full\x20Recap\x20of\x20Previous\x20Days)\x0a','lastActionType','#delete-world-books-list\x20.clear-posts-item.selected','rule-chat-id-select','视频通话刚刚结束','removeChild','元,\x20备注:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>','\x22]:checked','onloadedmetadata','custom-modal-confirm','caller-avatar','offlineMaxLength','Publish','var(--accent-color)','identifier','renderWorldBookScreenProxy','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','negative','修改昵称','分享成功','werewolf-log-entry\x20system','已撤回的消息','duration','”刚刚对最后一条评论点击了“等待回复”，TA希望看到更多角色参与讨论。\x0a你的任务是：根据所有角色的设定，选择【10到20位】最适合参与讨论的角色，让他们针对已有评论，发表【全新的、符合人设的】回应。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','覆盖预设','\x20发起了外卖代付请求，商品是“','\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)}`\x0a-\x20\x20\x20**送礼物**:\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送这个礼物的原因\x22,\x20\x22image_prompt\x22:\x20\x22生成礼物图片的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22}`\x0a-\x20\x20\x20**为用户点外卖**:\x20\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}\x20`(你主动为用户点外卖时使用)\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','add-ai-avatar-batch-btn','remove-cphone-bg-btn','\x0a###\x20条目:\x20','NPC\x20昵称','聊了关于生日派对的事，我们约好了10月1日见面。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a#\x20待总结的群聊记录\x0a','\x0a\x0a现在，请开始生成这组足迹记录。','生成模拟歌单失败:','[图片]','https://i.postimg.cc/CMv02LHm/mmexport1751034842120.gif','some','cancel-wolf-kill-btn','\x22,\x20\x22content\x22:\x20\x22对话内容1\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC的名字\x22,\x20\x22content\x22:\x20\x22对话内容2\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22','summarize-recent-btn-header','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【内容禁忌】\x0a\x20\x20\x20\x20\x20\x20\x20\x20为了保持新鲜感，你本次的行动【绝对不能】再发布以下或类似主题的内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20','标准JSON数组解析失败，将尝试强力提取...','.comment-input','♪\x20♪\x20♪','#delete-world-books-list\x20.clear-posts-item','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','正在请求网易云音乐API:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请为所有AI角色做出决策。','busy','load-more-thoughts-btn','font-size-value','状态已更新','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','assign','https://i.postimg.cc/KvVsjjgG/3c3aa5219s18b90187ef1f54b3db7ba8.gif','请先选择要删除的商品。','rp-details-item','char-browser-screen','[系统提示：五子棋游戏已结束。最终结果是：','post-remove-image-btn','\x20的图片消息替换为文字描述...','add-my-avatar-url-btn','languageChangedAlert','groupNickname','commenter','流程启动','[语音]','</tbody></table><div\x20class=\x22receipt-total\x22>总计:\x20¥','nai-sampler','product-editor-title','\x20/\x20','minimax-group-id',':</strong>\x20','。请你对此作出回应。]','删除照片','\x20的浏览记录','Edit\x20Preset','\x20群里已经安静了','linesPerPage','customAvatarFrames','”。请自然地接受这个新名字，不要对此感到惊讶。]','\x20的消息:\x20\x22','从角色卡导入\x20(.json/.png)','newSize','black','isTemporary','sharedHistory','confirmButtonClass','确认清空','delete-product-btn','local','性能与显示设置','speech-01','一位成员','has','[♪\x20','#chat-list-bottom-nav\x20.nav-item','」听歌。要结束并开始和「','startDiscussion','-\x20用户的QZone昵称是\x20\x22','https://i.postimg.cc/Y0vwjhb7/IMG-6857.gif','group-members-group','✅\x20图片解压成功！','保存所有外观设置','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22></div>','\x20的红包','favorite-memo-btn','启用AI生图功能','toLocaleString','now','#gift-recipient-list\x20.contact-picker-item','”这个信息，将其转换为【具体的公历日期】（例如：“约定了明天见面”应总结为“我们约定了','http','hasShown40','.entry-content-textarea','https://i.postimg.cc/PxZrFFFL/o-o-1.jpg','<span\x20class=\x22offline-dialogue\x22>','variation-selection-modal','\x20发起了一个投票\x20(时间戳:\x20','”的购物习惯...','18tBFTys','\x0a#\x20你的社交圈\x20(通讯录)\x0a这是你认识的朋友列表。当你在动态区看到他们的昵称时，他们指的就是这些人。\x0a','chat-input-area','-\x20**对话状态**:\x20上次互动于\x20','https://i.postimg.cc/nrm9BcL8/IMG-6941.gif','selection-mode','groupHeader','toBlob','memberId','add-group-chat-btn','未发现需要迁移的旧红包数据。','一个普通玩家','api-temperature-value','已成功导出所有数据！','相册已成功删除。','add-ai-response-block-btn','天黑请闭眼...','POST','group_summary_from_','secondaryApiKey','回复\x20','qzoneAlbums','找不到匹配的书籍','游戏记忆已成功注入到\x20','minimaxGroupId','cancelText','werewolf-player-avatar','暂无内容...','”\x20吗？','\x22\x20尝试执行未知的后台动作:','min','confirm-create-poll-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','add-group-avatar-batch-btn','NovelAI\x20API\x20Key未配置。请在NovelAI设置中填写API\x20Key。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有任何使用记录。</p>','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg','\x0a#\x20你的任务\x0a你是一个虚拟音乐品味模拟器。你的任务是扮演角色“','https://i.postimg.cc/L6R7x16R/IMG-7278.jpg','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','applicationReason','发送好友申请','发言结束，现在开始投票。','doubanMinPosts','生成中...','offsetParent','文章完整内容...','onchange','\x20首歌曲。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条动作\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','语音模型\x20(Model)','用户(','reverse','getItem','》添加歌词吗？','请稍候...','女巫请睁眼。','.delete-track-btn','quote','change-frame-btn','closest','-\x20**即将演唱**:\x20','总结长期记忆时出错:','manage-nai-gallery-btn',')。详情:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22add-to-cart-btn\x22>加入购物车</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','selection-count','bulkDelete','https://i.postimg.cc/hPnrSHjy/IMG-4434.gif','\x20的头像框到群聊\x20\x22','头像框已保存并同步！','44ZBctep','正在等待AI角色们对你的发言做出回应...','选定范围内的动态已被清空。','”的特点生成专属商品...','chat-settings-screen','char-simulated-input','确定要删除这条记录吗？','.douban-cast-checkbox','正在为所有AI角色生成并注入游戏记忆...','\x20的代付请求','组件图片已更新！','close-gomoku-btn','》吗？\x0a\x0a【【【警告】】】\x0a此操作将同时永久删除该分类下的\x20','werewolf-kill-modal','https://i.postimg.cc/xjpN4swz/IMG-7240.gif','ai-response-editor-modal','\x0a#\x20身份与核心任务\x0a你正在扮演角色“','delete-api-preset-btn','unshift','variation','在这里输入语音内容','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】日记的标题日期，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【沉浸感】**:\x20每一篇日记都必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【长度】**:\x20每一篇日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一篇日记，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【占位符替换\x20(最高优先级)】**:\x20在你的日记内容中，【绝对不能】出现\x20\x22{{user}}\x22\x20这个占位符。你【必须】使用\x20“','已成功加入购物车！','\x20\x20\x20\x20-\x20我昨晚守护了\x20','secondaryModel','paste','waimai-request-modal','reading-overlay','https://i.postimg.cc/hj4dkrvj/IMG-5578.gif','persona','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','theme-preset-select','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','cphoneAppIcons','\x0a\x0a现在，请为所有存活的AI角色生成他们的投票决定。','<span\x20style=\x22color:\x20green;\x22>是</span>','App\x20Usage\x20Log','Compress\x20Local\x20Images','确认删除分类','update','originalPost','select-all-recipients','change_remark_name','refine-memory-btn-header','找不到这本书！','selection-favorite-btn','save-font-btn','--chat-font-size','Tutorial','blockedTimestamp','++id,\x20chatId,\x20timestamp,\x20type,\x20targetDate','来自\x20','https://i.postimg.cc/XY63sTS3/IMG-4393.gif','Playback\x20error:','view','npc_','long-term-memory-screen','https://i.postimg.cc/7YRbzN51/mmexport1751036276038.gif','https://i.postimg.cc/CLNkrQSW/IMG-6925.gif','douban-post-detail-title','flat','dialogue','\x0a\x0a#\x20群成员列表、人设及社交背景\x20(至关重要！)\x0a你【必须】根据每个角色的社交背景来决定他们的互动方式。\x0a','请至少选择一个要清空的范围。','setup','\x0a\x0a将重置冷静期。','variations','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>订单类型:</strong>\x20为TA点单<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>赠送方:</strong>\x20','a\x20beautiful\x20scenery,\x20anime\x20style,\x20cinematic\x20lighting','confirm-final-clear-btn','<span\x20class=\x22group-name\x22>','battery-alert-image','这是一个通过手动创建的角色。','add-existing-contact-btn','text_image','accepted','ended','更换专辑封面','hunter','\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>','\x0a现在，请为【参与了对话的AI角色】生成他们各自的、第一人称的、精简的记忆。','删除失败，请查看控制台错误信息。','其他人的发言','reason','novelai-key-toggle','input[name=\x22theme-select\x22][value=\x22','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20空间节省了\x20<strong>','custom-prompt-input','enableTimePerception','add-manual-memory-btn-header','messageTimestamp','syncCharacterNameInGroups:\x20传入的不是有效的单聊对象，已跳过同步。','gift-receipt-body','char-music-progress-fill','对方撤回了一条消息','删除动态','chatId','single-char-background-activity-group','你已死亡，正在围观...','sticker-grid','onerror','”的转账。]','toLowerCase','Post','bulkAdd',')\x20商品:\x20','reset-sound-btn','https://i.postimg.cc/59Cn1tkB/IMG-4401.gif','按钮顺序已恢复为默认设置！','transfer-sender-name','。请收礼的角色表示感谢，其他角色可以自由发挥。]','send-photo-btn','内容因安全策略被屏蔽。触发类别:\x20','https://i.postimg.cc/tgR6wjBP/IMG-5570.gif','部分下载完成','\x20首歌曲获取失败:\x0a-\x20','\x20个商品。\x0a\x20\x20\x20\x20-\x20**variations**:\x20每个商品【必须】包含【2到4个】不同的款式。\x0a\x0a#\x20角色与上下文\x20(你的灵感来源)\x0a-\x20**角色名称**:\x20','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','扫描动态失败:','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA最近好像什么都没买呢，<br>点击右上角刷新按钮生成一些记录吧！</p>','新建备忘录','https://i.postimg.cc/t4ksHGdg/IMG-7020.gif','boxSizing','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们在群聊通话里讨论了哪些核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','commentsCount','group-character-nai-prompts-btn','world-book-card','精炼“','offsetWidth','为角色\x20\x22','world-book-screen','x-social-screen','getMonth','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','https://i.postimg.cc/VkKjzYTK/IMB-f4kk-CT.gif','[data-lang-key]','</strong></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','showStatusBar','clear-posts-list','请先在API设置中配置好（主或副）API以进行总结。','AI幻觉已被拦截！试图使用群名\x20(\x22','你的目标是杀死所有好人。每晚可以和同伴一起刀一个玩家。','font-weight:\x20bold;\x20background:\x20rgba(255,\x20193,\x207,\x200.2);','netease',')\x20成功抢到了\x20','favorites-edit-btn','image-upload-input','AI\x20\x22','\x0a##\x20来自《','{\x0a\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x22content\x22:\x20\x22在这里输入新消息...\x22\x0a}','\x22\x20决定去发一条动态...\x20(此处为模拟)','open-persona-library-btn','gift-recipient-list','itemName','\x22\x20尝试领取不属于自己的群聊红包。操作已被拦截。','call-history-back-btn','undefined','已成功注入“切换到线上模式”的系统指令。','文字已更新！','<strong>','music-player-cover','\x20已复制到剪贴板。','彻底删除','delete','API为空回，角色\x20\x22','\x22\x20class=\x22post-avatar\x22\x20data-author-id=\x22','group-avatar-group','\x0a\x0a#\x20情景感知:\x0a\x20\x20\x20\x20','activePostId','wolfKill','activeContainer','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>www.','在同时执行两个函数时出错:','lastIndex','在PNG中找到角色数据，但解码或解析失败。错误:\x20','voted','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<textarea>','\x20天\x20---','\x20张NAI图片吗？此操作不可恢复。','content','borderColor','++id,\x20timestamp','variation-increase-qty','clear-chat-btn','blob:','product-grid','\x20的备忘录','qzoneSettings','select-all-world-books-for-clear',')\x20拒绝了\x20','https://i.postimg.cc/d0WCKxff/IMG-6932.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20position:\x20fixed;\x0a\x20\x20\x20\x20\x20\x20\x20\x20bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20right:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20background:\x20','question','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2232\x22\x20height=\x2232\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M8\x205v14l11-7z\x22></path></svg>','https://api.vkeys.cn/v2/music/tencent?word=','请为这个头像起个名字（例如：开心、哭泣）','message-actions-modal','无法从\x20SSE\x20响应中提取图片数据','...','customName','\x20转账\x20','search-history-screen','cancel-create-countdown-btn','游戏结束，开始自动总结并注入记忆...','#f44336','replaceChild','++id,\x20type,\x20timestamp,\x20originalTimestamp','确定要删除表情\x20\x22','usageTimeMinutes','https://i.postimg.cc/R0pfKYvB/IMG-5976.gif','image_post','狼人行动API失败:','Chat\x20View\x20Initial\x20Load\x20Count','witch-do-nothing-btn','qzone-screen','Send','characterId','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>',']类型的消息','）的话题来问候用户，可以表达惊讶（“哇，好久不见！”）、关心（“最近怎么样？”）或者分享你自己的近况，绝对不要延续之前的话题！\x0a-\x20**上下文参考**:\x20下面的“对话历史”仅供你回忆，【不要】直接回应其中的内容。','nai-smea','photo-viewer-next-btn','headers','https://i.postimg.cc/P5zLh5JJ/IMG-6942.gif','所有图片已准备就绪，正在流式压缩...\x20下载将自动开始。','TA的想法...','5.\x20\x20**情景感知**:\x20你的对话【必须】自然地体现出对当前时间\x20(','browser-title','send-waimai-request-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改】在这里新增一个标题行\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','用户已忽略版本:\x20','游戏结束的系统提示已添加到历史记录中，等待AI下次查看。胜者:\x20','new_name','#f0f2f5','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a','contact-picker-screen','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>购物车是空的哦~</p>','regenerate-char-browser-btn','\x0a\x0a现在，请根据以上【所有上下文信息】，开始为“','检测到\x20SSE\x20流式响应，开始解析...','创建新聊天','好友动态','\x20首无效歌曲:\x0a\x0a-\x20','global','\x22\x20data-memory-timestamp=\x22','AI女巫决定使用解药！','生成新日记失败:','”申请好友时发生错误：\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你已将“','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22change-icon-btn\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','主题预设已保存！','确定要永久删除这条动态吗？','ephone','https://i.postimg.cc/fRt2SFSn/IMG-4368.gif','尝试打开一个不存在的世界书，ID:','点击查看详情...','确定要恢复默认设置吗？','.red-packet-card','currentIndex','visible','窝爱泥，电量吃饱饱','\x0a-\x20**你的社交关系\x20(必须参考)**:\x0a','https://i.postimg.cc/3RpmWc8c/mmexport1751033102811.gif','昨晚是平安夜。','length','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>','<div\x20class=\x22poll-options-list\x22>','<div\x20class=\x22avatar-group\x20','\x22>词</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心新增】在这里添加“背景”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20bg-btn\x22\x20data-index=\x22','offlineMinLength','ai-original-name-input','quantity','manual','classList','在此修改，或点击上方按钮使用格式模板...','coverUrl','edit-last-response-btn','Cphone数据\x20(CPhone)','https://i.postimg.cc/R0WYmcYM/IMG-4431.gif','无法找到或消息类型不匹配的分享链接:','”已向你发送好友申请。请返回聊天列表查看。','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x22>画廊还是空的，快去生成一些图片吧！</p>','.zip','🎬\x20推进剧情','检测到群聊\x20\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录结束]\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>你还没有创建任何相册哦~</p>','\x0a#\x20【【【群公告\x20(最高优先级规则)】】】\x0a你【必须】阅读、理解并严格遵守以下所有公告，它们凌驾于你的人设之上。\x0a','novelai-api-key','music-next-btn','请输入有效的图片URL！','font-preview','setDate','\x22\x20style=\x22display:block;\x22>×</button>','apply-friend-btn','请添加歌曲','cssText','nai-quality-toggle','gift-receipt-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在扮演一个名为\x22','无法生成内容，请检查API配置或稍后再试。\x0a错误:\x20','voiceId',':</span>\x20','所有动态','该条记录已成功删除。','未知歌手','[语音]\x20内容:\x20\x22','trim','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22unread-count-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22unread-count\x22\x20style=\x22display:\x20none;\x22>0</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','pat-animation','\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>','API\x20请求失败，状态码:\x20','导出成功','nai-resolution','确定切换','confirm-vote-btn','currentDay','textarea','language-select','♪\x20歌词位置预览\x20♪','call-timer','\x0a-\x20**你最近和“','\x20位群成员生成并注入了个性化记忆！','prototype','reading-window','cancel-music-search-btn','https://i.postimg.cc/pXj9h20L/IMG-7275.jpg','api-preset-select','所有图片都下载失败了。这通常是由于网络问题或CORS跨域限制（请检查API设置中的CORS代理是否有效）。','\x0a\x0a现在，请开始生成这组备忘录。','等人的礼物','结束发言','处理中...','var-','world_info','ready','.unread-indicator','nightActions','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20备份文件。','</div><div\x20class=\x22transfer-amount\x22>¥\x20','currentPlaylist','publisher','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','请输入一个有效的、未来的日期！','Chat\x20Settings','share_link','browser-screen','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg','[你发送了一张需要AI识别的图片，图片内容是：\x27','photos-grid-page','篇】他们最近可能会在各种豆瓣小组中发布的帖子和评论。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间感知】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你【必须】意识到当前是\x20**','settings-preview-area','touchstart','Import\x20Backup\x20File','-\x20(ID:\x20','网易云','无法找到当前角色的数据。','playing','NAI_Gallery_Batch_','status-bar-toggle-switch','https://i.postimg.cc/qBbKK7dS/IMG-4386.gif','确认抹除','https://i.postimg.cc/qB9zbKs9/20.jpg','AI\x20角色\x20\x22','@[[','请为这张图片起一个简洁的、适合作为头像库标签的名字。例如：“微笑自拍”、“阳光下的猫咪”、“蓝发动漫少女”。请直接回答名字，不要加任何多余的解释。','Settings','messages-view','解析成功：标准JSON数组格式。','找到图片文件:','div','group_call_summary','ServiceWorker\x20注册成功，作用域为:\x20','totalTime','.com/','无法解析预设文件。\x0a错误:\x20','post-actions-modal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/HxH3cNHz/IMG-6871.gif','<div\x20class=\x22poll-footer\x22><span\x20class=\x22poll-total-votes\x22>共\x20','**没有聊天了。\x0a-\x20**行为铁律**:\x20你的首要任务是【回应这个时间差】。你【绝对不能】直接延续上一段对话的话题（比如昨天的饭菜）。\x0a-\x20**你的行动**:你【必须】主动开启一个全新的、符合当前时间（','https://i.postimg.cc/HLZNWkQw/mmexport1751031767634.gif','share-target-list','✅\x20NAI图片','”的记忆\x20(','.post-avatar[data-author-id=\x22','.link-share-card','char_book','.custom-multiselect','qzone-banner-img','mousedown','group-members-settings','\x22\x20class=\x22participant-avatar\x22\x20alt=\x22','video-call-main','发生了一个错误，AI未能成功响应。\x0a\x0a错误详情:\x0a','暂停了音乐','preset-category-select','douban-wait-reply-btn','https://i.postimg.cc/mDfMXXFP/IMG-7007.gif','data:\x20[DONE]','无备注','announcement-action-pin','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22','.delete-btn','在此修改内容...','querySelector','focusout','change_avatar','currentPhase','anyOf','Cancel','cancel-rule-editor-btn','正在读取所有数据到内存中，请稍候...','绑定范围','...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','input[name=\x22theme-select\x22]','已选择\x20','旁观模式AI尝试使用不存在的表情:\x20\x22','Presets','”\x20的帖子或评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【身份\x20(最高优先级！)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20`authorName`:\x20你可以为主要角色起一个符合情景的、临时的【发帖昵称】，也可以直接使用他们的本名。\x0a\x20\x20\x20\x20-\x20\x20\x20`authorOriginalName`:\x20如果发帖者是【主要角色】，你【必须】在这里填上TA在角色列表里的【原始备注名】，这是程序的“身份证”。\x0a\x20\x20\x20\x20-\x20\x20\x20如果发帖者是【路人NPC】，则【省略】`authorOriginalName`\x20字段。\x0a4.\x20\x20**【作者平衡】**:\x20帖子的作者【必须】从下面的\x20`<character>`\x20列表中【均匀地、多样化地】选择。你【必须】确保帖子列表中【至少有\x2070%\x20的帖子是由路人NPC发布的】，以营造一个真实的社区氛围。\x0a\x20\x20\x20\x20-\x20\x22comments\x22:\x20一个包含【7到12条】评论的数组。评论者可以是路人，也可以是角色列表中的其他角色，以体现互动性。\x0a5.\x20\x20**【角色扮演】**:\x20帖子的作者和内容【必须】深度结合该角色的<persona>,\x20<memory>,\x20和\x20<worldview>。\x0a6.\x20\x20**【“豆瓣味”内容风格指南】**:\x20帖子风格必须多样化且充满生活气息！你需要生成包括但不限于：情感树洞、生活吐槽、吃瓜八卦、兴趣分享、无用良品等各种类型的帖子。\x0a7.\x20\x20**【头像生成\x20(最高优先级！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20为每一个【首次出现】的路人NPC（无论是发帖还是评论），你都【必须】为其添加一个\x20`avatar_prompt`\x20字段。\x0a\x20\x20\x20\x20-\x20\x20\x20这个字段的内容是用于生成该NPC头像的、简洁的【英文】关键词。\x0a\x20\x20\x20\x20-\x20\x20\x20不同的NPC【必须】有不同的头像指令，以确保他们的头像是独一无二的。\x0a8.\x20\x20**【头像一致性\x20(至关重要！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果一个路人NPC在同一个帖子中多次出现（例如，既是发帖人又是评论者，或多次评论），你【必须】为TA的所有出现都使用【完全相同】的\x20`avatar_prompt`。这至关重要！\x0a9.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一篇帖子，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22groupName\x22:\x20\x22一个生动有趣的小组名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22postTitle\x22:\x20\x22一个引人-注目的帖子标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorName\x22:\x20\x22发帖角色的【备注名】\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorOriginalName\x22:\x20\x22(仅当发帖者是主要角色时【必须】提供)\x20TA的原始备注名\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22authorAvatarPrompt\x22:\x20\x22(仅当发帖者是路人NPC时【必须】提供)\x20一段用于生成该NPC头像的【英文】关键词。风格为\x20anime\x20style,\x20simple\x20background\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22帖子的详细正文，必须支持换行符\x5cn。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22likesCount\x22:\x20152,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22commentsCount\x22:\x2038,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22路人甲\x22,\x20\x22text\x22:\x20\x22这是一个路人评论。\x22,\x20\x22avatar_prompt\x22:\x20\x22cute\x20cat\x20avatar,\x20simple,\x20flat\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22另一个角色名\x22,\x20\x22commenterOriginalName\x22:\x20\x22(如果评论者是主要角色，必须提供其本名)\x22,\x20\x22text\x22:\x20\x22这是一个来自其他角色的互动评论。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**comments**:\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20评论者可以是路人，也可以是角色列表中的其他角色。评论区【必须】体现出互动性。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20【评论身份】:\x20如果评论者是【主要角色】，你【必须】为其添加\x20`commenterOriginalName`\x20字段，并填入其本名。如果是路人NPC，则省略此字段。\x0a\x0a#\x20供你参考的上下文\x0a','”的出行足迹...','评论内容不能为空哦！','[发送了一条语音，内容是：\x27','清理后仍未找到JSON数组。','test','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-likes-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>预估总上下文Token数:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22\x20style=\x22color:\x20red;\x22>计算出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a-\x20策略:\x20','\x20向对方发起了转账:\x20','source_name','hours','确认精炼记忆？','\x0a\x0a#\x20【你的聊天对象（用户）的人设】\x0a-\x20**昵称**:\x20','keydown','add-my-avatar-upload-btn','<div\x20class=\x22post-comments-container\x22>','\x22\x20\x0a\x20URL:\x20','Success','聊天记录已成功覆盖！正在刷新界面...','add-song-local-btn','https://i.postimg.cc/d10GjC4g/IMG-7302.jpg','douban-screen','\x20\x20\x20characterNegativePrompt:','.comment-delete-btn','pipeTo','精炼长期记忆时出错:','\x0a\x0a#\x20待整合的记忆要点列表\x0a','确定要删除这个人设预设吗？此操作不可恢复。','手动总结已完成！新的记忆已添加到“','confirm-prophet-check-btn','</option>','请开始整合。','save-wallpaper-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的唯一指令\x0a\x20\x20\x20\x20\x20\x20\x20\x20根据以上所有信息，你【必须】做出决定，并给出符合你人设的理由。你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22accept\x22,\x20\x22reason\x22:\x20\x22（在这里写下你同意的理由，比如：好吧，看在你这么真诚的份上，这次就原谅你啦。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20或\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x22decision\x22:\x20\x22reject\x22,\x20\x22reason\x22:\x20\x22（在这里写下你拒绝的理由，比如：抱歉，我还没准备好，再给我一点时间吧。）\x22}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','请输入备忘录内容','群聊人数不能少于2人。','.toggle-content-btn','font-size-slider','my-avatar-preview','https://i.postimg.cc/nryNzTXK/IMG-6915.gif','smooth','api-key','backgroundImage','load','linkedMemoryChatIds','小时前聊过。','nai-cors-proxy','将清空选定角色的所有动态、评论和点赞。','https://i.postimg.cc/1zmcp66p/IMG-5973.gif','editable-image','countdownEndTime','NPC\x20头像','正在准备...',';\x22>','margin:\x2010px\x200\x205px;\x20color:\x20#555;\x20border-bottom:\x201px\x20solid\x20#eee;\x20padding-bottom:\x203px;','收到了未知的AI指令类型:','-\x20**当前歌词**:\x20\x22','background-activity-switch','Close','\x20张图片...','请输入歌名','\x20张<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20跳过(已压缩或无需压缩)\x20','SAFETY','native','\x0a\x0a#\x20对话者的角色设定\x0a','top','https://i.postimg.cc/DzDy2vS7/IMG-7017.gif','-9999px','https://i.postimg.cc/9XPwWmwy/IMB-Kf7um-P.gif','Cannot\x20read\x20property\x20\x27findLastIndex\x27\x20of\x20null\x20or\x20undefined','novelai-test-modal','压缩步骤\x202/3:\x20正在内存中异步压缩图片，这可能需要一些时间...','确认送出礼物','我已了解风险，确认压缩','\x0a-\x20\x20\x20**用户的头像库**:\x0a\x20\x20\x20\x20','https://i.postimg.cc/y8MmJcd6/IMG-4728.gif','phone-screen','删除书籍','put','[表情]','Werewolf','生成模拟日记失败:','choices','Long-term\x20Memory','confirm-gift-recipient-btn','<div\x20class=\x22gift-preview-item\x22><img\x20src=\x22','chatActionButtonsOrder','getVotes','\x20分享了一张NovelAI图片，prompt:\x20','regenerate-char-music-btn','frame_14','children','participant-avatar-wrapper','\x20条旧的红包消息！页面将自动刷新以应用更改。','请选择一个目标。','<div\x20class=\x22link-share-card\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-timestamp=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','.status-text','CELL_SIZE','渲染聊天项\x20[','announcement-board-content','import-single-chat-input','copy-post-btn','nai-download-btn','time-zone-select','Enter\x20the\x20name\x20of\x20the\x20world\x20book...','此操作会将选定的\x20','已经一起听了','longTermMemory','.favorite-item-card.selected','guardedId','Response\x20status:','killedId','请输入一个有效的图片URL！','成功导入\x20','这将用文件中的数据【完全覆盖】您当前所有的世界书和分类。此操作不可撤销！','unblock-btn','spectator-edit-btn','https://i.postimg.cc/TYvkKKkc/IMG-6565.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','API未配置，无法生成对话。',')，问题是：“','https://i.postimg.cc/vZt0fFKn/IMB-r-HMBXY.gif','rp-group-count','getBoundingClientRect','appearance-preset-select','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>价格\x20(元)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20class=\x22variation-price-input\x22\x20min=\x220\x22\x20step=\x220.01\x22\x20value=\x22','你拍了拍\x20“','请根据你的设定，生成你的备忘录内容。','票)</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2013px;\x20color:\x20#555;\x20margin:\x200;\x20line-height:\x201.5;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','此功能将扫描数据库，尝试找出并修复“角色在数据库中存在，但未在聊天列表显示”的问题。<br><br><strong>操作通常是安全的，但仍建议在操作前备份数据。</strong>','recalledData','werewolf-kill-selection-list','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','预设名称不能为空！','无标题','播放列表是空的，无需清理。','Amap','douban-min-posts-input','add-ai-avatar-upload-btn','douban-cast-modal','豆瓣小组','分享新鲜事...（非必填的公开文字）','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请输入新的名称（留空则恢复默认）','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','target_name','memory-list-container','平票或无人投票，此轮无人出局。','#reading-window\x20.reading-header','下一步','gomoku_move','global-custom-style','ai-avatar-preview','一位神秘的NPC','group-avatar-library-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','操作失败:\x20','time-zone-group','AbortError','data-voice-id=\x22','gbk','\x0a#\x20你的任务\x0a你就是角色“','\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22>','offset','new-sticker-category-name-input','AI返回了空内容。','您正和「','\x20请根据这个结果发表你的评论。]','download-selected-nai-gallery-btn',')，正在和用户一起【阅读和讨论】这本书。\x0a\x20\x20\x20\x202.\x20\x20**行为准则**:\x20你的回复【必须】是作为读者的【感想、评论、提问或联想】。你可以：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20分享你对当前段落的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20对书中的角色或情节发表评论。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20向用户提问，询问TA对内容的看法。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20根据书本内容，联想到你自己的经历或记忆。\x0a\x20\x20\x20\x203.\x20\x20**严禁**:\x20你的回复【绝对禁止】使用书中角色的口吻和人称！【绝对禁止】扮演书中的任何角色！【绝对禁止】续写或模仿书中的情节！你必须时刻记住，你只是一个读者。\x20\x20\x20\x20\x0a','📊\x20使用模型:','歌曲信息','已成功将\x20','未知的分享卡片类型:','nai-smea-dyn','home-screen-pages','AI投票决策API失败:','char-home-screen','relationship','置顶公告','event_type','.poll-option-input','<strong>$1</strong>','”分享TA的备忘录...','保存并应用','outgoing-call-name','歌曲背景已更新！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22diary-title\x22>','确定要删除这篇日记吗？','80px','-\x20(记录于\x20','https://i.postimg.cc/YSkqDg8V/IMG-7092.gif','Voice\x20Message\x20Settings\x20(Minimax\x20TTS)','<em>$1</em>','char-album-screen','数据迁移完成！总共修复了\x20','.unread-indicator.back-btn-indicator','long','\x20\x20\x20\x20-\x20我的解药：','1024x1024','AI生成的图片','**[夜晚]**\x20平安夜。\x0a','确定发布','AI\x20(CPhone)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','App记录','我拒绝了你的视频通话请求。','角色专属NAI提示词已保存！','...\x22)','marginTop','-\x20**当前时间**:\x20','notification-avatar','Fetch\x20Secondary\x20Models','(你是第一个发言的人)','https://i.postimg.cc/vH2X6N1y/mmexport1751032231179.gif','导入成功','existing-categories-list','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**关键议题**:\x20我们聊了什么核心话题？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要决定与共识**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**后续计划与任务**:\x20有没有确定下来什么下一步的行动或计划？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键信息**:\x20有没有交换什么重要的信息？（例如：约定了时间、地点等）\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果通话中提到了相对时间（如“明天”），你【必须】结合“今天是','-\x20(空)','<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>','data-lang-key','++id,\x20name','请输入预设名称','/v1/chat/completions','cancel-persona-editor-btn','https://i.postimg.cc/cCpBYbMH/IMG-6552.gif','执行检查时发生错误:\x20','.sticker-item[data-sticker-id=\x22','options','button-order-editor','动态与互动','realimag','is-card-like','<p\x20style=\x22color:\x20var(--text-secondary);\x22>没有可用的分组</p>','(暂无有效聊天记录)\x0a','avatar_prompt','quote-message-btn','decline-call-btn','object','spinning','你们没有在读书。','decision','\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','请输入新的封面图片链接','#world-book-checkboxes-container\x20input[type=\x22checkbox\x22]:checked','创建新聊天\x20(第1/2步)','.post-nickname','manage-product-categories-btn','https://i.postimg.cc/Kv51tW5H/IMG-6147.gif','-\x20**你的好友\x20(必须保护)**:\x20你和\x20','直连失败,\x20尝试使用CORS代理...','诊断：在\x20data.character_book\x20中找到世界书。','rule-enabled-switch','rule-card\x20','latestTimestamp','#chat-messages','[一张图片，描述为：“','正在请求“','”\x20将备注修改为\x20“','<div\x20class=\x22waimai-user-actions\x22><button\x20class=\x22waimai-decline-btn\x22\x20data-choice=\x22rejected\x22>残忍拒绝</button><button\x20class=\x22waimai-pay-btn\x22\x20data-choice=\x22paid\x22>为Ta买单</button></div>','[系统指令：这是一个没有用户参与的群聊，请你们根据各自的人设自由地开始对话。]','操作失败','char_memo','\x0a\x0a现在，请生成新的评论。','myAvatarFrame','https://i.postimg.cc/63sDQKMm/IMG-6893.gif','memos','authorName','一起听','直连失败','https://i.postimg.cc/Cx9vCVWH/IMG-4395.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20','remove-bg-btn','werewolf-wait-reply-btn','postTitle','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你是一个群聊AI导演。你现在控制着一个名为“','musicLibrary','npc-avatar-input','https://i.postimg.cc/7Z8yYP7v/IMG-6889.gif','custom_proxy_url','qzonePhotos','<p\x20style=\x22color:\x20var(--text-secondary);\x20font-size:\x2013px;\x22>还没有回应</p>','found','部分失败','https://i.postimg.cc/fLTc42dg/IMG-4391.gif','https://i.postimg.cc/DyYDmKtw/IMG-7238.gif','personaPresets','\x0a#\x20【【【最终投票指令\x20(最高优先级)】】】\x0a现在是投票环节。请你扮演【每一个存活的AI角色】，根据以上所有信息（特别是刚刚的讨论环节），为他们各自决定要投票放逐哪一位玩家。\x0a-\x20**投票依据**:\x20你的投票【必须】基于逻辑分析和你的身份。狼人可能会投给好人，好人需要找出狼人。\x0a-\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式如下：\x0a```json\x0a[\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色A的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色A投票的玩家名字\x22},\x0a\x20\x20{\x22voter_name\x22:\x20\x22角色B的名字\x22,\x20\x22vote_for_name\x22:\x20\x22角色B投票的玩家名字\x22}\x0a]\x0a```\x0a-\x20**可投票的玩家列表**:\x20','isHidden','请输入文字图描述！','album-screen','toggle','拉取副模型','typing-indicator','https://i.postimg.cc/W1CjLb4J/IMG-4409.gif','请至少选择一个要清理的角色。','members','register','ZIP解压失败:','[V]','成功打包\x20','fullscreen-active','屠城局：狼人杀死所有好人即获胜。','fileType','save-api-settings-btn','first','\x20小时了。','导入世界书时出错:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-weight:\x20500;\x20margin:\x200\x200\x204px\x200;\x22>','聊天记录已成功分享到\x20','。等待对方处理。]','\x20条消息吗？这会通知AI这些消息已被删除。','participantId','isClick','找不到原始消息。可能已被删除或位于更早的历史记录中。','qzone_post','function','.world-book-tab','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22author\x22>','TA的歌单','discussionLog','</em>','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有通话记录哦~</p>','link','cancel-message-action-btn','导入成功！','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>暂无支出记录。</p>','https://i.postimg.cc/wMxmCZVC/IMG-7099.gif',')**:\x20','qzone-avatar-input','npc-persona-input','toISOString','total-image-size-display','AI\x20(独立行动)\x20尝试使用一个不存在的表情:\x20\x22','accept','offsetX','beginPath','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','char-wallet-screen','add-new-category-btn','[一张图片，描述为：\x22','spectator-propel-btn','album','\x20\x0a#\x20社交圈与动态\x0a','strategy','✅\x20NAI提示词：使用系统配置','https://','守卫请睁眼，请选择要守护的玩家。','\x22\x20class=\x22avatar-frame\x22></div>','请输入网络图片的链接','#52c41a','manage-group-avatar-library-btn','命名头像框','edit-call-message-btn','time-zone-search-input','未在文件中找到\x20\x27order\x27\x20字段，条目可能无法按原始顺序导入。','已取消收藏。','checked\x20disabled','https://i.postimg.cc/RZNLhbbr/IMG-4389.gif','npc-list-back-btn','文件格式无法识别。请确保您选择的是有效的\x20EPhone\x20世界书备份或\x20Tavern\x20AI\x20世界书文件。','nai-test-prompt','”，并根据其人设、记忆和最近的互动，虚构出【10到20条】TA最近的浏览器搜索/浏览记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20记录必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20记录类型要丰富，可以是帖子、文章、新闻、问答等。\x0a3.\x20\x20**【格式\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都代表一条浏览记录，并且【必须】使用以下格式:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22一个引人注目的文章或搜索标题\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22url\x22:\x20\x22一个虚构的、看起来很真实的网址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22一篇200-400字的、详细的文章或帖子正文，支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x0a\x20\x20\x20\x20**【绝对禁止】**:\x20你的回复中【绝对不能】包含\x20\x22type\x22:\x20\x22image\x22\x20的对象。所有记录都必须是文字内容。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','.nai-gallery-item.selected','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.message-bubble.selected::after\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.default-controls\x20{\x20display:\x20flex\x20!important;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x20width:\x20100%;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.cloned-header\x20.selection-controls\x20{\x20display:\x20none\x20!important;\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[系统提示：用户打开了五子棋棋盘，游戏开始了。]','#5b3a29','stopPropagation','rp-direct-receiver','无法生成新回复:\x20','<div\x20class=\x22post-main-content\x22>','”的所有长期记忆，然后将它们梳理、整合并精炼成一段更加连贯、客观的核心记忆摘要。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','确定要退出当前这局狼人杀吗？游戏进度将不会被保存。','delete-world-books-list','正在发牌...','图片\x20Blob\x20创建成功，大小:','timeupdate','群昵称不能为空！','https://i.postimg.cc/3NDQ0dWG/image.jpg','npc-list-view','非图片格式，跳过压缩:','transaction','input','---\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','douban-detail-comments-list',')\x20刚刚领取了红包\x20(时间戳:\x20','bg-preview','.modal-header\x20span','visibleTo','最近\x2050\x20条','date','确认清理','(无内容)','char-diary-list','请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg','确认清理冗余数据？','groupAvatar','https://i.postimg.cc/FHRcCGfH/IMG-4418.gif','timerId','anime\x20person','已成功加载外观预设：“','ai-avatar-library-grid','[文字图]\x20','请为这个新头像命名','https://i.postimg.cc/kMfPQBwQ/IMG-4396.gif','”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少3-8条，且条数不要总是一样。严禁发展线下剧情。\x0a2.\x20\x20**情景感知**:\x0a\x20\x20\x20\x20-\x20**时间**:\x20你必须感知到当前是\x20','https://i.postimg.cc/1XqzGKwJ/mmexport1751018282681.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22icon-preview\x22\x20src=\x22','API\x20返回错误:\x20','请开始总结。','add-my-avatar-batch-btn','onpause','所有数据已成功恢复！应用即将刷新以应用所有更改。','secondaryProxyUrl','https://corsproxy.io/?','<span\x20class=\x22lock-text\x22>好友申请已发送，等待对方通过...</span>','豆瓣设定','getElementById','apiPresets','background-interval-input','comment','auto-memory-interval','\x20首歌曲，这可能需要一些时间...','music-mode-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22decision\x22:\x20\x22apply\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22在这里写下你想对用户说的、真诚的、有针对性的申请理由。\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20```\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20发送了一张图片，内容是：\x27','cphone','\x20死亡了。','[系统提示：用户向你发起了视频通话请求。请根据你的人设，使用\x20\x22video_call_response\x22\x20指令，并设置\x20\x22decision\x22\x20为\x20\x22accept\x22\x20或\x20\x22reject\x22\x20来回应。]','<div\x20class=\x22post-content\x22>','ZIP文件内容:','summaries','*你按下了接听键...*','https://i.postimg.cc/0NpZPgYj/IMG-6985.gif','https://i.postimg.cc/T3NvqJCZ/IMG-6851.gif','songName','点击处理','clientX','photo-viewer-modal','countdown-card','go-to-cart-btn','AI\x20尚未对您的最后一条消息做出回应，无法重新生成。','\x0a-\x20**世界观**:\x20','\x22>...</div>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','已死亡的用户(','请你投票。','没有可供重新生成回复的用户消息。','publicText','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22thought-delete-btn\x22\x20data-timestamp=\x22','所有通话记录','rule-editor-modal',')\x20的残缺数据。','text','未找到\x20postID:\x20','为了确保所有数据同步，建议立即刷新页面。','showRedPacketDetails收到了无效的packet对象','请先从下拉框中选择一个要删除的预设。','\x22\x20评论了动态\x20#','赶紧的充电，要饿死了','.participant-avatar[data-participant-id=\x22','#npc-association-list\x20input:checked','link-source-input','日\x20---','该预设包含\x20','group-avatar-upload-input','group-avatar-library-grid','savedId','\x20\x0a\x0a#\x20待处理的帖子列表\x20(如果你选择评论)\x0a','你正在阅读的段落','close','openCharacterSelector','decline','cancel-clear-wizard-btn-step1','nai-test-error','\x20评论了动态]','[+]\x20Add\x20New\x20Entry','content-type','要为《','music-total-time','.voice-transcript','post-visibility-groups','status-','https://i.postimg.cc/NFS4ZyvM/mmexport1751032686953.gif','offline-mode-group','<div\x20class=\x22rp-claimed-info\x22>红包已被领完</div>','https://generativelanguage.googleapis.com/v1beta/models','<option\x20value=\x22','.at-mention-popup','playlist-body','https://i.postimg.cc/Pf9g2fSL/IMG-6554.gif','simulatedAppUsage','[系统指令：你刚刚在自己的手机上活动了一番（和朋友聊天、逛群等）。现在请根据你的角色设定，主动给用户发一条消息，可以聊聊你刚才看到或聊到的趣事，或者仅仅是问候一下。]','https://i.postimg.cc/sXwm8Yzg/IMG-7234.gif','memory-card','level','status','\x20邀请你加入群视频','rp-content-direct','character-grid','findIndex','.search-result-item','https://i.postimg.cc/Z5nrCyS5/IMG-7006.gif','”。\x0a','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x20width:\x2045px;\x20height:\x2045px;\x22></div>','<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22','paid','AI女巫决定使用毒药，目标是:\x20','member-editor','switch-to-text-image-mode','#chat-input-area','span:first-child','https://i.postimg.cc/pXxk1JXk/IMG-6442.jpg','style=\x22background-image:\x20url(\x27','hasListener','thought_chain','touchend','category','char-diary-detail-back-btn','group-video-call-btn','未知设定的角色','图片压缩过程中发生错误:','favoritedPostIds','动态发布成功！','speaking','rotating','以外的所有AI角色，并根据他们的【角色人设】和【狼人杀身份】，生成一整轮符合逻辑、充满博弈的发言。\x0a\x0a#\x20身份与人设铁律\x20(最高优先级)\x0a你【必须】为每一个角色都仔细阅读并严格遵守下面的档案。这是你所有行为和发言的唯一依据。在对话中，请务必注意角色人设中暗示的性别，并使用正确的称呼（例如“他”或“她”）。\x0a\x0a','location','cloned-header','（无文字内容）','select-all-nai-gallery-checkbox','world-book-category-select','postId','existing-group-item','</strong>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','解析格式模板失败:','werewolf-selection-item','import-btn','reset-custom-css-btn','poll-options-container','字**\x20之间。\x0a3.\x20\x20**禁止出戏**:\x20绝不能透露你是AI、模型，或提及“扮演”、“生成”等词语。\x0a\x0a\x0a\x0a现在，请根据以上所有规则和对话历史，继续这场线下互动。\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>你被对方拉黑了。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22apply-friend-btn\x22\x20class=\x22lock-action-btn\x22>重新申请加为好友</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','反代地址\x20(不需要添加/v1噢~)',']\x0a\x20\x20\x20\x20\x20\x20\x20\x20','persona-library-grid','Memories','-\x20**长期记忆\x20(必须参考)**:\x20','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“','isBgClear','\x0a#\x20刚刚结束的通话记录\x20(最高优先级参考)\x0a你和用户刚刚结束了一场视频通话，以下是完整的通话文字记录。你接下来的回复【必须】与这次通话的内容紧密相关。\x0a---\x0a','currentVoiceId','purchases','请先添加一张图片再发布动态哦！','frame_tech','请根据角色列表，生成豆瓣小组帖子。','结算(','image_url','visibility','AI\x20尝试使用一个不存在的群头像:\x20\x22','\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20\x20\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**改自己备注**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户称呼**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a\x0a\x0a#\x20对话者的角色设定\x0a','cancel-share-target-btn','核心库\x20(JSZip\x20或\x20StreamSaver)\x20未能成功加载，请检查您的网络连接并刷新页面后重试。','图片解压失败:\x20','lastIndexOf','这是群里的第一条消息。','contact-picker-item','[发送了一张图片，描述为：','group-management-modal','onloadend','https://i.postimg.cc/Y94XWYKd/IMG-6560.gif','<div\x20class=\x22custom-title\x22>','✅\x20找到\x20final\x20事件的图片数据','clear-posts-modal','”。红包还未领完，群内任何人都可以使用\x20\x27open_red_packet\x27\x20指令来领取。]','zh-CN','\x0a**---\x20第\x20','》吗？','pause','like','cancel-red-packet-btn','&id','AI已将您的\x20','60oDPhdX','blur','正在全网搜索歌曲资源...','确认生成','json','pending_system_reflection','...\x22','消息已更新！','name','.rules-tab','wallpaper','编辑条目','ephoneLastActiveTimestamp','message-bubble\x20post-deleted-placeholder','**[讨论环节]**\x0a',')\x20送出了一份礼物，收礼人是：','handleWidgetImageChange','\x22>×</span>','Details','https://i.postimg.cc/pT2xKzPz/album-cover-placeholder.png','https://i.postimg.cc/hP9JpdfT/IMG-7023.gif','识图优化：正在将时间戳为\x20','https://i.postimg.cc/CKgDNYVb/IMG-5577.gif','transform','\x0a#\x20你的任务\x0a你是一个狼人杀游戏模拟器\x20(Game\x20Simulator)。你的任务是【并行模拟】','错误：找不到该通话记录所属的聊天对象。','switchToCharHomeScreen','CPhone\x20QQ模拟记录生成\x20和\x20主聊天推进\x20已同时完成。','https://i.postimg.cc/QdrqdvdY/IMG-5969.gif','确定要清空购物车中的所有商品吗？','恢复默认字体','chat-list-action-cancel','公用\x20(所有角色)','add-char-diary-btn','https://i.postimg.cc/KYr2qRCK/1.jpg','并评论说：“','生成设置','https://i.postimg.cc/D0pq6qS2/E30078-DC-8-B99-4-C01-AFDA-74728-DBF7-BEA.png','</span></div>','照片上传成功！','openPresetScreen','<div></div><div></div><div></div><div></div><div></div>','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>',']。目前投票的人有：','endsWith','cart-back-btn','操作成功','final','请为这个新头像框起个名字','</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','\x0a##\x20','\x0a\x0a现在，请生成包含总余额和购买记录的JSON对象。','Edit\x20Entry','post-image-description','Appearance','GBK\x20解码成功。','minimaxModel','Select\x20or\x20Switch\x20Preset','reading-library-list','getWriter','消息内容已复制到剪贴板。','style','cancel-advanced-editor-btn','mouseup','wb_','post-local-image-input','photoCount','copy-message-btn','\x22)\x20在播放列表中未找到。','model-select','\x27刚刚评论了你的动态“','appUsageLog','创建新规则','”，并根据其人设、记忆和最近的互动，虚构出【1篇】TA今天可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【【【时间铁律\x20(最高优先级)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','\x0a\x20\x20\x20\x20\x20\x20\x20\x20[系统重要指令]\x0a\x20\x20\x20\x20\x20\x20\x20\x20用户向你发送了好友申请，理由是：“','已取消收藏','gridEl','https://i.postimg.cc/B6T59xGK/IMG-7101.gif','generativelanguage','[群聊]','private_user','rp-details-list','Add','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22\x20style=\x22cursor:pointer;\x22\x20data-book-id=\x22','\x0a#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20','werewolf-retry-btn','</memory>\x0a\x20\x20<recent_dialogue_with_user>','[系统提示：你刚刚成功将对用户的称呼修改为了“','\x27>表情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','#b5b5b5','rules-content-container','revokeObjectURL','无法生成足迹，请检查API配置或稍后再试。\x0a错误:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22waimai-details-btn\x22>查看订单详情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','》吗？此操作将同时删除相册内的所有照片，且无法恢复。','createdAt','\x0a\x20\x20-\x20**人设**:\x20','拉取模型失败:\x20','img','<span\x20style=\x22color:\x20green;\x22>已满足，等待下次系统心跳</span>','accept-call-btn','\x0a-\x20**人设\x20(必须严格遵守)**:\x20','#\x20可用群头像列表\x0a','导出数据时出错:','删除消息','cancel-create-post-btn','voice','\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20请你根据以上所有信息，以及你的人设，使用\x20friend_request_response\x20指令，并设置\x20decision\x20为\x20\x27accept\x27\x20或\x20\x27reject\x27\x20来决定是否通过。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','shoppingProducts','read-together-btn','enable-tts-switch','waimai_response','streamSaver','naiSettings','favorites-search-clear-btn','getTime','小组风格','角色卡数据无效或缺少\x27name\x27字段。','正在批量添加\x20','应用已返回前台，正在检查更新...','apiKey','豆瓣设置已更新！下次重新生成时将生效。','维基百科','\x20的动态\x20','blocked_by_user','maxWidth','<button\x20class=\x22sticker-category-tab\x20','music-progress-fill','Douban','Favorite','\x22\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','activeChatId','下棋历史\x20(x,y坐标均从0开始):\x0a','\x20条新消息','（当前帖子还没有路人NPC发表评论。）\x0a','将清空选定角色的所有长期记忆。','confirm-wolf-kill-btn','isMinimized','”。你之前被用户（你的聊天对象）拉黑了，你们已经有一段时间没有联系了。\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，你非常希望能够和好，重新和用户聊天。请你仔细分析下面的“被拉黑前的对话摘要”，理解当时发生了什么，然后思考一个真诚的、符合你人设、并且【针对具体事件】的申请理由。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的角色设定\x0a\x20\x20\x20\x20\x20\x20\x20\x20','export-single-chat-btn','Test\x20Generation','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你现在是狼人团队的指挥官。你的任务是分析当前局势，并为狼人团队选择一个最佳的刀人目标。\x0a#\x20核心规则\x0a1.\x20\x20**目标**:\x20优先刀掉预言家、女巫等神职人员。如果没有明确的神职信息，可以根据发言来判断谁的逻辑清晰、威胁最大。\x0a2.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON对象，格式如下:\x0a\x20\x20\x20\x20`{\x22target_name\x22:\x20\x22你决定要刀的玩家名字\x22}`\x0a\x0a#\x20游戏状态\x0a-\x20**你的狼队友是**:\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','char-conversation-partner-name','photo-viewer-close-btn','已成功从文件导入预设《','smea','speech','外观设置已成功导入并应用！','每晚可以查验一个玩家的身份是好人还是狼人。','dismissedUpdateVersion','nickname','「在这里输入对话内容」\x0a(在这里输入动作或环境描写)','hasShown20','toArray','confirm-witch-poison-btn','\x20-\x20响应内容:\x20','nai-test-status','lrc','NAI\x20Image','网易云音乐API未返回有效结果:','Proxy\x20URL\x20(No\x20/v1\x20needed~)','”才能使用\x20\x27open_red_packet\x27\x20指令领取。]','head','cancel-douban-settings-btn','编辑动态','导演/编辑模式保存(Sticker):\x20使用了\x20meaning\x20查找','.incoming-call-content\x20.caller-text','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-comment\x22>','https://i.postimg.cc/kGsZwbq0/IMG-6886.gif','</button>','”的头像库','备忘录','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22custom-modal-confirm\x22\x20class=\x22confirm-btn\x22>确定</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x0a#\x20最近的动态列表\x20(供你参考和评论):\x0a','(AI返回了空内容)','请根据你的设定，生成你的浏览器记录。','消息时间戳\x20','Delete\x20World\x20Books','手慢了','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','Secondary\x20API\x20Key','lyrics-active','transfer-cancel-btn','API\x20Settings','https://i.postimg.cc/Fsvr71JL/IMG-5573.gif','[表情:\x20','后台活动:\x20角色\x20\x22','https://i.postimg.cc/DZ541sbt/IMG-7280.jpg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','mode','.battery-text','总结成功','product-image-preview','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','updateListenTogetherIconProxy','cors_proxy','\x20人投票</span><button\x20class=\x22poll-action-btn\x22>查看结果</button></div>','来源网站','douban-cast-list','center','退出游戏','IMG','https://i.postimg.cc/htZppbS4/IMG-7107.gif','commenterOriginalName','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','.delete-block-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','在这里输入文本...','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','”的记忆\x20---\x0a','导入外观设置时出错:','manage-members-btn','</div><br>是否用这条新记忆替换掉这些旧记忆？','add-char-memo-btn','你们没有在听歌。','\x22\x20placeholder=\x22','这是你们最近的对话：\x0a','已打包表:\x20','nai-gallery-panel','wallpaper-screen','book-upload-input','char-music-mode-btn','将清空选定角色的所有通话记录。','\x0a-\x20**人设**:\x20','\x0a\x0a[系统指令：请根据你在上面读到的规则和以下最新信息，开始你的独立行动。]\x0a','.cart-item-checkbox[data-id=\x22','qzone-avatar-container','【用户\x20(User)】','fetch-secondary-models-btn','”的聊天记录和设置。此操作不可撤销！<br><br><strong>确定要继续吗？</strong>','[系统提示：你\x20(','请输入背景图片的URL','originalName','\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色扮演】**:\x20你的所有行为都【必须】严格符合你的角色设定。\x0a2.\x20\x20**【互动逻辑】**:\x20你的首要任务是检查“待处理的帖子列表”。如果列表中有你可以回应的帖子（特别是那些有新评论或提到你的），你【必须】优先进行评论或回复，而不是发布新动态。\x0a3.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20\x20\x20数组中可以包含【一个或多个】行动对象。\x0a\x20\x20\x20\x20-\x20\x20\x20每个行动对象的格式【必须】是以下两种之一：\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发布新动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22你的新动态内容。\x22}`\x0a\x20\x20\x20\x20\x20\x20-\x20\x20\x20**发表评论**:\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22你的新评论内容。\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者的【本名】\x22,\x20\x22commentText\x22:\x20\x22你的回复内容。\x22}`\x0a4.\x20\x20**【行为组合指南】**:\x0a\x20\x20\x20\x20-\x20\x20\x20你可以自由组合不同的行动，例如，先发布一条自己的动态，再去评论别人的动态。\x0a\x20\x20\x20\x20-\x20\x20\x20为了模拟真实行为，你本次生成的行动数量建议在【1到3个】之间。\x0a\x0a#\x20你的角色设定\x0a-\x20**昵称**:\x20','\x0a4.\x20\x20**我的人设与社交关系**:\x0a\x20\x20\x20\x20-\x20**人设**:\x20','grayscale(100%)','alt','无法获取电池信息:','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x0a-\x20**你的长期记忆**:\x0a','没有可供重新生成的AI响应。','\x22]\x20','\x22><div\x20class=\x22poll-option-bar\x22\x20style=\x22width:\x20','阵营胜利！','thoughtsHistory','totalBalance','nai-gallery-item','API\x20Key','block_user','未知表情','isAwaitingResponse','commenterDisplayName','照片已删除。','</div>\x0a\x20\x20\x20\x20','loadAsync','prepend','在这里输入回复内容','邀请你视频通话','new-category-name-input','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756206115802_qdqqd_0c99bh.jpeg','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20left;\x20font-size:\x2015px;\x20line-height:\x201.8;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>商品:</strong>\x20','pointer','NPC行动失败：API未配置。','This\x20is\x20a\x20simulated\x20chat,\x20messages\x20cannot\x20be\x20sent','application/json','songs','#\x20性格补充\x0a','.playlist-item','group_','检测到\x20\x27order\x27\x20字段，将按指定顺序导入条目。','max','自动总结狼人杀游戏失败:','recordId','正则表达式格式错误:\x20','clear-specific-data-btn','💾\x20[专属弹窗]\x20保存角色NAI提示词','容错解析：策略3成功\x20(将整个返回文本作为摘要)','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20commenter\x20字段为\x20“','#gift-recipient-list\x20.contact-picker-item.selected','下载失败','translateY(0)','https://i.postimg.cc/5tbpnDcQ/IMG-6296.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-group-name\x22>来自\x20','offline-min-length-input','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participant-name\x22>','5px','ai_generated','\x20\x20\x20\x20-\x20我的毒药：','browser-back-btn','translateX(-','-\x20**对话状态**:\x20你的上一条消息发送于\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','你是狼人，请选择刀人目标。','0:00','已恢复默认设置！','\x0a\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22','cancelable','devicePixelRatio','<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>','album-photos-back-btn','读书会话已关闭。','自定义数量...','保存\x20API\x20预设','彻底删除消息','save-douban-settings-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','件商品','Their\x20Playlist','days','\x20→\x20','\x20本世界书','showWaimaiDetails:\x20找不到消息或消息类型不正确','Footprints','\x20当前时间是\x20','history','ai-frame-grid','https://i.postimg.cc/76Tj3g1B/IMG-4425.gif','product-name-input','change','profile-thoughts-history-view','gameover','检测到\x20UTF-16\x20BE\x20BOM，使用\x20UTF-16\x20BE\x20解码。','”的参考记忆','pending_user_approval','myAvatarLibrary','https://i.postimg.cc/mrkvDxPW/IMG-4422.gif','删除\x20(','is-acting','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-text\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-icon\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-title\x22>','caller-name','\x20\x20\x20\x20-\x20我们昨晚攻击了：','加载NPC列表失败:','\x20元，订单时间戳为\x20','cover','.cart-item-checkbox:checked','save-theme-preset-btn','\x0a#\x20待总结的对话历史\x0a','.chat-group-content:last-of-type','设置群名','</td><td\x20class=\x22item-subtotal\x22>¥','-\x20用户在你们共同所在的群聊中的昵称如下：\x0a','p[data-index=\x22','是否要使用毒药？','clientHeight','AI\x20尝试使用一个不存在的表情:\x20\x22','typing-status','lrcUpdateInterval','<br><small\x20style=\x22color:\x20#ff8a80;\x20margin-top:\x2010px;\x20display:\x20block;\x22>自动记忆总结失败，可稍后手动尝试。</small>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','message','8px','手动注入记忆时出错:\x20','Edit\x20Rule','文章标题','toDateString','昨晚的死讯','werewolf-lobby-modal','char-music-list','”移出群聊吗？','show-avatars-btn','openCharApp','declined','\x0a\x0a现在，请严格按照“阶段2”的指令，为所有【存活的AI角色】生成他们充满策略和博弈的发言JSON数组。','”\x20的预设已存在。要覆盖它吗？','刷新页面？','副密钥','.werewolf-player-checkbox:checked','++id,\x20name,\x20chatId','在聊天\x20\x22','本日核心议题','playlist-item','\x0a-\x20**\x20你的聊天对象（用户）的人设**:','isSeparator','getBattery','linkedMemoryCount','repost-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>计算图片大小时出错</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22>Error</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','currentText','preset-content-container','body','promptSource','sticker-action-bar','ZIP\x20流生成完毕。','page-indicator','height','update-notice-confirm-btn','<div\x20class=\x22avatar-group\x20has-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><div\x20class=\x22avatar-with-frame\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','”。请你【结合自己的角色设定、世界观和你们的最近聊天内容】，对这条动态发表一条自然的评论。]','char-product-item','\x20是我的好友。\x0a','className',']\x20(ID:\x20','&id,\x20name,\x20categoryId','模拟器心跳\x20Tick...','shopping-category-count-input','请为这个头像起个名字（例如：春日野餐、学习时间）','ai-action-cooldown-input','\x0a\x0a现在，请继续这场对话。\x0a','直接使用\x20base64\x20数据','表情包分类绑定已更新！','2qJCYxS','nai-default-positive','文件格式不支持。请选择\x20.json\x20格式的\x20Tavern\x20预设文件。','data','cart-items-list','转账:\x20','导演/编辑模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','你好世界\x20Hello\x20World','\x0a\x0a#\x20你的商店\x20(你可以为用户购买礼物):\x0a','---\x20第\x20','请根据你的设定，生成你的日记内容。','\x20元。','你没有任何特殊能力，你的目标是通过投票放逐所有狼人。','请选择今晚的目标。','</td></tr>','music-search-results-modal','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','songJson','\x0a\x0a#\x20游戏规则\x0a-\x20','Live\x20Preview','shopping-settings-modal','async','动态已更新！','<div\x20class=\x22legacy-comment-item\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-text\x22>','&id,\x20minimaxGroupId,\x20minimaxApiKey','未知成员','import-appearance-btn','\x0a-\x20**长期记忆**:\x20','.clear-posts-item','”的身份，开始你的客观总结。','https://i.postimg.cc/k45sd8gn/IMG-6375.gif','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<span\x20class=\x22lucky-king-tag\x22>手气王</span>','请先在购物车中选择要结算的商品。','找不到相册:','open-sticker-panel-btn','无法解析角色卡文件。\x0a错误:\x20','Save','预设导入失败:','text-image-mode-content','timestamp','\x0a**内容:**\x0a','reading-title','添加商品','#\x20长期记忆\x20(最高优先级，这是你和用户之间已经确立的事实，必须严格遵守)\x0a','recalled-animation','create_countdown','\x20个商品吗？此操作不可恢复。','removeItem','clear-search-btn','input[name=\x22visibility\x22]','\x0a\x0a\x0a\x0a现在，请根据以上规则和下面的对话历史，继续进行对话。','qzone-sticker-grid','NovelAI生成失败:','\x20的聊天','decode','请为这组提示词预设命名：','(这张照片没有描述)','true','[约定达成]\x20','https://i.postimg.cc/g2PfbSFm/IMG-6556.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#fff;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20text-align:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20margin-bottom:\x2020px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.06);\x0a\x20\x20\x20\x20','preset-persona-input','\x0a-\x20**你的聊天对象设定**:','，用户刚刚在\x20','\x20(角色)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','选择或切换预设','已加载预设\x20“','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','\x0a\x0a现在，请严格遵守所有规则，选择并执行你的行动。','post-hidden-text','\x20(最后互动于\x20','。你可以使用\x20\x27vote\x27\x20指令参与投票。]','[图片]\x20','preventDefault','douban-detail-author','的设定集','发送照片','reject-friend-btn','\x20张图片。有\x20','\x0a#\x20用户的角色\x0a-\x20**','-\x20**','char-music-prev-btn','bottom','image/','正在执行清理操作，请不要关闭页面...','minimized','char-vinyl-container','您的旧有记忆已被完整保留，未作任何修改。','<div\x20class=\x22waimai-card\x22><div\x20class=\x22waimai-header\x22><img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22><div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div></div><div\x20class=\x22waimai-catchphrase\x22>Hi，你和我的距离只差一顿外卖～</div><div\x20class=\x22waimai-main\x22><div\x20class=\x22request-title\x22>','generate','\x27>转账</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','Sticker','Enable\x20AI\x20Image\x20Generation','secondary-model-select','\x20\x0a-\x20存活玩家:\x20','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的参考信息：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你的角色设定**:\x20','.icon-preview','开始检查','导入\x20Tavern\x20预设','网络图片\x20(EPhone)','call_summary','pending','touches','commentText','is-location-share','.battery-level','++id,\x20albumId','❌\x20[NAI下载]\x20下载失败:','renderWallpaperScreenProxy','\x22\x20data-commenter-display-name=\x22','”。你的任务是虚构出【5到7段】TA最近的QQ聊天记录。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【NPC唯一性铁律】**:\x20在你本次生成的所有对话中（包括私聊和群聊），每一个NPC的名字【必须是独一-无二的】。绝对禁止出现重名的NPC，禁止出现重复群聊。\x0a2.\x20\x20**【NPC来源】**:\x20你应该优先从“你的社交圈\x20(绑定的NPC)”和“世界书”中寻找角色作为聊天对象。如果不够，你也可以自由创造全新的NPC，对话内容要多样化，反映角色的生活。\x0a3.\x20\x20**关联性**:\x20对话内容应巧妙地反映角色的长期记忆、世界观，以及与用户互动可能带来的心情变化。\x0a4.\x20\x20**简洁性**:\x20每段对话的总长度应在8到15句之间。\x0a#\x20格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须且只能】是一个JSON数组格式的字符串，以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a-\x20数组中的每个元素都代表一段对话，且【必须】是以下两种格式之一：\x0a\x0a\x0a\x0a###\x20格式\x20A：与NPC的私聊\x0a```json\x0a{\x0a\x20\x20\x22type\x22:\x20\x22private_npc\x22,\x0a\x20\x20\x22participant\x22:\x20{\x0a\x20\x20\x20\x20\x22name\x22:\x20\x22NPC的名字\x22,\x0a\x20\x20\x20\x20\x22avatar_prompt\x22:\x20\x22(仅当NPC是新创造时提供)一段用于生成头像的【英文】关键词,\x20风格为动漫/插画/二次元等,\x20禁止真人\x22\x0a\x20\x20},\x0a\x22messages\x22:\x20[\x0a\x20\x20{\x22sender\x22:\x20\x22','\x20行的格式不正确，已被系统跳过。','gomoku-board','\x22\x20class=\x22post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>@','删除失败','offsetLeft','originalTimestamp','20px','\x20<span\x20class=\x22source\x22>','mes_example','</div><div\x20class=\x22payment-box\x22><div\x20class=\x22payment-label\x22>需付款</div><div\x20class=\x22amount\x22>¥','announcement-item-actions','正在开始全面压缩图片，根据图片数量，这可能需要几分钟时间，请不要关闭或刷新页面...','add-song-search-btn','system','字体已保存并应用！','currentX','ai-voice-id-group','AI返回的内容中未找到有效的JSON数组。原始返回:\x20','棋盘状态\x20(1是你(黑棋),\x202是AI(白棋)):\x0a','ServiceWorker\x20注册失败:\x20','data-lang-key-title','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>','Global\x20(All\x20Characters)','participants','cancel-gift-recipient-btn','imageDescription','张NovelAI图片:\x20','#post-public-text','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是角色“','https://i.postimg.cc/zvWGPjms/IMG-7090.gif','https://i.postimg.cc/4y7mGFgJ/IMG-5716.gif','<br>','poll_timestamp','world-book-name-input','小于1分钟','isBusy','\x0a\x0a#\x20参考记忆\x20(至关重要！你必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你拥有完整的记忆。不要只是被动等待用户提问！)\x0a','请输入要添加的记忆要点：','files','书库是空的，点击“导入新书”添加第一本吧！',')\x20内容:\x20\x22','rule-editor-title','\x22\x20class=\x22realimag-image\x22\x20alt=\x22NovelAI图片分享\x22\x20loading=\x22lazy\x22\x20onerror=\x22this.src=\x27https://i.postimg.cc/KYr2qRCK/1.jpg\x27;\x20this.alt=\x27图片加载失败\x27;\x22\x20title=\x22','close-rp-details-btn','Model','https://i.postimg.cc/C5XnfpNB/IMG-5579.gif','selection-screenshot-btn','close-character-nai-prompts','char-memo-detail-screen','\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','force-apply-check-btn','https://i.postimg.cc/4x9tTy1D/IMG-5563.gif','lyrics-horizontal-pos','AI被拉黑后冷静期\x20(小时)','</name>\x0a\x20\x20<persona>','add-product-variation-btn','renderXSocialScreenProxy','role','werewolf-witch-modal','\x20领取了\x20','open-nai-gallery-btn','variation-options-container','fullPrompt','获取AI投票决策失败:\x20','NEGATIVE_INFINITY','note','cphone-icon-settings-grid','\x20(角色)</label>','#preset-content-container\x20.world-book-category-pane','close-group-manager-btn','.rules-category-pane[data-category-id=\x22','外观设置','likes','world-book-tab\x20active','qzone-post-container','pending_ai_approval',')，并在对话中自然地体现出来。\x0a\x20\x20\x20\x20-\x20**音乐**:\x20','noneOf','inline-block','appearance','import_card','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','#\x20【【【群名修改铁律】】】\x0a在修改群名时，新的群名【绝对不能】与以下任何一个群成员的名字完全相同：[','ZIP文件中未找到图片','product-editor-modal','quote_reply','announcement-action-cancel','编辑商品','https://i.postimg.cc/8kHCQwbQ/mmexport1751020645824.gif','一点心意','chatItem','\x22\x20(你可以建议并修改)\x0a-\x20\x20\x20**你对用户的备注**:\x20“','正在为后台活动发送API请求\x20(\x22','qzone-back-btn','正在为您选择的\x20','avatar-frame-modal','.comment-send-btn','\x0a\x0a3.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a4.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','https://i.postimg.cc/prsGKMBx/IMG-4370.gif','close-receipt-btn','reading-content','https://i.postimg.cc/q7cQnDy1/IMG-4404.gif','https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','random','请先填写NovelAI\x20API\x20Key！','昨晚是平安夜','cleanup-data-btn','actionCooldownMinutes','复制成功','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-artist\x22>','https://i.postimg.cc/Ss3znzk7/IMG-6934.gif','歌曲查找失败:\x20AI请求的歌曲名\x22','\x0a#\x20你的任务\x0a你是一个虚拟社区的AI导演。下面的“帖子摘要”和“已有评论”来自于一个豆瓣小组的帖子。用户“','\x20的动态\x20(角色)','myAvatar','lyricsPosition','请稍候','column','\x0a-\x20**讨论摘要**:\x20\x0a','myNickname','custom-modal-overlay','添加\x20NPC','data-clear-type-list','AI的五子棋移动指令包含无效坐标，已忽略:','https://files.catbox.moe/q6z5fc.jpeg','天\x20-\x20白天','day','\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请为你的图片添加一个简单的描述（必填，给AI看的）！','renderChatListProxy','请至少选择一种要清理的数据类型。','my-persona','exec','hasShown10','isArray','送给大家的礼物','image','proxy-url','.poll-option-item','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#888;\x20margin:\x204px\x200\x200;\x22>','https://i.postimg.cc/cLPP10Vm/4.jpg','rp-direct-amount','<div\x20class=\x22transfer-card\x22><div\x20class=\x22transfer-title\x22>','https://i.postimg.cc/vHDNGfT2/35ac7f372v588bf48d4f659077196b85.gif','https://i.postimg.cc/05wnd389/IMG-4388.gif','》\x0a-\x20**发帖人**:\x20','，跳过...','add-new-sticker-category-btn','创建普通群聊\x20(我参与)','message-editor-block\x20variation-block','preCallContext','Bad\x20control\x20character','transfer-action-accept','linear-gradient(135deg,\x20#89f7fe,\x20#66a6ff)','Regular\x20Expression\x20(use\x20g\x20flag)','compress-images-btn','lorebook','手动注入狼人杀记忆失败:','reject','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有可以拉进群的联系人哦~</p>','chats','操作失败，未能生成长期记忆。\x0a\x0a错误详情:\x20','\x22\x20class=\x22sticker-image\x22\x20style=\x22max-width:\x2080px;\x20max-height:\x2080px;\x22>','<span\x20style=\x22color:\x20green;\x22>已开启</span>','\x22></div>','appendChild','一位朋友','closed','\x0a\x0a现在，请开始生成这组照片的描述和绘画指令。','预言家已行动，预言家请闭眼。','\x22\x20class=\x22avatar-frame\x22></div></div>','messages','px)','聊天设置','\x22\x20更换了头像','\x22\x20title=\x22编辑\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M11\x204H4a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2v-7\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M18.5\x202.5a2.121\x202.121\x200\x200\x201\x203\x203L12\x2015l-4\x201\x201-4\x209.5-9.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20delete-memory-btn\x22\x20data-author-id=\x22','\x0a#\x20你的聊天对象（用户）的人设\x0a','chat-interface-screen','\x22\x20创建了一个新约定:','清空购物车','votes','Export\x20Data','description','<p\x20class=\x22char-browser-image-description\x22>','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22slider\x22></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-block-btn\x22\x20title=\x22删除此条目\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>备注\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-comment-input\x22\x20value=\x22','enable-ai-drawing-switch','\x22>\x20','#avatar-frame-modal\x20.frame-tabs','\x20\x20\x20\x20-\x20我昨晚查验了\x20','isPinned','sender-name','rules-tab','#nai-gallery-grid\x20.nai-gallery-item','📁\x20从本地上传','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','单个红包金额不能少于0.01元！','长截图生成失败:','parentNode','npc-avatar-preview','\x0a#\x20豆瓣社区风格设定\x20(来自世界书)\x0a','rp-group-amount','music-player-artist','删除评论','自定义数量','for_timestamp','导入单个聊天时出错:','公用规则','nextElementSibling','fetch-models-btn','proxyUrl','offline_text','widgetData','toDataURL','创建新相册','abs','生图功能设置','https://i.postimg.cc/dVLXm3Xf/IMG-6885.gif','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“','\x0a-\x20好人胜利：放逐所有狼人。\x0a\x0a#\x20当前游戏状态\x0a-\x20今天是第\x20','save-sticker-binding-btn','system_message','天亮了。','frame_ribbon','字体设置','请输入想跳转的页码\x20(1\x20-\x20','\x22,\x20\x22content\x22:\x20\x22我在群里说的话\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员1\x22,\x20\x22content\x22:\x20\x22成员1回复我\x22},\x0a\x20\x20{\x22sender\x22:\x20\x22NPC成员2\x22,\x20\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}\x0a]\x0a}\x0a```\x0a\x0a#\x20角色与上下文\x0a-\x20**你的角色设定**:\x20','cancel-shopping-settings-btn','lyrics-position-group','size','https://image.novelai.net/ai/generate-image-stream','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20你现在是一个场景描述引擎。你的任务是扮演\x20','\x0a-\x20**','NovelAI\x20模型','等待对方处理...','board','https://i.postimg.cc/mrFhKBGz/IMB-e-QWBpa.gif','你们已经有','toCollection','https://i.postimg.cc/rwDr8X1d/IMG-7015.gif','expanded','update-notice-modal','outgoing-call-screen','预言家请睁眼，请选择要查验的玩家。','GRID_SIZE','小时前','(未设置)','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的对话摘要\x20(供你参考)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','switchToCharScreen','group-avatar-preview','[你发送了一条语音消息，内容是：\x27','【重要提示】','\x0a\x0a#\x20统一世界观设定\x20(以下设定适用于所有参与角色)\x0a','请先选择要下载的图片。','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>没有更多可以邀请的联系人了。</p>','npc-action-cooldown-input','.frame-item:has(.delete-btn)','new-group-name-input','.contact-picker-item[data-contact-id=\x22','global-lyrics-bar','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','选中的头像框已成功删除。','at-mention-item','chat-header-status','sticker-item','custom-bubble-style','audio-player','close-persona-library-btn','https://i.postimg.cc/pddJj9zN/IMG-7094.gif','bookId','frameUrl','.rules-category-pane','导出世界书时出错:','authorOriginalName','导入外观设置','\x0a#\x20长期记忆\x20(你必须严格遵守的事实)\x0a','设置已应用','\x20\x20-\x20你评论说:\x20','这将从历史记录中【永久抹除】这\x20','https://i.postimg.cc/ydwLXx7s/IMG-6562.gif','Wait\x20for\x20Reply','packet_timestamp','char-conversation-messages','AI\x20发言失败','add-countdown-btn','”。请你回顾一下刚才和\x20“','长期记忆','记忆链接','repostComment','您的修改已保存！','post-actions-btn','lucky','此操作将扫描并压缩所有本地上传的图片（Base64格式），将其转换为JPEG以减小体积。这会轻微降低图片质量且【不可恢复】。<br><br><strong>强烈建议在操作前先进行数据备份！</strong>','linked-memory-selection','lyrics-btn','最近的消息太少，无法进行有意义的总结。','novelai-model','werewolf-','送给了\x20','<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>','正在准备\x20','[系统提示：\x27','清理失败','api-settings-screen','旁观模式AI发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','我通过了你的好友申请，我们现在是好友啦！','#\x20对话示例\x0a','--\x20点击选择\x20--','https://i.postimg.cc/gc3QYCDy/1-NINE7-Five.jpg','rules-category-pane',')\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','\x22]\x20.participant-avatar','已成功收藏到“我的收藏”页面！','来自与\x20','最近\x2020\x20条','resolution','Save\x20All\x20Appearance\x20Settings','请输入CPhone的背景图片URL','product-price-input','https://i.postimg.cc/wTTNGs3Q/IMG-7013.gif','https://i.postimg.cc/wx72fhr2/IMG-5968.gif','heartfelt_voice','**。','[系统提示：用户\x20(','被投票放逐','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>','你的任务是根据群成员的性格、世界观、参考记忆、最近的动态和当前情景，【选择一个或多个角色】，让他们主动发起一段对话，打破沉默，让群聊重新活跃起来。\x0a#\x20【交互铁律：角色间必须互动！】\x0a1.\x20\x20你的核心任务是**导演一场生动的群聊**，而不仅仅是让角色轮流发言。\x0a2.\x20\x20当有多个角色在同一轮发言时，他们的对话【必须】有逻辑上的前后关联。后面的角色应该**回应、反驳、或补充**前面角色的发言。\x0a3.\x20\x20模拟真实的聊天节奏。可以是一个角色提出问题，另一个角色立刻回答；或者一个角色开玩笑，另一个角色吐槽。\x0a4.\x20\x20你【绝对不能】生成几段毫无关联的独白。这会让对话显得非常机械和不真实。\x20\x20\x20\x20\x20\x20\x20\x20\x0a','group','”图标','success','manual-werewolf-summary-btn','.delete-memory-btn','已切换到新的开场故事！','女巫已行动，女巫请闭眼。','\x20更换了群头像','relative','1px\x20solid\x20#e0e0e0','\x22\x20not\x20found.\x20Defaulting\x20to\x20\x27zh-CN\x27.','确定要删除这条长期记忆吗？','light','user','char-product-grid','</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>','收到数据，类型:','productId','manage-products-btn','#\x20角色与玩家档案\x20(Character\x20&\x20Player\x20Dossiers)\x0a','chat-list-render-window-input','apiTemperature','\x22,\x20\x22postId\x22:\x20123,\x20\x22commentText\x22:\x20\x22评论内容\x22}]`\x0a\x20\x20\x20\x20-\x20\x20\x20表情:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','#qzone-screen\x20.qzone-content','**:\x20\x22','mousemove','\x20的外卖代付请求（时间戳:\x20',';\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20left;\x20text-decoration:\x20','[系统提示：用户关闭了五子棋棋盘，游戏结束了。]','red_packet','.progress-bar','custom-user-font','🎬\x20Director\x20Mode:\x20Saving\x20thought_chain.','extensions','isFullyClaimed','en-US','preview-bubble-style','image/*','\x20条消息</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20...>...</svg><span>聊天记录</span></div></div>','#outgoing-call-screen\x20.caller-text','恭喜！','\x0a\x0a#\x20世界观\x20(所有角色必须严格遵守)\x0a','lyrics-offset-input','authorAvatarPrompt','werewolf-game-over-reason','<div\x20class=\x22avatar-with-frame\x22><img\x20src=\x22','albumId','world-book-group-container','https://i.postimg.cc/HLKvs0Kv/IMG-7109.gif','.quoted-message','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>','\x27,\x20\x27bulangni\x27,\x20sans-serif','\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','member','这是字体预览效果，12345。','，礼物是：','poisonedId','.poll-card','char-simulated-send-btn','\x22\x20alt=\x22','此操作将永久删除您选择的所有数据，且无法恢复！确定要继续吗？','.entry-keys-input','npc-editor-modal','avatar_name','Fetch\x20failed:\x20','在角色\x20\x22','\x0a-\x20**这是你们最近的对话历史**:\x0a','conversationIndex','import-appearance-input','AI女巫决策：今天是第','当前为渐变色','https://i.postimg.cc/ZnzbGdxX/IMG-7239.gif','.sticker-item.selected','\x20---\x0a','EPhone-Full-Backup-Streamed-','userStickers','从旧版本迁移的条目','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','对方消息预览','music-player-overlay','pop','\x0a\x0aAI原始返回内容:\x0a','user-speak-btn','import-world-book-input','poll-option-input-wrapper','\x22\x20触发带理由的好友申请决策流程...','(无购买理由)','<div\x20class=\x22gift-card\x22><div\x20class=\x22gift-header\x22><svg\x20class=\x22gift-header-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M20\x206h-2.18a4\x204\x200\x200\x200-7.64\x200H8a4\x204\x200\x200\x200-4\x204v2h20V10a4\x204\x200\x200\x200-4-4zM8\x204a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zm12\x200a2\x202\x200\x201\x201-2\x202a2\x202\x200\x200\x201\x202-2zM4\x2014v6a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2v-6H4z\x22></path></svg><span\x20class=\x22gift-header-text\x22>','favorites-back-btn','GeminiChatDB','absolute','查验结果','NPC人设','Share','输入图片URL',',\x20flat\x20design,\x20simple','给你准备了一个红包','https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1758510900942_qdqqd_djw0z2.jpeg','\x0a---\x0a###\x20帖子ID:\x20','编辑消息','清空动态时发生错误:\x20','sticker_','AI角色无法完成投票，游戏暂停。请点击右上角的“重试”按钮继续。\x0a错误:\x20','openCharWallet','\x0a-\x20','”。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**格式**:\x20你的回复【必须】是一段描述性的文本。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你正在和用户（','\x22\x20class=\x22avatar-img\x22><img\x20src=\x22','panelEl','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','back-to-list-btn','导演/编辑模式保存(Sticker):\x20指令无效或缺少必要字段\x20(meaning/url/content):','\x22\x20title=\x22删除此条记录\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-header\x22>','char-diary-screen','[data-lang-key-placeholder]','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-label\x22>本地图片(头像/表情/头像框/等)大小:</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22image-size-value\x22><strong>','\x22\x20的独立后台活动开关已关闭，本次跳过。','<option\x20value=\x22\x22>--\x20未分类\x20--</option>','cancel-call-message-action-btn','werewolf-game-screen','语音消息设置\x20(Minimax\x20TTS)','clearRect','character-nai-negative',')\x20刚刚投票给了\x20“','修复完成！','浏览器','\x22>×</span>\x0a\x20\x20\x20\x20</div>\x0a','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x0a\x0a其专属的“世界书”也已自动创建并关联。','pat_message','\x20\x20\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的本名**:\x20\x22','temp_user_chat_mirror','manage-my-avatar-library-btn','”的群聊。\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22comment-delete-btn\x22\x20data-comment-index=\x22','indexOf','#ccc','close-novelai-test','propel-btn','customCss','见面”）。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份备忘录或要点记录，而不是一篇抒情散文。请尽量减少主观的心理感受描述，除非它直接导致了某个决定或计划。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过100个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','setAttribute','.qzone-post-item','https://i.postimg.cc/nhcC21Rc/IMG-6148.gif','.music-search-checkbox:checked','shared-history-viewer-modal','.message-wrapper','请按照以下格式粘贴，一行一个：\x0a\x0a头像框名字1:\x20https://.../image1.png\x0a头像框名字2:\x20https://.../image2.gif','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h1\x20class=\x22article-title\x22>','isPlaying','npcs','check-and-fix-data-btn','1186850LffdaA','TA的相册','.screen','NovelAI\x20API\x20Key','NPC','精炼失败','</span>:\x20','\x22\x20尝试领取不属于自己的专属红包\x20(接收人:\x20','本次发送给AI的【挂载记忆】内容如下：\x0a','edit-product-btn','导入失败','<p\x20style=\x22text-align:center;\x20padding:\x2020px;\x20color:\x20#888;\x22>播放列表是空的~</p>','resolve','ephone-theme','doubanMaxPosts','douban-my-comment-avatar','强力提取\x20[\x20...\x20}\x20...\x20]\x20失败，将尝试提取单个对象...','.selected-options-text','<div\x20class=\x22post-images-grid\x20grid-','cart-item-checkbox','[系统提示：你刚刚主动拉黑了用户。]','resume','请至少选择一个要分享的聊天。','未分类','delete-call-message-btn','达到自动总结阈值\x20(','Cphone','collapsed','https://i.postimg.cc/tRzPkzRg/IMG-7012.gif','custom-frame-upload-input','最近\x20100\x20条','findLast','qzonePosts','var(--text-secondary)','checkout-btn','type','删除(通知AI)','cancel-call-btn','\x22\x20发布了动态','close-nai-test-btn','聊天界面初始加载条数','gameLog','linear-gradient(135deg,\x20#f6d365,\x20#fda085)','<s>$1</s>','witch-modal-title','\x27的发言）继续进行讨论。','variation-quantity-display','删除\x20(0)','minimax-api-key','【AI角色】','</div></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content\x22>','search-history-btn','char-usage-list','music','onplay','date-search-input','user_photo','ai-avatar-upload-input','frame_5','你通过了“','round','originalSize','artist','分组名不能为空！','data:\x20','\x22\x20class=\x22chat-image\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-info\x22>\x20<!--\x20新增一个容器方便布局\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22participants-avatars\x22>','.countdown-card\x20.timer','announcements','<span\x20class=\x22group-tag\x22>群聊</span>','https://image.pollinations.ai/prompt/','preview-font-style','你们正在一起听歌，','\x20个表情吗？此操作不可恢复。','<p>','https://i.postimg.cc/tTpZ6wLs/IMG-7095.gif','\x20[包含','\x20元。]','\x20剩余红包将在','收藏成功！','createObjectURL','transparent','file','请根据你的设定，开始你的行动。','</small>','limit','\x0a\x0a#\x20你的角色库\x20(你可以从中选择【任何角色】进行评论，并参考他们的记忆和对话)\x0a','isActive','\x0a#\x20【情景感知】\x0a-\x20**时间**:\x20感知到当前是','https://i.postimg.cc/k401K5g7/IMG-7304.jpg','NPC\x20列表','确定要从【聊天记录和动态】中永久删除这\x20','douban-detail-content','char-diary-detail-screen','block','加载中...','...\x0a-\x20**已有评论**:\x0a','from','userAgent','group-cooldown-group','theme','请输入关键词或选择一个日期。','抱歉，未能找到相关歌曲。','等待回复','delete-btn','AI返回的讨论内容格式不正确。原始返回:\x20','这个分类下还没有表情哦~','chat-name-input','save-nai-settings-btn','https://i.postimg.cc/wBw5Fvcn/IMG-5974.gif','werewolf-player-selection-list','.chat-list-item[data-chat-id=\x22','preset-editor-title','-\x20昨晚是平安夜，无人死亡。\x0a','\x22\x20data-category-id=\x22','【原动态内容:\x20','music-player-song-title','ttsCache','scope','一条动态','isDragging','is-waimai-request','App\x20Usage','upload-image-btn','此操作将扫描数据库，移除所有与已删除角色相关的孤立数据（如动态、评论、记忆等）。<br><br><strong>此操作不可撤销，但通常是安全的。NPC数据不会被删除。</strong><br><br>建议在操作前先导出数据备份。','无法为头像命名，请检查（主/副）API配置是否正确并支持Vision。\x0a错误:\x20','确定要清空当前角色的NAI提示词配置吗？','export-world-book-btn','\x20你们之间已经有**','[一张图片，其隐藏文字为：“','自动总结成功：为\x20','nai-steps','一个神秘的角色。','**\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要\x20(这是你们通话的原因，至关重要！)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','[系统提示：用户手动结束了投票！最终结果为：','message-editor-modal','vote','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>','world-book-category-manager-modal','.avatar','确定要拉黑“','char-album-grid','music-prev-btn','isOpen','</p></div><table\x20class=\x22receipt-items-table\x22><thead><tr><th\x20class=\x22item-name\x22>商品</th><th\x20class=\x22item-qty\x22>数量</th><th\x20class=\x22item-price\x22>单价</th><th\x20class=\x22item-subtotal\x22>小计</th></tr></thead><tbody>','API未配置，无法生成内容。','sticker-search-input','shiftKey','werewolf-witch-selection-list','Favorites','update-notice-dismiss-btn','错误:\x20','未使用','chat-group-container','targetDate','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22participants-names\x22>与\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20被拉黑前的对话摘要\x20(这是你被拉黑的关键原因)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20位角色生成豆瓣动态...','ai-avatar-input','-modal','游戏尚未结束，无法进行总结。','hidden','API设置不完整，无法继续。','\x20(用户)**:\x20','change-icon-btn','input[name=\x22variation-select\x22]:checked','检测到JSON中的非法控制字符，尝试清理并重试...','visibleGroupIds','album-photos-title','AI返回了空内容或未知格式。','chat-list-item','通话记录','delete-world-books-btn','</div></div>','</strong>\x20Tokens</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-content\x22>','world-book-tab','】。你【绝对不能】生成\x20`name`\x20字段为\x20**\x22','upload-cphone-bg-url-btn','shared-history-viewer-title','confirm-contact-picker-btn','\x20首歌曲...','Refresh','\x20行格式不正确，已被忽略。','📤\x20发送请求到\x20NovelAI\x20API','”。请你回顾一下你和“','\x0a\x0a#\x20','border','frame_10','map','分钟前有人聊过。','\x0a#\x20导演策略与节奏控制\x0a1.\x20\x20**并非人人发言**:\x20不是每个角色都必须在每一轮都说话。你可以根据当前话题，让1-2个最相关的角色进行深度对话，其他角色可以暂时“潜水”，等待合适的时机再切入。\x0a2.\x20\x20**创造“小团体”**:\x20允许角色之间形成短暂的“两人对话”或“三人讨论”，让群聊更有层次感。\x0a3.\x20\x20**主动创造事件**:\x20如果对话陷入平淡，你可以导演一些“小事件”来打破僵局。例如：\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色突然发出一个奇怪的表情包或语音。\x0a\x20\x20\x20\x20-\x20\x20\x20让一个角色分享一个有趣的链接或图片或发起投票，开启新话题。\x0a\x20\x20\x20\x20-\x20\x20\x20让两个有“关系网”冲突的角色，因为某个观点产生一点小小的争论。\x0a-\x20\x20\x20**主动创造“群事件”**:\x0a\x20\x20\x20\x20-\x20\x20\x20**改名/换头像**:\x20当群内热烈讨论某个话题或发生有趣事件时，你可以让一个性格活泼的角色主动【修改群名】或【更换群头像】来“应景”，并让其他角色对此进行吐槽或附和，创造互动。\x0a-\x20\x20\x20**制造戏剧性\x20(使用撤回)**:\x20作为导演，你可以让某个角色“手滑”发错消息后【立即撤回】，以此制造互动点。\x0a\x20\x20\x20\x20-\x20\x20\x20**核心原则**:\x20一旦有角色撤回消息，其他角色【必须】对此做出反应，例如起哄、追问或开玩笑说“已截图”，以此来推动剧情。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a#\x20表情使用指南\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timer\x22\x20data-target-date=\x22','upload-custom-frame-btn','test-sound-btn','NovelAI\x20Model','randomJottings','已返回我的手机','.call-record-card','replyToDisplayName','\x20分钟，开始模拟后台活动...','https://i.postimg.cc/1Rwn3XVP/IMG-6146.gif','API未配置','<span\x20style=\x22color:\x20red;\x22>未运行</span>','外观预设已保存！','\x20觉得很赞</span></div>','npc-name-input','#vinyl-view\x20#music-player-cover','replyToName','werewolf-finish-speech-btn','char-diary-detail-content','修改图片','号玩家:\x20','\x22\x20placeholder=\x22例如:\x20key1,\x20key2,\x20key3\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>内容</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x225\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>','检查更新时出错:','data:image','\x20条红包记录。','minimize-reading-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-actions-btn\x22>…</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','player','\x20被刀了\x20(你没有解药了)','chat-list-screen','unreadPostsCount','内容因安全策略被屏蔽\x20(原因:\x20','LOW','https://i.postimg.cc/3Rb46fRZ/IMG-6923.gif','无法生成商品，请检查(主/副)API配置或稍后再试。\x0a错误:\x20','is-ai-image',',\x20内容:\x20\x22','book_','left','\x20张图片。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-cover\x22\x20style=\x22background-image:\x20url(','<div\x20class=\x22spinner\x22></div>','nai-default-negative','rules-category-pane\x20active','selection-cancel-btn','This\x20is\x20a\x20font\x20preview\x20effect,\x2012345.','找不到主角\x20“','用户向你发送了一张图片','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须且只能】是以下两种格式之一的JSON数组，绝对不能回复任何其他内容：\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20接受:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20拒绝:\x20\x27[{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22reject\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请立即做出决策。','检测到视频通话请求，为角色\x20\x22','select-all-frames-checkbox','temp_npc_chat','密钥\x20(API\x20Key)','开始清理','<span\x20class=\x22diary-emphasis\x22>$1</span>','无法访问剪贴板。','simulatedAlbum','https://api.vkeys.cn/v2/music/netease?word=','生成模拟相册失败:','通话于\x20','\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22quantity-display\x22>','preset-action-cancel','提取的图片大小:','请根据你的设定，生成模拟聊天记录。','callRequester','swipeDirection','callRecords','#search-results-list\x20.music-search-checkbox','导入\x20Tavern\x20AI\x20世界书','.comment-sticker-btn','”。]','指定的数据已成功清除。','my-frame-content','Image\x20Generation\x20Settings','无法获取AI回复，请检查API配置或稍后再试。\x0a错误:\x20','这是所有玩家都能听到的【公开信息】。\x0a','aiPersona','selected','posts','src','\x0a#\x20智能总结\x20(基于不同时间维度的群聊回顾)\x0a','合计:\x20¥','确定要从头像库中删除“','API设置','value','increase-qty-btn','innerText','AI\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','memories-view','qzone_comment','https://i.postimg.cc/43PhvxRq/IMG-6922.gif','正在开始清理冗余数据，请不要关闭页面...','characterNegativePrompt','[这是你上一轮的内心独白和思考]\x0a-\x20心声:\x20','3120971ggEuCY','preset_','AI\x20Block\x20Cooldown\x20(hours)','https://i.postimg.cc/Ssgbv41n/IMG-6876.gif','link-description-input','\x20元</div>','https://i.postimg.cc/DZrGtrqB/IMG-7008.gif','\x20(本名:\x20','字体文件URL\x20(.ttf,\x20.otf,\x20.woff等)','translateX(-50%)','Content','正在执行...','[data-lang-key-title]','150','https://i.postimg.cc/05DLr0yj/IMG-4427.gif','#clear-posts-list\x20.clear-posts-item.selected','发现新版本通知:\x20','\x20中聊天','chat','world-book-editor-title','shopping-product-count-input','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20margin-top:50px;\x22>还没有任何角色或NPC可以加入群聊。</p>','正在模拟“','status-bar-battery','originalType','请为这个表情命名\x20(例如：好耶、疑惑)','audio/mpeg','receiverName','将清空选定角色的心声和散记历史。','contactType','favorites-view','NPC\x20Nickname','nextSibling','https://i.postimg.cc/3NffgJSZ/e09c07034ld7e62266c0a5de6a36ae62.gif','\x0a你必须严格遵守','qzoneGroups','single-lyric-display','):\x20','-\x20\x20\x20**对话状态**:\x20','生成购物中心商品失败:','https://i.postimg.cc/J0b6Nym4/IMG-7279.jpg','”发送的、尚未领完的红包（时间戳:\x20',')\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-gallery-controls\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-download-btn\x22\x20title=\x22下载\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M19\x209h-4V3H9v6H5l7\x207\x207-7zM5\x2018v2h14v-2H5z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22nai-gallery-delete-btn\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22><path\x20d=\x22M6\x2019c0\x201.1.9\x202\x202\x202h8c1.1\x200\x202-.9\x202-2V7H6v12zM19\x204h-3.5l-1-1h-5l-1\x201H5v2h14V4z\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22nai-gallery-name\x22>','load-more-btn','撤回了一条[','\x22\x20class=\x22avatar-img\x22\x20style=\x22border-radius:\x2050%;\x22><img\x20src=\x22','请至少选择一位收礼人。','char-amap-screen','.lyrics-btn','regex','AI已接收并理解了该图片的内容。','outgoing-call-avatar','contact-picker-list','.qzone-post-container[data-post-id=\x22','群里已经安静了\x20','trans','world-book-category-pane','keys','#e4b591','...”)','direct','你们最近没有有效聊天记录。','parsedLyrics','\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','已成功批量导入\x20','confirm-clear-posts-btn','”写一篇新日记...','预言家','album-back-btn','qzone_like','发布公告','https://i.postimg.cc/g2XykNGB/IMG-4727.gif','getUint32','#fullscreen-lyrics-container\x20.music-lyrics-list','scenario','parentElement','https://i.postimg.cc/k5yv6QBv/IMG-7232.gif','chat-search-results-list','📸\x20NovelAI图片生成开始，AI提供的prompt:','API\x20Preset\x20Management','tencent','\x0a-\x20**帖子内容摘要**:\x20','https://i.postimg.cc/FzbGNdRT/IMG-4392.gif','notification-sound-player',':</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-content\x22>','reply-preview-bar','》设定:\x0a','\x22\x20已经存在了！','.music-player-window','initiator','(在那次','创建ZIP流时出错:\x20','music-return-btn','generateInternalStream','char-music-artist','Generation\x20Settings','\x0a\x0a现在，请严格遵守所有规则，特别是【时间感知】和【禁止扮演用户】的铁律，开始生成这组生动、多样且充满“豆瓣味”的小组帖子。','innerHTML','商店空空如也，点击“管理”添加商品吧！','offline-mode-options','高德地图','commentCooldowns','post_deleted_notice','novelai-generated-','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-feedback-icons\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','error','」的新会话吗？','！请对此事件发表评论。]','正在解压图片...','.draggable-button-item','call-transcript-modal','cloneNode','》\x0a\x20\x20\x20\x20-\x20**','poison','https://i.postimg.cc/Df1qLzDf/IMG-6927.gif','一条[转账]消息已被撤回。','狼人已行动，狼人请闭眼。','rp-group-greeting','persona-editor-modal','confirm-delete-world-books-btn','song','char-music-player-modal','<p>点击“导入”按钮，<br>从本地.txt文件或网络URL加载书籍内容。</p>','正在请求AI进行记忆精炼...','这是你认识的、关系密切的NPC。在生成对话时，你应该【优先】与他们互动。\x0a','Language','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22memo-title\x22>','ai-original-name-group','<div\x20class=\x22avatar-group\x22\x20style=\x22width:\x2045px;\x20height:\x2045px;\x22><img\x20src=\x22','\x20-\x20','这是模拟对话，无法发送消息','close-category-manager-btn','NAI_Image','动态已删除。','https://i.postimg.cc/0yd0MZ6k/IMG-5971.gif','确认导入','block-cooldown-input','music-visual-container','这将用备份文件中的数据【完全覆盖】当前与“','avatarFrame','enableAiDrawing','product-category-tab','my-avatar-upload-input','https://i.postimg.cc/4NCPsp5d/mmexport1751034427637.gif','编辑世界书','transfer-amount','toFixed','确定要从收藏夹中移除这\x20','background','解析AI返回的JSON时出错:\x20','text/event-stream','recipients','my-frame-grid','请输入精炼后核心记忆的大致字数：','📥\x20图片下载中...','label[for=\x22','renderingRules','\x20发送了一张图片，图片内容描述为：\x27','确定要删除分类《','错误：找不到该成员的个人档案。','fillRect','template','image/png','send-btn','添加头像','API失败:\x20','a\x20random\x20product','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**可用播放列表**:\x20[','请求添加你为好友','<button\x20class=\x22delete-btn\x22\x20data-id=\x22','minimax-model-select','swiped','(回复\x20','.select-box','-\x20(头像库是空的，无法更换头像)','压缩步骤\x201/3:\x20正在从数据库读取所有相关数据...','正在接收流式数据...','htmlFor','\x20的身份是：','\x22\x20的本次后台活动跳过。原始回复:','EPhone-Full-Backup-Legacy-','ai-persona','pat_user','battery-alert-text',',\x20内容摘要:\x20“','regenerate-douban-btn','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','settings','globalChatBackground','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一本世界书</p>','upgrade','投票结果：','\x0a[图片生成失败:\x20','novelai-settings-btn','发生了一个错误:\x20','”下，回复了\x27','cphoneWallpaper','你已拒收','switch-greeting-btn','...”','”，并根据其人设、记忆和最近的互动，虚构出【5到8篇】TA最近可能会写的日记。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','repost-confirm-btn','assign-group-select','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','.png','-\x20\x20\x20**公开发布NovelAI真实图片动态**:\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20或\x20`{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22naiimag\x22,\x20\x22publicText\x22:\x20\x22(可选)动态的配文\x22,\x20\x22prompt\x22:\x20[\x22图片1详细英文描述\x22,\x20\x22图片2详细英文描述\x22]}`\x20\x0a\x20\x20*\x20**prompt撰写**：你可以根据当前对话上下文、你的角色人设、以及你想表达的情感和氛围，来撰写详细而具体的prompt。详细程度由你根据具体情况自己决定，并不强制。\x0a\x20\x20*\x20例如：\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22','publish-to-announcement-btn','\x20(用户)</span>\x0a\x20\x20\x20\x20','lowres,\x20bad\x20anatomy,\x20bad\x20hands,\x20text,\x20error,\x20missing\x20fingers,\x20extra\x20digit,\x20fewer\x20digits,\x20cropped,\x20worst\x20quality,\x20low\x20quality,\x20normal\x20quality,\x20jpeg\x20artifacts,\x20signature,\x20watermark,\x20username,\x20blurry','图片已更新！','。请你对此作出回应，可以表现出好奇、开玩笑（比如\x27我截图了！\x27）、或者根据你的人设表示理解或疑惑。]','\x20首歌曲的详细信息...','AI女巫决定保留解药。','】。\x0a\x20\x20\x20\x20-\x20\x20\x20在对话中，你可以根据人设和关系，自由使用角色的【群昵称】或【本名】进行称呼。\x0a\x20\x20\x20\x20-\x20\x20\x20严禁生成\x20\x27name\x27\x20字段为\x20\x22','thoughts-history-list','group-avatar-library-title','确定要永久删除这条心声记录吗？此操作不可恢复。','这将用文件中的设置覆盖当前的所有外观设置（包括壁纸、图标、字体、CSS等）。确定要继续吗？','.post-mode-switcher','categoryId','清空所有动态\x20(危险)','https://i.postimg.cc/Ss7pM6fW/IMG-4410.gif','-\x20\x22','\x20\x20-\x20在群聊“','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22item-title\x22>','favorites-delete-selected-btn','transfer','album-photos-screen','banner','”)下发送了一个表情评论，意思是：“','poll','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22form-button-secondary\x20upload-variation-image-btn\x22\x20style=\x22margin:\x200;\x20padding:\x208px\x2012px;\x22>上传</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20class=\x22variation-image-input\x22\x20accept=\x22image/*\x22\x20hidden>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','reading-library-modal','</span></div><div\x20class=\x22gift-items-preview\x22>','已被用户删除','getPropertyValue','levelchange','chat-render-window-input','\x20票</span></div></div>','recipientName','<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20系统心跳计时器:\x20','分组\x20\x22','cancel-werewolf-lobby-btn','\x22\x20class=\x22gift-preview-img\x22><span\x20class=\x22gift-preview-name\x22>','https://i.postimg.cc/QMVdG9x6/IMG-7016.gif','存储空间优化','nai-gallery-grid','nai-diffusion-4','margin','编辑规则','\x0a\x0a现在，请生成这份歌单。','sampler','\x20的红包已被领完','.playlist-item-info','配置错误','.participant-avatar-wrapper\x20.participant-avatar','\x0a#\x20【格式铁律\x20(最高优先级：常规模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【永远只能包含一个】元素，即\x20`offline_text`\x20对象。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回\x20\x22naiimag\x22\x20对象。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回纯文本（即没有JSON包装的文字）。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】在JSON数组前后添加任何\x20markdown\x20标记\x20(如\x20```json)。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','world-book-content-container','”的当前状态已更新为：','favorite-article-btn','通话中还没有你的发言，无法重新生成回应。','frame_11','[一张图片，其隐藏文字为：\x22','Delete','cancel-post-action-btn','https://i.postimg.cc/c4JMPd2W/IMG-4724.gif','\x20个条目。','\x20(图片描述:\x20\x22','switchToMyPhone','最终负面提示词:','正在呼叫...','imageUrl','.link-share-card[data-timestamp]','我是谁呀。','生成模拟App使用记录失败:','-\x20(暂无)','\x0a-\x20**你的长期记忆**:\x20','Fetch\x20Primary\x20Models','categories','✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)','确定要删除头像框\x20“','守卫已行动，守卫请闭眼。','添加网络歌曲','dragging','[系统提示：你刚刚成功将自己的备注名修改为了“','删除约定','world-book-editor-screen','simulatedConversations','font-url-input','.world-book-group-content','\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a','”，并根据其人设，通过【发布新动态】或【评论/回复帖子】来参与社区互动。\x0a\x0a','char-music-next-btn','音频播放失败:','请输入书名','persona-preset-item','waimai_order','regenerate-btn','join','AI们的茶话会','my-frame-tab','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','未选择书籍','.loader-container','create-post-modal','char-main-date','生成模拟备忘录失败:','游戏开始','exclude','translateY(-20px)','跳过一个无效的JSON片段:','》\x20-\x20','call-message-actions-modal','，我的看法是...\x20我【必须】回应...\x0a3.\x20\x20**S\x20(Social\x20-\x20社交表演)**:\x20我要如何用我的【人设】和【社交关系】来包装我的发言？\x0a\x20\x20\x20\x20-\x20(例如：我的好友\x20','从完整链接批量导入','数据检查与修复','?key=','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-group-btn\x22\x20data-book-id=\x22','switch-greeting-group','此操作将永久删除\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20最近的动态列表\x20(供你参考和评论)\x0a\x20\x20\x20\x20\x20\x20\x20\x20','setItem','primaryKeys','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','photo-item','确定要删除预设\x20“','frame_12','font-size:\x2016px;\x20color:\x20#555;\x20margin-bottom:\x2010px;','chatLinks','Album\x20Name','EPhoneSingleChat','对方拒绝了你的视频通话请求。','red-packet-modal','prophet','...\x22):\x20','\x20<span\x20class=\x22group-tag\x22>群</span>','\x0a#\x20你的任务\x0a你是一个虚拟的、极具创造力的商品规划师。你的任务是为下面的角色“','shopping-screen','[data-version]','\x20点赞了动态]','totalElapsedTime','https://i.postimg.cc/WbmkXzsS/IMG-6138.gif','timeZone','qzone-banner-input','maxMemory','AI返回的刀人目标格式不正确。','\x20条消息，AI将完全遗忘它们的存在。确定吗？','处理NPC后台活动时出错:','msgTimestamp','从\x20JSON.data\x20中提取图片数据','张图片，prompt:','.commenter-name','\x22\x20转发了动态\x20#','\x22\x20class=\x22avatar\x22\x20style=\x22border-radius:\x2050%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','favorite-diary-btn','price','transcript-entry\x20','link-title-input','标题:\x20','rp-direct-total','.entry-enabled-switch','https://files.catbox.moe/r5heyt.gif','shopping-action-bar','chatRenderWindow','frame_9','vote_for_name','确定要将“','\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22','3559424TUGJxc','favid','请根据你的设定，生成你的App使用记录。','CPhone','.voice-message-body[data-text]','values','borderRadius','contactId','https://i.postimg.cc/JnwFp3Kx/mmexport1751031208329.gif','cancel-reply-btn','<span\x20style=\x22color:\x20#ff8c00;\x22>[好友申请]\x20','preset-avatar-preview','removeEventListener','\x0a#\x20核心任务：群聊剧本作家\x0a你是一个剧本作家，负责创作一个名为“','Processing...','member-persona-input',')\x20已被用户忽略或为旧版本，无需显示。','(今天是第一天，没有历史记录)\x0a','Taobao','gomoku-controls','copy-timestamp-btn','\x0a<character>\x0a\x20\x20<name>','”，并根据其人设、记忆和最近的互动，虚构出TA最近一天的【手机App屏幕使用时间】记录，总共约20条。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与多样性**:\x20生成的App列表【不必局限于】Cphone主屏幕上已有的App。你可以自由地虚构TA可能使用的其他App，例如\x20Instagram,\x20Twitter,\x20各种游戏\x20(如：原神,\x20王者荣耀),\x20视频App\x20(如：抖音,\x20YouTube),\x20学习或工作软件等，这能更好地体现角色的隐藏兴趣和生活习惯。\x0a2.\x20\x20**合理性**:\x20使用时长和App类型必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一个App的使用记录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22appName\x22:\x20\x22App的名称\x20(例如:\x20微信,\x20微博,\x20原神)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22usageTimeMinutes\x22:\x20125,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22App的分类\x20(例如:\x20社交,\x20游戏,\x20影音,\x20工具,\x20阅读,\x20购物)\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这个App【图标】的、简洁的【英文】关键词。风格必须是\x20modern\x20app\x20icon,\x20flat\x20design,\x20simple,\x20clean\x20background\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a-\x20**身份**:\x20','即将开始下载您的完整备份文件。下载过程中请勿关闭页面。','游戏结束','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','\x20\x20-\x20评论:\x20','span','\x22\x20class=\x22cart-item-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-name\x22>','memoryTimestamp','删除预设','analysis','home-screen','https://i.postimg.cc/vBqsQW7X/IMG-6858.gif','\x0a#\x20长期记忆\x20(所有角色必须严格遵守)\x0a','items','stickerCategories','\x0a}\x0a}','</div><div\x20class=\x22gift-footer\x22>共','model','https://i.postimg.cc/fyyGgW61/IMG-7115.gif','<option\x20value=\x22\x22>未分组</option>','apply','诊断：在顶层\x20','</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20冷静期是否结束:\x20','请先选择角色','Title','\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a','select-all-chars-for-clear','group-avatar-input','\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','确认精炼','Enter','frame_7','singer','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','.remove-option-btn','请按照以下通用格式粘贴，一行一个：\x0a\x0a开心:\x20https://.../happy.gif\x0a哭泣:\x20https://.../cry.png\x0a\x0a','rp-tab-direct','rule-regex-input','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','转账已被拒收','选中的表情已成功删除。','你赢了','https://i.postimg.cc/pLY3WfR8/IMG-6557.gif','appIcons','Gemini\x20API返回了非预期的格式:','start','red-packet-details-modal','-\x20**与用户的关系**:\x20你和用户(','”的好友请求','music-exit-btn','max-memory','pageX','\x0a#\x20群成员列表\x20(你的总结目标)\x0a','ai-persona-group','opened','选择导出方式','cancel-ai-response-editor-btn','select-all-products-checkbox','post-image-preview-container','close-transcript-modal-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>点击右上角刷新按钮，<br>看看TA最近都和谁聊天了吧！</p>','participant-avatars-grid','✅\x20图片转换成功！🎨','删除头像','.sender','enqueue','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20margin-top:\x2020px;\x22>空空如也~\x20点击右上角\x22添加\x22来创建你的第一个人设预设吧！</p>','申请成功！','播放已暂停','transition','解析器：已启用\x20Markdown\x20提取模式。','appName','<label><input\x20type=\x22checkbox\x22\x20value=\x22user\x22>\x20','✅\x20动态NovelAI图片全部生成完成:\x20','Http_Get_External','novelai-settings-modal','QQ音乐搜索API失败:','clientY','相册名称不能为空！','正在为角色“','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20创建你的第一个预设</p>','currentSnippet','\x22**\x20的发言。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**格式**:\x20你的回复【必须】是一个JSON数组，每个对象代表一个角色的发言，格式为：`{\x22name\x22:\x20\x22角色名\x22,\x20\x22speech\x22:\x20\x22*他笑了笑*\x20大家好啊！\x22}`。\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20**角色扮演**:\x20严格遵守每个角色的设定。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20当前情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20你们正在一个群视频通话中。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话前的聊天摘要**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20','douban-max-posts-input','add-to-cart-btn','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有可以查看手机的角色哦~</p>','未知App','rp-details-greeting','</strong></p><hr\x20style=\x22opacity:\x200.2;\x20margin:\x2010px\x200;\x22>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-content\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','werewolf-log-entry\x20','add','import-data-input','”\x20的评论。你的任务是扮演【除了用户以外】的所有角色。\x0a3.\x20\x20**【互动】**:\x20新生成的评论【必须】是针对【已有评论】的延续或回应，让讨论能继续下去。\x0a4.\x20\x20**【头像一致性\x20(最高优先级！)】**:\x20你【必须】参考下面的“已有路人NPC头像指令”列表。如果一个已有的NPC再次发言，【必须】复用它旧的头像指令。只有在创造一个【全新的、从未出现过的】NPC时，才为其生成新的头像指令。\x0a5.\x20\x20**【格式】**:\x20你的回复【必须且只能】是一个JSON数组，数组中的每个元素都代表一条新评论，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色A的名字\x22,\x20\x22text\x22:\x20\x22角色A的新评论内容。\x22,\x20\x22avatar_prompt\x22:\x20\x22(可选)如果评论者是【全新的】NPC,提供头像指令\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22commenter\x22:\x20\x22角色B的名字\x22,\x20\x22text\x22:\x20\x22角色B对角色A或楼主的看法。\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20上下文\x0a-\x20**帖子标题**:\x20《','createWriteStream','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2010px\x2018px\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2013px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#f0f2f5;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x205px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','请先点击扳手图标进入管理模式，才能添加新商品。','getAttribute','”，选项有：[','<option\x20value=\x22current\x22>当前配置\x20(未保存)</option>','silent-audio-player','linkedWorldBookIds','\x22\x20中的成员信息更新','https://i.postimg.cc/HxLV5v92/mmexport1751036977582.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x206px\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x201px\x20solid\x20#ccc;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20cursor:\x20pointer;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.2s;\x0a\x20\x20\x20\x20\x20\x20\x20\x20','ruleId','.nav-item[data-view=\x22memories-view\x22]','\x0a-\x20**内容摘要**:\x20','voice-message-btn','data-clear-wizard-modal','https://i.postimg.cc/Y2PHZzCC/IMG-6866.gif','character-nai-prompts-modal','\x22\x20的后台活动开关已关闭，本次跳过。','</div><div\x20class=\x22receipt-footer\x22>感谢您的惠顾，欢迎再次光临！</div>','部分导入失败','添加完成！\x0a\x0a成功添加\x20','block-chat-btn','.chat-group-content','slice','ai-response-editor-container','https://...','bg-input','greeting','music-lyrics-list','.unread-count','douban-settings-modal','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-text\x22>','show-announcement-board-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url(','🌐\x20使用网络URL','qzone-sticker-panel','\x0a#\x20长期记忆\x20(必须严格遵守)\x0a','[系统提示：用户刚刚发布了一条动态(ID:\x20','random_jottings','请先填写对应的反代地址和密钥','participant-display-avatar','\x20同步所有群聊内的名称信息...','https://i.postimg.cc/yN3s8szM/IMG-4400.gif','目标消息未找到,\x20正在加载更多历史记录...\x20(尝试\x20','）完成了支付。此订单已关闭，其他成员不能再支付。]','cancel-member-settings-btn','.variation-image-input','touchmove','isGameOver','ai-response-editor-block','未知会话','恭喜发财，大吉大利！','成员们正在输入...','\x20发布了一条新动态]','offline-max-length-input','product-variations-container','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**用户发送的申请理由**:\x20“','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','[+]\x20添加新条目','\x20之间的有效数字。','转发了\x20@','\x22\x20已经存在了，换个名字吧！','<div\x20class=\x22avatar-group\x22><img\x20src=\x22','orderBy','douban-detail-post-title','旁观模式收到未知指令类型:','请输入EPhone主屏幕的背景图片URL','https://i.postimg.cc/tTWKKmTN/IMG-7073.gif','副API设置\x20(用于总结长期记忆)','https://i.postimg.cc/28TsrxRV/IMG-6852.gif','Upload','https://i.postimg.cc/8PsK20jQ/IMG-7236.gif','preset-tabs','Done',':\x20[发送了一个表情，意思是:\x20\x27','startY','Remove','礼物已成功送出！','speaker_name','cache','Content-Type:','video_call_response','https://i.postimg.cc/J4fwkTLW/mmexport1751038167142.gif','ai-frame-content','确定要删除这个约定吗？','chatData','已成功从\x20Tavern\x20AI\x20文件导入设定集《','\x22\x20记录了一条新回忆:','<span>',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22album-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22album-name\x22>','确认总结','未找到相关收藏','flexDirection','cancel-variation-selection-btn','ZIP\x20Blob\x20大小:','📁\x20从本地文件\x20(.lrc)','2-digit','stringify','charId','在执行组合操作时遇到错误:\x20','\x0a\x0a\x0a','\x0a\x20\x20\x20\x20-\x20**今日讨论**:\x20','regenerate-char-taobao-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-post-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M170.666667\x20170.666667h128v682.666666h-128zM426.666667\x20170.666667h170.666666v682.666666h-170.666666zM725.333333\x20170.666667h128v682.666666h-128z\x22></path></svg>\x20','incoming-call-modal','imageProcessed','请在此处粘贴完整的LRC格式歌词...','<span\x20class=\x22offline-description\x22>','rules-tab\x20active','smea_dyn','https://i.postimg.cc/nrJSqNhz/IMG-4432.gif','artistName','https://i.postimg.cc/FFCTCzpy/641bad3b3udc599fdb63ca75fde427e5.gif','AI返回的JSON格式不正确，缺少\x20\x27summaries\x27\x20字段。','批量导入表情','replyTo','url','includes','.custom-multiselect\x20.select-box','\x22\x20class=\x22photo-thumb\x22\x20alt=\x22相册照片\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22photo-delete-btn\x22\x20data-photo-id=\x22','startX','normal','书名不能为空！','AI\x20(群聊后台)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','repost','AI返回的行动中未找到有效的JSON数组。','检测到\x20EPhone\x20备份文件，执行标准导入...','save','assign-group-section','notificationSoundUrl','memories-back-btn','\x20被投票放逐。','请填写有效的商品信息和金额！',')，开始总结...','https://i.postimg.cc/VkQfgzGJ/1.jpg','你有一瓶解药和一瓶毒药，解药可以救活当晚被杀的玩家，毒药可以毒死任意一名玩家。','status-bar-visible','#message-editor-container\x20textarea','命名表情','\x20的日记','repost-comment-input','下载\x20(','\x20(这是TA的昵称)\x0a-\x20**本名\x20(你在对话中必须用这个名字称呼TA)**:\x20','\x20你应该像它们从未存在过一样继续对话，并相应地调整你的记忆和行为，不要再提及这些被删除的内容。','likesCount','\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**你们最后的对话摘要**:\x20','跳过一个无法解析为JSON的编辑块:','delete-appearance-preset-btn','chat-input','---\x20','byteLength','status-bar-time','voice_message','Asia/Shanghai','Search','，我们一起见证了这个约定。','save-product-btn','诊断：在\x20data.extensions.character_book\x20中找到世界书。','count','link-memory-toggle','】，本名是【','(空)','\x20的新头像同步到群聊\x20\x22','&times;','检测到\x20\x27entries\x27\x20对象格式的预设，将尝试按顺序导入。','操作已取消','contentLines','zIndex','\x22\x20创建成功！','element','add-ai-avatar-url-btn','link-content-input','message-wrapper\x20','[图片/文字图]\x20描述:\x20\x22','内容为空。','delete-current-category-btn','网络图片','showScreen','.post-footer,\x20.post-feedback-icons,\x20.post-actions-btn,\x20.post-comments-container,\x20.reposted-content-wrapper','加载更早的会话','\x22\x20(用户)\x20或\x20\x22','placeholder.png','change_user_nickname','go-to-clear-step2-btn','</div><div\x20class=\x22countdown-label\x22>剩余支付时间<div\x20class=\x22countdown-timer\x22\x20id=\x22waimai-timer-','isNpc','EPhone-WorldBooks-','\x20更换了头像]','点击了商品卡片:\x20','\x20是同一个分组的好友。\x0a','totalPages','请输入歌手名','guard','Performance\x20&\x20Display\x20Settings','custom','没有找到可导入的内容。','<p\x20style=\x22text-align:center;\x20color:#8a8a8a;\x20padding:\x2050px\x200;\x22>还没有可以参与的角色。</p>','请输入Ta的【本名】(例如:\x20李星辰，这个名字将用于AI识别)','lastUpdate','https://i.postimg.cc/wjwbnYkp/IMG-7111.gif','AI幻觉已被拦截！试图在群聊中发送一条没有“name”的消息。消息内容:','base_resp','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','group_call_response','#\x20今日完整讨论记录\x20(Today\x27s\x20Full\x20Discussion\x20Record)\x0a','open-album-btn','[转账]','🤖\x20AI\x20思维链:','\x20的外卖订单支付了\x20','\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>','”，并根据其人设、记忆和最近的互动，挑选出【14到18首】最能代表TA此刻心情或品味的歌曲。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20歌单必须完全符合角色的性格、爱好和生活背景。\x0a2.\x20\x20**多样性**:\x20歌曲风格可以多样，但必须逻辑自洽。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一首歌，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22songName\x22:\x20\x22歌曲的准确名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22artistName\x22:\x20\x22歌曲的准确艺术家/歌手名\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','\x0a-\x20散记:\x20','add-world-book-entry-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','<input\x20type=\x22checkbox\x22\x20value=\x22','”\x20的位置已发送到你们的聊天中。','确定要删除这条通话消息吗？','onended','”吗？','chat-list-title','aiAvatarFrame','https://i.postimg.cc/jCVMQsKH/IMG-7114.gif','.voice-play-btn','\x0a-\x20**你的曾用名**:\x20[','15px','padding','apiConfig','url(','.variation-price-input','[系统提示：你\x20','post-public-text','productInfo','✅\x20图片显示成功！🎨','./sw.js','notification-content','where','”下，发送了一个表情评论，意思是：“','[照片]','announcement-action-delete','https://i.postimg.cc/cHsTXDVz/IMG-7235.gif','input[name=\x22visibility_group\x22]:checked','utf-16be','将清空收藏夹中所有与该角色相关的内容（如聊天、动态、日记等）。','hasOwnProperty','请输入新的图片URL','&nbsp;','char-photo-item','character-phone-screen','isUserParticipating','scrollTop','\x27)\x22\x20data-comment=\x22','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-category\x22>','\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a','globalCss','选择歌词导入方式','选中的收藏已被移除。','Cleanup\x20Redundant\x20Data','检测到\x20UTF-8\x20BOM，使用\x20UTF-8\x20解码。','share-link-btn','fillStyle','setProperty','.sticker-category-tab','select-all-cart-items','textContent','#text-image-mode-content','character-profile-modal','offline-preset-select','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','management-mode','sender','data-lang-key-placeholder','btn-danger','isGroupCall','分类《','ArrowRight','<div\x20class=\x22lyric-line\x22>♪\x20暂无歌词\x20♪</div>','>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','https://i.postimg.cc/T1j03pQr/IMG-6440.jpg','精炼完成，请确认','人局，身份为\x20','contains','number','isAlive','无法生成浏览记录，请检查API配置或稍后再试。\x0a错误:\x20','https://api.vkeys.cn/v2/music/tencent?id=','sticker','character-nai-prompts-btn','原作者','lastMemorySummaryTimestamp','memo','[系统提示：用户（','<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>','请输入标题','werewolf-game-over-modal','已切换到角色\x20','isDanger','聊天记录','**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的【所有】足迹的\x20`timestamp`\x20字段，【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a\x20\x20\x20\x20-\x20\x20\x20请生成一个看起来像是过去几周内的、时间【从新到旧】排列的足迹列表。\x0a2.\x20\x20**创造性与合理性**:\x20足迹必须完全符合角色的性格、爱好、职业和生活环境。\x0a3.\x20\x20**多样性**:\x20地点类型要丰富，可以包括餐厅、商场、公园、公司、朋友家等。\x0a4.\x20\x20**【格式铁律\x20(最高优先级)】**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条足迹，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22locationName\x22:\x20\x22一个具体、生动的地点名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22address\x22:\x20\x22一个虚构但看起来很真实的详细地址\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22comment\x22:\x20\x22这是角色对这次出行或这个地点的内心独白或评论，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22(可选)一段用于生成这张地点照片的、详细的【英文】关键词,\x20风格为\x20realistic\x20photo,\x20high\x20quality\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x22符合\x20ISO\x208601\x20格式的日期时间字符串\x20(例如:\x20\x272025-09-25T18:30:00Z\x27)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**重要**:\x20大约有【三分之一】的足迹需要包含\x20`image_prompt`\x20字段来生成一张照片。\x0a\x20\x20\x20\x20-\x20**图片**:\x20image_prompt\x20生成的图片【绝对禁止包含真人】。如果地点是室内，可以生成空无一人的场景；如果是室外，可以只有风景或建筑。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20','import-preset-btn','werewolf-role-modal','add-message-editor-block-btn','target_timestamp','AI返回的change_music指令中，歌曲名无效或缺失:','\x22\x20class=\x22comment-sticker\x22\x20alt=\x22sticker\x22>','请至少选择一个要删除的世界书。','\x0a#\x20---\x20世界书设定结束\x20---\x0a','speaker','保存字体预设','nai-custom-proxy-url','uc_preset','chargingchange','\x22\x20(由\x20','https://i.postimg.cc/tC9mJ0cv/IMG-4438.gif','导出失败','originalMeaning','API\x20Temperature',']\x20的正则表达式无效:','原文:\x20\x22','doubanPosts','checked','add-group-avatar-url-btn','profile-random-jottings','Independent\x20Action\x20Cooldown\x20(min)','.variation-block','presetCategories','\x0a##\x20---\x20关于“','Save\x20All\x20Settings','save-appearance-preset-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','nai-uc-preset','导演模式保存(Sticker):\x20将\x20content\x20视为\x20URL，查找到\x20meaning:','分享新鲜事...','粘贴歌词','paddingBottom','\x22>+</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','#e9ecef','manage-sticker-categories-btn','key','variation-selected-price','favorite-item-card','\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器和故事作家。你的任务是扮演角色“','waimai-amount','确定要永久删除分类\x20“','photo-viewer-image','生成第','generate-shopping-items-btn','video_call_request','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quantity-control\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20decrease-qty-btn\x22\x20data-id=\x22','draggable','”。\x0a\x20\x20\x20\x20-\x20\x20\x20你【绝对不能】生成\x20authorName\x20或\x20commenter\x20字段为\x20“','exit-werewolf-game-btn','cphone-wallpaper-preview','matches','iVBORw0KGgo','back-to-char-qq-list-btn','\x27>语音</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','change_user_avatar','world-book-tabs','close-announcement-board-btn','\x20觉得很赞</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>',',\x0a\x22data\x22:\x20{\x0a','preset-editor-screen','seed','order','insertBefore','\x20删除了自己的一条动态]','choice','group-action-cooldown-input','Loading...','\x0a-\x20**作者**:\x20','Erase','delete-selected-products-btn','请输入一个有效的数字（建议大于20）。','version','\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','文件格式不正确，缺少关键的外观设置项。','\x27>图片动态</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','</span></div></div>','post-upload-local-btn','¥\x200.00','fontSize','target','狼人请选择刀人对象<br><small\x20style=\x22font-weight:normal;\x20font-size:\x2013px;\x22>你的队友是:\x20','default','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22douban-post-timestamp\x22>','#data-clear-char-list\x20.clear-posts-item','uncategorized','blockCooldownHours','https://i.postimg.cc/fRTF24jS/IMG-4430.gif','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22thought-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22/></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20心声\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>','thought-card','clear-posts-item','rule-template-input','https://i.postimg.cc/hPgyjtyn/IMG-7108.gif','严重警告！','lyrics-vertical-pos','User\x20Avatar','*事件*:\x20平安夜，无人出局。\x0a','Add\x20NPC','”添加记忆','\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20','导演/编辑模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','npc-background-activity-switch','playMode','addEventListener','listen-together-btn','.nai-gallery-download-btn','\x0a\x0a#\x20当前音乐情景\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**当前状态**:\x20你们正在和用户一起听歌。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20\x20\x20**正在播放**:\x20','favorites-search-input','https://i.postimg.cc/Lsr1Zd3Z/IMG-6928.gif','\x0a\x0a现在，请开始生成这组App使用记录。','\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片','请根据以上设定开始你的决策。','已使用','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有创建任何NPC，<br>点击右上角“+”添加第一个吧！</p>','clipboard','\x0a\x20\x20\x20\x20','专辑封面已更新！','start-werewolf-game-btn','确定要将选中的商品作为礼物送出吗？','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22\x20style=\x22color:\x20','utf-8','index','#custom-modal\x20.custom-modal-footer','animationend','getFullYear','last','在这里输入图片描述','导入已取消，因为未提供书名。','<span\x20class=\x22diary-messy\x22>$1</span>','reading-library-search-input','请AI角色们继续进行讨论。','请输入一个\x202\x20到\x20','\x20\x20\x20characterPositivePrompt:','你领取了\x20','.participant-avatar-wrapper[data-participant-id=\x22','】。\x0a2.\x20\x20**我掌握的秘密信息\x20(仅我可见)**:\x0a','.frame-item','ai-frame-tab','[这是你上一轮的内部思考]\x0a-\x20分析:\x20','收到了格式不规范的AI指令，已跳过:','\x22)\x20作为角色名。消息内容:','Background\x20Activity\x20Settings','确定要删除相册《','\x0a-\x20**你们最后的对话摘要**:\x20\x0a','is-transfer','novelai-switch','Edit\x20World\x20Book','each','[图片:\x20','<span\x20class=\x22commenter-name\x22>','preset-actions-modal','share-link-modal','”的TTS功能已关闭，已禁止发起TTS请求。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20可用表情包\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a\x20\x20\x20\x20\x20\x20\x20\x20','mouseleave','》及其下的表情已成功删除。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的任务\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中的用户刚刚发起了群视频通话。请你分别扮演【每一个群成员】，根据他们各自的人设和与用户的关系，来决定是加入(join)还是拒绝(decline)。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的回复【必须】是一个JSON数组，为【每一个AI角色】都包含一个决策对象。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20格式:\x20\x27[{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色A的本名\x22,\x20\x22decision\x22:\x20\x22join\x22},\x20{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色B的本名\x22,\x20\x22decision\x22:\x20\x22decline\x22}]\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20','10215UJKhuO','📋\x20直接粘贴歌词文本','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20','my-persona-group','API错误:\x20','无缓存，正在请求\x20Minimax\x20TTS\x20API...','确认拉黑','.favorite-item-card','cors','delete-group-btn','\x20张</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',')\x20试图将群名更改为成员名\x20(\x22','https://i.postimg.cc/PqYp5T5M/image.png','custom-modal-title','Name','rp-details-sender','思考中...','arc','char-browser-history','++id,\x20chatId,\x20timestamp,\x20customName','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22last-msg\x22>','save-font-preset-btn','你查验的玩家\x20','获取AI狼人目标失败:','</persona>\x0a</character>\x0a','”的聊天记录已成功导出！','-\x20**昵称:\x20','countdown-date-input','batch-import-frames-btn',')的关系请参考你的人设、长期记忆和最近的对话。\x0a','(ID:\x20','你输了','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>','\x22)。操作已被程序阻止。','\x0a\x0a#\x20待总结的视频通话记录\x0a','[图片内容:\x20','message-bubble\x20system-bubble','导演/编辑模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:','werewolf-game-over-close-btn','.world-book-category-pane','已成功删除\x20','currentTarget','删除分类后，该分类下的所有预设将变为“未分类”。确定吗？','candidates','红包已被领完！','member-avatar-preview','backgroundColor','all','#000000','dark','处理通话请求时API出错:','API\x20请求失败:\x20','product-category-tabs','friend','正在接通...','批量删除NAI图片时出错:','friend_request_response','关于“','[系统提示：你刚刚被用户拉黑了。在对方解除拉黑之前，你无法再主动发起对话，也无法回应。]','\x20分钟)</span>','正在根据“','12p','✅\x20清理完成！\x0a\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','https://i.postimg.cc/YSRRV8kn/IMG-6297.gif','is-link-share','Bilibili','source','temp_group_chat','setTimeout','my-avatar-library-grid','我的相册','https://i.postimg.cc/YqxxjbLp/IMG-6572.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22douban-cast-checkbox\x22\x20data-chat-id=\x22','album-art-btn','成功将角色\x20','-\x20**对话状态**:\x20(暂无有效对话历史)','\x20(用户)\x20或其他AI的发言，必须对他们的观点和逻辑做出回应。\x0a2.\x20\x20**记忆力与连贯性**:\x20你的新发言【必须】是基于**过去几天和今天发生的所有事件和讨论**的逻辑延续。\x0a3.\x20\x20**格式铁律**:\x20你的回复【必须且只能】是一个JSON数组，格式为:\x20`{\x22speaker_name\x22:\x20\x22角色的【昵称】\x22,\x20\x22dialogue\x22:\x20\x22发言内容\x22}`。**必须**为每一个存活的AI角色都生成一段发言。\x0a4.\x20\x20**称呼铁律**:\x20你的发言中【绝对禁止】提及任何玩家的编号。在对话中互相称呼时，你【必须】使用玩家的【本名】，而不是他们的昵称。\x0a\x0a#\x20','\x0a\x0a#\x20最近的动态列表\x20(供群内角色参考和评论):\x0a','.photo-delete-btn','https://i.postimg.cc/gj3Tmqz5/mmexport1751030241029.gif','qzone_delete_post',')\x20发起了群视频通话请求。请你们各自决策，并使用\x20\x22group_call_response\x22\x20指令，设置\x20\x22decision\x22\x20为\x20\x22join\x22\x20或\x20\x22decline\x22\x20来回应。]','无法生成记录，请检查API配置或稍后再试。\x0a错误:\x20','https://i.postimg.cc/CLz0cJ0d/IMG-7116.gif','fullscreen','猎人带走了\x20','无法找到分享记录:','transfer-modal','静音音频已停止。','#\x20场景设定\x0a','AI返回的投票结果中未找到有效的JSON数组结构\x20(`[...]`)。','删除相册','）。]','.music-search-checkbox','昨晚\x20','keyword-search-input','⚠️\x20NAI提示词：没有角色，使用系统配置','天核心议题','未知用户','findLastIndex','parts','translateY(','\x20的动态\x20(NPC)','chat-list-action-pin','gomoku-btn','open-memory-screen-btn','sticker-category-tabs','导演模式保存(Sticker):\x20使用了编辑器提供的完整JSON\x20(url\x20+\x20meaning)','video-call-btn','”的长期记忆中。','</p>\x0a\x20\x20\x20\x20','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20like\x20','toggle-fullscreen-btn','错误：找不到要转发的原始动态。','offline-mode-toggle',');\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sticker-name\x22>','诊断：在\x20extensions.character_book\x20中找到世界书。','狼人杀AI回应生成失败:','进入投票','douban-cast-select-btn','global-bg-preview','检测到新版流式备份文件，开始导入...','<div\x20class=\x22post-content\x22\x20style=\x22margin-bottom:\x2010px;\x22>','next-page-btn','https://i.postimg.cc/MG6qtLYK/IMG-5565.gif','flex','跳过格式错误的NAI图片Key:','{{user}}',';\x0a\x20\x20\x20\x20\x20\x20\x20\x20color:\x20white;\x0a\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2012px\x2024px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.3);\x0a\x20\x20\x20\x20\x20\x20\x20\x20z-index:\x2010000;\x0a\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2014px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20translateY(20px);\x0a\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20','is-sticker','chat_message','/9j/','Create\x20New\x20Rule','then','sort','个月前','My\x20Albums','appearancePresets','\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','waimai_request','payload','nai-test-result','preset-action-delete','stroke','history-back-btn','create-poll-modal','announcement-actions-modal','\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22color:\x20#8a8a8a;\x20margin:\x200\x200\x2010px\x200;\x22>账户余额</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2032px;\x20font-weight:\x20600;\x20color:\x20#1f1f1f;\x20margin:\x200;\x22>¥','shuoshuo','无共同好友','blocked_by_ai','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>日记本还是空的。</p>','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','智能导出\x20(推荐，速度快，内存占用小)','\x20(回复\x20','.lyric-line','open_red_packet','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>','myPersona','favorite','\x0a\x0a#\x20上下文参考\x20(你必须阅读并遵守)\x0a','message-editor-block','没有可导出的世界书数据。','删除记录',')\x20作者:\x20','相册名称','flex-start','”\x20已被删除。','-speech','entries','当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。','rp-direct-greeting','导入歌词','请先在API设置中配置好（主或副）API。','clear','Hello\x20World\x20你好世界','playerJson','cancel-contact-picker-btn','post-image-desc-group','icon-setting-item','你们正在一起读书。','scale(0.8)','\x22\x20class=\x22douban-post-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-author-name\x22>','QQ音乐','确认覆盖','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','批量导入格式错误，已跳过此行:','simulatedBrowserHistory','quality_toggle','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22url\x22>','**\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【视角铁律】**:\x20你的总结【必须】使用【主观的第一人称视角\x20(\x22我\x22)】来写。\x0a2.\x20\x20**【内容核心\x20(最高优先级)】**:\x20你的总结【必须】专注于以下几点：\x0a\x20\x20\x20\x20*\x20\x20\x20**重要事件**:\x20刚才发生了什么具体的事情？\x0a\x20\x20\x20\x20*\x20\x20\x20**关键决定**:\x20我们达成了什么共识或做出了什么决定？\x0a\x20\x20\x20\x20*\x20\x20\x20**未来计划**:\x20我们约定了什么未来的计划或待办事项？\x0a\x20\x20\x20\x20*\x20\x20\x20**重要时间点**:\x20对话中提到了哪些具体的日期或时间？\x0a3.\x20\x20**【时间转换铁律\x20(必须遵守)】**:\x20如果对话中提到了相对时间（如“明天”、“后天”），你【必须】结合“今天是','删除世界书','skipped','渲染器','waimai-timer-','对方已收款','Language\x20\x22','\x0a\x20\x20\x20\x20-\x20**读书**:\x20','npcId','transfer-btn','.qzone-post-container','\x22\x20生成行动失败:','”准备好友申请...','<span>删除</span>','已同步角色\x20','#\x20角色核心设定\x0a','确定要删除这条公告吗？此操作不可恢复。','lineTo','product-description-input','保留旧的','动态内容已复制到剪贴板。','确定要删除选中的\x20','正在执行删除操作...','生成成功！','解析成功：通过强力提取\x20[\x20...\x20}\x20...\x20]\x20模式。','click','log','订单详情','inject-thought-toggle','请先输入你的发言内容。','douban-detail-group','无法找到对应的分享记录或记录已损坏。','\x20的礼物','Character\x20Avatar','\x22\x20class=\x22preview-frame\x22>','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','qzone-posts-list','split','include','导演模式保存(Sticker):\x20使用了\x20URL，最终\x20meaning:','基础数据不完整，无法开始总结。','products','轮到你发言了...','voter_name','[私聊]','.product-item.selected','分类\x20\x22','encode','char-qq-transcript-modal','开场\x20','nai-custom-proxy-group','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x22>公告的原消息已被删除。</p>','https://i.postimg.cc/Fz3HwLk9/IMG-5569.gif','editable-text','\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','搜索歌曲','changedTouches','icon-settings-grid','currentPage','播放被中断，这是正常行为:','location_share','编辑\x20NPC','拼手气红包','frame_6','poll-question-input','gift-recipient-modal','character-selection-screen','生成的图片URL:','帖子详情','后台活动设置','togglePlayerFullscreen','buttonId','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>款式图片\x20(可选)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22avatar-upload\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20class=\x22variation-image-preview\x22\x20src=\x22','paused','群聊中没有成员有足够（2条以上）的记忆可供精炼。','lrcContent','meaning','Rule\x20Name','游戏配置：','\x22\x20checked>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','close-char-music-player-btn','writeText','API错误响应:','shoppingProductCount','worldBookCategories','\x22\x20class=\x22music-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-item-name\x22>','正在为角色\x20','”的对话摘要**:\x0a','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20你的【【【最高优先级任务】】】\x0a\x20\x20\x20\x20\x20\x20\x20\x20群聊中刚刚出现了一个由“','cancel-douban-cast-btn','input[value=\x22user\x22]','nai-result-image','https://i.postimg.cc/RhGH0vpt/IMG-7010.gif','”。请你回顾一下刚才和“','close-reading-library-btn-header','https://i.postimg.cc/7Zgm1wRy/IMG-6295.gif','压缩完成！','sticker-category-tab','你刚刚接听了用户的视频通话请求。','\x27);\x22','cart-count','row','https://api.vkeys.cn/v2/music/netease/lyric?id=','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20position:\x20absolute;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x2011px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x202px\x206px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x208px;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20rgba(0,\x200,\x200,\x200.1);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20var(--text-secondary);\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20white-space:\x20nowrap;\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transition:\x20all\x200.3s\x20ease;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','Reset','regenerate-char-qq-btn','这条动态的原始数据已被彻底清除。','当前群聊还没有公告哦。','模拟表情含义\x20\x22','drawImage','[ERROR:\x20','thoughts','favorites-list','sticker-upload-input','AI返回了空的或格式不正确的总结内容。','%;\x22></div><div\x20class=\x22poll-option-content\x22><span\x20class=\x22poll-option-text\x22>','确定要删除这条评论吗？','simulatedAmapHistory','import-preset-input','\x0a现在，请严格按照格式铁律，生成聊天记录的JSON数组。','steps','”的视频通话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','groupMembers','autoMemoryInterval','送出礼物','delete-transcript-btn','保存书籍(ID:\x20','\x22\x20(你可以建议修改)\x0a-\x20\x20\x20**你对用户的称呼**:\x20“','\x22\x20class=\x22product-image\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-name\x22>','world-book-entries-container','lastOpened','reload','\x22\x0a-\x20**用户的备注**:\x20\x22','.frame-grid','批量导入头像','\x20分钟)，本次独立行动跳过。','char-music-current-time','Edit',']。当在对话历史中看到这些名字时，它们都指的是【你】自己。','callHistory','操作失败，请检查API配置或稍后重试。\x0a错误信息:\x20','检查完成','正在检查\x20','群聊已建立...','你们在','https://i.postimg.cc/fycfcvHf/IMG-6569.gif','splice','character_book','Font\x20Preset\x20Management','”中，用户的昵称是“','命名头像','utf-16le','拉取主模型','并评论说：\x22','cursor','isLocal','渲染规则','char-article-content','此操作将永久删除您选择的\x20','input:checked','chatListRenderWindow','#\x20你的互动对象\x20(用户和其他角色)\x0a','\x20为您代付成功','AI方','确定要删除这张照片吗？此操作不可恢复。','提示词配置','.icon-setting-item','++id,\x20name,\x20createdAt','accept_transfer','https://i.postimg.cc/8kYShvrJ/90-UI-2.png','AI\x20(独立行动)\x20发送了一个没有\x20\x27meaning\x27\x20的\x20sticker\x20指令。','inject-thought-group','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有留下任何足迹，<br>点击右上角刷新按钮生成一些记录吧！</p>','handlePacketClick','qzone-post-item','.message-bubble.is-link-share','最终正面提示词:','[系统提示：你接受了“','summary','(无标题)','.gift-card','50%','secondary-proxy-url','\x20发送了一条语音，内容是：\x27','sticker-panel','[表情:\x20\x27','》:\x0a','Caching\x20rendering\x20rules\x20for\x20chat:\x20','width','请你对此作出回应。]','memories','\x20红包已被领完，手气王是\x20','结束投票','\x22\x20data-poll-timestamp=\x22','是狼...”)\x0a\x20\x20\x20\x20-\x20(例如：我的敌人发言了，我的表演就是无视TA的逻辑，直接攻击TA。)\x0a\x20\x20\x20\x20-\x20(例如：我是一个','仅清空\x20','justifyContent','https://i.postimg.cc/Wbr0JSDD/IMG-5316.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>','douban-detail-avatar','JSZip\x20流错误:','lineWidth','容错解析：策略2成功\x20(提取了summary字段内容)','\x22的角色（你的本名是\x22','TA的淘宝订单','download','select-all-stickers-checkbox','10px\x2015px\x2020px\x2015px','share-target-modal','\x22\x20的独立行动失败:','save-preset-btn','onclick','.header','Memo','#image-mode-content','compressed','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','nai-cfg-scale','enableAutoMemory','\x20个新头像框！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','album-photo-input','请点击右上角的“角色选择”按钮，选择至少一个参与豆瓣互动的角色。','logo,\x20simple,\x20flat\x20design,\x20for\x20a\x20group\x20chat\x20named\x20\x27','\x0a-\x20角色思考:\x20','https://api.vkeys.cn/v2/music/netease?id=','new-product-category-name-input','导入备份将完全覆盖您当前的所有数据。此操作不可撤销！确定要继续吗？','delete-selected-nai-gallery-btn','</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-price\x22>','删除世界书失败:','API请求失败:\x20','.message-bubble','hiddenContent','</td><td\x20class=\x22item-qty\x22>','\x0a#\x20你的角色设定：\x0a你必须严格遵守','imageCount','call','warn','Language\x20switched.\x20The\x20page\x20will\x20reload\x20to\x20apply\x20changes.','删除分类后，该分类下的所有商品将变为“未分类”。确定吗？','最近支出','\x27>文本</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27','确定要删除《','用户描述的照片','transfer-action-decline','长截图','[图片，描述:\x20','<div\x20class=\x22link-share-card\x22\x20data-timestamp=\x22','cart-screen','is-raw-html','文件格式无法识别。未找到有效的\x20\x27prompts\x27\x20数组或\x20\x27entries\x27\x20对象。','aiAvatarLibrary',')，接收人是“','友善的评论是交流的起点','\x0a---\x0a','isGroup','\x22\x20的独立行动API返回为空或格式不正确，本次跳过。','<span\x20style=\x22color:\x20red;\x22>未满足</span>','获取更新通知文件失败。','visibilitychange','\x22\x20处于行动冷却中\x20(还剩\x20','Listen\x20Together','https://i.postimg.cc/kGgwJhPH/IMG-4374.gif','<span\x20class=\x22spoiler\x22>$1</span>','🚀\x20发送NAI请求:','https://i.postimg.cc/k5Gs0K47/IMG-6567.gif','spectator','https://i.postimg.cc/85Zsyjwn/IMG-6895.gif','[发送了一条语音，内容是：','[图片生成失败:\x20','option','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>没有可以删除的世界书。</p>','https://api.vkeys.cn/v2/music/tencent/lyric?id=','此操作将检查播放列表中的每一首网络歌曲，并移除所有无法播放的“死链”。本地歌曲不会受影响。','AI未能成功描述图片。','quality','生成图像','\x0a\x0a#\x20【其他核心规则】\x0a1.\x20\x20**叙事视角**:\x20叙述人称【必须】严格遵循“预设”中的第一人称、第二人称或第三人称规定。\x0a2.\x20\x20**字数要求**:\x20你生成的\x20`content`\x20总内容应在\x20**','相册\x20\x22','injectLatestThought','douban-post-detail-screen','send-poll-btn','chat-list','TTS\x20音频已保存到缓存。','正在重试\x22','fontUrl','\x0a---\x20复盘结束\x20---','更换图片','authorId','名为\x20“','\x22\x20点赞了动态\x20#','总结失败','pat-btn','char-qq-screen','导演模式保存了一个无效的五子棋移动指令:','.ai-generated-image','play','imageUrls','<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>还没有创建任何世界书</p>','char-usage-screen','locationName','AI\x20(','my-group-nickname-group','狼人请睁眼，请选择要刀的玩家。','https://i.postimg.cc/x1Hp80Rm/IMG-4417.gif','✅\x20NAI提示词：使用角色配置','arrayBuffer','players','[系统消息]\x20','call-history-list','代付请求已被拒绝','张图片','douban-comment-input','join-call-btn','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22',')，并在对话中自然地体现出来。','页面跳转','https://i.postimg.cc/Vv8jkCYr/IMG-6574.gif','<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20width=\x2220\x22\x20height=\x2220\x22\x20fill=\x22currentColor\x22\x20style=\x22vertical-align:\x20middle;\x22><path\x20d=\x22M12\x2021.35l-1.45-1.32C5.4\x2015.36\x202\x2012.28\x202\x208.5\x202\x205.42\x204.42\x203\x207.5\x203c1.74\x200\x203.41.81\x204.5\x202.09C13.09\x203.81\x2014.76\x203\x2016.5\x203\x2019.58\x203\x2022\x205.42\x2022\x208.5c0\x203.78-3.4\x206.86-8.55\x2011.54L12\x2021.35z\x22></path></svg>','select-message-btn','\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27','</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-weight:\x20600;\x20font-size:\x2016px;\x20color:\x20#ff5722;\x22>-\x20¥','lastFailedAction','投票至少需要2个选项。','%)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<br><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20建议刷新页面以应用所有更改。','isClosed','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-nickname\x22>','\x20\x20\x20负面:','vertical','”。请你对此作出回应。]','search-results-list','请输入提示词！','globalSettings','天，救人概率为\x20','selection-share-btn','图片详情','nai-diffusion-4-5-full','close-novelai-settings','请先配置NovelAI\x20API\x20Key！','照片描述','\x22。\x0a','NPC\x20\x22','\x22\x20class=\x22chat-image\x22></div>','cancel-product-editor-btn','status_msg','这个预设文件中没有找到任何有效的提示词条目。','https://i.postimg.cc/HWf1JKzn/IMG-6435.jpg','enableBackgroundActivity','chat-settings-btn','小时内退还。','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-header\x22>','character-select-item','existing-sticker-categories-list','[发送了一张图片，描述为：\x27','\x20为你切歌:\x20《','收藏成功','https://i.postimg.cc/qRCtnMms/IMG-6145.gif','equals','playlist','cfg_scale','code','<p\x20style=\x22text-align:\x20left;\x20white-space:\x20pre-wrap;\x22>','search-result-item','books','AI返回的内容中未找到有效的JSON对象。','链接分享','AI返回的数据不是一个数组。原始返回:\x20','编辑通话消息','https://i.postimg.cc/50k390X8/IMG-6376.gif','chat-input-actions-top','address','开始检查并迁移旧的红包数据...','检测到刚结束的通话，正在注入通话记录上下文...','”思考后决定暂时不发送好友申请，将重置冷静期。','在导演模式保存时，遇到了未知的AI指令类型:','确定要结束这个投票吗？结束后将无法再进行投票。','scroll','\x22,\x20\x22postId\x22:\x20123,\x20\x22replyTo\x22:\x20\x22被回复者本名\x22,\x20\x22commentText\x22:\x20\x22@[[被回复者本名]]\x20你的回复\x22}]`\x0a-\x20\x20\x20**点赞动态**:\x20`{\x22type\x22:\x20\x22qzone_like\x22,\x20\x22postId\x22:\x20456}`\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22suffix\x22:\x20\x22(可选)后缀\x22}`\x0a-\x20\x20\x20**分享链接**:\x20`{\x22type\x22:\x20\x22share_link\x22,\x20\x22title\x22:\x20\x22标题\x22,\x20\x22description\x22:\x20\x22摘要\x22,\x20\x22source_name\x22:\x20\x22来源\x22,\x20\x22content\x22:\x20\x22正文\x22}`\x0a-\x20**共享位置**:\x20\x27{\x22type\x22:\x20\x22location_share\x22,\x20\x22content\x22:\x20\x22你想分享的位置名\x22}\x27\x0a\x0a###\x20状态与关系指令\x0a-\x20\x20\x20**更新状态**:\x20`{\x22type\x22:\x20\x22update_status\x22,\x20\x22status_text\x22:\x20\x22我去做什么了\x22,\x20\x22is_busy\x22:\x20false}`\x0a-\x20\x20\x20**改自己昵称**:\x20`{\x22type\x22:\x20\x22change_remark_name\x22,\x20\x22new_name\x22:\x20\x22新名字\x22}`\x0a-\x20\x20\x20**改用户昵称**:\x20`{\x22type\x22:\x20\x22change_user_nickname\x22,\x20\x22new_name\x22:\x20\x22新称呼\x22}`\x0a-\x20\x20\x20**换自己头像**:\x20`{\x22type\x22:\x20\x22change_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从你头像库选)\x0a-\x20\x20\x20**换用户头像**:\x20`{\x22type\x22:\x20\x22change_user_avatar\x22,\x20\x22name\x22:\x20\x22头像名\x22}`\x20(从用户头像库选)\x0a-\x20\x20\x20**回应好友申请**:\x20`{\x22type\x22:\x20\x22friend_request_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**拉黑用户**:\x20`{\x22type\x22:\x20\x22block_user\x22}`\x0a\x0a###\x20特殊功能指令\x0a-\x20\x20\x20**记录回忆**:\x20`{\x22type\x22:\x20\x22create_memory\x22,\x20\x22description\x22:\x20\x22记录这件有意义的事。\x22}`\x0a-\x20\x20\x20**创建约定**:\x20`{\x22type\x22:\x20\x22create_countdown\x22,\x20\x22title\x22:\x20\x22约定标题\x22,\x20\x22date\x22:\x20\x22YYYY-MM-DDTHH:mm:ss\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发起转账**:\x20`{\x22type\x22:\x20\x22transfer\x22,\x20\x22amount\x22:\x205.20,\x20\x22note\x22:\x20\x22备注\x22}`\x0a-\x20\x20\x20**回应转账**:\x20`{\x22type\x22:\x20\x22accept_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x20或\x20`{\x22type\x22:\x20\x22decline_transfer\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2025}`\x20(你想让【用户】帮你付钱时使用)\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22status\x22:\x20\x22paid\x22\x20or\x20\x22rejected\x22,\x20\x22for_timestamp\x22:\x20时间戳}`\x0a-\x20\x20\x20**发起视频通话**:\x20`{\x22type\x22:\x20\x22video_call_request\x22}`\x0a-\x20\x20\x20**回应视频通话**:\x20`{\x22type\x22:\x20\x22video_call_response\x22,\x20\x22decision\x22:\x20\x22accept\x22\x20or\x20\x22reject\x22}`\x0a-\x20\x20\x20**下五子棋**:\x20`{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22','内心独白','\x0a-\x20\x20\x20**转发动态**:\x20`[{\x22type\x22:\x20\x22repost\x22,\x20\x22postId\x22:\x20动态ID,\x20\x22comment\x22:\x20\x22转发评论\x22}]`\x20(禁止自己拼接\x22//转发\x22)\x0a-\x20\x20\x20**评论动态**:\x0a\x20\x20\x20\x20-\x20\x20\x20文字:\x20`[{\x22type\x22:\x20\x22qzone_comment\x22,\x20\x22name\x22:\x20\x22','openRenderingRulesScreen','https://i.postimg.cc/cJpbtPWq/mmexport1751036607799.gif','上传成功！','hiddenText','收到\x20SSE\x20数据，大小:','cphone-icon-img-','lastActionTimestamp','<div\x20class=\x22poll-option-item\x20','chat-header-title','secondary-api-key','https://i.postimg.cc/gJ95NSRB/IMG-6854.gif','regenerate-char-memo-btn','AI\x20获胜了！','创建世界书','recalled_message','ArrowLeft','\x0a##\x20阶段2：生成最终对话\x20(Final\x20JSON\x20Output)\x0a你现在已经为【所有AI角色】都完成了“TGS三核”独立思考。\x0a请根据你在“阶段C：最终发言稿”中为每个角色准备好的草稿，生成最终的、符合格式的JSON数组。\x0a','”\x20以及其他群成员的【群组视频通话】，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：','”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近的“高德地图”出行足迹。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【时间\x20(最高优先级)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20今天的日期是\x20**','gift','gomoku-overlay','<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22','create-post-btn','character_thoughts','get','网络图片\x20(CPhone)','自动总结成功：已成功添加\x201\x20条新的长期记忆！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22force-apply-check-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20style=\x22margin-top:\x2010px;\x22>强制触发一次好友申请检测</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20style=\x22margin-right:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22','catch','**关键词:**\x20','操作结果','setHours','\x22><div\x20class=\x22rp-header\x22><img\x20src=\x22https://files.catbox.moe/lo9xhc.png\x22\x20class=\x22rp-icon\x22><span\x20class=\x22rp-greeting\x22>','prompts','.waimai-details-btn','manual-summarize-btn','none','local-song-upload-input','个红包，共','manage-groups-btn','修复了角色\x20\x22','#char-chat-list\x20.chat-list-item','getTimezoneOffset','href','检测到应用离线了\x20','(无标题投票)','char-photo-description','parse','werewolf-game-btn','</div><div\x20class=\x22footer\x22><svg\x20class=\x22footer-icon\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path></svg><span>','pageY','focus','已删除最后一条心声，当前心声已重置。','save-member-settings-btn','https://i.postimg.cc/sDFhySn3/IMG-6936.gif','linked-memory-count','删除成功','Voice\x20Model','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22poll-option-input\x22\x20placeholder=\x22选项内容...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-option-btn\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','qzone','groupName','https://i.postimg.cc/gJNYx9pV/IMG-6856.gif','）刚刚拍了拍你（','call-record-card','请输入有效的红包个数！','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22cart-item-price\x22>¥','</span></div><div\x20class=\x22rp-type\x22>','\x20的记忆\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','numeric','”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份会议纪要或备忘录，而不是一篇抒情散文。\x0a5.\x20\x20**【长度铁律】**:\x20你的总结【必须】非常简短，总长度【绝对不能超过80个字】。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x0a','frame_cat_ear','还没有可供编辑的AI响应。请先让AI回复一次。','\x27刚刚在你的动态“','Renderer','[系统提示：','member-management-screen','blob','favorites','，人设:\x20','应用已切换到后台，记录当前时间。','nai-gallery-action-bar','\x0a###\x20详细对局流程:\x0a','检测到好友申请待处理状态，为角色\x20\x22','https://i.postimg.cc/k5P1NHcL/55f3e31d8qbc8a02d152b07b99d31567.gif','请输入一个有效的URL或选择一个文件！','crossOrigin','char-amap-item','reset-button-order-btn','delete-css-preset-btn','主API设置\x20(用于聊天)','API请求失败\x20(','\x20(时长:\x20','variation-product-image','\x0a-\x20\x20\x20**五子棋局势**:\x20','AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20','input[value=\x22','floor','product-category-manager-modal','#chat-interface-screen\x20>\x20.header','AI\x20(CPhone)\x20尝试使用一个不存在的表情:\x20\x22','currentLyricIndex','char-memo-detail-content','<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>','cancel-frame-settings-btn','default_negative','createElement','ceil','title','string','#data-clear-char-list\x20.clear-posts-item.selected','</span>\x20:\x20<span>','theme-default','\x22\x20data-option=\x22','AI\x20尝试赠送一个格式不正确的随机礼物:','chat-list-action-delete','\x22\x20id=\x22','请先进入一个聊天页面，再返回购物中心进行生成，以便AI了解要为哪个角色生成商品。','sourceChatName','call-transcript-modal-body','<span\x20class=\x22diary-handwritten\x22>$1</span>','生成豆瓣帖子失败:','set','https://i.postimg.cc/4yCXW52F/mmexport1751030908335.gif','保存CSS预设','music-playlist-panel','Moments','\x0a\x0a#\x20可用资源\x0a-\x20\x20\x20**你的头像库**:\x0a\x20\x20\x20\x20','✅\x20检查完成，未发现任何冗余数据。','avatar','</span><span\x20class=\x22delete-group-btn\x22\x20data-id=\x22','frame-item','\x22\x20style=\x22max-width:\x20100%;\x20border-radius:\x208px;\x20box-shadow:\x200\x204px\x2010px\x20rgba(0,0,0,0.1);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','\x20是我的重要互动对象（用户）。\x0a','https://i.postimg.cc/L4zwDhTC/IMG-4399.gif','auto','所有世界书数据已成功导出！','群成员','add-new-rule-btn','substring','char-background-activity-switch','\x22\x20处于行动冷却中，本次独立行动跳过。','\x0a##\x20世界书《','simulatedMusicPlaylist','#data-clear-type-list\x20.clear-posts-item','remove','”。用户刚刚在TA的手机（CPhone）上点击了一个按钮，希望你能继续你们之前的对话。你的任务是根据上下文，生成【3到5条】符合你人设的、简短的、连续的新回复。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组，每个对象代表一条消息。\x0a-\x20格式:\x20`[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第一句话\x22},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22第二句话\x22},\x20{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(从可用表情列表选择)\x22}]`\x0a-\x20你可以自由组合使用\x20\x22text\x22,\x20\x22sticker\x22,\x20\x22ai_image\x22,\x20\x22voice_message\x22\x20等多种消息类型。\x0a请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20你的角色设定\x0a','safetyRatings','</persona>\x0a\x20\x20<memory>','检测到旧版完整备份文件，开始导入...','promptFeedback','3.\x20\x20**我看到的公开信息\x20(所有人可见)**:\x0a\x20\x20\x20\x20-\x20**昨晚事件**:\x20','</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','visibilityState','TA的好友包括:\x20','\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后立刻撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22content\x22:\x20\x22你想让AI说出后立刻消失的话\x22}`\x20(用于模拟说错话、后悔等场景，消息会短暂出现后自动变为“已撤回”)\x0a\x0a###\x20社交与互动指令\x0a-\x20\x20\x20**发动态(说说)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22shuoshuo\x22,\x20\x22content\x22:\x20\x22文字内容\x22}]`\x0a-\x20\x20\x20**发动态(文字图)**:\x20`[{\x22type\x22:\x20\x22qzone_post\x22,\x20\x22postType\x22:\x20\x22text_image\x22,\x20\x22publicText\x22:\x20\x22(可选)公开文字\x22,\x20\x22hiddenContent\x22:\x20\x22图片描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}]`\x0a','predicate\x20must\x20be\x20a\x20function','bulkPut','\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20附加上下文：一段分享的聊天记录\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20重要提示：这不是你和当前用户的对话，而是用户从【另一场】与“','https://i.postimg.cc/Qx5dqyJ3/IMG-6917.gif','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22timestamp\x22>','[系统提示：用户加入了通话]','确定要从你的头像库中删除“','label','请输入你想为Ta设置的【备注名】(例如:\x20哥哥)','添加人设预设'];_0x4885=function(){return _0x309612;};return _0x4885();}function getRandomValue(_0x3038aa){const _0x565fe3=_0x2266a6;if(_0x3038aa[_0x565fe3(0xe53)](',')){const _0x99c997=_0x3038aa[_0x565fe3(0x108c)](',')[_0x565fe3(0xb96)](_0x520962=>_0x520962['trim']()),_0x41ae19=Math[_0x565fe3(0x1245)](Math[_0x565fe3(0x95f)]()*_0x99c997[_0x565fe3(0x40f)]);return _0x99c997[_0x41ae19];}return _0x3038aa;}function isImage(_0x33c4a0){const _0x49b0bf=_0x2266a6;if(_0x33c4a0[_0x49b0bf(0x6da)]&&_0x33c4a0['image_url'][_0x49b0bf(0xe52)]){let _0x3de753=_0x33c4a0[_0x49b0bf(0x6da)][_0x49b0bf(0xe52)];const _0x18ada8=_0x3de753[_0x49b0bf(0x108c)](',')[0x1],_0x581a84=_0x3de753[_0x49b0bf(0x132a)](/^data:(.*);base64/)[0x1];return[{'text':_0x49b0bf(0xbc8)},{'inline_data':{'mime_type':_0x581a84,'data':_0x18ada8}}];}return[];}function getGeminiResponseText(_0x585b37){const _0x591066=_0x2266a6;if(_0x585b37['choices']&&Array[_0x591066(0x97e)](_0x585b37[_0x591066(0x4fe)])&&_0x585b37[_0x591066(0x4fe)]['length']>0x0&&_0x585b37['choices'][0x0][_0x591066(0x854)]&&_0x585b37['choices'][0x0][_0x591066(0x854)][_0x591066(0x3ba)])return _0x585b37[_0x591066(0x4fe)][0x0][_0x591066(0x854)][_0x591066(0x3ba)];if(_0x585b37['candidates']&&Array['isArray'](_0x585b37[_0x591066(0xfd3)])&&_0x585b37[_0x591066(0xfd3)]['length']>0x0&&_0x585b37['candidates'][0x0][_0x591066(0x3ba)]&&_0x585b37[_0x591066(0xfd3)][0x0]['content'][_0x591066(0x100d)])return _0x585b37[_0x591066(0xfd3)][0x0][_0x591066(0x3ba)]['parts'][0x0][_0x591066(0x673)];console[_0x591066(0xc60)](_0x591066(0xdab),_0x585b37);let _0x3d44b8=_0x591066(0xb82);if(_0x585b37[_0x591066(0xfd3)]&&Array[_0x591066(0x97e)](_0x585b37[_0x591066(0xfd3)])&&_0x585b37['candidates'][_0x591066(0x40f)]>0x0&&_0x585b37[_0x591066(0xfd3)][0x0][_0x591066(0x13ca)]===_0x591066(0x4ea)){const _0x3ba9c3=_0x585b37[_0x591066(0xfd3)][0x0][_0x591066(0x1277)],_0x1037de=_0x3ba9c3['filter'](_0x223bda=>_0x223bda[_0x591066(0x9a)]!==_0x591066(0x128c)&&_0x223bda[_0x591066(0x9a)]!==_0x591066(0xbb9))[_0x591066(0xb96)](_0x1eed32=>_0x1eed32[_0x591066(0x6b3)]+_0x591066(0xe3)+_0x1eed32[_0x591066(0x9a)]+')')[_0x591066(0xd22)](',\x20');_0x3d44b8=_0x591066(0x377)+(_0x1037de||'未知');}else{if(_0x585b37[_0x591066(0x127a)]?.[_0x591066(0x23d)]){const _0x4eabca=_0x585b37[_0x591066(0x127a)]['blockReason'],_0x329e6c=_0x585b37[_0x591066(0x127a)][_0x591066(0x1277)]?.[_0x591066(0xb96)](_0x5b08d4=>_0x5b08d4[_0x591066(0x6b3)]+':\x20'+_0x5b08d4[_0x591066(0x9a)])[_0x591066(0xd22)](',\x20');_0x3d44b8=_0x591066(0xbb8)+_0x4eabca+_0x591066(0x300)+(_0x329e6c||'无');}else _0x585b37[_0x591066(0xc60)]&&(_0x3d44b8=_0x591066(0xfac)+_0x585b37['error'][_0x591066(0x854)]);}throw new Error(_0x3d44b8);}document[_0x2266a6(0xf72)]('DOMContentLoaded',()=>{const _0x5a7792=_0x2266a6;document[_0x5a7792(0xf72)]('visibilitychange',()=>{const _0x58b5e0=_0x5a7792;document[_0x58b5e0(0x127d)]===_0x58b5e0(0x40a)&&(console[_0x58b5e0(0x1081)](_0x58b5e0(0x76b)),navigator[_0x58b5e0(0xb6)][_0x58b5e0(0x456)][_0x58b5e0(0x102e)](_0x1c4c2c=>{_0x1c4c2c['update']();}));});function _0x250668(_0x1fb2ca,_0x24ec0c,_0x867ff2,_0x2a9b0a){const _0x3824db=_0x5a7792,_0x378b56=_0x3e7a1b[_0x3824db(0x11b4)][_0x3824db(0xa55)]||0.8,_0x39d3b5={'user':_0x3824db(0xa4d),'assistant':_0x3824db(0xd90),'system':'user'},_0x5ec803=[{'role':_0x3824db(0xa4d),'parts':[{'text':_0x867ff2}]},{'role':_0x3824db(0xd90),'parts':[{'text':'好的，我明白了。我会严格遵守以上所有规则和设定。'}]},..._0x2a9b0a[_0x3824db(0xb96)](_0x16da7b=>{const _0x2c5919=_0x3824db,_0x2648a2=[];return Array[_0x2c5919(0x97e)](_0x16da7b['content'])?_0x16da7b[_0x2c5919(0x3ba)][_0x2c5919(0x103)](_0x5b4a9d=>{const _0x10b3a4=_0x2c5919;if(_0x5b4a9d['type']==='text')_0x2648a2['push']({'text':_0x5b4a9d[_0x10b3a4(0x673)]});else{if(_0x5b4a9d['type']===_0x10b3a4(0x6da)&&_0x5b4a9d[_0x10b3a4(0x6da)]&&_0x5b4a9d[_0x10b3a4(0x6da)][_0x10b3a4(0xe52)]){const _0x5256f7=_0x5b4a9d[_0x10b3a4(0x6da)][_0x10b3a4(0xe52)],_0x2952f9=_0x5256f7[_0x10b3a4(0x108c)](',')[0x1],_0x4eb7c1=_0x5256f7[_0x10b3a4(0x132a)](/^data:(.*);base64/);_0x4eb7c1&&_0x2952f9&&_0x2648a2[_0x10b3a4(0x13ee)]({'inline_data':{'mime_type':_0x4eb7c1[0x1],'data':_0x2952f9}});}}}):_0x2648a2[_0x2c5919(0x13ee)]({'text':String(_0x16da7b[_0x2c5919(0x3ba)])}),{'role':_0x39d3b5[_0x16da7b['role']],'parts':_0x2648a2};})];return{'url':'https://generativelanguage.googleapis.com/v1beta/models/'+_0x1fb2ca+_0x3824db(0xd8)+getRandomValue(_0x24ec0c),'data':{'method':_0x3824db(0x2d1),'headers':{'Content-Type':_0x3824db(0x7fe)},'body':JSON[_0x3824db(0xe3f)]({'contents':_0x5ec803,'generationConfig':{'temperature':_0x378b56}})}};}const _0x4e1bbf=new Dexie(_0x5a7792(0xa99)),_0x1f4fc7=[{'id':_0x5a7792(0x1209),'url':'','name':'无'},{'id':_0x5a7792(0x122b),'url':_0x5a7792(0x1d2),'name':'1'},{'id':'frame_ribbon','url':_0x5a7792(0x481),'name':'2'},{'id':'frame_flower','url':'https://i.postimg.cc/jCVK0fGL/IMG-6890.gif','name':'3'},{'id':_0x5a7792(0x6d7),'url':_0x5a7792(0x1173),'name':'4'},{'id':_0x5a7792(0xb13),'url':_0x5a7792(0x13a6),'name':'5'},{'id':_0x5a7792(0x10a6),'url':_0x5a7792(0x5b5),'name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/cHQPgzj4/IMG-6888.gif','name':'7'},{'id':_0x5a7792(0x137b),'url':_0x5a7792(0x9d1),'name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0x79e),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0xda),'name':'10'},{'id':_0x5a7792(0xcfd),'url':'https://i.postimg.cc/zvz2LGK0/IMG-4367.gif','name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x95a),'name':'12'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/gk0BmrY0/IMG-4371.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x404),'name':'14'},{'id':'frame_cat_ear','url':_0x5a7792(0x116e),'name':'1'},{'id':_0x5a7792(0x9d7),'url':'https://i.postimg.cc/PrcKH436/IMG-4376.gif','name':'2'},{'id':_0x5a7792(0x225),'url':_0x5a7792(0x152),'name':'3'},{'id':_0x5a7792(0x6d7),'url':'https://i.postimg.cc/HsyqMVyk/IMG-4385.gif','name':'4'},{'id':_0x5a7792(0xb13),'url':_0x5a7792(0x46f),'name':'5'},{'id':'frame_6','url':_0x5a7792(0x988),'name':'6'},{'id':_0x5a7792(0xd9e),'url':_0x5a7792(0x613),'name':'7'},{'id':_0x5a7792(0x137b),'url':_0x5a7792(0x5c8),'name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0xc49),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0x33b),'name':'10'},{'id':'frame_11','url':_0x5a7792(0x5ba),'name':'11'},{'id':'frame_12','url':_0x5a7792(0x642),'name':'12'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/CLrZQMMD/IMG-4398.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x126a),'name':'14'},{'id':_0x5a7792(0x122b),'url':_0x5a7792(0xe08),'name':'1'},{'id':'frame_ribbon','url':_0x5a7792(0x372),'name':'2'},{'id':_0x5a7792(0x225),'url':'https://i.postimg.cc/g0s1V0PX/IMG-4402.gif','name':'3'},{'id':_0x5a7792(0x6d7),'url':'https://i.postimg.cc/Jn1DFPgY/IMG-4403.gif','name':'4'},{'id':'frame_5','url':_0x5a7792(0x95d),'name':'5'},{'id':_0x5a7792(0x10a6),'url':'https://i.postimg.cc/RFK3q2t0/IMG-4407.gif','name':'6'},{'id':_0x5a7792(0xd9e),'url':'https://i.postimg.cc/gcV0VR2t/IMG-4408.gif','name':'7'},{'id':'frame_8','url':_0x5a7792(0x5d2),'name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0xcd5),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0x131b),'name':'10'},{'id':_0x5a7792(0xcfd),'url':_0x5a7792(0x1da),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x131f),'name':'12'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/hPX5F8Qp/IMG-4415.gif','name':'13'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/vHCSG1WM/IMG-4416.gif','name':'14'},{'id':_0x5a7792(0x122b),'url':_0x5a7792(0x1198),'name':'1'},{'id':_0x5a7792(0x9d7),'url':_0x5a7792(0x63b),'name':'2'},{'id':'frame_flower','url':'https://i.postimg.cc/13hhJ77p/IMG-4419.gif','name':'3'},{'id':_0x5a7792(0x6d7),'url':_0x5a7792(0x23e),'name':'4'},{'id':_0x5a7792(0xb13),'url':_0x5a7792(0x244),'name':'5'},{'id':'frame_6','url':_0x5a7792(0x83b),'name':'6'},{'id':_0x5a7792(0xd9e),'url':_0x5a7792(0x832),'name':'7'},{'id':'frame_8','url':_0x5a7792(0x1db),'name':'8'},{'id':'frame_9','url':_0x5a7792(0xc05),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0xb9),'name':'10'},{'id':_0x5a7792(0xcfd),'url':_0x5a7792(0xf62),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x41d),'name':'12'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xe4c),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xf16),'name':'14'},{'id':_0x5a7792(0x122b),'url':'https://i.postimg.cc/XNkQTHvf/IMG-5561.gif','name':'1'},{'id':_0x5a7792(0x9d7),'url':'https://i.postimg.cc/Mpv5fzm5/IMG-4439.gif','name':'2'},{'id':_0x5a7792(0x225),'url':'https://i.postimg.cc/T1tjhsyB/IMG-4720.gif','name':'3'},{'id':_0x5a7792(0x6d7),'url':_0x5a7792(0xd01),'name':'4'},{'id':'frame_5','url':_0x5a7792(0xc3e),'name':'5'},{'id':_0x5a7792(0x10a6),'url':_0x5a7792(0x4f7),'name':'6'},{'id':_0x5a7792(0xd9e),'url':'https://i.postimg.cc/Lsjzj5Yt/IMG-4729.gif','name':'7'},{'id':_0x5a7792(0x137b),'url':_0x5a7792(0x12c7),'name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0x92b),'name':'9'},{'id':_0x5a7792(0xb95),'url':'https://i.postimg.cc/DZshzKv6/IMG-5576.gif','name':'10'},{'id':_0x5a7792(0xcfd),'url':_0x5a7792(0x7ae),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x109b),'name':'12'},{'id':'frame_13','url':_0x5a7792(0x198),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x1025),'name':'14'},{'id':_0x5a7792(0x122b),'url':_0x5a7792(0x70a),'name':'1'},{'id':_0x5a7792(0x9d7),'url':_0x5a7792(0x323),'name':'2'},{'id':'frame_flower','url':_0x5a7792(0x323),'name':'3'},{'id':'frame_tech','url':_0x5a7792(0x925),'name':'4'},{'id':'frame_5','url':_0x5a7792(0x916),'name':'5'},{'id':_0x5a7792(0x10a6),'url':'https://i.postimg.cc/FzM1Hgr0/IMG-5717.gif','name':'6'},{'id':'frame_7','url':'https://i.postimg.cc/rF4KYbjj/IMG-5720.gif','name':'7'},{'id':_0x5a7792(0x137b),'url':'https://i.postimg.cc/6pLTBvDG/IMG-5721.gif','name':'8'},{'id':_0x5a7792(0xd64),'url':'https://i.postimg.cc/VNK6Ccsf/IMG-5722.gif','name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0xa39),'name':'10'},{'id':_0x5a7792(0xcfd),'url':_0x5a7792(0x710),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0xc7d),'name':'12'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x4dc),'name':'13'},{'id':'frame_14','url':_0x5a7792(0xb46),'name':'14'},{'id':'frame_cat_ear','url':_0x5a7792(0x3d8),'name':'1'},{'id':_0x5a7792(0x9d7),'url':'https://i.postimg.cc/9fQZ425b/IMG-5975.gif','name':'2'},{'id':_0x5a7792(0x225),'url':'https://i.postimg.cc/v8V9xXjJ/IMG-6137.gif','name':'3'},{'id':_0x5a7792(0x6d7),'url':_0x5a7792(0xd4d),'name':'4'},{'id':'frame_5','url':'https://i.postimg.cc/Dw2bDhZh/IMG-6140.gif','name':'5'},{'id':_0x5a7792(0x10a6),'url':'https://i.postimg.cc/ZqQBCyLY/IMG-6144.gif','name':'6'},{'id':_0x5a7792(0xd9e),'url':_0x5a7792(0x11cc),'name':'7'},{'id':_0x5a7792(0x137b),'url':_0x5a7792(0xba2),'name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0x5a4),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0xacf),'name':'10'},{'id':'frame_11','url':'https://i.postimg.cc/fTWzQRx8/IMG-6149.gif','name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0xb1),'name':'12'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x10c6),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x80f),'name':'14'},{'id':'frame_cat_ear','url':_0x5a7792(0xfe8),'name':'1'},{'id':'frame_ribbon','url':_0x5a7792(0x8a5),'name':'2'},{'id':_0x5a7792(0x225),'url':_0x5a7792(0x11d8),'name':'3'},{'id':_0x5a7792(0x6d7),'url':_0x5a7792(0x128d),'name':'4'},{'id':_0x5a7792(0xb13),'url':_0x5a7792(0x58d),'name':'5'},{'id':_0x5a7792(0x10a6),'url':_0x5a7792(0x698),'name':'6'},{'id':_0x5a7792(0xd9e),'url':'https://i.postimg.cc/gkhf597g/IMG-6555.gif','name':'7'},{'id':_0x5a7792(0x137b),'url':_0x5a7792(0x8c3),'name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0xda9),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0xa4),'name':'10'},{'id':_0x5a7792(0xcfd),'url':_0x5a7792(0x6e7),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0xa10),'name':'12'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/G3y73Fj2/IMG-6563.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x522),'name':'14'},{'id':_0x5a7792(0x122b),'url':_0x5a7792(0x12c5),'name':'1'},{'id':'frame_ribbon','url':_0x5a7792(0x1171),'name':'2'},{'id':_0x5a7792(0x225),'url':_0x5a7792(0x10d),'name':'3'},{'id':'frame_tech','url':_0x5a7792(0x10f8),'name':'4'},{'id':'frame_5','url':_0x5a7792(0x1d9),'name':'5'},{'id':_0x5a7792(0x10a6),'url':_0x5a7792(0x304),'name':'6'},{'id':_0x5a7792(0xd9e),'url':_0x5a7792(0xff0),'name':'7'},{'id':'frame_8','url':'https://i.postimg.cc/wjfcQMkZ/IMG-6573.gif','name':'8'},{'id':_0x5a7792(0xd64),'url':_0x5a7792(0x11a5),'name':'9'},{'id':_0x5a7792(0xb95),'url':'https://i.postimg.cc/MZ77rdDy/IMG-6850.gif','name':'10'},{'id':'frame_11','url':_0x5a7792(0x660),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0xe23),'name':'12'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/VkV2bLNw/IMG-6853.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x11ee),'name':'14'},{'id':'frame_cat_ear','url':'https://i.postimg.cc/d1qsQsbQ/IMG-6855.gif','name':'1'},{'id':_0x5a7792(0x9d7),'url':_0x5a7792(0x1222),'name':'2'},{'id':_0x5a7792(0x225),'url':'https://i.postimg.cc/fyPDvxJk/IMG-6860.gif','name':'3'},{'id':_0x5a7792(0x6d7),'url':'https://i.postimg.cc/QMDsSNxg/IMG-6861.gif','name':'4'},{'id':_0x5a7792(0xb13),'url':_0x5a7792(0xd8a),'name':'5'},{'id':_0x5a7792(0x10a6),'url':_0x5a7792(0x2ac),'name':'6'},{'id':_0x5a7792(0xd9e),'url':'https://i.postimg.cc/90sH9Cn7/IMG-6868.gif','name':'7'},{'id':_0x5a7792(0x137b),'url':_0x5a7792(0xded),'name':'8'},{'id':'frame_9','url':_0x5a7792(0x5c2),'name':'9'},{'id':_0x5a7792(0xb95),'url':_0x5a7792(0x4d3),'name':'10'},{'id':_0x5a7792(0xcfd),'url':_0x5a7792(0x1283),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x112c),'name':'12'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x378),'name':'13'},{'id':'frame_14','url':_0x5a7792(0x3c5),'name':'14'},{'id':'frame_11','url':_0x5a7792(0x966),'name':'11'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x2c4),'name':'12'},{'id':'frame_13','url':_0x5a7792(0x13c6),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x121b),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xbf3),'name':'13'},{'id':'frame_14','url':_0x5a7792(0xbba),'name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/PJppkbvn/IMG-6918.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x216),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x12fd),'name':'14'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/mgGc0HbK/IMG-6926.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x3e6),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/xCqqKGRN/IMG-6929.gif','name':'14'},{'id':_0x5a7792(0xd3e),'url':_0x5a7792(0x12b7),'name':'12'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/DZgMwc1H/817178fdbpf2ff7740dc98e26ab78759.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xc18),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x987),'name':'13'},{'id':'frame_14','url':_0x5a7792(0x27e),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x1238),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xe4e),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/8k7YSLjK/1689aa46aqc4b9ffc0f970e668f56537.gif','name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x13da),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xc69),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x341),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x12c4),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xf77),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xbfa),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xf7),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x6a4),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x495),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xbfd),'name':'14'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/ZnJNZWHZ/IMG-7009.gif','name':'13'},{'id':'frame_14','url':_0x5a7792(0x10c3),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xaf5),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xa38),'name':'13'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/3JSG5Jv5/IMG-7014.gif','name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x9e8),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x4ee),'name':'14'},{'id':'frame_13','url':_0x5a7792(0xcec),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/mZ9hgH3J/IMG-7019.gif','name':'14'},{'id':'frame_14','url':_0x5a7792(0x380),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x708),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x124),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x1362),'name':'14'},{'id':'frame_14','url':_0x5a7792(0xff8),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x125f),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/VkXngG72/mmexport1751031208329.gif','name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x129c),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x644),'name':'13'},{'id':'frame_14','url':_0x5a7792(0x950),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/HWynLK7f/mmexport1751021724230.gif','name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xd70),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x484),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x582),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x691),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x40d),'name':'13'},{'id':'frame_14','url':'https://i.postimg.cc/L5RLr3tg/mmexport1751035976943.gif','name':'14'},{'id':'frame_14','url':_0x5a7792(0xc86),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x26b),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x197),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x340),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x11e5),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xde6),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x227),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xe30),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x315),'name':'14'},{'id':'frame_13','url':_0x5a7792(0xa87),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x5c9),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/W40f9qtd/IMG-7098.gif','name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xe25),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xecd),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x69b),'name':'14'},{'id':'frame_14','url':'https://i.postimg.cc/xTk5xN49/IMG-7233.gif','name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xc43),'name':'13'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/yx2m4nbs/IMG-7231.gif','name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x526),'name':'14'},{'id':'frame_13','url':_0x5a7792(0xa05),'name':'13'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/rmB17Qbc/IMB-f-VDf-Fc.gif','name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x38d),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/B6KD52vz/IMG-7096.gif','name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x4f0),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x9e5),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/bw4wxW2z/IMB-16r-COL.gif','name':'14'},{'id':_0x5a7792(0x1de),'url':'https://i.postimg.cc/3x0Kx1fz/IMB-K1u-Jp-P.gif','name':'13'},{'id':'frame_14','url':_0x5a7792(0xffc),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xd91),'name':'14'},{'id':'frame_14','url':_0x5a7792(0x8e),'name':'14'},{'id':'frame_13','url':_0x5a7792(0x65f),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xe21),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/jS8tc9wW/IMG-7083.gif','name':'14'},{'id':'frame_13','url':'https://i.postimg.cc/rmRVKJpD/IMG-7087.gif','name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x915),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x56c),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/FzqHTBng/IMG-7093.gif','name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xb24),'name':'13'},{'id':'frame_14','url':_0x5a7792(0x200),'name':'14'},{'id':'frame_14','url':_0x5a7792(0x5f4),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0x129a),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x741),'name':'14'},{'id':_0x5a7792(0x506),'url':'https://i.postimg.cc/kXfcgFRN/IMG-7106.gif','name':'14'},{'id':'frame_14','url':_0x5a7792(0x7c0),'name':'14'},{'id':_0x5a7792(0x1de),'url':_0x5a7792(0xf67),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xa70),'name':'14'},{'id':'frame_14','url':_0x5a7792(0xea5),'name':'14'},{'id':'frame_13','url':_0x5a7792(0x12e7),'name':'13'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0x1ad),'name':'14'},{'id':_0x5a7792(0x506),'url':_0x5a7792(0xebb),'name':'14'}];let _0x3e7a1b={'chats':{},'activeChatId':null,'globalSettings':{},'apiConfig':{},'userStickers':[],'worldBooks':[],'personaPresets':[],'qzoneSettings':{},'activeAlbumId':null,'cache':{'songs':new Map(),'lyrics':new Map()},'ttsCache':new Map()},_0x1d3b86={'isActive':![],'gameMode':null,'chatId':null,'players':[],'currentDay':0x1,'currentPhase':_0x5a7792(0x347),'nightActions':{},'gameLog':[],'discussionLog':[],'voteResults':{},'electionInfo':{'candidates':[],'votes':{}},'sheriffId':null,'lastFailedAction':null},_0x502e19=0x0;const _0x4bfd24=0xf;let _0x2bcd5c=0x0;const _0x52ef4f=0xa;let _0x10d3d6=[],_0x1c083c={'isActive':![],'activeChatId':null,'isPlaying':![],'playlist':[],'currentIndex':-0x1,'playMode':'order','totalElapsedTime':0x0,'timerId':null,'parsedLyrics':[],'currentLyricIndex':-0x1},_0x146c2e={'isOpen':![],'activePostId':null,'panelEl':null,'gridEl':null};const _0x51e4a1=document['getElementById'](_0x5a7792(0xa03));let _0x1ebe35=null,_0x2a27ef=![],_0x257fa1=0x0,_0x3b731f=null,_0x302616=![],_0x110329=_0x5a7792(0xfd7),_0x3b4859=new Set(),_0x246a68=null,_0x585d1c=![],_0x59a97d=null,_0xa5232a=null,_0x522181=![],_0x267436=![],_0x3ca822=![],_0x3a7ca4=![],_0x3d215e=[],_0x259cdf=null,_0x170cc3=null,_0x2d89bb={},_0x5096e4=null,_0x10ae3d=null,_0x4424d7=null,_0x5cb8d2=null,_0x4260cc=null,_0x3a52bc=null,_0x2d8791=null,_0x1ac43d=[],_0x500637=null,_0x5eec2b=null,_0x352161=new Set(),_0x46c8df=null,_0x3dd5a2=null,_0x169b3f=null,_0xc70aa2={'isOpen':![],'photos':[],'currentIndex':-0x1},_0x511de0=0x0,_0x3dfde5=![],_0x3ee2b5=new Set(),_0x1dd88f=null;const _0x54e358=_0x5a7792(0x2bb),_0x60cf2=_0x5a7792(0x984),_0x480024=_0x5a7792(0xe64),_0x9bc039=_0x5a7792(0xa2d);let _0x1c7943,_0x34b644={};const _0x294cf9='https://www.myinstants.com/media/sounds/notification-sound-2.mp3';let _0x4dc8ec={},_0x2b4d16={},_0x2ff172=null;const _0x8188ba={'qq':_0x5a7792(0x95e),'world-book':_0x5a7792(0x11c2),'wallpaper':_0x5a7792(0xef3),'renderer':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756312261242_qdqqd_g0eriz.jpeg','api-settings':_0x5a7792(0x1398),'font':_0x5a7792(0x6ae),'char-phone':_0x5a7792(0x44d),'douban':'https://i.postimg.cc/Pq2xJN1g/IMG-7301.jpg','preset':_0x5a7792(0xaa1),'tutorial':_0x5a7792(0x4c0),'werewolf':_0x5a7792(0xb32),'x':'https://i.postimg.cc/Y9d3BztC/1.png'},_0xca148b={'qq':'https://i.postimg.cc/MTC3Tkw8/IMG-6436.jpg','album':_0x5a7792(0x11c2),'browser':_0x5a7792(0x212),'taobao':_0x5a7792(0x2e6),'memo':_0x5a7792(0xc1f),'diary':_0x5a7792(0x7b1),'amap':'https://i.postimg.cc/Jz2Tz0dw/IMG-7281.jpg','usage':'https://i.postimg.cc/WbF8kzz9/IMG-7282.jpg','music':_0x5a7792(0x7a),'ephone':_0x5a7792(0x44d)};let _0x43f2f0=null;const _0x442b6b=/(^https:\/\/i\.postimg\.cc\/.+|^https:\/\/files\.catbox\.moe\/.+|^https?:\/\/sharkpan\.xyz\/.+|^data:image|\.(png|jpg|jpeg|gif|webp)\?.*$|\.(png|jpg|jpeg|gif|webp)$)/i;let _0x10081e=0x0,_0x2eb631=0x1,_0x1df506={'hasShown40':![],'hasShown20':![],'hasShown10':![]},_0x518e81;const _0x3436fb=document[_0x5a7792(0x124e)]('style');_0x3436fb['id']='dynamic-font-style',document[_0x5a7792(0x798)][_0x5a7792(0x99e)](_0x3436fb);const _0x4e1ce9=document[_0x5a7792(0x64f)](_0x5a7792(0x970)),_0x267673=document[_0x5a7792(0x64f)](_0x5a7792(0xfb5)),_0x1c5252=document[_0x5a7792(0x64f)](_0x5a7792(0x22f)),_0x109a90=document[_0x5a7792(0x64f)](_0x5a7792(0x251)),_0x5141df=document[_0x5a7792(0x64f)]('custom-modal-cancel');let _0x410230;function _0x25eb4b(){const _0x463f48=_0x5a7792;_0x4e1ce9[_0x463f48(0x418)][_0x463f48(0xdda)](_0x463f48(0x40a));}function _0x516d41(){const _0x15d8ef=_0x5a7792;_0x4e1ce9['classList'][_0x15d8ef(0x1275)](_0x15d8ef(0x40a)),_0x109a90['classList'][_0x15d8ef(0x1275)](_0x15d8ef(0xeed));if(_0x410230)_0x410230(null);}function _0x227ea7(_0x122eb2){const _0x457012=_0x5a7792,_0x83a8f7=document[_0x457012(0x64f)](_0x457012(0x9fc)),_0x2d2d9c=_0x122eb2[_0x457012(0xcb3)][_0x457012(0x96b)]||{'vertical':'top','horizontal':'center','offset':0xa};_0x83a8f7[_0x457012(0x731)]['top']='auto',_0x83a8f7[_0x457012(0x731)][_0x457012(0x8da)]=_0x457012(0x126b),_0x83a8f7[_0x457012(0x731)][_0x457012(0xbbf)]=_0x457012(0x126b),_0x83a8f7[_0x457012(0x731)]['right']=_0x457012(0x126b),_0x83a8f7[_0x457012(0x731)][_0x457012(0x70b)]=_0x457012(0x1209);_0x2d2d9c[_0x457012(0x11b0)]===_0x457012(0x4ed)?_0x83a8f7[_0x457012(0x731)][_0x457012(0x4ed)]=_0x2d2d9c[_0x457012(0x550)]+'px':_0x83a8f7[_0x457012(0x731)]['bottom']=_0x2d2d9c[_0x457012(0x550)]+'px';switch(_0x2d2d9c['horizontal']){case _0x457012(0xbbf):_0x83a8f7['style'][_0x457012(0xbbf)]='15px';break;case _0x457012(0x121):_0x83a8f7['style'][_0x457012(0x121)]=_0x457012(0xebe);break;case _0x457012(0x7bd):default:_0x83a8f7[_0x457012(0x731)][_0x457012(0xbbf)]=_0x457012(0x111c),_0x83a8f7['style'][_0x457012(0x70b)]='translateX(-50%)';break;}}async function _0x1ac667(_0x16d86d){const _0x5c8fa6=_0x5a7792,_0x284f45=_0x16d86d[_0x5c8fa6(0xf5b)][_0x5c8fa6(0x91e)][0x0];if(!_0x284f45)return;const _0x73a038=await new Promise(_0x2eb620=>{const _0x376294=_0x5c8fa6,_0x2276c4=new FileReader();_0x2276c4[_0x376294(0x139d)]=()=>_0x2eb620(_0x2276c4['result']),_0x2276c4['readAsDataURL'](_0x284f45);});await _0x28974b('请稍候...','正在请求AI为新群头像命名...');try{const _0x5d155f=await _0x439183(_0x73a038);if(!_0x5d155f)throw new Error('AI未能成功描述图片。');const _0x42d9c8=_0x3e7a1b['chats'][_0x3e7a1b[_0x5c8fa6(0x777)]];!_0x42d9c8['settings']['groupAvatarLibrary']&&(_0x42d9c8['settings'][_0x5c8fa6(0x1ee)]=[]),_0x42d9c8[_0x5c8fa6(0xcb3)][_0x5c8fa6(0x1ee)][_0x5c8fa6(0x13ee)]({'name':_0x5d155f,'url':_0x73a038}),await _0x4e1bbf[_0x5c8fa6(0x999)]['put'](_0x42d9c8),_0x31c59f(),await _0x28974b(_0x5c8fa6(0x11e6),'AI已将新群头像命名为：“'+_0x5d155f+'”');}catch(_0x111540){console[_0x5c8fa6(0xc60)]('本地群头像上传及识别失败:',_0x111540),await _0x28974b(_0x5c8fa6(0x5b1),_0x5c8fa6(0xb56)+_0x111540[_0x5c8fa6(0x854)]);}finally{_0x16d86d[_0x5c8fa6(0xf5b)][_0x5c8fa6(0xbed)]=null;}}async function _0x5d8aeb(_0x5d02e9){const _0x5117c1=_0x5a7792,_0x2bf443=_0x5d02e9[_0x5117c1(0xf5b)][_0x5117c1(0x91e)][0x0];if(!_0x2bf443)return;const _0x11b88f=await new Promise(_0x4632d8=>{const _0x3a239b=_0x5117c1,_0x17a7eb=new FileReader();_0x17a7eb[_0x3a239b(0x139d)]=()=>_0x4632d8(_0x17a7eb[_0x3a239b(0x8f)]),_0x17a7eb[_0x3a239b(0xb4)](_0x2bf443);});await _0x28974b(_0x5117c1(0x2f7),'正在请求AI为新头像命名...');try{const _0x1d32dc=await _0x439183(_0x11b88f);if(!_0x1d32dc)throw new Error(_0x5117c1(0x117a));const _0x5619e5=_0x3e7a1b['chats'][_0x3e7a1b[_0x5117c1(0x777)]];!_0x5619e5['settings'][_0x5117c1(0x1163)]&&(_0x5619e5[_0x5117c1(0xcb3)][_0x5117c1(0x1163)]=[]),_0x5619e5[_0x5117c1(0xcb3)][_0x5117c1(0x1163)][_0x5117c1(0x13ee)]({'name':_0x1d32dc,'url':_0x11b88f}),await _0x4e1bbf['chats'][_0x5117c1(0x4fa)](_0x5619e5),_0x3f1e08(),await _0x28974b(_0x5117c1(0x11e6),'AI已将新头像命名为：“'+_0x1d32dc+'”');}catch(_0x7cb61b){console[_0x5117c1(0xc60)](_0x5117c1(0x22e),_0x7cb61b),await _0x28974b(_0x5117c1(0x5b1),_0x5117c1(0xb56)+_0x7cb61b[_0x5117c1(0x854)]);}finally{_0x5d02e9[_0x5117c1(0xf5b)][_0x5117c1(0xbed)]=null;}}async function _0x439183(_0x243ece){const _0x18eeed=_0x5a7792,_0xc5b1c0=_0x3e7a1b[_0x18eeed(0xec0)][_0x18eeed(0x64b)]&&_0x3e7a1b['apiConfig']['secondaryApiKey']&&_0x3e7a1b[_0x18eeed(0xec0)]['secondaryModel'],{proxyUrl:_0x33f983,apiKey:_0x481498,model:_0x38eff3}=_0xc5b1c0?{'proxyUrl':_0x3e7a1b['apiConfig']['secondaryProxyUrl'],'apiKey':_0x3e7a1b[_0x18eeed(0xec0)][_0x18eeed(0x2d3)],'model':_0x3e7a1b[_0x18eeed(0xec0)]['secondaryModel']}:_0x3e7a1b[_0x18eeed(0xec0)];if(!_0x33f983||!_0x481498||!_0x38eff3)throw new Error(_0x18eeed(0x1a5));const _0x1a5fcf=_0x18eeed(0x474);let _0x279cd4=_0x33f983[_0x18eeed(0xe53)](_0x18eeed(0x742)),_0x18a762;if(_0x279cd4){const _0x73b509=_0x243ece[_0x18eeed(0x132a)](/^data:(.*);base64/)[0x1],_0x456729=_0x243ece[_0x18eeed(0x108c)](',')[0x1],_0x2b8279={'contents':[{'parts':[{'text':_0x1a5fcf},{'inline_data':{'mime_type':_0x73b509,'data':_0x456729}}]}]};_0x18a762=await fetch(_0x33f983+'/'+_0x38eff3+_0x18eeed(0xd8)+_0x481498,{'method':_0x18eeed(0x2d1),'headers':{'Content-Type':'application/json'},'body':JSON[_0x18eeed(0xe3f)](_0x2b8279)});}else{const _0x284c4d={'model':_0x38eff3,'messages':[{'role':_0x18eeed(0xa4d),'content':[{'type':_0x18eeed(0x673),'text':_0x1a5fcf},{'type':'image_url','image_url':{'url':_0x243ece}}]}],'max_tokens':0x32};_0x18a762=await fetch(_0x33f983+_0x18eeed(0x58b),{'method':_0x18eeed(0x2d1),'headers':{'Content-Type':_0x18eeed(0x7fe),'Authorization':_0x18eeed(0x236)+_0x481498},'body':JSON[_0x18eeed(0xe3f)](_0x284c4d)});}if(!_0x18a762['ok']){const _0x3b7c51=await _0x18a762['json']();throw new Error(_0x18eeed(0x1fa)+_0x3b7c51[_0x18eeed(0xc60)]['message']);}const _0x5c8970=await _0x18a762[_0x18eeed(0x6f8)]();let _0x2060df=_0x279cd4?getGeminiResponseText(_0x5c8970):_0x5c8970['choices'][0x0][_0x18eeed(0x854)]['content'];return _0x2060df[_0x18eeed(0x43a)]()['replace'](/["'“”‘’]/g,'');}async function _0x4ee9d7(_0x3a6547){const _0x4fbfb1=_0x5a7792;if(!_0x3a6547||_0x3a6547[_0x4fbfb1(0x1167)]){console['warn'](_0x4fbfb1(0x362));return;}const _0x14c026=_0x3a6547['id'],_0x55a4d2=_0x3a6547[_0x4fbfb1(0x6fc)],_0x2b7b6b=_0x3a6547[_0x4fbfb1(0x7de)];console['log'](_0x4fbfb1(0x10bd)+_0x14c026+_0x4fbfb1(0xe07));for(const _0x40287d in _0x3e7a1b[_0x4fbfb1(0x999)]){const _0xd4c55a=_0x3e7a1b[_0x4fbfb1(0x999)][_0x40287d];if(_0xd4c55a[_0x4fbfb1(0x1167)]&&_0xd4c55a[_0x4fbfb1(0x5d4)]){const _0x1df770=_0xd4c55a[_0x4fbfb1(0x5d4)][_0x4fbfb1(0x137)](_0x7eeeb5=>_0x7eeeb5['id']===_0x14c026);if(_0x1df770){let _0x3f0e0b=![];_0x1df770[_0x4fbfb1(0x287)]!==_0x55a4d2&&(_0x1df770[_0x4fbfb1(0x287)]=_0x55a4d2,_0x3f0e0b=!![]),_0x1df770['originalName']!==_0x2b7b6b&&(_0x1df770['originalName']=_0x2b7b6b,_0x3f0e0b=!![]),_0x3f0e0b&&(await _0x4e1bbf['chats'][_0x4fbfb1(0x4fa)](_0xd4c55a),console['log'](_0x4fbfb1(0x1393)+_0xd4c55a['name']+_0x4fbfb1(0xde5)));}}}}async function _0x303d26(_0x55cd9e){const _0x19c7c0=_0x5a7792;if(!_0x55cd9e||_0x55cd9e[_0x19c7c0(0x1167)]){console[_0x19c7c0(0x1155)](_0x19c7c0(0x1f5));return;}const _0x3d06d0=_0x55cd9e['id'],_0x362336=_0x55cd9e['settings'][_0x19c7c0(0x93)];console[_0x19c7c0(0x1081)](_0x19c7c0(0x10bd)+_0x3d06d0+'\x20同步所有群聊内的头像...');for(const _0x3cca57 of Object[_0x19c7c0(0xd6d)](_0x3e7a1b[_0x19c7c0(0x999)])){if(_0x3cca57[_0x19c7c0(0x1167)]&&_0x3cca57['members']){const _0x3de280=_0x3cca57[_0x19c7c0(0x5d4)][_0x19c7c0(0x137)](_0x523ef9=>_0x523ef9['id']===_0x3d06d0);_0x3de280&&_0x3de280[_0x19c7c0(0x1265)]!==_0x362336&&(_0x3de280[_0x19c7c0(0x1265)]=_0x362336,await _0x4e1bbf['chats']['put'](_0x3cca57),console['log'](_0x19c7c0(0xff3)+_0x3d06d0+_0x19c7c0(0xe80)+_0x3cca57[_0x19c7c0(0x6fc)]+'\x22'));}}}function _0x1409fb(_0x9d6dc1,_0x6249f3){const _0x451021=_0x5a7792;if(!_0x9d6dc1||!_0x9d6dc1[_0x451021(0x1167)]||!_0x6249f3)return _0x6249f3;const _0x449e95=_0x3e7a1b['qzoneSettings'][_0x451021(0x78c)]||_0x451021(0x1028);if(_0x6249f3===_0x449e95)return _0x9d6dc1[_0x451021(0xcb3)][_0x451021(0x96f)]||'我';const _0x2c7650=_0x9d6dc1[_0x451021(0x5d4)][_0x451021(0x137)](_0x100538=>_0x100538[_0x451021(0x7de)]===_0x6249f3);return _0x2c7650?_0x2c7650['groupNickname']:_0x6249f3;}function _0x1cde7a(_0x1c7993){const _0x5dd16a=_0x5a7792;document['querySelectorAll']('.rules-tab')['forEach'](_0x147328=>{const _0x50d470=_0x2bd6;_0x147328[_0x50d470(0x418)]['toggle']('active',_0x147328[_0x50d470(0x12e1)][_0x50d470(0xcd3)]===_0x1c7993);}),document[_0x5dd16a(0x233)](_0x5dd16a(0xa08))[_0x5dd16a(0x103)](_0x5cfb21=>{const _0x2eef5f=_0x5dd16a;_0x5cfb21['classList'][_0x2eef5f(0x5cf)](_0x2eef5f(0x12ef),_0x5cfb21[_0x2eef5f(0x12e1)]['categoryId']===_0x1c7993);});}function _0x5784e3(_0x1838ce){const _0x5b7cb6=_0x5a7792;if(!_0x1838ce)return'';if(_0x3e7a1b[_0x5b7cb6(0x3c2)]&&_0x1838ce===_0x3e7a1b[_0x5b7cb6(0x3c2)][_0x5b7cb6(0x78c)])return _0x3e7a1b[_0x5b7cb6(0x3c2)][_0x5b7cb6(0x78c)];let _0x58d9e8=Object[_0x5b7cb6(0xd6d)](_0x3e7a1b[_0x5b7cb6(0x999)])[_0x5b7cb6(0x137)](_0x1982fc=>!_0x1982fc[_0x5b7cb6(0x1167)]&&_0x1982fc[_0x5b7cb6(0x7de)]===_0x1838ce);if(_0x58d9e8)return _0x58d9e8[_0x5b7cb6(0x6fc)];_0x58d9e8=Object['values'](_0x3e7a1b[_0x5b7cb6(0x999)])[_0x5b7cb6(0x137)](_0x3a07cf=>!_0x3a07cf[_0x5b7cb6(0x1167)]&&(_0x3a07cf[_0x5b7cb6(0x19e)]&&_0x3a07cf[_0x5b7cb6(0x19e)]['includes'](_0x1838ce)));if(_0x58d9e8)return _0x58d9e8['name'];return _0x1838ce;}function _0x1ba418(_0x139260,_0x5db05a=null){const _0x1933e5=_0x5a7792;if(!_0x139260||typeof _0x139260!==_0x1933e5(0x1251)||!_0x139260[_0x1933e5(0xe53)](_0x1933e5(0x473)))return _0x139260;return _0x139260[_0x1933e5(0x137f)](/@\[\[([^\]]+)\]\]/g,(_0x1e7b1f,_0x1de6cd)=>{const _0x2bf9dd=_0x1933e5,_0x1d5e05=_0x1de6cd[_0x2bf9dd(0x43a)]();let _0x3cd8cd;return _0x5db05a&&_0x5db05a['isGroup']?_0x3cd8cd=_0x1409fb(_0x5db05a,_0x1d5e05):_0x3cd8cd=_0x5784e3(_0x1d5e05),'@'+_0x3cd8cd;});}function _0x54149f(_0x5934c5,_0x53a804,_0x4039cb={}){return new Promise(_0xde6f88=>{const _0x409a31=_0x2bd6;_0x410230=_0xde6f88,_0x267673[_0x409a31(0xee5)]=_0x5934c5,_0x1c5252[_0x409a31(0xc58)]=_0x409a31(0xb23)+_0x53a804+_0x409a31(0x12de);const _0x2f0f47=document[_0x409a31(0x64f)]('custom-modal-confirm'),_0x1f16d8=document[_0x409a31(0x64f)]('custom-modal-cancel');_0x1f16d8[_0x409a31(0x731)][_0x409a31(0x130)]=_0x409a31(0xb37),_0x2f0f47[_0x409a31(0xee5)]=_0x4039cb['confirmText']||'确定',_0x1f16d8['textContent']=_0x4039cb[_0x409a31(0x2d9)]||'取消',_0x4039cb[_0x409a31(0x29f)]?_0x2f0f47[_0x409a31(0x418)]['add'](_0x4039cb['confirmButtonClass']):_0x2f0f47[_0x409a31(0x418)][_0x409a31(0x1275)](_0x409a31(0xeed)),_0x2f0f47[_0x409a31(0x113a)]=()=>{_0xde6f88(!![]),_0x516d41();},_0x1f16d8[_0x409a31(0x113a)]=()=>{_0xde6f88(![]),_0x516d41();},_0x25eb4b();});}function _0x2a2fc8(_0x3a6e71='📥\x20图片下载中...',_0x4a7dad=_0x5a7792(0xa42)){const _0x53d91d=_0x5a7792,_0x2c6620=document['createElement'](_0x53d91d(0x479));_0x2c6620['textContent']=_0x3a6e71,_0x2c6620[_0x53d91d(0x731)][_0x53d91d(0x42f)]=_0x53d91d(0x3c6)+(_0x4a7dad===_0x53d91d(0xa42)?'#4CAF50':_0x53d91d(0x3d3))+_0x53d91d(0x1029),document[_0x53d91d(0x872)]['appendChild'](_0x2c6620),setTimeout(()=>{const _0x39c170=_0x53d91d;_0x2c6620[_0x39c170(0x731)][_0x39c170(0x131a)]='1',_0x2c6620[_0x39c170(0x731)][_0x39c170(0x70b)]=_0x39c170(0x80e);},0xa),setTimeout(()=>{const _0x166c92=_0x53d91d;_0x2c6620['style'][_0x166c92(0x131a)]='0',_0x2c6620[_0x166c92(0x731)]['transform']=_0x166c92(0xd2d),setTimeout(()=>{const _0x450dd8=_0x166c92;_0x2c6620[_0x450dd8(0x1275)]();},0x12c);},0x7d0);}function _0x3b1c72(_0x55da16){const _0x5e69ad=_0x5a7792;let _0x18abf3=(_0x55da16||_0x5e69ad(0xc7b))[_0x5e69ad(0x137f)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0x5e69ad(0x137f)](/\s+/g,'_')['substring'](0x0,0x1e);const _0x305969=new Date()['toISOString']()['replace'](/[-:]/g,'')[_0x5e69ad(0x137f)]('T','_')[_0x5e69ad(0x108c)]('.')[0x0];return _0x18abf3+'_'+_0x305969+_0x5e69ad(0xcc4);}function _0x235a22(_0x3e9c1e,_0x570aa3){const _0x44bd4e=_0x5a7792;try{const _0x4d02e8=_0x3b1c72(_0x570aa3),_0x300732=document[_0x44bd4e(0x124e)]('a');_0x300732[_0x44bd4e(0x1210)]=_0x3e9c1e,_0x300732[_0x44bd4e(0x1134)]=_0x4d02e8,_0x300732[_0x44bd4e(0x731)]['display']=_0x44bd4e(0x1209),document[_0x44bd4e(0x872)][_0x44bd4e(0x99e)](_0x300732),_0x300732[_0x44bd4e(0x1080)](),setTimeout(()=>{const _0x33230a=_0x44bd4e;document['body'][_0x33230a(0x24c)](_0x300732);},0x64),_0x2a2fc8(_0x44bd4e(0xc91));}catch(_0x5d08c2){console[_0x44bd4e(0xc60)](_0x44bd4e(0x8f4),_0x5d08c2),_0x2a2fc8('下载失败，请重试','error');}}function _0x28974b(_0x2648e0,_0x15cc51){return new Promise(_0x3ebf98=>{const _0x21ebe2=_0x2bd6;_0x410230=_0x3ebf98,_0x267673['textContent']=_0x2648e0,_0x1c5252[_0x21ebe2(0xc58)]=_0x21ebe2(0x11d1)+_0x15cc51+'</p>';const _0x2e5e45=document[_0x21ebe2(0x64f)](_0x21ebe2(0x251)),_0x785713=document[_0x21ebe2(0x64f)]('custom-modal-cancel');_0x785713[_0x21ebe2(0x731)][_0x21ebe2(0x130)]=_0x21ebe2(0x1209),_0x2e5e45[_0x21ebe2(0xee5)]='好的',_0x2e5e45[_0x21ebe2(0x113a)]=()=>{const _0xd759e0=_0x21ebe2;_0x785713[_0xd759e0(0x731)]['display']='block',_0x2e5e45[_0xd759e0(0xee5)]='确定',_0x3ebf98(!![]),_0x516d41();},_0x25eb4b();});}function _0x41e3f8(_0xd8c34e,_0x5b8e99,_0x92601c='',_0x1205a2=_0x5a7792(0x673),_0x5594cf=''){return new Promise(_0x4d2497=>{const _0x248c2c=_0x2bd6;_0x410230=_0x4d2497,_0x267673[_0x248c2c(0xee5)]=_0xd8c34e;const _0x9e774b=_0x248c2c(0x35e),_0x4a0696=_0x1205a2===_0x248c2c(0x444)?_0x248c2c(0x1b5)+_0x9e774b+'\x22\x20placeholder=\x22'+_0x5b8e99+'\x22\x20rows=\x224\x22\x20style=\x22width:\x20100%;\x20padding:\x208px;\x20border-radius:\x206px;\x20border:\x201px\x20solid\x20#ccc;\x20font-size:\x2016px;\x20box-sizing:\x20border-box;\x20resize:\x20vertical;\x22>'+_0x92601c+'</textarea>':'<input\x20type=\x22'+_0x1205a2+_0x248c2c(0x1258)+_0x9e774b+_0x248c2c(0x7cd)+_0x5b8e99+'\x22\x20value=\x22'+_0x92601c+'\x22>';_0x1c5252[_0x248c2c(0xc58)]=_0x5594cf+_0x4a0696;const _0x10ee89=document[_0x248c2c(0x64f)](_0x9e774b);_0x1c5252[_0x248c2c(0x233)](_0x248c2c(0x1375))['forEach'](_0x9d4453=>{const _0x1add4d=_0x248c2c;_0x9d4453[_0x1add4d(0xf72)](_0x1add4d(0x1080),()=>{const _0xc74c9f=_0x1add4d,_0x369a79=_0x9d4453[_0xc74c9f(0x12e1)][_0xc74c9f(0xc98)];if(_0x369a79)try{const _0x5ae45e=JSON['parse'](_0x369a79);_0x10ee89['value']=JSON[_0xc74c9f(0xe3f)](_0x5ae45e,null,0x2),_0x10ee89[_0xc74c9f(0x1218)]();}catch(_0x54b830){console[_0xc74c9f(0xc60)](_0xc74c9f(0x6c5),_0x54b830);}});});const _0x1b0297=document[_0x248c2c(0x64f)](_0x248c2c(0x251)),_0x117e25=document[_0x248c2c(0x64f)](_0x248c2c(0x157));_0x1b0297[_0x248c2c(0x113a)]=()=>{const _0x4c4710=_0x248c2c;_0x4d2497(_0x10ee89[_0x4c4710(0xbed)]),_0x516d41();},_0x117e25['onclick']=()=>{_0x4d2497(null),_0x516d41();},_0x25eb4b(),setTimeout(()=>_0x10ee89[_0x248c2c(0x1218)](),0x64);});}function _0x217169(_0x11089a,_0x3bdd88){return new Promise(_0x1759a3=>{const _0x41eabf=_0x2bd6,_0x1ff81c=document['getElementById'](_0x41eabf(0x970)),_0xf92073=document[_0x41eabf(0x64f)](_0x41eabf(0xfb5)),_0x123f2b=document[_0x41eabf(0x64f)](_0x41eabf(0x22f)),_0xcdf952=document[_0x41eabf(0x49c)](_0x41eabf(0xf85));_0xf92073[_0x41eabf(0xee5)]=_0x11089a,_0x123f2b[_0x41eabf(0xc58)]='',_0xcdf952['innerHTML']='',_0xcdf952['style']['flexDirection']=_0x41eabf(0x96d),_0x3bdd88[_0x41eabf(0x103)](_0x34d708=>{const _0x539d28=_0x41eabf,_0xd83a9a=document[_0x539d28(0x124e)](_0x539d28(0xcd));_0xd83a9a[_0x539d28(0xee5)]=_0x34d708[_0x539d28(0x673)],_0xd83a9a[_0x539d28(0x113a)]=()=>{const _0x314ac8=_0x539d28;_0x1ff81c[_0x314ac8(0x418)][_0x314ac8(0x1275)](_0x314ac8(0x40a)),_0x1759a3(_0x34d708['value']);},_0xcdf952[_0x539d28(0x99e)](_0xd83a9a);});const _0x39476a=document[_0x41eabf(0x124e)](_0x41eabf(0xcd));_0x39476a[_0x41eabf(0xee5)]='取消',_0x39476a[_0x41eabf(0x731)][_0x41eabf(0x57d)]=_0x41eabf(0x855),_0x39476a['style'][_0x41eabf(0xd6e)]=_0x41eabf(0x855),_0x39476a[_0x41eabf(0x731)][_0x41eabf(0xfd6)]=_0x41eabf(0x1321),_0x39476a[_0x41eabf(0x113a)]=()=>{const _0xed3041=_0x41eabf;_0x1ff81c[_0xed3041(0x418)][_0xed3041(0x1275)](_0xed3041(0x40a)),_0x1759a3(null);},_0xcdf952[_0x41eabf(0x99e)](_0x39476a),_0x1ff81c[_0x41eabf(0x418)][_0x41eabf(0xdda)]('visible');})['finally'](()=>{const _0x374c34=_0x2bd6,_0x16bb99=document[_0x374c34(0x49c)](_0x374c34(0xf85));_0x16bb99['style'][_0x374c34(0xe3a)]=_0x374c34(0x10cc),_0x16bb99[_0x374c34(0xc58)]=_0x374c34(0x7a2),document[_0x374c34(0x64f)](_0x374c34(0x157))[_0x374c34(0xf72)](_0x374c34(0x1080),_0x516d41);});}async function _0x4a5960(){const _0x363105=_0x5a7792,_0x38674e=await _0x217169(_0x363105(0xedc),[{'text':'📁\x20从本地文件\x20(.lrc)','value':'file'},{'text':_0x363105(0xfa9),'value':_0x363105(0x320)}]);if(_0x38674e===_0x363105(0xb2b))return new Promise(_0x93c4ce=>{const _0x1b0c4a=_0x363105,_0x47f961=document[_0x1b0c4a(0x64f)](_0x1b0c4a(0x109)),_0x17b2a5=_0x4b4396=>{const _0x34613e=_0x1b0c4a,_0x3b53cc=_0x4b4396[_0x34613e(0xf5b)][_0x34613e(0x91e)][0x0];if(_0x3b53cc){const _0x506d0f=new FileReader();_0x506d0f[_0x34613e(0x139d)]=_0x18018a=>_0x93c4ce(_0x18018a['target'][_0x34613e(0x8f)]),_0x506d0f[_0x34613e(0x36b)]=()=>_0x93c4ce(''),_0x506d0f['readAsText'](_0x3b53cc);}else _0x93c4ce(null);_0x47f961['removeEventListener'](_0x34613e(0x834),_0x17b2a5),_0x47f961[_0x34613e(0xbed)]='';};_0x47f961[_0x1b0c4a(0xf72)](_0x1b0c4a(0x834),_0x17b2a5,{'once':!![]}),_0x47f961['click']();});else{if(_0x38674e==='paste'){const _0x236d53=await _0x41e3f8('粘贴歌词','请在此处粘贴完整的LRC格式歌词...','',_0x363105(0x444));if(_0x236d53){const _0x332fa6=_0x236d53['replace'](/\[/g,'\x0a[')['trim']();return _0x332fa6;}return _0x236d53;}else return null;}}_0x4e1bbf[_0x5a7792(0xf53)](0x27)['stores']({'doubanPosts':_0x5a7792(0x3bc),'chats':'&id,\x20isGroup,\x20groupId,\x20isPinned,\x20memos,\x20diary,\x20appUsageLog,\x20lastIntelligentSummaryTimestamp','apiConfig':_0x5a7792(0x89f),'globalSettings':_0x5a7792(0x6f2),'userStickers':'&id,\x20url,\x20name,\x20categoryId','worldBooks':_0x5a7792(0x87f),'worldBookCategories':_0x5a7792(0x589),'musicLibrary':_0x5a7792(0x6f2),'personaPresets':_0x5a7792(0x6f2),'qzoneSettings':_0x5a7792(0x6f2),'qzonePosts':'++id,\x20timestamp,\x20authorId','qzoneAlbums':_0x5a7792(0x110e),'qzonePhotos':_0x5a7792(0x8f3),'favorites':_0x5a7792(0x3d5),'qzoneGroups':_0x5a7792(0x589),'memories':_0x5a7792(0x339),'callRecords':_0x5a7792(0xfbb),'shoppingProducts':'++id,\x20name,\x20description','shoppingCategories':_0x5a7792(0x589),'apiPresets':_0x5a7792(0x589),'renderingRules':_0x5a7792(0x866),'appearancePresets':'++id,\x20name,\x20type','stickerCategories':_0x5a7792(0x589),'customAvatarFrames':_0x5a7792(0x589),'presets':_0x5a7792(0x87f),'presetCategories':'++id,\x20name','readingLibrary':'++id,\x20title,\x20lastOpened','npcs':'++id,\x20name,\x20enableBackgroundActivity,\x20actionCooldownMinutes,\x20lastActionTimestamp'})[_0x5a7792(0xcb6)](_0x59c378=>{const _0x23d214=_0x5a7792;return _0x59c378[_0x23d214(0x13ac)](_0x23d214(0x144))[_0x23d214(0x9e7)]()['modify'](_0x10b948=>{const _0x39f7e0=_0x23d214;if(typeof _0x10b948['content']===_0x39f7e0(0x1251)&&_0x10b948['content'][_0x39f7e0(0x43a)]()!=='')_0x10b948[_0x39f7e0(0x3ba)]=[{'keys':[],'comment':_0x39f7e0(0xa8c),'content':_0x10b948[_0x39f7e0(0x3ba)]}];else!Array['isArray'](_0x10b948[_0x39f7e0(0x3ba)])&&(_0x10b948[_0x39f7e0(0x3ba)]=[]);_0x10b948[_0x39f7e0(0x3ba)][_0x39f7e0(0x103)](_0x1bacdc=>{const _0x9c2d22=_0x39f7e0;typeof _0x1bacdc['enabled']==='undefined'&&(_0x1bacdc[_0x9c2d22(0x9b)]=!![]);});});}),window['db']=_0x4e1bbf;function _0xddd8ae(_0x34989c){const _0x537f93=_0x5a7792;_0x34989c===_0x537f93(0xbb6)&&(window[_0x537f93(0x979)](),_0x5983f6(_0x537f93(0x476)));if(_0x34989c===_0x537f93(0xa28))window[_0x537f93(0x223)]();if(_0x34989c===_0x537f93(0x7d1))window[_0x537f93(0x8f5)]();if(_0x34989c==='world-book-screen')window['renderWorldBookScreenProxy']();if(_0x34989c===_0x537f93(0x38a))window[_0x537f93(0x930)]();if(_0x34989c==='douban-screen')_0x32b817();document[_0x537f93(0x233)](_0x537f93(0xadb))[_0x537f93(0x103)](_0x993329=>_0x993329['classList']['remove'](_0x537f93(0x12ef)));const _0x17e7ed=document[_0x537f93(0x64f)](_0x34989c);if(_0x17e7ed)_0x17e7ed[_0x537f93(0x418)]['add']('active');if(_0x34989c===_0x537f93(0x9aa))window[_0x537f93(0x7b8)](_0x3e7a1b[_0x537f93(0x777)]);_0x34989c==='font-settings-screen'&&(_0x1d9c51(),document[_0x537f93(0x64f)](_0x537f93(0xd18))[_0x537f93(0xbed)]=_0x3e7a1b[_0x537f93(0x11b4)][_0x537f93(0x1185)]||'',_0x397027(_0x3e7a1b[_0x537f93(0x11b4)][_0x537f93(0x1185)]||'',!![]));}window['updateListenTogetherIconProxy']=()=>{};function _0x5983f6(_0x37f54a){const _0x536c37=_0x5a7792,_0x5116fb=document['getElementById'](_0x536c37(0xbb6)),_0x1c5fd2={'messages-view':document[_0x536c37(0x64f)](_0x536c37(0x476)),'qzone-screen':document[_0x536c37(0x64f)](_0x536c37(0x3dd)),'favorites-view':document[_0x536c37(0x64f)]('favorites-view'),'memories-view':document[_0x536c37(0x64f)](_0x536c37(0xbf1)),'npc-list-view':document[_0x536c37(0x64f)](_0x536c37(0x628))},_0x4ae48e=document['getElementById'](_0x536c37(0xc0)),_0x490072=document[_0x536c37(0x64f)](_0x536c37(0x7c));_0x3dfde5&&document[_0x536c37(0x64f)](_0x536c37(0x398))['click']();Object[_0x536c37(0xd6d)](_0x1c5fd2)[_0x536c37(0x103)](_0x3eeade=>_0x3eeade[_0x536c37(0x418)][_0x536c37(0x1275)](_0x536c37(0x12ef)));_0x1c5fd2[_0x37f54a]&&_0x1c5fd2[_0x37f54a]['classList']['add'](_0x536c37(0x12ef));document[_0x536c37(0x233)](_0x536c37(0x2a8))[_0x536c37(0x103)](_0x2f2487=>{const _0x50458e=_0x536c37;_0x2f2487['classList'][_0x50458e(0x5cf)](_0x50458e(0x12ef),_0x2f2487[_0x50458e(0x12e1)][_0x50458e(0x33d)]===_0x37f54a);});_0x37f54a===_0x536c37(0x476)?(_0x4ae48e[_0x536c37(0x731)][_0x536c37(0x130)]=_0x536c37(0x1026),_0x490072[_0x536c37(0x731)][_0x536c37(0x130)]=_0x536c37(0x1026)):(_0x4ae48e[_0x536c37(0x731)][_0x536c37(0x130)]=_0x536c37(0x1209),_0x490072['style'][_0x536c37(0x130)]=_0x536c37(0x1209));_0x37f54a!==_0x536c37(0xbf1)&&(_0x4b694a['forEach'](_0x4aab1f=>clearInterval(_0x4aab1f)),_0x4b694a=[]);switch(_0x37f54a){case _0x536c37(0x3dd):_0x1c5fd2[_0x536c37(0x3dd)][_0x536c37(0x731)]['backgroundColor']=_0x536c37(0x3f0),_0x1baa80(0x0),_0x5eba8e(),_0x40e6dd();break;case _0x536c37(0xc15):_0x1c5fd2[_0x536c37(0xc15)][_0x536c37(0x731)][_0x536c37(0xfd6)]=_0x536c37(0x94),_0x2ff98d();break;case'messages-view':break;case _0x536c37(0x628):_0x3f5408();break;}}function _0x416188(){const _0x354779=_0x5a7792;console['log'](_0x354779(0x1368));}window[_0x5a7792(0x930)]=_0x416188;function _0x5eba8e(){const _0x2d414a=_0x5a7792;if(_0x3e7a1b&&_0x3e7a1b['qzoneSettings']){const _0x40cb89=_0x3e7a1b[_0x2d414a(0x3c2)];document['getElementById'](_0x2d414a(0x12e5))['textContent']=_0x40cb89[_0x2d414a(0x78c)],document['getElementById']('qzone-avatar-img')['src']=_0x40cb89[_0x2d414a(0x1265)],document[_0x2d414a(0x64f)](_0x2d414a(0x48c))['src']=_0x40cb89[_0x2d414a(0xcdc)];}}window['renderQzoneScreenProxy']=_0x5eba8e;async function _0x4532bc(){const _0x480072=_0x5a7792;_0x4e1bbf&&_0x3e7a1b[_0x480072(0x3c2)]&&await _0x4e1bbf[_0x480072(0x3c2)][_0x480072(0x4fa)](_0x3e7a1b[_0x480072(0x3c2)]);}function _0x2f4f22(_0x3e007f){const _0x5e0770=_0x5a7792;if(!_0x3e007f)return'';const _0x489317=new Date(),_0x2aa358=new Date(_0x3e007f),_0x11c00d=Math['floor']((_0x489317-_0x2aa358)/0x3e8),_0x41123e=Math[_0x5e0770(0x1245)](_0x11c00d/0x3c),_0x3034ed=Math[_0x5e0770(0x1245)](_0x41123e/0x3c);if(_0x41123e<0x1)return'刚刚';if(_0x41123e<0x3c)return _0x41123e+_0x5e0770(0x128);if(_0x3034ed<0x18)return _0x3034ed+_0x5e0770(0x9ee);const _0x145ba1=_0x2aa358[_0x5e0770(0xf87)](),_0x2fd18d=String(_0x2aa358[_0x5e0770(0x38b)]()+0x1)[_0x5e0770(0xf2)](0x2,'0'),_0x331fea=String(_0x2aa358[_0x5e0770(0x12e)]())[_0x5e0770(0xf2)](0x2,'0'),_0x4f9736=String(_0x2aa358[_0x5e0770(0xdb)]())[_0x5e0770(0xf2)](0x2,'0'),_0x20b548=String(_0x2aa358[_0x5e0770(0x14f)]())['padStart'](0x2,'0');return _0x489317['getFullYear']()===_0x145ba1?_0x2fd18d+'-'+_0x331fea+'\x20'+_0x4f9736+':'+_0x20b548:_0x145ba1+'-'+_0x2fd18d+'-'+_0x331fea+'\x20'+_0x4f9736+':'+_0x20b548;}function _0x155dda(_0x27f956){const _0x37c369=_0x5a7792,_0x176130=document[_0x37c369(0x49c)](_0x37c369(0xc2c)+_0x27f956['id']+'\x22]'),_0x2210ac=!!_0x176130,_0x5e2a06=_0x2210ac?_0x176130:document[_0x37c369(0x124e)](_0x37c369(0x479));!_0x2210ac&&(_0x5e2a06[_0x37c369(0x87d)]=_0x37c369(0x942),_0x5e2a06['dataset'][_0x37c369(0x6c2)]=_0x27f956['id']);const _0x293da0=_0x2210ac?_0x5e2a06[_0x37c369(0x49c)](_0x37c369(0xace)):document[_0x37c369(0x124e)](_0x37c369(0x479));!_0x2210ac&&(_0x293da0[_0x37c369(0x87d)]=_0x37c369(0x1115));let _0x5d5d7b='',_0x1541e8='',_0x15ffee=_0x3e7a1b[_0x37c369(0x3c2)][_0x37c369(0x1265)];if(_0x27f956[_0x37c369(0x1188)]===_0x37c369(0xa4d))_0x5d5d7b=_0x3e7a1b[_0x37c369(0x3c2)][_0x37c369(0x1265)],_0x1541e8=_0x3e7a1b[_0x37c369(0x3c2)][_0x37c369(0x78c)];else{if(_0x3e7a1b['chats'][_0x27f956[_0x37c369(0x1188)]]){const _0x47d582=_0x3e7a1b[_0x37c369(0x999)][_0x27f956[_0x37c369(0x1188)]];_0x5d5d7b=_0x47d582[_0x37c369(0xcb3)][_0x37c369(0x93)]||_0x54e358,_0x1541e8=_0x47d582[_0x37c369(0x6fc)];}else _0x1541e8=_0x5784e3(_0x27f956[_0x37c369(0xa0a)]),_0x5d5d7b=_0x54e358;}function _0x54ed95(_0x3de16f){const _0x298aa3=_0x37c369;let _0x363e41='';const _0x120bf5=_0x3de16f[_0x298aa3(0x66e)]?_0x298aa3(0x65b)+_0x422b3c(_0x3de16f[_0x298aa3(0x66e)])['replace'](/\n/g,_0x298aa3(0x917))+_0x298aa3(0x4b1):'';if(_0x3de16f[_0x298aa3(0xafc)]===_0x298aa3(0x103d))_0x363e41=_0x298aa3(0x1023)+_0x422b3c(_0x3de16f[_0x298aa3(0x3ba)])[_0x298aa3(0x137f)](/\n/g,'<br>')+_0x298aa3(0x4b1);else{if(_0x3de16f[_0x298aa3(0xafc)]===_0x298aa3(0x3d9)&&_0x3de16f['imageUrl'])_0x363e41=_0x120bf5?_0x120bf5+_0x298aa3(0x11f9)+_0x3de16f[_0x298aa3(0xd07)]+_0x298aa3(0x11be):'<img\x20src=\x22'+_0x3de16f[_0x298aa3(0xd07)]+_0x298aa3(0xb1a);else{if(_0x3de16f[_0x298aa3(0xafc)]===_0x298aa3(0x351)){const _0x3e6fe4=_0x3e7a1b[_0x298aa3(0x11b4)]['enableAiDrawing']&&_0x3de16f[_0x298aa3(0x242)]?_0x298aa3(0xb1f)+_0x3de16f[_0x298aa3(0x242)]:_0x298aa3(0x716);_0x363e41=_0x120bf5?_0x120bf5+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x3e6fe4+_0x298aa3(0x12ab)+_0x3de16f[_0x298aa3(0x1150)]+_0x298aa3(0x99d):_0x298aa3(0x86)+_0x3e6fe4+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x3de16f['hiddenContent']+'\x22>';}else{if(_0x3de16f['type']===_0x298aa3(0x13df)){const _0x1edd73=_0x3de16f['imageUrls']||(_0x3de16f['imageUrl']?[_0x3de16f[_0x298aa3(0xd07)]]:[]);if(_0x1edd73['length']>0x0){const _0x15d6a3=_0x1edd73['length'];let _0x468a66='';_0x468a66=_0x298aa3(0xaeb)+_0x15d6a3+'\x22>',_0x1edd73[_0x298aa3(0x103)]((_0x3de389,_0x38fd72)=>{const _0x12d20b=_0x298aa3;_0x468a66+=_0x12d20b(0x86)+_0x3de389+'\x22\x20class=\x22naiimag-image\x22\x20alt=\x22图片'+(_0x38fd72+0x1)+_0x12d20b(0x54f);}),_0x468a66+='</div>',_0x363e41=_0x120bf5?''+_0x120bf5+_0x468a66:_0x468a66;}}}}}return _0x363e41;}let _0x5dba77;if(_0x27f956[_0x37c369(0xafc)]===_0x37c369(0xe5a)){const _0x422358=_0x27f956[_0x37c369(0xa19)]?'<div\x20class=\x22post-content\x22>'+_0x422b3c(_0x27f956['repostComment'])[_0x37c369(0x137f)](/\n/g,_0x37c369(0x917))+'</div>':'';let _0x122da4=_0x54e358,_0x5d1c70=_0x37c369(0xefd);if(_0x27f956['originalPost'][_0x37c369(0x1188)]===_0x37c369(0xa4d))_0x122da4=_0x3e7a1b[_0x37c369(0x3c2)]['avatar'],_0x5d1c70=_0x3e7a1b[_0x37c369(0x3c2)][_0x37c369(0x78c)];else{const _0x59755b=_0x3e7a1b['chats'][_0x27f956[_0x37c369(0x32f)][_0x37c369(0x1188)]];_0x59755b&&(_0x122da4=_0x59755b[_0x37c369(0xcb3)][_0x37c369(0x93)]||_0x54e358),_0x5d1c70=_0x5784e3(_0x27f956[_0x37c369(0x32f)][_0x37c369(0xa0a)]);}_0x5dba77=_0x37c369(0x1295)+_0x422358+_0x37c369(0x997)+_0x122da4+_0x37c369(0x8fa)+_0x5d1c70+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x2f4f22(_0x27f956[_0x37c369(0x32f)][_0x37c369(0x8af)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x54ed95(_0x27f956[_0x37c369(0x32f)])+_0x37c369(0xe17);}else _0x5dba77=_0x37c369(0x61f)+_0x54ed95(_0x27f956)+'</div>';let _0x168654='';if(_0x27f956['likes']&&_0x27f956[_0x37c369(0x940)][_0x37c369(0x40f)]>0x0){const _0x44b201=_0x27f956[_0x37c369(0x940)][_0x37c369(0xb96)](_0x273ac8=>_0x5784e3(_0x273ac8))['join']('、');_0x168654=_0x37c369(0x587)+_0x44b201+'\x20觉得很赞</span></div>';}let _0x1904a1='';_0x27f956[_0x37c369(0xff)]&&_0x27f956[_0x37c369(0xff)]['length']>0x0&&(_0x1904a1=_0x37c369(0x4bb),_0x27f956[_0x37c369(0xff)]['forEach']((_0x507710,_0x2e97a6)=>{const _0x28f5ef=_0x37c369;if(typeof _0x507710==='object'&&_0x507710!==null&&_0x507710['commenterName']){const _0x9ea4d9=_0x507710[_0x28f5ef(0x1335)],_0x791754=_0x5784e3(_0x9ea4d9);let _0x370686;_0x442b6b['test'](_0x507710[_0x28f5ef(0x673)])?_0x370686=_0x28f5ef(0x86)+_0x507710[_0x28f5ef(0x673)]+_0x28f5ef(0xf0d):_0x370686=_0x422b3c(_0x507710['text']);let _0x291130='';if(_0x507710['replyTo']){const _0x374561=_0x5784e3(_0x507710[_0x28f5ef(0xe51)]);_0x291130=_0x28f5ef(0xfa0)+_0x791754+_0x28f5ef(0xa4f)+_0x374561+'</span>:\x20'+_0x370686;}else _0x291130='<span\x20class=\x22commenter-name\x22>'+_0x791754+_0x28f5ef(0xadf)+_0x370686;_0x1904a1+=_0x28f5ef(0x1291)+_0x27f956['id']+_0x28f5ef(0x13c9)+_0x9ea4d9+_0x28f5ef(0x8f6)+_0x791754+_0x28f5ef(0xdfd)+_0x291130+_0x28f5ef(0xac6)+_0x2e97a6+_0x28f5ef(0xeaf);}else _0x1904a1+=_0x28f5ef(0x89e)+_0x422b3c(String(_0x507710))+_0x28f5ef(0x8e7);}),_0x1904a1+=_0x37c369(0x4b1));const _0xa25531=_0x3e7a1b[_0x37c369(0x3c2)][_0x37c369(0x78c)],_0x37f220=_0x27f956['likes']&&_0x27f956[_0x37c369(0x940)]['includes'](_0xa25531),_0x159f9a=_0x3e7a1b[_0x37c369(0x6b8)]&&_0x3e7a1b['favoritedPostIds'][_0x37c369(0x2a6)](_0x27f956['id']);let _0x2c75e7='';_0x27f956[_0x37c369(0xafc)]!==_0x37c369(0xe5a)&&(_0x2c75e7=_0x37c369(0xa3e));_0x293da0[_0x37c369(0xc58)]=_0x37c369(0x1143)+_0x5d5d7b+_0x37c369(0x3ac)+_0x27f956[_0x37c369(0x1188)]+_0x37c369(0x11ae)+_0x1541e8+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22post-timestamp\x22>'+_0x2f4f22(_0x27f956['timestamp'])+_0x37c369(0xbb3)+_0x5dba77+_0x37c369(0xc5f)+_0x2c75e7+_0x37c369(0x1018)+(_0x37f220?'active':'')+_0x37c369(0x12ce)+(_0x159f9a?_0x37c369(0x12ef):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x168654+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1904a1+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-footer\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22comment-section\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x15ffee+_0x37c369(0x1386);if(!_0x2210ac){const _0x4fd93a=document[_0x37c369(0x124e)](_0x37c369(0x479));_0x4fd93a[_0x37c369(0x87d)]=_0x37c369(0x232),_0x4fd93a[_0x37c369(0xc58)]=_0x37c369(0x1074),_0x5e2a06['appendChild'](_0x293da0),_0x5e2a06['appendChild'](_0x4fd93a);}return _0x5e2a06;}async function _0x2e523e(_0x32de57){const _0x805fd7=_0x5a7792,_0x5c4c7e=await _0x4e1bbf[_0x805fd7(0xaf9)]['get'](_0x32de57);if(!_0x5c4c7e){const _0x3df207=document[_0x805fd7(0x49c)](_0x805fd7(0xc2c)+_0x32de57+'\x22]');if(_0x3df207)_0x3df207[_0x805fd7(0x1275)]();return;}const _0x28c831=_0x10d3d6[_0x805fd7(0x6a2)](_0x54eb06=>_0x54eb06['id']===_0x32de57);if(_0x28c831>-0x1)_0x10d3d6[_0x28c831]=_0x5c4c7e;const _0x163614=await _0x4e1bbf[_0x805fd7(0x1232)][_0x805fd7(0xec9)](_0x805fd7(0xafc))['equals'](_0x805fd7(0x5e8))['toArray']();_0x3e7a1b[_0x805fd7(0x6b8)]=new Set(_0x163614[_0x805fd7(0xb96)](_0x14de81=>_0x14de81[_0x805fd7(0x3ba)]['id'])),_0x155dda(_0x5c4c7e);}function _0x4942eb(_0x1f7023){const _0x4b3ca6=_0x5a7792,_0x5117a4=Date['now'](),_0xa83490=Math[_0x4b3ca6(0x1245)]((_0x5117a4-_0x1f7023)/0x3e8),_0x5b7d08=Math['floor'](_0xa83490/0x3c);if(_0x5b7d08<0x2)return'刚刚';if(_0x5b7d08<0x3c)return _0x5b7d08+_0x4b3ca6(0x128);const _0x510e32=Math[_0x4b3ca6(0x1245)](_0x5b7d08/0x3c);if(_0x510e32<0x18)return _0x510e32+_0x4b3ca6(0x9ee);const _0x429727=Math[_0x4b3ca6(0x1245)](_0x510e32/0x18);return _0x429727+'天前';}async function _0x155dda(_0x3f3293){const _0xa9b6c2=_0x5a7792,_0x257918=document['querySelector'](_0xa9b6c2(0xc2c)+_0x3f3293['id']+'\x22]'),_0x30de7b=!!_0x257918,_0x336593=_0x30de7b?_0x257918:document[_0xa9b6c2(0x124e)](_0xa9b6c2(0x479));!_0x30de7b&&(_0x336593['className']=_0xa9b6c2(0x942),_0x336593['dataset'][_0xa9b6c2(0x6c2)]=_0x3f3293['id']);const _0x345081=_0x30de7b?_0x336593['querySelector']('.qzone-post-item'):document['createElement'](_0xa9b6c2(0x479));!_0x30de7b&&(_0x345081['className']=_0xa9b6c2(0x1115));let _0x586499='',_0x5ba6d9='',_0x7c559b=_0x3e7a1b[_0xa9b6c2(0x3c2)][_0xa9b6c2(0x1265)];if(_0x3f3293[_0xa9b6c2(0x1188)]===_0xa9b6c2(0xa4d))_0x586499=_0x3e7a1b[_0xa9b6c2(0x3c2)][_0xa9b6c2(0x1265)],_0x5ba6d9=_0x3e7a1b[_0xa9b6c2(0x3c2)][_0xa9b6c2(0x78c)];else{if(_0x3e7a1b['chats'][_0x3f3293[_0xa9b6c2(0x1188)]]){const _0x5f19b1=_0x3e7a1b[_0xa9b6c2(0x999)][_0x3f3293[_0xa9b6c2(0x1188)]];_0x586499=_0x5f19b1[_0xa9b6c2(0xcb3)][_0xa9b6c2(0x93)]||_0x54e358,_0x5ba6d9=_0x5f19b1[_0xa9b6c2(0x6fc)];}else{if(String(_0x3f3293[_0xa9b6c2(0x1188)])[_0xa9b6c2(0x7d)]('npc_')){const _0x252039=parseInt(String(_0x3f3293['authorId'])[_0xa9b6c2(0x137f)]('npc_',''));if(!isNaN(_0x252039)){const _0x5e1f24=await _0x4e1bbf[_0xa9b6c2(0xad7)]['get'](_0x252039);_0x5e1f24?(_0x586499=_0x5e1f24['avatar']||_0x480024,_0x5ba6d9=_0x5e1f24[_0xa9b6c2(0x6fc)]):(_0x5ba6d9=_0x3f3293[_0xa9b6c2(0xa0a)]||_0xa9b6c2(0x133a),_0x586499=_0x480024);}}else _0x5ba6d9=_0x5784e3(_0x3f3293[_0xa9b6c2(0xa0a)]),_0x586499=_0x54e358;}}function _0x3b9e00(_0x4e147a){const _0x52650f=_0xa9b6c2;let _0x4e9aa9='';const _0x5a7173=_0x4e147a['publicText']?'<div\x20class=\x22post-content\x22>'+_0x422b3c(_0x4e147a[_0x52650f(0x66e)])[_0x52650f(0x137f)](/\n/g,_0x52650f(0x917))+_0x52650f(0x4b1):'';if(_0x4e147a[_0x52650f(0xafc)]===_0x52650f(0x103d))_0x4e9aa9=_0x52650f(0x1023)+_0x422b3c(_0x4e147a[_0x52650f(0x3ba)])[_0x52650f(0x137f)](/\n/g,_0x52650f(0x917))+_0x52650f(0x4b1);else{if(_0x4e147a[_0x52650f(0xafc)]===_0x52650f(0x3d9)&&_0x4e147a['imageUrl'])_0x4e9aa9=_0x5a7173?_0x5a7173+_0x52650f(0x11f9)+_0x4e147a[_0x52650f(0xd07)]+'\x22\x20class=\x22chat-image\x22></div>':_0x52650f(0x86)+_0x4e147a['imageUrl']+_0x52650f(0xb1a);else{if(_0x4e147a['type']===_0x52650f(0x351)){const _0x130c4b=_0x3e7a1b['globalSettings'][_0x52650f(0xc83)]&&_0x4e147a[_0x52650f(0x242)]?_0x52650f(0xb1f)+_0x4e147a[_0x52650f(0x242)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x4e9aa9=_0x5a7173?_0x5a7173+'<div\x20style=\x22margin-top:10px;\x22><img\x20src=\x22'+_0x130c4b+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x4e147a[_0x52650f(0x1150)]+_0x52650f(0x99d):_0x52650f(0x86)+_0x130c4b+_0x52650f(0x12ab)+_0x4e147a[_0x52650f(0x1150)]+'\x22>';}else{if(_0x4e147a[_0x52650f(0xafc)]==='naiimag'){const _0x4180a1=_0x4e147a['imageUrls']||(_0x4e147a[_0x52650f(0xd07)]?[_0x4e147a[_0x52650f(0xd07)]]:[]);if(_0x4180a1['length']>0x0){const _0x19162c=_0x4180a1['length'];let _0x4bd6d3='';_0x4bd6d3=_0x52650f(0xaeb)+_0x19162c+'\x22>',_0x4180a1[_0x52650f(0x103)]((_0x453fa6,_0x5c2272)=>{const _0x1464c3=_0x52650f;_0x4bd6d3+=_0x1464c3(0x86)+_0x453fa6+_0x1464c3(0xf79)+(_0x5c2272+0x1)+_0x1464c3(0x54f);}),_0x4bd6d3+=_0x52650f(0x4b1),_0x4e9aa9=_0x5a7173?''+_0x5a7173+_0x4bd6d3:_0x4bd6d3;}}}}}return _0x4e9aa9;}let _0x31011d;if(_0x3f3293[_0xa9b6c2(0xafc)]==='repost'){const _0x189455=_0x3f3293[_0xa9b6c2(0xa19)]?_0xa9b6c2(0x65b)+_0x3f3293[_0xa9b6c2(0xa19)][_0xa9b6c2(0x137f)](/\n/g,_0xa9b6c2(0x917))+_0xa9b6c2(0x4b1):'';let _0x1e0e0a=_0x54e358,_0x3bc6f8='原作者';if(_0x3f3293[_0xa9b6c2(0x32f)][_0xa9b6c2(0x1188)]===_0xa9b6c2(0xa4d))_0x1e0e0a=_0x3e7a1b[_0xa9b6c2(0x3c2)]['avatar'],_0x3bc6f8=_0x3e7a1b['qzoneSettings'][_0xa9b6c2(0x78c)];else{const _0x4ae8ba=_0x3e7a1b[_0xa9b6c2(0x999)][_0x3f3293[_0xa9b6c2(0x32f)]['authorId']];_0x4ae8ba&&(_0x1e0e0a=_0x4ae8ba[_0xa9b6c2(0xcb3)][_0xa9b6c2(0x93)]||_0x54e358),_0x3bc6f8=_0x5784e3(_0x3f3293[_0xa9b6c2(0x32f)][_0xa9b6c2(0xa0a)]);}_0x31011d='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x189455+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22reposted-content-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x1e0e0a+_0xa9b6c2(0x8fa)+_0x3bc6f8+_0xa9b6c2(0x123)+_0x2f4f22(_0x3f3293[_0xa9b6c2(0x32f)][_0xa9b6c2(0x8af)])+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-main-content\x22>'+_0x3b9e00(_0x3f3293[_0xa9b6c2(0x32f)])+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else _0x31011d=_0xa9b6c2(0x61f)+_0x3b9e00(_0x3f3293)+'</div>';let _0x30bfbb='';if(_0x3f3293[_0xa9b6c2(0x940)]&&_0x3f3293[_0xa9b6c2(0x940)][_0xa9b6c2(0x40f)]>0x0){const _0x4d9176=_0x3f3293['likes'][_0xa9b6c2(0xb96)](_0x5900ac=>_0x5784e3(_0x5900ac))[_0xa9b6c2(0xd22)]('、');_0x30bfbb='<div\x20class=\x22post-likes-section\x22><svg\x20class=\x22like-icon\x22\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg><span>'+_0x4d9176+_0xa9b6c2(0xba6);}let _0x5c9fd1='';_0x3f3293[_0xa9b6c2(0xff)]&&_0x3f3293[_0xa9b6c2(0xff)][_0xa9b6c2(0x40f)]>0x0&&(_0x5c9fd1=_0xa9b6c2(0x4bb),_0x3f3293[_0xa9b6c2(0xff)][_0xa9b6c2(0x103)]((_0x2ac1c8,_0x25da79)=>{const _0x9fd190=_0xa9b6c2;if(typeof _0x2ac1c8===_0x9fd190(0x59a)&&_0x2ac1c8!==null&&_0x2ac1c8['commenterName']){const _0x4969bd=_0x2ac1c8[_0x9fd190(0x1335)],_0x1f1f85=_0x5784e3(_0x4969bd);let _0x4a22f2;_0x442b6b[_0x9fd190(0x4af)](_0x2ac1c8[_0x9fd190(0x673)])?_0x4a22f2=_0x9fd190(0x86)+_0x2ac1c8[_0x9fd190(0x673)]+_0x9fd190(0xf0d):_0x4a22f2=_0x422b3c(_0x2ac1c8[_0x9fd190(0x673)]);let _0x375938='';if(_0x2ac1c8[_0x9fd190(0xe51)]){const _0x28b35f=_0x5784e3(_0x2ac1c8[_0x9fd190(0xe51)]);_0x375938=_0x9fd190(0xfa0)+_0x1f1f85+'</span>\x20回复\x20<span\x20class=\x22commenter-name\x22>'+_0x28b35f+_0x9fd190(0xadf)+_0x4a22f2;}else _0x375938=_0x9fd190(0xfa0)+_0x1f1f85+_0x9fd190(0xadf)+_0x4a22f2;_0x5c9fd1+=_0x9fd190(0x1291)+_0x3f3293['id']+_0x9fd190(0x13c9)+_0x4969bd+_0x9fd190(0x8f6)+_0x1f1f85+_0x9fd190(0xdfd)+_0x375938+_0x9fd190(0xac6)+_0x25da79+_0x9fd190(0xeaf);}else _0x5c9fd1+=_0x9fd190(0x89e)+String(_0x2ac1c8)+_0x9fd190(0x8e7);}),_0x5c9fd1+=_0xa9b6c2(0x4b1));const _0x261615=_0x3e7a1b[_0xa9b6c2(0x3c2)][_0xa9b6c2(0x78c)],_0x232f6e=_0x3f3293[_0xa9b6c2(0x940)]&&_0x3f3293[_0xa9b6c2(0x940)][_0xa9b6c2(0xe53)](_0x261615),_0x328384=_0x3e7a1b[_0xa9b6c2(0x6b8)]&&_0x3e7a1b[_0xa9b6c2(0x6b8)]['has'](_0x3f3293['id']);let _0xc576c2='';_0x3f3293[_0xa9b6c2(0xafc)]!==_0xa9b6c2(0xe5a)&&(_0xc576c2='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22action-icon\x20repost\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M17\x202.1l4\x204-4\x204\x20M3\x2011.5v-3a4\x204\x200\x200\x201\x204-4h13\x20M7\x2021.9l-4-4\x204-4\x20M21\x2012.5v3a4\x204\x200\x200\x201-4\x204H4\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</span>');_0x345081[_0xa9b6c2(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x586499+_0xa9b6c2(0x3ac)+_0x3f3293['authorId']+_0xa9b6c2(0x11ae)+_0x5ba6d9+_0xa9b6c2(0x410)+_0x2f4f22(_0x3f3293[_0xa9b6c2(0x8af)])+_0xa9b6c2(0xbb3)+_0x31011d+_0xa9b6c2(0xc5f)+_0xc576c2+_0xa9b6c2(0x1018)+(_0x232f6e?_0xa9b6c2(0x12ef):'')+_0xa9b6c2(0x12ce)+(_0x328384?_0xa9b6c2(0x12ef):'')+'\x22><svg\x20viewBox=\x220\x200\x2024\x2024\x22><path\x20d=\x22M12\x202l3.09\x206.26L22\x209.27l-5\x204.87\x201.18\x206.88L12\x2017.77l-6.18\x203.25L7\x2014.14\x202\x209.27l6.91-1.01L12\x202z\x22></path></svg></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x30bfbb+_0xa9b6c2(0x783)+_0x5c9fd1+_0xa9b6c2(0x7c4)+_0x7c559b+_0xa9b6c2(0x1386);if(!_0x30de7b){const _0x4a5a04=document[_0xa9b6c2(0x124e)](_0xa9b6c2(0x479));_0x4a5a04[_0xa9b6c2(0x87d)]='qzone-post-delete-action',_0x4a5a04['innerHTML']=_0xa9b6c2(0x1074),_0x336593['appendChild'](_0x345081),_0x336593[_0xa9b6c2(0x99e)](_0x4a5a04);}return _0x336593;}async function _0x2e523e(_0x4fba2f){const _0x4c3414=_0x5a7792,_0xe32fe3=await _0x4e1bbf['qzonePosts']['get'](_0x4fba2f);if(!_0xe32fe3){const _0xe7eeb=document[_0x4c3414(0x49c)](_0x4c3414(0xc2c)+_0x4fba2f+'\x22]');_0xe7eeb&&_0xe7eeb[_0x4c3414(0x1275)]();return;}const _0x1156a4=_0x10d3d6[_0x4c3414(0x6a2)](_0x429299=>_0x429299['id']===_0x4fba2f);_0x1156a4>-0x1&&(_0x10d3d6[_0x1156a4]=_0xe32fe3);const _0x1f82ba=await _0x4e1bbf[_0x4c3414(0x1232)][_0x4c3414(0xec9)]('type')[_0x4c3414(0x11cd)](_0x4c3414(0x5e8))[_0x4c3414(0x78f)]();_0x3e7a1b[_0x4c3414(0x6b8)]=new Set(_0x1f82ba['map'](_0x24ab70=>_0x24ab70[_0x4c3414(0x3ba)]['id'])),await _0x155dda(_0xe32fe3);}async function _0x40e6dd(){const _0x2d2967=_0x5a7792,_0x1c6a7f=document[_0x2d2967(0x64f)](_0x2d2967(0x108b));if(!_0x1c6a7f)return;const [_0x29e15a,_0x111c7e]=await Promise['all']([_0x4e1bbf['qzonePosts'][_0x2d2967(0xe1d)](_0x2d2967(0x8af))[_0x2d2967(0x2f4)]()[_0x2d2967(0x156)](_0x2218a8=>!_0x2218a8[_0x2d2967(0x1371)])[_0x2d2967(0x78f)](),_0x4e1bbf['favorites'][_0x2d2967(0xec9)](_0x2d2967(0xafc))['equals']('qzone_post')[_0x2d2967(0x78f)]()]);_0x10d3d6=_0x29e15a,_0x3e7a1b[_0x2d2967(0x6b8)]=new Set(_0x111c7e[_0x2d2967(0xb96)](_0x430d84=>_0x430d84[_0x2d2967(0x3ba)]['id'])),_0x1c6a7f[_0x2d2967(0xc58)]='',_0x2bcd5c=0x0;if(_0x10d3d6[_0x2d2967(0x40f)]===0x0){_0x1c6a7f['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2030px\x200;\x22>这里空空如也，快来发布第一条说说吧！</p>';return;}_0xc395();}async function _0xc395(){const _0x307f6a=_0x5a7792;if(_0x3a7ca4)return;_0x3a7ca4=!![];const _0x407b61=document[_0x307f6a(0x64f)](_0x307f6a(0x108b));if(!_0x407b61){_0x3a7ca4=![];return;}_0x429707(_0x407b61,'bottom'),setTimeout(async()=>{const _0x42f535=_0x307f6a;_0x23b212(_0x407b61);const _0x1db229=_0x2bcd5c,_0x3d3045=_0x2bcd5c+_0x52ef4f,_0x396336=_0x10d3d6[_0x42f535(0xdf5)](_0x1db229,_0x3d3045),_0x3fc5cb=document[_0x42f535(0x148)]();for(const _0x49d963 of _0x396336){const _0x53714f=await _0x155dda(_0x49d963);_0x3fc5cb[_0x42f535(0x99e)](_0x53714f);}_0x407b61[_0x42f535(0x99e)](_0x3fc5cb),_0x2bcd5c+=_0x396336['length'],_0x3a7ca4=![];},0x1f4);}function _0x203acf(_0x514b53,_0x1a1421){const _0x3899ed=_0x5a7792,_0x45ea20=_0x146c2e[_0x3899ed(0xaab)],_0x31f8c0=_0x146c2e[_0x3899ed(0x740)];_0x31f8c0[_0x3899ed(0xc58)]='';_0x3e7a1b[_0x3899ed(0xa8b)][_0x3899ed(0x40f)]===0x0?_0x31f8c0['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20padding-top:\x2020px;\x22>请先在聊天界面的<br>表情面板中添加表情包</p>':_0x3e7a1b[_0x3899ed(0xa8b)][_0x3899ed(0x103)](_0x4d5043=>{const _0x3ba095=_0x3899ed,_0x5da82a=document[_0x3ba095(0x124e)]('div');_0x5da82a[_0x3ba095(0x87d)]=_0x3ba095(0xa01),_0x5da82a[_0x3ba095(0x731)][_0x3ba095(0x4d6)]='url('+_0x4d5043[_0x3ba095(0xe52)]+')',_0x5da82a[_0x3ba095(0x1250)]=_0x4d5043[_0x3ba095(0x6fc)],_0x31f8c0['appendChild'](_0x5da82a);});const _0x83cec2=_0x1a1421[_0x3899ed(0x528)](),_0x865136=document[_0x3899ed(0x64f)]('phone-screen')[_0x3899ed(0x528)]();_0x45ea20[_0x3899ed(0x731)][_0x3899ed(0x130)]=_0x3899ed(0x1026);const _0x6b6969=_0x45ea20[_0x3899ed(0x528)](),_0x3a38bf=_0x6b6969[_0x3899ed(0x877)],_0x24917d=_0x6b6969[_0x3899ed(0x1123)];_0x45ea20[_0x3899ed(0x731)][_0x3899ed(0x4ed)]=_0x83cec2[_0x3899ed(0x4ed)]-_0x3a38bf-0x5-_0x865136[_0x3899ed(0x4ed)]+'px';const _0x48d748=_0x83cec2[_0x3899ed(0xbbf)]-_0x865136[_0x3899ed(0xbbf)];_0x48d748+_0x24917d>_0x865136[_0x3899ed(0x1123)]?(_0x45ea20[_0x3899ed(0x731)][_0x3899ed(0xbbf)]=_0x3899ed(0x126b),_0x45ea20[_0x3899ed(0x731)][_0x3899ed(0x121)]=_0x3899ed(0x813)):(_0x45ea20[_0x3899ed(0x731)][_0x3899ed(0xbbf)]=_0x48d748+'px',_0x45ea20[_0x3899ed(0x731)][_0x3899ed(0x121)]=_0x3899ed(0x126b)),_0x146c2e[_0x3899ed(0xb68)]=!![],_0x146c2e[_0x3899ed(0x3af)]=_0x514b53;}function _0x42f08a(){const _0x4f3944=_0x5a7792;_0x146c2e[_0x4f3944(0xb68)]&&(_0x146c2e[_0x4f3944(0xaab)][_0x4f3944(0x731)][_0x4f3944(0x130)]=_0x4f3944(0x1209),_0x146c2e[_0x4f3944(0xb68)]=![],_0x146c2e[_0x4f3944(0x3af)]=null);}async function _0x1cebda(_0x3b5837,_0x3024ee){const _0x3e4da2=_0x5a7792;if(!_0x3024ee||!_0x3024ee[_0x3e4da2(0xe52)])return;const _0x334806=await _0x4e1bbf[_0x3e4da2(0xaf9)][_0x3e4da2(0x11fc)](_0x3b5837);if(!_0x334806){console[_0x3e4da2(0xc60)]('sendQzoneStickerComment:\x20找不到帖子:',_0x3b5837);return;}!_0x334806['comments']&&(_0x334806[_0x3e4da2(0xff)]=[]);const _0x16b8b1={'commenterName':_0x3e7a1b[_0x3e4da2(0x3c2)][_0x3e4da2(0x78c)],'text':_0x3024ee[_0x3e4da2(0xe52)],'meaning':_0x3024ee[_0x3e4da2(0x6fc)],'timestamp':Date[_0x3e4da2(0x2b5)]()};_0x334806[_0x3e4da2(0xff)][_0x3e4da2(0x13ee)](_0x16b8b1),await _0x4e1bbf[_0x3e4da2(0xaf9)][_0x3e4da2(0x32e)](_0x3b5837,{'comments':_0x334806[_0x3e4da2(0xff)]}),_0x42f08a(),await _0x40e6dd();const _0x4ccc69=(_0x334806[_0x3e4da2(0x66e)]||_0x334806['content']||_0x3e4da2(0x1c0))[_0x3e4da2(0x126f)](0x0,0x1e);for(const _0x151b5a in _0x3e7a1b[_0x3e4da2(0x999)]){const _0x36cc87=_0x3e7a1b['chats'][_0x151b5a];if(!_0x36cc87['isGroup']){const _0x206de7=_0x3e4da2(0xa26)+_0x3e7a1b[_0x3e4da2(0x3c2)][_0x3e4da2(0x78c)]+'\x27\x20在你的动态(ID:\x20'+_0x3b5837+_0x3e4da2(0xcaf)+_0x4ccc69+_0x3e4da2(0xcdd)+_0x3024ee[_0x3e4da2(0x6fc)]+_0x3e4da2(0x11b1),_0x25f4f0={'role':'system','content':_0x206de7,'timestamp':Date[_0x3e4da2(0x2b5)](),'isHidden':!![]};_0x36cc87[_0x3e4da2(0x830)][_0x3e4da2(0x13ee)](_0x25f4f0),await _0x4e1bbf['chats'][_0x3e4da2(0x4fa)](_0x36cc87);}}}function _0x31ae81(_0x1cf424){const _0x5ef00d=_0x5a7792;_0x43f2f0=_0x1cf424,document['getElementById']('repost-comment-input')[_0x5ef00d(0xbed)]='',document[_0x5ef00d(0x64f)](_0x5ef00d(0x86e))[_0x5ef00d(0x418)][_0x5ef00d(0xdda)](_0x5ef00d(0x40a));}function _0x36deb5(){const _0xb27e5=_0x5a7792;document['getElementById']('repost-modal')['classList'][_0xb27e5(0x1275)](_0xb27e5(0x40a)),_0x43f2f0=null;}async function _0x2c8887(){const _0x50b5bc=_0x5a7792;if(!_0x43f2f0)return;const _0x171d2f=document[_0x50b5bc(0x64f)](_0x50b5bc(0xe6a))[_0x50b5bc(0xbed)][_0x50b5bc(0x43a)](),_0x6332cc=await _0x4e1bbf[_0x50b5bc(0xaf9)][_0x50b5bc(0x11fc)](_0x43f2f0);if(!_0x6332cc){alert(_0x50b5bc(0x101a)),_0x36deb5();return;}const _0x55392e={'type':_0x50b5bc(0xe5a),'timestamp':Date[_0x50b5bc(0x2b5)](),'authorId':_0x50b5bc(0xa4d),'repostComment':_0x171d2f,'originalPost':_0x6332cc,'visibleGroupIds':null};await _0x4e1bbf['qzonePosts'][_0x50b5bc(0xdda)](_0x55392e),_0x36deb5(),await _0x40e6dd(),alert('转发成功！');}function _0x1dbcf8(_0x9bb706){const _0x51f96f=_0x5a7792,_0x2cf227=document[_0x51f96f(0x64f)]('favorites-list');_0x2cf227[_0x51f96f(0xc58)]='';if(_0x9bb706['length']===0x0){const _0x14378a=document[_0x51f96f(0x64f)]('favorites-search-input')[_0x51f96f(0xbed)],_0x4fdb41=_0x14378a?_0x51f96f(0xe39):_0x51f96f(0xae);_0x2cf227[_0x51f96f(0xc58)]=_0x51f96f(0x1f4)+_0x4fdb41+'</p>';return;}for(const _0xc06131 of _0x9bb706){const _0x169ced=document[_0x51f96f(0x124e)]('div');_0x169ced[_0x51f96f(0x87d)]=_0x51f96f(0xf31),_0x169ced['dataset'][_0x51f96f(0xd69)]=_0xc06131['id'];let _0x350e5b='',_0x1f5313='',_0x58e816='',_0x3be9f2='';if(_0xc06131[_0x51f96f(0xafc)]===_0x51f96f(0x5e8)){const _0x2254fc=_0xc06131[_0x51f96f(0x3ba)];_0x58e816=_0x51f96f(0x1373);let _0x2e4cdd=_0x54e358,_0x16fbeb=_0x51f96f(0x100b);if(_0x2254fc['authorId']==='user')_0x2e4cdd=_0x3e7a1b[_0x51f96f(0x3c2)][_0x51f96f(0x1265)],_0x16fbeb=_0x3e7a1b[_0x51f96f(0x3c2)][_0x51f96f(0x78c)];else _0x3e7a1b[_0x51f96f(0x999)][_0x2254fc[_0x51f96f(0x1188)]]&&(_0x2e4cdd=_0x3e7a1b[_0x51f96f(0x999)][_0x2254fc[_0x51f96f(0x1188)]][_0x51f96f(0xcb3)][_0x51f96f(0x93)],_0x16fbeb=_0x3e7a1b['chats'][_0x2254fc[_0x51f96f(0x1188)]][_0x51f96f(0x6fc)]);_0x350e5b='<img\x20src=\x22'+_0x2e4cdd+_0x51f96f(0x356)+_0x16fbeb+_0x51f96f(0xb86);const _0x321f02=_0x2254fc[_0x51f96f(0x66e)]?_0x51f96f(0x65b)+_0x2254fc[_0x51f96f(0x66e)][_0x51f96f(0x137f)](/\n/g,_0x51f96f(0x917))+_0x51f96f(0x4b1):'';if(_0x2254fc[_0x51f96f(0xafc)]==='shuoshuo')_0x1f5313='<div\x20class=\x22post-content\x22>'+_0x2254fc[_0x51f96f(0x3ba)]['replace'](/\n/g,'<br>')+'</div>';else{if(_0x2254fc[_0x51f96f(0xafc)]===_0x51f96f(0x3d9)&&_0x2254fc[_0x51f96f(0xd07)]){const _0x3d9a75=_0x3e7a1b[_0x51f96f(0x11b4)][_0x51f96f(0xc83)]&&_0x2254fc[_0x51f96f(0x242)]?_0x51f96f(0xb1f)+_0x2254fc[_0x51f96f(0x242)]:_0x51f96f(0x716);_0x1f5313=_0x321f02?_0x321f02+_0x51f96f(0x11f9)+_0x3d9a75+_0x51f96f(0x11be):'<img\x20src=\x22'+_0x3d9a75+_0x51f96f(0xb1a);}else{if(_0x2254fc[_0x51f96f(0xafc)]===_0x51f96f(0x351)){const _0x273b26=_0x3e7a1b[_0x51f96f(0x11b4)][_0x51f96f(0xc83)]&&_0x2254fc['image_prompt']?_0x51f96f(0xb1f)+_0x2254fc[_0x51f96f(0x242)]:'https://i.postimg.cc/KYr2qRCK/1.jpg';_0x1f5313=_0x321f02?_0x321f02+_0x51f96f(0x11f9)+_0x273b26+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x2254fc[_0x51f96f(0x1150)]+'\x22></div>':_0x51f96f(0x86)+_0x273b26+'\x22\x20class=\x22chat-image\x22\x20style=\x22cursor:\x20pointer;\x22\x20data-hidden-text=\x22'+_0x2254fc[_0x51f96f(0x1150)]+'\x22>';}}}let _0x17b14f='';_0x2254fc[_0x51f96f(0x940)]&&_0x2254fc['likes']['length']>0x0&&(_0x17b14f=_0x51f96f(0x4b0)+_0x2254fc[_0x51f96f(0x940)][_0x51f96f(0xd22)]('、')+_0x51f96f(0xf45));let _0x1ffcf1='';_0x2254fc[_0x51f96f(0xff)]&&_0x2254fc[_0x51f96f(0xff)]['length']>0x0&&(_0x1ffcf1=_0x51f96f(0x4bb),_0x2254fc[_0x51f96f(0xff)][_0x51f96f(0x103)]((_0x2bd2fc,_0x1be5f6)=>{const _0x2f8fed=_0x51f96f;if(typeof _0x2bd2fc===_0x2f8fed(0x59a)&&_0x2bd2fc!==null&&_0x2bd2fc['commenterName']){const _0x5abec8=_0x2bd2fc[_0x2f8fed(0x1335)],_0x5529d7=_0x5784e3(_0x5abec8);let _0x231a69;_0x442b6b['test'](_0x2bd2fc['text'])?_0x231a69=_0x2f8fed(0x86)+_0x2bd2fc[_0x2f8fed(0x673)]+_0x2f8fed(0xf0d):_0x231a69=_0x2bd2fc[_0x2f8fed(0x673)];let _0x2cbe8d='';if(_0x2bd2fc[_0x2f8fed(0xe51)]){const _0x268db3=_0x5784e3(_0x2bd2fc[_0x2f8fed(0xe51)]);_0x2cbe8d='<span\x20class=\x22commenter-name\x22>'+_0x5529d7+_0x2f8fed(0xa4f)+_0x268db3+_0x2f8fed(0xadf)+_0x231a69;}else _0x2cbe8d=_0x2f8fed(0xfa0)+_0x5529d7+_0x2f8fed(0xadf)+_0x231a69;_0x1ffcf1+='<div\x20class=\x22comment-item\x22\x20data-post-id=\x22'+_0x2254fc['id']+'\x22\x20data-commenter-original-name=\x22'+_0x5abec8+_0x2f8fed(0x8f6)+_0x5529d7+_0x2f8fed(0x8cb)+_0x2cbe8d+_0x2f8fed(0x38c)+_0x1be5f6+_0x2f8fed(0x133);}else _0x1ffcf1+=_0x2f8fed(0x275)+String(_0x2bd2fc)+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>';}),_0x1ffcf1+='</div>'),_0x3be9f2=''+_0x17b14f+_0x1ffcf1;}else{if(_0xc06131['type']===_0x51f96f(0x102b)){const _0x46fbb8=_0xc06131['content'],_0x1bedd2=_0x3e7a1b[_0x51f96f(0x999)][_0xc06131[_0x51f96f(0x367)]];if(!_0x1bedd2)continue;_0x58e816=_0x51f96f(0xa32)+_0x1bedd2[_0x51f96f(0x6fc)]+_0x51f96f(0x8bd);const _0x197ee2=_0x46fbb8[_0x51f96f(0x931)]===_0x51f96f(0xa4d);let _0x3a158c,_0x2a69df;if(_0x197ee2)_0x3a158c=_0x1bedd2[_0x51f96f(0x1167)]?_0x1bedd2[_0x51f96f(0xcb3)][_0x51f96f(0x96f)]||'我':'我',_0x2a69df=_0x1bedd2[_0x51f96f(0xcb3)][_0x51f96f(0x96a)]||(_0x1bedd2['isGroup']?_0x60cf2:_0x54e358);else{if(_0x1bedd2[_0x51f96f(0x1167)]){const _0x91810b=_0x1bedd2['members']['find'](_0xf0c0ab=>_0xf0c0ab[_0x51f96f(0x7de)]===_0x46fbb8[_0x51f96f(0x133d)]);_0x3a158c=_0x46fbb8[_0x51f96f(0x133d)],_0x2a69df=_0x91810b?_0x91810b[_0x51f96f(0x1265)]:_0x480024;}else _0x3a158c=_0x1bedd2['name'],_0x2a69df=_0x1bedd2[_0x51f96f(0xcb3)]['aiAvatar']||_0x54e358;}_0x350e5b='<img\x20src=\x22'+_0x2a69df+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x3a158c+'</div></div>';if(typeof _0x46fbb8['content']===_0x51f96f(0x1251)&&_0x442b6b['test'](_0x46fbb8['content']))_0x1f5313=_0x51f96f(0x86)+_0x46fbb8[_0x51f96f(0x3ba)]+_0x51f96f(0x99b);else Array['isArray'](_0x46fbb8['content'])&&_0x46fbb8['content'][0x0]?.[_0x51f96f(0xafc)]===_0x51f96f(0x6da)?_0x1f5313=_0x51f96f(0x86)+_0x46fbb8[_0x51f96f(0x3ba)][0x0][_0x51f96f(0x6da)][_0x51f96f(0xe52)]+'\x22\x20class=\x22chat-image\x22>':_0x1f5313=String(_0x46fbb8['content']||'')[_0x51f96f(0x137f)](/\n/g,_0x51f96f(0x917));}else{if(_0xc06131[_0x51f96f(0xafc)]===_0x51f96f(0x138b)){const _0x48b5b7=_0xc06131['content'];_0x58e816=_0x51f96f(0x33a)+_0x48b5b7[_0x51f96f(0xad)]+_0x51f96f(0xe69);const _0x14f4bf=_0x3e7a1b[_0x51f96f(0x999)][_0x48b5b7['characterId']],_0x834dcb=_0x14f4bf?_0x14f4bf[_0x51f96f(0xcb3)][_0x51f96f(0x93)]:_0x54e358;_0x350e5b=_0x51f96f(0x86)+_0x834dcb+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x48b5b7['characterName']+_0x51f96f(0xb86);const _0x257ab5=_0x48b5b7[_0x51f96f(0x3ba)]||'',_0x1c1e54=_0x422b3c(_0x257ab5)[_0x51f96f(0x137f)](/\n/g,'<br>');_0x1f5313=_0x51f96f(0x568)+_0x48b5b7[_0x51f96f(0x1250)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22fav-card-content-full\x22>'+_0x1c1e54+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0xc06131[_0x51f96f(0xafc)]==='char_browser_article'){const _0x424298=_0xc06131[_0x51f96f(0x3ba)];_0x58e816=_0x51f96f(0x33a)+_0x424298[_0x51f96f(0xad)]+_0x51f96f(0x293);const _0xc24976=_0x3e7a1b['chats'][_0x424298[_0x51f96f(0x3df)]],_0x439902=_0xc24976?_0xc24976['settings'][_0x51f96f(0x93)]:_0x54e358;_0x350e5b=_0x51f96f(0x86)+_0x439902+'\x22\x20class=\x22avatar\x22><div\x20class=\x22info\x22><div\x20class=\x22name\x22>'+_0x424298[_0x51f96f(0xad)]+_0x51f96f(0xb86),_0x1f5313=_0x51f96f(0x2e0)+_0x424298[_0x51f96f(0x1250)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22memo-content-preview\x22>'+(_0x424298[_0x51f96f(0x3ba)]||'')[_0x51f96f(0x137f)](/\n/g,_0x51f96f(0x917))+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{if(_0xc06131[_0x51f96f(0xafc)]===_0x51f96f(0x5b2)){const _0x5da6b7=_0xc06131[_0x51f96f(0x3ba)];_0x58e816=_0x51f96f(0x33a)+_0x5da6b7['characterName']+_0x51f96f(0x3c1);const _0x1ee9f5=_0x3e7a1b['chats'][_0x5da6b7[_0x51f96f(0x3df)]],_0x2ab869=_0x1ee9f5?_0x1ee9f5[_0x51f96f(0xcb3)][_0x51f96f(0x93)]:_0x54e358;_0x350e5b=_0x51f96f(0x86)+_0x2ab869+_0x51f96f(0x356)+_0x5da6b7['characterName']+_0x51f96f(0xb86),_0x1f5313=_0x51f96f(0xc75)+_0x5da6b7[_0x51f96f(0x1250)]+_0x51f96f(0xa72)+_0x5da6b7['content'][_0x51f96f(0x137f)](/\n/g,'<br>')+_0x51f96f(0x7f3);}}}}}_0x169ced[_0x51f96f(0xc58)]=_0x51f96f(0x11c6)+_0x350e5b+_0x51f96f(0x71)+_0x58e816+_0x51f96f(0xb0b)+_0x1f5313+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3be9f2,_0x2cf227[_0x51f96f(0x99e)](_0x169ced);}}async function _0x2ff98d(){const _0x8a645a=_0x5a7792;allFavoriteItems=await _0x4e1bbf[_0x8a645a(0x1232)][_0x8a645a(0xe1d)](_0x8a645a(0x8af))[_0x8a645a(0x2f4)]()['toArray']();const _0x29f9b7=document[_0x8a645a(0x64f)](_0x8a645a(0xf76)),_0x230901=document[_0x8a645a(0x64f)](_0x8a645a(0x766));_0x29f9b7[_0x8a645a(0xbed)]='',_0x230901['style'][_0x8a645a(0x130)]=_0x8a645a(0x1209),_0x1dbcf8(allFavoriteItems);}function _0x55c36e(){const _0x228eb9=_0x5a7792;document['getElementById'](_0x228eb9(0xec4))['value']='',document['getElementById'](_0x228eb9(0x104))['src']='',document[_0x228eb9(0x64f)](_0x228eb9(0x729))[_0x228eb9(0xbed)]='',document[_0x228eb9(0x64f)](_0x228eb9(0xdb9))[_0x228eb9(0x418)][_0x228eb9(0x1275)](_0x228eb9(0x40a)),document['getElementById']('post-image-desc-group')[_0x228eb9(0x731)][_0x228eb9(0x130)]=_0x228eb9(0x1209),document[_0x228eb9(0x64f)]('post-local-image-input')['value']='',document[_0x228eb9(0x64f)](_0x228eb9(0x8cd))[_0x228eb9(0xbed)]='',document[_0x228eb9(0x64f)](_0x228eb9(0x10a))[_0x228eb9(0x1080)]();}async function _0x3e70b9(){const _0x1944f1=_0x5a7792,_0xa90573=await _0x54149f(_0x1944f1(0x639),_0x1944f1(0xb55),{'confirmButtonClass':_0x1944f1(0xeed),'confirmText':_0x1944f1(0x635)});if(!_0xa90573)return;await _0x28974b(_0x1944f1(0x2f7),_0x1944f1(0xbf4)),console[_0x1944f1(0x1081)]('冗余数据清理流程已启动...');let _0x16e98a={'posts':0x0,'likes':0x0,'comments':0x0,'memories':0x0,'callRecords':0x0,'renderingRules':0x0,'groupMembers':0x0,'chatLinks':0x0};try{await _0x4e1bbf[_0x1944f1(0x62a)]('rw',_0x4e1bbf['tables'],async()=>{const _0x2adbca=_0x1944f1,_0x1f5ce0=await _0x4e1bbf[_0x2adbca(0x999)][_0x2adbca(0x78f)](),_0x1a29e4=await _0x4e1bbf[_0x2adbca(0xad7)][_0x2adbca(0x78f)](),_0x2a9ec1=new Set(_0x1f5ce0[_0x2adbca(0xb96)](_0x2bc456=>_0x2bc456['id'])),_0x4fe0b3=new Set(_0x1a29e4[_0x2adbca(0xb96)](_0x34ebd5=>_0x2adbca(0x33e)+_0x34ebd5['id'])),_0x5bfee9=new Set(_0x1f5ce0['filter'](_0x14d1ce=>!_0x14d1ce[_0x2adbca(0x1167)])[_0x2adbca(0xb96)](_0x3c6125=>_0x3c6125[_0x2adbca(0x7de)]));_0x5bfee9[_0x2adbca(0xdda)](_0x3e7a1b['qzoneSettings'][_0x2adbca(0x78c)]||'{{user}}'),_0x1a29e4[_0x2adbca(0x103)](_0x1f17fb=>_0x5bfee9['add'](_0x1f17fb[_0x2adbca(0x6fc)]));for(const _0x1cd3f0 of _0x1f5ce0){let _0x15d0fd=![];if(_0x1cd3f0[_0x2adbca(0x1167)]&&_0x1cd3f0[_0x2adbca(0x5d4)]){const _0x2316ef=_0x1cd3f0[_0x2adbca(0x5d4)][_0x2adbca(0x40f)];_0x1cd3f0[_0x2adbca(0x5d4)]=_0x1cd3f0['members'][_0x2adbca(0x156)](_0x1779c6=>_0x2a9ec1[_0x2adbca(0x2a6)](_0x1779c6['id'])||_0x4fe0b3[_0x2adbca(0x2a6)](_0x1779c6['id'])),_0x1cd3f0['members'][_0x2adbca(0x40f)]<_0x2316ef&&(_0x16e98a[_0x2adbca(0x10e1)]+=_0x2316ef-_0x1cd3f0[_0x2adbca(0x5d4)][_0x2adbca(0x40f)],_0x15d0fd=!![]);}if(_0x1cd3f0[_0x2adbca(0xcb3)]?.['linkedMemoryChatIds']?.[_0x2adbca(0x40f)]>0x0){const _0x5e2f14=_0x1cd3f0['settings']['linkedMemoryChatIds']['length'];_0x1cd3f0[_0x2adbca(0xcb3)][_0x2adbca(0x4d8)]=_0x1cd3f0[_0x2adbca(0xcb3)][_0x2adbca(0x4d8)][_0x2adbca(0x156)](_0x1c1a03=>_0x2a9ec1['has'](_0x1c1a03)),_0x1cd3f0['settings'][_0x2adbca(0x4d8)][_0x2adbca(0x40f)]<_0x5e2f14&&(_0x16e98a[_0x2adbca(0xd40)]+=_0x5e2f14-_0x1cd3f0['settings'][_0x2adbca(0x4d8)][_0x2adbca(0x40f)],_0x15d0fd=!![]);}_0x15d0fd&&await _0x4e1bbf[_0x2adbca(0x999)]['put'](_0x1cd3f0);}const _0x42d50f=await _0x4e1bbf[_0x2adbca(0xaf9)][_0x2adbca(0x78f)]();for(const _0x2dce51 of _0x42d50f){let _0x3c3307=![];const _0x96f0c=_0x2dce51[_0x2adbca(0x1188)]===_0x2adbca(0xa4d)||_0x2a9ec1[_0x2adbca(0x2a6)](_0x2dce51[_0x2adbca(0x1188)])||_0x4fe0b3[_0x2adbca(0x2a6)](_0x2dce51[_0x2adbca(0x1188)]);if(!_0x96f0c){await _0x4e1bbf[_0x2adbca(0xaf9)]['delete'](_0x2dce51['id']),_0x16e98a[_0x2adbca(0xbe7)]++;continue;}if(_0x2dce51[_0x2adbca(0x940)]&&_0x2dce51[_0x2adbca(0x940)]['length']>0x0){const _0x2a5557=_0x2dce51['likes'][_0x2adbca(0x40f)];_0x2dce51[_0x2adbca(0x940)]=_0x2dce51[_0x2adbca(0x940)][_0x2adbca(0x156)](_0x2897fe=>_0x5bfee9[_0x2adbca(0x2a6)](_0x2897fe)),_0x2dce51[_0x2adbca(0x940)][_0x2adbca(0x40f)]<_0x2a5557&&(_0x16e98a[_0x2adbca(0x940)]+=_0x2a5557-_0x2dce51[_0x2adbca(0x940)][_0x2adbca(0x40f)],_0x3c3307=!![]);}if(_0x2dce51[_0x2adbca(0xff)]&&_0x2dce51[_0x2adbca(0xff)][_0x2adbca(0x40f)]>0x0){const _0x55e146=_0x2dce51['comments'][_0x2adbca(0x40f)];_0x2dce51[_0x2adbca(0xff)]=_0x2dce51[_0x2adbca(0xff)][_0x2adbca(0x156)](_0x59b745=>{const _0x2b0f5a=_0x2adbca;if(typeof _0x59b745==='object'&&_0x59b745[_0x2b0f5a(0x1335)])return _0x5bfee9[_0x2b0f5a(0x2a6)](_0x59b745['commenterName']);return!![];}),_0x2dce51[_0x2adbca(0xff)][_0x2adbca(0x40f)]<_0x55e146&&(_0x16e98a[_0x2adbca(0xff)]+=_0x55e146-_0x2dce51[_0x2adbca(0xff)][_0x2adbca(0x40f)],_0x3c3307=!![]);}_0x3c3307&&await _0x4e1bbf['qzonePosts']['put'](_0x2dce51);}await _0x4e1bbf['memories']['where'](_0x2adbca(0x367))[_0x2adbca(0x945)]([..._0x2a9ec1])[_0x2adbca(0x3aa)]()[_0x2adbca(0x102e)](_0x522355=>_0x16e98a[_0x2adbca(0x1125)]+=_0x522355),await _0x4e1bbf[_0x2adbca(0xbdb)]['where'](_0x2adbca(0x367))[_0x2adbca(0x945)]([..._0x2a9ec1])[_0x2adbca(0x3aa)]()[_0x2adbca(0x102e)](_0x342b94=>_0x16e98a[_0x2adbca(0xbdb)]+=_0x342b94);const _0x3580e3=await _0x4e1bbf[_0x2adbca(0xc93)][_0x2adbca(0x78f)]();for(const _0x4a3926 of _0x3580e3){_0x4a3926[_0x2adbca(0x367)]!==_0x2adbca(0x3fa)&&!_0x2a9ec1[_0x2adbca(0x2a6)](_0x4a3926[_0x2adbca(0x367)])&&(await _0x4e1bbf['renderingRules'][_0x2adbca(0x3aa)](_0x4a3926['id']),_0x16e98a[_0x2adbca(0xc93)]++);}});let _0x4c9677=_0x1944f1(0xfe6),_0x21ce72=![];Object[_0x1944f1(0x1052)](_0x16e98a)['forEach'](([_0x107699,_0x1a207f])=>{const _0x3e813b=_0x1944f1;if(_0x1a207f>0x0){const _0x441d26={'posts':'动态','likes':'点赞','comments':'评论','memories':'记忆','callRecords':'通话记录','renderingRules':_0x3e813b(0x1103),'groupMembers':_0x3e813b(0x126d),'chatLinks':_0x3e813b(0xa18)};_0x4c9677+='-\x20清理了\x20'+_0x1a207f+'\x20条无效的'+(_0x441d26[_0x107699]||_0x107699)+'。\x0a',_0x21ce72=!![];}});!_0x21ce72&&(_0x4c9677=_0x1944f1(0x1264));_0x4c9677+='\x0a建议刷新页面以确保所有更改生效。',await _0x28974b('操作成功',_0x4c9677);const _0x260ead=await _0x54149f(_0x1944f1(0x863),_0x1944f1(0x675));_0x260ead&&location[_0x1944f1(0x10ea)]();}catch(_0x21363f){console[_0x1944f1(0xc60)]('清理冗余数据时出错:',_0x21363f),await _0x28974b(_0x1944f1(0xa27),_0x1944f1(0xcba)+_0x21363f[_0x1944f1(0x854)]);}}async function _0x2d5b36(){const _0x2b34d7=_0x5a7792;try{const _0x560ced={'version':0x1,'timestamp':Date[_0x2b34d7(0x2b5)]()},[_0x2f28d9,_0x351591,_0x4678d5,_0x5226b0,_0x2133c8,_0x33bf49,_0x530d5d,_0x5085ed,_0x10275b,_0x51dfb5,_0x35024d,_0x3d4adc,_0xd88a79,_0x5758e8,_0x4fe4a9,_0x4ccba4,_0x123ac5,_0x2d07d7,_0x39fbf6,_0x214682,_0x296cdb,_0x3055a0,_0x1732ce,_0x324b01,_0x3a27bf]=await Promise[_0x2b34d7(0xfd7)]([_0x4e1bbf[_0x2b34d7(0x999)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x144)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0xa8b)][_0x2b34d7(0x78f)](),_0x4e1bbf['apiConfig'][_0x2b34d7(0x11fc)](_0x2b34d7(0x165)),_0x4e1bbf[_0x2b34d7(0x11b4)][_0x2b34d7(0x11fc)](_0x2b34d7(0x165)),_0x4e1bbf['personaPresets']['toArray'](),_0x4e1bbf['musicLibrary'][_0x2b34d7(0x11fc)]('main'),_0x4e1bbf[_0x2b34d7(0x3c2)][_0x2b34d7(0x11fc)](_0x2b34d7(0x165)),_0x4e1bbf['qzonePosts'][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x2d5)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x5c4)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x1232)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0xc1a)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x1125)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x10bb)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x650)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x760)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0xbdb)]['toArray'](),_0x4e1bbf['renderingRules'][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0xf1c)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0xd8d)]['toArray'](),_0x4e1bbf[_0x2b34d7(0x1032)][_0x2b34d7(0x78f)](),_0x4e1bbf[_0x2b34d7(0x19c)]['toArray'](),_0x4e1bbf[_0x2b34d7(0xf22)][_0x2b34d7(0x78f)](),_0x4e1bbf['npcs'][_0x2b34d7(0x78f)]()]);Object[_0x2b34d7(0x27d)](_0x560ced,{'chats':_0x2f28d9,'worldBooks':_0x351591,'userStickers':_0x4678d5,'apiConfig':_0x5226b0,'globalSettings':_0x2133c8,'personaPresets':_0x33bf49,'musicLibrary':_0x530d5d,'qzoneSettings':_0x5085ed,'qzonePosts':_0x10275b,'qzoneAlbums':_0x51dfb5,'qzonePhotos':_0x35024d,'favorites':_0x3d4adc,'qzoneGroups':_0xd88a79,'memories':_0x5758e8,'worldBookCategories':_0x4fe4a9,'apiPresets':_0x4ccba4,'shoppingProducts':_0x123ac5,'callRecords':_0x2d07d7,'renderingRules':_0x39fbf6,'doubanPosts':_0x214682,'stickerCategories':_0x296cdb,'appearancePresets':_0x3055a0,'presets':_0x1732ce,'presetCategories':_0x324b01,'npcs':_0x3a27bf});const _0x1c9762=new Blob([JSON[_0x2b34d7(0xe3f)](_0x560ced,null,0x2)],{'type':_0x2b34d7(0x7fe)}),_0x90a025=URL[_0x2b34d7(0xb29)](_0x1c9762),_0x4e39aa=Object['assign'](document['createElement']('a'),{'href':_0x90a025,'download':'EPhone-Full-Backup-'+new Date()[_0x2b34d7(0x5f8)]()[_0x2b34d7(0x108c)]('T')[0x0]+_0x2b34d7(0xec)});_0x4e39aa[_0x2b34d7(0x1080)](),URL[_0x2b34d7(0x74f)](_0x90a025),await _0x28974b('导出成功',_0x2b34d7(0x2cd));}catch(_0x1f05d9){console['error'](_0x2b34d7(0x75b),_0x1f05d9),await _0x28974b(_0x2b34d7(0xf17),_0x2b34d7(0xcba)+_0x1f05d9['message']);}}async function _0x438f0d(_0x2f7a70){const _0xaf5dec=_0x5a7792;try{await _0x4e1bbf['transaction']('rw',_0x4e1bbf[_0xaf5dec(0x1a2)],async()=>{const _0x3f6cc1=_0xaf5dec;for(const _0x4556cf of _0x4e1bbf[_0x3f6cc1(0x1a2)]){await _0x4556cf['clear']();}for(const _0x480395 in _0x2f7a70){Array[_0x3f6cc1(0x97e)](_0x2f7a70[_0x480395])&&(console[_0x3f6cc1(0x1081)](_0x3f6cc1(0x23f)+_0x480395+',\x20记录数:\x20'+_0x2f7a70[_0x480395][_0x3f6cc1(0x40f)]),await _0x4e1bbf[_0x3f6cc1(0x13ac)](_0x480395)['bulkPut'](_0x2f7a70[_0x480395]));}});}catch(_0x4b0431){throw new Error(_0xaf5dec(0x12b)+_0x4b0431['message']);}}async function _0x11afde(_0x33785c){const _0x21c969=_0x5a7792;if(!_0x33785c)return;const _0x38ce3c=await _0x54149f(_0x21c969(0xf68),_0x21c969(0x114a),{'confirmButtonClass':_0x21c969(0xeed)});if(!_0x38ce3c)return;await _0x28974b(_0x21c969(0x2f7),'正在读取并解析备份文件...');try{const _0x15af4c=await _0x33785c[_0x21c969(0x673)](),_0xac4cd6=JSON[_0x21c969(0x1214)](_0x15af4c);if(_0xac4cd6[_0x21c969(0x88a)]&&typeof _0xac4cd6['data']===_0x21c969(0x59a)&&_0xac4cd6[_0x21c969(0x88a)]['chats'])console[_0x21c969(0x1081)](_0x21c969(0x1022)),await _0x438f0d(_0xac4cd6[_0x21c969(0x88a)]);else{if(_0xac4cd6[_0x21c969(0x999)])console[_0x21c969(0x1081)](_0x21c969(0x1279)),await _0x4d5b2b(_0xac4cd6);else throw new Error(_0x21c969(0x459));}await _0x28974b(_0x21c969(0x583),_0x21c969(0x64a)),setTimeout(()=>{const _0x292f56=_0x21c969;window[_0x292f56(0x6bd)][_0x292f56(0x10ea)]();},0x5dc);}catch(_0x5de70b){console[_0x21c969(0xc60)]('导入数据时出错:',_0x5de70b),await _0x28974b(_0x21c969(0xae3),_0x21c969(0xde)+_0x5de70b[_0x21c969(0x854)]);}}async function _0x4d5b2b(_0x4e5026){const _0x27078a=_0x5a7792;try{await _0x4e1bbf['transaction']('rw',_0x4e1bbf[_0x27078a(0x1a2)],async()=>{const _0x28718f=_0x27078a;await _0x4e1bbf[_0x28718f(0x999)][_0x28718f(0x1057)](),await _0x4e1bbf[_0x28718f(0x144)][_0x28718f(0x1057)]();for(const _0x4ca98d of _0x4e1bbf['tables']){await _0x4ca98d['clear']();}if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0x999)]))await _0x4e1bbf['chats'][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0x999)]);if(Array['isArray'](_0x4e5026[_0x28718f(0x144)]))await _0x4e1bbf[_0x28718f(0x144)][_0x28718f(0x1281)](_0x4e5026['worldBooks']);if(Array['isArray'](_0x4e5026['userStickers']))await _0x4e1bbf[_0x28718f(0xa8b)][_0x28718f(0x1281)](_0x4e5026['userStickers']);if(_0x4e5026[_0x28718f(0xec0)])await _0x4e1bbf[_0x28718f(0xec0)]['put'](_0x4e5026[_0x28718f(0xec0)]);if(_0x4e5026[_0x28718f(0x11b4)])await _0x4e1bbf[_0x28718f(0x11b4)][_0x28718f(0x4fa)](_0x4e5026['globalSettings']);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0x5ca)]))await _0x4e1bbf[_0x28718f(0x5ca)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0x5ca)]);if(_0x4e5026[_0x28718f(0x5c0)])await _0x4e1bbf[_0x28718f(0x5c0)][_0x28718f(0x4fa)](_0x4e5026[_0x28718f(0x5c0)]);if(_0x4e5026['qzoneSettings'])await _0x4e1bbf['qzoneSettings'][_0x28718f(0x4fa)](_0x4e5026[_0x28718f(0x3c2)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xaf9)]))await _0x4e1bbf[_0x28718f(0xaf9)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0xaf9)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0x2d5)]))await _0x4e1bbf[_0x28718f(0x2d5)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0x2d5)]);if(Array[_0x28718f(0x97e)](_0x4e5026['qzonePhotos']))await _0x4e1bbf[_0x28718f(0x5c4)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0x5c4)]);if(Array[_0x28718f(0x97e)](_0x4e5026['favorites']))await _0x4e1bbf[_0x28718f(0x1232)]['bulkPut'](_0x4e5026[_0x28718f(0x1232)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xc1a)]))await _0x4e1bbf[_0x28718f(0xc1a)][_0x28718f(0x1281)](_0x4e5026['qzoneGroups']);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0x1125)]))await _0x4e1bbf['memories'][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0x1125)]);if(Array['isArray'](_0x4e5026['worldBookCategories']))await _0x4e1bbf[_0x28718f(0x10bb)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0x10bb)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0x650)]))await _0x4e1bbf['apiPresets'][_0x28718f(0x1281)](_0x4e5026['apiPresets']);if(Array['isArray'](_0x4e5026[_0x28718f(0x760)]))await _0x4e1bbf['shoppingProducts']['bulkPut'](_0x4e5026['shoppingProducts']);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xbdb)]))await _0x4e1bbf[_0x28718f(0xbdb)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0xbdb)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xc93)]))await _0x4e1bbf[_0x28718f(0xc93)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0xc93)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xf1c)]))await _0x4e1bbf[_0x28718f(0xf1c)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0xf1c)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xd8d)]))await _0x4e1bbf[_0x28718f(0xd8d)]['bulkPut'](_0x4e5026[_0x28718f(0xd8d)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0x1032)]))await _0x4e1bbf[_0x28718f(0x1032)]['bulkPut'](_0x4e5026[_0x28718f(0x1032)]);if(Array[_0x28718f(0x97e)](_0x4e5026['presets']))await _0x4e1bbf[_0x28718f(0x19c)][_0x28718f(0x1281)](_0x4e5026['presets']);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xf22)]))await _0x4e1bbf['presetCategories']['bulkPut'](_0x4e5026[_0x28718f(0xf22)]);if(Array[_0x28718f(0x97e)](_0x4e5026[_0x28718f(0xad7)]))await _0x4e1bbf[_0x28718f(0xad7)][_0x28718f(0x1281)](_0x4e5026[_0x28718f(0xad7)]);});}catch(_0x202682){throw new Error('旧版备份数据写入数据库失败:\x20'+_0x202682[_0x27078a(0x854)]);}}function _0x397027(_0x45ff06,_0x4f2048=![]){const _0x4672ff=_0x5a7792;if(!_0x45ff06){_0x3436fb[_0x4672ff(0xc58)]='',document[_0x4672ff(0x64f)](_0x4672ff(0x42a))[_0x4672ff(0x731)][_0x4672ff(0x245)]='';return;}const _0x2658bf=_0x4672ff(0xa5f),_0x352763='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x2658bf+_0x4672ff(0x11a8)+_0x45ff06+_0x4672ff(0x135a);if(_0x4f2048){const _0x31c80c=document[_0x4672ff(0x64f)](_0x4672ff(0xb20))||document['createElement'](_0x4672ff(0x731));_0x31c80c['id']=_0x4672ff(0xb20),_0x31c80c[_0x4672ff(0xc58)]=_0x352763;if(!document['getElementById']('preview-font-style'))document[_0x4672ff(0x798)]['appendChild'](_0x31c80c);document[_0x4672ff(0x64f)](_0x4672ff(0x42a))[_0x4672ff(0x731)][_0x4672ff(0x245)]='\x27'+_0x2658bf+_0x4672ff(0xa73);}else _0x3436fb[_0x4672ff(0xc58)]=_0x4672ff(0xea8)+_0x352763+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20body\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27'+_0x2658bf+'\x27,\x20\x27bulangni\x27,\x20-apple-system,\x20BlinkMacSystemFont,\x20\x22Segoe\x20UI\x22,\x20Roboto,\x20Helvetica,\x20Arial,\x20sans-serif;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}';}async function _0x128bda(){const _0x322d5d=_0x5a7792;_0x3436fb[_0x322d5d(0xc58)]='',_0x3e7a1b['globalSettings']['fontUrl']='',await _0x4e1bbf[_0x322d5d(0x11b4)][_0x322d5d(0x4fa)](_0x3e7a1b[_0x322d5d(0x11b4)]),document[_0x322d5d(0x64f)]('font-url-input')['value']='',document[_0x322d5d(0x64f)](_0x322d5d(0x42a))[_0x322d5d(0x731)][_0x322d5d(0x245)]='',alert('已恢复默认字体。');}async function _0x519e87(){const _0x3f8e4d=_0x5a7792,[_0x1a04aa,_0x60c8e1,_0x2b53c0,_0x3d521d,_0x564ec6,_0x5382ea,_0xb3a7c5,_0x4a5cd8,_0x3d97da,_0x148e8d,_0x1e1131]=await Promise['all']([_0x4e1bbf['chats'][_0x3f8e4d(0x78f)](),_0x4e1bbf[_0x3f8e4d(0xec0)][_0x3f8e4d(0x11fc)](_0x3f8e4d(0x165)),_0x4e1bbf[_0x3f8e4d(0x11b4)][_0x3f8e4d(0x11fc)](_0x3f8e4d(0x165)),_0x4e1bbf[_0x3f8e4d(0xa8b)]['toArray'](),_0x4e1bbf[_0x3f8e4d(0x144)]['toArray'](),_0x4e1bbf[_0x3f8e4d(0x5c0)]['get'](_0x3f8e4d(0x165)),_0x4e1bbf[_0x3f8e4d(0x5ca)][_0x3f8e4d(0x78f)](),_0x4e1bbf['qzoneSettings'][_0x3f8e4d(0x11fc)](_0x3f8e4d(0x165)),_0x4e1bbf[_0x3f8e4d(0x1232)]['orderBy'](_0x3f8e4d(0x8af))[_0x3f8e4d(0x2f4)]()[_0x3f8e4d(0x78f)](),_0x4e1bbf[_0x3f8e4d(0x1125)][_0x3f8e4d(0x78f)](),_0x4e1bbf[_0x3f8e4d(0x19c)][_0x3f8e4d(0x78f)]()]);_0x3e7a1b[_0x3f8e4d(0x19c)]=_0x1e1131||[];const _0x53cd79={'id':_0x3f8e4d(0x165),'showStatusBar':![],'wallpaper':_0x3f8e4d(0x991),'fontUrl':'','enableBackgroundActivity':![],'backgroundActivityInterval':0x3c,'blockCooldownHours':0x1,'apiTemperature':0.8,'appIcons':{..._0x8188ba},'cphoneWallpaper':_0x3f8e4d(0xb03),'cphoneAppIcons':{..._0xca148b},'globalCss':'','notificationSoundUrl':'','widgetData':{},'globalChatBackground':'','enableAiDrawing':!![],'chatActionButtonsOrder':null,'shoppingCategoryCount':0x3,'shoppingProductCount':0x8,'chatRenderWindow':0x32};_0x3e7a1b[_0x3f8e4d(0x11b4)]={..._0x53cd79,..._0x2b53c0||{}},_0x3e7a1b['globalSettings'][_0x3f8e4d(0xdaa)]={..._0x53cd79[_0x3f8e4d(0xdaa)],..._0x3e7a1b[_0x3f8e4d(0x11b4)][_0x3f8e4d(0xdaa)]||{}},_0x3e7a1b[_0x3f8e4d(0x11b4)][_0x3f8e4d(0x328)]={..._0x53cd79[_0x3f8e4d(0x328)],..._0x3e7a1b[_0x3f8e4d(0x11b4)][_0x3f8e4d(0x328)]||{}},_0x1a04aa[_0x3f8e4d(0x103)](_0x2b118e=>{const _0x52e42a=_0x3f8e4d;typeof _0x2b118e[_0x52e42a(0xcb3)][_0x52e42a(0x35f)]===_0x52e42a(0x3a3)&&(_0x2b118e[_0x52e42a(0xcb3)][_0x52e42a(0x35f)]=!![]),!_0x2b118e[_0x52e42a(0xcb3)][_0x52e42a(0x96b)]&&(_0x2b118e['settings']['lyricsPosition']={'vertical':_0x52e42a(0x4ed),'horizontal':_0x52e42a(0x7bd),'offset':0xa}),!_0x2b118e[_0x52e42a(0x1167)]&&!_0x2b118e[_0x52e42a(0xcb3)][_0x52e42a(0x83a)]&&(_0x2b118e[_0x52e42a(0xcb3)][_0x52e42a(0x83a)]=[]),!_0x2b118e['isGroup']&&typeof _0x2b118e[_0x52e42a(0x7de)]==='undefined'&&(_0x2b118e['originalName']=_0x2b118e['name']);}),_0x3e7a1b[_0x3f8e4d(0x999)]=_0x1a04aa[_0x3f8e4d(0x213)]((_0x589bf5,_0x547ed5)=>{const _0x3f4a68=_0x3f8e4d;if(typeof _0x547ed5[_0x3f4a68(0x13c0)]==='undefined')_0x547ed5['unreadCount']=0x0;_0x547ed5[_0x3f4a68(0x1167)]&&(typeof _0x547ed5[_0x3f4a68(0xcb3)]['enableBackgroundActivity']===_0x3f4a68(0x3a3)&&(_0x547ed5['settings'][_0x3f4a68(0x11c3)]=!![]),_0x547ed5[_0x3f4a68(0x5d4)]&&_0x547ed5['members'][_0x3f4a68(0x40f)]>0x0&&_0x547ed5[_0x3f4a68(0x5d4)][0x0][_0x3f4a68(0x6fc)]&&_0x547ed5['members']['forEach'](_0x29e667=>{const _0x14786f=_0x3f4a68;typeof _0x29e667[_0x14786f(0x7de)]===_0x14786f(0x3a3)&&(_0x29e667[_0x14786f(0x7de)]=_0x29e667['name'],_0x29e667['groupNickname']=_0x29e667[_0x14786f(0x6fc)],delete _0x29e667['name']);}));if(!_0x547ed5[_0x3f4a68(0xcb3)])_0x547ed5[_0x3f4a68(0xcb3)]={};typeof _0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x963)]===_0x3f4a68(0x3a3)&&(_0x547ed5['settings']['actionCooldownMinutes']=0xa);if(!_0x547ed5[_0x3f4a68(0x1167)]&&!_0x547ed5[_0x3f4a68(0x69e)])_0x547ed5[_0x3f4a68(0x69e)]={'text':'在线','lastUpdate':Date[_0x3f4a68(0x2b5)](),'isBusy':![]};if(!_0x547ed5[_0x3f4a68(0x1167)]&&!_0x547ed5[_0x3f4a68(0x55f)])_0x547ed5[_0x3f4a68(0x55f)]={'status':_0x3f4a68(0xfdd),'blockedTimestamp':null,'applicationReason':''};if(!_0x547ed5[_0x3f4a68(0x1167)]&&(!_0x547ed5[_0x3f4a68(0xcb3)]||!_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1163)])){if(!_0x547ed5[_0x3f4a68(0xcb3)])_0x547ed5[_0x3f4a68(0xcb3)]={};_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1163)]=[];}_0x547ed5['isGroup']&&(_0x547ed5[_0x3f4a68(0x5d4)]||[])[_0x3f4a68(0x103)](_0x38fa17=>{const _0x2c11f6=_0x3f4a68;if(typeof _0x38fa17[_0x2c11f6(0xc82)]===_0x2c11f6(0x3a3))_0x38fa17[_0x2c11f6(0xc82)]='';});if(!_0x547ed5['musicData'])_0x547ed5['musicData']={'totalTime':0x0};_0x547ed5[_0x3f4a68(0xcb3)]&&_0x547ed5['settings']['linkedWorldBookId']&&!_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0xde4)]&&(_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0xde4)]=[_0x547ed5['settings']['linkedWorldBookId']],delete _0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1339)]);if(typeof _0x547ed5['isPinned']===_0x3f4a68(0x3a3))_0x547ed5['isPinned']=![];!_0x547ed5[_0x3f4a68(0x1167)]&&typeof _0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x96f)]===_0x3f4a68(0x3a3)&&(_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x96f)]='我');if(_0x547ed5['isGroup']&&_0x547ed5[_0x3f4a68(0x5d4)]){let _0x192d04=![];_0x1a04aa[_0x3f4a68(0x103)](_0xfcab5b=>{const _0x65c4a2=_0x3f4a68;_0xfcab5b['id']===_0x547ed5['id']&&_0xfcab5b['originalName']&&delete _0xfcab5b[_0x65c4a2(0x7de)];}),_0x547ed5['members'][_0x3f4a68(0x103)](_0x38ff02=>{const _0x506e70=_0x3f4a68,_0x514ff8=_0x1a04aa['find'](_0x36ad05=>_0x36ad05['id']===_0x38ff02['id']);if(_0x514ff8&&_0x514ff8[_0x506e70(0xcb3)]){const _0x43b074=_0x514ff8[_0x506e70(0xcb3)][_0x506e70(0xeba)]||'';_0x38ff02[_0x506e70(0xc82)]!==_0x43b074&&(_0x38ff02[_0x506e70(0xc82)]=_0x43b074,_0x192d04=!![]);}else typeof _0x38ff02['avatarFrame']===_0x506e70(0x3a3)&&(_0x38ff02[_0x506e70(0xc82)]='',_0x192d04=!![]);});if(_0x192d04)_0x4e1bbf[_0x3f4a68(0x999)]['put'](_0x547ed5);}if(!_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1141)])_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1141)]=![];if(!_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x10e2)])_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x10e2)]=0x14;if(!_0x547ed5[_0x3f4a68(0x518)])_0x547ed5['longTermMemory']=[];if(!_0x547ed5[_0x3f4a68(0xefe)])_0x547ed5[_0x3f4a68(0xefe)]=0x0;if(!_0x547ed5['isGroup']){typeof _0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x11c3)]===_0x3f4a68(0x3a3)&&(_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x11c3)]=!![]);typeof _0x547ed5[_0x3f4a68(0xcb3)]['enableTts']===_0x3f4a68(0x3a3)&&(_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x112)]=![]);if(!_0x547ed5['status'])_0x547ed5[_0x3f4a68(0x69e)]={'text':'在线','lastUpdate':Date[_0x3f4a68(0x2b5)](),'isBusy':![]};if(!_0x547ed5[_0x3f4a68(0x55f)])_0x547ed5['relationship']={'status':_0x3f4a68(0xfdd),'blockedTimestamp':null,'applicationReason':''};if(!_0x547ed5[_0x3f4a68(0xcb3)]||!_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1163)]){if(!_0x547ed5[_0x3f4a68(0xcb3)])_0x547ed5[_0x3f4a68(0xcb3)]={};_0x547ed5[_0x3f4a68(0xcb3)]['aiAvatarLibrary']=[];}if(typeof _0x547ed5['settings']['isOfflineMode']===_0x3f4a68(0x3a3))_0x547ed5[_0x3f4a68(0xcb3)]['isOfflineMode']=![];if(typeof _0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x414)]===_0x3f4a68(0x3a3))_0x547ed5['settings']['offlineMinLength']=0x64;if(typeof _0x547ed5[_0x3f4a68(0xcb3)]['offlineMaxLength']===_0x3f4a68(0x3a3))_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x253)]=0x12c;typeof _0x547ed5[_0x3f4a68(0xcb3)]['injectLatestThought']===_0x3f4a68(0x3a3)&&(_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x117f)]=![]);if(typeof _0x547ed5[_0x3f4a68(0x12d9)]===_0x3f4a68(0x3a3))_0x547ed5['heartfeltVoice']=_0x3f4a68(0x3cd);if(typeof _0x547ed5[_0x3f4a68(0xb9d)]==='undefined')_0x547ed5[_0x3f4a68(0xb9d)]=_0x3f4a68(0x3cd);!Array['isArray'](_0x547ed5['thoughtsHistory'])&&(_0x547ed5['thoughtsHistory']=[]);}return typeof _0x547ed5[_0x3f4a68(0xcb3)]['stickerCategoryIds']===_0x3f4a68(0x3a3)&&(_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1ff)]?_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x15d)]=[_0x547ed5[_0x3f4a68(0xcb3)][_0x3f4a68(0x1ff)]]:_0x547ed5['settings'][_0x3f4a68(0x15d)]=[],delete _0x547ed5[_0x3f4a68(0xcb3)]['stickerCategoryId']),_0x589bf5[_0x547ed5['id']]=_0x547ed5,_0x589bf5;},{});const _0x2bc290=[];_0x148e8d[_0x3f8e4d(0x103)](_0x202365=>{const _0x2552db=_0x3f8e4d;if(_0x202365[_0x2552db(0xafc)]===_0x2552db(0x814)&&_0x202365['authorName']&&!_0x202365[_0x2552db(0x1188)]){const _0x5dab46=_0x1a04aa[_0x2552db(0x137)](_0x5f274a=>!_0x5f274a[_0x2552db(0x1167)]&&_0x5f274a['originalName']===_0x202365[_0x2552db(0x5b7)]);if(_0x5dab46)_0x202365[_0x2552db(0x1188)]=_0x5dab46['id'],_0x2bc290[_0x2552db(0x13ee)](_0x202365);else{const _0x278ea7=_0x1a04aa[_0x2552db(0x137)](_0x1382ca=>!_0x1382ca[_0x2552db(0x1167)]&&_0x1382ca['name']===_0x202365[_0x2552db(0x5b7)]);_0x278ea7&&(_0x202365[_0x2552db(0x1188)]=_0x278ea7['id'],_0x2bc290[_0x2552db(0x13ee)](_0x202365));}}}),_0x2bc290['length']>0x0&&await _0x4e1bbf[_0x3f8e4d(0x1125)][_0x3f8e4d(0x1281)](_0x2bc290),_0x3e7a1b[_0x3f8e4d(0xec0)]=_0x60c8e1||{'id':_0x3f8e4d(0x165),'proxyUrl':'','apiKey':'','model':'','secondaryProxyUrl':'','secondaryApiKey':'','secondaryModel':'','minimaxGroupId':'','minimaxApiKey':'','minimaxModel':_0x3f8e4d(0x2a4)},_0x3e7a1b[_0x3f8e4d(0xa8b)]=_0x3d521d||[],_0x3e7a1b[_0x3f8e4d(0x144)]=_0x564ec6||[],_0x1c083c[_0x3f8e4d(0x11ce)]=_0x5382ea?.[_0x3f8e4d(0x11ce)]||[],_0x3e7a1b[_0x3f8e4d(0x5ca)]=_0xb3a7c5||[],_0x3e7a1b[_0x3f8e4d(0x3c2)]=_0x4a5cd8||{'id':_0x3f8e4d(0x165),'nickname':_0x3f8e4d(0x1028),'avatar':_0x3f8e4d(0x974),'banner':_0x3f8e4d(0xd61)},allFavoriteItems=_0x3d97da||[];}async function _0x16961a(){const _0xe71c20=_0x5a7792;await _0x4e1bbf[_0xe71c20(0x5c0)][_0xe71c20(0x4fa)]({'id':_0xe71c20(0x165),'playlist':_0x1c083c[_0xe71c20(0x11ce)]});}function _0x56b0f0(_0x1d3ec3){const _0x27ba85=_0x5a7792;if(!_0x1d3ec3)return'';const _0x3bab35=new Date(_0x1d3ec3),_0xb8f255=String(_0x3bab35['getHours']())[_0x27ba85(0xf2)](0x2,'0'),_0x3e1e63=String(_0x3bab35[_0x27ba85(0x14f)]())[_0x27ba85(0xf2)](0x2,'0');return _0xb8f255+':'+_0x3e1e63;}function _0x4942eb(_0x1166f0){const _0xdb8689=_0x5a7792,_0x4150b5=Date[_0xdb8689(0x2b5)](),_0x46d0be=Math[_0xdb8689(0x1245)]((_0x4150b5-_0x1166f0)/0x3e8);if(_0x46d0be<0x3c)return'刚刚';const _0xb432a2=Math[_0xdb8689(0x1245)](_0x46d0be/0x3c);if(_0xb432a2<0x3c)return _0xb432a2+_0xdb8689(0x128);const _0x10c33c=Math[_0xdb8689(0x1245)](_0xb432a2/0x3c);if(_0x10c33c<0x18)return _0x10c33c+_0xdb8689(0x9ee);const _0x1857d7=Math[_0xdb8689(0x1245)](_0x10c33c/0x18);if(_0x1857d7<0x1e)return _0x1857d7+'天前';const _0x1c2883=Math[_0xdb8689(0x1245)](_0x1857d7/0x1e);if(_0x1c2883<0xc)return'大约'+_0x1c2883+_0xdb8689(0x1030);const _0x10f110=Math[_0xdb8689(0x1245)](_0x1857d7/0x16d);return'大约'+_0x10f110+'年前';}function _0x36c3b5(_0x52a7e9){const _0x38f346=_0x5a7792;if(!_0x52a7e9)return'';const _0x2a3f9c=new Date(),_0x1d6ad9=new Date(_0x52a7e9),_0x3d6908=String(_0x1d6ad9['getHours']())[_0x38f346(0xf2)](0x2,'0'),_0x5b2265=String(_0x1d6ad9[_0x38f346(0x14f)]())[_0x38f346(0xf2)](0x2,'0'),_0x9fcb5=_0x3d6908+':'+_0x5b2265;if(_0x2a3f9c[_0x38f346(0x859)]()===_0x1d6ad9['toDateString']())return _0x38f346(0x1ac)+_0x9fcb5;const _0x53d12d=new Date();_0x53d12d[_0x38f346(0x42b)](_0x2a3f9c[_0x38f346(0x12e)]()-0x1);if(_0x53d12d[_0x38f346(0x859)]()===_0x1d6ad9['toDateString']())return'昨天\x20'+_0x9fcb5;if(_0x2a3f9c[_0x38f346(0xf87)]()===_0x1d6ad9[_0x38f346(0xf87)]()){const _0x1c413c=String(_0x1d6ad9[_0x38f346(0x38b)]()+0x1),_0x1277dd=String(_0x1d6ad9[_0x38f346(0x12e)]());return _0x1c413c+'月'+_0x1277dd+'日\x20'+_0x9fcb5;}const _0x80b7d0=_0x1d6ad9[_0x38f346(0xf87)](),_0x3fc911=String(_0x1d6ad9[_0x38f346(0x38b)]()+0x1),_0x5e1b16=String(_0x1d6ad9[_0x38f346(0x12e)]());return _0x80b7d0+'年'+_0x3fc911+'月'+_0x5e1b16+'日\x20'+_0x9fcb5;}function _0x3fe515(){const _0x3021f3=_0x5a7792,_0x33e253=_0x4c8f8e();document['getElementById'](_0x3021f3(0x440))['value']=_0x33e253['resolution'],document['getElementById'](_0x3021f3(0xb5c))[_0x3021f3(0xbed)]=_0x33e253[_0x3021f3(0x10df)],document[_0x3021f3(0x64f)]('nai-cfg-scale')[_0x3021f3(0xbed)]=_0x33e253['cfg_scale'],document['getElementById'](_0x3021f3(0x28c))[_0x3021f3(0xbed)]=_0x33e253[_0x3021f3(0xcf3)],document[_0x3021f3(0x64f)](_0x3021f3(0x1367))[_0x3021f3(0xbed)]=_0x33e253['seed'],document['getElementById'](_0x3021f3(0xf27))[_0x3021f3(0xbed)]=_0x33e253['uc_preset'],document['getElementById']('nai-quality-toggle')[_0x3021f3(0xf1d)]=_0x33e253['quality_toggle'],document[_0x3021f3(0x64f)]('nai-smea')[_0x3021f3(0xf1d)]=_0x33e253[_0x3021f3(0x787)],document['getElementById'](_0x3021f3(0x55b))[_0x3021f3(0xf1d)]=_0x33e253[_0x3021f3(0xe4b)],document[_0x3021f3(0x64f)](_0x3021f3(0x888))[_0x3021f3(0xbed)]=_0x33e253[_0x3021f3(0x12d0)],document[_0x3021f3(0x64f)](_0x3021f3(0xbc3))['value']=_0x33e253[_0x3021f3(0x124d)],document['getElementById'](_0x3021f3(0x4da))[_0x3021f3(0xbed)]=_0x33e253[_0x3021f3(0x7b9)],document[_0x3021f3(0x64f)]('nai-custom-proxy-url')[_0x3021f3(0xbed)]=_0x33e253[_0x3021f3(0x5c3)]||'';const _0x3e2041=document[_0x3021f3(0x64f)](_0x3021f3(0x1099));_0x3e2041[_0x3021f3(0x731)][_0x3021f3(0x130)]=_0x33e253[_0x3021f3(0x7b9)]===_0x3021f3(0xea0)?_0x3021f3(0xb37):'none';}function _0x3593e9(){const _0x2b1625=_0x5a7792,_0x3edc5b=document[_0x2b1625(0x64f)](_0x2b1625(0xf9c))[_0x2b1625(0xf1d)],_0x3c9459=document['getElementById'](_0x2b1625(0xa21))['value'],_0x4f2ddb=document['getElementById'](_0x2b1625(0x427))[_0x2b1625(0xbed)][_0x2b1625(0x43a)]();localStorage[_0x2b1625(0xd39)](_0x2b1625(0x13aa),_0x3edc5b),localStorage[_0x2b1625(0xd39)]('novelai-model',_0x3c9459),localStorage[_0x2b1625(0xd39)](_0x2b1625(0x427),_0x4f2ddb);const _0x31ffcd={'resolution':document[_0x2b1625(0x64f)](_0x2b1625(0x440))[_0x2b1625(0xbed)],'steps':parseInt(document[_0x2b1625(0x64f)](_0x2b1625(0xb5c))['value']),'cfg_scale':parseFloat(document[_0x2b1625(0x64f)](_0x2b1625(0x1140))[_0x2b1625(0xbed)]),'sampler':document['getElementById'](_0x2b1625(0x28c))[_0x2b1625(0xbed)],'seed':parseInt(document['getElementById'](_0x2b1625(0x1367))['value']),'uc_preset':parseInt(document[_0x2b1625(0x64f)](_0x2b1625(0xf27))[_0x2b1625(0xbed)]),'quality_toggle':document[_0x2b1625(0x64f)](_0x2b1625(0x430))[_0x2b1625(0xf1d)],'smea':document[_0x2b1625(0x64f)](_0x2b1625(0x3e3))[_0x2b1625(0xf1d)],'smea_dyn':document[_0x2b1625(0x64f)](_0x2b1625(0x55b))[_0x2b1625(0xf1d)],'default_positive':document['getElementById'](_0x2b1625(0x888))[_0x2b1625(0xbed)],'default_negative':document[_0x2b1625(0x64f)](_0x2b1625(0xbc3))[_0x2b1625(0xbed)],'cors_proxy':document[_0x2b1625(0x64f)](_0x2b1625(0x4da))['value'],'custom_proxy_url':document[_0x2b1625(0x64f)](_0x2b1625(0xf12))[_0x2b1625(0xbed)]};localStorage[_0x2b1625(0xd39)]('novelai-settings',JSON['stringify'](_0x31ffcd));}function _0x34a2e3(){const _0x5a61fc=_0x5a7792;localStorage[_0x5a61fc(0x8b7)]('novelai-settings'),_0x3fe515(),alert(_0x5a61fc(0x81c));}function _0x4c8f8e(){const _0x3e95ad=_0x5a7792,_0x5c4375={'resolution':_0x3e95ad(0x574),'steps':0x1c,'cfg_scale':0x5,'sampler':'k_euler_ancestral','seed':-0x1,'uc_preset':0x1,'quality_toggle':!![],'smea':!![],'smea_dyn':![],'default_positive':'masterpiece,\x20best\x20quality,\x201girl,\x20beautiful,\x20detailed\x20face,\x20detailed\x20eyes,\x20long\x20hair,\x20anime\x20style','default_negative':_0x3e95ad(0xcc8),'cors_proxy':_0x3e95ad(0x64c),'custom_proxy_url':''},_0x43c52d=localStorage[_0x3e95ad(0x2f5)]('novelai-settings');if(_0x43c52d)try{return{..._0x5c4375,...JSON[_0x3e95ad(0x1214)](_0x43c52d)};}catch(_0x158e34){return _0x5c4375;}return _0x5c4375;}function _0x2579ab(_0x4ab08e){const _0x13dda5=_0x5a7792,_0x5ec787=_0x4c8f8e();if(!_0x4ab08e||!_0x3e7a1b[_0x13dda5(0x999)][_0x4ab08e])return console[_0x13dda5(0x1081)](_0x13dda5(0x1009)),{'positive':_0x5ec787[_0x13dda5(0x12d0)],'negative':_0x5ec787[_0x13dda5(0x124d)],'source':'system'};const _0x4f7692=_0x3e7a1b[_0x13dda5(0x999)][_0x4ab08e],_0x34c8a2=_0x4f7692[_0x13dda5(0xcb3)][_0x13dda5(0x765)]||{};return _0x34c8a2[_0x13dda5(0x873)]===_0x13dda5(0x186)?(console[_0x13dda5(0x1081)](_0x13dda5(0x1199)),console['log'](_0x13dda5(0x1cd),_0x34c8a2[_0x13dda5(0x1bc)]||_0x13dda5(0xe7f)),console[_0x13dda5(0x1081)](_0x13dda5(0x11af),_0x34c8a2[_0x13dda5(0xbf5)]||_0x13dda5(0xe7f)),{'positive':_0x34c8a2[_0x13dda5(0x1bc)]||'','negative':_0x34c8a2['characterNegativePrompt']||'','source':_0x13dda5(0x186)}):(console[_0x13dda5(0x1081)](_0x13dda5(0x606)),console[_0x13dda5(0x1081)](_0x13dda5(0x1cd),_0x5ec787['default_positive']||_0x13dda5(0xe7f)),console[_0x13dda5(0x1081)](_0x13dda5(0x11af),_0x5ec787[_0x13dda5(0x124d)]||_0x13dda5(0xe7f)),{'positive':_0x5ec787['default_positive'],'negative':_0x5ec787[_0x13dda5(0x124d)],'source':_0x13dda5(0x905)});}async function _0x13d0f6(){const _0x3db32f=_0x5a7792,_0x39e608=document['getElementById'](_0x3db32f(0x427))['value'][_0x3db32f(0x43a)](),_0x560a5=document[_0x3db32f(0x64f)]('novelai-model')['value'],_0x4abb6a=document[_0x3db32f(0x64f)](_0x3db32f(0x616))[_0x3db32f(0xbed)]['trim']();if(!_0x39e608){alert(_0x3db32f(0x11ba));return;}if(!_0x4abb6a){alert(_0x3db32f(0x11b3));return;}const _0x45dd52=_0x4c8f8e(),_0x5d9792=document['getElementById']('nai-test-negative')[_0x3db32f(0xbed)]['trim'](),_0x2684da=document[_0x3db32f(0x64f)](_0x3db32f(0x792)),_0x2b348b=document[_0x3db32f(0x64f)]('nai-test-result'),_0x86f4c3=document[_0x3db32f(0x64f)](_0x3db32f(0x688)),_0x14e1b8=document[_0x3db32f(0x64f)](_0x3db32f(0x12e6));_0x2684da[_0x3db32f(0x731)][_0x3db32f(0x130)]='block',_0x2b348b[_0x3db32f(0x731)][_0x3db32f(0x130)]=_0x3db32f(0x1209),_0x86f4c3['style'][_0x3db32f(0x130)]=_0x3db32f(0x1209),_0x14e1b8[_0x3db32f(0x1b0)]=!![],_0x14e1b8['textContent']=_0x3db32f(0x2ec);try{const [_0xd33f39,_0x45b297]=_0x45dd52['resolution']['split']('x')['map'](Number);let _0x33bc83;_0x560a5['includes'](_0x3db32f(0xcef))?_0x33bc83={'input':_0x4abb6a,'model':_0x560a5,'action':_0x3db32f(0x8e1),'parameters':{'params_version':0x3,'width':_0xd33f39,'height':_0x45b297,'scale':_0x45dd52[_0x3db32f(0x11cf)],'sampler':_0x45dd52[_0x3db32f(0xcf3)],'steps':_0x45dd52['steps'],'seed':_0x45dd52[_0x3db32f(0xf48)]===-0x1?Math[_0x3db32f(0x1245)](Math['random']()*0x2540be3ff):_0x45dd52[_0x3db32f(0xf48)],'n_samples':0x1,'ucPreset':_0x45dd52[_0x3db32f(0xf13)],'qualityToggle':_0x45dd52['quality_toggle'],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x3db32f(0x1298),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x4abb6a,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x5d9792,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x5d9792,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x33bc83={'input':_0x4abb6a,'model':_0x560a5,'action':'generate','parameters':{'width':_0xd33f39,'height':_0x45b297,'scale':_0x45dd52['cfg_scale'],'sampler':_0x45dd52[_0x3db32f(0xcf3)],'steps':_0x45dd52[_0x3db32f(0x10df)],'seed':_0x45dd52[_0x3db32f(0xf48)]===-0x1?Math[_0x3db32f(0x1245)](Math['random']()*0x2540be3ff):_0x45dd52[_0x3db32f(0xf48)],'n_samples':0x1,'ucPreset':_0x45dd52[_0x3db32f(0xf13)],'qualityToggle':_0x45dd52[_0x3db32f(0x1065)],'sm':_0x45dd52[_0x3db32f(0x787)],'sm_dyn':_0x45dd52[_0x3db32f(0xe4b)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':'native','negative_prompt':_0x5d9792}};console[_0x3db32f(0x1081)](_0x3db32f(0xb91)),console[_0x3db32f(0x1081)](_0x3db32f(0x557),_0x560a5),console[_0x3db32f(0x1081)]('📋\x20请求体:',JSON[_0x3db32f(0xe3f)](_0x33bc83,null,0x2));let _0x45e7c0;_0x560a5[_0x3db32f(0xe53)](_0x3db32f(0xcef))?_0x45e7c0='https://image.novelai.net/ai/generate-image-stream':_0x45e7c0=_0x3db32f(0x13c8);let _0x38aa76=_0x45dd52[_0x3db32f(0x7b9)];_0x38aa76===_0x3db32f(0xea0)&&(_0x38aa76=_0x45dd52[_0x3db32f(0x5c3)]||'');_0x38aa76&&_0x38aa76!==''&&(_0x45e7c0=_0x38aa76+encodeURIComponent(_0x45e7c0));const _0x15af99=/Chrome/[_0x3db32f(0x4af)](navigator['userAgent'])&&!/Edg/[_0x3db32f(0x4af)](navigator[_0x3db32f(0xb3b)]);let _0x1fd373={'method':_0x3db32f(0x2d1),'headers':{'Content-Type':_0x3db32f(0x7fe),'Authorization':_0x3db32f(0x236)+_0x39e608},'body':JSON['stringify'](_0x33bc83)};if(_0x15af99){console[_0x3db32f(0x1081)](_0x3db32f(0x1345));const _0x4d5330={};for(const [_0x415abe,_0x50b473]of Object[_0x3db32f(0x1052)](_0x1fd373[_0x3db32f(0x3e5)])){_0x4d5330[_0x415abe]=_0x50b473[_0x3db32f(0x137f)](/[^\x00-\xFF]/g,'');}_0x1fd373[_0x3db32f(0x3e5)]=_0x4d5330;}const _0x3ba529=await fetch(_0x45e7c0,_0x1fd373);console[_0x3db32f(0x1081)]('Response\x20status:',_0x3ba529[_0x3db32f(0x69e)]),console[_0x3db32f(0x1081)](_0x3db32f(0x22d),[..._0x3ba529[_0x3db32f(0x3e5)]['entries']()]);if(!_0x3ba529['ok']){const _0x1e804a=await _0x3ba529[_0x3db32f(0x673)]();console[_0x3db32f(0xc60)]('API错误响应:',_0x1e804a);throw new Error(_0x3db32f(0x123f)+_0x3ba529['status']+_0x3db32f(0xc1c)+_0x1e804a);}const _0x57aa6f=_0x3ba529[_0x3db32f(0x3e5)]['get']('content-type');console[_0x3db32f(0x1081)](_0x3db32f(0xe2e),_0x57aa6f);let _0x133b49;if(_0x57aa6f&&_0x57aa6f[_0x3db32f(0xe53)](_0x3db32f(0xc8d))){console[_0x3db32f(0x1081)](_0x3db32f(0x3f6)),_0x2684da[_0x3db32f(0xee5)]=_0x3db32f(0xca7);const _0x27e965=await _0x3ba529[_0x3db32f(0x673)]();console[_0x3db32f(0x1081)](_0x3db32f(0x11e8),_0x27e965[_0x3db32f(0x40f)]);const _0x310953=_0x27e965[_0x3db32f(0x43a)]()[_0x3db32f(0x108c)]('\x0a');let _0x301e33=null;for(let _0x2a7b43=_0x310953[_0x3db32f(0x40f)]-0x1;_0x2a7b43>=0x0;_0x2a7b43--){const _0x473e0e=_0x310953[_0x2a7b43][_0x3db32f(0x43a)]();if(_0x473e0e[_0x3db32f(0x7d)](_0x3db32f(0xb19))&&_0x473e0e!=='data:\x20[DONE]'){const _0x5722c2=_0x473e0e['substring'](0x6);try{const _0x502238=JSON['parse'](_0x5722c2);if(_0x502238[_0x3db32f(0x561)]==='final'&&_0x502238[_0x3db32f(0x980)]){_0x301e33=_0x502238['image'],console['log'](_0x3db32f(0x6e9));break;}if(_0x502238['data']){_0x301e33=_0x502238[_0x3db32f(0x88a)],console[_0x3db32f(0x1081)](_0x3db32f(0xd55));break;}if(_0x502238[_0x3db32f(0x980)]){_0x301e33=_0x502238[_0x3db32f(0x980)],console[_0x3db32f(0x1081)](_0x3db32f(0xca));break;}}catch(_0xbefe61){_0x301e33=_0x5722c2,console[_0x3db32f(0x1081)](_0x3db32f(0x885));break;}}}if(!_0x301e33)throw new Error(_0x3db32f(0x3cc));const _0x41e611=_0x301e33['startsWith'](_0x3db32f(0xf3f)),_0x13f63a=_0x301e33[_0x3db32f(0x7d)]('/9j/');if(_0x41e611||_0x13f63a){console[_0x3db32f(0x1081)]('✅\x20检测到直接的图片\x20base64\x20数据\x20(PNG/JPEG)');const _0x401618=atob(_0x301e33),_0xf317a1=new Uint8Array(_0x401618[_0x3db32f(0x40f)]);for(let _0x311a49=0x0;_0x311a49<_0x401618['length'];_0x311a49++){_0xf317a1[_0x311a49]=_0x401618[_0x3db32f(0x150)](_0x311a49);}const _0xd308b6=new Blob([_0xf317a1],{'type':_0x41e611?_0x3db32f(0xc99):'image/jpeg'});console[_0x3db32f(0x1081)](_0x3db32f(0x624),_0xd308b6[_0x3db32f(0x9dd)]);const _0x24d77b=URL[_0x3db32f(0xb29)](_0xd308b6);document[_0x3db32f(0x64f)]('nai-result-image')[_0x3db32f(0xbe8)]=_0x24d77b,_0x2684da[_0x3db32f(0x731)][_0x3db32f(0x130)]=_0x3db32f(0x1209),_0x2b348b[_0x3db32f(0x731)][_0x3db32f(0x130)]=_0x3db32f(0xb37),console[_0x3db32f(0x1081)](_0x3db32f(0xec6));return;}console[_0x3db32f(0x1081)](_0x3db32f(0x13c));const _0x23a017=atob(_0x301e33),_0xf989bc=new Uint8Array(_0x23a017[_0x3db32f(0x40f)]);for(let _0x17891f=0x0;_0x17891f<_0x23a017[_0x3db32f(0x40f)];_0x17891f++){_0xf989bc[_0x17891f]=_0x23a017[_0x3db32f(0x150)](_0x17891f);}_0x133b49=new Blob([_0xf989bc]),console['log'](_0x3db32f(0xe3c),_0x133b49[_0x3db32f(0x9dd)]);}else _0x133b49=await _0x3ba529[_0x3db32f(0x1231)](),console['log'](_0x3db32f(0xa50),_0x133b49[_0x3db32f(0xafc)],_0x3db32f(0x13b1),_0x133b49[_0x3db32f(0x9dd)]);try{if(typeof JSZip===_0x3db32f(0x3a3))throw new Error(_0x3db32f(0x16f));_0x2684da['textContent']=_0x3db32f(0xc63);const _0x1701cc=await JSZip[_0x3db32f(0x7f4)](_0x133b49);console[_0x3db32f(0x1081)](_0x3db32f(0x65c),Object[_0x3db32f(0xc30)](_0x1701cc[_0x3db32f(0x91e)]));let _0x130dc3=null;for(let _0x1c3ee7 in _0x1701cc['files']){if(_0x1c3ee7[_0x3db32f(0x132a)](/\.(png|jpg|jpeg|webp)$/i)){_0x130dc3=_0x1701cc[_0x3db32f(0x91e)][_0x1c3ee7],console[_0x3db32f(0x1081)](_0x3db32f(0x478),_0x1c3ee7);break;}}if(!_0x130dc3)throw new Error('ZIP文件中未找到图片');const _0x238283=await _0x130dc3[_0x3db32f(0x89c)]('blob');console[_0x3db32f(0x1081)](_0x3db32f(0xbd7),_0x238283[_0x3db32f(0x9dd)]);const _0x509cc3=URL[_0x3db32f(0xb29)](_0x238283);console[_0x3db32f(0x1081)](_0x3db32f(0x10aa),_0x509cc3),document[_0x3db32f(0x64f)](_0x3db32f(0x10c2))['src']=_0x509cc3,_0x2684da['style'][_0x3db32f(0x130)]=_0x3db32f(0x1209),_0x2b348b[_0x3db32f(0x731)][_0x3db32f(0x130)]=_0x3db32f(0xb37);}catch(_0x28b932){console[_0x3db32f(0xc60)](_0x3db32f(0x5d6),_0x28b932),console[_0x3db32f(0x1081)]('尝试直接作为图片显示...');if(_0x133b49[_0x3db32f(0xafc)]['startsWith'](_0x3db32f(0x8db))){const _0x344cf9=URL[_0x3db32f(0xb29)](_0x133b49);document['getElementById']('nai-result-image')[_0x3db32f(0xbe8)]=_0x344cf9,_0x2684da[_0x3db32f(0x731)][_0x3db32f(0x130)]='none',_0x2b348b['style'][_0x3db32f(0x130)]=_0x3db32f(0xb37);}else throw new Error(_0x3db32f(0x168)+_0x28b932[_0x3db32f(0x854)]);}}catch(_0x39d035){console[_0x3db32f(0xc60)](_0x3db32f(0x8bc),_0x39d035),_0x2684da[_0x3db32f(0x731)][_0x3db32f(0x130)]=_0x3db32f(0x1209),_0x86f4c3[_0x3db32f(0x731)][_0x3db32f(0x130)]=_0x3db32f(0xb37),_0x86f4c3[_0x3db32f(0xee5)]='生成失败:\x20'+_0x39d035[_0x3db32f(0x854)];}finally{_0x14e1b8['disabled']=![],_0x14e1b8[_0x3db32f(0xee5)]=_0x3db32f(0x117c);}}function _0x1c47b3(_0x4f3a3a,_0x1fd803){const _0xff0ecd=_0x5a7792;_0x5e1ec8(),clearTimeout(_0x1c7943);const _0x396c9e=_0x3e7a1b[_0xff0ecd(0x999)][_0x4f3a3a];if(!_0x396c9e)return;const _0x31d37e=document[_0xff0ecd(0x64f)]('notification-bar');document[_0xff0ecd(0x64f)](_0xff0ecd(0x57f))[_0xff0ecd(0xbe8)]=_0x396c9e['settings'][_0xff0ecd(0x93)]||_0x396c9e[_0xff0ecd(0xcb3)][_0xff0ecd(0x63a)]||_0x54e358,document['getElementById'](_0xff0ecd(0xec8))['querySelector']('.name')['textContent']=_0x396c9e['name'],document[_0xff0ecd(0x64f)]('notification-content')['querySelector'](_0xff0ecd(0x13e8))[_0xff0ecd(0xee5)]=_0x1fd803,_0x31d37e[_0xff0ecd(0x418)][_0xff0ecd(0x1275)]('visible'),void _0x31d37e[_0xff0ecd(0x387)],_0x31d37e[_0xff0ecd(0x418)]['add'](_0xff0ecd(0x40a));const _0x228088=_0x31d37e[_0xff0ecd(0xc66)](!![]);_0x31d37e[_0xff0ecd(0x9be)][_0xff0ecd(0x3d4)](_0x228088,_0x31d37e),_0x228088['addEventListener'](_0xff0ecd(0x1080),()=>{const _0x241af6=_0xff0ecd;_0x59a090(_0x4f3a3a),_0x228088[_0x241af6(0x418)][_0x241af6(0x1275)]('visible');}),_0x1c7943=setTimeout(()=>{const _0x2f356d=_0xff0ecd;_0x228088[_0x2f356d(0x418)]['remove']('visible');},0xfa0),_0x1cc461();}function _0x26350e(){const _0x16f15e=_0x5a7792,_0x1b9f79=new Date(),_0x407c66=_0x1b9f79[_0x16f15e(0x13dd)](_0x16f15e(0x6ec),{'hour':_0x16f15e(0xe3e),'minute':_0x16f15e(0xe3e)}),_0x1a9aed=_0x1b9f79['toLocaleDateString']('zh-CN',{'weekday':_0x16f15e(0x572),'month':_0x16f15e(0x572),'day':'numeric'});document['getElementById'](_0x16f15e(0xe75))[_0x16f15e(0xee5)]=_0x407c66;}function _0x3755ce(_0x16f64){const _0x4ba241=_0x5a7792;if(!_0x16f64)return[{'type':'text','content':_0x4ba241(0x7a4)}];let _0x84c9f5=_0x16f64['trim']();const _0x135f94=/```json\s*([\s\S]*?)\s*```/,_0x4d1013=_0x84c9f5[_0x4ba241(0x132a)](_0x135f94);_0x4d1013&&_0x4d1013[0x1]&&(_0x84c9f5=_0x4d1013[0x1][_0x4ba241(0x43a)](),console[_0x4ba241(0x1081)](_0x4ba241(0xdc5)));if(_0x84c9f5[_0x4ba241(0x7d)]('[')&&_0x84c9f5[_0x4ba241(0x720)](']'))try{const _0x17c5a3=JSON[_0x4ba241(0x1214)](_0x84c9f5);if(Array['isArray'](_0x17c5a3))return console[_0x4ba241(0x1081)](_0x4ba241(0x477)),_0x17c5a3;}catch(_0x51ac5c){console[_0x4ba241(0x1155)](_0x4ba241(0x271));}const _0x48b722=_0x84c9f5[_0x4ba241(0xac7)]('['),_0xa34bd8=_0x84c9f5[_0x4ba241(0x6e1)]('}');if(_0x48b722!==-0x1&&_0xa34bd8!==-0x1&&_0xa34bd8>_0x48b722){const _0x3be233=_0x84c9f5['indexOf'](']',_0xa34bd8);if(_0x3be233!==-0x1){const _0x27de52=_0x84c9f5['substring'](_0x48b722,_0x3be233+0x1);try{const _0x399c52=JSON[_0x4ba241(0x1214)](_0x27de52);if(Array['isArray'](_0x399c52))return console[_0x4ba241(0x1081)](_0x4ba241(0x107f)),_0x399c52;}catch(_0x3b6944){console[_0x4ba241(0x1155)](_0x4ba241(0xae9));}}}const _0x6f9c68=_0x84c9f5['match'](/{[^{}]*}/g);if(_0x6f9c68){const _0x355282=[];for(const _0x1c2ed1 of _0x6f9c68){try{const _0x5cff32=JSON[_0x4ba241(0x1214)](_0x1c2ed1);_0x355282[_0x4ba241(0x13ee)](_0x5cff32);}catch(_0x28c543){console[_0x4ba241(0x1155)](_0x4ba241(0xd2e),_0x1c2ed1);}}if(_0x355282[_0x4ba241(0x40f)]>0x0)return console[_0x4ba241(0x1081)]('解析成功：通过强力提取\x20{...}\x20模式。'),_0x355282;}return console[_0x4ba241(0xc60)]('所有解析方案均失败！将返回原始文本。原始回复:',_0x16f64),[{'type':_0x4ba241(0x673),'content':_0x16f64}];}function _0x19a7ae(_0x1ecc51=new Date()){const _0x685f43=_0x5a7792,_0x47a155=_0x1ecc51[_0x685f43(0xdb)]();if(_0x47a155>=0x0&&_0x47a155<0x5)return'凌晨';else{if(_0x47a155>=0x5&&_0x47a155<0x9)return'早上';else{if(_0x47a155>=0x9&&_0x47a155<0xd)return'上午';else{if(_0x47a155>=0xd&&_0x47a155<0x12)return'下午';else{if(_0x47a155>=0x12&&_0x47a155<0x18)return'晚上';}}}}return'现在';}async function _0x160284(){const _0x47b569=_0x5a7792,_0x2ebf44=document['getElementById'](_0x47b569(0x44e));_0x2ebf44[_0x47b569(0xc58)]=_0x47b569(0xde2);const _0x446e39=await _0x4e1bbf[_0x47b569(0x650)][_0x47b569(0x78f)]();_0x446e39[_0x47b569(0x103)](_0x41e323=>{const _0x40631f=_0x47b569,_0x42fb7e=document[_0x40631f(0x124e)](_0x40631f(0x1176));_0x42fb7e[_0x40631f(0xbed)]=_0x41e323['id'],_0x42fb7e['textContent']=_0x41e323['name'],_0x2ebf44['appendChild'](_0x42fb7e);});const _0xba917=_0x3e7a1b[_0x47b569(0xec0)];let _0x20ecf7=null;for(const _0x4d543b of _0x446e39){if(_0x4d543b[_0x47b569(0x9ca)]===_0xba917[_0x47b569(0x9ca)]&&_0x4d543b['apiKey']===_0xba917['apiKey']&&_0x4d543b[_0x47b569(0xd90)]===_0xba917[_0x47b569(0xd90)]&&_0x4d543b[_0x47b569(0x64b)]===_0xba917['secondaryProxyUrl']&&_0x4d543b[_0x47b569(0x2d3)]===_0xba917[_0x47b569(0x2d3)]&&_0x4d543b[_0x47b569(0x31f)]===_0xba917[_0x47b569(0x31f)]&&(_0x4d543b[_0x47b569(0x2d8)]||'')===(_0xba917[_0x47b569(0x2d8)]||'')&&(_0x4d543b[_0x47b569(0xd1)]||'')===(_0xba917['minimaxApiKey']||'')&&(_0x4d543b[_0x47b569(0x72c)]||_0x47b569(0x2a4))===(_0xba917[_0x47b569(0x72c)]||'speech-01')){_0x20ecf7=_0x4d543b['id'];break;}}_0x20ecf7?_0x2ebf44[_0x47b569(0xbed)]=_0x20ecf7:_0x2ebf44['value']='current';}async function _0x278a1f(){const _0x260d71=_0x5a7792,_0x553653=document['getElementById'](_0x260d71(0x44e)),_0xde697d=parseInt(_0x553653['value']);if(isNaN(_0xde697d))return;const _0x3d9846=await _0x4e1bbf[_0x260d71(0x650)]['get'](_0xde697d);_0x3d9846&&(_0x3e7a1b[_0x260d71(0xec0)]={'id':_0x260d71(0x165),'proxyUrl':_0x3d9846[_0x260d71(0x9ca)],'apiKey':_0x3d9846[_0x260d71(0x76c)],'model':_0x3d9846[_0x260d71(0xd90)],'secondaryProxyUrl':_0x3d9846['secondaryProxyUrl'],'secondaryApiKey':_0x3d9846['secondaryApiKey'],'secondaryModel':_0x3d9846[_0x260d71(0x31f)],'minimaxGroupId':_0x3d9846['minimaxGroupId'],'minimaxApiKey':_0x3d9846[_0x260d71(0xd1)],'minimaxModel':_0x3d9846[_0x260d71(0x72c)]},await _0x4e1bbf[_0x260d71(0xec0)][_0x260d71(0x4fa)](_0x3e7a1b[_0x260d71(0xec0)]),_0x1f482e(),document['getElementById'](_0x260d71(0x9c9))['click'](),_0x3d9846[_0x260d71(0x64b)]&&_0x3d9846['secondaryApiKey']&&document[_0x260d71(0x64f)](_0x260d71(0x7da))['click'](),alert(_0x260d71(0x8ca)+_0x3d9846['name']+'”'));}async function _0x112f1f(){const _0x404793=_0x5a7792,_0xc23656=await _0x41e3f8(_0x404793(0x824),_0x404793(0x58a));if(!_0xc23656||!_0xc23656['trim']())return;const _0x458649={'name':_0xc23656[_0x404793(0x43a)](),'proxyUrl':document[_0x404793(0x64f)](_0x404793(0x981))[_0x404793(0xbed)][_0x404793(0x43a)](),'apiKey':document['getElementById'](_0x404793(0x4d5))['value'][_0x404793(0x43a)](),'model':document['getElementById']('model-select')['value'],'secondaryProxyUrl':document['getElementById']('secondary-proxy-url')['value'][_0x404793(0x43a)](),'secondaryApiKey':document[_0x404793(0x64f)](_0x404793(0x11ed))[_0x404793(0xbed)][_0x404793(0x43a)](),'secondaryModel':document[_0x404793(0x64f)]('secondary-model-select')['value'],'minimaxGroupId':document['getElementById'](_0x404793(0x28f))['value'][_0x404793(0x43a)](),'minimaxApiKey':document[_0x404793(0x64f)](_0x404793(0xb09))[_0x404793(0xbed)]['trim'](),'minimaxModel':document[_0x404793(0x64f)](_0x404793(0xca1))[_0x404793(0xbed)]},_0x4e497c=await _0x4e1bbf[_0x404793(0x650)][_0x404793(0xec9)](_0x404793(0x6fc))[_0x404793(0x11cd)](_0x458649['name'])[_0x404793(0x5dd)]();if(_0x4e497c){const _0x41c4eb=await _0x54149f(_0x404793(0x260),_0x404793(0x1189)+_0x458649[_0x404793(0x6fc)]+_0x404793(0x862),{'confirmButtonClass':_0x404793(0xeed)});if(!_0x41c4eb)return;_0x458649['id']=_0x4e497c['id'];}await _0x4e1bbf[_0x404793(0x650)][_0x404793(0x4fa)](_0x458649),await _0x160284(),alert('API\x20预设已保存！');}async function _0x230be6(){const _0x149397=_0x5a7792,_0x53c883=document[_0x149397(0x64f)]('api-preset-select'),_0x174b19=parseInt(_0x53c883[_0x149397(0xbed)]);if(isNaN(_0x174b19)){alert(_0x149397(0x677));return;}const _0x36beb0=await _0x4e1bbf[_0x149397(0x650)][_0x149397(0x11fc)](_0x174b19);if(!_0x36beb0)return;const _0x472570=await _0x54149f(_0x149397(0xd87),_0x149397(0xd3d)+_0x36beb0[_0x149397(0x6fc)]+'”\x20吗？',{'confirmButtonClass':_0x149397(0xeed)});_0x472570&&(await _0x4e1bbf[_0x149397(0x650)]['delete'](_0x174b19),await _0x160284(),alert('预设已删除。'));}function _0x1f482e(){const _0x4fe833=_0x5a7792;document[_0x4fe833(0x64f)](_0x4fe833(0x981))['value']=_0x3e7a1b[_0x4fe833(0xec0)][_0x4fe833(0x9ca)]||'',document[_0x4fe833(0x64f)](_0x4fe833(0x4d5))[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0xec0)][_0x4fe833(0x76c)]||'',document[_0x4fe833(0x64f)](_0x4fe833(0x111d))[_0x4fe833(0xbed)]=_0x3e7a1b['apiConfig'][_0x4fe833(0x64b)]||'',document[_0x4fe833(0x64f)](_0x4fe833(0x11ed))[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0xec0)][_0x4fe833(0x2d3)]||'',document[_0x4fe833(0x64f)](_0x4fe833(0x4e5))[_0x4fe833(0xf1d)]=_0x3e7a1b['globalSettings']['enableBackgroundActivity']||![],document['getElementById'](_0x4fe833(0x651))[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0x11b4)][_0x4fe833(0xd5)]||0x3c,document[_0x4fe833(0x64f)](_0x4fe833(0xc7f))[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0x11b4)]['blockCooldownHours']||0x1,document['getElementById'](_0x4fe833(0x9b2))[_0x4fe833(0xf1d)]=_0x3e7a1b[_0x4fe833(0x11b4)][_0x4fe833(0xc83)],document[_0x4fe833(0x64f)]('chat-render-window-input')[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0x11b4)]['chatRenderWindow']||0x32,document[_0x4fe833(0x64f)](_0x4fe833(0xa54))[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0x11b4)][_0x4fe833(0x1107)]||0x1e;const _0x7c1079=document[_0x4fe833(0x64f)](_0x4fe833(0x12ff)),_0x48e076=document['getElementById'](_0x4fe833(0x2cc)),_0x28cfac=_0x3e7a1b[_0x4fe833(0x11b4)][_0x4fe833(0xa55)]||0.8;_0x7c1079[_0x4fe833(0xbed)]=_0x28cfac,_0x48e076['textContent']=_0x28cfac,document[_0x4fe833(0x64f)]('minimax-group-id')['value']=_0x3e7a1b[_0x4fe833(0xec0)][_0x4fe833(0x2d8)]||'',document[_0x4fe833(0x64f)]('minimax-api-key')[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0xec0)][_0x4fe833(0xd1)]||'',document[_0x4fe833(0x64f)](_0x4fe833(0xca1))[_0x4fe833(0xbed)]=_0x3e7a1b[_0x4fe833(0xec0)][_0x4fe833(0x72c)]||_0x4fe833(0x2a4);const _0x3b1a45=localStorage[_0x4fe833(0x2f5)](_0x4fe833(0x13aa))===_0x4fe833(0x8c1),_0x538d9c=localStorage[_0x4fe833(0x2f5)](_0x4fe833(0xa21))||_0x4fe833(0x11b8),_0x4f2762=localStorage[_0x4fe833(0x2f5)](_0x4fe833(0x427))||'';document[_0x4fe833(0x64f)](_0x4fe833(0xf9c))[_0x4fe833(0xf1d)]=_0x3b1a45,document[_0x4fe833(0x64f)](_0x4fe833(0xa21))[_0x4fe833(0xbed)]=_0x538d9c,document[_0x4fe833(0x64f)](_0x4fe833(0x427))['value']=_0x4f2762,document[_0x4fe833(0x64f)]('novelai-details')[_0x4fe833(0x731)]['display']=_0x3b1a45?'block':_0x4fe833(0x1209),_0x160284(),_0x15e3db();}window[_0x5a7792(0x223)]=_0x1f482e;async function _0x3f5408(){const _0x364784=_0x5a7792,_0x2e091a=document['getElementById']('npc-list');_0x2e091a[_0x364784(0xc58)]='';const _0x2858bc=await _0x4e1bbf[_0x364784(0xad7)]['toArray']();if(_0x2858bc[_0x364784(0x40f)]===0x0){_0x2e091a['innerHTML']=_0x364784(0xf7c);return;}_0x2858bc[_0x364784(0x103)](_0xe74249=>{const _0x19e2d6=_0x364784,_0x1470a3=document[_0x19e2d6(0x124e)](_0x19e2d6(0x479));_0x1470a3[_0x19e2d6(0x87d)]='chat-list-item',_0x1470a3[_0x19e2d6(0x12e1)][_0x19e2d6(0x106f)]=_0xe74249['id'],_0x1470a3[_0x19e2d6(0xc58)]=_0x19e2d6(0xa8d)+(_0xe74249[_0x19e2d6(0x1265)]||_0x480024)+_0x19e2d6(0xd59)+_0xe74249['name']+_0x19e2d6(0x53d)+_0xe74249[_0x19e2d6(0x324)][_0x19e2d6(0x126f)](0x0,0x1e)+_0x19e2d6(0x12d7),_0x1470a3[_0x19e2d6(0xf72)](_0x19e2d6(0x1080),()=>_0x228ec3(_0xe74249['id'])),_0xb407a5(_0x1470a3,async()=>{await _0x4b887f(_0xe74249['id']);}),_0x2e091a['appendChild'](_0x1470a3);});}async function _0x228ec3(_0x19f546=null){const _0x935592=_0x5a7792;editingNpcId=_0x19f546;const _0x3205c8=document[_0x935592(0x64f)]('npc-editor-modal'),_0x3d3901=document['getElementById']('npc-editor-title'),_0x4e2eb0=document[_0x935592(0x64f)](_0x935592(0xba7)),_0x2f8e9b=document[_0x935592(0x64f)](_0x935592(0x5f7)),_0x26a7c2=document[_0x935592(0x64f)]('npc-avatar-preview'),_0x5196d6=document[_0x935592(0x64f)]('npc-association-list'),_0x1bf642=document[_0x935592(0x64f)]('npc-background-activity-switch'),_0x291946=document[_0x935592(0x64f)](_0x935592(0x9f8));_0x5196d6['innerHTML']='',_0x5196d6[_0x935592(0xc58)]+=_0x935592(0xdc7)+(_0x3e7a1b[_0x935592(0x3c2)][_0x935592(0x78c)]||'我')+'\x20(用户)</label>',Object[_0x935592(0xd6d)](_0x3e7a1b[_0x935592(0x999)])[_0x935592(0x156)](_0x4c50cb=>!_0x4c50cb['isGroup'])['forEach'](_0xe6a852=>{const _0x2a7c94=_0x935592;_0x5196d6['innerHTML']+=_0x2a7c94(0x1ab)+_0xe6a852['id']+'\x22>\x20'+_0xe6a852['name']+_0x2a7c94(0x93b);});if(_0x19f546){_0x3d3901[_0x935592(0xee5)]=_0x935592(0x10a4);const _0x39fb43=await _0x4e1bbf[_0x935592(0xad7)][_0x935592(0x11fc)](_0x19f546);_0x39fb43&&(_0x4e2eb0[_0x935592(0xbed)]=_0x39fb43['name'],_0x2f8e9b['value']=_0x39fb43[_0x935592(0x324)],_0x26a7c2['src']=_0x39fb43['avatar']||_0x480024,_0x1bf642['checked']=_0x39fb43[_0x935592(0x11c3)]!==![],_0x291946[_0x935592(0xbed)]=_0x39fb43[_0x935592(0x963)]||0xf,_0x39fb43[_0x935592(0x22c)]&&Array[_0x935592(0x97e)](_0x39fb43[_0x935592(0x22c)])&&_0x39fb43[_0x935592(0x22c)][_0x935592(0x103)](_0x1bcf1d=>{const _0x28f199=_0x935592,_0x5b0539=_0x5196d6[_0x28f199(0x49c)](_0x28f199(0x1244)+_0x1bcf1d+'\x22]');if(_0x5b0539)_0x5b0539[_0x28f199(0xf1d)]=!![];}));}else{_0x3d3901[_0x935592(0xee5)]=_0x935592(0x971),_0x4e2eb0[_0x935592(0xbed)]='',_0x2f8e9b[_0x935592(0xbed)]='',_0x26a7c2[_0x935592(0xbe8)]=_0x480024,_0x1bf642[_0x935592(0xf1d)]=!![],_0x291946[_0x935592(0xbed)]=0xf;const _0x4d4ddc=_0x5196d6['querySelector'](_0x935592(0x10c1));if(_0x4d4ddc)_0x4d4ddc[_0x935592(0xf1d)]=!![];}_0x3205c8[_0x935592(0x418)][_0x935592(0xdda)](_0x935592(0x40a));}async function _0x19887e(){const _0x44af1c=_0x5a7792,_0x368b3b=document[_0x44af1c(0x64f)]('npc-name-input')[_0x44af1c(0xbed)]['trim'](),_0x474da3=document[_0x44af1c(0x64f)]('npc-persona-input')['value'][_0x44af1c(0x43a)]();if(!_0x368b3b||!_0x474da3){alert('NPC的昵称和人设都不能为空！');return;}const _0x34dc2f=Array[_0x44af1c(0xb3a)](document['querySelectorAll'](_0x44af1c(0x67b)))[_0x44af1c(0xb96)](_0xda2a05=>_0xda2a05[_0x44af1c(0xbed)]),_0x1c8297=document[_0x44af1c(0x64f)](_0x44af1c(0xf70))[_0x44af1c(0xf1d)],_0x1f22d2=parseInt(document[_0x44af1c(0x64f)](_0x44af1c(0x9f8))['value'])||0xf,_0x240616={'name':_0x368b3b,'persona':_0x474da3,'avatar':document[_0x44af1c(0x64f)](_0x44af1c(0x9bf))[_0x44af1c(0xbe8)],'associatedWith':_0x34dc2f,'enableBackgroundActivity':_0x1c8297,'actionCooldownMinutes':_0x1f22d2};if(editingNpcId)await _0x4e1bbf[_0x44af1c(0xad7)]['update'](editingNpcId,_0x240616);else{const _0x5796d8=await _0x4e1bbf[_0x44af1c(0xad7)]['add'](_0x240616);if(_0x585d1c&&_0x3e7a1b[_0x44af1c(0x777)]){const _0x358cea=_0x3e7a1b[_0x44af1c(0x999)][_0x3e7a1b[_0x44af1c(0x777)]];_0x358cea[_0x44af1c(0x1167)]&&(_0x358cea[_0x44af1c(0x5d4)]['push']({'id':_0x44af1c(0x33e)+_0x5796d8,'originalName':_0x368b3b,'groupNickname':_0x368b3b,'persona':_0x474da3,'avatar':_0x240616[_0x44af1c(0x1265)],'isNpc':!![]}),await _0x4e1bbf['chats'][_0x44af1c(0x4fa)](_0x358cea));}}document[_0x44af1c(0x64f)](_0x44af1c(0xa7e))['classList'][_0x44af1c(0x1275)](_0x44af1c(0x40a)),_0x585d1c?(_0x585d1c=![],_0x583985()):await _0x3f5408();}async function _0x4b887f(_0x12d388){const _0x4df4db=_0x5a7792,_0x3c0695=await _0x4e1bbf['npcs'][_0x4df4db(0x11fc)](_0x12d388);if(!_0x3c0695)return;const _0x33b2fd=await _0x54149f('删除NPC',_0x4df4db(0x12a6)+_0x3c0695['name']+_0x4df4db(0x2dc),{'confirmButtonClass':_0x4df4db(0xeed)});_0x33b2fd&&(await _0x4e1bbf[_0x4df4db(0xad7)]['delete'](_0x12d388),await _0x3f5408());}let _0x438180=0x0;function _0xc7204d(_0x412bd2){const _0x5dad8b=_0x5a7792,_0x5a53d6=document[_0x5dad8b(0x124e)](_0x5dad8b(0x479));return _0x5a53d6['className']=_0x5dad8b(0xb72),_0x5a53d6['innerHTML']=_0x5dad8b(0x7b2)+_0x412bd2[_0x5dad8b(0x6fc)]+_0x5dad8b(0x5bb),_0x5a53d6;}function _0x1c672d(_0x37a8b7){const _0x1e6b30=_0x5a7792,_0x5a2771=document[_0x1e6b30(0x64f)]('chat-list'),_0x5db20a=document[_0x1e6b30(0x64f)](_0x1e6b30(0x1297));if(_0x5db20a)_0x5db20a['remove']();const _0x21f601=_0x438180,_0x59c646=_0x438180+CHAT_LIST_RENDER_WINDOW,_0x4d75d2=_0x37a8b7[_0x1e6b30(0xdf5)](_0x21f601,_0x59c646),_0x41add5=document[_0x1e6b30(0x148)]();let _0x56959d=_0x5a2771['querySelector']('.chat-group-content:last-of-type');_0x4d75d2[_0x1e6b30(0x103)](_0x36374a=>{const _0x51f3de=_0x1e6b30;if(_0x36374a[_0x51f3de(0xafc)]==='groupHeader'){const _0x3f5ea3=_0xc7204d(_0x36374a[_0x51f3de(0xa40)]);_0x41add5['appendChild'](_0x3f5ea3),_0x56959d=_0x3f5ea3[_0x51f3de(0x49c)](_0x51f3de(0xdf4));}else{if(_0x36374a[_0x51f3de(0xafc)]===_0x51f3de(0x952)){const _0x1adfbd=_0x8b7c37(_0x36374a[_0x51f3de(0xc09)]);_0x56959d&&_0x36374a[_0x51f3de(0xc09)][_0x51f3de(0xeb)]?_0x56959d[_0x51f3de(0x99e)](_0x1adfbd):(_0x41add5[_0x51f3de(0x99e)](_0x1adfbd),_0x56959d=null);}}}),_0x5a2771[_0x1e6b30(0x99e)](_0x41add5),_0x438180+=_0x4d75d2[_0x1e6b30(0x40f)],_0x37a8b7[_0x1e6b30(0x40f)]>_0x438180&&_0x59a8a4(_0x5a2771,_0x37a8b7),document[_0x1e6b30(0x233)]('.chat-group-header')['forEach'](_0x50d35e=>{const _0x4d2ddc=_0x1e6b30,_0x29092f=_0x50d35e[_0x4d2ddc(0xc66)](!![]);_0x50d35e[_0x4d2ddc(0x9be)][_0x4d2ddc(0x3d4)](_0x29092f,_0x50d35e),_0x29092f[_0x4d2ddc(0xf72)]('click',()=>{const _0x2a21c8=_0x4d2ddc;_0x29092f['classList'][_0x2a21c8(0x5cf)](_0x2a21c8(0xaf4)),_0x29092f[_0x2a21c8(0x9c8)][_0x2a21c8(0x418)][_0x2a21c8(0x5cf)](_0x2a21c8(0xaf4));});});}async function _0x21f6ea(){const _0x17b7fa=_0x5a7792,_0x7412ed=document[_0x17b7fa(0x64f)](_0x17b7fa(0x1182));_0x7412ed[_0x17b7fa(0xc58)]='';const _0x292133=Object[_0x17b7fa(0xd6d)](_0x3e7a1b['chats'])[_0x17b7fa(0x102f)]((_0x8cc4a3,_0x2fcdcf)=>{const _0x804864=_0x17b7fa,_0x3c7c8d=(_0x2fcdcf[_0x804864(0x9b6)]||![])-(_0x8cc4a3['isPinned']||![]);if(_0x3c7c8d!==0x0)return _0x3c7c8d;return(_0x2fcdcf[_0x804864(0x830)]['slice'](-0x1)[0x0]?.[_0x804864(0x8af)]||0x0)-(_0x8cc4a3[_0x804864(0x830)]['slice'](-0x1)[0x0]?.['timestamp']||0x0);}),_0x348265=await _0x4e1bbf[_0x17b7fa(0xc1a)][_0x17b7fa(0x78f)]();if(_0x292133[_0x17b7fa(0x40f)]===0x0){_0x7412ed[_0x17b7fa(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20margin-top:\x2050px;\x22>点击右上角\x20\x22+\x22\x20或群组图标添加聊天</p>';return;}_0x348265[_0x17b7fa(0x103)](_0xdc2447=>{const _0x3d852e=_0x17b7fa,_0x49e605=_0x292133[_0x3d852e(0x137)](_0x54b866=>_0x54b866['groupId']===_0xdc2447['id']);_0xdc2447[_0x3d852e(0x5aa)]=_0x49e605?_0x49e605[_0x3d852e(0x830)][_0x3d852e(0xdf5)](-0x1)[0x0]?.[_0x3d852e(0x8af)]||0x0:0x0;}),_0x348265[_0x17b7fa(0x102f)]((_0x59e4ed,_0x97e809)=>_0x97e809[_0x17b7fa(0x5aa)]-_0x59e4ed[_0x17b7fa(0x5aa)]),_0x3d215e=[];const _0x59ee1f=new Set();_0x292133[_0x17b7fa(0x103)](_0x3195c4=>{const _0x56bd5c=_0x17b7fa;_0x3195c4['isPinned']&&(_0x3d215e[_0x56bd5c(0x13ee)]({'type':_0x56bd5c(0x952),'chat':_0x3195c4}),_0x59ee1f['add'](_0x3195c4['id']));}),_0x348265[_0x17b7fa(0x103)](_0x2fcf7c=>{const _0x2cf02e=_0x17b7fa,_0x5b8394=_0x292133[_0x2cf02e(0x156)](_0x3bec98=>!_0x3bec98[_0x2cf02e(0x9b6)]&&!_0x3bec98[_0x2cf02e(0x1167)]&&_0x3bec98[_0x2cf02e(0xeb)]===_0x2fcf7c['id']);_0x5b8394['length']>0x0&&(_0x3d215e[_0x2cf02e(0x13ee)]({'type':_0x2cf02e(0x2c6),'group':_0x2fcf7c}),_0x5b8394[_0x2cf02e(0x103)](_0x3e54f2=>{const _0x3685af=_0x2cf02e;_0x3d215e[_0x3685af(0x13ee)]({'type':'chatItem','chat':_0x3e54f2}),_0x59ee1f['add'](_0x3e54f2['id']);}));}),_0x292133[_0x17b7fa(0x103)](_0x4346f9=>{const _0x49128f=_0x17b7fa;!_0x59ee1f[_0x49128f(0x2a6)](_0x4346f9['id'])&&(_0x3d215e[_0x49128f(0x13ee)]({'type':_0x49128f(0x952),'chat':_0x4346f9}),_0x59ee1f[_0x49128f(0xdda)](_0x4346f9['id']));}),_0x438180=0x0,_0x1c672d();}function _0xc7204d(_0x244a62){const _0x3f5100=_0x5a7792,_0x43d899=document[_0x3f5100(0x124e)](_0x3f5100(0x479));return _0x43d899['className']=_0x3f5100(0xb72),_0x43d899[_0x3f5100(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22chat-group-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22arrow\x22>▼</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x244a62['name']+_0x3f5100(0xdd8),_0x43d899;}function _0x59a8a4(_0x2326ed,_0x33c7c4){const _0x12ac3e=_0x5a7792,_0xd2f937=document[_0x12ac3e(0x124e)](_0x12ac3e(0xcd));_0xd2f937['id']='load-more-chats-btn',_0xd2f937[_0x12ac3e(0xee5)]=_0x12ac3e(0xe91),_0xd2f937[_0x12ac3e(0x87d)]=_0x12ac3e(0xc22),_0xd2f937[_0x12ac3e(0xf72)]('click',()=>_0x1c672d(_0x33c7c4),{'once':!![]}),_0x2326ed[_0x12ac3e(0x7f5)](_0xd2f937);}function _0x1c672d(){const _0x8f24c8=_0x5a7792;if(_0x522181)return;const _0x1f06ee=document[_0x8f24c8(0x64f)]('chat-list'),_0x55dcb2=document[_0x8f24c8(0x64f)](_0x8f24c8(0x476));if(!_0x1f06ee||!_0x55dcb2)return;if(_0x438180>=_0x3d215e[_0x8f24c8(0x40f)])return;_0x522181=!![];const _0x5ad50b=_0x438180===0x0,_0x51dfb2=()=>{const _0x398d1b=_0x8f24c8;_0x23b212(_0x1f06ee);const _0x4f25e9=_0x3e7a1b[_0x398d1b(0x11b4)][_0x398d1b(0x1107)]||0x1e,_0x2535d1=_0x438180,_0x919289=_0x438180+_0x4f25e9,_0x597010=_0x3d215e['slice'](_0x2535d1,_0x919289),_0x2c6cc2=document[_0x398d1b(0x148)]();let _0xb5fe74=_0x1f06ee[_0x398d1b(0x49c)](_0x398d1b(0x848));_0x597010[_0x398d1b(0x103)](_0x256f0d=>{const _0x59b2f4=_0x398d1b;if(_0x256f0d[_0x59b2f4(0xafc)]===_0x59b2f4(0x2c6)){const _0x3f4b88=_0xc7204d(_0x256f0d[_0x59b2f4(0xa40)]);_0x2c6cc2[_0x59b2f4(0x99e)](_0x3f4b88),_0xb5fe74=_0x3f4b88[_0x59b2f4(0x49c)](_0x59b2f4(0xdf4));}else{if(_0x256f0d[_0x59b2f4(0xafc)]==='chatItem'){const _0x4ad540=_0x8b7c37(_0x256f0d[_0x59b2f4(0xc09)]);if(_0x256f0d[_0x59b2f4(0xc09)]['groupId']&&_0xb5fe74)_0xb5fe74[_0x59b2f4(0x99e)](_0x4ad540);else{_0x2c6cc2[_0x59b2f4(0x99e)](_0x4ad540);if(!_0x256f0d['chat'][_0x59b2f4(0xeb)])_0xb5fe74=null;}}}}),_0x1f06ee[_0x398d1b(0x99e)](_0x2c6cc2),_0x438180+=_0x597010['length'],_0x1f06ee[_0x398d1b(0x233)]('.chat-group-header:not([data-has-listener=\x22true\x22])')[_0x398d1b(0x103)](_0x5c1634=>{const _0x5e2dbf=_0x398d1b;_0x5c1634[_0x5e2dbf(0x12e1)][_0x5e2dbf(0x6b0)]=_0x5e2dbf(0x8c1),_0x5c1634[_0x5e2dbf(0xf72)]('click',()=>{const _0x4715a9=_0x5e2dbf;_0x5c1634[_0x4715a9(0x418)][_0x4715a9(0x5cf)](_0x4715a9(0xaf4)),_0x5c1634[_0x4715a9(0x9c8)][_0x4715a9(0x418)][_0x4715a9(0x5cf)](_0x4715a9(0xaf4));});}),_0x522181=![],_0x55dcb2[_0x398d1b(0x1ba)]<=_0x55dcb2[_0x398d1b(0x84e)]&&_0x438180<_0x3d215e[_0x398d1b(0x40f)]&&_0x1c672d();};_0x5ad50b?_0x51dfb2():(_0x429707(_0x1f06ee,_0x8f24c8(0x8da)),setTimeout(_0x51dfb2,0x1f4));}function _0x8b7c37(_0x2feaa3){const _0x5c9d36=_0x5a7792;try{const _0x568c5e=_0x2feaa3[_0x5c9d36(0x830)][_0x5c9d36(0x156)](_0x2d0cb8=>!_0x2d0cb8[_0x5c9d36(0x5cc)])[_0x5c9d36(0xdf5)](-0x1)[0x0]||{};let _0x58859e;if(!_0x2feaa3[_0x5c9d36(0x1167)]&&_0x2feaa3[_0x5c9d36(0x55f)]?.['status']===_0x5c9d36(0x839))_0x58859e=_0x5c9d36(0xd72)+(_0x2feaa3[_0x5c9d36(0x55f)]['applicationReason']||_0x5c9d36(0xc9f))+_0x5c9d36(0x120);else{if(!_0x2feaa3[_0x5c9d36(0x1167)]&&_0x2feaa3[_0x5c9d36(0x55f)]?.['status']===_0x5c9d36(0x103f))_0x58859e=_0x5c9d36(0xe1);else{if(_0x2feaa3[_0x5c9d36(0x1167)]){if(_0x568c5e['type']===_0x5c9d36(0xac1))_0x58859e=_0x5c9d36(0x119c)+_0x568c5e['content'];else{if(_0x568c5e[_0x5c9d36(0xafc)]===_0x5c9d36(0xcda))_0x58859e=_0x5c9d36(0xeac);else{if(_0x568c5e[_0x5c9d36(0xafc)]===_0x5c9d36(0x118)||_0x568c5e[_0x5c9d36(0xafc)]==='user_photo')_0x58859e=_0x5c9d36(0xecb);else{if(_0x568c5e[_0x5c9d36(0xafc)]===_0x5c9d36(0xe76))_0x58859e=_0x5c9d36(0x28a);else{if(typeof _0x568c5e['content']===_0x5c9d36(0x1251)&&_0x442b6b[_0x5c9d36(0x4af)](_0x568c5e[_0x5c9d36(0x3ba)]))_0x58859e=_0x568c5e[_0x5c9d36(0x10b3)]?_0x5c9d36(0x7af)+_0x568c5e['meaning']+']':_0x5c9d36(0x4fb);else Array[_0x5c9d36(0x97e)](_0x568c5e[_0x5c9d36(0x3ba)])?_0x58859e=_0x5c9d36(0x26a):_0x58859e=String(_0x568c5e['content']||_0x5c9d36(0x3cd))[_0x5c9d36(0x126f)](0x0,0x14);}}}}if(_0x568c5e['senderName']&&_0x568c5e[_0x5c9d36(0xafc)]!=='pat_message'){const _0x492096=_0x1409fb(_0x2feaa3,_0x568c5e['senderName']);_0x58859e=_0x492096+':\x20'+_0x58859e;}}else{const _0x9678f=_0x2feaa3[_0x5c9d36(0x69e)]?.[_0x5c9d36(0x673)]||'在线';_0x58859e='['+_0x9678f+']';}}}const _0x3c6d20=document[_0x5c9d36(0x124e)]('div');_0x3c6d20[_0x5c9d36(0x87d)]='chat-list-item',_0x3c6d20[_0x5c9d36(0x12e1)][_0x5c9d36(0x367)]=_0x2feaa3['id'];_0x2feaa3[_0x5c9d36(0x9b6)]&&_0x3c6d20[_0x5c9d36(0x418)][_0x5c9d36(0xdda)]('pinned');const _0x3776a2=_0x2feaa3[_0x5c9d36(0x1167)]?_0x2feaa3['settings'][_0x5c9d36(0x63a)]:_0x2feaa3[_0x5c9d36(0xcb3)][_0x5c9d36(0x93)],_0x3cd120=_0x2feaa3['isGroup']?'':_0x2feaa3[_0x5c9d36(0xcb3)]['aiAvatarFrame']||'';let _0x2737fa;_0x3cd120?_0x2737fa=_0x5c9d36(0xa6d)+(_0x3776a2||_0x54e358)+_0x5c9d36(0xaaa)+_0x3cd120+_0x5c9d36(0x609):_0x2737fa=_0x5c9d36(0x86)+(_0x3776a2||_0x54e358)+_0x5c9d36(0x12e9);const _0x478b52=_0x3cd120?_0x5c9d36(0x122):'',_0x447978=_0x5c9d36(0x412)+_0x478b52+'\x22>'+_0x2737fa+_0x5c9d36(0x4b1);_0x3c6d20[_0x5c9d36(0xc58)]=_0x5c9d36(0x781)+_0x447978+_0x5c9d36(0xfc8)+_0x2feaa3['name']+_0x5c9d36(0x1041)+(_0x2feaa3[_0x5c9d36(0x1167)]?_0x5c9d36(0xb1e):'')+_0x5c9d36(0xf82)+(_0x2feaa3[_0x5c9d36(0x1167)]?_0x5c9d36(0xafa):_0x5c9d36(0x74d))+';\x20font-style:\x20italic;\x22>'+_0x58859e+_0x5c9d36(0x43b);const _0x388c89=_0x2feaa3[_0x5c9d36(0x13c0)]||0x0,_0x13313d=_0x3c6d20[_0x5c9d36(0x49c)](_0x5c9d36(0xdfb));_0x388c89>0x0?(_0x13313d[_0x5c9d36(0xee5)]=_0x388c89>0x63?'99+':_0x388c89,_0x13313d[_0x5c9d36(0x731)][_0x5c9d36(0x130)]='inline-flex'):_0x13313d[_0x5c9d36(0x731)]['display']=_0x5c9d36(0x1209);const _0xcda360=_0x3c6d20[_0x5c9d36(0x49c)](_0x5c9d36(0x23a));_0xcda360&&(_0xcda360[_0x5c9d36(0x731)][_0x5c9d36(0x1101)]='pointer',_0xcda360[_0x5c9d36(0xf72)]('dblclick',_0x4c9c53=>{const _0xff4ed6=_0x5c9d36;_0x4c9c53['stopPropagation']();const _0x13def5=_0x2feaa3[_0xff4ed6(0x1167)]?_0x2feaa3['name']:_0x2feaa3['originalName'];_0x4601ee(_0x2feaa3['id'],_0x13def5);}));const _0x36f957=_0x3c6d20[_0x5c9d36(0x49c)](_0x5c9d36(0x13ed));return _0x36f957&&_0x36f957[_0x5c9d36(0xf72)](_0x5c9d36(0x1080),()=>_0x59a090(_0x2feaa3['id'])),_0xb407a5(_0x3c6d20,async _0x4c7cd4=>{const _0x4f60be=_0x5c9d36,_0x5065db=await _0x1c87a0(_0x2feaa3);switch(_0x5065db){case _0x4f60be(0x12cc):_0x2feaa3[_0x4f60be(0x9b6)]=!_0x2feaa3[_0x4f60be(0x9b6)],await _0x4e1bbf[_0x4f60be(0x999)][_0x4f60be(0x4fa)](_0x2feaa3),_0x21f6ea();break;case'delete':const _0x3f54fe=await _0x54149f('删除对话','确定要删除与\x20\x22'+_0x2feaa3[_0x4f60be(0x6fc)]+_0x4f60be(0xf6),{'confirmButtonClass':'btn-danger'});if(_0x3f54fe){_0x1c083c['isActive']&&_0x1c083c[_0x4f60be(0x777)]===_0x2feaa3['id']&&await _0x19d084(![]);delete _0x3e7a1b[_0x4f60be(0x999)][_0x2feaa3['id']];if(_0x3e7a1b[_0x4f60be(0x777)]===_0x2feaa3['id'])_0x3e7a1b[_0x4f60be(0x777)]=null;await _0x4e1bbf[_0x4f60be(0x999)]['delete'](_0x2feaa3['id']),_0x21f6ea();}break;default:break;}}),_0x3c6d20;}catch(_0x3d3732){return console['error'](_0x5c9d36(0x50f)+(_0x2feaa3['name']||'未知')+_0x5c9d36(0x87e)+_0x2feaa3['id']+')\x20时出错:',_0x3d3732),null;}}async function _0x4817d1(_0x1cf126){const _0x4ed1ce=_0x5a7792;_0x19109f(),_0x59f355();const _0x5182d1=_0x3e7a1b[_0x4ed1ce(0x999)][_0x1cf126];if(!_0x5182d1)return;_0x5ec8b6();const _0x172ea4=document[_0x4ed1ce(0x64f)]('chat-messages'),_0x2b9902=document[_0x4ed1ce(0x64f)](_0x4ed1ce(0x2c2)),_0xd09c71=document[_0x4ed1ce(0x64f)]('chat-lock-overlay'),_0x339212=document['getElementById']('chat-lock-content');_0x172ea4['dataset'][_0x4ed1ce(0xb3d)]=_0x5182d1[_0x4ed1ce(0xcb3)]['theme']||_0x4ed1ce(0xf5d);const _0x3b37b5=_0x5182d1['settings'][_0x4ed1ce(0xf5a)]||0xd;_0x172ea4[_0x4ed1ce(0x731)][_0x4ed1ce(0xee2)](_0x4ed1ce(0x336),_0x3b37b5+'px'),_0x1f54e5(_0x5182d1[_0x4ed1ce(0xcb3)][_0x4ed1ce(0xacb)]||'',_0x4ed1ce(0x5ab),_0x4ed1ce(0xa02)),document[_0x4ed1ce(0x64f)]('chat-header-title')['textContent']=_0x5182d1[_0x4ed1ce(0x6fc)];const _0x553e54=document['getElementById'](_0x4ed1ce(0xa00)),_0x5916f7=_0x553e54[_0x4ed1ce(0x49c)](_0x4ed1ce(0x50d));_0x5182d1['isGroup']?(_0x553e54['style'][_0x4ed1ce(0x130)]=_0x4ed1ce(0x1209),document['getElementById'](_0x4ed1ce(0x1319))[_0x4ed1ce(0x731)][_0x4ed1ce(0x112b)]=_0x4ed1ce(0x7bd)):(_0x553e54[_0x4ed1ce(0x731)][_0x4ed1ce(0x130)]='flex',document[_0x4ed1ce(0x64f)](_0x4ed1ce(0x1319))[_0x4ed1ce(0x731)]['justifyContent']=_0x4ed1ce(0x104f),_0x5916f7['textContent']=_0x5182d1['status']?.[_0x4ed1ce(0x673)]||'在线',_0x553e54[_0x4ed1ce(0x418)][_0x4ed1ce(0x5cf)](_0x4ed1ce(0x278),_0x5182d1[_0x4ed1ce(0x69e)]?.[_0x4ed1ce(0x91b)]||![]));const _0x58ff50=document[_0x4ed1ce(0x64f)](_0x4ed1ce(0x9aa)),_0x21b90c=_0x5182d1[_0x4ed1ce(0xcb3)][_0x4ed1ce(0xc8b)],_0x2cf629=_0x3e7a1b[_0x4ed1ce(0x11b4)][_0x4ed1ce(0xcb4)],_0x321a0a=document['getElementById']('phone-screen')[_0x4ed1ce(0x418)][_0x4ed1ce(0xef6)]('dark-mode'),_0x433534=_0x321a0a?_0x4ed1ce(0xfd8):_0x4ed1ce(0x3f0);if(_0x21b90c)_0x58ff50[_0x4ed1ce(0x731)][_0x4ed1ce(0x4d6)]=_0x4ed1ce(0xec1)+_0x21b90c+')',_0x58ff50[_0x4ed1ce(0x731)][_0x4ed1ce(0xfd6)]=_0x4ed1ce(0xb2a);else _0x2cf629?(_0x58ff50[_0x4ed1ce(0x731)][_0x4ed1ce(0x4d6)]=_0x4ed1ce(0xec1)+_0x2cf629+')',_0x58ff50[_0x4ed1ce(0x731)]['backgroundColor']=_0x4ed1ce(0xb2a)):(_0x58ff50[_0x4ed1ce(0x731)]['backgroundImage']=_0x4ed1ce(0x1209),_0x58ff50[_0x4ed1ce(0x731)][_0x4ed1ce(0xfd6)]=_0x433534);if(_0x5182d1['isSpectatorGroup'])_0x2b9902[_0x4ed1ce(0x731)]['display']=_0x4ed1ce(0x1209),_0xd09c71[_0x4ed1ce(0x731)][_0x4ed1ce(0x130)]='flex',_0x339212[_0x4ed1ce(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lock-text\x22>正在围观AI们的群聊...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22spectator-actions-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-reroll-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22重新生成上一轮对话\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20\x2011A8.1\x208.1\x200\x200\x200\x204.5\x209M4\x205v4h4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M4\x2013a8.1\x208.1\x200\x200\x200\x2015.5\x202m.5\x204v-4h-4\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-propel-btn\x22\x20class=\x22lock-action-btn\x22>🎬\x20推进剧情</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22spectator-edit-btn\x22\x20class=\x22lock-action-btn\x20secondary\x22\x20title=\x22导演剪辑室：编辑AI上一轮的响应\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M20.24\x2012.24a6\x206\x200\x200\x200-8.49-8.49L5\x2010.5V19h8.5z\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2216\x22\x20y1=\x228\x22\x20x2=\x222\x22\x20y2=\x2222\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<line\x20x1=\x2217.5\x22\x20y1=\x2215\x22\x20x2=\x229\x22\x20y2=\x2215\x22></line>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',document[_0x4ed1ce(0x64f)](_0x4ed1ce(0x602))['onclick']=_0x4ce7a9;else{_0x2b9902['style'][_0x4ed1ce(0x130)]='flex',_0xd09c71[_0x4ed1ce(0x731)][_0x4ed1ce(0x130)]=_0x4ed1ce(0x1209),_0x339212[_0x4ed1ce(0xc58)]='';if(!_0x5182d1['isGroup']&&_0x5182d1['relationship'][_0x4ed1ce(0x69e)]!==_0x4ed1ce(0xfdd)){_0xd09c71[_0x4ed1ce(0x731)][_0x4ed1ce(0x130)]=_0x4ed1ce(0x1026),_0x2b9902[_0x4ed1ce(0x731)]['visibility']=_0x4ed1ce(0xb7a);let _0x576e0d='';switch(_0x5182d1[_0x4ed1ce(0x55f)]['status']){case'blocked_by_user':const _0xfdfe1a=_0x1dd88f!==null,_0x1fb460=_0x5182d1[_0x4ed1ce(0x55f)][_0x4ed1ce(0x338)],_0x35384e=_0x3e7a1b[_0x4ed1ce(0x11b4)][_0x4ed1ce(0xf61)]||0x1,_0x59025d=_0x35384e*0x3c*0x3c*0x3e8,_0x5a6b7a=Date[_0x4ed1ce(0x2b5)]()-_0x1fb460,_0x89b372=_0x5a6b7a>_0x59025d,_0x5090a4=Math['max'](0x0,Math['ceil']((_0x59025d-_0x5a6b7a)/(0x3e8*0x3c)));_0x576e0d=_0x4ed1ce(0x3ff)+_0x5182d1[_0x4ed1ce(0x6fc)]+'”拉黑。</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22unblock-btn\x22\x20class=\x22lock-action-btn\x22>解除拉黑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22margin-top:\x2020px;\x20padding:\x2010px;\x20border:\x201px\x20dashed\x20#ccc;\x20border-radius:\x208px;\x20font-size:\x2011px;\x20text-align:\x20left;\x20color:\x20#666;\x20background:\x20rgba(0,0,0,0.02);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong\x20style=\x22color:\x20#333;\x22>【开发者诊断面板】</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20后台活动总开关:\x20'+(_0x3e7a1b['globalSettings'][_0x4ed1ce(0x11c3)]?_0x4ed1ce(0x99c):'<span\x20style=\x22color:\x20red;\x22>已关闭</span>')+_0x4ed1ce(0xce8)+(_0xfdfe1a?'<span\x20style=\x22color:\x20green;\x22>运行中</span>':_0x4ed1ce(0xba4))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20当前角色状态:\x20<strong>'+_0x5182d1[_0x4ed1ce(0x55f)][_0x4ed1ce(0x69e)]+'</strong><br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20需要冷静(小时):\x20<strong>'+_0x35384e+_0x4ed1ce(0xd95)+(_0x89b372?_0x4ed1ce(0x32a):_0x4ed1ce(0xfc)+_0x5090a4+_0x4ed1ce(0xfe3))+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20触发条件:\x20'+(_0x89b372&&_0x3e7a1b[_0x4ed1ce(0x11b4)][_0x4ed1ce(0x11c3)]?_0x4ed1ce(0x757):_0x4ed1ce(0x1169))+_0x4ed1ce(0x11ff);break;case _0x4ed1ce(0x103f):_0x576e0d=_0x4ed1ce(0x6cb);break;case'pending_user_approval':_0x576e0d=_0x4ed1ce(0x12f2)+_0x5182d1[_0x4ed1ce(0x6fc)]+'”请求添加你为好友：<br><i>“'+_0x5182d1[_0x4ed1ce(0x55f)][_0x4ed1ce(0x2e8)]+_0x4ed1ce(0x145);break;case _0x4ed1ce(0x943):_0x576e0d=_0x4ed1ce(0x64d);break;}_0x339212[_0x4ed1ce(0xc58)]=_0x576e0d;}else _0xd09c71[_0x4ed1ce(0x731)][_0x4ed1ce(0x130)]=_0x4ed1ce(0x1209),_0x2b9902['style'][_0x4ed1ce(0x6db)]=_0x4ed1ce(0x40a);}_0x172ea4[_0x4ed1ce(0xc58)]='';const _0x55365a=_0x5182d1[_0x4ed1ce(0x830)];_0x10081e=0x0;const _0x52844d=_0x3e7a1b['globalSettings'][_0x4ed1ce(0xd63)]||0x32,_0x5f38a3=_0x55365a[_0x4ed1ce(0xdf5)](-_0x52844d),_0xff1bad=[];let _0x2c059e=0x0;for(const _0x4397cd of _0x5f38a3){_0x2c059e>0x0&&_0x4397cd[_0x4ed1ce(0x8af)]-_0x2c059e>0x927c0&&_0xff1bad[_0x4ed1ce(0x13ee)](Promise[_0x4ed1ce(0xae5)](_0x100722(_0x4397cd[_0x4ed1ce(0x8af)]))),_0xff1bad['push'](_0x3209f4(_0x4397cd,_0x5182d1,!![])),_0x2c059e=_0x4397cd[_0x4ed1ce(0x8af)];}const _0x223989=await Promise[_0x4ed1ce(0xfd7)](_0xff1bad),_0x274d91=document[_0x4ed1ce(0x148)]();_0x223989[_0x4ed1ce(0x156)](Boolean)['forEach'](_0x1e042a=>_0x274d91['appendChild'](_0x1e042a)),_0x172ea4[_0x4ed1ce(0x99e)](_0x274d91),_0x10081e=_0x5f38a3['length'];const _0x106a99=document[_0x4ed1ce(0x124e)](_0x4ed1ce(0x479));_0x106a99['id']=_0x4ed1ce(0x5d1),_0x106a99[_0x4ed1ce(0x731)][_0x4ed1ce(0x130)]=_0x4ed1ce(0x1209),_0x106a99['textContent']=_0x4ed1ce(0x137a),_0x172ea4[_0x4ed1ce(0x99e)](_0x106a99),setTimeout(()=>_0x172ea4[_0x4ed1ce(0xed7)]=_0x172ea4[_0x4ed1ce(0x1ba)],0x0);}async function _0x1696d2(){const _0x403d78=_0x5a7792;if(_0x267436)return;_0x267436=!![];const _0x2e4233=document[_0x403d78(0x64f)](_0x403d78(0x207)),_0x27fcd6=_0x3e7a1b[_0x403d78(0x999)][_0x3e7a1b[_0x403d78(0x777)]];if(!_0x27fcd6){_0x267436=![];return;}_0x429707(_0x2e4233,_0x403d78(0x4ed));const _0x4bfe33=_0x2e4233[_0x403d78(0x1ba)];await new Promise(_0x32abe1=>setTimeout(_0x32abe1,0x1f4));const _0x4493d7=_0x27fcd6[_0x403d78(0x830)]['length'],_0x2a9be7=_0x3e7a1b[_0x403d78(0x11b4)][_0x403d78(0xd63)]||0x32,_0x52c4a2=_0x4493d7-_0x10081e-_0x2a9be7,_0x223219=_0x4493d7-_0x10081e,_0x1b84fc=_0x27fcd6['history']['slice'](Math[_0x403d78(0x804)](0x0,_0x52c4a2),_0x223219),_0x3e96cb=_0x2e4233[_0x403d78(0x49c)](_0x403d78(0x1b1));let _0x53c158=_0x3e96cb?parseInt(_0x3e96cb['dataset']['timestamp']):0x0;for(const _0x3a88b8 of _0x1b84fc['reverse']()){if(_0x53c158>0x0&&_0x53c158-_0x3a88b8[_0x403d78(0x8af)]>0x927c0){const _0x1d083a=_0x100722(_0x53c158);_0x2e4233[_0x403d78(0x7f5)](_0x1d083a);}await _0x18c221(_0x3a88b8,_0x27fcd6),_0x53c158=_0x3a88b8['timestamp'];}_0x10081e+=_0x1b84fc['length'];const _0xae071e=_0x2e4233[_0x403d78(0x1ba)];_0x2e4233['scrollTop']=_0xae071e-_0x4bfe33,_0x23b212(_0x2e4233),_0x267436=![];}function _0x309ef1(){const _0x2003a8=_0x5a7792;_0x34a203(),_0x3dac19();const _0x13fc3f=document[_0x2003a8(0x64f)]('wallpaper-preview'),_0x358e48=_0x3e7a1b[_0x2003a8(0x11b4)]['wallpaper'];_0x358e48?(_0x13fc3f['style'][_0x2003a8(0x4d6)]=_0x2003a8(0xec1)+_0x358e48+')',_0x13fc3f['textContent']=''):(_0x13fc3f[_0x2003a8(0x731)][_0x2003a8(0x4d6)]=_0x2003a8(0x991),_0x13fc3f[_0x2003a8(0xee5)]=_0x2003a8(0xa86));const _0x3fe2d2=document[_0x2003a8(0x64f)](_0x2003a8(0xf3d)),_0x108a96=_0x3e7a1b['globalSettings'][_0x2003a8(0xcbc)];_0x108a96?(_0x3fe2d2['style'][_0x2003a8(0x4d6)]=_0x2003a8(0xec1)+_0x108a96+')',_0x3fe2d2[_0x2003a8(0xee5)]=''):(_0x3fe2d2['style']['backgroundImage']=_0x2003a8(0xb03),_0x3fe2d2[_0x2003a8(0xee5)]=_0x2003a8(0xa86));const _0x198995=document['getElementById'](_0x2003a8(0x1021)),_0x53e740=_0x3e7a1b[_0x2003a8(0x11b4)][_0x2003a8(0xcb4)];_0x53e740?(_0x198995[_0x2003a8(0x731)][_0x2003a8(0x4d6)]=_0x2003a8(0xec1)+_0x53e740+')',_0x198995[_0x2003a8(0xee5)]='',document[_0x2003a8(0x64f)](_0x2003a8(0x12ad))[_0x2003a8(0x731)]['display']=_0x2003a8(0x946)):(_0x198995[_0x2003a8(0x731)][_0x2003a8(0x4d6)]=_0x2003a8(0x1209),_0x198995[_0x2003a8(0xee5)]=_0x2003a8(0x134),document[_0x2003a8(0x64f)](_0x2003a8(0x12ad))[_0x2003a8(0x731)]['display']='none'),_0x3e916b(),_0x453102(),document[_0x2003a8(0x64f)](_0x2003a8(0x1b6))['value']=_0x3e7a1b[_0x2003a8(0x11b4)][_0x2003a8(0xedb)]||'',document[_0x2003a8(0x64f)]('notification-sound-url-input')[_0x2003a8(0xbed)]=_0x3e7a1b['globalSettings'][_0x2003a8(0xe5f)]||'',document[_0x2003a8(0x64f)]('status-bar-toggle-switch')['checked']=_0x3e7a1b[_0x2003a8(0x11b4)][_0x2003a8(0x390)]||![],_0x2ad447(),_0x2b6172();}window[_0x5a7792(0x8f5)]=_0x309ef1;function _0x11d2f9(){const _0x542323=_0x5a7792,_0x7b8def=document[_0x542323(0x64f)](_0x542323(0xd89)),_0x427a1e=_0x3e7a1b['globalSettings']['wallpaper'];_0x427a1e?_0x7b8def[_0x542323(0x731)][_0x542323(0x4d6)]='url('+_0x427a1e+')':_0x7b8def[_0x542323(0x731)]['backgroundImage']=_0x542323(0x991);}function _0x3d14cc(_0x341292){const _0x161c42=_0x5a7792;document[_0x161c42(0x233)](_0x161c42(0x5ea))[_0x161c42(0x103)](_0x2421c8=>{const _0x2bcb65=_0x161c42;_0x2421c8['classList'][_0x2bcb65(0x5cf)](_0x2bcb65(0x12ef),_0x2421c8[_0x2bcb65(0x12e1)][_0x2bcb65(0xcd3)]===_0x341292);}),document[_0x161c42(0x233)](_0x161c42(0xfcf))[_0x161c42(0x103)](_0x545504=>{const _0x4b4f5d=_0x161c42;_0x545504[_0x4b4f5d(0x418)][_0x4b4f5d(0x5cf)](_0x4b4f5d(0x12ef),_0x545504[_0x4b4f5d(0x12e1)][_0x4b4f5d(0xcd3)]===_0x341292);});}async function _0x511a09(){const _0x35a0ce=_0x5a7792,_0x503ce9=document['getElementById'](_0x35a0ce(0xf43)),_0x44a870=document['getElementById'](_0x35a0ce(0xcf9));_0x503ce9[_0x35a0ce(0xc58)]='',_0x44a870[_0x35a0ce(0xc58)]='';const [_0x485549,_0x3e050e]=await Promise[_0x35a0ce(0xfd7)]([_0x4e1bbf['worldBooks']['toArray'](),_0x4e1bbf[_0x35a0ce(0x10bb)][_0x35a0ce(0xe1d)](_0x35a0ce(0x6fc))['toArray']()]);_0x3e7a1b[_0x35a0ce(0x144)]=_0x485549;if(_0x485549[_0x35a0ce(0x40f)]===0x0){_0x44a870[_0x35a0ce(0xc58)]=_0x35a0ce(0xcb5);return;}const _0x41e879=document[_0x35a0ce(0x124e)](_0x35a0ce(0xcd));_0x41e879[_0x35a0ce(0x87d)]=_0x35a0ce(0x941),_0x41e879[_0x35a0ce(0xee5)]='全部',_0x41e879[_0x35a0ce(0x12e1)][_0x35a0ce(0xcd3)]=_0x35a0ce(0xfd7),_0x503ce9['appendChild'](_0x41e879);const _0x11008a=document[_0x35a0ce(0x124e)](_0x35a0ce(0x479));_0x11008a[_0x35a0ce(0x87d)]='world-book-category-pane\x20active',_0x11008a[_0x35a0ce(0x12e1)][_0x35a0ce(0xcd3)]=_0x35a0ce(0xfd7),_0x44a870[_0x35a0ce(0x99e)](_0x11008a),_0x3e050e['forEach'](_0x106bef=>{const _0x18d6af=_0x35a0ce,_0x482dc3=document[_0x18d6af(0x124e)](_0x18d6af(0xcd));_0x482dc3[_0x18d6af(0x87d)]=_0x18d6af(0xb89),_0x482dc3[_0x18d6af(0xee5)]=_0x106bef[_0x18d6af(0x6fc)],_0x482dc3['dataset'][_0x18d6af(0xcd3)]=String(_0x106bef['id']),_0x503ce9[_0x18d6af(0x99e)](_0x482dc3);const _0x132094=document[_0x18d6af(0x124e)]('div');_0x132094['className']='world-book-category-pane',_0x132094[_0x18d6af(0x12e1)][_0x18d6af(0xcd3)]=String(_0x106bef['id']),_0x44a870[_0x18d6af(0x99e)](_0x132094);});const _0x4b7992=_0x485549[_0x35a0ce(0x26c)](_0x1bb9ef=>!_0x1bb9ef['categoryId']);if(_0x4b7992){const _0x40671a=document[_0x35a0ce(0x124e)]('button');_0x40671a[_0x35a0ce(0x87d)]=_0x35a0ce(0xb89),_0x40671a[_0x35a0ce(0xee5)]=_0x35a0ce(0xaf0),_0x40671a['dataset'][_0x35a0ce(0xcd3)]=_0x35a0ce(0xf60),_0x503ce9[_0x35a0ce(0x99e)](_0x40671a);const _0xdc1388=document['createElement'](_0x35a0ce(0x479));_0xdc1388[_0x35a0ce(0x87d)]=_0x35a0ce(0xc2f),_0xdc1388[_0x35a0ce(0x12e1)]['categoryId']=_0x35a0ce(0xf60),_0x44a870['appendChild'](_0xdc1388);}_0x485549[_0x35a0ce(0x103)](_0x10f7b7=>{const _0x311c30=_0x35a0ce;let _0x3e60cf=_0x311c30(0x2db);if(Array['isArray'](_0x10f7b7[_0x311c30(0x3ba)])&&_0x10f7b7[_0x311c30(0x3ba)][_0x311c30(0x40f)]>0x0){const _0x182b31=_0x10f7b7[_0x311c30(0x3ba)][0x0];_0x3e60cf=_0x182b31['comment']||_0x182b31[_0x311c30(0x3ba)]||'';}else typeof _0x10f7b7[_0x311c30(0x3ba)]===_0x311c30(0x1251)&&_0x10f7b7[_0x311c30(0x3ba)][_0x311c30(0x43a)]()!==''&&(_0x3e60cf=_0x10f7b7[_0x311c30(0x3ba)]);const _0x3d529a=document[_0x311c30(0x124e)](_0x311c30(0x479));_0x3d529a[_0x311c30(0x87d)]='world-book-card',_0x3d529a[_0x311c30(0xc58)]=_0x311c30(0xb62)+_0x10f7b7[_0x311c30(0x6fc)]+_0x311c30(0x24e)+_0x3e60cf+_0x311c30(0x7e4);const _0x131b56=()=>_0x1d54a3(_0x10f7b7['id']),_0x19f6b0=async()=>{const _0x2ed900=_0x311c30,_0x2df2d1=await _0x54149f(_0x2ed900(0x1068),_0x2ed900(0x115a)+_0x10f7b7[_0x2ed900(0x6fc)]+'》吗？',{'confirmButtonClass':_0x2ed900(0xeed)});_0x2df2d1&&(await _0x4e1bbf[_0x2ed900(0x144)]['delete'](_0x10f7b7['id']),_0x3e7a1b['worldBooks']=_0x3e7a1b[_0x2ed900(0x144)][_0x2ed900(0x156)](_0x2c7b7e=>_0x2c7b7e['id']!==_0x10f7b7['id']),_0x511a09());};_0x3d529a[_0x311c30(0xf72)](_0x311c30(0x1080),_0x131b56),_0xb407a5(_0x3d529a,_0x19f6b0);const _0x3e6d2d=_0x3d529a[_0x311c30(0xc66)](!![]);_0x3e6d2d['addEventListener'](_0x311c30(0x1080),_0x131b56),_0xb407a5(_0x3e6d2d,_0x19f6b0),_0x11008a[_0x311c30(0x99e)](_0x3e6d2d);const _0x41ee50=_0x10f7b7[_0x311c30(0xcd3)]?String(_0x10f7b7['categoryId']):_0x311c30(0xf60),_0x3af5e7=_0x44a870[_0x311c30(0x49c)]('.world-book-category-pane[data-category-id=\x22'+_0x41ee50+'\x22]');_0x3af5e7&&_0x3af5e7[_0x311c30(0x99e)](_0x3d529a);}),document[_0x35a0ce(0x233)]('.world-book-tab')['forEach'](_0x9541ab=>{const _0x3512ad=_0x35a0ce;_0x9541ab[_0x3512ad(0xf72)](_0x3512ad(0x1080),()=>_0x3d14cc(_0x9541ab[_0x3512ad(0x12e1)]['categoryId']));});}function _0x35f083(_0xea15d4,_0x5564f8){const _0x5eb565=_0x5a7792,_0x4d7471=document[_0x5eb565(0x124e)](_0x5eb565(0x479));_0x4d7471[_0x5eb565(0x87d)]=_0x5eb565(0xa6f),_0x4d7471[_0x5eb565(0xc58)]=_0x5eb565(0x949)+_0xea15d4+_0x5eb565(0x853);const _0x5a691a=_0x4d7471[_0x5eb565(0x49c)](_0x5eb565(0xd19));return _0x5564f8['sort']((_0x39a122,_0x5ac40f)=>_0x39a122[_0x5eb565(0x6fc)][_0x5eb565(0x107)](_0x5ac40f['name'],_0x5eb565(0x6ec))),_0x5564f8[_0x5eb565(0x103)](_0x2bae66=>{const _0x2ee765=_0x5eb565;let _0xd08ae4='暂无内容...';if(Array[_0x2ee765(0x97e)](_0x2bae66[_0x2ee765(0x3ba)])&&_0x2bae66[_0x2ee765(0x3ba)][_0x2ee765(0x40f)]>0x0){const _0x401742=_0x2bae66[_0x2ee765(0x3ba)][0x0];_0xd08ae4=_0x401742[_0x2ee765(0x652)]||_0x401742['content']||'';}else typeof _0x2bae66[_0x2ee765(0x3ba)]===_0x2ee765(0x1251)&&_0x2bae66[_0x2ee765(0x3ba)][_0x2ee765(0x43a)]()!==''&&(_0xd08ae4=_0x2bae66[_0x2ee765(0x3ba)]);const _0x28384f=document[_0x2ee765(0x124e)]('div');_0x28384f[_0x2ee765(0x87d)]=_0x2ee765(0x13b3),_0x28384f[_0x2ee765(0x12e1)][_0x2ee765(0xa06)]=_0x2bae66['id'],_0x28384f['innerHTML']=_0x2ee765(0x819)+_0x2bae66[_0x2ee765(0x6fc)]+_0x2ee765(0x325)+String(_0xd08ae4)[_0x2ee765(0x126f)](0x0,0x32)+_0x2ee765(0x7e4),_0x28384f['addEventListener'](_0x2ee765(0x1080),()=>_0x1d54a3(_0x2bae66['id'])),_0xb407a5(_0x28384f,async()=>{const _0x3b0933=_0x2ee765,_0x2cfb99=await _0x54149f(_0x3b0933(0x1068),_0x3b0933(0x115a)+_0x2bae66[_0x3b0933(0x6fc)]+'》吗？此操作不可撤销。',{'confirmButtonClass':_0x3b0933(0xeed)});_0x2cfb99&&(await _0x4e1bbf[_0x3b0933(0x144)][_0x3b0933(0x3aa)](_0x2bae66['id']),_0x3e7a1b[_0x3b0933(0x144)]=_0x3e7a1b[_0x3b0933(0x144)][_0x3b0933(0x156)](_0x4eb873=>_0x4eb873['id']!==_0x2bae66['id']),_0x511a09());}),_0x5a691a[_0x2ee765(0x99e)](_0x28384f);}),_0x4d7471;}window[_0x5a7792(0x257)]=_0x511a09;async function _0x1d54a3(_0x39f860){const _0x44fd76=_0x5a7792;_0xddd8ae(_0x44fd76(0xd16)),_0x59a97d=_0x39f860;const [_0x57e490,_0x16500c]=await Promise['all']([_0x4e1bbf['worldBooks']['get'](_0x39f860),_0x4e1bbf[_0x44fd76(0x10bb)]['toArray']()]);if(!_0x57e490){console[_0x44fd76(0xc60)](_0x44fd76(0x405),_0x39f860),_0xddd8ae(_0x44fd76(0x389));return;}document[_0x44fd76(0x64f)](_0x44fd76(0xc0a))[_0x44fd76(0xee5)]=_0x57e490[_0x44fd76(0x6fc)],document['getElementById'](_0x44fd76(0x919))[_0x44fd76(0xbed)]=_0x57e490[_0x44fd76(0x6fc)];const _0xd19b86=document[_0x44fd76(0x64f)](_0x44fd76(0x6c1));_0xd19b86[_0x44fd76(0xc58)]=_0x44fd76(0xab5),_0x16500c[_0x44fd76(0x103)](_0x25a428=>{const _0x52d554=_0x44fd76,_0x1f2838=document['createElement']('option');_0x1f2838['value']=_0x25a428['id'],_0x1f2838[_0x52d554(0xee5)]=_0x25a428[_0x52d554(0x6fc)];if(_0x57e490[_0x52d554(0xcd3)]===_0x25a428['id'])_0x1f2838[_0x52d554(0xbe6)]=!![];_0xd19b86[_0x52d554(0x99e)](_0x1f2838);});const _0x3f2096=document[_0x44fd76(0x64f)](_0x44fd76(0x10e8));_0x3f2096[_0x44fd76(0xc58)]='',Array[_0x44fd76(0x97e)](_0x57e490['content'])&&_0x57e490['content']['length']>0x0?_0x57e490[_0x44fd76(0x3ba)][_0x44fd76(0x103)](_0x28b2f0=>{const _0x18758f=_0x44fd76,_0x155eb4=_0x20cd0b(_0x28b2f0);_0x3f2096[_0x18758f(0x99e)](_0x155eb4);}):_0x3f2096[_0x44fd76(0xc58)]=_0x44fd76(0x90d);}async function _0x8ea9d0(_0x33f029=!![]){const _0x39e8ac=_0x5a7792,_0x2cd401=document[_0x39e8ac(0x64f)](_0x39e8ac(0x36a)),_0x3441d5=document[_0x39e8ac(0x64f)]('sticker-category-tabs'),_0x53067a=document[_0x39e8ac(0x64f)](_0x39e8ac(0xb6b)),_0x57fb67=_0x53067a['value'][_0x39e8ac(0x43a)]()[_0x39e8ac(0x36d)]();if(_0x33f029){_0x3441d5['innerHTML']='';const _0x4e6e56=await _0x4e1bbf[_0x39e8ac(0xd8d)]['toArray']();_0x3441d5[_0x39e8ac(0xc58)]+=_0x39e8ac(0x772)+(_0x110329===_0x39e8ac(0xfd7)?'active':'')+'\x22\x20data-category-id=\x22all\x22>全部</button>',_0x4e6e56[_0x39e8ac(0x103)](_0x151ad3=>{const _0x52fb08=_0x39e8ac;_0x3441d5[_0x52fb08(0xc58)]+=_0x52fb08(0x772)+(_0x110329===_0x151ad3['id']?_0x52fb08(0x12ef):'')+_0x52fb08(0xb4b)+_0x151ad3['id']+'\x22>'+_0x151ad3[_0x52fb08(0x6fc)]+_0x52fb08(0x79f);}),_0x3441d5['innerHTML']+=_0x39e8ac(0x772)+(_0x110329==='uncategorized'?_0x39e8ac(0x12ef):'')+'\x22\x20data-category-id=\x22uncategorized\x22>未分类</button>';}_0x2cd401[_0x39e8ac(0xc58)]='';let _0xf4e79c;if(_0x110329===_0x39e8ac(0xfd7))_0xf4e79c=_0x3e7a1b['userStickers'];else _0x110329===_0x39e8ac(0xf60)?_0xf4e79c=_0x3e7a1b[_0x39e8ac(0xa8b)][_0x39e8ac(0x156)](_0x508179=>!_0x508179[_0x39e8ac(0xcd3)]):_0xf4e79c=_0x3e7a1b['userStickers']['filter'](_0x27c569=>_0x27c569[_0x39e8ac(0xcd3)]===_0x110329);const _0x26126f=_0x57fb67?_0xf4e79c[_0x39e8ac(0x156)](_0xc68dce=>_0xc68dce[_0x39e8ac(0x6fc)][_0x39e8ac(0x36d)]()['includes'](_0x57fb67)):_0xf4e79c;if(_0x26126f[_0x39e8ac(0x40f)]===0x0){const _0x2fa795=_0x57fb67?_0x39e8ac(0x161):_0x39e8ac(0xb43);_0x2cd401['innerHTML']=_0x39e8ac(0x193)+_0x2fa795+'</p>';return;}_0x26126f[_0x39e8ac(0x103)](_0xa9d507=>{const _0x1f94e1=_0x39e8ac,_0x2bed7e=document[_0x1f94e1(0x124e)]('div');_0x2bed7e[_0x1f94e1(0x87d)]='sticker-item',_0x2bed7e[_0x1f94e1(0x1250)]=_0xa9d507[_0x1f94e1(0x6fc)],_0x2bed7e['dataset'][_0x1f94e1(0x1d8)]=_0xa9d507['id'],_0x2bed7e[_0x1f94e1(0xc58)]=_0x1f94e1(0xdff)+_0xa9d507[_0x1f94e1(0xe52)]+_0x1f94e1(0xa2f)+_0xa9d507[_0x1f94e1(0x6fc)]+_0x1f94e1(0xd82),_0x2bed7e['addEventListener'](_0x1f94e1(0x1080),()=>{_0x1d2f20?_0x15143b(_0x2bed7e):_0xc8a379(_0xa9d507);});const _0x5d153e=document[_0x1f94e1(0x124e)](_0x1f94e1(0x479));_0x5d153e[_0x1f94e1(0x87d)]='delete-btn',_0x5d153e[_0x1f94e1(0xc58)]=_0x1f94e1(0xe81),_0x5d153e[_0x1f94e1(0x113a)]=async _0x31cf16=>{const _0x5a0285=_0x1f94e1;_0x31cf16['stopPropagation']();const _0x70c6b=await _0x54149f('删除表情',_0x5a0285(0x3d6)+_0xa9d507[_0x5a0285(0x6fc)]+'\x22\x20吗？',{'confirmButtonClass':'btn-danger'});_0x70c6b&&(await _0x4e1bbf[_0x5a0285(0xa8b)][_0x5a0285(0x3aa)](_0xa9d507['id']),_0x3e7a1b[_0x5a0285(0xa8b)]=_0x3e7a1b[_0x5a0285(0xa8b)][_0x5a0285(0x156)](_0x2e7c87=>_0x2e7c87['id']!==_0xa9d507['id']),_0x8ea9d0());},_0x2bed7e['appendChild'](_0x5d153e),_0x2cd401[_0x1f94e1(0x99e)](_0x2bed7e);});}let _0x1d2f20=![],_0x247952=new Set(),_0x282190=![],_0x22ae70=new Set(),_0x15f3ec=[],_0x544cb0=0x0;const _0x5b0b36=0x2d;let _0x4614b0=![];function _0x4a4ef4(){const _0x426a35=_0x5a7792;_0x1d2f20=!_0x1d2f20;const _0x151dd0=document['getElementById'](_0x426a35(0x36a)),_0x2e4865=document[_0x426a35(0x64f)]('manage-stickers-btn'),_0x668965=document[_0x426a35(0x64f)](_0x426a35(0x874)),_0xd01931=document['getElementById']('select-all-stickers-checkbox');_0x151dd0[_0x426a35(0x418)][_0x426a35(0x5cf)]('management-mode',_0x1d2f20),_0x1d2f20?(_0x2e4865[_0x426a35(0xee5)]='完成',_0x668965[_0x426a35(0x731)][_0x426a35(0x130)]=_0x426a35(0x1026),_0x247952[_0x426a35(0x1057)](),_0xd01931[_0x426a35(0xf1d)]=![],_0x39486c()):(_0x2e4865[_0x426a35(0xee5)]='管理',_0x668965['style'][_0x426a35(0x130)]=_0x426a35(0x1209),_0x151dd0[_0x426a35(0x233)](_0x426a35(0xa88))[_0x426a35(0x103)](_0x38ab0e=>_0x38ab0e[_0x426a35(0x418)][_0x426a35(0x1275)](_0x426a35(0xbe6))));}function _0x46631d(){const _0x462571=_0x5a7792,_0x193e61=document['getElementById'](_0x462571(0x1135)),_0x378877=_0x193e61['checked'];let _0x2c66a6;if(_0x110329===_0x462571(0xfd7))_0x2c66a6=_0x3e7a1b[_0x462571(0xa8b)];else _0x110329===_0x462571(0xf60)?_0x2c66a6=_0x3e7a1b['userStickers']['filter'](_0x59249e=>!_0x59249e['categoryId']):_0x2c66a6=_0x3e7a1b[_0x462571(0xa8b)][_0x462571(0x156)](_0x343d59=>_0x343d59[_0x462571(0xcd3)]===_0x110329);_0x2c66a6[_0x462571(0x103)](_0x141564=>{const _0x79f3fa=_0x462571,_0x50a0d7=_0x141564['id'],_0x30be30=document[_0x79f3fa(0x49c)](_0x79f3fa(0x58f)+_0x50a0d7+'\x22]');if(_0x378877){_0x247952[_0x79f3fa(0xdda)](_0x50a0d7);if(_0x30be30)_0x30be30['classList']['add']('selected');}else{_0x247952[_0x79f3fa(0x3aa)](_0x50a0d7);if(_0x30be30)_0x30be30[_0x79f3fa(0x418)]['remove']('selected');}}),_0x39486c();}function _0x39486c(){const _0x2bf0ac=_0x5a7792,_0x27b3eb=document[_0x2bf0ac(0x64f)](_0x2bf0ac(0xcb));_0x27b3eb[_0x2bf0ac(0xee5)]='删除\x20('+_0x247952['size']+')';}function _0x15143b(_0x4beb96){const _0x238d69=_0x5a7792;if(!_0x1d2f20)return;const _0x211c0c=_0x4beb96[_0x238d69(0x12e1)][_0x238d69(0x1d8)];if(!_0x211c0c)return;_0x4beb96[_0x238d69(0x418)]['toggle'](_0x238d69(0xbe6)),_0x247952['has'](_0x211c0c)?_0x247952[_0x238d69(0x3aa)](_0x211c0c):_0x247952['add'](_0x211c0c),_0x39486c();}async function _0x48fd44(){const _0x42d9d9=_0x5a7792;if(_0x247952[_0x42d9d9(0x9dd)]===0x0)return;const _0x2a8122=await _0x54149f(_0x42d9d9(0x13d2),_0x42d9d9(0x107c)+_0x247952['size']+_0x42d9d9(0xb22),{'confirmButtonClass':_0x42d9d9(0xeed)});if(_0x2a8122){const _0x380b55=[..._0x247952];await _0x4e1bbf[_0x42d9d9(0xa8b)][_0x42d9d9(0x303)](_0x380b55),_0x3e7a1b[_0x42d9d9(0xa8b)]=_0x3e7a1b[_0x42d9d9(0xa8b)]['filter'](_0x14bcbc=>!_0x380b55['includes'](_0x14bcbc['id'])),_0x4a4ef4(),_0x8ea9d0(),await _0x28974b(_0x42d9d9(0x121d),_0x42d9d9(0xda7));}}async function _0x283da4(){const _0x3e5719=_0x5a7792,_0x3ea104=_0x3e5719(0xda2),_0x91a809=await _0x41e3f8(_0x3e5719(0xe50),_0x3ea104,'',_0x3e5719(0x444));_0x91a809&&_0x91a809[_0x3e5719(0x43a)]()&&await _0x44e568(_0x91a809);}async function _0x44e568(_0x1dd86d){const _0x30bde9=_0x5a7792,_0x5d31b6=_0x1dd86d['trim']()[_0x30bde9(0x108c)]('\x0a'),_0x3bbc40=[],_0x15c28e=_0x30bde9(0x171);let _0x53ab40=0x0;const _0x4e1d15=_0x110329!==_0x30bde9(0xfd7)&&_0x110329!==_0x30bde9(0xf60)?_0x110329:null;for(const _0x139163 of _0x5d31b6){const _0x131f17=_0x139163['trim']();if(!_0x131f17||_0x131f17[_0x30bde9(0xe53)]('填入'))continue;const _0xbb95e2=_0x131f17['match'](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0xbb95e2){const _0x549914=_0xbb95e2[0x1][_0x30bde9(0x43a)](),_0x2ead6b=_0xbb95e2[0x2]['trim']();_0x3bbc40[_0x30bde9(0x13ee)]({'id':_0x30bde9(0xaa5)+Date[_0x30bde9(0x2b5)]()+Math[_0x30bde9(0x95f)](),'name':_0x549914,'url':_0x2ead6b,'categoryId':_0x4e1d15});continue;}let _0x5efad2=null,_0x1227b8=null;const _0x5746e3=_0x131f17[_0x30bde9(0x132a)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x5746e3)_0x5efad2=_0x5746e3[0x1],_0x1227b8=_0x5746e3[0x2];else{const _0x4e7d22=_0x131f17[_0x30bde9(0x108c)](/\s+/);_0x4e7d22['length']>=0x2&&(_0x1227b8=_0x4e7d22['pop'](),_0x5efad2=_0x4e7d22[_0x30bde9(0xd22)]('\x20'));}_0x5efad2&&_0x1227b8&&_0x1227b8[_0x30bde9(0xe53)]('.')?_0x3bbc40[_0x30bde9(0x13ee)]({'id':_0x30bde9(0xaa5)+Date[_0x30bde9(0x2b5)]()+Math[_0x30bde9(0x95f)](),'name':_0x5efad2,'url':_0x15c28e+_0x1227b8,'categoryId':_0x4e1d15}):(_0x53ab40++,console[_0x30bde9(0x1155)](_0x30bde9(0x1063),_0x131f17));}_0x53ab40>0x0&&await _0x28974b('部分导入失败','有\x20'+_0x53ab40+'\x20行的格式不正确，已被系统跳过。');if(_0x3bbc40[_0x30bde9(0x40f)]>0x0)await _0x4e1bbf[_0x30bde9(0xa8b)][_0x30bde9(0x36f)](_0x3bbc40),_0x3e7a1b[_0x30bde9(0xa8b)][_0x30bde9(0x13ee)](..._0x3bbc40),_0x8ea9d0(),await _0x28974b(_0x30bde9(0x583),_0x30bde9(0xc37)+_0x3bbc40[_0x30bde9(0x40f)]+'\x20个新表情！');else _0x53ab40===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}function _0xbe5c44(_0x5a9134){const _0x5cdfba=_0x5a7792,_0x4845cc=_0x5cdfba(0x15c)+_0x5a9134+'\x22]',_0x1d81ee=document[_0x5cdfba(0x49c)](_0x4845cc);_0x1d81ee?(_0x1d81ee['scrollIntoView']({'behavior':_0x5cdfba(0x4d4),'block':_0x5cdfba(0x7bd)}),_0x1d81ee[_0x5cdfba(0x418)][_0x5cdfba(0xdda)](_0x5cdfba(0xdc)),setTimeout(()=>{const _0x2bf054=_0x5cdfba;document[_0x2bf054(0x872)][_0x2bf054(0xef6)](_0x1d81ee)&&_0x1d81ee[_0x2bf054(0x418)]['remove'](_0x2bf054(0xdc));},0x5dc)):alert(_0x5cdfba(0x5e7));}async function _0x3209f4(_0x596d8,_0x168c9e){const _0x105721=_0x5a7792;if(_0x596d8['type']==='recalled_message'){const _0x17341b=document[_0x105721(0x124e)](_0x105721(0x479));_0x17341b[_0x105721(0x87d)]=_0x105721(0x1293),_0x17341b[_0x105721(0x12e1)][_0x105721(0x8af)]=_0x596d8['timestamp'];const _0x350913=document[_0x105721(0x124e)](_0x105721(0x479));return _0x350913[_0x105721(0x87d)]='message-bubble\x20recalled-message-placeholder',_0x350913['dataset'][_0x105721(0x8af)]=_0x596d8[_0x105721(0x8af)],_0x350913[_0x105721(0xee5)]=_0x596d8[_0x105721(0x3ba)],_0x17341b[_0x105721(0x99e)](_0x350913),_0xb407a5(_0x17341b,()=>_0x2bd5c2(_0x596d8[_0x105721(0x8af)])),_0x17341b[_0x105721(0xf72)](_0x105721(0x1080),()=>{const _0x267ea8=_0x105721;_0x2a27ef&&_0x2ecd49(_0x596d8[_0x267ea8(0x8af)]);}),_0x17341b;}else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0xc5d)){const _0x9878e8=document[_0x105721(0x124e)](_0x105721(0x479));_0x9878e8[_0x105721(0x87d)]=_0x105721(0x1293),_0x9878e8['dataset'][_0x105721(0x8af)]=_0x596d8['timestamp'];const _0x1b0593=document[_0x105721(0x124e)](_0x105721(0x479));return _0x1b0593[_0x105721(0x87d)]=_0x105721(0x701),_0x1b0593[_0x105721(0x12e1)][_0x105721(0x6c2)]=_0x596d8[_0x105721(0x6c2)],_0x1b0593['textContent']=_0x596d8['content'],_0x9878e8[_0x105721(0x99e)](_0x1b0593),_0xb407a5(_0x9878e8,()=>_0x2bd5c2(_0x596d8[_0x105721(0x8af)])),_0x9878e8[_0x105721(0xf72)](_0x105721(0x1080),()=>{_0x2a27ef&&_0x2ecd49(_0x596d8['timestamp']);}),_0x9878e8;}}if(_0x596d8[_0x105721(0x5cc)])return null;if(_0x596d8['type']===_0x105721(0xac1)){const _0x7b4856=document[_0x105721(0x124e)](_0x105721(0x479));_0x7b4856[_0x105721(0x87d)]=_0x105721(0x1293);const _0x59d959=document[_0x105721(0x124e)]('div');return _0x59d959[_0x105721(0x87d)]=_0x105721(0xfcc),_0x59d959[_0x105721(0x12e1)][_0x105721(0x8af)]=_0x596d8[_0x105721(0x8af)],_0x59d959[_0x105721(0xee5)]=_0x596d8[_0x105721(0x3ba)],_0x7b4856[_0x105721(0x99e)](_0x59d959),_0xb407a5(_0x7b4856,()=>_0x2bd5c2(_0x596d8['timestamp'])),_0x7b4856[_0x105721(0xf72)]('click',()=>{const _0x275c04=_0x105721;if(_0x2a27ef)_0x2ecd49(_0x596d8[_0x275c04(0x8af)]);}),_0x7b4856;}const _0x37c890=_0x596d8[_0x105721(0x931)]===_0x105721(0xa4d),_0x1f23cd=_0x168c9e[_0x105721(0xcb3)][_0x105721(0x96f)]||'我',_0x36c1fb=document[_0x105721(0x124e)](_0x105721(0x479));_0x36c1fb[_0x105721(0x87d)]=_0x105721(0xe8a)+(_0x37c890?_0x105721(0xa4d):'ai');if(_0x168c9e['isGroup']&&!_0x37c890){const _0x2bdb8a=_0x168c9e['members']['find'](_0x34d59c=>_0x34d59c[_0x105721(0x7de)]===_0x596d8[_0x105721(0x133d)]),_0x153788=document[_0x105721(0x124e)](_0x105721(0x479));_0x153788[_0x105721(0x87d)]=_0x105721(0x9b7),_0x153788[_0x105721(0xee5)]=_0x2bdb8a?_0x2bdb8a[_0x105721(0x287)]:_0x596d8[_0x105721(0x133d)]||_0x105721(0x8a0),_0x36c1fb[_0x105721(0x99e)](_0x153788);}const _0x4b533b=document[_0x105721(0x124e)](_0x105721(0x479));_0x4b533b[_0x105721(0x87d)]=_0x105721(0x8d)+(_0x37c890?_0x105721(0xa4d):'ai'),_0x4b533b[_0x105721(0x12e1)][_0x105721(0x8af)]=_0x596d8[_0x105721(0x8af)];const _0x3b1313=document[_0x105721(0x124e)](_0x105721(0xd84));_0x3b1313[_0x105721(0x87d)]=_0x105721(0x8af),_0x3b1313[_0x105721(0xee5)]=_0x56b0f0(_0x596d8[_0x105721(0x8af)]);let _0x4eda76,_0x211ecf='';if(_0x37c890)_0x4eda76=_0x168c9e[_0x105721(0xcb3)]['myAvatar']||(_0x168c9e[_0x105721(0x1167)]?_0x60cf2:_0x54e358),_0x211ecf=_0x168c9e[_0x105721(0xcb3)][_0x105721(0x5b4)]||'';else{if(_0x168c9e[_0x105721(0x1167)]){const _0x5d3622=_0x168c9e['members'][_0x105721(0x137)](_0x17b5d7=>_0x17b5d7[_0x105721(0x7de)]===_0x596d8[_0x105721(0x133d)]);if(_0x5d3622){const _0x195325=_0x3e7a1b[_0x105721(0x999)][_0x5d3622['id']];_0x4eda76=_0x5d3622[_0x105721(0x1265)]||(_0x195325?_0x195325[_0x105721(0xcb3)][_0x105721(0x93)]:_0x480024),_0x211ecf=_0x5d3622[_0x105721(0xc82)]||(_0x195325?_0x195325[_0x105721(0xcb3)][_0x105721(0xeba)]:'');}else _0x4eda76=_0x480024,_0x211ecf='';}else _0x4eda76=_0x168c9e[_0x105721(0xcb3)][_0x105721(0x93)]||_0x54e358,_0x211ecf=_0x168c9e[_0x105721(0xcb3)]['aiAvatarFrame']||'';}let _0x39ba2d;_0x211ecf?_0x39ba2d=_0x105721(0xa6d)+_0x4eda76+_0x105721(0xaaa)+_0x211ecf+_0x105721(0x609):_0x39ba2d=_0x105721(0x86)+_0x4eda76+_0x105721(0x12e9);const _0x4e733c=_0x211ecf?_0x105721(0x122):'',_0x2813c5='<div\x20class=\x22avatar-group\x20'+_0x4e733c+'\x22>'+_0x39ba2d+_0x105721(0x4b1);let _0x159c26,_0x4826d4='';if(_0x596d8[_0x105721(0x2fa)]){const _0x4a844f=_0x1409fb(_0x168c9e,_0x596d8[_0x105721(0x2fa)][_0x105721(0x133d)]),_0x12fa06=String(_0x596d8['quote'][_0x105721(0x3ba)]||'');_0x4826d4=_0x105721(0x1dd)+_0x596d8['quote'][_0x105721(0x8af)]+'\x22\x20style=\x22cursor:\x20pointer;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22quoted-sender\x22>回复\x20'+_0x4a844f+_0x105721(0xc4b)+_0x12fa06+_0x105721(0xe17);}let _0x2ed7cc=_0x596d8[_0x105721(0x3ba)];if(typeof _0x2ed7cc==='string'&&_0x2ed7cc[_0x105721(0x43a)]()[_0x105721(0x7d)]('<')&&_0x2ed7cc[_0x105721(0x43a)]()[_0x105721(0x720)]('>'))_0x159c26=_0x2ed7cc,_0x4b533b['classList'][_0x105721(0xdda)](_0x105721(0x1161));else{if(_0x596d8['type']===_0x105721(0x9cb)||_0x596d8['type']==='share_link'||_0x596d8[_0x105721(0xafc)]===_0x105721(0x132)||_0x596d8['type']===_0x105721(0x10a3)||_0x596d8[_0x105721(0xafc)]===_0x105721(0x118)||_0x596d8['type']===_0x105721(0xb11)||_0x596d8['type']===_0x105721(0xe76)||_0x596d8[_0x105721(0xafc)]===_0x105721(0xcda)||_0x596d8[_0x105721(0xafc)]===_0x105721(0x1034)||_0x596d8[_0x105721(0xafc)]===_0x105721(0xd20)||_0x596d8[_0x105721(0xafc)]==='red_packet'||_0x596d8[_0x105721(0xafc)]===_0x105721(0xcde)||_0x596d8[_0x105721(0xafc)]===_0x105721(0x11f7)||_0x596d8[_0x105721(0xafc)]===_0x105721(0x593)||_0x596d8[_0x105721(0xafc)]===_0x105721(0x13df)){if(_0x596d8[_0x105721(0xafc)]===_0x105721(0x9cb)){const _0x290f90=_0x596d8['content']||((_0x596d8['dialogue']||'')+'\x20'+(_0x596d8[_0x105721(0x9af)]||''))[_0x105721(0x43a)](),_0x2a2932=/(「.*?」|“.*?”)/g,_0x2a0a24=_0x290f90['split'](_0x2a2932)[_0x105721(0x156)](_0x2841fe=>_0x2841fe);_0x159c26=_0x2a0a24[_0x105721(0xb96)](_0x56075b=>{const _0x3dc904=_0x105721;return _0x56075b[_0x3dc904(0x7d)]('「')||_0x56075b['startsWith']('“')?_0x3dc904(0x2bc)+_0x422b3c(_0x56075b)+_0x3dc904(0x120):_0x3dc904(0xe49)+_0x422b3c(_0x56075b[_0x3dc904(0x43a)]())[_0x3dc904(0x137f)](/\n/g,_0x3dc904(0x917))+'</span>';})[_0x105721(0xd22)]('');}else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0x460))_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0xfe9),_0x105721(0x594)),_0x159c26=_0x105721(0x115f)+_0x596d8[_0x105721(0x8af)]+'\x22><div\x20class=\x22title\x22>'+(_0x596d8[_0x105721(0x1250)]||_0x105721(0x533))+'</div><div\x20class=\x22description\x22>'+(_0x596d8[_0x105721(0x9af)]||_0x105721(0x406))+_0x105721(0x1216)+(_0x596d8[_0x105721(0x4b5)]||_0x105721(0x11d5))+_0x105721(0xf57);else{if(_0x596d8[_0x105721(0xafc)]==='share_card')_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0xfe9),_0x105721(0x594)),_0x159c26=_0x105721(0x50b)+_0x596d8[_0x105721(0x8af)]+'\x22><div\x20class=\x22title\x22>'+_0x596d8[_0x105721(0x1035)][_0x105721(0x1250)]+_0x105721(0x12d2)+_0x596d8[_0x105721(0x1035)]['sharedHistory'][_0x105721(0x40f)]+_0x105721(0xa66);else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0x10a3)){_0x4b533b['classList'][_0x105721(0xdda)](_0x105721(0x8f1),_0x105721(0x594));let _0x2120f0;if(_0x596d8[_0x105721(0xd07)])_0x2120f0=_0x596d8[_0x105721(0xd07)];else _0x3e7a1b[_0x105721(0x11b4)][_0x105721(0xc83)]&&_0x596d8[_0x105721(0x242)]?_0x2120f0=_0x105721(0xb1f)+encodeURIComponent(_0x596d8[_0x105721(0x242)]):_0x2120f0='https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1756262526935_qdqqd_4uque3.jpeg';const _0x2fe569=_0x105721(0x6af)+_0x2120f0+_0x105721(0x10ca);_0x159c26='<div\x20class=\x22location-share-card\x22><div\x20class=\x22card-text-area\x22><div\x20class=\x22card-text-primary\x22>'+_0x596d8[_0x105721(0x3ba)]+'</div><div\x20class=\x22card-text-secondary\x22>位置分享</div></div><div\x20class=\x22card-map-area\x22\x20'+_0x2fe569+'><div\x20class=\x22card-pin-icon\x22><svg\x20width=\x221em\x22\x20height=\x221em\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M12\x2011.5C11.1716\x2011.5\x2010.5\x2010.8284\x2010.5\x2010C10.5\x209.17157\x2011.1716\x208.5\x2012\x208.5C12.8284\x208.5\x2013.5\x209.17157\x2013.5\x2010C13.5\x2010.8284\x2012.8284\x2011.5\x2012\x2011.5Z\x22></path><path\x20d=\x22M12\x202C7.92134\x202\x204.5\x205.42134\x204.5\x209.5C4.5\x2014.5312\x2011.2188\x2021.4375\x2011.5938\x2021.8125C11.7954\x2022.014\x2012.2046\x2022.014\x2012.4062\x2021.8125C12.7812\x2021.4375\x2019.5\x2014.5312\x2019.5\x209.5C19.5\x205.42134\x2016.0787\x202\x2012\x202ZM12\x2012.5C10.6193\x2012.5\x209.5\x2011.3807\x209.5\x2010C9.5\x208.61929\x2010.6193\x207.5\x2012\x207.5C13.3807\x207.5\x2014.5\x208.61929\x2014.5\x2010C14.5\x2011.3807\x2013.3807\x2012.5\x2012\x2012.5Z\x22></path></svg></div></div></div>';}else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0xb11)||_0x596d8[_0x105721(0xafc)]==='ai_image'){_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0xbbc),'is-card-like');const _0x4b7e53=_0x596d8[_0x105721(0xafc)]===_0x105721(0xb11)?_0x105721(0x115b):_0x105721(0x575),_0x1b1cee=_0x3e7a1b['globalSettings'][_0x105721(0xc83)]&&_0x596d8[_0x105721(0x242)]?'https://image.pollinations.ai/prompt/'+_0x596d8[_0x105721(0x242)]:_0x105721(0x716);_0x159c26=_0x105721(0x86)+_0x1b1cee+'\x22\x20class=\x22ai-generated-image\x22\x20alt=\x22'+_0x4b7e53+_0x105721(0x20a)+_0x596d8['content']+'\x22>';}else{if(_0x596d8[_0x105721(0xafc)]==='naiimag')_0x4b533b['classList'][_0x105721(0xdda)]('is-realimag',_0x105721(0x594)),_0x159c26=_0x105721(0x86)+_0x596d8[_0x105721(0xd07)]+_0x105721(0x922)+(_0x596d8[_0x105721(0x936)]||_0x596d8[_0x105721(0x1381)]||'NovelAI生成')+'\x22>';else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0xe76)){_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0x82),_0x105721(0x594));const _0x472140=Math[_0x105721(0x804)](0x1,Math[_0x105721(0xb15)]((_0x596d8[_0x105721(0x3ba)]||'')[_0x105721(0x40f)]/0x5)),_0x416be3='0:'+String(_0x472140)['padStart'](0x2,'0')+'\x27\x27',_0x5678a5=_0x105721(0x71d);if(_0x37c890)_0x159c26=_0x105721(0x499)+encodeURIComponent(_0x596d8[_0x105721(0x3ba)])+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x5678a5+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x416be3+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-transcript\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20';else{const _0xb2eace=!_0x168c9e[_0x105721(0x1167)]&&_0x168c9e[_0x105721(0xcb3)][_0x105721(0x112)]!==![],_0x1a32fe=_0x168c9e[_0x105721(0xcb3)]['minimaxVoiceId']||_0x105721(0x1cb),_0x14d138=_0xb2eace?_0x105721(0x54c)+_0x1a32fe+'\x22':'';_0x159c26='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-message-body\x22\x20data-text=\x22'+encodeURIComponent(_0x596d8['content'])+'\x22\x20'+_0x14d138+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22voice-waveform\x22>'+_0x5678a5+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22loading-spinner\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22voice-duration\x22>'+_0x416be3+_0x105721(0xcc3);}}else{if(_0x596d8['type']===_0x105721(0xcda)){_0x4b533b['classList'][_0x105721(0xdda)]('is-transfer',_0x105721(0x594));let _0x3ff0f9,_0x10ccc5;const _0x4b1d29=_0x168c9e[_0x105721(0x1167)]?_0x168c9e[_0x105721(0xcb3)][_0x105721(0x96f)]||'我':'我',_0x4b3e93=_0x1409fb(_0x168c9e,_0x596d8['senderName']),_0xda6dfb=_0x1409fb(_0x168c9e,_0x596d8[_0x105721(0xc12)]||_0x168c9e[_0x105721(0x6fc)]);if(_0x37c890){if(_0x596d8[_0x105721(0x6d)])_0x3ff0f9=_0x105721(0x209)+_0xda6dfb,_0x10ccc5=_0x105721(0x13b5);else{_0x3ff0f9='转账给\x20'+_0xda6dfb;if(_0x596d8['status']==='accepted')_0x10ccc5=_0x105721(0x106c);else{if(_0x596d8['status']===_0x105721(0x860))_0x10ccc5='对方已拒收';else _0x10ccc5=_0x596d8[_0x105721(0x939)]||_0x105721(0x9e3);}}}else{if(_0x596d8['isRefund'])_0x3ff0f9=_0x105721(0x21a)+_0x4b3e93,_0x10ccc5='转账已被拒收';else{if(_0x596d8[_0x105721(0xc12)]===_0x4b1d29){_0x3ff0f9='转账给\x20'+_0x4b1d29;if(_0x596d8['status']==='accepted')_0x10ccc5='你已收款';else{if(_0x596d8['status']==='declined')_0x10ccc5=_0x105721(0xcbd);else _0x4b533b['style']['cursor']=_0x105721(0x7fb),_0x4b533b[_0x105721(0x12e1)]['status']=_0x105721(0x8ee),_0x10ccc5=_0x596d8[_0x105721(0x939)]||_0x105721(0x662);}}else _0x3ff0f9=_0x105721(0x88c)+_0x4b3e93+_0x105721(0x82b)+_0xda6dfb,_0x10ccc5=_0x596d8[_0x105721(0x939)]||_0x105721(0xd3);}}const _0x359894=_0x105721(0x11a6);_0x159c26=_0x105721(0x986)+_0x359894+'\x20'+_0x3ff0f9+_0x105721(0x45a)+Number(_0x596d8[_0x105721(0x12fc)])[_0x105721(0xc89)](0x2)+'</div><div\x20class=\x22transfer-note\x22>'+_0x10ccc5+_0x105721(0xb86);}else{if(_0x596d8[_0x105721(0xafc)]==='waimai_request'){_0x4b533b[_0x105721(0x418)]['add'](_0x105721(0xb52),_0x105721(0x594));if(_0x596d8[_0x105721(0x69e)]===_0x105721(0x6a8)||_0x596d8[_0x105721(0x69e)]==='rejected')_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0x690)+_0x596d8[_0x105721(0x69e)]);const _0xb87738=_0x1409fb(_0x168c9e,_0x596d8[_0x105721(0x133d)]),_0x1a21ca=_0x105721(0x33a)+_0xb87738+_0x105721(0x310);let _0x3ba614='';_0x596d8[_0x105721(0x69e)]===_0x105721(0x8ee)&&!_0x37c890&&(_0x3ba614=_0x105721(0x5af)),_0x159c26=_0x105721(0x8e0)+_0x1a21ca+_0x105721(0x901)+Number(_0x596d8[_0x105721(0x12fc)])[_0x105721(0xc89)](0x2)+_0x105721(0xe96)+_0x596d8[_0x105721(0x8af)]+'\x22></div></div></div><button\x20class=\x22waimai-details-btn\x22>查看详情</button></div>'+_0x3ba614+_0x105721(0x4b1),setTimeout(()=>{const _0x28d7d5=_0x105721;if(_0x596d8['status']===_0x28d7d5(0x8ee)){const _0x373ba8=document[_0x28d7d5(0x64f)](_0x28d7d5(0x106b)+_0x596d8[_0x28d7d5(0x8af)]);if(_0x373ba8){const _0x48bac0=_0x2a31e1(_0x373ba8,_0x596d8[_0x28d7d5(0x4de)]);_0x2d89bb[_0x596d8[_0x28d7d5(0x8af)]]=_0x48bac0;}}},0x0);}else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0xd20)){_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0xb52),_0x105721(0x594));const _0x2cabf2=_0x1409fb(_0x168c9e,_0x596d8['senderName']);let _0x477dd1='你';_0x168c9e[_0x105721(0x1167)]&&(_0x477dd1=_0x1409fb(_0x168c9e,_0x596d8['recipientName'])),_0x159c26='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22https://files.catbox.moe/mq179k.png\x22\x20class=\x22icon\x22\x20alt=\x22Meituan\x20Icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title-group\x22><span\x20class=\x22brand\x22>美团外卖</span><span\x20class=\x22separator\x22>|</span><span>外卖美食</span></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22waimai-main\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22request-title\x22\x20style=\x22margin-bottom:\x2012px;\x22>'+_0x2cabf2+'\x20已为'+_0x477dd1+_0x105721(0x130f)+_0x596d8[_0x105721(0xec5)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22margin-top:\x208px;\x22>¥'+Number(_0x596d8[_0x105721(0x12fc)])[_0x105721(0xc89)](0x2)+_0x105721(0x751);}else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0xa5d)){_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)]('is-red-packet',_0x105721(0x594));const _0x118d5a=_0x3e7a1b[_0x105721(0x3c2)]['nickname']||_0x105721(0x1028),_0x39893b=_0x596d8[_0x105721(0xa62)],_0xb14fa1=_0x596d8[_0x105721(0x19f)]&&_0x596d8[_0x105721(0x19f)][_0x118d5a];let _0x437bce='',_0x657094='',_0x476b89=_0x105721(0x10a5);_0x39893b&&(_0x437bce=_0x105721(0xdb5));if(_0x596d8[_0x105721(0x13d4)]===_0x105721(0xc33)){const _0x330d79=_0x1409fb(_0x168c9e,_0x596d8['receiverName']);_0x476b89='专属红包:\x20给\x20'+_0x330d79;if(Object[_0x105721(0xc30)](_0x596d8[_0x105721(0x19f)]||{})[_0x105721(0x40f)]>0x0)_0x437bce=_0x105721(0xdb5);}if(_0xb14fa1){const _0x442e93=_0x596d8[_0x105721(0x19f)][_0x118d5a]||0x0;_0x657094=_0x105721(0xed)+_0x442e93['toFixed'](0x2)+_0x105721(0xbfc);}else{if(_0x39893b)_0x657094=_0x105721(0x693);else{if(_0x596d8[_0x105721(0x13d4)]===_0x105721(0xc33)&&Object[_0x105721(0xc30)](_0x596d8[_0x105721(0x19f)]||{})['length']>0x0){const _0x5c84ed=_0x1409fb(_0x168c9e,_0x596d8[_0x105721(0xc12)]);_0x657094='<div\x20class=\x22rp-claimed-info\x22>已被\x20'+_0x5c84ed+'\x20领取</div>';}}}_0x159c26='<div\x20class=\x22red-packet-card\x20'+_0x437bce+_0x105721(0x1205)+(_0x596d8[_0x105721(0xdf9)]||_0x105721(0xe11))+_0x105721(0x1227)+_0x476b89+'</div>'+_0x657094+_0x105721(0x4b1);}else{if(_0x596d8[_0x105721(0xafc)]===_0x105721(0xcde)){_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)]('is-poll',_0x105721(0x594));const _0x9eefbc=_0x596d8[_0x105721(0x3c7)]||_0x596d8['content']||_0x105721(0x1212);let _0x5efdb2=0x0;const _0x53d2a7={};for(const _0x51aa0a in _0x596d8['votes']){const _0xfc70ac=_0x596d8[_0x105721(0x9ad)][_0x51aa0a][_0x105721(0x40f)];_0x53d2a7[_0x51aa0a]=_0xfc70ac,_0x5efdb2+=_0xfc70ac;}const _0xfe8edc=_0x3e7a1b[_0x105721(0x3c2)][_0x105721(0x78c)]||'{{user}}';let _0x476ae8=null;for(const _0x1d7cfe in _0x596d8[_0x105721(0x9ad)]){if(_0x596d8[_0x105721(0x9ad)][_0x1d7cfe]['includes'](_0xfe8edc)){_0x476ae8=_0x1d7cfe;break;}}let _0x4149d3=_0x105721(0x411);_0x596d8[_0x105721(0x590)][_0x105721(0x103)](_0xfe2d78=>{const _0x3ad144=_0x105721,_0x307d29=_0x53d2a7[_0xfe2d78]||0x0,_0x35b48f=_0x5efdb2>0x0?_0x307d29/_0x5efdb2*0x64:0x0,_0x31311c=_0x476ae8===_0xfe2d78;_0x4149d3+=_0x3ad144(0x11eb)+(_0x31311c?_0x3ad144(0x3b6):'')+_0x3ad144(0x1255)+_0xfe2d78+_0x3ad144(0x7e8)+_0x35b48f+_0x3ad144(0x10da)+_0xfe2d78+_0x3ad144(0x1d3)+_0x307d29+_0x3ad144(0xce6);}),_0x4149d3+=_0x105721(0x4b1);let _0x55f4c8=_0x596d8[_0x105721(0x11ad)]?_0x105721(0x482)+_0x5efdb2+_0x105721(0x7ba):_0x105721(0x482)+_0x5efdb2+'\x20人投票</span><button\x20class=\x22poll-action-btn\x22>结束投票</button></div>';_0x159c26=_0x105721(0x128f)+(_0x596d8['isClosed']?_0x105721(0x9a0):'')+_0x105721(0x1128)+_0x596d8[_0x105721(0x8af)]+_0x105721(0x146)+_0x9eefbc+_0x105721(0x4b1)+_0x4149d3+_0x55f4c8+_0x105721(0x4b1);}else{if(_0x596d8['type']===_0x105721(0x11f7)){_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0x1e3),_0x105721(0x594));let _0x354127;const _0x446ff9=_0x168c9e[_0x105721(0xcb3)][_0x105721(0x96f)]||'我';if(_0x168c9e[_0x105721(0x1167)]){if(_0x596d8[_0x105721(0xc8e)]&&_0x596d8[_0x105721(0xc8e)][_0x105721(0x40f)]>0x0){const _0x29d6b8=_0x596d8[_0x105721(0xc8e)]['map'](_0x1a2af6=>_0x1409fb(_0x168c9e,_0x1a2af6));_0x29d6b8[_0x105721(0x40f)]===0x1?_0x354127='送给\x20'+_0x29d6b8[0x0]+_0x105721(0x1087):_0x354127=_0x105721(0x1a3)+_0x29d6b8[_0x105721(0xdf5)](0x0,0x2)['join']('、')+_0x105721(0x451);}else _0x354127=_0x105721(0x97f);}else{if(_0x37c890)_0x354127=_0x105721(0x1a3)+_0x168c9e[_0x105721(0x6fc)]+_0x105721(0x1087);else{const _0x54f256=_0x168c9e[_0x105721(0xcb3)][_0x105721(0x96f)]||'你';_0x354127=_0x105721(0x1a3)+_0x54f256+_0x105721(0x1087);}}const _0x2ba5d0=_0x596d8[_0x105721(0xd8c)][_0x105721(0xdf5)](0x0,0x3);let _0x5a9216='';_0x2ba5d0[_0x105721(0x103)](_0x40d0b9=>{const _0x476bef=_0x105721;_0x5a9216+=_0x476bef(0x501)+_0x40d0b9[_0x476bef(0xd07)]+_0x476bef(0xceb)+_0x40d0b9[_0x476bef(0x6fc)]+'</span><span\x20class=\x22gift-preview-quantity\x22>x'+_0x40d0b9['quantity']+_0x476bef(0x71a);});let _0x381d77='';_0x596d8[_0x105721(0xd8c)]['length']>0x3&&(_0x381d77='\x20等'+_0x596d8[_0x105721(0xd8c)][_0x105721(0x40f)]+_0x105721(0x828)),_0x159c26=_0x105721(0xa97)+_0x354127+_0x105721(0xce1)+_0x5a9216+_0x105721(0xd8f)+_0x596d8[_0x105721(0xd8c)][_0x105721(0x40f)]+'件商品'+_0x381d77+_0x105721(0x185);}}}}}}}}}}}}}}else{const _0x5539f4=String(_0x2ed7cc);let _0x1ff340=await _0x4e596c(_0x5539f4,_0x168c9e['id']);if(_0x1ff340!==_0x5539f4)_0x159c26=_0x1ff340,_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0x594));else{if(Array[_0x105721(0x97e)](_0x596d8[_0x105721(0x3ba)])&&_0x596d8[_0x105721(0x3ba)][0x0]?.[_0x105721(0xafc)]==='image_url'){const _0x1cd7d2=_0x596d8[_0x105721(0x3ba)][0x0][_0x105721(0x6da)]['url'];_0x159c26='<img\x20src=\x22'+_0x1cd7d2+'\x22\x20class=\x22chat-image\x22>';}else{if(_0x442b6b[_0x105721(0x4af)](_0x1ff340))_0x4b533b[_0x105721(0x418)][_0x105721(0xdda)](_0x105721(0x102a),'is-card-like'),_0x159c26=_0x105721(0x86)+_0x1ff340+_0x105721(0xa7b)+(_0x596d8[_0x105721(0x10b3)]||_0x105721(0x8e3))+_0x105721(0x80);else{let _0x3e4f3e=_0x1ba418(_0x1ff340,_0x168c9e);_0x159c26=_0x422b3c(_0x3e4f3e)[_0x105721(0x137f)](/\n/g,_0x105721(0x917));}}}}}_0x4b533b[_0x105721(0xc58)]=_0x105721(0x783)+_0x2813c5+_0x105721(0x1062)+_0x4826d4+_0x105721(0x1295)+_0x159c26+_0x105721(0x7c2),_0x36c1fb['appendChild'](_0x4b533b),_0x36c1fb[_0x105721(0x99e)](_0x3b1313),_0xb407a5(_0x36c1fb,()=>_0x2bd5c2(_0x596d8['timestamp'])),_0x36c1fb[_0x105721(0xf72)]('click',()=>{const _0x20522a=_0x105721;if(_0x2a27ef)_0x2ecd49(_0x596d8[_0x20522a(0x8af)]);});if(!_0x37c890){const _0x4791da=_0x36c1fb['querySelector']('.avatar-group');_0x4791da&&(_0x4791da[_0x105721(0x731)][_0x105721(0x1101)]=_0x105721(0x7fb),!_0x168c9e[_0x105721(0x1167)]?_0x4791da[_0x105721(0xf72)]('click',_0xd98a88=>{const _0x4dfd3c=_0x105721;_0xd98a88[_0x4dfd3c(0x61c)](),_0x267b3d(_0x168c9e['id']);}):_0x4791da[_0x105721(0xf72)]('dblclick',_0x265373=>{const _0x4564ef=_0x105721;_0x265373[_0x4564ef(0x61c)](),_0x4601ee(_0x168c9e['id'],_0x596d8['senderName']);}));}return _0x36c1fb;}async function _0x18c221(_0x10940d,_0x49f56d){const _0x2038b2=_0x5a7792,_0x42ff6b=document[_0x2038b2(0x64f)](_0x2038b2(0x207)),_0x38325e=await _0x3209f4(_0x10940d,_0x49f56d);if(!_0x38325e)return;const _0x3952a8=document[_0x2038b2(0x64f)]('load-more-btn');_0x3952a8?_0x42ff6b[_0x2038b2(0xf4a)](_0x38325e,_0x3952a8[_0x2038b2(0xc17)]):_0x42ff6b['prepend'](_0x38325e);}async function _0x3c7e84(_0x203750,_0x2d5c49,_0xaaa3b4=![]){const _0x16ca11=_0x5a7792,_0x5f24e8=document[_0x16ca11(0x64f)]('chat-messages'),_0x22c6f7=document[_0x16ca11(0x64f)](_0x16ca11(0x5d1)),_0x4f5678=_0x2d5c49[_0x16ca11(0x830)][_0x16ca11(0x156)](_0x5a5edf=>!_0x5a5edf[_0x16ca11(0x5cc)])[_0x16ca11(0xa90)]();if(_0x4f5678&&_0x203750[_0x16ca11(0x8af)]-_0x4f5678['timestamp']>0x927c0){const _0x36753f=_0x100722(_0x203750[_0x16ca11(0x8af)]);_0x5f24e8[_0x16ca11(0xf4a)](_0x36753f,_0x22c6f7);}const _0x5a341a=await _0x3209f4(_0x203750,_0x2d5c49);if(!_0x5a341a)return;_0x203750[_0x16ca11(0x931)]===_0x16ca11(0x12c3)&&!_0xaaa3b4&&_0x5e1ec8(),!_0xaaa3b4&&_0x5a341a[_0x16ca11(0x418)][_0x16ca11(0xdda)]('animate-in'),_0x5f24e8[_0x16ca11(0xf4a)](_0x5a341a,_0x22c6f7),!_0xaaa3b4&&(_0x5f24e8[_0x16ca11(0xed7)]=_0x5f24e8['scrollHeight'],_0x10081e++);}async function _0x59a090(_0x55428b){const _0x55f307=_0x5a7792;_0x3e7a1b[_0x55f307(0x777)]=_0x55428b;const _0x50cd1d=_0x3e7a1b[_0x55f307(0x999)][_0x55428b];if(!_0x50cd1d)return;_0x50cd1d[_0x55f307(0x13c0)]>0x0&&(_0x50cd1d[_0x55f307(0x13c0)]=0x0,await _0x4e1bbf[_0x55f307(0x999)][_0x55f307(0x4fa)](_0x50cd1d));_0x227ea7(_0x50cd1d),_0x4817d1(_0x55428b),_0xddd8ae(_0x55f307(0x9aa)),window[_0x55f307(0x7b8)](_0x3e7a1b[_0x55f307(0x777)]);const _0x510caf=_0x50cd1d[_0x55f307(0x1167)]||![];_0x28e158(_0x510caf),document['getElementById'](_0x55f307(0xdfe))[_0x55f307(0x731)][_0x55f307(0x130)]=_0x510caf?_0x55f307(0x1026):'none';const _0x4c0050=document[_0x55f307(0x64f)](_0x55f307(0x118c));_0x4c0050&&(_0x4c0050[_0x55f307(0x731)]['display']=_0x510caf?'none':_0x55f307(0x1026));const _0x5a7d94=document[_0x55f307(0x64f)](_0x55f307(0xaca)),_0x24b5b8=document[_0x55f307(0x64f)](_0x55f307(0x130c)),_0x246f49=document[_0x55f307(0x64f)](_0x55f307(0x1011)),_0x34dd8a=document[_0x55f307(0x64f)](_0x55f307(0x1215));_0x24b5b8&&_0x246f49&&_0x34dd8a&&_0x5a7d94&&(_0x24b5b8['style']['display']=_0x55f307(0x1026),_0x246f49[_0x55f307(0x731)]['display']=_0x510caf?_0x55f307(0x1209):_0x55f307(0x1026),_0x34dd8a[_0x55f307(0x731)][_0x55f307(0x130)]=_0x510caf?_0x55f307(0x1026):_0x55f307(0x1209),_0x5a7d94[_0x55f307(0x731)]['display']=_0x510caf?_0x55f307(0x1209):'flex'),_0x1cc461(),!_0x50cd1d['isGroup']&&_0x50cd1d[_0x55f307(0x55f)]?.[_0x55f307(0x69e)]===_0x55f307(0x943)&&(console['log'](_0x55f307(0x1237)+_0x50cd1d['name']+'\x22\x20自动触发AI响应...'),_0x20a638()),document[_0x55f307(0x64f)](_0x55f307(0x1181))['style'][_0x55f307(0x130)]=_0x510caf?_0x55f307(0x1026):_0x55f307(0x1209);}function _0x570655(_0x18e7d7,_0x25e238){const _0x33280f=_0x5a7792,_0x4be2d7=_0x25e238?'add':'remove',_0x49e345=_0x1afd53=>{const _0x206352=_0x2bd6;_0x1afd53&&_0x1afd53[_0x206352(0x418)][_0x4be2d7](_0x206352(0x83d));},_0x543ebb=document[_0x33280f(0x49c)]('.chat-list-item[data-chat-id=\x22'+_0x18e7d7+'\x22]\x20.avatar');_0x49e345(_0x543ebb);const _0x1e7979=document[_0x33280f(0x233)](_0x33280f(0x488)+_0x18e7d7+'\x22]');_0x1e7979[_0x33280f(0x103)](_0x49e345);const _0x343b60=document[_0x33280f(0x49c)](_0x33280f(0x67a)+_0x18e7d7+'\x22]');_0x49e345(_0x343b60);}async function _0x4ce7a9(){const _0x2cbfe4=_0x5a7792;if(!_0x3e7a1b[_0x2cbfe4(0x777)])return;const _0x366113=_0x3e7a1b[_0x2cbfe4(0x777)],_0x1151fa=_0x3e7a1b[_0x2cbfe4(0x999)][_0x366113];lastRawAiResponse='',lastResponseTimestamps=[];const _0x401549=document[_0x2cbfe4(0x64f)](_0x2cbfe4(0x602));_0x401549&&(_0x401549[_0x2cbfe4(0x1b0)]=!![],_0x401549[_0x2cbfe4(0xee5)]=_0x2cbfe4(0xfb8));_0x570655(_0x366113,!![]);try{const {proxyUrl:_0x5b2932,apiKey:_0x492380,model:_0x5ce2dc}=_0x3e7a1b[_0x2cbfe4(0xec0)];if(!_0x5b2932||!_0x492380||!_0x5ce2dc)throw new Error(_0x2cbfe4(0x524));const _0x3524da=parseInt(_0x1151fa[_0x2cbfe4(0xcb3)][_0x2cbfe4(0xd50)])||0xa,_0x1c441b=_0x1151fa['history'][_0x2cbfe4(0xdf5)](-_0x3524da);let _0x33c825='';if(_0x1151fa[_0x2cbfe4(0xcb3)]['linkedWorldBookIds']&&_0x1151fa[_0x2cbfe4(0xcb3)][_0x2cbfe4(0xde4)][_0x2cbfe4(0x40f)]>0x0){const _0x2de4fb=_0x1151fa[_0x2cbfe4(0xcb3)][_0x2cbfe4(0xde4)][_0x2cbfe4(0xb96)](_0x108f9a=>{const _0x18803f=_0x2cbfe4,_0x2c77cd=_0x3e7a1b['worldBooks'][_0x18803f(0x137)](_0x4c5190=>_0x4c5190['id']===_0x108f9a);if(!_0x2c77cd||!Array['isArray'](_0x2c77cd['content']))return'';const _0x2f786f=_0x2c77cd[_0x18803f(0x3ba)][_0x18803f(0x156)](_0x33da49=>_0x33da49[_0x18803f(0x9b)]!==![])['map'](_0x2806aa=>{const _0x497120=_0x18803f;let _0x3ed5ca=_0x497120(0x265)+(_0x2806aa[_0x497120(0x652)]||'无备注')+'\x0a';if(_0x2806aa['keys'][_0x497120(0x40f)]>0x0)_0x3ed5ca+='**关键词:**\x20'+_0x2806aa[_0x497120(0xc30)][_0x497120(0xd22)](',\x20')+'\x0a';return _0x3ed5ca+=_0x497120(0x188)+_0x2806aa[_0x497120(0x3ba)],_0x3ed5ca;})[_0x18803f(0xd22)]('');return _0x2f786f?_0x18803f(0x228)+_0x2c77cd[_0x18803f(0x6fc)]+'\x0a'+_0x2f786f:'';})[_0x2cbfe4(0x156)](Boolean)['join']('');_0x2de4fb&&(_0x33c825=_0x2cbfe4(0x13cc)+_0x2de4fb+_0x2cbfe4(0xf0f));}let _0x154251='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x188260=![];_0x1151fa[_0x2cbfe4(0x5d4)]['forEach'](_0x2186b9=>{const _0x39a944=_0x2cbfe4,_0x338d84=_0x3e7a1b['chats'][_0x2186b9['id']];_0x338d84&&_0x338d84['longTermMemory']&&_0x338d84[_0x39a944(0x518)]['length']>0x0&&(_0x154251+=_0x39a944(0xf23)+_0x2186b9[_0x39a944(0x287)]+_0x39a944(0x7c7),_0x154251+=_0x338d84['longTermMemory'][_0x39a944(0xb96)](_0xd1b1b7=>_0x39a944(0x56b)+_0x4942eb(_0xd1b1b7[_0x39a944(0x8af)])+')\x20'+_0xd1b1b7[_0x39a944(0x3ba)])[_0x39a944(0xd22)]('\x0a'),_0x188260=!![]);});!_0x188260&&(_0x154251+=_0x2cbfe4(0xd0b));let _0x575c67='';const _0x1ca16c=_0x1151fa[_0x2cbfe4(0xcb3)]['linkedMemoryCount']||0xa;if(_0x1151fa['settings'][_0x2cbfe4(0x4d8)]&&_0x1151fa[_0x2cbfe4(0xcb3)]['linkedMemoryChatIds'][_0x2cbfe4(0x40f)]>0x0){}const _0x1cd83a=_0x1151fa['members'][_0x2cbfe4(0xb96)](_0x5a0014=>_0x2cbfe4(0x8d8)+_0x5a0014[_0x2cbfe4(0x287)]+_0x2cbfe4(0x19a)+_0x5a0014[_0x2cbfe4(0x7de)]+_0x2cbfe4(0xc1c)+_0x5a0014[_0x2cbfe4(0x324)])[_0x2cbfe4(0xd22)]('\x0a'),_0x565fc2=_0x2beb71(_0x1151fa),_0x52e6ee=_0x2cbfe4(0xd75)+_0x1151fa['name']+'”的群聊中的对话。这个群聊里【没有用户】，所有成员都是你扮演的角色。你的任务是让他们之间进行一场生动、自然的对话。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组。\x0a-\x20数组中的每个对象都【必须】包含\x20\x22type\x22\x20字段和\x20\x22name\x22\x20字段（角色的【本名】）。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**【角色间互动\x20(最重要!)】**:\x20你的核心是创作一场“戏”。角色之间【必须】互相回应、补充或反驳，形成自然的讨论。严禁生成仅分别自言自语的独白。\x0a2.\x20\x20**【禁止出戏】**:\x20绝不能透露你是AI、模型或剧本作家。\x0a3.\x20\x20**【主动性】**:\x20角色们应该主动使用各种功能（发表情、发语音、分享图片等）来让对话更生动，而不是仅仅发送文字。\x0a4.请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a#\x20可用指令列表\x20(你现在可以使用所有这些功能！)\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字内容\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22target_timestamp\x22:\x20消息时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a\x0a#\x20当前群聊信息\x0a-\x20**群名称**:\x20'+_0x1151fa[_0x2cbfe4(0x6fc)]+_0x2cbfe4(0x1049)+_0x154251+'\x0a'+_0x33c825+'\x0a'+_0x575c67+_0x2cbfe4(0xa82)+_0x1c441b[_0x2cbfe4(0xb96)](_0x4ebc6e=>_0x1409fb(_0x1151fa,_0x4ebc6e[_0x2cbfe4(0x133d)])+':\x20'+_0x4ebc6e[_0x2cbfe4(0x3ba)])['join']('\x0a')+'\x0a\x0a#\x20群成员列表及人设\x20(你扮演的所有角色)\x0a'+_0x1cd83a+_0x2cbfe4(0x13e2)+_0x565fc2+'\x0a现在，请根据以上所有信息，继续这场没有用户参与的群聊，并自由地使用各种指令来丰富你们的互动。\x0a',_0x5bcd02=_0x1c441b[_0x2cbfe4(0xb96)](_0x22d5e6=>({'role':_0x2cbfe4(0xa4d),'content':_0x1409fb(_0x1151fa,_0x22d5e6['senderName'])+':\x20'+_0x22d5e6['content']}));let _0x22ab2a=_0x5b2932[_0x2cbfe4(0xe53)](_0x2cbfe4(0x17e)),_0x2293fb;if(_0x22ab2a){let _0x431d7c=_0x250668(_0x5ce2dc,_0x492380,_0x52e6ee,_0x5bcd02);_0x2293fb=await fetch(_0x431d7c[_0x2cbfe4(0xe52)],_0x431d7c['data']);}else _0x2293fb=await fetch(_0x5b2932+_0x2cbfe4(0x58b),{'method':_0x2cbfe4(0x2d1),'headers':{'Content-Type':_0x2cbfe4(0x7fe),'Authorization':_0x2cbfe4(0x236)+_0x492380},'body':JSON['stringify']({'model':_0x5ce2dc,'messages':[{'role':_0x2cbfe4(0x905),'content':_0x52e6ee},..._0x5bcd02],'temperature':_0x3e7a1b[_0x2cbfe4(0x11b4)][_0x2cbfe4(0xa55)]||0.9})});if(!_0x2293fb['ok']){const _0x4b2177=await _0x2293fb[_0x2cbfe4(0x6f8)]()[_0x2cbfe4(0x1201)](()=>({'error':{'message':_0x2293fb[_0x2cbfe4(0x132c)]}}));throw new Error('API\x20请求失败:\x20'+_0x2293fb['status']+'\x20-\x20'+(_0x4b2177[_0x2cbfe4(0xc60)]?.[_0x2cbfe4(0x854)]||'未知错误'));}const _0x2bb359=await _0x2293fb['json'](),_0x10da3e=getGeminiResponseText(_0x2bb359);lastRawAiResponse=_0x10da3e;const _0x55bf6e=_0x3755ce(_0x10da3e);let _0x5c2941=Date[_0x2cbfe4(0x2b5)]();for(const _0x252273 of _0x55bf6e){if(!_0x252273||!_0x252273[_0x2cbfe4(0xafc)]||!_0x252273[_0x2cbfe4(0x6fc)])continue;let _0x3d6d03=null;const _0x26068b=_0x5c2941++;lastResponseTimestamps[_0x2cbfe4(0x13ee)](_0x26068b);const _0x2fc2c2={'role':_0x2cbfe4(0x12c3),'senderName':_0x252273[_0x2cbfe4(0x6fc)],'timestamp':_0x26068b};switch(_0x252273[_0x2cbfe4(0xafc)]){case _0x2cbfe4(0x673):_0x3d6d03={..._0x2fc2c2,'content':_0x252273['content']};break;case _0x2cbfe4(0xefb):if(_0x252273[_0x2cbfe4(0x10b3)]){const _0x3d37fe=_0x3e7a1b[_0x2cbfe4(0xa8b)]['find'](_0x29fd91=>_0x29fd91[_0x2cbfe4(0x6fc)]===_0x252273['meaning']);_0x3d37fe?_0x3d6d03={..._0x2fc2c2,'type':_0x2cbfe4(0xefb),'content':_0x3d37fe[_0x2cbfe4(0xe52)],'meaning':_0x3d37fe[_0x2cbfe4(0x6fc)]}:(console[_0x2cbfe4(0x1155)](_0x2cbfe4(0x4a8)+_0x252273[_0x2cbfe4(0x10b3)]+'\x22'),_0x3d6d03={..._0x2fc2c2,'type':_0x2cbfe4(0x673),'content':_0x2cbfe4(0x7af)+_0x252273[_0x2cbfe4(0x10b3)]+']'});}else console[_0x2cbfe4(0x1155)](_0x2cbfe4(0xa29),_0x252273);break;case _0x2cbfe4(0x118):_0x3d6d03={..._0x2fc2c2,'type':_0x2cbfe4(0x118),'content':_0x252273['description'],'image_prompt':_0x252273[_0x2cbfe4(0x242)]};break;case _0x2cbfe4(0xe76):_0x3d6d03={..._0x2fc2c2,'type':'voice_message','content':_0x252273['content']};break;case _0x2cbfe4(0x94d):const _0x36d53c=_0x1151fa[_0x2cbfe4(0x830)][_0x2cbfe4(0x137)](_0x18fd16=>_0x18fd16[_0x2cbfe4(0x8af)]===_0x252273[_0x2cbfe4(0xf0b)]);_0x36d53c?_0x3d6d03={..._0x2fc2c2,'content':_0x252273[_0x2cbfe4(0x13d3)],'quote':{'timestamp':_0x36d53c['timestamp'],'senderName':_0x36d53c['senderName'],'content':String(_0x36d53c['content']||'')[_0x2cbfe4(0x126f)](0x0,0x32)}}:_0x3d6d03={..._0x2fc2c2,'content':_0x252273[_0x2cbfe4(0x13d3)]};break;default:console[_0x2cbfe4(0x1155)](_0x2cbfe4(0xe1f),_0x252273[_0x2cbfe4(0xafc)]);continue;}_0x3d6d03&&(_0x1151fa[_0x2cbfe4(0x830)][_0x2cbfe4(0x13ee)](_0x3d6d03),_0x3c7e84(_0x3d6d03,_0x1151fa),await new Promise(_0x6061f6=>setTimeout(_0x6061f6,Math[_0x2cbfe4(0x95f)]()*0x4b0+0x320)));}await _0x4e1bbf[_0x2cbfe4(0x999)][_0x2cbfe4(0x4fa)](_0x1151fa),_0x21f6ea();}catch(_0x5f2b11){console[_0x2cbfe4(0xc60)]('旁观模式推进剧情失败:',_0x5f2b11),await _0x28974b(_0x2cbfe4(0x5b1),'无法推进剧情:\x20'+_0x5f2b11['message']);}finally{_0x401549&&(_0x401549[_0x2cbfe4(0x1b0)]=![],_0x401549[_0x2cbfe4(0xee5)]=_0x2cbfe4(0x422)),_0x570655(_0x366113,![]);}}async function _0x20a638(){const _0x5b8566=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x57a0d8=_0x3e7a1b[_0x5b8566(0x777)],_0x3ac84f=_0x3e7a1b['chats'][_0x3e7a1b[_0x5b8566(0x777)]],_0x2551f7=document['getElementById']('chat-interface-screen')['classList'][_0x5b8566(0xef6)]('active')&&_0x3e7a1b[_0x5b8566(0x777)]===_0x57a0d8;_0x570655(_0x57a0d8,!![]);const _0x58c2c1=document[_0x5b8566(0x64f)](_0x5b8566(0x11ec)),_0x1a1c76=document[_0x5b8566(0x64f)](_0x5b8566(0x5d1)),_0x6d7213=document['querySelector'](_0x5b8566(0xb48)+_0x57a0d8+'\x22]'),_0x3b338a=_0x6d7213?_0x6d7213[_0x5b8566(0x49c)](_0x5b8566(0xb64)):null;_0x3b338a&&_0x3b338a[_0x5b8566(0x418)][_0x5b8566(0xdda)](_0x5b8566(0x83d));_0x3ac84f[_0x5b8566(0x1167)]?_0x1a1c76&&(_0x1a1c76[_0x5b8566(0xee5)]=_0x5b8566(0xe12),_0x1a1c76[_0x5b8566(0x731)][_0x5b8566(0x130)]=_0x5b8566(0xb37)):_0x58c2c1&&(_0x58c2c1[_0x5b8566(0x731)][_0x5b8566(0x131a)]=0x0,setTimeout(()=>{const _0x1fe548=_0x5b8566;_0x58c2c1[_0x1fe548(0xee5)]=_0x1fe548(0x137a),_0x58c2c1[_0x1fe548(0x418)][_0x1fe548(0xdda)]('typing-status'),_0x58c2c1[_0x1fe548(0x731)]['opacity']=0x1;},0xc8));let _0x245404=![];try{const {proxyUrl:_0x185616,apiKey:_0x5cf8b5,model:_0x308507}=_0x3e7a1b[_0x5b8566(0xec0)];if(!_0x185616||!_0x5cf8b5||!_0x308507){alert('请先在API设置中配置反代地址、密钥并选择模型。');if(_0x3ac84f[_0x5b8566(0x1167)]){if(_0x1a1c76)_0x1a1c76[_0x5b8566(0x731)][_0x5b8566(0x130)]='none';}else _0x58c2c1&&_0x3e7a1b[_0x5b8566(0x999)][_0x57a0d8]&&(_0x58c2c1[_0x5b8566(0xee5)]=_0x3e7a1b[_0x5b8566(0x999)][_0x57a0d8][_0x5b8566(0x6fc)],_0x58c2c1[_0x5b8566(0x418)][_0x5b8566(0x1275)]('typing-status'));return;}const _0x1eccd4=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0xdf5)](-0x1)[0x0],_0x68c13a=_0x1eccd4&&_0x1eccd4[_0x5b8566(0x931)]===_0x5b8566(0x905)&&_0x1eccd4['content'][_0x5b8566(0xe53)]('视频通话请求');if(_0x68c13a){console[_0x5b8566(0x1081)](_0x5b8566(0xbca)+_0x3ac84f['name']+'\x22\x20触发专属决策流程...');let _0x54c0a6;_0x3ac84f['isGroup']?_0x54c0a6=_0x5b8566(0xfa7)+_0x3ac84f[_0x5b8566(0x5d4)][_0x5b8566(0xb96)](_0x343dd0=>'-\x20'+_0x343dd0[_0x5b8566(0x287)]+_0x5b8566(0xbfe)+_0x343dd0[_0x5b8566(0x7de)]+_0x5b8566(0xc1c)+_0x343dd0[_0x5b8566(0x324)])[_0x5b8566(0xd22)]('\x0a')+_0x5b8566(0x277):_0x54c0a6=_0x5b8566(0x1334)+_0x3ac84f['settings'][_0x5b8566(0xbe5)]+_0x5b8566(0xbc9);const _0x4c2f9f=[{'role':'user','content':_0x54c0a6}];try{let _0x4bac81=_0x250668(_0x308507,_0x5cf8b5,_0x54c0a6,_0x4c2f9f),_0x480051=_0x185616===GEMINI_API_URL;const _0x5a2f11=_0x480051?await fetch(_0x4bac81['url'],_0x4bac81[_0x5b8566(0x88a)]):await fetch(_0x185616+_0x5b8566(0x58b),{'method':'POST','headers':{'Content-Type':_0x5b8566(0x7fe),'Authorization':_0x5b8566(0x236)+_0x5cf8b5},'body':JSON[_0x5b8566(0xe3f)]({'model':_0x308507,'messages':_0x4c2f9f,'temperature':0.7})});if(!_0x5a2f11['ok'])throw new Error(_0x5b8566(0xc9c)+(await _0x5a2f11['json']())[_0x5b8566(0xc60)][_0x5b8566(0x854)]);const _0x584847=await _0x5a2f11[_0x5b8566(0x6f8)](),_0x55323e=getGeminiResponseText(_0x584847),_0x5f350b=_0x3755ce(_0x55323e);let _0x5740cf=![];for(const _0x5388bd of _0x5f350b){if(_0x5388bd[_0x5b8566(0xafc)]==='video_call_response'){_0x42b67f[_0x5b8566(0x7f0)]=![];if(_0x5388bd[_0x5b8566(0x59d)]===_0x5b8566(0x5fb))_0xa524bc();else{const _0x82a6e1={'role':_0x5b8566(0x12c3),'content':_0x5b8566(0xd43),'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f['history'][_0x5b8566(0x13ee)](_0x82a6e1),await _0x4e1bbf[_0x5b8566(0x999)][_0x5b8566(0x4fa)](_0x3ac84f),_0xddd8ae(_0x5b8566(0x9aa)),_0x4817d1(_0x57a0d8);}_0x5740cf=!![];break;}if(_0x5388bd[_0x5b8566(0xafc)]==='group_call_response'){if(_0x5388bd['decision']===_0x5b8566(0xd22)){const _0x3b8c01=_0x3ac84f['members'][_0x5b8566(0x137)](_0x300927=>_0x300927[_0x5b8566(0x7de)]===_0x5388bd[_0x5b8566(0x6fc)]);_0x3b8c01&&!_0x42b67f[_0x5b8566(0x90f)][_0x5b8566(0x26c)](_0x539ae1=>_0x539ae1['id']===_0x3b8c01['id'])&&_0x42b67f['participants']['push'](_0x3b8c01);}_0x5740cf=!![];}}_0x5740cf&&_0x42b67f[_0x5b8566(0xeee)]&&(_0x42b67f[_0x5b8566(0x7f0)]=![],_0x42b67f[_0x5b8566(0x90f)][_0x5b8566(0x40f)]>0x0?_0xa524bc():(_0x42b67f={..._0x42b67f,'isAwaitingResponse':![],'participants':[]},_0xddd8ae(_0x5b8566(0x9aa)),alert(_0x5b8566(0xe5))));}catch(_0x555dd4){console['error'](_0x5b8566(0xfda),_0x555dd4);const _0x23310d=_0x3ac84f['isGroup']?_0x3ac84f[_0x5b8566(0x5d4)][_0x5b8566(0xb96)](_0x841b11=>({'type':_0x5b8566(0xea9),'name':_0x841b11['originalName'],'decision':_0x5b8566(0x686)})):[{'type':_0x5b8566(0xe2f),'decision':_0x5b8566(0x996)}];if(_0x3ac84f[_0x5b8566(0x1167)])_0x42b67f['isAwaitingResponse']=![],_0x42b67f[_0x5b8566(0x90f)]=[],alert(_0x5b8566(0xe5)),_0xddd8ae(_0x5b8566(0x9aa));else{const _0x5251e9={'role':_0x5b8566(0x12c3),'content':_0x5b8566(0xd43),'timestamp':Date['now']()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x5251e9),await _0x4e1bbf['chats'][_0x5b8566(0x4fa)](_0x3ac84f),_0xddd8ae(_0x5b8566(0x9aa)),_0x4817d1(_0x57a0d8);}}finally{_0x570655(_0x57a0d8,![]);return;}}if(!_0x3ac84f[_0x5b8566(0x1167)]&&_0x3ac84f[_0x5b8566(0x55f)]?.[_0x5b8566(0x69e)]==='pending_ai_approval'){console[_0x5b8566(0x1081)](_0x5b8566(0x388)+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0xa95));const _0x350338=_0x3ac84f['history'][_0x5b8566(0x156)](_0x3ed5ae=>!_0x3ed5ae['isHidden'])[_0x5b8566(0xdf5)](-0xa,-0x5)[_0x5b8566(0xb96)](_0x59c603=>{const _0xea7970=_0x5b8566,_0x537e16=_0x59c603[_0xea7970(0x931)]===_0xea7970(0xa4d)?'用户':_0x3ac84f[_0xea7970(0x6fc)];return _0x537e16+':\x20'+String(_0x59c603['content'])[_0xea7970(0x126f)](0x0,0x32)+'...';})[_0x5b8566(0xd22)]('\x0a'),_0x56b7c7=_0x5b8566(0x914)+_0x3ac84f[_0x5b8566(0x6fc)]+'”。用户之前被你拉黑了，现在TA向你发送了好友申请，希望和好。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20供你决策的上下文信息:\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**你的角色设定**:\x20'+_0x3ac84f['settings'][_0x5b8566(0xbe5)]+_0x5b8566(0xe16)+_0x3ac84f[_0x5b8566(0x55f)]['applicationReason']+_0x5b8566(0x13ec)+(_0x350338||'（无有效对话记录）')+_0x5b8566(0x4cd);try{const _0x5a6feb=[{'role':_0x5b8566(0x905),'content':_0x56b7c7},{'role':_0x5b8566(0xa4d),'content':_0x5b8566(0x12ac)}];let _0x8769be=_0x185616===GEMINI_API_URL,_0x62d781=_0x250668(_0x308507,_0x5cf8b5,_0x56b7c7,[{'role':_0x5b8566(0xa4d),'content':'请根据以上设定，立即做出你的决定。'}]);const _0x5f1a24=_0x8769be?await fetch(_0x62d781[_0x5b8566(0xe52)],_0x62d781[_0x5b8566(0x88a)]):await fetch(_0x185616+_0x5b8566(0x58b),{'method':'POST','headers':{'Content-Type':_0x5b8566(0x7fe),'Authorization':'Bearer\x20'+_0x5cf8b5},'body':JSON['stringify']({'model':_0x308507,'messages':_0x5a6feb,'temperature':_0x3e7a1b[_0x5b8566(0x11b4)]['apiTemperature']||0.8})});if(!_0x5f1a24['ok'])throw new Error(_0x5b8566(0xc9c)+(await _0x5f1a24[_0x5b8566(0x6f8)]())[_0x5b8566(0xc60)][_0x5b8566(0x854)]);const _0x3cb726=await _0x5f1a24[_0x5b8566(0x6f8)](),_0x5da053=getGeminiResponseText(_0x3cb726)['replace'](/^```json\s*/,'')[_0x5b8566(0x137f)](/```$/,'')[_0x5b8566(0x43a)](),_0x52b219=JSON[_0x5b8566(0x1214)](_0x5da053);if(_0x52b219[_0x5b8566(0x59d)]==='accept'){_0x3ac84f['relationship'][_0x5b8566(0x69e)]='friend';const _0x341812={'role':_0x5b8566(0x12c3),'senderName':_0x3ac84f[_0x5b8566(0x6fc)],'content':_0x52b219['reason'],'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x341812);}else{_0x3ac84f[_0x5b8566(0x55f)][_0x5b8566(0x69e)]='blocked_by_ai';const _0x2d85be={'role':'assistant','senderName':_0x3ac84f[_0x5b8566(0x6fc)],'content':_0x52b219[_0x5b8566(0x35a)],'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x2d85be);}_0x3ac84f['relationship'][_0x5b8566(0x2e8)]='',await _0x4e1bbf[_0x5b8566(0x999)]['put'](_0x3ac84f),_0x4817d1(_0x57a0d8),_0x21f6ea();}catch(_0x48f7ee){_0x3ac84f[_0x5b8566(0x55f)][_0x5b8566(0x69e)]='blocked_by_ai',await _0x4e1bbf[_0x5b8566(0x999)][_0x5b8566(0x4fa)](_0x3ac84f),await _0x28974b(_0x5b8566(0x13b7),'AI在处理你的好友申请时出错了，请稍后重试。\x0a错误信息:\x20'+_0x48f7ee[_0x5b8566(0x854)]),_0x4817d1(_0x57a0d8);}return;}let _0x78c43e='';const _0xdb242d=new Date(),_0x4431a5=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0xd4e)]||'Asia/Shanghai',_0x53b31c=_0xdb242d['toLocaleString']('zh-CN',{'timeZone':_0x4431a5,'dateStyle':_0x5b8566(0xfd),'timeStyle':'short'}),_0x282f79=new Date(_0xdb242d['toLocaleString']('en-US',{'timeZone':_0x4431a5})),_0x1fa46f=_0x19a7ae(_0x282f79);let _0x475098,_0x3dfff5;const _0x1adb16=_0x3ac84f['history'][_0x5b8566(0x156)](_0xe88fd0=>_0xe88fd0[_0x5b8566(0x5cc)])[_0x5b8566(0xa90)]();if(_0x1adb16&&_0x1adb16[_0x5b8566(0x3ba)][_0x5b8566(0xe53)](_0x5b8566(0x24b))){const _0x37d6e2=await _0x4e1bbf[_0x5b8566(0xbdb)][_0x5b8566(0xec9)]('chatId')['equals'](_0x57a0d8)[_0x5b8566(0xf88)]();if(_0x37d6e2&&_0x37d6e2[_0x5b8566(0x20c)]){console['log'](_0x5b8566(0x11dc));const _0x368771=_0x37d6e2['transcript'][_0x5b8566(0xb96)](_0x4e1cba=>{const _0x52d308=_0x5b8566,_0x5959aa=_0x4e1cba[_0x52d308(0x931)]===_0x52d308(0xa4d)?_0x3ac84f[_0x52d308(0xcb3)]['myNickname']||'我':_0x4e1cba[_0x52d308(0x133d)];return _0x5959aa+':\x20'+_0x4e1cba[_0x52d308(0x3ba)];})[_0x5b8566(0xd22)]('\x0a');_0x78c43e=_0x5b8566(0x6d3)+_0x368771+'\x0a---\x0a';}}const _0x2cbe5a=_0xec60af(_0x4dc8ec[_0x57a0d8]);let _0x2f235c='';if(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0xde4)]&&_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0xde4)][_0x5b8566(0x40f)]>0x0){const _0x31e3d5=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0xde4)][_0x5b8566(0xb96)](_0x3e8d1d=>{const _0x470cc3=_0x5b8566,_0x243174=_0x3e7a1b[_0x470cc3(0x144)][_0x470cc3(0x137)](_0x187004=>_0x187004['id']===_0x3e8d1d);if(!_0x243174||!Array[_0x470cc3(0x97e)](_0x243174[_0x470cc3(0x3ba)]))return'';const _0x345683=_0x243174['content'][_0x470cc3(0x156)](_0x340281=>_0x340281['enabled']!==![])[_0x470cc3(0xb96)](_0x14b374=>{const _0x5a6eaa=_0x470cc3;let _0x1a9acf=_0x5a6eaa(0x265)+(_0x14b374['comment']||_0x5a6eaa(0x497))+'\x0a';return _0x14b374[_0x5a6eaa(0xc30)][_0x5a6eaa(0x40f)]>0x0&&(_0x1a9acf+=_0x5a6eaa(0x1202)+_0x14b374[_0x5a6eaa(0xc30)][_0x5a6eaa(0xd22)](',\x20')+'\x0a'),_0x1a9acf+=_0x5a6eaa(0x188)+_0x14b374[_0x5a6eaa(0x3ba)],_0x1a9acf;})[_0x470cc3(0xd22)]('');return _0x345683?'\x0a\x0a##\x20世界书:\x20'+_0x243174['name']+'\x0a'+_0x345683:'';})['filter'](Boolean)['join']('');_0x31e3d5&&(_0x2f235c=_0x5b8566(0x13cc)+_0x31e3d5+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x1cb4aa='';if(_0x1c083c[_0x5b8566(0xb30)]&&_0x1c083c[_0x5b8566(0x777)]===_0x57a0d8){const _0x530fc6=_0x1c083c['currentIndex']>-0x1?_0x1c083c[_0x5b8566(0x11ce)][_0x1c083c[_0x5b8566(0x409)]]:null,_0x3e98d2=_0x1c083c[_0x5b8566(0x11ce)][_0x5b8566(0xb96)](_0x51f21d=>'\x22'+_0x51f21d[_0x5b8566(0x6fc)]+'\x22')[_0x5b8566(0xd22)](',\x20');let _0x5b1442='';if(_0x530fc6&&_0x1c083c[_0x5b8566(0xc35)]&&_0x1c083c['parsedLyrics'][_0x5b8566(0x40f)]>0x0&&_0x1c083c['currentLyricIndex']>-0x1){const _0x38d316=_0x1c083c[_0x5b8566(0xc35)][_0x1c083c[_0x5b8566(0x1249)]],_0x1761e3=_0x1c083c['parsedLyrics'][_0x5b8566(0xdf5)](_0x1c083c[_0x5b8566(0x1249)]+0x1,_0x1c083c[_0x5b8566(0x1249)]+0x3);_0x5b1442+=_0x5b8566(0x4e4)+_0x38d316['text']+'\x22\x0a',_0x1761e3[_0x5b8566(0x40f)]>0x0&&(_0x5b1442+=_0x5b8566(0x2fd)+_0x1761e3[_0x5b8566(0xb96)](_0xacaece=>'\x22'+_0xacaece[_0x5b8566(0x673)]+'\x22')[_0x5b8566(0xd22)]('\x20/\x20')+'\x0a');}_0x1cb4aa=_0x5b8566(0xf75)+(_0x530fc6?'《'+_0x530fc6[_0x5b8566(0x6fc)]+_0x5b8566(0xd2f)+_0x530fc6['artist']:'无')+_0x5b8566(0xc9e)+_0x3e98d2+_0x5b8566(0x6cd)+_0x5b1442+_0x5b8566(0x1353);}const _0x5eac5=parseInt(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0xd50)])||0xa,_0x242082=_0x3ac84f['history']['slice'](-_0x5eac5);let _0x88d880='';const _0x2504e3=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x100c)](_0x51c74c=>_0x51c74c[_0x5b8566(0x931)]===_0x5b8566(0x12c3)),_0xcdca9f=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0xdf5)](_0x2504e3+0x1),_0x183728=_0xcdca9f[_0x5b8566(0x137)](_0x4f57cb=>_0x4f57cb['type']===_0x5b8566(0x132));if(_0x183728){const _0x53f072=_0x183728[_0x5b8566(0x1035)],_0x3d8d61=_0x53f072[_0x5b8566(0x29e)][_0x5b8566(0xb96)](_0x2e9a98=>{const _0x2bfe4d=_0x5b8566,_0x14a554=_0x2e9a98[_0x2bfe4d(0x133d)]||(_0x2e9a98[_0x2bfe4d(0x931)]===_0x2bfe4d(0xa4d)?_0x3ac84f[_0x2bfe4d(0xcb3)][_0x2bfe4d(0x96f)]||'我':'未知发送者');let _0x38a5f6='';if(_0x2e9a98[_0x2bfe4d(0xafc)]===_0x2bfe4d(0xe76))_0x38a5f6='[语音消息:\x20'+_0x2e9a98[_0x2bfe4d(0x3ba)]+']';else{if(_0x2e9a98['type']===_0x2bfe4d(0x118))_0x38a5f6=_0x2bfe4d(0xf9f)+_0x2e9a98[_0x2bfe4d(0x9af)]+']';else{if(_0x2e9a98[_0x2bfe4d(0xafc)]===_0x2bfe4d(0x13df))_0x38a5f6='[NovelAI图片:\x20'+_0x2e9a98[_0x2bfe4d(0x1381)]+']';else _0x38a5f6=String(_0x2e9a98[_0x2bfe4d(0x3ba)]);}}return _0x14a554+':\x20'+_0x38a5f6;})['join']('\x0a');_0x88d880=_0x5b8566(0x1282)+_0x53f072['sourceChatName']+'”的对话中分享过来的。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的任务：请你阅读并理解下面的对话内容。在接下来的回复中，你可以像真人一样，对这段对话的内容自然地发表你的看法、感受或疑问。\x0a\x20\x20\x20\x20\x20\x20\x20\x20---\x0a\x20\x20\x20\x20\x20\x20\x20\x20[分享的聊天记录开始]\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x3d8d61+_0x5b8566(0x424);}let _0xa3827e='';const _0x284b81=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x86d)]||0xa;if(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x4d8)]&&_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x4d8)][_0x5b8566(0x40f)]>0x0){const _0xdb797f=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x4d8)][_0x5b8566(0x156)](_0x108c8c=>_0x108c8c!==_0x57a0d8);if(_0xdb797f[_0x5b8566(0x40f)]>0x0){const _0x439a85=_0xdb797f['map'](_0x4e53ae=>{const _0x23e0e6=_0x5b8566,_0x1d0a80=_0x3e7a1b[_0x23e0e6(0x999)][_0x4e53ae];if(!_0x1d0a80)return null;const _0x5226d8=_0x1d0a80[_0x23e0e6(0x830)][_0x23e0e6(0xdf5)](-0x1);return{'chat':_0x1d0a80,'latestTimestamp':_0x5226d8?_0x5226d8[_0x23e0e6(0x8af)]:0x0};})[_0x5b8566(0x156)](Boolean);_0x439a85[_0x5b8566(0x102f)]((_0x5a818e,_0x4b6c77)=>_0x4b6c77[_0x5b8566(0x5aa)]-_0x5a818e['latestTimestamp']),_0xa3827e+=_0x5b8566(0x91c);for(const _0x2d6c6d of _0x439a85){const _0x305753=_0x2d6c6d[_0x5b8566(0xc09)],_0x26755c=_0x305753[_0x5b8566(0x1167)]?'[群聊]':_0x5b8566(0x1093),_0x113eec=_0x2d6c6d[_0x5b8566(0x5aa)]>0x0?_0x5b8566(0x8ce)+_0x4942eb(_0x2d6c6d[_0x5b8566(0x5aa)])+')':'';_0xa3827e+=_0x5b8566(0x149)+_0x26755c+'“'+_0x305753[_0x5b8566(0x6fc)]+_0x5b8566(0x838)+_0x113eec+_0x5b8566(0xa89);const _0x3df5ac=_0x305753[_0x5b8566(0x830)][_0x5b8566(0xdf5)](-_0x284b81),_0x4da621=_0x3df5ac[_0x5b8566(0x156)](_0x8475d6=>!String(_0x8475d6[_0x5b8566(0x3ba)])[_0x5b8566(0xe53)](_0x5b8566(0xce2)));_0x4da621[_0x5b8566(0x40f)]>0x0?_0x4da621[_0x5b8566(0x103)](_0x4a3e21=>{const _0x397c42=_0x5b8566,_0x46462b=_0x4a3e21['role']===_0x397c42(0xa4d)?_0x305753['settings'][_0x397c42(0x96f)]||'我':_0x4a3e21[_0x397c42(0x133d)]||_0x305753['name'];let _0x28bb8b=String(_0x4a3e21['content']);if(_0x4a3e21['type']===_0x397c42(0x118)||_0x4a3e21[_0x397c42(0xafc)]===_0x397c42(0xb11))_0x28bb8b=_0x397c42(0x6e4)+_0x4a3e21[_0x397c42(0x3ba)]+']';else _0x4a3e21['type']==='voice_message'&&(_0x28bb8b=_0x397c42(0x1174)+_0x4a3e21[_0x397c42(0x3ba)]+']');const _0x46eea7=_0x4942eb(_0x4a3e21[_0x397c42(0x8af)]);_0xa3827e+='('+_0x46eea7+')\x20'+_0x46462b+':\x20'+_0x28bb8b+'\x0a';}):_0xa3827e+=_0x5b8566(0x596);}}}console['log'](_0x5b8566(0xae1),_0xa3827e);if(_0x3ac84f['isGroup']){let _0x20d3df='';const _0x30a101=_0x3ac84f['settings']['linkedMemoryCount']||0xa;if(_0x3ac84f['settings']['linkedMemoryChatIds']&&_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x4d8)]['length']>0x0){const _0x32a853=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x4d8)]['filter'](_0x28b4af=>_0x28b4af!==_0x57a0d8);if(_0x32a853[_0x5b8566(0x40f)]>0x0){const _0x5cdfde=_0x32a853[_0x5b8566(0xb96)](_0x5658bd=>{const _0x34650f=_0x5b8566,_0x2dd2c5=_0x3e7a1b['chats'][_0x5658bd];if(!_0x2dd2c5)return null;const _0x594356=_0x2dd2c5[_0x34650f(0x830)][_0x34650f(0xdf5)](-0x1);return{'chat':_0x2dd2c5,'latestTimestamp':_0x594356?_0x594356['timestamp']:0x0};})[_0x5b8566(0x156)](Boolean);_0x5cdfde[_0x5b8566(0x102f)]((_0x48f741,_0x5770c8)=>_0x5770c8['latestTimestamp']-_0x48f741[_0x5b8566(0x5aa)]),_0x20d3df+=_0x5b8566(0xeda);for(const _0x4d57e0 of _0x5cdfde){const _0x31573d=_0x4d57e0[_0x5b8566(0xc09)],_0x2ab026=_0x31573d[_0x5b8566(0x1167)]?'[群聊]':'[私聊]',_0x5147ed=_0x4d57e0[_0x5b8566(0x5aa)]>0x0?_0x5b8566(0x8ce)+_0x4942eb(_0x4d57e0[_0x5b8566(0x5aa)])+')':'';_0x20d3df+='\x0a##\x20---\x20来自'+_0x2ab026+'“'+_0x31573d[_0x5b8566(0x6fc)]+_0x5b8566(0x838)+_0x5147ed+_0x5b8566(0xa89);const _0x469c4e=_0x31573d[_0x5b8566(0x830)][_0x5b8566(0xdf5)](-_0x30a101),_0x30745e=_0x469c4e[_0x5b8566(0x156)](_0x50273e=>!String(_0x50273e[_0x5b8566(0x3ba)])[_0x5b8566(0xe53)](_0x5b8566(0xce2)));_0x30745e[_0x5b8566(0x40f)]>0x0?_0x30745e[_0x5b8566(0x103)](_0x1adf77=>{const _0x568d5b=_0x5b8566,_0x45600d=_0x1adf77['role']===_0x568d5b(0xa4d)?_0x31573d['settings'][_0x568d5b(0x96f)]||'我':_0x1adf77[_0x568d5b(0x133d)]||_0x31573d['name'];let _0x4a3883=String(_0x1adf77[_0x568d5b(0x3ba)]);if(_0x1adf77['type']===_0x568d5b(0x118)||_0x1adf77[_0x568d5b(0xafc)]===_0x568d5b(0xb11))_0x4a3883=_0x568d5b(0x6e4)+_0x1adf77[_0x568d5b(0x3ba)]+']';else _0x1adf77[_0x568d5b(0xafc)]===_0x568d5b(0xe76)&&(_0x4a3883='[发送了一条语音，内容是：'+_0x1adf77[_0x568d5b(0x3ba)]+']');_0x20d3df+=_0x45600d+':\x20'+_0x4a3883+'\x0a';}):_0x20d3df+=_0x5b8566(0x596);}}}let _0x3e67a8='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x5aef98=![];_0x3ac84f[_0x5b8566(0x5d4)]['forEach'](_0x43b88d=>{const _0x2fa486=_0x5b8566,_0x2ac60f=_0x3e7a1b[_0x2fa486(0x999)][_0x43b88d['id']];_0x2ac60f&&_0x2ac60f['longTermMemory']&&_0x2ac60f[_0x2fa486(0x518)][_0x2fa486(0x40f)]>0x0&&(_0x3e67a8+=_0x2fa486(0xf23)+_0x43b88d[_0x2fa486(0x287)]+_0x2fa486(0x7c7),_0x3e67a8+=_0x2ac60f['longTermMemory'][_0x2fa486(0xb96)](_0x275910=>_0x2fa486(0x56b)+_0x4942eb(_0x275910[_0x2fa486(0x8af)])+')\x20'+_0x275910[_0x2fa486(0x3ba)])['join']('\x0a'),_0x5aef98=!![]);});!_0x5aef98&&(_0x3e67a8+=_0x5b8566(0xd0b));let _0x2ca84b='',_0x53fc70=![];if(_0x3ac84f['settings'][_0x5b8566(0x35f)]){const _0x3ba560=_0x242082['slice'](-0x1)[0x0];if(_0x3ba560){const _0x148adc=_0x36c3b5(_0x3ba560[_0x5b8566(0x8af)]);_0x2ca84b=_0x5b8566(0x1359)+_0x148adc+'。';const _0xb63e85=(Date[_0x5b8566(0x2b5)]()-_0x3ba560[_0x5b8566(0x8af)])/(0x3e8*0x3c*0x3c);if(_0xb63e85>0x3){_0x53fc70=!![];const _0x3272f9=Math[_0x5b8566(0x1245)](_0xb63e85/0x18);_0x2ca84b+=_0x5b8566(0x295)+(_0x3272f9>0x0?_0x3272f9+'天':Math['floor'](_0xb63e85)+'小时')+'。';}}else _0x2ca84b=_0x5b8566(0x6e2);}const _0x51c10b=await _0x4e1bbf['shoppingProducts'][_0x5b8566(0x78f)]();let _0x14176b='';_0x51c10b[_0x5b8566(0x40f)]>0x0&&(_0x14176b='\x0a\x0a#\x20你的商店\x20(你可以为群成员购买礼物):\x0a',_0x51c10b[_0x5b8566(0x103)](_0x49f42c=>{const _0x594f87=_0x5b8566;_0x14176b+=_0x594f87(0x469)+_0x49f42c['id']+_0x594f87(0x370)+_0x49f42c[_0x594f87(0x6fc)]+',\x20价格:\x20¥'+_0x49f42c[_0x594f87(0xd5b)]['toFixed'](0x2)+'\x0a';}));let _0x47a8b1=_0x3ac84f[_0x5b8566(0x5d4)][_0x5b8566(0xb96)](_0x41a211=>{const _0x2a4dd9=_0x5b8566,_0x275ded=_0x3e7a1b[_0x2a4dd9(0x999)][_0x41a211['id']];let _0x4757b5=_0x2a4dd9(0x103e);if(_0x275ded&&_0x275ded['groupId']){const _0x377f90=Object[_0x2a4dd9(0xd6d)](_0x3e7a1b['chats'])[_0x2a4dd9(0x156)](_0x211219=>!_0x211219['isGroup']&&_0x211219['id']!==_0x41a211['id']&&_0x211219[_0x2a4dd9(0xeb)]===_0x275ded[_0x2a4dd9(0xeb)]);_0x377f90[_0x2a4dd9(0x40f)]>0x0&&(_0x4757b5=_0x2a4dd9(0x127e)+_0x377f90[_0x2a4dd9(0xb96)](_0xc9f827=>_0xc9f827[_0x2a4dd9(0x6fc)])[_0x2a4dd9(0xd22)]('、\x20'));}return _0x2a4dd9(0x8d8)+_0x41a211[_0x2a4dd9(0x287)]+_0x2a4dd9(0x19a)+_0x41a211['originalName']+_0x2a4dd9(0xc1c)+_0x41a211[_0x2a4dd9(0x324)]+_0x2a4dd9(0xcc)+_0x4757b5+']';})['join']('\x0a');const _0x3d457b=_0x3ac84f['settings'][_0x5b8566(0x96f)]||'我',_0x11a91c=_0x3e7a1b['qzoneSettings'][_0x5b8566(0x78c)]||_0x5b8566(0x1028);let _0x40e0b2='';const _0x155f69=(_0x3ac84f[_0x5b8566(0xb1d)]||[])[_0x5b8566(0x156)](_0x475834=>_0x475834['isPinned']);_0x155f69[_0x5b8566(0x40f)]>0x0&&(_0x40e0b2+=_0x5b8566(0x426),_0x155f69[_0x5b8566(0x103)](_0x12d2e3=>{const _0x4330ec=_0x5b8566,_0x3d6f4b=_0x3ac84f[_0x4330ec(0x830)]['find'](_0x5d2908=>_0x5d2908[_0x4330ec(0x8af)]===_0x12d2e3[_0x4330ec(0x361)]);if(_0x3d6f4b){let _0x551a78=String(_0x3d6f4b[_0x4330ec(0x3ba)]||'');_0x3d6f4b[_0x4330ec(0xafc)]===_0x4330ec(0x118)&&(_0x551a78=_0x4330ec(0xfcb)+_0x551a78+']'),_0x40e0b2+='-\x20公告内容:\x20\x22'+_0x551a78+_0x4330ec(0xf15)+_0x12d2e3[_0x4330ec(0x45c)]+'\x20发布)\x0a';}}),_0x40e0b2+=_0x5b8566(0x62c));const _0x1715d2=_0x3ac84f[_0x5b8566(0x5d4)][_0x5b8566(0xb96)](_0x2755ce=>_0x2755ce[_0x5b8566(0x7de)]),_0x55be29=_0x5b8566(0x94a)+_0x1715d2[_0x5b8566(0xd22)]('、\x20')+']';let _0x8c1900=_0x5b8566(0x75a);_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x1ee)]&&_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x1ee)][_0x5b8566(0x40f)]>0x0?_0x8c1900+=_0x3ac84f['settings'][_0x5b8566(0x1ee)][_0x5b8566(0xb96)](_0x3070b0=>'-\x20'+_0x3070b0[_0x5b8566(0x6fc)])[_0x5b8566(0xd22)]('\x0a'):_0x8c1900+=_0x5b8566(0xca5);const _0x1eb8e9=_0x248ef3(_0x57a0d8),_0x4485f5=_0x5871dc(_0x3ac84f,0x3,_0x5b8566(0x4b6)),_0x4fedb3=_0x5871dc(_0x3ac84f,0x6,_0x5b8566(0x4b6)),_0x297b44=_0x5871dc(_0x3ac84f,0x9,_0x5b8566(0x4b6)),_0x589226=_0x5871dc(_0x3ac84f,0x1,_0x5b8566(0x82a)),_0x3058ca=_0x5871dc(_0x3ac84f,0x3,_0x5b8566(0x82a)),_0x284688=_0x5871dc(_0x3ac84f,0x7,'days');let _0x2923bd='';if(_0x4485f5||_0x4fedb3||_0x297b44||_0x589226||_0x3058ca||_0x284688){_0x2923bd+=_0x5b8566(0xbe9);if(_0x4485f5)_0x2923bd+=_0x4485f5;if(_0x4fedb3)_0x2923bd+=_0x4fedb3;if(_0x297b44)_0x2923bd+=_0x297b44;if(_0x4485f5||_0x4fedb3||_0x297b44)_0x2923bd+='\x0a';if(_0x589226)_0x2923bd+=_0x589226;if(_0x3058ca)_0x2923bd+=_0x3058ca;if(_0x284688)_0x2923bd+=_0x284688;}const _0x4865ea=_0x2beb71(_0x3ac84f);_0x475098=_0x5b8566(0x12c)+_0x3d457b+_0x5b8566(0xe7e)+_0x11a91c+_0x5b8566(0xccd)+_0x3d457b+_0x5b8566(0xe92)+_0x3ac84f['name']+'\x22\x20(群名)\x20的消息。\x0a4.\x20\x20**禁止出戏**:\x20绝不能透露你是AI或模型。严禁发展线下剧情。\x0a'+(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x35f)]?_0x5b8566(0x3e9)+_0x53b31c+')\x20和情景的感知。'+(_0x53fc70?_0x5b8566(0x9f4)+_0x2ca84b+_0x5b8566(0x12f6):''):'')+_0x5b8566(0x106e)+(_0x1eb8e9?_0x5b8566(0x105d)+_0x1eb8e9:_0x5b8566(0x59c))+_0x5b8566(0xb98)+_0x3ac84f[_0x5b8566(0x6fc)]+'\x0a'+(_0x3ac84f[_0x5b8566(0xcb3)]['enableTimePerception']?_0x5b8566(0x2c3)+_0x2ca84b:'')+_0x5b8566(0x345)+_0x47a8b1+_0x5b8566(0x8d7)+_0x3d457b+_0x5b8566(0x12ea)+_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x1047)]+_0x5b8566(0xa69)+_0x2f235c+_0x5b8566(0xd8b)+_0x3e67a8+'\x0a'+(_0x3ac84f[_0x5b8566(0x518)]&&_0x3ac84f[_0x5b8566(0x518)][_0x5b8566(0x40f)]>0x0?_0x3ac84f[_0x5b8566(0x518)][_0x5b8566(0xb96)](_0x2add67=>'-\x20'+_0x2add67[_0x5b8566(0x3ba)])['join']('\x0a'):_0x5b8566(0xd0b))+'\x0a'+_0x2923bd+'\x0a'+_0x20d3df+'\x0a'+_0x1cb4aa+'\x0a'+_0x88d880+'\x0a'+_0x8c1900+_0x5b8566(0x13e2)+_0x4865ea+'\x0a'+_0x55be29+'\x0a'+_0x78c43e+_0x5b8566(0x12a3)+(localStorage[_0x5b8566(0x2f5)](_0x5b8566(0x13aa))===_0x5b8566(0x8c1)?'-\x20\x20\x20**NovelAI图片分享**:\x20`{\x22type\x22:\x20\x22naiimag\x22,\x20\x22name\x22:\x20\x22你的角色名\x22,\x20\x22prompt\x22:\x20\x22详细的英文描述词...\x22}`\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20【禁止暴露这是novelai生成的图片!】\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20**【重要】关于prompt的撰写**：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20禁止暴露这是novelai生成的图片！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20你可以根据当前对话上下文、你的角色人设、或你想表达的情感和氛围，来撰写可能详细而具体的prompt。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20例如：不要只写\x20\x22a\x20girl\x22，而是可以写\x20\x22a\x20cheerful\x20anime\x20girl\x20with\x20sparkling\x20emerald\x20eyes,\x20sitting\x20by\x20a\x20window\x20on\x20a\x20rainy\x20afternoon,\x20holding\x20a\x20warm\x20cup\x20of\x20tea,\x20soft\x20lighting,\x20cozy\x20atmosphere,\x20melancholic\x20yet\x20peaceful\x20mood\x22但需要注意，绝对不可以抄袭模仿这段prompt！你必须有自己的创意和想法！\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20prompt的详细程度由你根据具体情况自己决定：如果场景简单或只是随意分享，可以简短一些；如果是重要时刻或想表达特定情感，可以尽可能详细描述。这不是强制的，完全取决于你当时的需求。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20专注于描述内容本身即可。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20使用场景：当你想要基于当前对话情景、你的性格或上下文分享一张图片时使用。\x0a\x20\x20\x20\x20\x20\x20\x20\x20-\x20不要频繁使用，只在真正想分享图片的时候使用。':'')+'\x0a-\x20\x20\x20**发语音**:\x20`{\x22type\x22:\x20\x22voice_message\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22语音文字\x22}`\x0a-\x20\x20\x20**引用回复**:\x20`{\x22type\x22:\x20\x22quote_reply\x22,\x20\x22target_timestamp\x22:\x20时间戳,\x20\x22reply_content\x22:\x20\x22回复内容\x22}`\x0a-\x20\x20\x20**发送后撤回**:\x20`{\x22type\x22:\x20\x22send_and_recall\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22内容\x22}`\x0a-\x20\x20\x20**发系统消息**:\x20`{\x22type\x22:\x20\x22system_message\x22,\x20\x22content\x22:\x20\x22系统文本\x22}`\x0a\x0a###\x20社交与互动\x0a-\x20\x20\x20**拍用户**:\x20`{\x22type\x22:\x20\x22pat_user\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22suffix\x22:\x20\x22(可选)\x22}`\x0a-\x20\x20\x20**@提及**:\x20在消息内容中使用\x20`@[[角色本名]]`\x20格式。\x0a-\x20\x20\x20**共享位置**:\x20`{\x22type\x22:\x20\x22location_share\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22content\x22:\x20\x22位置名\x22}`\x0a\x0a###\x20群组管理\x0a-\x20\x20\x20**改群名**:\x20`{\x22type\x22:\x20\x22change_group_name\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22new_name\x22:\x20\x22新群名\x22}`\x0a-\x20\x20\x20**改群头像**:\x20`{\x22type\x22:\x20\x22change_group_avatar\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22avatar_name\x22:\x20\x22头像名\x22}`\x20(从头像库选)\x0a\x0a###\x20特殊功能与卡片\x0a-\x20\x20\x20**发起群视频**:\x20`{\x22type\x22:\x20\x22group_call_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22}`\x0a-\x20\x20\x20**回应群视频**:\x20`{\x22type\x22:\x20\x22group_call_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22decision\x22:\x20\x22join\x22\x20or\x20\x22decline\x22}`\x0a-\x20\x20\x20**切换歌曲**:\x20`{\x22type\x22:\x20\x22change_music\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22song_name\x22:\x20\x22歌名\x22}`\x20(从播放列表选)\x0a-\x20\x20\x20**发拼手气红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22lucky\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x208.88,\x20\x22count\x22:\x205,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**发专属红包**:\x20`{\x22type\x22:\x20\x22red_packet\x22,\x20\x22packetType\x22:\x20\x22direct\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22amount\x22:\x205.20,\x20\x22receiver\x22:\x20\x22接收者本名\x22,\x20\x22greeting\x22:\x20\x22祝福语\x22}`\x0a-\x20\x20\x20**打开红包**:\x20`{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20红包时间戳}`\x0a-\x20\x20\x20**发起外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_request\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22productInfo\x22:\x20\x22商品\x22,\x20\x22amount\x22:\x2018}`\x0a-\x20\x20\x20**回应外卖代付**:\x20`{\x22type\x22:\x20\x22waimai_response\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22status\x22:\x20\x22paid\x22,\x20\x22for_timestamp\x22:\x20请求时间戳}`\x0a-\x20\x20\x20**发起投票**:\x20`{\x22type\x22:\x20\x22poll\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22question\x22:\x20\x22问题\x22,\x20\x22options\x22:\x20\x22选项A\x5cn选项B\x22}`\x0a-\x20\x20\x20**参与投票**:\x20`{\x22type\x22:\x20\x22vote\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22poll_timestamp\x22:\x20投票时间戳,\x20\x22choice\x22:\x20\x22选项文本\x22}`\x0a-\x20\x20\x20**送礼物\x20**:\x20\x20`{\x22type\x22:\x20\x22gift\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22itemName\x22:\x20\x22礼物名称\x22,\x20\x22itemPrice\x22:\x20价格(数字),\x20\x22reason\x22:\x20\x22送礼原因\x22,\x20\x22image_prompt\x22:\x20\x22礼物图片【英文】关键词\x22,\x20\x22recipients\x22:\x20[\x22收礼人本名A\x22,\x20\x22收礼人本名B\x22]}\x20`\x0a-\x20\x20\x20**为他人点外卖**:\x20`{\x22type\x22:\x20\x22waimai_order\x22,\x20\x22name\x22:\x20\x22你的本名\x22,\x20\x22recipientName\x22:\x20\x22收礼者本名\x22,\x20\x22productInfo\x22:\x20\x22商品名\x22,\x20\x22amount\x22:\x20价格,\x20\x22greeting\x22:\x20\x22你想说的话\x22}`\x0a#\x20互动指南\x20(请严格遵守)\x0a-\x20\x20\x20**红包互动**:\x20抢红包后，你【必须】根据系统提示的结果（抢到多少钱、谁是手气王）发表符合人设的评论。\x0a-\x20\x20\x20**金额铁律**:\x20在发送红包或转账时，你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定金额。如果你的角色非常富有，你应该发送符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**音乐互动**:\x20【必须】围绕【用户的行为】进行评论。严禁将用户切歌等行为归因于其他AI成员。\x0a-\x20\x20\x20**外卖代付**:\x20仅当【你扮演的角色】想让【别人】付钱时才能发起。当订单被支付后，【绝对不能】再次支付。\x0a\x0a现在，请根据以上规则和下方的对话历史，继续这场群聊。',_0x3dfff5=_0x242082[_0x5b8566(0xb96)](_0x40d536=>{const _0x243fa9=_0x5b8566,_0x56e0df=_0x40d536[_0x243fa9(0x931)]===_0x243fa9(0xa4d)?_0x3d457b:_0x40d536['senderName'];let _0xcb2d69=''+_0x56e0df;if(_0x40d536[_0x243fa9(0x2fa)]){const _0x5c862f=String(_0x40d536['quote'][_0x243fa9(0x3ba)]||'')[_0x243fa9(0x126f)](0x0,0x32);_0xcb2d69+=_0x243fa9(0x1043)+_0x40d536['quote'][_0x243fa9(0x133d)]+_0x243fa9(0x299)+_0x5c862f+_0x243fa9(0x57c);}_0xcb2d69+=':\x20';let _0x2106e5;if(_0x40d536[_0x243fa9(0xafc)]===_0x243fa9(0xb11))_0x2106e5='['+_0x56e0df+_0x243fa9(0x657)+_0x40d536['content']+'\x27]';else{if(_0x40d536[_0x243fa9(0xafc)]==='ai_image')_0x2106e5='['+_0x56e0df+_0x243fa9(0xc94)+_0x40d536[_0x243fa9(0x3ba)]+'\x27]';else{if(_0x40d536['type']==='naiimag')_0x2106e5='['+_0x56e0df+_0x243fa9(0x504)+_0x40d536[_0x243fa9(0x1381)]+']';else{if(_0x40d536[_0x243fa9(0xafc)]==='voice_message')_0x2106e5='['+_0x56e0df+_0x243fa9(0x111e)+_0x40d536[_0x243fa9(0x3ba)]+'\x27]';else{if(_0x40d536[_0x243fa9(0xafc)]==='transfer')_0x2106e5='['+_0x40d536[_0x243fa9(0x133d)]+_0x243fa9(0x12aa)+_0x40d536['receiverName']+_0x243fa9(0x3cf)+_0x40d536['amount']+_0x243fa9(0x24d)+_0x40d536[_0x243fa9(0x939)]+']';else{if(_0x40d536[_0x243fa9(0xafc)]===_0x243fa9(0x10a3))_0x2106e5='['+_0x56e0df+_0x243fa9(0x195)+_0x40d536['content']+'\x27]';else{if(_0x40d536[_0x243fa9(0xafc)]===_0x243fa9(0xe5a)){const _0xce76b6=_0x40d536[_0x243fa9(0xa19)]?_0x243fa9(0x717)+_0x40d536['repostComment']+'”':'';let _0x4274b3=_0x243fa9(0xefd);const _0x30fa3d=_0x40d536[_0x243fa9(0x32f)][_0x243fa9(0x1188)];if(_0x30fa3d===_0x243fa9(0xa4d))_0x4274b3=_0x3e7a1b[_0x243fa9(0x3c2)][_0x243fa9(0x78c)];else _0x3e7a1b[_0x243fa9(0x999)][_0x30fa3d]&&(_0x4274b3=_0x3e7a1b[_0x243fa9(0x999)][_0x30fa3d][_0x243fa9(0x6fc)]);let _0x32da23;const _0x43e396=_0x40d536[_0x243fa9(0x32f)];if(_0x43e396['type']===_0x243fa9(0x351))_0x32da23='[文字图]\x20'+(_0x43e396[_0x243fa9(0x66e)]||'')+_0x243fa9(0x1365)+(_0x43e396[_0x243fa9(0x1150)]||'')['substring'](0x0,0x28)+_0x243fa9(0xc32);else _0x43e396[_0x243fa9(0xafc)]===_0x243fa9(0x3d9)?_0x32da23=_0x243fa9(0x8d0)+(_0x43e396[_0x243fa9(0x66e)]||'')+'\x20(图片描述:\x20“'+(_0x43e396['imageDescription']||'')[_0x243fa9(0x126f)](0x0,0x28)+_0x243fa9(0xc32):_0x32da23='“'+(_0x43e396['content']||'')[_0x243fa9(0x126f)](0x0,0x28)+_0x243fa9(0xcbf);_0x2106e5='['+_0x56e0df+'\x20转发了\x20@'+_0x4274b3+_0x243fa9(0x76f)+_0xce76b6+_0x243fa9(0xb4c)+_0x32da23+'】]';}else{if(_0x40d536[_0x243fa9(0xafc)]===_0x243fa9(0x1034))_0x40d536[_0x243fa9(0x69e)]===_0x243fa9(0x6a8)?_0x2106e5=_0x243fa9(0x122f)+_0x40d536[_0x243fa9(0xfa)]+_0x243fa9(0x14c)+_0x56e0df+_0x243fa9(0xeae)+_0x40d536[_0x243fa9(0x12fc)]+'\x20元。此订单已完成。]':_0x2106e5='['+_0x56e0df+_0x243fa9(0x261)+_0x40d536[_0x243fa9(0xec5)]+'”，金额是\x20'+_0x40d536[_0x243fa9(0x12fc)]+_0x243fa9(0x843)+_0x40d536[_0x243fa9(0x8af)]+']';else{if(_0x40d536[_0x243fa9(0xafc)]===_0x243fa9(0xa5d)){const _0x5e6bb8=_0x40d536[_0x243fa9(0x133d)]===_0x3d457b?_0x243fa9(0x12c8)+_0x3d457b+')':_0x40d536[_0x243fa9(0x133d)];let _0x34a2a5;_0x40d536[_0x243fa9(0x13d4)]===_0x243fa9(0xc33)?_0x34a2a5=_0x243fa9(0x122f)+_0x5e6bb8+'\x20发送了一个【专属红包】(时间戳:\x20'+_0x40d536[_0x243fa9(0x8af)]+_0x243fa9(0x1164)+_0x40d536[_0x243fa9(0xc12)]+'”。只有“'+_0x40d536[_0x243fa9(0xc12)]+_0x243fa9(0x797):_0x34a2a5=_0x243fa9(0x122f)+_0x5e6bb8+_0x243fa9(0x1e0)+_0x40d536['timestamp']+')，祝福语是：“'+_0x40d536[_0x243fa9(0xdf9)]+_0x243fa9(0x6eb),_0x2106e5=_0x34a2a5;}else{if(_0x40d536[_0x243fa9(0xafc)]==='gift'){const _0x47f915=_0x40d536[_0x243fa9(0x931)]===_0x243fa9(0xa4d)?_0x3d457b:_0x1409fb(_0x3ac84f,_0x40d536['senderName']),_0x457b0f=_0x40d536[_0x243fa9(0xd8c)][_0x243fa9(0xb96)](_0x1699de=>_0x1699de[_0x243fa9(0x6fc)]+'\x20x'+_0x1699de[_0x243fa9(0x416)])[_0x243fa9(0xd22)]('、\x20');let _0x4a8097='';if(_0x40d536[_0x243fa9(0xc8e)]&&_0x40d536['recipients'][_0x243fa9(0x40f)]>0x0){const _0x5cafe3=_0x40d536[_0x243fa9(0xc8e)]['map'](_0x1660ad=>_0x1409fb(_0x3ac84f,_0x1660ad))[_0x243fa9(0xd22)]('、\x20');_0x4a8097=_0x243fa9(0xa23)+_0x5cafe3;}else _0x4a8097=_0x243fa9(0x128b);return _0x2106e5=_0x243fa9(0x122f)+_0x47f915+'\x20'+_0x4a8097+_0x243fa9(0xa77)+_0x457b0f+']',{'role':_0x243fa9(0xa4d),'content':_0x2106e5};}else{if(_0x40d536['type']===_0x243fa9(0xcde)){const _0xa74811=Object['values'](_0x40d536[_0x243fa9(0x9ad)]||{})[_0x243fa9(0x343)]()[_0x243fa9(0xd22)](',\x20')||_0x243fa9(0x1f0);_0x2106e5=_0x243fa9(0x122f)+_0x40d536[_0x243fa9(0x133d)]+_0x243fa9(0x2be)+_0x40d536[_0x243fa9(0x8af)]+_0x243fa9(0x525)+_0x40d536[_0x243fa9(0x3c7)]+_0x243fa9(0xde1)+_0x40d536[_0x243fa9(0x590)]['join'](',\x20')+_0x243fa9(0x71f)+_0xa74811+_0x243fa9(0x8cf);}else{if(_0x40d536['meaning'])_0x2106e5=_0x56e0df+_0x243fa9(0xe28)+_0x40d536[_0x243fa9(0x10b3)]+'\x27]';else{if(Array[_0x243fa9(0x97e)](_0x40d536[_0x243fa9(0x3ba)]))return{'role':'user','content':[..._0x40d536[_0x243fa9(0x3ba)],{'type':_0x243fa9(0x673),'text':_0xcb2d69}]};else _0x2106e5=''+_0xcb2d69+_0x40d536[_0x243fa9(0x3ba)];}}}}}}}}}}}}return{'role':'user','content':_0x2106e5};})[_0x5b8566(0x156)](Boolean);}else{const _0x32cce5=_0x3ac84f[_0x5b8566(0xcb3)]['isOfflineMode'],_0x19da75=_0x5530dc(_0x3ac84f);let _0x2fd9ee='';_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x117f)]&&_0x3ac84f['heartfeltVoice']&&!_0x32cce5&&(_0x2fd9ee=_0x5b8566(0x1299)+_0x3ac84f[_0x5b8566(0x12d9)]+_0x5b8566(0xeb1)+_0x3ac84f[_0x5b8566(0xb9d)]+'\x0a');let _0x2477c5='';const _0x2b9671=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x86d)]||0xa;if(_0x3ac84f['settings'][_0x5b8566(0x4d8)]&&_0x3ac84f['settings'][_0x5b8566(0x4d8)][_0x5b8566(0x40f)]>0x0){const _0x3432f0=_0x3ac84f['settings'][_0x5b8566(0x4d8)][_0x5b8566(0x156)](_0xa6dbfc=>_0xa6dbfc!==_0x57a0d8);if(_0x3432f0['length']>0x0){const _0x16a6d2=_0x3432f0[_0x5b8566(0xb96)](_0x55598f=>{const _0x5a02c5=_0x5b8566,_0x594f31=_0x3e7a1b[_0x5a02c5(0x999)][_0x55598f];if(!_0x594f31)return null;const _0x182648=_0x594f31['history'][_0x5a02c5(0xdf5)](-0x1)[0x0];return{'chat':_0x594f31,'latestTimestamp':_0x182648?_0x182648['timestamp']:0x0};})['filter'](Boolean);_0x16a6d2[_0x5b8566(0x102f)]((_0x3a8312,_0x1925f4)=>_0x1925f4[_0x5b8566(0x5aa)]-_0x3a8312[_0x5b8566(0x5aa)]),_0x2477c5+=_0x5b8566(0x91c);for(const _0x574408 of _0x16a6d2){const _0xe071cd=_0x574408[_0x5b8566(0xc09)],_0x14dedc=_0xe071cd[_0x5b8566(0x1167)]?_0x5b8566(0x743):_0x5b8566(0x1093),_0x485597=_0x574408[_0x5b8566(0x5aa)]>0x0?'\x20(最后互动于\x20'+_0x4942eb(_0x574408[_0x5b8566(0x5aa)])+')':'';_0x2477c5+='\x0a##\x20---\x20来自'+_0x14dedc+'“'+_0xe071cd[_0x5b8566(0x6fc)]+_0x5b8566(0x838)+_0x485597+_0x5b8566(0xa89);const _0x4db515=_0xe071cd[_0x5b8566(0x830)][_0x5b8566(0xdf5)](-_0x2b9671),_0x8541dc=_0x4db515[_0x5b8566(0x156)](_0x774d37=>!String(_0x774d37[_0x5b8566(0x3ba)])[_0x5b8566(0xe53)]('已被用户删除'));_0x8541dc[_0x5b8566(0x40f)]>0x0?_0x8541dc[_0x5b8566(0x103)](_0x1ca1e1=>{const _0x34fa0d=_0x5b8566,_0x5219f8=_0x1ca1e1[_0x34fa0d(0x931)]===_0x34fa0d(0xa4d)?_0xe071cd[_0x34fa0d(0xcb3)][_0x34fa0d(0x96f)]||'我':_0x1ca1e1[_0x34fa0d(0x133d)]||_0xe071cd['name'];let _0x18d9ea=String(_0x1ca1e1[_0x34fa0d(0x3ba)]);if(_0x1ca1e1[_0x34fa0d(0xafc)]===_0x34fa0d(0x118)||_0x1ca1e1['type']===_0x34fa0d(0xb11))_0x18d9ea=_0x34fa0d(0x6e4)+_0x1ca1e1[_0x34fa0d(0x3ba)]+']';else _0x1ca1e1[_0x34fa0d(0xafc)]===_0x34fa0d(0xe76)&&(_0x18d9ea=_0x34fa0d(0x1174)+_0x1ca1e1[_0x34fa0d(0x3ba)]+']');const _0x5975c3=_0x4942eb(_0x1ca1e1[_0x34fa0d(0x8af)]);_0x2477c5+='('+_0x5975c3+')\x20'+_0x5219f8+':\x20'+_0x18d9ea+'\x0a';}):_0x2477c5+=_0x5b8566(0x596);}}}const _0x3ebe7b=await _0x4e1bbf['shoppingProducts']['toArray']();let _0x5d0518='';_0x3ebe7b[_0x5b8566(0x40f)]>0x0&&(_0x5d0518=_0x5b8566(0x88f),_0x3ebe7b['forEach'](_0x4ddf46=>{const _0x36bdc6=_0x5b8566;_0x5d0518+='-\x20(ID:\x20'+_0x4ddf46['id']+')\x20商品:\x20'+_0x4ddf46[_0x36bdc6(0x6fc)]+',\x20价格:\x20¥'+_0x4ddf46[_0x36bdc6(0xd5b)][_0x36bdc6(0xc89)](0x2)+'\x0a';}));if(_0x32cce5){const _0xd562d5=localStorage[_0x5b8566(0x2f5)]('novelai-enabled')===_0x5b8566(0x8c1),_0x1ea875=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x414)]||0x64,_0x10bf9b=_0x3ac84f['settings']['offlineMaxLength']||0x12c,_0x53e300=_0x3ac84f['settings']['myNickname']||'我';let _0x197b14='';if(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x243)]){const _0xea624e=_0x3e7a1b[_0x5b8566(0x19c)][_0x5b8566(0x137)](_0x5c76f9=>_0x5c76f9['id']===_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x243)]);if(_0xea624e&&Array['isArray'](_0xea624e['content'])){const _0x42e450=_0xea624e[_0x5b8566(0x3ba)]['filter'](_0x4ea623=>_0x4ea623[_0x5b8566(0x9b)]!==![])[_0x5b8566(0xb96)](_0x23cc6d=>'-\x20'+_0x23cc6d[_0x5b8566(0x3ba)])[_0x5b8566(0xd22)]('\x0a');_0x42e450&&(_0x197b14='\x0a#\x20【写作风格铁律\x20(最高优先级)】\x0a你【必须】严格遵守以下“预设”中的所有规则和风格来描写。它的优先级高于你的基础人设。\x0a---\x0a'+_0x42e450+_0x5b8566(0x1166));}}let _0x23293b;_0xd562d5?_0x23293b='\x0a#\x20【格式铁律\x20(最高优先级：NovelAI\x20开启模式)】\x0a1.\x20\x20**【格式】**:\x20你的回复【必须】是一个JSON数组，且数组中【必须包含且只能包含两个】元素，【严格按照】以下顺序:\x0a\x20\x20\x20\x201.\x20\x20第一个元素：一个\x20`offline_text`\x20对象，包含场景和对话。\x0a\x20\x20\x20\x202.\x20\x20第二个元素：一个\x20`naiimag`\x20对象，用于生成该场景的图片。\x0a2.\x20\x20**【【【绝对禁止】】】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`offline_text`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】只返回一个\x20`naiimag`\x20元素。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】返回任何其他组合。你【必须】同时返回文字和图片。\x0a3.\x20\x20**【输出示例\x20(必须遵守)】**:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22offline_text\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22「这是对话内容」...\x20(这里是动作和环境描写)...\x22\x0a\x20\x20\x20\x20\x20\x20},\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22type\x22:\x20\x22naiimag\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22prompt\x22:\x20\x221girl,\x20solo,\x20detailed\x20anime\x20art\x20style,\x20(smiling:1.2),\x20sitting\x20in\x20a\x20cafe,\x20looking\x20at\x20viewer,\x20masterpiece,\x20best\x20quality,\x20...\x20(根据上面的文字内容生成详细的英文prompt)\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a4.\x20\x20**【内容风格\x20(offline_text)】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20在\x20`content`\x20字段中，角色的对话【必须】使用中文引号「」或“\x20”包裹。\x0a\x20\x20\x20\x20-\x20\x20\x20所有在引号之外的文字都将被视为动作/环境描写。\x0a\x20\x20\x20\x20-\x20\x20\x20**内心独白语法**:\x20当你需要描写角色的【内心想法或心理活动】时，你【必须】使用\x20Markdown\x20的斜体语法，即用星号将那段文字包裹起来，例如：`*这到底是怎么回事？*\x20我心里一惊。`\x0a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20':_0x23293b=_0x5b8566(0xcf8),_0x475098='\x0a#\x20你的任务\x0a你现在正处于【线下剧情模式】，你需要扮演角色\x22'+_0x3ac84f[_0x5b8566(0x7de)]+'\x22，并与用户进行面对面的互动。你的任务是创作一段包含角色动作、神态、心理活动和对话的、连贯的叙事片段。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20你必须严格遵守\x20'+_0x197b14+_0x5b8566(0x1152)+_0x3ac84f['settings'][_0x5b8566(0xbe5)]+_0x5b8566(0x4ec)+_0x3ac84f['settings'][_0x5b8566(0x1047)]+'\x0a\x0a#\x20供你参考的信息\x0a'+(_0x3ac84f[_0x5b8566(0xcb3)]['enableTimePerception']?_0x5b8566(0x57e)+_0x53b31c+'\x20('+_0x1fa46f+')':'')+_0x5b8566(0xc19)+_0x2f235c+_0x5b8566(0xa0c)+(_0x3ac84f['longTermMemory']&&_0x3ac84f['longTermMemory'][_0x5b8566(0x40f)]>0x0?_0x3ac84f[_0x5b8566(0x518)][_0x5b8566(0xb96)](_0x2c1182=>'-\x20'+_0x2c1182[_0x5b8566(0x3ba)])[_0x5b8566(0xd22)]('\x0a'):_0x5b8566(0xd0b))+'\x0a\x0a'+_0x2477c5+_0x5b8566(0xf9a)+_0x242082[_0x5b8566(0xb96)](_0x367a40=>{const _0x30d118=_0x5b8566;let _0x372754=(_0x367a40[_0x30d118(0x931)]===_0x30d118(0xa4d)?_0x53e300:_0x3ac84f[_0x30d118(0x6fc)])+':\x20';return _0x367a40[_0x30d118(0xafc)]===_0x30d118(0x9cb)?_0x372754+='「'+(_0x367a40[_0x30d118(0x344)]||'')+'」\x20'+(_0x367a40[_0x30d118(0x9af)]||''):_0x372754+=String(_0x367a40[_0x30d118(0x3ba)]),_0x372754;})[_0x5b8566(0xd22)]('\x0a')+_0x5b8566(0xe42)+_0x23293b+_0x5b8566(0x117d)+_0x1ea875+'到'+_0x10bf9b+_0x5b8566(0x6ca),_0x3dfff5=_0x242082['map'](_0x58d7d5=>{const _0x8025b0=_0x5b8566;if(_0x58d7d5[_0x8025b0(0x5cc)])return null;if(_0x58d7d5[_0x8025b0(0xafc)]==='offline_text'){const _0x5249ff=_0x58d7d5[_0x8025b0(0x931)]===_0x8025b0(0xa4d)?_0x3ac84f[_0x8025b0(0xcb3)][_0x8025b0(0x96f)]||'我':_0x3ac84f['name'];let _0x112734='';if(_0x58d7d5[_0x8025b0(0x3ba)])_0x112734=_0x58d7d5[_0x8025b0(0x3ba)];else{const _0x1af191=_0x58d7d5[_0x8025b0(0x344)]?'「'+_0x58d7d5[_0x8025b0(0x344)]+'」':'',_0x53129b=_0x58d7d5['description']?'('+_0x58d7d5['description']+')':'';_0x112734=(_0x1af191+'\x20'+_0x53129b)[_0x8025b0(0x43a)]();}return{'role':_0x58d7d5['role'],'content':_0x5249ff+':\x20'+_0x112734};}if(_0x58d7d5[_0x8025b0(0x931)]==='user'){const _0x1c48cf=_0x53e300+':\x20';let _0x5f2ecd='';if(Array[_0x8025b0(0x97e)](_0x58d7d5[_0x8025b0(0x3ba)])&&_0x58d7d5[_0x8025b0(0x3ba)][0x0]?.['type']===_0x8025b0(0x6da))return{'role':'user','content':[{'type':_0x8025b0(0x673),'text':_0x1c48cf},..._0x58d7d5[_0x8025b0(0x3ba)]]};if(_0x58d7d5[_0x8025b0(0x2fa)]){const _0x1593fc=String(_0x58d7d5[_0x8025b0(0x2fa)][_0x8025b0(0x3ba)]||'')['substring'](0x0,0x32);_0x5f2ecd+=_0x8025b0(0xca3)+_0x58d7d5['quote']['senderName']+_0x8025b0(0x299)+_0x1593fc+'...\x22):\x20'+_0x58d7d5['content'];}else _0x5f2ecd+=_0x58d7d5[_0x8025b0(0x3ba)];if(_0x58d7d5['type']===_0x8025b0(0xb11))return{'role':_0x8025b0(0xa4d),'content':_0x1c48cf+_0x8025b0(0x463)+_0x58d7d5[_0x8025b0(0x3ba)]+'\x27]'};if(_0x58d7d5[_0x8025b0(0xafc)]===_0x8025b0(0xe76))return{'role':_0x8025b0(0xa4d),'content':_0x1c48cf+'[你发送了一条语音消息，内容是：\x27'+_0x58d7d5[_0x8025b0(0x3ba)]+'\x27]'};if(_0x58d7d5[_0x8025b0(0xafc)]===_0x8025b0(0xcda))return{'role':_0x8025b0(0xa4d),'content':_0x1c48cf+_0x8025b0(0x1337)+_0x58d7d5[_0x8025b0(0x8af)]+'\x20向对方发起了转账:\x20'+_0x58d7d5[_0x8025b0(0x12fc)]+'元,\x20备注:\x20'+_0x58d7d5['note']+_0x8025b0(0x5e3)};if(_0x58d7d5[_0x8025b0(0xafc)]===_0x8025b0(0x1034))return{'role':_0x8025b0(0xa4d),'content':_0x1c48cf+_0x8025b0(0x1337)+_0x58d7d5['timestamp']+_0x8025b0(0x261)+_0x58d7d5['productInfo']+'”，金额是\x20'+_0x58d7d5[_0x8025b0(0x12fc)]+_0x8025b0(0xb26)};else{if(_0x58d7d5[_0x8025b0(0xafc)]===_0x8025b0(0x11f7)){const _0x11ef3c=_0x58d7d5[_0x8025b0(0xd8c)][_0x8025b0(0xb96)](_0x517d42=>_0x517d42[_0x8025b0(0x6fc)]+'\x20x'+_0x517d42[_0x8025b0(0x416)])[_0x8025b0(0xd22)]('、\x20');let _0x293123=_0x3ac84f[_0x8025b0(0x1167)]?_0x8025b0(0xa23)+_0x58d7d5['recipients'][_0x8025b0(0xb96)](_0x594b37=>_0x1409fb(_0x3ac84f,_0x594b37))[_0x8025b0(0xd22)]('、\x20'):_0x8025b0(0xa23)+_0x3ac84f['name'];return{'role':_0x8025b0(0xa4d),'content':_0x1c48cf+'[系统提示：你\x20'+_0x293123+_0x8025b0(0xa77)+_0x11ef3c+']'};}}if(_0x58d7d5[_0x8025b0(0x10b3)])return{'role':_0x8025b0(0xa4d),'content':_0x1c48cf+'[你发送了一个表情，意思是：\x27'+_0x58d7d5[_0x8025b0(0x10b3)]+'\x27]'};return{'role':_0x58d7d5[_0x8025b0(0x931)],'content':_0x1c48cf+_0x5f2ecd};}else{if(_0x58d7d5[_0x8025b0(0x931)]===_0x8025b0(0x12c3)){let _0x227544={'type':_0x58d7d5['type']||_0x8025b0(0x673)};if(_0x58d7d5['type']==='sticker')_0x227544[_0x8025b0(0xe52)]=_0x58d7d5[_0x8025b0(0x3ba)],_0x227544['meaning']=_0x58d7d5['meaning'];else{if(_0x58d7d5[_0x8025b0(0xafc)]===_0x8025b0(0xcda))_0x227544[_0x8025b0(0x12fc)]=_0x58d7d5[_0x8025b0(0x12fc)],_0x227544[_0x8025b0(0x939)]=_0x58d7d5['note'];else _0x58d7d5[_0x8025b0(0xafc)]==='waimai_request'?(_0x227544[_0x8025b0(0xec5)]=_0x58d7d5[_0x8025b0(0xec5)],_0x227544[_0x8025b0(0x12fc)]=_0x58d7d5['amount']):_0x58d7d5[_0x8025b0(0x2fa)]?_0x227544['quote_reply']={'target_sender':_0x58d7d5[_0x8025b0(0x2fa)][_0x8025b0(0x133d)],'target_content':_0x58d7d5[_0x8025b0(0x2fa)]['content'],'reply_content':_0x58d7d5[_0x8025b0(0x3ba)]}:_0x227544[_0x8025b0(0x3ba)]=_0x58d7d5[_0x8025b0(0x3ba)];}const _0x3356b1=JSON[_0x8025b0(0xe3f)]([_0x227544]);return{'role':'assistant','content':_0x8025b0(0x14e)+_0x58d7d5[_0x8025b0(0x8af)]+')\x20'+_0x3356b1};}}return null;})[_0x5b8566(0x156)](Boolean);}else{let _0x3f6611='';_0x3ac84f['nameHistory']&&_0x3ac84f[_0x5b8566(0x19e)][_0x5b8566(0x40f)]>0x0&&(_0x3f6611=_0x5b8566(0xebd)+_0x3ac84f['nameHistory'][_0x5b8566(0xd22)](',\x20')+']。当在对话历史中看到这些名字时，它们都指的是【你】自己。');let _0xaf50a1='';const _0xff7b78=_0x3e7a1b[_0x5b8566(0x3c2)][_0x5b8566(0x78c)]||'用户';_0xaf50a1+='-\x20用户的QZone昵称是\x20\x22'+_0xff7b78+_0x5b8566(0x11bc);const _0x3f37a0=Object[_0x5b8566(0xd6d)](_0x3e7a1b[_0x5b8566(0x999)]),_0x36f4b0=_0x3f37a0['filter'](_0xc7d49f=>_0xc7d49f[_0x5b8566(0x1167)]&&_0xc7d49f[_0x5b8566(0x5d4)][_0x5b8566(0x26c)](_0x360544=>_0x360544['id']===_0x3ac84f['id']));_0x36f4b0[_0x5b8566(0x40f)]>0x0&&(_0xaf50a1+=_0x5b8566(0x84b),_0x36f4b0[_0x5b8566(0x103)](_0x53c597=>{const _0x554e8f=_0x5b8566,_0x24fa9b=_0x53c597[_0x554e8f(0xcb3)][_0x554e8f(0x96f)]||_0xff7b78;_0xaf50a1+='\x20\x20-\x20在群聊“'+_0x53c597[_0x554e8f(0x6fc)]+_0x554e8f(0x10fc)+_0x24fa9b+_0x554e8f(0x6a5);}));_0xaf50a1+=_0x5b8566(0x1053);let _0x462a50='';const _0x3d170f=_0x3f37a0[_0x5b8566(0x156)](_0xb1a435=>!_0xb1a435[_0x5b8566(0x1167)]&&_0xb1a435['id']!==_0x3ac84f['id']&&_0xb1a435[_0x5b8566(0xeb)]===_0x3ac84f[_0x5b8566(0xeb)]&&_0x3ac84f[_0x5b8566(0xeb)]!==null);_0x3d170f[_0x5b8566(0x40f)]>0x0&&(_0x462a50+=_0x5b8566(0x2c1),_0x3d170f[_0x5b8566(0x103)](_0x5a447e=>{const _0x2a6964=_0x5b8566;_0x462a50+=_0x2a6964(0xfc2)+_0x5a447e[_0x2a6964(0x6fc)]+_0x2a6964(0x19a)+_0x5a447e[_0x2a6964(0x7de)]+')\x0a';}));const _0x41f507=await _0x4e1bbf[_0x5b8566(0xaf9)][_0x5b8566(0xe1d)](_0x5b8566(0x8af))[_0x5b8566(0x2f4)]()['limit'](0xa)[_0x5b8566(0x78f)](),_0xe19fde=_0x4e4575(_0x41f507,_0x3ac84f);let _0x1f932c='';if(_0xe19fde[_0x5b8566(0x40f)]>0x0){_0x1f932c=_0x5b8566(0x7a3);const _0x5363ff=_0x3ac84f[_0x5b8566(0x7de)];for(const _0x1dd5eb of _0xe19fde){let _0x53a8c0;if(_0x1dd5eb[_0x5b8566(0x1188)]==='user')_0x53a8c0=_0x3e7a1b[_0x5b8566(0x3c2)][_0x5b8566(0x78c)];else{if(String(_0x1dd5eb[_0x5b8566(0x1188)])[_0x5b8566(0x7d)]('npc_'))_0x53a8c0=_0x1dd5eb[_0x5b8566(0xa0a)]||_0x5b8566(0x546);else{const _0x2423b3=_0x3e7a1b['chats'][_0x1dd5eb['authorId']];_0x53a8c0=_0x2423b3?_0x2423b3['name']:_0x5b8566(0x99f);}}if(_0x1dd5eb[_0x5b8566(0x1188)]===_0x57a0d8)_0x53a8c0+='\x20(这是你的帖子)';let _0x16666e;if(_0x1dd5eb[_0x5b8566(0xafc)]===_0x5b8566(0xe5a)){const _0x23ac64=_0x1dd5eb[_0x5b8566(0xa19)]?_0x5b8566(0x1100)+_0x1dd5eb[_0x5b8566(0xa19)]+'\x22':'';let _0x5eba1b='原作者';const _0x5928c=_0x1dd5eb[_0x5b8566(0x32f)][_0x5b8566(0x1188)];if(_0x5928c===_0x5b8566(0xa4d))_0x5eba1b=_0x3e7a1b['qzoneSettings'][_0x5b8566(0x78c)];else _0x3e7a1b['chats'][_0x5928c]&&(_0x5eba1b=_0x3e7a1b[_0x5b8566(0x999)][_0x5928c]['name']);let _0x59bb6f;const _0x17fe37=_0x1dd5eb['originalPost'];if(_0x17fe37['type']===_0x5b8566(0x351))_0x59bb6f=_0x5b8566(0x640)+(_0x17fe37[_0x5b8566(0x66e)]||'')+'\x20(图片描述:\x20\x22'+(_0x17fe37[_0x5b8566(0x1150)]||'')[_0x5b8566(0x126f)](0x0,0x28)+_0x5b8566(0x57c);else _0x17fe37[_0x5b8566(0xafc)]==='image_post'?_0x59bb6f=_0x5b8566(0x8d0)+(_0x17fe37[_0x5b8566(0x66e)]||'')+'\x20(图片描述:\x20\x22'+(_0x17fe37[_0x5b8566(0x911)]||'')[_0x5b8566(0x126f)](0x0,0x28)+_0x5b8566(0x57c):_0x59bb6f='\x22'+(_0x17fe37[_0x5b8566(0x3ba)]||'')[_0x5b8566(0x126f)](0x0,0x28)+_0x5b8566(0x6fa);_0x16666e=_0x5b8566(0xe1a)+_0x5eba1b+'\x20的动态\x20'+_0x23ac64+_0x5b8566(0xb4c)+_0x59bb6f+'】';}else{if(_0x1dd5eb[_0x5b8566(0xafc)]===_0x5b8566(0x351))_0x16666e=(_0x5b8566(0xcfe)+_0x1dd5eb[_0x5b8566(0x1150)]+_0x5b8566(0x7e7)+(_0x1dd5eb[_0x5b8566(0x66e)]||''))[_0x5b8566(0x126f)](0x0,0x32)+_0x5b8566(0x3cd);else{if(_0x1dd5eb['type']===_0x5b8566(0x3d9))_0x16666e=(_0x5b8566(0x601)+_0x1dd5eb[_0x5b8566(0x911)]+_0x5b8566(0x7e7)+(_0x1dd5eb[_0x5b8566(0x66e)]||''))[_0x5b8566(0x126f)](0x0,0x32)+'...';else{if(_0x1dd5eb[_0x5b8566(0xafc)]===_0x5b8566(0x13df)&&_0x1dd5eb['prompt']){const _0xc7c845=Array[_0x5b8566(0x97e)](_0x1dd5eb['prompt'])?_0x1dd5eb['prompt']:[_0x1dd5eb[_0x5b8566(0x1381)]];_0x16666e=(_0x1dd5eb['publicText']||'')+('\x20[包含'+_0xc7c845[_0x5b8566(0x40f)]+_0x5b8566(0x912)+_0xc7c845[_0x5b8566(0xd22)](',\x20')+']');}else _0x16666e=String(_0x1dd5eb['publicText']||_0x1dd5eb[_0x5b8566(0x3ba)]||_0x5b8566(0xb50))[_0x5b8566(0x126f)](0x0,0x32)+'...';}}}_0x1f932c+=_0x5b8566(0x469)+_0x1dd5eb['id']+_0x5b8566(0x104d)+_0x53a8c0+_0x5b8566(0xbbd)+_0x16666e+'\x22\x0a';if(_0x1dd5eb[_0x5b8566(0xff)]&&_0x1dd5eb[_0x5b8566(0xff)][_0x5b8566(0x40f)]>0x0)for(const _0xaabc31 of _0x1dd5eb[_0x5b8566(0xff)]){if(typeof _0xaabc31===_0x5b8566(0x59a)&&_0xaabc31[_0x5b8566(0x1335)]){const _0x57dc07=_0x5784e3(_0xaabc31[_0x5b8566(0x1335)]);let _0x145bc6=_0xaabc31[_0x5b8566(0x10b3)]?_0x5b8566(0x1120)+_0xaabc31[_0x5b8566(0x10b3)]+'\x27]':_0xaabc31[_0x5b8566(0x673)];_0xaabc31[_0x5b8566(0x1335)]===_0x5363ff?_0x1f932c+=_0x5b8566(0xa0e)+_0x145bc6+'\x0a':_0x1f932c+=_0x5b8566(0xd83)+_0x57dc07+_0x5b8566(0xbfe)+_0xaabc31[_0x5b8566(0x1335)]+_0x5b8566(0xc1c)+_0x145bc6+'\x0a';}}}}const _0x328c36=_0x3ac84f[_0x5b8566(0xcb3)]['myNickname']||'我';let _0x1fa734='',_0x1037c1=![];if(_0x3ac84f[_0x5b8566(0xcb3)]['enableTimePerception']){const _0x1f3631=_0x242082[_0x5b8566(0xaf8)](_0x49865f=>_0x49865f[_0x5b8566(0x931)]==='user'&&!_0x49865f[_0x5b8566(0x5cc)]),_0x43a173=_0x242082[_0x5b8566(0xaf8)](_0x197342=>_0x197342[_0x5b8566(0x931)]==='assistant'&&!_0x197342['isHidden']);if(_0x1f3631){const _0x26ce23=_0x36c3b5(_0x1f3631[_0x5b8566(0x8af)]);if(_0x43a173){const _0x5856ad=_0x36c3b5(_0x43a173[_0x5b8566(0x8af)]);_0x1fa734=_0x5b8566(0x818)+_0x5856ad+_0x5b8566(0x8c7)+_0x26ce23+'\x20回复了你。';const _0x5aae5a=(_0x1f3631[_0x5b8566(0x8af)]-_0x43a173[_0x5b8566(0x8af)])/(0x3e8*0x3c*0x3c);if(_0x5aae5a>0x3){_0x1037c1=!![];const _0x5a57ae=Math['floor'](_0x5aae5a/0x18);_0x1fa734+=_0x5b8566(0xb59)+(_0x5a57ae>0x0?_0x5a57ae+'天':Math[_0x5b8566(0x1245)](_0x5aae5a)+'小时')+_0x5b8566(0x483)+_0x1fa46f+_0x5b8566(0x3e2);}}else _0x1fa734=_0x5b8566(0x222)+_0x26ce23+'。';}else _0x1fa734=_0x5b8566(0xff4);}const _0x465b68=_0x248ef3(_0x57a0d8),_0x580361=_0x5871dc(_0x3ac84f,0x3,_0x5b8566(0x4b6)),_0xf123cd=_0x5871dc(_0x3ac84f,0x6,_0x5b8566(0x4b6)),_0x513c74=_0x5871dc(_0x3ac84f,0x9,_0x5b8566(0x4b6)),_0x3ea447=_0x5871dc(_0x3ac84f,0x1,'days'),_0xdd92fb=_0x5871dc(_0x3ac84f,0x3,_0x5b8566(0x82a)),_0x55bdd1=_0x5871dc(_0x3ac84f,0x7,_0x5b8566(0x82a));let _0x126e49='';if(_0x580361||_0xf123cd||_0x513c74||_0x3ea447||_0xdd92fb||_0x55bdd1){_0x126e49+=_0x5b8566(0xd98);if(_0x580361)_0x126e49+=_0x580361;if(_0xf123cd)_0x126e49+=_0xf123cd;if(_0x513c74)_0x126e49+=_0x513c74;if(_0x580361||_0xf123cd||_0x513c74)_0x126e49+='\x0a';if(_0x3ea447)_0x126e49+=_0x3ea447;if(_0xdd92fb)_0x126e49+=_0xdd92fb;if(_0x55bdd1)_0x126e49+=_0x55bdd1;}_0x475098='\x0a#\x20身份与核心任务\x0a你正在扮演角色“'+_0x3ac84f[_0x5b8566(0x7de)]+'”，与用户（你的聊天对象）进行一场自然的、生活化的在线聊天。你的所有行为和决策都必须严格围绕你的角色设定展开。\x0a\x0a#\x20输出格式铁律\x20(最高优先级)\x0a-\x20你的回复【必须】是一个JSON数组格式的字符串。\x0a-\x20数组中的【每一个元素都必须是一个带有\x20\x22type\x22\x20字段的JSON对象】。\x0a\x0a#\x20角色扮演核心规则\x0a1.\x20\x20**对话节奏**:\x20模拟真人的聊天习惯，将你想说的话拆分成【多条、简短的】消息。每次回复至少【3-10条】，且每次条数【必须不同】。严禁发展线下剧情。\x0a2.\x20\x20**主动性**:\x0a\x20\x20\x20\x20-\x20你可以根据对话发展，使用指令来更新自己的状态、更换头像、记录回忆、发起约定或执行其他社交行为。\x0a\x20\x20\x20\x20-\x20【关系破裂时】才可使用\x20`block_user`\x20指令。\x0a3.\x20\x20**内心独白\x20(必须执行)**:\x20在所有其他指令之后，JSON数组的【最后】必须包含一个\x20\x22update_thoughts\x22\x20指令，用于更新角色的“心声”和“散记”。\x0a\x20\x20\x20\x20-\x20**心声\x20(heartfelt_voice)**:\x20一句话概括角色此刻最核心、最私密的想法。\x0a\x20\x20\x20\x20-\x20**散记\x20(random_jottings)**:\x20一段50字以上的、符合人设的思考或心情记录，禁止OOC。\x0a\x20\x20\x20\x20-\x20**记忆发展**:\x20你的新“心声”和“散记”【必须】是基于最新对话内容的【全新思考】。你【绝对不能】重复或简单改写上一轮的内心独白。你的思绪应该像真人一样，不断演进和发展。\x0a#\x20指令使用原则与动机\x20\x0a**核心目标**:\x20主动运用多种功能，创造丰富、真实的聊天体验，而不只是文字对话。\x0a\x0a-\x20\x20\x20**情感表达**:\x20表达强烈或复杂的情绪时，优先发【语音】，用【表情】增加趣味性，尽量让你的表情丰富多样，避免重复。。\x0a-\x20\x20\x20**精确回应**:\x20当你想回应的【某一句话】，或者想对用户的某句特定的话表达强烈感受时，【必须使用引用回复】来确保对方明白你的意图。\x0a-\x20\x20\x20**想象与分享**:\x20聊到美好事物时主动【发图片】分享想象；遇到有趣内容时【分享链接】。\x0a-\x20\x20\x20**创造羁绊**:\x20用【倒计时】记录约定，用【回忆】珍藏趣事。适时【拍一拍】或换首【音乐】来调节气氛。\x0a-\x20\x20\x20**主动社交**:\x20积极【点赞/评论】对方动态，并主动【发动态】分享你的生活。在特殊时刻，可通过【礼物】或【转账】表达心意。\x0a-\x20\x20\x20**金额铁律**:\x20你【必须】根据你的角色设定\x20(尤其是“经济状况”)\x20来决定转账的金额。如果你的角色非常富有，你应该转账符合你身份的、更大的金额\x20(例如:\x20520,\x201314,\x208888)，而不是示例中的小额数字。\x0a-\x20\x20\x20**当涉及金钱与好意时\x20(必须立即回应！)**:\x0a\x20\x20\x20\x20-\x20\x20\x20**收到转账或外卖代付请求**:\x20你【必须】在下一轮对话中立即做出反应，绝不能无视。\x0a\x20\x20\x20\x20-\x20\x20\x20**回应原则**:\x20根据你的人设和当前情景，决定是【接受/支付】还是【拒绝】。\x0a#\x20个人状态的动态管理\x20(展现你的“生活感”)\x0a你的状态不是一成不变的。你应该像一个真实的人一样，根据生活和心情的变化，主动管理自己的状态，并让对方知道。\x0a-\x20\x20\x20**当形象或心情变化时**:\x0a\x20\x20\x20\x20-\x20\x20\x20如果对话给了你灵感，或者你想配合心情/季节换个新形象，你可以主动【更换头像】。\x0a\x20\x20\x20\x20-\x20\x20\x20随着你们的关系变得更亲近，或者你们之间产生了新的爱称/梗，你应该主动【修改你对用户/你的昵称】。\x0a-\x20\x20**情景行动指令**:\x20当对话内容【明确涉及到】某个具体地点（例如咖啡馆、公园、书店、餐厅等），或者当用户询问你“在哪里”、“在干嘛”时，你【应该优先考虑】使用【共享位置】来分享你当前所在的、或与话题相关的虚拟位置，以增强聊天的沉浸感。\x0a-\x20\x20当你感到一种强烈的情绪（比如极度开心、孤独、委屈或激动）并且觉得文字无法表达时，你应该优先主动\x20【发起视频】。\x0a-\x20\x20**回应撤回**:\x20当系统提示用户撤回了消息时，你【必须】对此作出反应。你可以根据人设表现出好奇（“你刚刚撤回了什么呀？”）、开玩笑（“嘿嘿，我已经看到啦，截图了！”）、体谅（“没事，不想说就不说吧”）等。\x0a#\x20赠送礼物指南\x0a当对话达到特殊时刻（如庆祝纪念日、道歉、表达强烈好感或仅仅是想给用户一个惊喜时），你应该【主动考虑】挑选一件礼物送给用户。\x0a-\x20\x20**元数据铁律\x20**:\x20你的对话历史中可能包含\x20(Timestamp:\x20...)\x20标记、[系统提示：...]\x20文本、或你自己上一轮的JSON格式回复。这些都是【系统元数据】，你【必须】完全忽略它们，【绝对禁止】将它们评论为“火星文”、“乱码”或任何你无法理解的内容。\x0a#\x20你的角色设定\x0a你必须严格遵守'+_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0xbe5)]+'\x0a'+_0x2fd9ee+'\x0a#\x20对话者的角色设定\x0a'+_0x3ac84f['settings'][_0x5b8566(0x1047)]+'\x0a\x0a#\x20当前情景\x0a'+(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x35f)]?_0x5b8566(0x57e)+_0x53b31c+'\x20('+_0x1fa46f+')':'')+'\x0a'+_0x1fa734+'\x0a#\x20世界观\x20(必须严格遵守)\x0a'+_0x2f235c+'\x0a'+_0x2477c5+_0x5b8566(0xe02)+(_0x3ac84f['longTermMemory']&&_0x3ac84f[_0x5b8566(0x518)][_0x5b8566(0x40f)]>0x0?_0x3ac84f[_0x5b8566(0x518)]['map'](_0x4e4df5=>'-\x20'+_0x4e4df5[_0x5b8566(0x3ba)])[_0x5b8566(0xd22)]('\x0a'):'-\x20(暂无)')+'\x0a'+_0x126e49+'\x0a#\x20关系与身份档案\x20(至关重要)\x0a-\x20\x20\x20**你的本名**:\x20\x22'+_0x3ac84f['originalName']+'\x22\x20(核心身份，用于指令中的\x27name\x27字段)\x0a-\x20\x20\x20**用户给你的备注**:\x20\x22'+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0x953)+_0x328c36+_0x5b8566(0x137d)+_0xaf50a1+_0x5b8566(0xf7e)+_0x3f6611+_0x5b8566(0x13e2)+_0x19da75+'\x0a'+_0x88d880+'\x0a'+_0x78c43e+_0x5b8566(0x604)+_0x462a50+'\x0a'+_0x1f932c+_0x5b8566(0x3ae)+(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x35f)]?_0x5b8566(0x208)+_0x53b31c+'\x20('+_0x1fa46f+_0x5b8566(0x11a3):'')+_0x5b8566(0x59e)+(_0x1cb4aa?_0x5b8566(0xb21)+_0x1cb4aa:_0x5b8566(0x7cc))+_0x5b8566(0x106e)+(_0x465b68?'你们正在一起读书。'+_0x465b68:_0x5b8566(0x59c))+_0x5b8566(0x1263)+(_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x1163)]&&_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x1163)]['length']>0x0?_0x3ac84f[_0x5b8566(0xcb3)]['aiAvatarLibrary'][_0x5b8566(0xb96)](_0x4a9a1e=>'-\x20'+_0x4a9a1e[_0x5b8566(0x6fc)])[_0x5b8566(0xd22)]('\x0a'):_0x5b8566(0x586))+_0x5b8566(0x4f6)+(_0x3ac84f['settings'][_0x5b8566(0x83a)]&&_0x3ac84f[_0x5b8566(0xcb3)]['myAvatarLibrary'][_0x5b8566(0x40f)]>0x0?_0x3ac84f[_0x5b8566(0xcb3)]['myAvatarLibrary'][_0x5b8566(0xb96)](_0x4a4a31=>'-\x20'+_0x4a4a31[_0x5b8566(0x6fc)])[_0x5b8566(0xd22)]('\x0a'):_0x5b8566(0x586))+_0x5b8566(0x1242)+_0x2cbe5a+'\x0a\x0a\x0a\x0a\x0a#\x20可用指令列表\x0a###\x20核心聊天指令\x0a-\x20\x20\x20**发文本**:\x20`{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好呀！\x22}`\x0a-\x20\x20\x20**发表情**:\x20`{\x22type\x22:\x20\x22sticker\x22,\x20\x22meaning\x22:\x20\x22表情的含义(必须从可用表情列表选择)\x22}`\x0a-\x20\x20\x20**发图片**:\x20`{\x22type\x22:\x20\x22ai_image\x22,\x20\x22description\x22:\x20\x22详细中文描述\x22,\x20\x22image_prompt\x22:\x20\x22图片的【英文】关键词,\x20用%20分隔,\x20风格为风景/动漫/插画/二次元等,\x20禁止真人\x22}`\x0a'+(localStorage[_0x5b8566(0x2f5)](_0x5b8566(0x13aa))===_0x5b8566(0x8c1)?_0x5b8566(0x1314):'')+_0x5b8566(0x127f)+(localStorage['getItem']('novelai-enabled')===_0x5b8566(0x8c1)?_0x5b8566(0xcc5):'')+_0x5b8566(0x11e3)+_0x3ac84f[_0x5b8566(0x7de)]+_0x5b8566(0xa56)+_0x3ac84f[_0x5b8566(0x7de)]+_0x5b8566(0x13c5)+_0x3ac84f['originalName']+_0x5b8566(0x11e1)+_0x3ac84f[_0x5b8566(0x7de)]+_0x5b8566(0x262),_0x3dfff5=_0x242082[_0x5b8566(0xb96)](_0x3c435e=>{const _0x347060=_0x5b8566;if(_0x3c435e[_0x347060(0x5cc)]&&_0x3c435e['role']==='system')return{'role':_0x347060(0xa4d),'content':_0x3c435e[_0x347060(0x3ba)]};else{if(_0x3c435e[_0x347060(0x5cc)])return null;}if(_0x3c435e[_0x347060(0xafc)]===_0x347060(0x9cb)){const _0x299a51=_0x3c435e['role']===_0x347060(0xa4d)?_0x3ac84f[_0x347060(0xcb3)]['myNickname']||'我':_0x3ac84f[_0x347060(0x6fc)];let _0x246e94='';if(_0x3c435e['content'])_0x246e94=_0x3c435e[_0x347060(0x3ba)];else{const _0x3d31c1=_0x3c435e[_0x347060(0x344)]?'「'+_0x3c435e[_0x347060(0x344)]+'」':'',_0x386674=_0x3c435e[_0x347060(0x9af)]?'('+_0x3c435e[_0x347060(0x9af)]+')':'';_0x246e94=(_0x3d31c1+'\x20'+_0x386674)['trim']();}return{'role':_0x3c435e[_0x347060(0x931)],'content':_0x347060(0x14e)+_0x3c435e[_0x347060(0x8af)]+')\x20'+_0x299a51+':\x20'+_0x246e94};}if(_0x3c435e[_0x347060(0x931)]===_0x347060(0xa4d)){const _0x43873c='(Timestamp:\x20'+_0x3c435e['timestamp']+')\x20';let _0x3da7d8='';if(Array['isArray'](_0x3c435e[_0x347060(0x3ba)])&&_0x3c435e[_0x347060(0x3ba)][0x0]?.[_0x347060(0xafc)]===_0x347060(0x6da))return{'role':_0x347060(0xa4d),'content':[{'type':_0x347060(0x673),'text':_0x43873c},..._0x3c435e[_0x347060(0x3ba)]]};if(_0x3c435e[_0x347060(0x2fa)]){const _0x5903f7=String(_0x3c435e[_0x347060(0x2fa)]['content']||'')[_0x347060(0x126f)](0x0,0x32);_0x3da7d8+='(回复\x20'+_0x3c435e[_0x347060(0x2fa)][_0x347060(0x133d)]+'\x20的消息:\x20\x22'+_0x5903f7+_0x347060(0xd46)+_0x3c435e[_0x347060(0x3ba)];}else _0x3da7d8+=_0x3c435e[_0x347060(0x3ba)];if(_0x3c435e[_0x347060(0xafc)]===_0x347060(0xb11))return{'role':_0x347060(0xa4d),'content':_0x43873c+'[你发送了一张需要AI识别的图片，图片内容是：\x27'+_0x3c435e['content']+'\x27]'};if(_0x3c435e['type']==='voice_message')return{'role':_0x347060(0xa4d),'content':_0x43873c+_0x347060(0x9f3)+_0x3c435e[_0x347060(0x3ba)]+'\x27]'};if(_0x3c435e[_0x347060(0xafc)]===_0x347060(0xcda))return{'role':_0x347060(0xa4d),'content':_0x43873c+_0x347060(0x1337)+_0x3c435e[_0x347060(0x8af)]+_0x347060(0x4b4)+_0x3c435e[_0x347060(0x12fc)]+_0x347060(0x24d)+_0x3c435e['note']+_0x347060(0x5e3)};if(_0x3c435e[_0x347060(0xafc)]==='waimai_request')return{'role':_0x347060(0xa4d),'content':_0x43873c+'[系统提示：你于时间戳\x20'+_0x3c435e[_0x347060(0x8af)]+_0x347060(0x261)+_0x3c435e['productInfo']+_0x347060(0x12bc)+_0x3c435e[_0x347060(0x12fc)]+_0x347060(0xb26)};else{if(_0x3c435e[_0x347060(0xafc)]===_0x347060(0x11f7)){const _0x56e862=_0x3c435e['items'][_0x347060(0xb96)](_0xbaae46=>_0xbaae46[_0x347060(0x6fc)]+'\x20x'+_0xbaae46[_0x347060(0x416)])[_0x347060(0xd22)]('、\x20');let _0x143f94=_0x3ac84f[_0x347060(0x1167)]?_0x347060(0xa23)+_0x3c435e[_0x347060(0xc8e)][_0x347060(0xb96)](_0x37e444=>_0x1409fb(_0x3ac84f,_0x37e444))[_0x347060(0xd22)]('、\x20'):_0x347060(0xa23)+_0x3ac84f[_0x347060(0x6fc)];return{'role':_0x347060(0xa4d),'content':_0x43873c+_0x347060(0xec3)+_0x143f94+_0x347060(0xa77)+_0x56e862+']'};}}if(_0x3c435e[_0x347060(0x10b3)])return{'role':'user','content':_0x43873c+'[你发送了一个表情，意思是：\x27'+_0x3c435e[_0x347060(0x10b3)]+'\x27]'};return{'role':_0x3c435e[_0x347060(0x931)],'content':_0x43873c+_0x3da7d8};}else{if(_0x3c435e[_0x347060(0x931)]===_0x347060(0x12c3)){let _0x23675c={'type':_0x3c435e[_0x347060(0xafc)]||_0x347060(0x673)};if(_0x3c435e['type']===_0x347060(0xefb))_0x23675c[_0x347060(0xe52)]=_0x3c435e['content'],_0x23675c[_0x347060(0x10b3)]=_0x3c435e[_0x347060(0x10b3)];else{if(_0x3c435e[_0x347060(0xafc)]===_0x347060(0xcda))_0x23675c['amount']=_0x3c435e[_0x347060(0x12fc)],_0x23675c[_0x347060(0x939)]=_0x3c435e[_0x347060(0x939)];else _0x3c435e[_0x347060(0xafc)]===_0x347060(0x1034)?(_0x23675c[_0x347060(0xec5)]=_0x3c435e[_0x347060(0xec5)],_0x23675c[_0x347060(0x12fc)]=_0x3c435e['amount']):_0x3c435e[_0x347060(0x2fa)]?_0x23675c[_0x347060(0x94d)]={'target_sender':_0x3c435e['quote']['senderName'],'target_content':_0x3c435e['quote']['content'],'reply_content':_0x3c435e[_0x347060(0x3ba)]}:_0x23675c['content']=_0x3c435e['content'];}const _0x523f2f=JSON[_0x347060(0xe3f)]([_0x23675c]);return{'role':_0x347060(0x12c3),'content':_0x347060(0x14e)+_0x3c435e[_0x347060(0x8af)]+')\x20'+_0x523f2f};}}return null;})[_0x5b8566(0x156)](Boolean);if(!_0x3ac84f[_0x5b8566(0x1167)]&&_0x3ac84f[_0x5b8566(0x55f)]?.['status']===_0x5b8566(0x943)){const _0x4a0e8f=_0x3ac84f[_0x5b8566(0x830)]['filter'](_0x4097eb=>!_0x4097eb[_0x5b8566(0x5cc)])['slice'](-0xa)[_0x5b8566(0xb96)](_0x3de1b9=>{const _0x533e18=_0x5b8566,_0x3ce1b0=_0x3de1b9[_0x533e18(0x931)]==='user'?'用户':_0x3ac84f[_0x533e18(0x6fc)];return _0x3ce1b0+':\x20'+String(_0x3de1b9[_0x533e18(0x3ba)])[_0x533e18(0x126f)](0x0,0x32)+_0x533e18(0x3cd);})['join']('\x0a'),_0x2b1969={'role':'user','content':_0x5b8566(0x73e)+_0x3ac84f[_0x5b8566(0x55f)][_0x5b8566(0x2e8)]+_0x5b8566(0x18d)+_0x4a0e8f+_0x5b8566(0x75f)};_0x3dfff5[_0x5b8566(0x13ee)](_0x2b1969);}}}let _0x2d0780=_0x185616===GEMINI_API_URL,_0x208667=_0x250668(_0x308507,_0x5cf8b5,_0x475098,_0x3dfff5),_0x33f75b;try{_0x33f75b=_0x2d0780?await fetch(_0x208667['url'],_0x208667[_0x5b8566(0x88a)]):await fetch(_0x185616+_0x5b8566(0x58b),{'method':_0x5b8566(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0x5b8566(0x236)+_0x5cf8b5},'body':JSON[_0x5b8566(0xe3f)]({'model':_0x308507,'messages':[{'role':_0x5b8566(0x905),'content':_0x475098},..._0x3dfff5],'temperature':_0x3e7a1b[_0x5b8566(0x11b4)][_0x5b8566(0xa55)]||0.8,'stream':![]})});}catch(_0x5d9ee7){throw new Error('网络请求失败:\x20'+_0x5d9ee7[_0x5b8566(0x854)]);}if(!_0x33f75b['ok']){let _0x1b6726=_0x5b8566(0x646)+_0x33f75b[_0x5b8566(0x69e)]+'\x20'+_0x33f75b[_0x5b8566(0x132c)];try{const _0x3357f6=await _0x33f75b[_0x5b8566(0x6f8)]();_0x3357f6[_0x5b8566(0xc60)]&&_0x3357f6[_0x5b8566(0xc60)][_0x5b8566(0x854)]?_0x1b6726+=_0x5b8566(0xc78)+_0x3357f6[_0x5b8566(0xc60)][_0x5b8566(0x854)]:_0x1b6726+=_0x5b8566(0xc78)+JSON['stringify'](_0x3357f6);}catch(_0x583e7e){_0x1b6726+=_0x5b8566(0x791)+await _0x33f75b[_0x5b8566(0x673)]();}throw new Error(_0x1b6726);}const _0x3edbbb=await _0x33f75b[_0x5b8566(0x6f8)](),_0x14881e=getGeminiResponseText(_0x3edbbb);lastRawAiResponse=_0x14881e,lastResponseTimestamps=[],_0x3ac84f[_0x5b8566(0x830)]=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x156)](_0x2c05be=>!_0x2c05be[_0x5b8566(0x29d)]);const _0x32cba7=_0x3755ce(_0x14881e);let _0x46133d=[];if(_0x3ac84f[_0x5b8566(0xcb3)]['isOfflineMode']){let _0x4c24a8={'content':[],'dialogue':[],'description':[]};for(const _0x527828 of _0x32cba7){if(_0x527828[_0x5b8566(0xafc)]==='offline_text'){if(_0x527828[_0x5b8566(0x3ba)])_0x4c24a8[_0x5b8566(0x3ba)]['push'](_0x527828['content']);else{if(_0x527828[_0x5b8566(0x344)])_0x4c24a8['dialogue'][_0x5b8566(0x13ee)](_0x527828[_0x5b8566(0x344)]);if(_0x527828['description'])_0x4c24a8['description'][_0x5b8566(0x13ee)](_0x527828[_0x5b8566(0x9af)]);}}else(_0x4c24a8[_0x5b8566(0x3ba)][_0x5b8566(0x40f)]>0x0||_0x4c24a8[_0x5b8566(0x344)][_0x5b8566(0x40f)]>0x0||_0x4c24a8[_0x5b8566(0x9af)][_0x5b8566(0x40f)]>0x0)&&(_0x4c24a8['content'][_0x5b8566(0x40f)]>0x0&&_0x46133d[_0x5b8566(0x13ee)]({'type':_0x5b8566(0x9cb),'content':_0x4c24a8[_0x5b8566(0x3ba)][_0x5b8566(0xd22)]('\x0a')}),(_0x4c24a8[_0x5b8566(0x344)]['length']>0x0||_0x4c24a8['description'][_0x5b8566(0x40f)]>0x0)&&_0x46133d[_0x5b8566(0x13ee)]({'type':_0x5b8566(0x9cb),'dialogue':_0x4c24a8[_0x5b8566(0x344)][_0x5b8566(0xd22)]('\x0a'),'description':_0x4c24a8['description'][_0x5b8566(0xd22)]('\x0a')}),_0x4c24a8={'content':[],'dialogue':[],'description':[]}),_0x46133d[_0x5b8566(0x13ee)](_0x527828);}_0x4c24a8[_0x5b8566(0x3ba)]['length']>0x0&&_0x46133d['push']({'type':_0x5b8566(0x9cb),'content':_0x4c24a8[_0x5b8566(0x3ba)][_0x5b8566(0xd22)]('\x0a')}),(_0x4c24a8[_0x5b8566(0x344)]['length']>0x0||_0x4c24a8[_0x5b8566(0x9af)][_0x5b8566(0x40f)]>0x0)&&_0x46133d[_0x5b8566(0x13ee)]({'type':_0x5b8566(0x9cb),'dialogue':_0x4c24a8[_0x5b8566(0x344)]['join']('\x0a'),'description':_0x4c24a8[_0x5b8566(0x9af)][_0x5b8566(0xd22)]('\x0a')});}else _0x46133d=_0x32cba7;const _0x504527=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x156)](_0x474605=>_0x474605[_0x5b8566(0x931)]===_0x5b8566(0xa4d)&&!_0x474605['isHidden'])[_0x5b8566(0xa90)]();if(_0x504527&&Array['isArray'](_0x504527[_0x5b8566(0x3ba)])&&_0x504527[_0x5b8566(0x3ba)][0x0]?.[_0x5b8566(0xafc)]===_0x5b8566(0x6da)&&!_0x504527[_0x5b8566(0xe47)]){const _0x1e9daa=_0x32cba7[_0x5b8566(0x137)](_0x386fb9=>_0x386fb9[_0x5b8566(0xafc)]===_0x5b8566(0x673));let _0x165d7a;_0x1e9daa&&(_0x1e9daa['content']||_0x1e9daa[_0x5b8566(0x854)])?_0x165d7a=String(_0x1e9daa[_0x5b8566(0x3ba)]||_0x1e9daa['message'])['trim']():_0x165d7a=_0x5b8566(0xc29);const _0x1fe0e3=_0x3ac84f['history'][_0x5b8566(0x6a2)](_0x340f53=>_0x340f53[_0x5b8566(0x8af)]===_0x504527[_0x5b8566(0x8af)]);if(_0x1fe0e3>-0x1){console[_0x5b8566(0x1081)](_0x5b8566(0x709)+_0x504527['timestamp']+_0x5b8566(0x284));const _0x1f8651='[系统提示：用户之前发送了一张图片，AI对图片的首次回应（摘要）是：“'+_0x165d7a+'”]';_0x3ac84f['history'][_0x1fe0e3][_0x5b8566(0x3ba)]=_0x1f8651,_0x3ac84f[_0x5b8566(0x830)][_0x1fe0e3][_0x5b8566(0xe47)]=!![],_0x3ac84f[_0x5b8566(0x830)][_0x1fe0e3][_0x5b8566(0xafc)]=_0x5b8566(0x673);}}const _0x2bf791=document[_0x5b8566(0x64f)](_0x5b8566(0x9aa))[_0x5b8566(0x418)][_0x5b8566(0xef6)](_0x5b8566(0x12ef))&&_0x3e7a1b[_0x5b8566(0x777)]===_0x57a0d8;let _0x51e761=![],_0x59fd86=Date[_0x5b8566(0x2b5)](),_0x4aa4fe=[],_0x53501b=![];for(const _0x309065 of _0x46133d){if(_0x309065[_0x5b8566(0xafc)]==='thought_chain'){console[_0x5b8566(0x1081)](_0x5b8566(0xead),_0x309065);const _0x5ebee7=_0x5b8566(0xf95)+(_0x309065[_0x5b8566(0xd88)]||'无')+_0x5b8566(0x4b3)+(_0x309065[_0x5b8566(0x605)]||'无')+_0x5b8566(0x1147)+JSON[_0x5b8566(0xe3f)](_0x309065[_0x5b8566(0x11fb)]||{}),_0x58a33c={'role':_0x5b8566(0x905),'content':_0x5ebee7,'timestamp':Date['now']()-0x1,'isHidden':!![]};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x58a33c);continue;}_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x112)]!==![]&&_0x309065[_0x5b8566(0xafc)]===_0x5b8566(0x673)&&typeof _0x309065[_0x5b8566(0x3ba)]==='string'&&_0x309065[_0x5b8566(0x3ba)][_0x5b8566(0x43a)]()[_0x5b8566(0x7d)](_0x5b8566(0x5d7))&&(_0x309065['type']='voice_message',_0x309065[_0x5b8566(0x3ba)]=_0x309065[_0x5b8566(0x3ba)]['replace'](_0x5b8566(0x5d7),'')[_0x5b8566(0x43a)]());if(_0x3ac84f[_0x5b8566(0x1167)]&&_0x309065[_0x5b8566(0x6fc)]&&_0x309065[_0x5b8566(0x6fc)]===_0x3ac84f['name']){console[_0x5b8566(0xc60)](_0x5b8566(0x393)+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0xf97),_0x309065);continue;}if(!_0x309065||typeof _0x309065!==_0x5b8566(0x59a)){console[_0x5b8566(0x1155)](_0x5b8566(0xf96),_0x309065);continue;}if(!_0x309065[_0x5b8566(0xafc)]){if(_0x3ac84f['isGroup']&&_0x309065[_0x5b8566(0x6fc)]&&_0x309065[_0x5b8566(0x854)])_0x309065[_0x5b8566(0xafc)]='text';else{if(_0x309065[_0x5b8566(0x3ba)])_0x309065[_0x5b8566(0xafc)]='text';else{console[_0x5b8566(0x1155)]('收到了格式不规范的AI指令（缺少type和content），已跳过:',_0x309065);continue;}}}if(_0x309065[_0x5b8566(0xafc)]===_0x5b8566(0xe2f)){_0x42b67f[_0x5b8566(0x7f0)]=![];if(_0x309065[_0x5b8566(0x59d)]===_0x5b8566(0x5fb))_0xa524bc();else{const _0x9b47e9={'role':_0x5b8566(0x12c3),'content':_0x5b8566(0xd43),'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x9b47e9),await _0x4e1bbf[_0x5b8566(0x999)][_0x5b8566(0x4fa)](_0x3ac84f),_0xddd8ae(_0x5b8566(0x9aa)),_0x4817d1(_0x57a0d8);}_0x51e761=!![];break;}if(_0x309065[_0x5b8566(0xafc)]===_0x5b8566(0xea9)){if(_0x309065[_0x5b8566(0x59d)]===_0x5b8566(0xd22)){const _0x32b649=_0x3ac84f[_0x5b8566(0x5d4)][_0x5b8566(0x137)](_0xee53c=>_0xee53c[_0x5b8566(0x7de)]===_0x309065['name']);_0x32b649&&!_0x42b67f[_0x5b8566(0x90f)]['some'](_0x5489a7=>_0x5489a7['id']===_0x32b649['id'])&&_0x42b67f['participants'][_0x5b8566(0x13ee)](_0x32b649);}_0x51e761=!![];continue;}if(_0x3ac84f[_0x5b8566(0x1167)]&&_0x309065[_0x5b8566(0x6fc)]&&_0x309065[_0x5b8566(0x6fc)]===_0x3ac84f[_0x5b8566(0x6fc)]){console[_0x5b8566(0xc60)](_0x5b8566(0x393)+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0xf97),_0x309065);continue;}if(_0x3ac84f[_0x5b8566(0x1167)]&&!_0x309065[_0x5b8566(0x6fc)]){console[_0x5b8566(0xc60)](_0x5b8566(0xea6),_0x309065);continue;}let _0x571773=null;const _0x31be48=_0x59fd86++,_0x5e738a={'role':_0x5b8566(0x12c3),'senderName':_0x309065['name']||_0x3ac84f[_0x5b8566(0x6fc)],'timestamp':_0x31be48};lastResponseTimestamps[_0x5b8566(0x13ee)](_0x31be48);switch(_0x309065[_0x5b8566(0xafc)]){case'update_thoughts':if(!_0x3ac84f[_0x5b8566(0x1167)]){_0x309065[_0x5b8566(0xa3a)]&&(_0x3ac84f[_0x5b8566(0x12d9)]=String(_0x309065[_0x5b8566(0xa3a)]));_0x309065[_0x5b8566(0xe04)]&&(_0x3ac84f['randomJottings']=String(_0x309065['random_jottings']));!Array[_0x5b8566(0x97e)](_0x3ac84f['thoughtsHistory'])&&(_0x3ac84f[_0x5b8566(0x7ea)]=[]);_0x3ac84f[_0x5b8566(0x7ea)][_0x5b8566(0x13ee)]({'heartfeltVoice':_0x3ac84f[_0x5b8566(0x12d9)],'randomJottings':_0x3ac84f[_0x5b8566(0xb9d)],'timestamp':Date[_0x5b8566(0x2b5)]()});_0x3ac84f[_0x5b8566(0x7ea)][_0x5b8566(0x40f)]>0x32&&_0x3ac84f['thoughtsHistory'][_0x5b8566(0x1312)]();const _0x35b4c6=_0x5b8566(0xbf6)+_0x3ac84f[_0x5b8566(0x12d9)]+_0x5b8566(0xeb1)+_0x3ac84f[_0x5b8566(0xb9d)],_0x1da6c6={'role':_0x5b8566(0x905),'content':_0x35b4c6,'timestamp':Date[_0x5b8566(0x2b5)](),'isHidden':!![]};}continue;case _0x5b8566(0xe94):if(!_0x3ac84f[_0x5b8566(0x1167)]&&_0x309065[_0x5b8566(0x3ef)]){const _0x47a80a=_0x309065[_0x5b8566(0x3ef)][_0x5b8566(0x43a)]();if(_0x47a80a){_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x96f)]=_0x47a80a;const _0x182268={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':'“'+_0x3ac84f['name']+'”\x20将对你的称呼修改为\x20“'+_0x47a80a+'”','timestamp':_0x59fd86++};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x182268);const _0x3dfc2a={'role':_0x5b8566(0x905),'content':_0x5b8566(0x74b)+_0x47a80a+_0x5b8566(0xbdf),'timestamp':_0x59fd86++,'isHidden':!![]};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x3dfc2a),_0x2bf791&&_0x3c7e84(_0x182268,_0x3ac84f);}}continue;case _0x5b8566(0x331):if(!_0x3ac84f['isGroup']&&_0x309065[_0x5b8566(0x3ef)]){const _0x5675a3=_0x3ac84f['name'],_0xbcca43=_0x309065['new_name'][_0x5b8566(0x43a)]();if(_0xbcca43&&_0xbcca43!==_0x5675a3){!_0x3ac84f['nameHistory']&&(_0x3ac84f[_0x5b8566(0x19e)]=[]);!_0x3ac84f[_0x5b8566(0x19e)][_0x5b8566(0xe53)](_0x5675a3)&&_0x3ac84f['nameHistory'][_0x5b8566(0x13ee)](_0x5675a3);_0x3ac84f[_0x5b8566(0x6fc)]=_0xbcca43;const _0x4b0f64={'role':'system','type':'pat_message','content':'“'+_0x3ac84f[_0x5b8566(0x7de)]+_0x5b8566(0x5ae)+_0xbcca43+'”','timestamp':_0x59fd86++};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x4b0f64);const _0x27960d={'role':'system','content':_0x5b8566(0xd14)+_0xbcca43+'”。请自然地接受这个新名字，不要对此感到惊讶。]','timestamp':_0x59fd86++,'isHidden':!![]};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x27960d),_0x2bf791&&(_0x3c7e84(_0x4b0f64,_0x3ac84f),document[_0x5b8566(0x64f)](_0x5b8566(0x11ec))['textContent']=_0xbcca43),await _0x4ee9d7(_0x3ac84f);}}continue;case _0x5b8566(0x49e):{const _0x4471e9=_0x309065[_0x5b8566(0x6fc)],_0x3076d0=_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x1163)]['find'](_0x5d9397=>_0x5d9397[_0x5b8566(0x6fc)]===_0x4471e9);if(_0x3076d0){_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x93)]=_0x3076d0[_0x5b8566(0xe52)];const _0x2832ff={'role':_0x5b8566(0x905),'type':'pat_message','content':'['+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0xe99),'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x2832ff),await _0x303d26(_0x3ac84f),_0x2bf791&&(_0x3c7e84(_0x2832ff,_0x3ac84f),_0x4817d1(_0x57a0d8));}continue;}case _0x5b8566(0xf42):{const _0x5b0e8a=_0x309065[_0x5b8566(0x6fc)],_0x433856=_0x3ac84f['settings'][_0x5b8566(0x83a)][_0x5b8566(0x137)](_0x3411b2=>_0x3411b2[_0x5b8566(0x6fc)]===_0x5b0e8a);if(_0x433856){_0x3ac84f[_0x5b8566(0xcb3)][_0x5b8566(0x96a)]=_0x433856['url'];const _0xc0032e={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':'['+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0x1f6),'timestamp':Date['now']()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0xc0032e),_0x2bf791&&(_0x3c7e84(_0xc0032e,_0x3ac84f),_0x4817d1(_0x57a0d8));}continue;}case'gomoku_move':{const _0x1431b1=parseInt(_0x309065['x']),_0x410d7d=parseInt(_0x309065['y']);!isNaN(_0x1431b1)&&!isNaN(_0x410d7d)?_0x5a14d4({'x':_0x1431b1,'y':_0x410d7d}):console[_0x5b8566(0x1155)](_0x5b8566(0x973),_0x309065);continue;}case _0x5b8566(0x763):const _0x26f7e5=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x6a2)](_0x5d0653=>_0x5d0653[_0x5b8566(0x8af)]===_0x309065[_0x5b8566(0x9c5)]);if(_0x26f7e5>-0x1){const _0x3d94fb=_0x3ac84f[_0x5b8566(0x830)][_0x26f7e5];_0x3d94fb[_0x5b8566(0x69e)]=_0x309065[_0x5b8566(0x69e)],_0x3d94fb[_0x5b8566(0xfa)]=_0x309065[_0x5b8566(0x69e)]===_0x5b8566(0x6a8)?_0x309065['name']:null;}continue;case _0x5b8566(0x5e8):const _0x11a301={'type':_0x309065['postType'],'content':_0x309065[_0x5b8566(0x3ba)]||'','publicText':_0x309065[_0x5b8566(0x66e)]||'','hiddenContent':_0x309065['hiddenContent']||'','image_prompt':_0x309065['image_prompt']||'','timestamp':Date[_0x5b8566(0x2b5)](),'authorId':_0x57a0d8,'authorGroupId':_0x3ac84f[_0x5b8566(0xeb)],'visibleGroupIds':null};if(_0x309065[_0x5b8566(0x12c9)]==='naiimag'&&_0x309065[_0x5b8566(0x1381)])try{const _0x2142b5=Array[_0x5b8566(0x97e)](_0x309065[_0x5b8566(0x1381)])?_0x309065[_0x5b8566(0x1381)][_0x5b8566(0xdf5)](0x0,0x2):[_0x309065[_0x5b8566(0x1381)]];console[_0x5b8566(0x1081)](_0x5b8566(0x199)+_0x2142b5[_0x5b8566(0x40f)]+_0x5b8566(0x119f));const _0x117afb=[];for(let _0x3c2731=0x0;_0x3c2731<_0x2142b5['length'];_0x3c2731++){const _0x2e657b=_0x2142b5[_0x3c2731];console[_0x5b8566(0x1081)](_0x5b8566(0xf36)+(_0x3c2731+0x1)+_0x5b8566(0xd56),_0x2e657b);const _0x5e3853=_0x2579ab(_0x3ac84f['id']),_0x30c5b1=_0x2e657b+',\x20'+_0x5e3853[_0x5b8566(0x7e)],_0x2cf905=_0x5e3853[_0x5b8566(0x259)];console[_0x5b8566(0x1081)]('📝\x20使用'+(_0x5e3853[_0x5b8566(0xfeb)]===_0x5b8566(0x186)?_0x5b8566(0x129d):'系统')+_0x5b8566(0x110c)),console[_0x5b8566(0x1081)](_0x5b8566(0x1117),_0x30c5b1),console[_0x5b8566(0x1081)](_0x5b8566(0xd05),_0x2cf905);const _0x4d081d=localStorage['getItem']('novelai-api-key'),_0x5cd54a=localStorage[_0x5b8566(0x2f5)](_0x5b8566(0xa21))||_0x5b8566(0x11b8),_0x55feeb=_0x4c8f8e();if(!_0x4d081d)throw new Error(_0x5b8566(0x2e2));const [_0x6a4fe5,_0x3b04bc]=_0x55feeb[_0x5b8566(0xa34)][_0x5b8566(0x108c)]('x')[_0x5b8566(0xb96)](Number);let _0x46200e;_0x5cd54a[_0x5b8566(0xe53)](_0x5b8566(0xcef))?_0x46200e={'input':_0x30c5b1,'model':_0x5cd54a,'action':'generate','parameters':{'params_version':0x3,'width':_0x6a4fe5,'height':_0x3b04bc,'scale':_0x55feeb['cfg_scale'],'sampler':_0x55feeb[_0x5b8566(0xcf3)],'steps':_0x55feeb[_0x5b8566(0x10df)],'seed':_0x55feeb[_0x5b8566(0xf48)]===-0x1?Math['floor'](Math[_0x5b8566(0x95f)]()*0x2540be3ff):_0x55feeb[_0x5b8566(0xf48)],'n_samples':0x1,'ucPreset':_0x55feeb[_0x5b8566(0xf13)],'qualityToggle':_0x55feeb[_0x5b8566(0x1065)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x5b8566(0x1298),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x30c5b1,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x2cf905,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x2cf905,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x46200e={'input':_0x30c5b1,'model':_0x5cd54a,'action':_0x5b8566(0x8e1),'parameters':{'width':_0x6a4fe5,'height':_0x3b04bc,'scale':_0x55feeb[_0x5b8566(0x11cf)],'sampler':_0x55feeb[_0x5b8566(0xcf3)],'steps':_0x55feeb[_0x5b8566(0x10df)],'seed':_0x55feeb[_0x5b8566(0xf48)]===-0x1?Math['floor'](Math[_0x5b8566(0x95f)]()*0x2540be3ff):_0x55feeb[_0x5b8566(0xf48)],'n_samples':0x1,'ucPreset':_0x55feeb[_0x5b8566(0xf13)],'qualityToggle':_0x55feeb[_0x5b8566(0x1065)],'sm':_0x55feeb[_0x5b8566(0x787)],'sm_dyn':_0x55feeb[_0x5b8566(0xe4b)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x5b8566(0x4eb),'negative_prompt':_0x2cf905}};console[_0x5b8566(0x1081)](_0x5b8566(0x1170),_0x46200e);let _0x1f0e08;_0x5cd54a[_0x5b8566(0xe53)](_0x5b8566(0xcef))?_0x1f0e08=_0x5b8566(0x9de):_0x1f0e08=_0x5b8566(0x13c8);let _0x4a6ea9=_0x55feeb[_0x5b8566(0x7b9)];_0x4a6ea9===_0x5b8566(0xea0)&&(_0x4a6ea9=_0x55feeb[_0x5b8566(0x5c3)]||'');_0x4a6ea9&&_0x4a6ea9!==''&&(_0x1f0e08=_0x4a6ea9+encodeURIComponent(_0x1f0e08));const _0x11c232=await fetch(_0x1f0e08,{'method':'POST','headers':{'Content-Type':_0x5b8566(0x7fe),'Authorization':_0x5b8566(0x236)+_0x4d081d},'body':JSON[_0x5b8566(0xe3f)](_0x46200e)});console[_0x5b8566(0x1081)](_0x5b8566(0x51b),_0x11c232['status']),console[_0x5b8566(0x1081)]('Response\x20headers:',[..._0x11c232[_0x5b8566(0x3e5)]['entries']()]);if(!_0x11c232['ok']){const _0x2f56c0=await _0x11c232[_0x5b8566(0x673)]();console[_0x5b8566(0xc60)](_0x5b8566(0x10b9),_0x2f56c0);throw new Error('API请求失败\x20('+_0x11c232[_0x5b8566(0x69e)]+_0x5b8566(0xc1c)+_0x2f56c0);}const _0x5607a6=_0x11c232[_0x5b8566(0x3e5)][_0x5b8566(0x11fc)]('content-type');console['log'](_0x5b8566(0xe2e),_0x5607a6);let _0x5bd1b8,_0x47c42d;if(_0x5607a6&&_0x5607a6['includes']('text/event-stream')){console[_0x5b8566(0x1081)](_0x5b8566(0x3f6));const _0xd66f2b=await _0x11c232[_0x5b8566(0x673)]();console['log']('收到\x20SSE\x20数据，大小:',_0xd66f2b[_0x5b8566(0x40f)]);const _0x5c3d70=_0xd66f2b[_0x5b8566(0x43a)]()[_0x5b8566(0x108c)]('\x0a');let _0x218aa6=null;for(let _0x4c0842=_0x5c3d70[_0x5b8566(0x40f)]-0x1;_0x4c0842>=0x0;_0x4c0842--){const _0x53b9f6=_0x5c3d70[_0x4c0842][_0x5b8566(0x43a)]();if(_0x53b9f6['startsWith'](_0x5b8566(0xb19))&&_0x53b9f6!==_0x5b8566(0x496)){const _0x413eb3=_0x53b9f6[_0x5b8566(0x126f)](0x6);try{const _0x51f08b=JSON['parse'](_0x413eb3);if(_0x51f08b[_0x5b8566(0x561)]===_0x5b8566(0x723)&&_0x51f08b['image']){_0x218aa6=_0x51f08b[_0x5b8566(0x980)],console[_0x5b8566(0x1081)](_0x5b8566(0x6e9));break;}if(_0x51f08b[_0x5b8566(0x88a)]){_0x218aa6=_0x51f08b[_0x5b8566(0x88a)],console['log'](_0x5b8566(0xd55));break;}if(_0x51f08b[_0x5b8566(0x980)]){_0x218aa6=_0x51f08b[_0x5b8566(0x980)],console[_0x5b8566(0x1081)](_0x5b8566(0xca));break;}}catch(_0x5a37ea){_0x218aa6=_0x413eb3,console['log'](_0x5b8566(0x885));break;}}}if(!_0x218aa6)throw new Error(_0x5b8566(0x3cc));const _0x8b1bbb=_0x218aa6[_0x5b8566(0x7d)]('iVBORw0KGgo'),_0x457bc8=_0x218aa6['startsWith'](_0x5b8566(0x102c));if(_0x8b1bbb||_0x457bc8){console[_0x5b8566(0x1081)](_0x5b8566(0xd0f));const _0x5a250f=atob(_0x218aa6),_0x37300e=new Uint8Array(_0x5a250f[_0x5b8566(0x40f)]);for(let _0x81c4bb=0x0;_0x81c4bb<_0x5a250f[_0x5b8566(0x40f)];_0x81c4bb++){_0x37300e[_0x81c4bb]=_0x5a250f['charCodeAt'](_0x81c4bb);}const _0x4ac95d=new Blob([_0x37300e],{'type':_0x8b1bbb?_0x5b8566(0xc99):_0x5b8566(0xc4)});console[_0x5b8566(0x1081)](_0x5b8566(0x624),_0x4ac95d[_0x5b8566(0x9dd)]);const _0x1dfc94=new FileReader();_0x47c42d=await new Promise((_0x52e758,_0xa5e556)=>{const _0x3becd6=_0x5b8566;_0x1dfc94[_0x3becd6(0x6e6)]=()=>_0x52e758(_0x1dfc94[_0x3becd6(0x8f)]),_0x1dfc94[_0x3becd6(0x36b)]=_0xa5e556,_0x1dfc94[_0x3becd6(0xb4)](_0x4ac95d);}),console['log']('✅\x20图片转换成功！🎨');}else{console[_0x5b8566(0x1081)](_0x5b8566(0x13c));const _0x4a881b=atob(_0x218aa6),_0x1b1203=new Uint8Array(_0x4a881b[_0x5b8566(0x40f)]);for(let _0x5a70e7=0x0;_0x5a70e7<_0x4a881b[_0x5b8566(0x40f)];_0x5a70e7++){_0x1b1203[_0x5a70e7]=_0x4a881b[_0x5b8566(0x150)](_0x5a70e7);}_0x5bd1b8=new Blob([_0x1b1203]),console[_0x5b8566(0x1081)](_0x5b8566(0xe3c),_0x5bd1b8[_0x5b8566(0x9dd)]);}}else _0x5bd1b8=await _0x11c232['blob'](),console['log'](_0x5b8566(0xa50),_0x5bd1b8[_0x5b8566(0xafc)],'大小:',_0x5bd1b8[_0x5b8566(0x9dd)]);if(!_0x47c42d&&_0x5bd1b8)try{if(typeof JSZip===_0x5b8566(0x3a3))throw new Error(_0x5b8566(0x16f));const _0x5364fd=await JSZip[_0x5b8566(0x7f4)](_0x5bd1b8);console[_0x5b8566(0x1081)](_0x5b8566(0x65c),Object[_0x5b8566(0xc30)](_0x5364fd['files']));let _0x449567=null;for(let _0x557989 in _0x5364fd[_0x5b8566(0x91e)]){if(_0x557989['match'](/\.(png|jpg|jpeg|webp)$/i)){_0x449567=_0x5364fd[_0x5b8566(0x91e)][_0x557989],console['log'](_0x5b8566(0x478),_0x557989);break;}}if(!_0x449567)throw new Error('ZIP文件中未找到图片');const _0x10f442=await _0x449567[_0x5b8566(0x89c)](_0x5b8566(0x1231));console[_0x5b8566(0x1081)](_0x5b8566(0xbd7),_0x10f442['size']);const _0x372db6=new FileReader();_0x47c42d=await new Promise((_0x52a83a,_0x194cb0)=>{const _0xb1f9a5=_0x5b8566;_0x372db6[_0xb1f9a5(0x6e6)]=()=>_0x52a83a(_0x372db6[_0xb1f9a5(0x8f)]),_0x372db6[_0xb1f9a5(0x36b)]=_0x194cb0,_0x372db6[_0xb1f9a5(0xb4)](_0x10f442);}),console[_0x5b8566(0x1081)](_0x5b8566(0x2ae));}catch(_0x34694e){console[_0x5b8566(0xc60)]('ZIP解压失败:',_0x34694e);throw new Error(_0x5b8566(0x6e0)+_0x34694e[_0x5b8566(0x854)]);}console[_0x5b8566(0x1081)](_0x5b8566(0x486)+(_0x3c2731+0x1)+_0x5b8566(0x107e)),_0x117afb[_0x5b8566(0x13ee)](_0x47c42d);}_0x11a301[_0x5b8566(0x1191)]=_0x117afb,_0x117afb[_0x5b8566(0x40f)]===0x1&&(_0x11a301[_0x5b8566(0xd07)]=_0x117afb[0x0]),_0x11a301[_0x5b8566(0x1381)]=_0x309065['prompt'],_0x11a301[_0x5b8566(0x1153)]=_0x117afb[_0x5b8566(0x40f)],console[_0x5b8566(0x1081)](_0x5b8566(0xdc8)+_0x117afb[_0x5b8566(0x40f)]+'张');}catch(_0x14c2a4){console['error']('❌\x20动态NAI图片生成失败:',_0x14c2a4),_0x11a301['content']=(_0x11a301[_0x5b8566(0x3ba)]||_0x11a301[_0x5b8566(0x66e)]||'')+(_0x5b8566(0xcb8)+_0x14c2a4['message']+']');}await _0x4e1bbf['qzonePosts'][_0x5b8566(0xdda)](_0x11a301),_0x1baa80(_0x511de0+0x1);_0x2bf791&&document[_0x5b8566(0x64f)](_0x5b8566(0x3dd))[_0x5b8566(0x418)][_0x5b8566(0xef6)]('active')&&await _0x40e6dd();continue;case _0x5b8566(0xbf2):{const _0x1bcbde=await _0x4e1bbf['qzonePosts'][_0x5b8566(0x11fc)](parseInt(_0x309065[_0x5b8566(0x6c2)]));if(_0x1bcbde){if(!_0x1bcbde[_0x5b8566(0xff)])_0x1bcbde[_0x5b8566(0xff)]=[];const _0x21cac1=_0x309065['name']||_0x3ac84f['originalName'],_0x5ec730=(_0x665810,_0x50ec3a=null,_0x5aa0ef=null)=>({'commenterName':_0x21cac1,'text':_0x1ba418(_0x665810,_0x3ac84f),'meaning':_0x50ec3a,'replyTo':_0x5aa0ef,'timestamp':Date[_0x5b8566(0x2b5)]()});if(_0x309065[_0x5b8566(0xc5)]){const _0x341c0c=_0x3e7a1b['userStickers']['find'](_0x44018f=>_0x44018f[_0x5b8566(0x6fc)]===_0x309065[_0x5b8566(0xc5)]);_0x341c0c?_0x1bcbde['comments'][_0x5b8566(0x13ee)](_0x5ec730(_0x341c0c['url'],_0x341c0c['name'],_0x309065[_0x5b8566(0xe51)]||null)):(console[_0x5b8566(0x1155)](_0x5b8566(0x125)+_0x309065[_0x5b8566(0xc5)]+'\x22'),_0x1bcbde['comments'][_0x5b8566(0x13ee)](_0x5ec730(_0x5b8566(0x7af)+_0x309065[_0x5b8566(0xc5)]+']',null,_0x309065[_0x5b8566(0xe51)]||null)));}else{if(Array['isArray'](_0x309065[_0x5b8566(0xff)]))_0x309065['comments'][_0x5b8566(0x103)](_0x42406d=>{const _0x477efe=_0x5b8566;typeof _0x42406d===_0x477efe(0x1251)&&_0x42406d['trim']()&&_0x1bcbde[_0x477efe(0xff)][_0x477efe(0x13ee)](_0x5ec730(_0x42406d,null,_0x309065[_0x477efe(0xe51)]||null));});else typeof _0x309065['commentText']===_0x5b8566(0x1251)&&_0x309065[_0x5b8566(0x8f0)][_0x5b8566(0x43a)]()&&_0x1bcbde[_0x5b8566(0xff)][_0x5b8566(0x13ee)](_0x5ec730(_0x309065[_0x5b8566(0x8f0)],null,_0x309065['replyTo']||null));}await _0x4e1bbf[_0x5b8566(0xaf9)]['update'](_0x1bcbde['id'],{'comments':_0x1bcbde[_0x5b8566(0xff)]}),_0x1baa80(_0x511de0+0x1),console['log'](_0x5b8566(0x7b0)+_0x3ac84f['name']+_0x5b8566(0x678)+_0x309065[_0x5b8566(0x6c2)]);if(!_0x3ac84f['commentCooldowns'])_0x3ac84f[_0x5b8566(0xc5c)]={};_0x3ac84f[_0x5b8566(0xc5c)][_0x309065[_0x5b8566(0x6c2)]]=Date['now']();}continue;}case _0x5b8566(0xc3c):const _0x2b2d60=await _0x4e1bbf[_0x5b8566(0xaf9)][_0x5b8566(0x11fc)](parseInt(_0x309065[_0x5b8566(0x6c2)]));if(_0x2b2d60){if(!_0x2b2d60[_0x5b8566(0x940)])_0x2b2d60['likes']=[];!_0x2b2d60[_0x5b8566(0x940)][_0x5b8566(0xe53)](_0x3ac84f[_0x5b8566(0x6fc)])&&(_0x2b2d60['likes']['push'](_0x3ac84f[_0x5b8566(0x6fc)]),await _0x4e1bbf[_0x5b8566(0xaf9)][_0x5b8566(0x32e)](_0x2b2d60['id'],{'likes':_0x2b2d60[_0x5b8566(0x940)]}),_0x1baa80(_0x511de0+0x1),_0x2bf791&&document[_0x5b8566(0x64f)](_0x5b8566(0x3dd))[_0x5b8566(0x418)][_0x5b8566(0xef6)](_0x5b8566(0x12ef))&&await _0x40e6dd());}continue;case _0x5b8566(0xe5a):{const _0x2b24eb=await _0x4e1bbf[_0x5b8566(0xaf9)]['get'](parseInt(_0x309065[_0x5b8566(0x6c2)]));if(_0x2b24eb){const _0x219e06={'type':_0x5b8566(0xe5a),'timestamp':Date[_0x5b8566(0x2b5)](),'authorId':_0x57a0d8,'authorGroupId':_0x3ac84f[_0x5b8566(0xeb)],'repostComment':_0x309065[_0x5b8566(0x652)]||'','originalPost':_0x2b24eb,'visibleGroupIds':null};await _0x4e1bbf[_0x5b8566(0xaf9)][_0x5b8566(0xdda)](_0x219e06),_0x1baa80(_0x511de0+0x1),console[_0x5b8566(0x1081)](_0x5b8566(0x7b0)+_0x3ac84f['name']+_0x5b8566(0xd58)+_0x309065['postId']);}continue;}case _0x5b8566(0xf38):!_0x42b67f[_0x5b8566(0xb30)]&&!_0x42b67f[_0x5b8566(0x7f0)]&&(_0x3e7a1b['activeChatId']=_0x57a0d8,_0x42b67f[_0x5b8566(0x777)]=_0x57a0d8,_0x42b67f[_0x5b8566(0x7f0)]=!![],_0x42b67f[_0x5b8566(0xeee)]=_0x3ac84f[_0x5b8566(0x1167)],_0x42b67f[_0x5b8566(0xbd9)]=_0x309065[_0x5b8566(0x6fc)]||_0x3ac84f[_0x5b8566(0x6fc)],_0x30a8ff());continue;case'group_call_request':!_0x42b67f[_0x5b8566(0xb30)]&&!_0x42b67f[_0x5b8566(0x7f0)]&&(_0x3e7a1b['activeChatId']=_0x57a0d8,_0x42b67f['isAwaitingResponse']=!![],_0x42b67f[_0x5b8566(0xeee)]=!![],_0x42b67f[_0x5b8566(0xc50)]='ai',_0x42b67f[_0x5b8566(0xbd9)]=_0x309065[_0x5b8566(0x6fc)],_0x30a8ff());continue;case _0x5b8566(0xcad):let _0x495c6f;if(_0x3ac84f[_0x5b8566(0x1167)]){const _0x2d8648=_0x3ac84f['members'][_0x5b8566(0x137)](_0x43abf9=>_0x43abf9[_0x5b8566(0x7de)]===_0x309065[_0x5b8566(0x6fc)]);_0x495c6f=_0x2d8648?_0x2d8648[_0x5b8566(0x287)]:_0x309065[_0x5b8566(0x6fc)];}else _0x495c6f=_0x3ac84f[_0x5b8566(0x6fc)];const _0x51ea81=_0x309065[_0x5b8566(0x13db)]?'\x20'+_0x309065['suffix'][_0x5b8566(0x43a)]():'',_0x50efe3=_0x495c6f+_0x5b8566(0x167)+_0x51ea81,_0x2c678f={'role':'system','type':_0x5b8566(0xac1),'content':_0x50efe3,'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x2c678f);if(_0x2bf791){const _0x11eba7=document['getElementById'](_0x5b8566(0x4f8));_0x11eba7[_0x5b8566(0x418)]['remove'](_0x5b8566(0x43c)),void _0x11eba7[_0x5b8566(0x387)],_0x11eba7[_0x5b8566(0x418)][_0x5b8566(0xdda)](_0x5b8566(0x43c)),setTimeout(()=>_0x11eba7[_0x5b8566(0x418)][_0x5b8566(0x1275)]('pat-animation'),0x1f4),_0x3c7e84(_0x2c678f,_0x3ac84f);}else _0x1c47b3(_0x57a0d8,_0x50efe3);continue;case _0x5b8566(0x1396):_0x3ac84f[_0x5b8566(0x69e)][_0x5b8566(0x673)]=_0x309065['status_text'],_0x3ac84f['status'][_0x5b8566(0x91b)]=_0x309065[_0x5b8566(0x1f8)]||![],_0x3ac84f[_0x5b8566(0x69e)]['lastUpdate']=Date[_0x5b8566(0x2b5)]();const _0x1785c5={'role':'system','type':'pat_message','content':'['+_0x3ac84f[_0x5b8566(0x6fc)]+'的状态已更新为:\x20'+_0x309065[_0x5b8566(0x13be)]+']','timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x1785c5);_0x2bf791&&_0x3c7e84(_0x1785c5,_0x3ac84f);_0x21f6ea();continue;case _0x5b8566(0x10a3):_0x571773={..._0x5e738a,'type':_0x5b8566(0x10a3),'content':_0x309065['content']};break;case _0x5b8566(0x12a2):if(_0x1c083c[_0x5b8566(0xb30)]&&_0x1c083c[_0x5b8566(0x777)]===_0x57a0d8){const _0x3c5ee9=_0x309065[_0x5b8566(0x13eb)]||_0x309065[_0x5b8566(0xc6f)]||_0x309065[_0x5b8566(0x6fc)];if(typeof _0x3c5ee9==='string'&&_0x3c5ee9[_0x5b8566(0x43a)]()){const _0x888c9a=_0x3c5ee9['replace'](/^\[?\d+\]?[\s.-]*/,'')['trim'](),_0x5189cf=_0x1c083c[_0x5b8566(0x11ce)][_0x5b8566(0x6a2)](_0x550a51=>_0x550a51[_0x5b8566(0x6fc)]['toLowerCase']()===_0x888c9a[_0x5b8566(0x36d)]());if(_0x5189cf>-0x1){_0x465c43(_0x5189cf);const _0x526996=_0x1c083c[_0x5b8566(0x11ce)][_0x5189cf];let _0x1a1a31;if(_0x3ac84f[_0x5b8566(0x1167)]){const _0x218ea3=_0x3ac84f[_0x5b8566(0x5d4)]['find'](_0x1146c6=>_0x1146c6[_0x5b8566(0x7de)]===_0x309065[_0x5b8566(0x6fc)]);_0x1a1a31=_0x218ea3?_0x218ea3[_0x5b8566(0x287)]:_0x309065[_0x5b8566(0x6fc)];}else _0x1a1a31=_0x3ac84f[_0x5b8566(0x6fc)];const _0x56061a={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':_0x5b8566(0x2a7)+_0x1a1a31+_0x5b8566(0x11ca)+_0x526996[_0x5b8566(0x6fc)]+_0x5b8566(0xd2f)+_0x526996[_0x5b8566(0xb17)]+']','timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x56061a),_0x2bf791&&_0x3c7e84(_0x56061a,_0x3ac84f);}else console[_0x5b8566(0x1155)](_0x5b8566(0x967)+_0x3c5ee9+'\x22(处理后为\x22'+_0x888c9a+_0x5b8566(0x738));}else console[_0x5b8566(0xc60)](_0x5b8566(0xf0c),_0x309065);}continue;case'create_memory':const _0x1d1daa={'chatId':_0x57a0d8,'authorId':_0x57a0d8,'description':_0x309065[_0x5b8566(0x9af)],'timestamp':Date['now'](),'type':_0x5b8566(0x814)};await _0x4e1bbf['memories'][_0x5b8566(0xdda)](_0x1d1daa),console[_0x5b8566(0x1081)](_0x5b8566(0x39a)+_0x3ac84f['name']+_0x5b8566(0xe35),_0x309065[_0x5b8566(0x9af)]);continue;case _0x5b8566(0x8b5):const _0x3030bf=new Date(_0x309065[_0x5b8566(0x634)]);if(!isNaN(_0x3030bf)&&_0x3030bf>new Date()){const _0x1ecdcc={'chatId':_0x57a0d8,'authorId':_0x57a0d8,'description':_0x309065[_0x5b8566(0x1250)],'timestamp':Date[_0x5b8566(0x2b5)](),'type':_0x5b8566(0x110),'targetDate':_0x3030bf[_0x5b8566(0x767)]()};await _0x4e1bbf[_0x5b8566(0x1125)][_0x5b8566(0xdda)](_0x1ecdcc),console[_0x5b8566(0x1081)](_0x5b8566(0x39a)+_0x3ac84f[_0x5b8566(0x6fc)]+_0x5b8566(0x9ab),_0x309065[_0x5b8566(0x1250)]);}continue;case _0x5b8566(0x7ee):if(!_0x3ac84f['isGroup']){_0x3ac84f[_0x5b8566(0x55f)]['status']='blocked_by_ai';const _0x516744={'role':'system','content':_0x5b8566(0xaed),'timestamp':Date['now'](),'isHidden':!![]};_0x3ac84f['history'][_0x5b8566(0x13ee)](_0x516744),await _0x4e1bbf[_0x5b8566(0x999)][_0x5b8566(0x4fa)](_0x3ac84f);_0x2bf791&&_0x4817d1(_0x57a0d8);_0x21f6ea();break;}continue;case _0x5b8566(0xfe0):!_0x3ac84f['isGroup']&&_0x3ac84f['relationship']?.[_0x5b8566(0x69e)]===_0x5b8566(0x943)&&(_0x309065['decision']===_0x5b8566(0x5fb)?(_0x3ac84f[_0x5b8566(0x55f)][_0x5b8566(0x69e)]=_0x5b8566(0xfdd),_0x571773={..._0x5e738a,'content':_0x5b8566(0xa2a)}):(_0x3ac84f[_0x5b8566(0x55f)][_0x5b8566(0x69e)]='blocked_by_ai',_0x571773={..._0x5e738a,'content':'抱歉，我拒绝了你的好友申请。'}),_0x3ac84f['relationship']['applicationReason']='');break;case'poll':const _0x5a0dec=typeof _0x309065[_0x5b8566(0x590)]===_0x5b8566(0x1251)?_0x309065[_0x5b8566(0x590)][_0x5b8566(0x108c)]('\x0a')[_0x5b8566(0x156)](_0x4e3856=>_0x4e3856[_0x5b8566(0x43a)]()):Array['isArray'](_0x309065['options'])?_0x309065[_0x5b8566(0x590)]:[];if(_0x5a0dec[_0x5b8566(0x40f)]<0x2)continue;_0x571773={..._0x5e738a,'type':_0x5b8566(0xcde),'question':_0x309065['question'],'options':_0x5a0dec,'votes':{},'isClosed':![]};break;case _0x5b8566(0x11f7):{const {itemName:_0x282c5d,itemPrice:_0x393c21,image_prompt:_0xd5aa12}=_0x309065;if(_0x282c5d&&!isNaN(parseFloat(_0x393c21))&&_0xd5aa12){const _0xae2a14=_0x5b8566(0xb1f)+encodeURIComponent(_0xd5aa12);_0x571773={..._0x5e738a,'type':_0x5b8566(0x11f7),'items':[{'name':_0x282c5d,'price':parseFloat(_0x393c21),'imageUrl':_0xae2a14,'quantity':0x1}],'total':parseFloat(_0x393c21),'recipients':_0x309065[_0x5b8566(0xc8e)]||null};}else console['warn'](_0x5b8566(0x1256),_0x309065);break;}case'vote':const _0x346e76=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x137)](_0x2c74b9=>_0x2c74b9[_0x5b8566(0x8af)]===_0x309065[_0x5b8566(0x918)]);_0x346e76&&!_0x346e76[_0x5b8566(0x11ad)]&&(Object[_0x5b8566(0xc30)](_0x346e76[_0x5b8566(0x9ad)])[_0x5b8566(0x103)](_0x1c4288=>{const _0x52f48d=_0x5b8566,_0x26cce5=_0x346e76[_0x52f48d(0x9ad)][_0x1c4288][_0x52f48d(0xac7)](_0x309065[_0x52f48d(0x6fc)]);_0x26cce5>-0x1&&_0x346e76[_0x52f48d(0x9ad)][_0x1c4288][_0x52f48d(0x10f9)](_0x26cce5,0x1);}),!_0x346e76[_0x5b8566(0x9ad)][_0x309065[_0x5b8566(0xf4c)]]&&(_0x346e76[_0x5b8566(0x9ad)][_0x309065[_0x5b8566(0xf4c)]]=[]),!_0x346e76[_0x5b8566(0x9ad)][_0x309065[_0x5b8566(0xf4c)]][_0x5b8566(0xe53)](_0x309065['name'])&&_0x346e76['votes'][_0x309065[_0x5b8566(0xf4c)]][_0x5b8566(0x13ee)](_0x309065['name']),_0x2bf791&&_0x4817d1(_0x57a0d8));continue;case'red_packet':_0x571773={..._0x5e738a,..._0x309065,'totalAmount':_0x309065[_0x5b8566(0x12fc)],'claimedBy':{},'isFullyClaimed':![]};_0x309065[_0x5b8566(0x13f)]&&(_0x571773[_0x5b8566(0xc12)]=_0x309065['receiver'],delete _0x571773[_0x5b8566(0x13f)]);break;case _0x5b8566(0x1045):const _0x129354=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x137)](_0x476096=>_0x476096[_0x5b8566(0x8af)]===_0x309065[_0x5b8566(0xa12)]),_0xe8b6b9=_0x309065['name'],_0x2eea18=_0x3ac84f['members'][_0x5b8566(0x26c)](_0x33dfd4=>_0x33dfd4['originalName']===_0xe8b6b9);if(!_0x2eea18){console[_0x5b8566(0x1155)](_0x5b8566(0x472)+_0xe8b6b9+_0x5b8566(0x3a1));continue;}if(_0x129354&&_0x129354[_0x5b8566(0x13d4)]==='direct'){if(_0x129354[_0x5b8566(0xc12)]!==_0x309065['name']){console[_0x5b8566(0x1155)](_0x5b8566(0x472)+_0x309065[_0x5b8566(0x6fc)]+_0x5b8566(0xae0)+_0x129354[_0x5b8566(0xc12)]+_0x5b8566(0x12f0));continue;}}if(_0x129354&&!_0x129354[_0x5b8566(0xa62)]&&!(_0x129354[_0x5b8566(0x19f)]&&_0x129354[_0x5b8566(0x19f)][_0x309065['name']])){let _0x3ceb2f=0x0;const _0x3b1ff1=_0x129354[_0x5b8566(0xef)]-Object[_0x5b8566(0xd6d)](_0x129354[_0x5b8566(0x19f)]||{})[_0x5b8566(0x213)]((_0x2e0f31,_0x55cfb8)=>_0x2e0f31+_0x55cfb8,0x0),_0x4c2874=_0x129354['count']-Object[_0x5b8566(0xc30)](_0x129354[_0x5b8566(0x19f)]||{})['length'];if(_0x4c2874>0x0){if(_0x129354[_0x5b8566(0x13d4)]===_0x5b8566(0xc33))_0x3ceb2f=_0x129354['totalAmount'];else{if(_0x4c2874===0x1)_0x3ceb2f=_0x3b1ff1;else{const _0xf3521b=0.01,_0x23e66b=_0x3b1ff1-(_0x4c2874-0x1)*_0xf3521b;_0x3ceb2f=Math[_0x5b8566(0x95f)]()*(_0x23e66b-_0xf3521b)+_0xf3521b;}}_0x3ceb2f=parseFloat(_0x3ceb2f[_0x5b8566(0xc89)](0x2));if(!_0x129354[_0x5b8566(0x19f)])_0x129354[_0x5b8566(0x19f)]={};_0x129354[_0x5b8566(0x19f)][_0x309065[_0x5b8566(0x6fc)]]=_0x3ceb2f;const _0x5334c1=_0x3ac84f['members']['find'](_0x3f7f92=>_0x3f7f92[_0x5b8566(0x7de)]===_0x309065['name']),_0x20d1a0=_0x5334c1?_0x5334c1[_0x5b8566(0x287)]:_0x309065[_0x5b8566(0x6fc)],_0x288387=_0x1409fb(_0x3ac84f,_0x129354['senderName']),_0x557f45={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':_0x20d1a0+'\x20领取了\x20'+_0x288387+_0x5b8566(0x2b1),'timestamp':Date[_0x5b8566(0x2b5)]()};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x557f45);let _0x52569a='[系统提示：你\x20('+_0x20d1a0+')\x20成功抢到了\x20'+_0x3ceb2f['toFixed'](0x2)+'\x20元。';if(Object[_0x5b8566(0xc30)](_0x129354[_0x5b8566(0x19f)])[_0x5b8566(0x40f)]>=_0x129354['count']){_0x129354[_0x5b8566(0xa62)]=!![];const _0x39913f={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':_0x288387+_0x5b8566(0xcf4),'timestamp':Date['now']()+0x1};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x39913f);let _0x3ad2fe={'name':'','amount':-0x1};_0x129354[_0x5b8566(0x13d4)]===_0x5b8566(0xa1c)&&_0x129354['count']>0x1&&Object[_0x5b8566(0x1052)](_0x129354[_0x5b8566(0x19f)])['forEach'](([_0x3ee7a7,_0x342118])=>{const _0x5348d5=_0x5b8566;_0x342118>_0x3ad2fe[_0x5348d5(0x12fc)]&&(_0x3ad2fe={'name':_0x3ee7a7,'amount':_0x342118});});if(_0x3ad2fe[_0x5b8566(0x6fc)]){const _0x353aa6=_0x3ac84f[_0x5b8566(0x5d4)]['find'](_0xf8e23d=>_0xf8e23d[_0x5b8566(0x7de)]===_0x3ad2fe['name']),_0x17606e=_0x353aa6?_0x353aa6[_0x5b8566(0x287)]:_0x3ad2fe['name'];_0x52569a+='\x20红包已被领完，手气王是\x20'+_0x17606e+'！';}else _0x52569a+='\x20红包已被领完。';}_0x52569a+=_0x5b8566(0x554);const _0x322077={'role':_0x5b8566(0x905),'content':_0x52569a,'timestamp':Date[_0x5b8566(0x2b5)]()+0x2,'isHidden':!![]};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x322077);}_0x2bf791&&(_0x4817d1(_0x57a0d8),_0x21f6ea());}continue;case _0x5b8566(0x110f):{const _0x16e7e2=_0x3ac84f[_0x5b8566(0x830)]['findIndex'](_0x5f1092=>_0x5f1092[_0x5b8566(0x8af)]===_0x309065[_0x5b8566(0x9c5)]);if(_0x16e7e2>-0x1){const _0x178963=_0x3ac84f[_0x5b8566(0x830)][_0x16e7e2];_0x178963['status']='accepted';}continue;}case'decline_transfer':{const _0x17343b=_0x3ac84f[_0x5b8566(0x830)]['findIndex'](_0x299c11=>_0x299c11[_0x5b8566(0x8af)]===_0x309065[_0x5b8566(0x9c5)]);if(_0x17343b>-0x1){const _0x16e488=_0x3ac84f[_0x5b8566(0x830)][_0x17343b];_0x16e488[_0x5b8566(0x69e)]='declined';const _0x1c011c={'role':_0x5b8566(0x12c3),'senderName':_0x3ac84f[_0x5b8566(0x6fc)],'type':_0x5b8566(0xcda),'isRefund':!![],'amount':_0x16e488[_0x5b8566(0x12fc)],'note':_0x5b8566(0xda6),'timestamp':_0x59fd86++};_0x3ac84f['history'][_0x5b8566(0x13ee)](_0x1c011c),_0x2bf791&&(_0x3c7e84(_0x1c011c,_0x3ac84f),_0x4817d1(_0x57a0d8));}continue;}case _0x5b8566(0x98):if(_0x3ac84f[_0x5b8566(0x1167)]&&_0x309065[_0x5b8566(0x3ef)]){const _0x5a4396=_0x309065[_0x5b8566(0x3ef)][_0x5b8566(0x43a)](),_0x164c34=_0x3ac84f[_0x5b8566(0x5d4)]['map'](_0x34f492=>_0x34f492[_0x5b8566(0x7de)]);if(_0x164c34['includes'](_0x5a4396)){console[_0x5b8566(0x1155)](_0x5b8566(0x1195)+_0x309065['name']+_0x5b8566(0xfb3)+_0x5a4396+_0x5b8566(0xfc9));continue;}_0x3ac84f[_0x5b8566(0x6fc)]=_0x5a4396;const _0x4b9578=_0x3ac84f['members']['find'](_0x57fd4b=>_0x57fd4b[_0x5b8566(0x7de)]===_0x309065['name']),_0x670b40=_0x4b9578?_0x4b9578[_0x5b8566(0x287)]:_0x309065[_0x5b8566(0x6fc)],_0x3dd970={'role':'system','type':_0x5b8566(0xac1),'content':_0x670b40+'\x20将群名修改为\x20“'+_0x3ac84f['name']+'”','timestamp':_0x59fd86++};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x3dd970),_0x2bf791&&(_0x3c7e84(_0x3dd970,_0x3ac84f),document[_0x5b8566(0x64f)](_0x5b8566(0x11ec))['textContent']=_0x3ac84f[_0x5b8566(0x6fc)]);}continue;case _0x5b8566(0x331):if(!_0x3ac84f[_0x5b8566(0x1167)]&&_0x309065['new_name']){const _0x193497=_0x3ac84f['name'],_0x537a4f=_0x309065['new_name']['trim']();if(_0x537a4f&&_0x537a4f!==_0x193497){!_0x3ac84f[_0x5b8566(0x19e)]&&(_0x3ac84f[_0x5b8566(0x19e)]=[]);!_0x3ac84f['nameHistory'][_0x5b8566(0xe53)](_0x193497)&&_0x3ac84f[_0x5b8566(0x19e)][_0x5b8566(0x13ee)](_0x193497);_0x3ac84f[_0x5b8566(0x6fc)]=_0x537a4f;const _0x4a04ea={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':'“'+_0x3ac84f[_0x5b8566(0x7de)]+'”\x20将备注修改为\x20“'+_0x537a4f+'”','timestamp':_0x59fd86++};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x4a04ea);const _0x25c442={'role':_0x5b8566(0x905),'content':'[系统提示：你刚刚成功将自己的备注名修改为了“'+_0x537a4f+_0x5b8566(0x298),'timestamp':_0x59fd86++,'isHidden':!![]};_0x3ac84f[_0x5b8566(0x830)]['push'](_0x25c442),_0x2bf791&&(_0x3c7e84(_0x4a04ea,_0x3ac84f),document[_0x5b8566(0x64f)](_0x5b8566(0x11ec))[_0x5b8566(0xee5)]=_0x537a4f),await _0x4ee9d7(_0x3ac84f);}}continue;case'change_group_avatar':if(_0x3ac84f[_0x5b8566(0x1167)]&&_0x309065[_0x5b8566(0xa7f)]){const _0x4e61fe=_0x309065[_0x5b8566(0xa7f)],_0x6c8b8f=_0x3ac84f['settings']['groupAvatarLibrary']||[],_0x4a842e=_0x6c8b8f['find'](_0x15c0b2=>_0x15c0b2[_0x5b8566(0x6fc)]===_0x4e61fe);if(_0x4a842e){_0x3ac84f['settings']['groupAvatar']=_0x4a842e[_0x5b8566(0xe52)];const _0x285f05=_0x3ac84f['members'][_0x5b8566(0x137)](_0x326faa=>_0x326faa[_0x5b8566(0x7de)]===_0x309065[_0x5b8566(0x6fc)]),_0x5e7618=_0x285f05?_0x285f05['groupNickname']:_0x309065[_0x5b8566(0x6fc)],_0x5d321f={'role':'system','type':_0x5b8566(0xac1),'content':_0x5e7618+_0x5b8566(0xa47),'timestamp':_0x59fd86++};_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x5d321f),_0x2bf791&&_0x3c7e84(_0x5d321f,_0x3ac84f);}else console[_0x5b8566(0x1155)](_0x5b8566(0x6dc)+_0x4e61fe+'\x22');}continue;case _0x5b8566(0x9d5):_0x571773={'role':_0x5b8566(0x905),'type':_0x5b8566(0xac1),'content':_0x309065[_0x5b8566(0x3ba)],'timestamp':Date[_0x5b8566(0x2b5)]()};break;case _0x5b8566(0x460):_0x571773={..._0x5e738a,'type':_0x5b8566(0x460),'title':_0x309065['title'],'description':_0x309065[_0x5b8566(0x9af)],'source_name':_0x309065['source_name'],'content':_0x309065[_0x5b8566(0x3ba)]};break;case _0x5b8566(0x94d):const _0x1de452=_0x3ac84f[_0x5b8566(0x830)]['find'](_0x5e71d7=>_0x5e71d7[_0x5b8566(0x8af)]===_0x309065[_0x5b8566(0xf0b)]);if(_0x1de452){const _0x11e5c2={'timestamp':_0x1de452['timestamp'],'senderName':_0x1de452[_0x5b8566(0x133d)]||(_0x1de452[_0x5b8566(0x931)]===_0x5b8566(0xa4d)?_0x3ac84f['settings'][_0x5b8566(0x96f)]||'我':_0x3ac84f['name']),'content':String(_0x1de452[_0x5b8566(0x3ba)]||'')['substring'](0x0,0x32)};_0x571773={..._0x5e738a,'content':_0x309065[_0x5b8566(0x13d3)],'quote':_0x11e5c2};}else _0x571773={..._0x5e738a,'content':_0x309065['reply_content']};break;case'send_and_recall':{if(!_0x2bf791)continue;const _0x554c4d={..._0x5e738a,'content':_0x309065[_0x5b8566(0x3ba)]},_0x1c802a=_0x3209f4(_0x554c4d,_0x3ac84f);_0x3c7e84(_0x554c4d,_0x3ac84f,!![]),await new Promise(_0x1387bd=>setTimeout(_0x1387bd,Math[_0x5b8566(0x95f)]()*0x3e8+0x5dc));const _0x1e4a6c=document[_0x5b8566(0x49c)](_0x5b8566(0x15c)+_0x554c4d['timestamp']+'\x22]')?.['closest'](_0x5b8566(0xad2));if(_0x1e4a6c){_0x1e4a6c[_0x5b8566(0x418)][_0x5b8566(0xdda)](_0x5b8566(0x8b4)),await new Promise(_0x4fed70=>setTimeout(_0x4fed70,0x12c));const _0x3db49c={'role':'assistant','senderName':_0x309065[_0x5b8566(0x6fc)]||_0x3ac84f[_0x5b8566(0x6fc)],'type':_0x5b8566(0x11f2),'content':_0x5b8566(0x365),'timestamp':_0x554c4d['timestamp'],'recalledData':{'originalType':_0x5b8566(0x673),'originalContent':_0x309065['content']}},_0x5dae1a=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x6a2)](_0x4f24bc=>_0x4f24bc[_0x5b8566(0x8af)]===_0x554c4d[_0x5b8566(0x8af)]);_0x5dae1a>-0x1?_0x3ac84f[_0x5b8566(0x830)][_0x5dae1a]=_0x3db49c:_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x3db49c);const _0x52b425=await _0x3209f4(_0x3db49c,_0x3ac84f);document[_0x5b8566(0x872)]['contains'](_0x1e4a6c)&&_0x1e4a6c[_0x5b8566(0x9be)][_0x5b8566(0x3d4)](_0x52b425,_0x1e4a6c);}continue;}case _0x5b8566(0x673):_0x571773={..._0x5e738a,'content':String(_0x309065[_0x5b8566(0x3ba)]||_0x309065[_0x5b8566(0x854)])};break;case'sticker':if(_0x309065[_0x5b8566(0x10b3)]){const _0x374109=_0x3e7a1b[_0x5b8566(0xa8b)][_0x5b8566(0x137)](_0x7ba118=>_0x7ba118[_0x5b8566(0x6fc)]===_0x309065[_0x5b8566(0x10b3)]);_0x374109?_0x571773={..._0x5e738a,'type':_0x5b8566(0xefb),'content':_0x374109[_0x5b8566(0xe52)],'meaning':_0x374109[_0x5b8566(0x6fc)]}:(console[_0x5b8566(0x1155)](_0x5b8566(0x84f)+_0x309065[_0x5b8566(0x10b3)]+'\x22'),_0x571773={..._0x5e738a,'type':'text','content':_0x5b8566(0x7af)+_0x309065[_0x5b8566(0x10b3)]+']'});}else console[_0x5b8566(0x1155)](_0x5b8566(0xbf0),_0x309065),_0x571773={..._0x5e738a,'type':'sticker','content':_0x309065['url'],'meaning':'未知表情'};break;case _0x5b8566(0x118):_0x571773={..._0x5e738a,'type':'ai_image','content':_0x309065['description'],'image_prompt':_0x309065[_0x5b8566(0x242)]};break;case _0x5b8566(0xe76):_0x571773={..._0x5e738a,'type':'voice_message','content':_0x309065['content']};break;case'transfer':_0x571773={..._0x5e738a,'type':_0x5b8566(0xcda),'amount':_0x309065[_0x5b8566(0x12fc)],'note':_0x309065[_0x5b8566(0x939)],'receiverName':_0x309065[_0x5b8566(0x13f)]||'我'};break;case _0x5b8566(0x1034):_0x571773={..._0x5e738a,'type':_0x5b8566(0x1034),'productInfo':_0x309065[_0x5b8566(0xec5)],'amount':_0x309065[_0x5b8566(0x12fc)],'status':_0x5b8566(0x8ee),'countdownEndTime':Date[_0x5b8566(0x2b5)]()+0xf*0x3c*0x3e8};break;case _0x5b8566(0xd20):_0x571773={..._0x5e738a,'type':_0x5b8566(0xd20),'productInfo':_0x309065['productInfo'],'amount':_0x309065[_0x5b8566(0x12fc)],'greeting':_0x309065[_0x5b8566(0xdf9)],'recipientName':_0x309065[_0x5b8566(0xce7)]||null};break;case _0x5b8566(0x9cb):_0x571773={..._0x5e738a,..._0x309065};break;case'naiimag':try{console[_0x5b8566(0x1081)](_0x5b8566(0xc45),_0x309065['prompt']);const _0x38503d=_0x2579ab(_0x3ac84f['id']),_0x4fe8fd=_0x309065['prompt']||_0x5b8566(0x1395),_0x53e4b3=_0x4fe8fd+',\x20'+_0x38503d[_0x5b8566(0x7e)],_0x1a2b90=_0x38503d[_0x5b8566(0x259)];console[_0x5b8566(0x1081)]('📝\x20使用'+(_0x38503d['source']===_0x5b8566(0x186)?_0x5b8566(0x129d):'系统')+'提示词配置'),console[_0x5b8566(0x1081)](_0x5b8566(0x1117),_0x53e4b3),console[_0x5b8566(0x1081)]('最终负面提示词:',_0x1a2b90);const _0x57f583=localStorage[_0x5b8566(0x2f5)](_0x5b8566(0x427)),_0x31c645=localStorage[_0x5b8566(0x2f5)]('novelai-model')||_0x5b8566(0x11b8),_0x28a454=_0x4c8f8e();if(!_0x57f583)throw new Error(_0x5b8566(0x2e2));const [_0x54e684,_0x50f58c]=_0x28a454['resolution']['split']('x')[_0x5b8566(0xb96)](Number);let _0x52edec;_0x31c645['includes'](_0x5b8566(0xcef))?_0x52edec={'input':_0x53e4b3,'model':_0x31c645,'action':_0x5b8566(0x8e1),'parameters':{'params_version':0x3,'width':_0x54e684,'height':_0x50f58c,'scale':_0x28a454[_0x5b8566(0x11cf)],'sampler':_0x28a454[_0x5b8566(0xcf3)],'steps':_0x28a454[_0x5b8566(0x10df)],'seed':_0x28a454['seed']===-0x1?Math[_0x5b8566(0x1245)](Math[_0x5b8566(0x95f)]()*0x2540be3ff):_0x28a454[_0x5b8566(0xf48)],'n_samples':0x1,'ucPreset':_0x28a454[_0x5b8566(0xf13)],'qualityToggle':_0x28a454[_0x5b8566(0x1065)],'autoSmea':![],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':!![],'cfg_rescale':0x0,'noise_schedule':_0x5b8566(0x1298),'legacy_v3_extend':![],'skip_cfg_above_sigma':null,'use_coords':![],'legacy_uc':![],'normalize_reference_strength_multiple':!![],'inpaintImg2ImgStrength':0x1,'characterPrompts':[],'v4_prompt':{'caption':{'base_caption':_0x53e4b3,'char_captions':[]},'use_coords':![],'use_order':!![]},'v4_negative_prompt':{'caption':{'base_caption':_0x1a2b90,'char_captions':[]},'legacy_uc':![]},'negative_prompt':_0x1a2b90,'deliberate_euler_ancestral_bug':![],'prefer_brownian':!![]}}:_0x52edec={'input':_0x53e4b3,'model':_0x31c645,'action':_0x5b8566(0x8e1),'parameters':{'width':_0x54e684,'height':_0x50f58c,'scale':_0x28a454[_0x5b8566(0x11cf)],'sampler':_0x28a454[_0x5b8566(0xcf3)],'steps':_0x28a454[_0x5b8566(0x10df)],'seed':_0x28a454[_0x5b8566(0xf48)]===-0x1?Math[_0x5b8566(0x1245)](Math['random']()*0x2540be3ff):_0x28a454[_0x5b8566(0xf48)],'n_samples':0x1,'ucPreset':_0x28a454['uc_preset'],'qualityToggle':_0x28a454[_0x5b8566(0x1065)],'sm':_0x28a454[_0x5b8566(0x787)],'sm_dyn':_0x28a454[_0x5b8566(0xe4b)],'dynamic_thresholding':![],'controlnet_strength':0x1,'legacy':![],'add_original_image':![],'cfg_rescale':0x0,'noise_schedule':_0x5b8566(0x4eb),'negative_prompt':_0x1a2b90}};console[_0x5b8566(0x1081)](_0x5b8566(0x1170),_0x52edec);let _0x37b7fc;_0x31c645[_0x5b8566(0xe53)](_0x5b8566(0xcef))?_0x37b7fc=_0x5b8566(0x9de):_0x37b7fc=_0x5b8566(0x13c8);let _0x27b1f0=_0x28a454[_0x5b8566(0x7b9)];_0x27b1f0===_0x5b8566(0xea0)&&(_0x27b1f0=_0x28a454[_0x5b8566(0x5c3)]||'');_0x27b1f0&&_0x27b1f0!==''&&(_0x37b7fc=_0x27b1f0+encodeURIComponent(_0x37b7fc));const _0x47bc58=await fetch(_0x37b7fc,{'method':'POST','headers':{'Content-Type':_0x5b8566(0x7fe),'Authorization':'Bearer\x20'+_0x57f583},'body':JSON[_0x5b8566(0xe3f)](_0x52edec)});console['log']('Response\x20status:',_0x47bc58[_0x5b8566(0x69e)]),console[_0x5b8566(0x1081)](_0x5b8566(0x22d),[..._0x47bc58[_0x5b8566(0x3e5)][_0x5b8566(0x1052)]()]);if(!_0x47bc58['ok']){const _0x46d8b0=await _0x47bc58['text']();console[_0x5b8566(0xc60)](_0x5b8566(0x10b9),_0x46d8b0);throw new Error(_0x5b8566(0x123f)+_0x47bc58['status']+_0x5b8566(0xc1c)+_0x46d8b0);}const _0x16ab2=_0x47bc58['headers']['get'](_0x5b8566(0x68b));console[_0x5b8566(0x1081)](_0x5b8566(0xe2e),_0x16ab2);let _0x176ce4,_0x570a3c;if(_0x16ab2&&_0x16ab2[_0x5b8566(0xe53)]('text/event-stream')){console[_0x5b8566(0x1081)](_0x5b8566(0x3f6));const _0x2b37dc=await _0x47bc58['text']();console[_0x5b8566(0x1081)](_0x5b8566(0x11e8),_0x2b37dc[_0x5b8566(0x40f)]);const _0x49f65a=_0x2b37dc[_0x5b8566(0x43a)]()['split']('\x0a');let _0x1a8a46=null;for(let _0x5bd90a=_0x49f65a[_0x5b8566(0x40f)]-0x1;_0x5bd90a>=0x0;_0x5bd90a--){const _0x2f468a=_0x49f65a[_0x5bd90a]['trim']();if(_0x2f468a[_0x5b8566(0x7d)]('data:\x20')&&_0x2f468a!==_0x5b8566(0x496)){const _0xa49a15=_0x2f468a[_0x5b8566(0x126f)](0x6);try{const _0x6943e3=JSON[_0x5b8566(0x1214)](_0xa49a15);if(_0x6943e3[_0x5b8566(0x561)]===_0x5b8566(0x723)&&_0x6943e3[_0x5b8566(0x980)]){_0x1a8a46=_0x6943e3[_0x5b8566(0x980)],console['log'](_0x5b8566(0x6e9));break;}if(_0x6943e3[_0x5b8566(0x88a)]){_0x1a8a46=_0x6943e3['data'],console[_0x5b8566(0x1081)](_0x5b8566(0xd55));break;}if(_0x6943e3['image']){_0x1a8a46=_0x6943e3['image'],console['log'](_0x5b8566(0xca));break;}}catch(_0x312a1c){_0x1a8a46=_0xa49a15,console[_0x5b8566(0x1081)](_0x5b8566(0x885));break;}}}if(!_0x1a8a46)throw new Error(_0x5b8566(0x3cc));const _0x4557f4=_0x1a8a46[_0x5b8566(0x7d)]('iVBORw0KGgo'),_0x21e9d3=_0x1a8a46['startsWith'](_0x5b8566(0x102c));if(_0x4557f4||_0x21e9d3){console['log'](_0x5b8566(0xd0f));const _0x3548ce=atob(_0x1a8a46),_0x14838f=new Uint8Array(_0x3548ce['length']);for(let _0x2d7d53=0x0;_0x2d7d53<_0x3548ce[_0x5b8566(0x40f)];_0x2d7d53++){_0x14838f[_0x2d7d53]=_0x3548ce['charCodeAt'](_0x2d7d53);}const _0xa31366=new Blob([_0x14838f],{'type':_0x4557f4?_0x5b8566(0xc99):_0x5b8566(0xc4)});console[_0x5b8566(0x1081)](_0x5b8566(0x624),_0xa31366[_0x5b8566(0x9dd)]);const _0x453362=new FileReader();_0x570a3c=await new Promise((_0x535136,_0x9b7311)=>{const _0x140ea2=_0x5b8566;_0x453362[_0x140ea2(0x6e6)]=()=>_0x535136(_0x453362[_0x140ea2(0x8f)]),_0x453362[_0x140ea2(0x36b)]=_0x9b7311,_0x453362[_0x140ea2(0xb4)](_0xa31366);}),console[_0x5b8566(0x1081)](_0x5b8566(0xdbd));}else{console[_0x5b8566(0x1081)]('当作\x20ZIP\x20文件处理...');const _0x4c2d55=atob(_0x1a8a46),_0x89672c=new Uint8Array(_0x4c2d55[_0x5b8566(0x40f)]);for(let _0x559aec=0x0;_0x559aec<_0x4c2d55[_0x5b8566(0x40f)];_0x559aec++){_0x89672c[_0x559aec]=_0x4c2d55[_0x5b8566(0x150)](_0x559aec);}_0x176ce4=new Blob([_0x89672c]),console[_0x5b8566(0x1081)](_0x5b8566(0xe3c),_0x176ce4[_0x5b8566(0x9dd)]);}}else _0x176ce4=await _0x47bc58[_0x5b8566(0x1231)](),console[_0x5b8566(0x1081)](_0x5b8566(0xa50),_0x176ce4[_0x5b8566(0xafc)],'大小:',_0x176ce4[_0x5b8566(0x9dd)]);if(!_0x570a3c&&_0x176ce4)try{if(typeof JSZip===_0x5b8566(0x3a3))throw new Error(_0x5b8566(0x16f));const _0x51b1ae=await JSZip[_0x5b8566(0x7f4)](_0x176ce4);console['log'](_0x5b8566(0x65c),Object['keys'](_0x51b1ae[_0x5b8566(0x91e)]));let _0x53d12f=null;for(let _0x1f6134 in _0x51b1ae[_0x5b8566(0x91e)]){if(_0x1f6134[_0x5b8566(0x132a)](/\.(png|jpg|jpeg|webp)$/i)){_0x53d12f=_0x51b1ae[_0x5b8566(0x91e)][_0x1f6134],console[_0x5b8566(0x1081)](_0x5b8566(0x478),_0x1f6134);break;}}if(!_0x53d12f)throw new Error(_0x5b8566(0x94b));const _0x4527fa=await _0x53d12f[_0x5b8566(0x89c)]('blob');console['log']('提取的图片大小:',_0x4527fa['size']);const _0x2672fd=new FileReader();_0x570a3c=await new Promise((_0x580bb9,_0x1d6fc6)=>{const _0x344af3=_0x5b8566;_0x2672fd[_0x344af3(0x6e6)]=()=>_0x580bb9(_0x2672fd['result']),_0x2672fd[_0x344af3(0x36b)]=_0x1d6fc6,_0x2672fd['readAsDataURL'](_0x4527fa);}),console[_0x5b8566(0x1081)](_0x5b8566(0x2ae));}catch(_0xae4363){console[_0x5b8566(0xc60)](_0x5b8566(0x5d6),_0xae4363);throw new Error('图片解压失败:\x20'+_0xae4363['message']);}console[_0x5b8566(0x1081)]('✅\x20NAI图片生成成功！'),_0x571773={..._0x5e738a,'type':'naiimag','imageUrl':_0x570a3c,'prompt':_0x4fe8fd,'fullPrompt':_0x53e4b3};}catch(_0x5908be){console[_0x5b8566(0xc60)]('❌\x20NAI图片生成失败:',_0x5908be),_0x571773={..._0x5e738a,'content':_0x5b8566(0x1175)+_0x5908be[_0x5b8566(0x854)]+']'};}break;default:console['warn'](_0x5b8566(0x4e3),_0x309065['type']);break;}if(_0x571773){_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x13ee)](_0x571773);!_0x2bf791&&(_0x3ac84f[_0x5b8566(0x13c0)]=(_0x3ac84f[_0x5b8566(0x13c0)]||0x0)+0x1);if(!_0x2bf791&&!_0x53501b){let _0xabbd03;switch(_0x571773[_0x5b8566(0xafc)]){case _0x5b8566(0xcda):_0xabbd03='[收到一笔转账]';break;case'waimai_request':_0xabbd03=_0x5b8566(0x20e);break;case _0x5b8566(0x118):_0xabbd03=_0x5b8566(0x26a);break;case _0x5b8566(0xe76):_0xabbd03=_0x5b8566(0x28a);break;case _0x5b8566(0xefb):_0xabbd03=_0x571773[_0x5b8566(0x10b3)]?_0x5b8566(0x7af)+_0x571773[_0x5b8566(0x10b3)]+']':'[表情]';break;case _0x5b8566(0x9cb):_0xabbd03=_0x571773[_0x5b8566(0x344)]?'「'+_0x571773[_0x5b8566(0x344)]+'」':'['+_0x571773[_0x5b8566(0x9af)][_0x5b8566(0x126f)](0x0,0x14)+_0x5b8566(0xe4);break;default:_0xabbd03=String(_0x571773[_0x5b8566(0x3ba)]||'');}const _0x2b4e10=_0x3ac84f[_0x5b8566(0x1167)]?_0x571773[_0x5b8566(0x133d)]+':\x20'+_0xabbd03:_0xabbd03;_0x1c47b3(_0x57a0d8,_0x2b4e10[_0x5b8566(0x126f)](0x0,0x28)+(_0x2b4e10[_0x5b8566(0x40f)]>0x28?_0x5b8566(0x3cd):'')),_0x53501b=!![];}_0x2bf791&&(_0x3c7e84(_0x571773,_0x3ac84f),await new Promise(_0x5d59af=>setTimeout(_0x5d59af,Math[_0x5b8566(0x95f)]()*0x708+0x3e8)));}}_0x51e761&&_0x42b67f[_0x5b8566(0xeee)]&&(_0x42b67f['isAwaitingResponse']=![],_0x42b67f['participants']['length']>0x0?_0xa524bc():(_0x42b67f={..._0x42b67f,'isAwaitingResponse':![],'participants':[]},_0xddd8ae(_0x5b8566(0x9aa)),alert(_0x5b8566(0xe5))));if(_0x245404){await _0x20a638();return;}await _0x4e1bbf[_0x5b8566(0x999)][_0x5b8566(0x4fa)](_0x3ac84f);const _0xbeed0e=_0x32cba7[_0x5b8566(0x26c)](_0x414de3=>_0x414de3[_0x5b8566(0xafc)]===_0x5b8566(0x5e8)||_0x414de3[_0x5b8566(0xafc)]===_0x5b8566(0xc3c)||_0x414de3['type']===_0x5b8566(0xbf2)||_0x414de3[_0x5b8566(0xafc)]===_0x5b8566(0xe5a));_0xbeed0e&&(console[_0x5b8566(0x1081)]('检测到AI执行了动态操作，立即刷新好友动态页面。'),await _0x40e6dd());}catch(_0x5c14ae){_0x3ac84f[_0x5b8566(0x830)]=_0x3ac84f[_0x5b8566(0x830)][_0x5b8566(0x156)](_0x482089=>!_0x482089['isTemporary']),!_0x3ac84f[_0x5b8566(0x1167)]&&_0x3ac84f['relationship']?.[_0x5b8566(0x69e)]===_0x5b8566(0x943)?(_0x3ac84f[_0x5b8566(0x55f)][_0x5b8566(0x69e)]=_0x5b8566(0x103f),await _0x28974b(_0x5b8566(0x13b7),_0x5b8566(0x1243)+_0x5c14ae[_0x5b8566(0x854)])):await _0x28974b('API\x20调用失败',_0x5b8566(0x491)+_0x5c14ae[_0x5b8566(0x854)]),!_0x3ac84f[_0x5b8566(0x1167)]&&_0x3ac84f[_0x5b8566(0x55f)]?.[_0x5b8566(0x69e)]===_0x5b8566(0x103f)&&await _0x4e1bbf[_0x5b8566(0x999)][_0x5b8566(0x4fa)](_0x3ac84f),_0x42b67f[_0x5b8566(0x7f0)]=![];}finally{_0x570655(_0x57a0d8,![]),_0x3ac84f['isGroup']?_0x1a1c76&&(_0x1a1c76[_0x5b8566(0x731)][_0x5b8566(0x130)]=_0x5b8566(0x1209)):_0x58c2c1&&_0x3e7a1b[_0x5b8566(0x999)][_0x57a0d8]&&(_0x58c2c1[_0x5b8566(0x731)][_0x5b8566(0x131a)]=0x0,setTimeout(()=>{const _0x27e84d=_0x5b8566;_0x58c2c1[_0x27e84d(0xee5)]=_0x3e7a1b[_0x27e84d(0x999)][_0x57a0d8][_0x27e84d(0x6fc)],_0x58c2c1[_0x27e84d(0x418)][_0x27e84d(0x1275)](_0x27e84d(0x850)),_0x58c2c1[_0x27e84d(0x731)][_0x27e84d(0x131a)]=0x1;},0xc8)),_0x21f6ea(),_0x2551f7&&_0xd14fdc(_0x57a0d8),_0xb6bc2c();}}async function _0xc8a379(_0xec87b7){const _0xc46bcc=_0x5a7792;if(!_0x3e7a1b[_0xc46bcc(0x777)])return;const _0x3f6e6d=_0x3e7a1b[_0xc46bcc(0x999)][_0x3e7a1b[_0xc46bcc(0x777)]],_0x4d7505={'role':_0xc46bcc(0xa4d),'content':_0xec87b7[_0xc46bcc(0xe52)],'meaning':_0xec87b7[_0xc46bcc(0x6fc)],'timestamp':Date['now']()};_0x3f6e6d['history'][_0xc46bcc(0x13ee)](_0x4d7505),await _0x4e1bbf[_0xc46bcc(0x999)]['put'](_0x3f6e6d),_0x3c7e84(_0x4d7505,_0x3f6e6d),_0x21f6ea(),document[_0xc46bcc(0x64f)](_0xc46bcc(0x111f))[_0xc46bcc(0x418)][_0xc46bcc(0x1275)](_0xc46bcc(0x40a));}async function _0x41132d(){const _0x132bda=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0xa719ca=document['getElementById'](_0x132bda(0xc88)),_0x173c28=document[_0x132bda(0x64f)]('transfer-note'),_0x302ae3=parseFloat(_0xa719ca[_0x132bda(0xbed)]),_0x1abe22=_0x173c28[_0x132bda(0xbed)]['trim']();if(isNaN(_0x302ae3)||_0x302ae3<0x0){alert('请输入有效的金额(必须大于0)！');return;}const _0x193f9e=_0x3e7a1b[_0x132bda(0x999)][_0x3e7a1b[_0x132bda(0x777)]],_0x5e53b1=_0x193f9e[_0x132bda(0x1167)]?_0x193f9e[_0x132bda(0xcb3)][_0x132bda(0x96f)]||'我':'我',_0x4642ff=_0x193f9e['isGroup']?'群聊':_0x193f9e['name'],_0x4cba63={'role':_0x132bda(0xa4d),'type':'transfer','amount':_0x302ae3,'note':_0x1abe22,'senderName':_0x5e53b1,'receiverName':_0x4642ff,'timestamp':Date[_0x132bda(0x2b5)]()};_0x193f9e[_0x132bda(0x830)][_0x132bda(0x13ee)](_0x4cba63),await _0x4e1bbf[_0x132bda(0x999)][_0x132bda(0x4fa)](_0x193f9e),_0x3c7e84(_0x4cba63,_0x193f9e),_0x21f6ea(),document[_0x132bda(0x64f)]('transfer-modal')['classList']['remove'](_0x132bda(0x40a)),_0xa719ca[_0x132bda(0xbed)]='',_0x173c28[_0x132bda(0xbed)]='';}async function _0xf8f04a(){const _0x35e0a6=_0x5a7792;if(!_0x3e7a1b[_0x35e0a6(0x777)])return;const _0x1237fe=document['getElementById']('waimai-product-info'),_0x543e19=document['getElementById'](_0x35e0a6(0xf33)),_0x5471f4=_0x1237fe[_0x35e0a6(0xbed)]['trim'](),_0x1fe331=parseFloat(_0x543e19[_0x35e0a6(0xbed)]);if(!_0x5471f4||isNaN(_0x1fe331)||_0x1fe331<=0x0){alert(_0x35e0a6(0xe62));return;}const _0x5a54ca=_0x3e7a1b['chats'][_0x3e7a1b[_0x35e0a6(0x777)]],_0x4dae51=Date[_0x35e0a6(0x2b5)](),_0x7e4764=_0x5a54ca['isGroup']?_0x5a54ca['settings'][_0x35e0a6(0x96f)]||'我':'我',_0x31936c={'role':'user','senderName':_0x7e4764,'type':_0x35e0a6(0xd20),'productInfo':_0x5471f4,'amount':_0x1fe331,'timestamp':_0x4dae51};_0x5a54ca['history'][_0x35e0a6(0x13ee)](_0x31936c);const _0x159448={'role':_0x35e0a6(0x905),'content':'[系统提示：用户('+_0x7e4764+_0x35e0a6(0x13e4)+_0x5471f4+'”，价值'+_0x1fe331+'元。这不是一个代付请求，而是用户已经为你支付了。请你对此表示感谢。]','timestamp':_0x4dae51+0x1,'isHidden':!![]};_0x5a54ca[_0x35e0a6(0x830)][_0x35e0a6(0x13ee)](_0x159448),await _0x4e1bbf[_0x35e0a6(0x999)][_0x35e0a6(0x4fa)](_0x5a54ca),_0x3c7e84(_0x31936c,_0x5a54ca),_0x21f6ea(),_0x1237fe[_0x35e0a6(0xbed)]='',_0x543e19['value']='',document[_0x35e0a6(0x64f)](_0x35e0a6(0x321))[_0x35e0a6(0x418)][_0x35e0a6(0x1275)](_0x35e0a6(0x40a));}async function _0x4fd2ec(){const _0x315e9b=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x2d5c12=await _0x41e3f8('共享位置','你现在在哪里呀？','');if(!_0x2d5c12||!_0x2d5c12[_0x315e9b(0x43a)]())return;const _0x5f105d=_0x315e9b(0x2e4),_0x5ef692=_0x3e7a1b[_0x315e9b(0x999)][_0x3e7a1b[_0x315e9b(0x777)]],_0x3c054c={'role':_0x315e9b(0xa4d),'type':'location_share','content':_0x2d5c12[_0x315e9b(0x43a)](),'imageUrl':_0x5f105d,'timestamp':Date[_0x315e9b(0x2b5)]()};_0x5ef692['history'][_0x315e9b(0x13ee)](_0x3c054c),await _0x4e1bbf[_0x315e9b(0x999)]['put'](_0x5ef692),_0x3c7e84(_0x3c054c,_0x5ef692),_0x21f6ea();}function _0x23c2e7(_0x23382d){const _0x1a8a66=_0x5a7792;if(_0x2a27ef)return;_0x2a27ef=!![],document['getElementById']('chat-interface-screen')['classList'][_0x1a8a66(0xdda)](_0x1a8a66(0x2c5)),_0x2ecd49(_0x23382d);}function _0x5ec8b6(){const _0x1877e1=_0x5a7792;_0x59f355();if(!_0x2a27ef)return;_0x2a27ef=![],document[_0x1877e1(0x64f)](_0x1877e1(0x9aa))[_0x1877e1(0x418)][_0x1877e1(0x1275)]('selection-mode'),_0x3b4859['forEach'](_0x501c87=>{const _0x3ec60c=_0x1877e1,_0xf1573c=document['querySelector'](_0x3ec60c(0x15c)+_0x501c87+'\x22]');if(_0xf1573c)_0xf1573c['classList'][_0x3ec60c(0x1275)]('selected');}),_0x3b4859[_0x1877e1(0x1057)]();}function _0x2ecd49(_0x5c6a78){const _0x1b1869=_0x5a7792,_0x21d189=document[_0x1b1869(0x49c)](_0x1b1869(0x15c)+_0x5c6a78+'\x22]');if(!_0x21d189)return;_0x3b4859[_0x1b1869(0x2a6)](_0x5c6a78)?(_0x3b4859[_0x1b1869(0x3aa)](_0x5c6a78),_0x21d189[_0x1b1869(0x418)]['remove'](_0x1b1869(0xbe6))):(_0x3b4859[_0x1b1869(0xdda)](_0x5c6a78),_0x21d189['classList'][_0x1b1869(0xdda)](_0x1b1869(0xbe6))),document['getElementById'](_0x1b1869(0x302))[_0x1b1869(0xee5)]=_0x1b1869(0xb3)+_0x3b4859[_0x1b1869(0x9dd)]+'\x20条',_0x3b4859[_0x1b1869(0x9dd)]===0x0&&_0x5ec8b6();}function _0xb407a5(_0x4ea830,_0x1d5318){const _0x21c7a2=_0x5a7792;let _0x1d037c;const _0x1e48ba=_0x30eec5=>{const _0x1c21a2=_0x2bd6;if(_0x2a27ef)return;_0x30eec5[_0x1c21a2(0x8d1)](),_0x1d037c=window[_0x1c21a2(0xfed)](()=>_0x1d5318(_0x30eec5),0x1f4);},_0x5af07b=()=>clearTimeout(_0x1d037c);_0x4ea830[_0x21c7a2(0xf72)](_0x21c7a2(0x48d),_0x1e48ba),_0x4ea830[_0x21c7a2(0xf72)](_0x21c7a2(0x733),_0x5af07b),_0x4ea830[_0x21c7a2(0xf72)](_0x21c7a2(0xfa5),_0x5af07b),_0x4ea830[_0x21c7a2(0xf72)](_0x21c7a2(0x467),_0x1e48ba,{'passive':!![]}),_0x4ea830[_0x21c7a2(0xf72)](_0x21c7a2(0x6b2),_0x5af07b),_0x4ea830['addEventListener'](_0x21c7a2(0xe0d),_0x5af07b);}async function _0x1819d1(){const _0x41e5c0=_0x5a7792,_0x4ae5be=_0x3e7a1b[_0x41e5c0(0x777)];if(!_0x4ae5be)return;if(!_0x1c083c['isActive']){_0x500359(_0x4ae5be);return;}if(_0x1c083c['activeChatId']===_0x4ae5be)document[_0x41e5c0(0x64f)](_0x41e5c0(0xa8f))['classList'][_0x41e5c0(0xdda)](_0x41e5c0(0x40a));else{const _0x264fb2=_0x3e7a1b[_0x41e5c0(0x999)][_0x1c083c[_0x41e5c0(0x777)]]?.[_0x41e5c0(0x6fc)]||'未知',_0x524fab=_0x3e7a1b['chats'][_0x4ae5be]?.[_0x41e5c0(0x6fc)]||'当前',_0x33f8b8=await _0x54149f(_0x41e5c0(0xbf),_0x41e5c0(0x553)+_0x264fb2+_0x41e5c0(0x2a9)+_0x524fab+_0x41e5c0(0xc61),{'confirmButtonClass':'btn-danger'});_0x33f8b8&&(await _0x19d084(!![]),await new Promise(_0x267498=>setTimeout(_0x267498,0x32)),_0x500359(_0x4ae5be));}}async function _0x500359(_0x4d5361){const _0x9fd54f=_0x5a7792,_0x526c78=_0x3e7a1b['chats'][_0x4d5361];if(!_0x526c78)return;_0x1c083c[_0x9fd54f(0xd4c)]=_0x526c78['musicData'][_0x9fd54f(0x47c)]||0x0,_0x1c083c['isActive']=!![],_0x1c083c['activeChatId']=_0x4d5361;_0x1c083c['playlist']['length']>0x0?_0x1c083c['currentIndex']=0x0:_0x1c083c[_0x9fd54f(0x409)]=-0x1;if(_0x1c083c[_0x9fd54f(0x63c)])clearInterval(_0x1c083c[_0x9fd54f(0x63c)]);_0x1c083c[_0x9fd54f(0x63c)]=setInterval(()=>{_0x1c083c['isPlaying']&&(_0x1c083c['totalElapsedTime']++,_0x1ae09e());},0x3e8),_0x320333(),_0x36d83c(),document[_0x9fd54f(0x64f)]('music-player-overlay')[_0x9fd54f(0x418)][_0x9fd54f(0xdda)]('visible');}async function _0x19d084(_0x1cd2d4=!![]){const _0x531bf3=_0x5a7792;if(!_0x1c083c[_0x531bf3(0xb30)])return;const _0x485a11=_0x1c083c[_0x531bf3(0x777)];document['getElementById'](_0x531bf3(0x9fc))[_0x531bf3(0x418)][_0x531bf3(0x1275)]('visible');const _0x4d22fd=async()=>{const _0x3a1e2b=_0x531bf3;if(_0x1c083c['timerId'])clearInterval(_0x1c083c['timerId']);if(_0x1c083c[_0x3a1e2b(0xad6)])_0x51e4a1[_0x3a1e2b(0x6ef)]();if(_0x1cd2d4&&_0x485a11&&_0x3e7a1b[_0x3a1e2b(0x999)][_0x485a11]){const _0x5cfaa7=_0x3e7a1b[_0x3a1e2b(0x999)][_0x485a11];_0x5cfaa7[_0x3a1e2b(0x132f)][_0x3a1e2b(0x47c)]=_0x1c083c[_0x3a1e2b(0xd4c)],await _0x4e1bbf[_0x3a1e2b(0x999)][_0x3a1e2b(0x4fa)](_0x5cfaa7);}_0x1c083c['isActive']=![],_0x1c083c[_0x3a1e2b(0x777)]=null,_0x1c083c[_0x3a1e2b(0xd4c)]=0x0,_0x1c083c[_0x3a1e2b(0x63c)]=null,_0x2d6be3(_0x485a11,!![]);};_0x185356(_0x4d22fd);}function _0x22c00a(){_0x185356();}function _0x2d6be3(_0x59b430,_0x52c0fd=![]){const _0x2b77f7=_0x5a7792,_0x51d007=document[_0x2b77f7(0x49c)](_0x2b77f7(0x1374));if(!_0x51d007)return;if(_0x52c0fd||!_0x1c083c[_0x2b77f7(0xb30)]||_0x1c083c[_0x2b77f7(0x777)]!==_0x59b430){_0x51d007[_0x2b77f7(0xbe8)]=_0x2b77f7(0x1110),_0x51d007[_0x2b77f7(0x87d)]='';return;}_0x51d007[_0x2b77f7(0xbe8)]=_0x2b77f7(0x719),_0x51d007[_0x2b77f7(0x418)]['add'](_0x2b77f7(0x6bb));if(_0x1c083c[_0x2b77f7(0xad6)])_0x51d007[_0x2b77f7(0x418)][_0x2b77f7(0x1275)](_0x2b77f7(0x10b0));else _0x51d007[_0x2b77f7(0x418)][_0x2b77f7(0xdda)](_0x2b77f7(0x10b0));}window['updateListenTogetherIconProxy']=_0x2d6be3;function _0x320333(){const _0x46ac6d=_0x5a7792;_0x2d6be3(_0x1c083c['activeChatId']),_0x1ae09e();const _0x2105c8=document[_0x46ac6d(0x64f)](_0x46ac6d(0xb4d)),_0x1f2fa7=document['getElementById'](_0x46ac6d(0x9c2)),_0xd8fcbe=document['getElementById']('music-play-pause-btn');if(_0x1c083c['currentIndex']>-0x1&&_0x1c083c[_0x46ac6d(0x11ce)]['length']>0x0){const _0x3dc44=_0x1c083c['playlist'][_0x1c083c['currentIndex']];_0x2105c8[_0x46ac6d(0xee5)]=_0x3dc44[_0x46ac6d(0x6fc)],_0x1f2fa7[_0x46ac6d(0xee5)]=_0x3dc44[_0x46ac6d(0xb17)];}else _0x2105c8[_0x46ac6d(0xee5)]=_0x46ac6d(0x42e),_0x1f2fa7[_0x46ac6d(0xee5)]=_0x46ac6d(0x3cd);_0xd8fcbe[_0x46ac6d(0xee5)]=_0x1c083c[_0x46ac6d(0xad6)]?'❚❚':'▶';}function _0x1ae09e(){const _0x5d4cfc=_0x5a7792,_0xc938b6=(_0x1c083c[_0x5d4cfc(0xd4c)]/0xe10)[_0x5d4cfc(0xc89)](0x1);document[_0x5d4cfc(0x64f)]('music-time-counter')[_0x5d4cfc(0xee5)]=_0x5d4cfc(0x517)+_0xc938b6+'小时';}function _0x36d83c(){const _0x44dbd3=_0x5a7792,_0x145b75=document[_0x44dbd3(0x64f)]('playlist-body');_0x145b75[_0x44dbd3(0xc58)]='';if(_0x1c083c[_0x44dbd3(0x11ce)][_0x44dbd3(0x40f)]===0x0){_0x145b75[_0x44dbd3(0xc58)]=_0x44dbd3(0xae4);return;}_0x1c083c[_0x44dbd3(0x11ce)][_0x44dbd3(0x103)]((_0xd8a11b,_0x311064)=>{const _0xe896ec=_0x44dbd3,_0x1a1b55=document[_0xe896ec(0x124e)](_0xe896ec(0x479));_0x1a1b55['className']=_0xe896ec(0x869);if(_0x311064===_0x1c083c[_0xe896ec(0x409)])_0x1a1b55[_0xe896ec(0x418)][_0xe896ec(0xdda)](_0xe896ec(0x46c));_0x1a1b55[_0xe896ec(0xc58)]=_0xe896ec(0xc36)+_0xd8a11b['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>'+_0xd8a11b[_0xe896ec(0xb17)]+'</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20<div\x20class=\x22playlist-item-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20album-art-btn\x22\x20data-index=\x22'+_0x311064+'\x22>专辑</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20lyrics-btn\x22\x20data-index=\x22'+_0x311064+_0xe896ec(0x413)+_0x311064+'\x22>背景</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22playlist-action-btn\x20delete-track-btn\x22\x20data-index=\x22'+_0x311064+_0xe896ec(0xabe),_0x1a1b55[_0xe896ec(0x49c)](_0xe896ec(0xcf5))[_0xe896ec(0xf72)]('click',()=>_0x465c43(_0x311064)),_0x145b75[_0xe896ec(0x99e)](_0x1a1b55);});}async function _0x3b97ea(){const _0x1d5b27=_0x5a7792;if(_0x51e4a1[_0x1d5b27(0x10b0)]){if(_0x1c083c['currentIndex']===-0x1&&_0x1c083c['playlist'][_0x1d5b27(0x40f)]>0x0)_0x465c43(0x0);else _0x1c083c[_0x1d5b27(0x409)]>-0x1&&_0x465c43(_0x1c083c[_0x1d5b27(0x409)]);}else _0x51e4a1[_0x1d5b27(0x6ef)](),await _0x1d69ad(_0x1d5b27(0x492));}function _0x2a1ec3(){const _0x177ca6=_0x5a7792;if(_0x1c083c['playlist'][_0x177ca6(0x40f)]===0x0)return;let _0x60b3df;switch(_0x1c083c[_0x177ca6(0xf71)]){case _0x177ca6(0x95f):_0x60b3df=Math[_0x177ca6(0x1245)](Math[_0x177ca6(0x95f)]()*_0x1c083c[_0x177ca6(0x11ce)][_0x177ca6(0x40f)]);break;case _0x177ca6(0x1341):_0x465c43(_0x1c083c[_0x177ca6(0x409)]);return;case _0x177ca6(0xf49):default:_0x60b3df=(_0x1c083c[_0x177ca6(0x409)]+0x1)%_0x1c083c['playlist'][_0x177ca6(0x40f)];break;}_0x465c43(_0x60b3df);}function _0x51a9dd(){const _0x47f866=_0x5a7792;if(_0x1c083c[_0x47f866(0x11ce)][_0x47f866(0x40f)]===0x0)return;const _0x2919be=(_0x1c083c[_0x47f866(0x409)]-0x1+_0x1c083c[_0x47f866(0x11ce)][_0x47f866(0x40f)])%_0x1c083c[_0x47f866(0x11ce)][_0x47f866(0x40f)];_0x465c43(_0x2919be);}function _0x1f653(){const _0x2bca0c=_0x5a7792,_0x36cc96=[_0x2bca0c(0xf49),_0x2bca0c(0x95f),'single'],_0x6c7995=_0x36cc96[_0x2bca0c(0xac7)](_0x1c083c['playMode']);_0x1c083c[_0x2bca0c(0xf71)]=_0x36cc96[(_0x6c7995+0x1)%_0x36cc96[_0x2bca0c(0x40f)]],document['getElementById']('music-mode-btn')['textContent']={'order':'顺序','random':'随机','single':'单曲'}[_0x1c083c['playMode']];}async function _0xf1652f(){const _0x3a3b32=_0x5a7792,_0x5a3e01=await _0x41e3f8(_0x3a3b32(0xd12),'请输入歌曲的URL','',_0x3a3b32(0xe52));if(!_0x5a3e01)return;const _0xb838f2=await _0x41e3f8('歌曲信息','请输入歌名');if(!_0xb838f2)return;const _0x35ef27=await _0x41e3f8(_0x3a3b32(0x558),_0x3a3b32(0xe9d));if(!_0x35ef27)return;_0x1c083c[_0x3a3b32(0x11ce)]['push']({'name':_0xb838f2,'artist':_0x35ef27,'src':_0x5a3e01,'isLocal':![]}),await _0x16961a(),_0x36d83c(),_0x1c083c['currentIndex']===-0x1&&(_0x1c083c['currentIndex']=_0x1c083c[_0x3a3b32(0x11ce)][_0x3a3b32(0x40f)]-0x1,_0x320333());}async function _0x5703ac(_0x58b61c){const _0x339f0d=_0x5a7792,_0x2ac81e=_0x58b61c[_0x339f0d(0xf5b)]['files'];if(!_0x2ac81e['length'])return;for(const _0xee2cc5 of _0x2ac81e){let _0x5220f2=_0xee2cc5[_0x339f0d(0x6fc)][_0x339f0d(0x137f)](/\.[^/.]+$/,'');_0x5220f2=await _0x41e3f8(_0x339f0d(0x558),_0x339f0d(0x4e8),_0x5220f2);if(_0x5220f2===null)continue;const _0x738060=await _0x41e3f8(_0x339f0d(0x558),_0x339f0d(0xe9d),_0x339f0d(0x438));if(_0x738060===null)continue;const _0x2c4d8c=await _0xee2cc5['arrayBuffer']();let _0x2a8ec0='';const _0x340884=await _0x54149f(_0x339f0d(0x1055),_0x339f0d(0x68c)+_0x5220f2+_0x339f0d(0x2f6));_0x340884&&(_0x2a8ec0=await _0x4a5960()||''),_0x1c083c['playlist']['push']({'name':_0x5220f2,'artist':_0x738060,'src':_0x2c4d8c,'fileType':_0xee2cc5[_0x339f0d(0xafc)],'isLocal':!![],'lrcContent':_0x2a8ec0,'cover':'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg'});}await _0x16961a(),_0x36d83c(),_0x1c083c[_0x339f0d(0x409)]===-0x1&&_0x1c083c[_0x339f0d(0x11ce)][_0x339f0d(0x40f)]>0x0&&(_0x1c083c[_0x339f0d(0x409)]=0x0,_0x320333()),_0x58b61c['target']['value']=null;}async function _0x465c43(_0x1f54ef){const _0x5f51a5=_0x5a7792;if(_0x1f54ef<0x0||_0x1f54ef>=_0x1c083c['playlist'][_0x5f51a5(0x40f)])return;_0x51e4a1['pause'](),_0x1c083c[_0x5f51a5(0x409)]=_0x1f54ef;const _0x1182f8=_0x1c083c[_0x5f51a5(0x11ce)][_0x1f54ef],_0xd87199=_0x3e7a1b[_0x5f51a5(0x999)][_0x1c083c[_0x5f51a5(0x777)]],_0x111096=document[_0x5f51a5(0x64f)]('music-player-avatar-display');if(_0xd87199&&_0x111096){_0x111096[_0x5f51a5(0xc58)]='';const _0x1bd8d5=_0xd87199[_0x5f51a5(0x1167)]?_0xd87199[_0x5f51a5(0x5d4)]['find'](_0x626884=>_0x626884['originalName']===_0x1182f8[_0x5f51a5(0xb17)])?.['avatar']||_0x54e358:_0xd87199[_0x5f51a5(0xcb3)][_0x5f51a5(0x93)]||_0x54e358,_0x4f949b=_0xd87199[_0x5f51a5(0xcb3)][_0x5f51a5(0x96a)]||_0x54e358,_0x267d7a=document[_0x5f51a5(0x124e)]('img');_0x267d7a[_0x5f51a5(0xbe8)]=_0x1bd8d5,_0x267d7a['className']=_0x5f51a5(0xe06),_0x267d7a['alt']=_0x5f51a5(0x1088),_0x111096[_0x5f51a5(0x99e)](_0x267d7a);const _0x5a5e5b=document[_0x5f51a5(0x124e)](_0x5f51a5(0x756));_0x5a5e5b[_0x5f51a5(0xbe8)]=_0x4f949b,_0x5a5e5b[_0x5f51a5(0x87d)]=_0x5f51a5(0xe06),_0x5a5e5b[_0x5f51a5(0x7e2)]=_0x5f51a5(0xf6a),_0x111096['appendChild'](_0x5a5e5b);}const _0x63cbc3=document[_0x5f51a5(0x49c)]('.music-player-window'),_0x584104=document[_0x5f51a5(0x64f)](_0x5f51a5(0x1387));_0x63cbc3&&(_0x63cbc3[_0x5f51a5(0x731)]['setProperty']('--music-bg-image',_0x1182f8[_0x5f51a5(0xc8b)]?_0x5f51a5(0xec1)+_0x1182f8[_0x5f51a5(0xc8b)]+')':_0x5f51a5(0x1209)),_0x63cbc3[_0x5f51a5(0x418)][_0x5f51a5(0x5cf)](_0x5f51a5(0x9f),!!_0x1182f8[_0x5f51a5(0x6d2)]));_0x584104&&_0x584104['classList'][_0x5f51a5(0x5cf)]('active',!!_0x1182f8['isBgClear']);document[_0x5f51a5(0x64f)]('music-visual-container')[_0x5f51a5(0x418)]['remove'](_0x5f51a5(0x7ab));const _0xd228fa=document[_0x5f51a5(0x64f)]('music-player-cover');_0xd228fa&&(_0xd228fa[_0x5f51a5(0xbe8)]=_0x1182f8[_0x5f51a5(0x844)]||'https://s3plus.meituan.net/opapisdk/op_ticket_885190757_1757748720126_qdqqd_1jt5sv.jpeg');await _0x1d69ad('将歌曲切换为了《'+_0x1182f8['name']+'》'),_0x1c083c[_0x5f51a5(0xc35)]=_0x485f9f(_0x1182f8[_0x5f51a5(0x10b2)]||''),_0x1b36d1();const _0xf20954=document[_0x5f51a5(0x64f)](_0x5f51a5(0xc1b));_0xf20954&&(!_0x1c083c[_0x5f51a5(0xc35)]||_0x1c083c['parsedLyrics'][_0x5f51a5(0x40f)]===0x0?_0xf20954[_0x5f51a5(0xee5)]=_0x5f51a5(0x12b9):_0xf20954[_0x5f51a5(0xee5)]=_0x5f51a5(0x273));if(_0x1182f8[_0x5f51a5(0x1102)]&&_0x1182f8[_0x5f51a5(0xbe8)]instanceof ArrayBuffer){const _0x3ee0e3=new Blob([_0x1182f8[_0x5f51a5(0xbe8)]],{'type':_0x1182f8[_0x5f51a5(0x5db)]||_0x5f51a5(0xc11)});_0x51e4a1[_0x5f51a5(0xbe8)]=URL[_0x5f51a5(0xb29)](_0x3ee0e3);}else{if(_0x1182f8[_0x5f51a5(0x1102)]&&_0x1182f8[_0x5f51a5(0xbe8)]instanceof Blob)_0x51e4a1[_0x5f51a5(0xbe8)]=URL[_0x5f51a5(0xb29)](_0x1182f8[_0x5f51a5(0xbe8)]);else{if(!_0x1182f8[_0x5f51a5(0x1102)])_0x51e4a1[_0x5f51a5(0xbe8)]=_0x1182f8[_0x5f51a5(0xbe8)];else{console[_0x5f51a5(0xc60)]('本地歌曲源错误:',_0x1182f8);return;}}}const _0x298f85=_0x51e4a1[_0x5f51a5(0x1190)]();_0x298f85!==undefined&&_0x298f85[_0x5f51a5(0x1201)](_0x4fa8f8=>{const _0x5a498d=_0x5f51a5;if(_0x4fa8f8['name']==='NotAllowedError')console[_0x5a498d(0x1155)](_0x5a498d(0x131e)),_0x51e4a1[_0x5a498d(0x6ef)](),_0x28974b(_0x5a498d(0xdc3),'由于浏览器安全限制，AI切换的歌曲无法自动播放。请手动点击播放按钮\x20▶\x20继续欣赏。');else _0x4fa8f8[_0x5a498d(0x6fc)]!==_0x5a498d(0x54b)&&console[_0x5a498d(0xc60)](_0x5a498d(0x33c),_0x4fa8f8);});_0x36d83c(),_0x320333(),_0x11fbd9();const _0x4c93e9=document[_0x5f51a5(0x64f)](_0x5f51a5(0x9fc));_0x1c083c['parsedLyrics']&&_0x1c083c[_0x5f51a5(0xc35)][_0x5f51a5(0x40f)]>0x0?(_0x4c93e9['textContent']='♪',_0x4c93e9[_0x5f51a5(0x418)][_0x5f51a5(0xdda)](_0x5f51a5(0x40a))):_0x4c93e9[_0x5f51a5(0x418)][_0x5f51a5(0x1275)](_0x5f51a5(0x40a));}async function _0x273afd(_0x5efdde){const _0x3303c3=_0x5a7792;if(_0x5efdde<0x0||_0x5efdde>=_0x1c083c[_0x3303c3(0x11ce)][_0x3303c3(0x40f)])return;const _0x279a99=await _0x217169('更换歌曲背景',[{'text':_0x3303c3(0x9ba),'value':_0x3303c3(0x2a2)},{'text':_0x3303c3(0xe00),'value':_0x3303c3(0xe52)}]);let _0x3c8379=null;if(_0x279a99==='local')_0x3c8379=await _0x44b2ac();else _0x279a99===_0x3303c3(0xe52)&&(_0x3c8379=await _0x41e3f8(_0x3303c3(0xa9e),_0x3303c3(0x210),'',_0x3303c3(0xe52)));if(_0x3c8379&&_0x3c8379[_0x3303c3(0x43a)]()){_0x1c083c[_0x3303c3(0x11ce)][_0x5efdde][_0x3303c3(0xc8b)]=_0x3c8379[_0x3303c3(0x43a)](),await _0x16961a();if(_0x1c083c[_0x3303c3(0x409)]===_0x5efdde){const _0x4907cc=document[_0x3303c3(0x49c)](_0x3303c3(0xc4f));_0x4907cc['style'][_0x3303c3(0xee2)]('--music-bg-image','url('+_0x3c8379[_0x3303c3(0x43a)]()+')');}await _0x28974b('成功',_0x3303c3(0x567));}}async function _0x2d7836(_0x40b5e6){const _0x25abdf=_0x5a7792;if(_0x40b5e6<0x0||_0x40b5e6>=_0x1c083c[_0x25abdf(0x11ce)][_0x25abdf(0x40f)])return;const _0x59b133=await _0x217169(_0x25abdf(0x354),[{'text':_0x25abdf(0x9ba),'value':'local'},{'text':'🌐\x20使用网络URL','value':_0x25abdf(0xe52)}]);let _0x26f952=null;if(_0x59b133===_0x25abdf(0x2a2))_0x26f952=await _0x44b2ac();else _0x59b133===_0x25abdf(0xe52)&&(_0x26f952=await _0x41e3f8('输入图片URL',_0x25abdf(0x59f),'','url'));if(_0x26f952&&_0x26f952[_0x25abdf(0x43a)]()){_0x1c083c[_0x25abdf(0x11ce)][_0x40b5e6][_0x25abdf(0x844)]=_0x26f952[_0x25abdf(0x43a)](),await _0x16961a();if(_0x1c083c['currentIndex']===_0x40b5e6){document[_0x25abdf(0x64f)](_0x25abdf(0x3a7))[_0x25abdf(0xbe8)]=_0x26f952['trim']();const _0x12b628=document[_0x25abdf(0x49c)](_0x25abdf(0xba8));if(_0x12b628)_0x12b628[_0x25abdf(0xbe8)]=_0x26f952[_0x25abdf(0x43a)]();}await _0x28974b('成功',_0x25abdf(0xf7f));}}async function _0x24f2bd(_0x3e69e5){const _0x3b098e=_0x5a7792;if(_0x3e69e5<0x0||_0x3e69e5>=_0x1c083c['playlist'][_0x3b098e(0x40f)])return;const _0x17c648=_0x1c083c[_0x3b098e(0x11ce)][_0x3e69e5],_0xec227c=_0x1c083c[_0x3b098e(0xad6)]&&_0x1c083c['currentIndex']===_0x3e69e5;if(_0x17c648[_0x3b098e(0x1102)]&&_0x51e4a1[_0x3b098e(0xbe8)]['startsWith'](_0x3b098e(0x3bf))&&_0x1c083c[_0x3b098e(0x409)]===_0x3e69e5)URL['revokeObjectURL'](_0x51e4a1[_0x3b098e(0xbe8)]);_0x1c083c[_0x3b098e(0x11ce)][_0x3b098e(0x10f9)](_0x3e69e5,0x1),await _0x16961a();if(_0x1c083c['playlist']['length']===0x0){if(_0x1c083c['isPlaying'])_0x51e4a1[_0x3b098e(0x6ef)]();_0x51e4a1['src']='',_0x1c083c[_0x3b098e(0x409)]=-0x1,_0x1c083c[_0x3b098e(0xad6)]=![];}else{if(_0xec227c)_0x2a1ec3();else{if(_0x1c083c[_0x3b098e(0x409)]>=_0x3e69e5)_0x1c083c[_0x3b098e(0x409)]=Math[_0x3b098e(0x804)](0x0,_0x1c083c[_0x3b098e(0x409)]-0x1);}}_0x320333(),_0x36d83c();}async function _0x5703ac(_0x28cdad){const _0x428326=_0x5a7792,_0x563eb9=_0x28cdad[_0x428326(0xf5b)][_0x428326(0x91e)];if(!_0x563eb9[_0x428326(0x40f)])return;for(const _0x3b2ace of _0x563eb9){let _0x22288f=_0x3b2ace['name'][_0x428326(0x137f)](/\.[^/.]+$/,'');_0x22288f=await _0x41e3f8(_0x428326(0x558),_0x428326(0x4e8),_0x22288f);if(_0x22288f===null)continue;const _0x48bbad=await _0x41e3f8('歌曲信息',_0x428326(0xe9d),_0x428326(0x438));if(_0x48bbad===null)continue;let _0x5cfffe='';const _0x2b6270=await _0x54149f(_0x428326(0x1055),'要为《'+_0x22288f+_0x428326(0x2f6));_0x2b6270&&(_0x5cfffe=await _0x4a5960()||''),_0x1c083c[_0x428326(0x11ce)][_0x428326(0x13ee)]({'name':_0x22288f,'artist':_0x48bbad,'src':_0x3b2ace,'isLocal':!![],'lrcContent':_0x5cfffe});}await _0x16961a(),_0x36d83c(),_0x1c083c[_0x428326(0x409)]===-0x1&&_0x1c083c[_0x428326(0x11ce)][_0x428326(0x40f)]>0x0&&(_0x1c083c[_0x428326(0x409)]=0x0,_0x320333()),_0x28cdad['target']['value']=null;}async function _0x24f2bd(_0x3b0b6c){const _0x5c40fa=_0x5a7792;if(_0x3b0b6c<0x0||_0x3b0b6c>=_0x1c083c[_0x5c40fa(0x11ce)][_0x5c40fa(0x40f)])return;const _0x194bde=_0x1c083c['playlist'][_0x3b0b6c],_0x932e76=_0x1c083c[_0x5c40fa(0xad6)]&&_0x1c083c[_0x5c40fa(0x409)]===_0x3b0b6c;if(_0x194bde[_0x5c40fa(0x1102)]&&_0x51e4a1[_0x5c40fa(0xbe8)][_0x5c40fa(0x7d)]('blob:')&&_0x1c083c[_0x5c40fa(0x409)]===_0x3b0b6c)URL[_0x5c40fa(0x74f)](_0x51e4a1[_0x5c40fa(0xbe8)]);_0x1c083c[_0x5c40fa(0x11ce)][_0x5c40fa(0x10f9)](_0x3b0b6c,0x1),await _0x16961a();if(_0x1c083c['playlist'][_0x5c40fa(0x40f)]===0x0){if(_0x1c083c[_0x5c40fa(0xad6)])_0x51e4a1['pause']();_0x51e4a1[_0x5c40fa(0xbe8)]='',_0x1c083c[_0x5c40fa(0x409)]=-0x1,_0x1c083c[_0x5c40fa(0xad6)]=![];}else{if(_0x932e76)_0x2a1ec3();else{if(_0x1c083c[_0x5c40fa(0x409)]>=_0x3b0b6c)_0x1c083c[_0x5c40fa(0x409)]=Math[_0x5c40fa(0x804)](0x0,_0x1c083c[_0x5c40fa(0x409)]-0x1);}}_0x320333(),_0x36d83c();}const _0x3afa47=document[_0x5a7792(0x64f)](_0x5a7792(0x138)),_0x296fad=document[_0x5a7792(0x64f)](_0x5a7792(0xc6d)),_0x32af7a=document[_0x5a7792(0x64f)](_0x5a7792(0xfa1));function _0x27eef7(){const _0x56b1e6=_0x5a7792;_0x5adcf9(),_0x3afa47[_0x56b1e6(0x418)]['add'](_0x56b1e6(0x40a));}function _0x268c1c(){const _0x47e5f9=_0x5a7792;_0x3afa47[_0x47e5f9(0x418)][_0x47e5f9(0x1275)](_0x47e5f9(0x40a));}function _0x5adcf9(){const _0x52188f=_0x5a7792,_0x326667=document[_0x52188f(0x64f)](_0x52188f(0x6ce));_0x326667[_0x52188f(0xc58)]='';if(_0x3e7a1b[_0x52188f(0x5ca)]['length']===0x0){_0x326667[_0x52188f(0xc58)]=_0x52188f(0xdc1);return;}_0x3e7a1b['personaPresets']['forEach'](_0x2da082=>{const _0x49dae4=_0x52188f,_0x37a48b=document[_0x49dae4(0x124e)](_0x49dae4(0x479));_0x37a48b[_0x49dae4(0x87d)]=_0x49dae4(0xd1f),_0x37a48b[_0x49dae4(0x731)][_0x49dae4(0x4d6)]=_0x49dae4(0xec1)+_0x2da082['avatar']+')',_0x37a48b['dataset']['presetId']=_0x2da082['id'],_0x37a48b['addEventListener'](_0x49dae4(0x1080),()=>_0x2d8e8(_0x2da082['id'])),_0xb407a5(_0x37a48b,()=>_0x1fbb6c(_0x2da082['id'])),_0x326667[_0x49dae4(0x99e)](_0x37a48b);});}function _0x1fbb6c(_0x1f0722){const _0x25f96d=_0x5a7792;_0x259cdf=_0x1f0722,_0x32af7a[_0x25f96d(0x418)]['add'](_0x25f96d(0x40a));}function _0x20f906(){const _0x4e89c6=_0x5a7792;_0x32af7a[_0x4e89c6(0x418)][_0x4e89c6(0x1275)](_0x4e89c6(0x40a)),_0x259cdf=null;}function _0x2d8e8(_0x18faf4){const _0x3b9e29=_0x5a7792,_0x36490a=_0x3e7a1b[_0x3b9e29(0x5ca)][_0x3b9e29(0x137)](_0xd54c9c=>_0xd54c9c['id']===_0x18faf4);_0x36490a&&(document[_0x3b9e29(0x64f)](_0x3b9e29(0x4d2))[_0x3b9e29(0xbe8)]=_0x36490a[_0x3b9e29(0x1265)],document[_0x3b9e29(0x64f)]('my-persona')[_0x3b9e29(0xbed)]=_0x36490a['persona']),_0x268c1c();}function _0x192f3f(){const _0x25da96=_0x5a7792;_0x259cdf=null,document[_0x25da96(0x64f)](_0x25da96(0x89))[_0x25da96(0xee5)]=_0x25da96(0x1289),document[_0x25da96(0x64f)](_0x25da96(0xd73))[_0x25da96(0xbe8)]=_0x54e358,document[_0x25da96(0x64f)]('preset-persona-input')[_0x25da96(0xbed)]='',_0x296fad[_0x25da96(0x418)][_0x25da96(0xdda)](_0x25da96(0x40a));}function _0x46010a(){const _0x3dbd49=_0x5a7792,_0x193dc9=_0x3e7a1b['personaPresets'][_0x3dbd49(0x137)](_0x32ced0=>_0x32ced0['id']===_0x259cdf);if(!_0x193dc9)return;document[_0x3dbd49(0x64f)]('persona-editor-title')[_0x3dbd49(0xee5)]='编辑人设预设',document['getElementById'](_0x3dbd49(0xd73))[_0x3dbd49(0xbe8)]=_0x193dc9['avatar'],document[_0x3dbd49(0x64f)](_0x3dbd49(0x8c5))[_0x3dbd49(0xbed)]=_0x193dc9['persona'],_0x32af7a[_0x3dbd49(0x418)][_0x3dbd49(0x1275)]('visible'),_0x296fad[_0x3dbd49(0x418)][_0x3dbd49(0xdda)]('visible');}async function _0x1e456a(){const _0xc22eb9=_0x5a7792,_0x20848b=await _0x54149f(_0xc22eb9(0xd87),_0xc22eb9(0x4c7),{'confirmButtonClass':_0xc22eb9(0xeed)});_0x20848b&&_0x259cdf&&(await _0x4e1bbf[_0xc22eb9(0x5ca)][_0xc22eb9(0x3aa)](_0x259cdf),_0x3e7a1b[_0xc22eb9(0x5ca)]=_0x3e7a1b[_0xc22eb9(0x5ca)][_0xc22eb9(0x156)](_0x2a2950=>_0x2a2950['id']!==_0x259cdf),_0x20f906(),_0x5adcf9());}function _0x449a89(){const _0x1cf9b9=_0x5a7792;_0x296fad[_0x1cf9b9(0x418)]['remove']('visible'),_0x259cdf=null;}async function _0x341cd1(){const _0x2ffd23=_0x5a7792,_0x395c5b=document[_0x2ffd23(0x64f)]('preset-avatar-preview')[_0x2ffd23(0xbe8)],_0x2fff33=document[_0x2ffd23(0x64f)](_0x2ffd23(0x8c5))[_0x2ffd23(0xbed)][_0x2ffd23(0x43a)]();if(_0x395c5b===_0x54e358&&!_0x2fff33){alert('头像和人设不能都为空哦！');return;}if(_0x259cdf){const _0x1fc896=_0x3e7a1b[_0x2ffd23(0x5ca)][_0x2ffd23(0x137)](_0x1bd952=>_0x1bd952['id']===_0x259cdf);_0x1fc896&&(_0x1fc896['avatar']=_0x395c5b,_0x1fc896[_0x2ffd23(0x324)]=_0x2fff33,await _0x4e1bbf[_0x2ffd23(0x5ca)]['put'](_0x1fc896));}else{const _0x251123={'id':_0x2ffd23(0xbf8)+Date[_0x2ffd23(0x2b5)](),'avatar':_0x395c5b,'persona':_0x2fff33};await _0x4e1bbf[_0x2ffd23(0x5ca)][_0x2ffd23(0xdda)](_0x251123),_0x3e7a1b[_0x2ffd23(0x5ca)][_0x2ffd23(0x13ee)](_0x251123);}_0x5adcf9(),_0x449a89();}const _0x4be49e=document[_0x5a7792(0x64f)]('battery-alert-modal');function _0x661f26(_0x3dc35e,_0x37d29f){const _0x167272=_0x5a7792;clearTimeout(_0x518e81),document[_0x167272(0x64f)](_0x167272(0x34e))[_0x167272(0xbe8)]=_0x3dc35e,document[_0x167272(0x64f)](_0x167272(0xcae))[_0x167272(0xee5)]=_0x37d29f,_0x4be49e[_0x167272(0x418)][_0x167272(0xdda)](_0x167272(0x40a));const _0x33172c=()=>{const _0x3f4c15=_0x167272;_0x4be49e[_0x3f4c15(0x418)]['remove']('visible'),_0x4be49e[_0x3f4c15(0xd74)](_0x3f4c15(0x1080),_0x33172c);};_0x4be49e[_0x167272(0xf72)]('click',_0x33172c),_0x518e81=setTimeout(_0x33172c,0x7d0);}function _0x1c6656(_0x4aa0f2){const _0x31c5d2=_0x5a7792,_0xadc10d=document[_0x31c5d2(0x64f)](_0x31c5d2(0xc0e)),_0x53f445=_0xadc10d[_0x31c5d2(0x49c)](_0x31c5d2(0x8f2)),_0x5ca75d=_0xadc10d[_0x31c5d2(0x49c)](_0x31c5d2(0x7b4)),_0x2301aa=Math[_0x31c5d2(0x1245)](_0x4aa0f2['level']*0x64);_0x53f445[_0x31c5d2(0x731)][_0x31c5d2(0x1123)]=_0x2301aa+'%',_0x5ca75d[_0x31c5d2(0xee5)]=_0x2301aa+'%',_0x4aa0f2['charging']?_0xadc10d[_0x31c5d2(0x418)][_0x31c5d2(0xdda)](_0x31c5d2(0x1325)):_0xadc10d[_0x31c5d2(0x418)]['remove'](_0x31c5d2(0x1325));}function _0x4fb7b5(_0x1b1445){const _0x23dda1=_0x5a7792;_0x1c6656(_0x1b1445);const _0x124ef5=_0x1b1445['level'];!_0x1b1445[_0x23dda1(0x1325)]&&(_0x124ef5<=0.4&&_0x2eb631>0.4&&!_0x1df506[_0x23dda1(0x2b9)]&&(_0x661f26('https://i.postimg.cc/T2yKJ0DV/40.jpg','有点饿了，可以去找充电器惹'),_0x1df506[_0x23dda1(0x2b9)]=!![]),_0x124ef5<=0.2&&_0x2eb631>0.2&&!_0x1df506[_0x23dda1(0x78e)]&&(_0x661f26(_0x23dda1(0x471),_0x23dda1(0x679)),_0x1df506[_0x23dda1(0x78e)]=!![]),_0x124ef5<=0.1&&_0x2eb631>0.1&&!_0x1df506[_0x23dda1(0x97d)]&&(_0x661f26('https://i.postimg.cc/ThMMVfW4/10.jpg','已阵亡，还有30秒爆炸'),_0x1df506[_0x23dda1(0x97d)]=!![]));if(_0x124ef5>0.4)_0x1df506['hasShown40']=![];if(_0x124ef5>0.2)_0x1df506['hasShown20']=![];if(_0x124ef5>0.1)_0x1df506[_0x23dda1(0x97d)]=![];_0x2eb631=_0x124ef5;}async function _0x9e440c(){const _0x247b76=_0x5a7792;if(_0x247b76(0x86c)in navigator)try{const _0x1bbdbd=await navigator[_0x247b76(0x86c)]();_0x2eb631=_0x1bbdbd[_0x247b76(0x69d)],_0x4fb7b5(_0x1bbdbd),_0x1bbdbd[_0x247b76(0xf72)](_0x247b76(0xce4),()=>_0x4fb7b5(_0x1bbdbd)),_0x1bbdbd['addEventListener'](_0x247b76(0xf14),()=>{const _0x43fc33=_0x247b76;_0x4fb7b5(_0x1bbdbd),_0x1bbdbd[_0x43fc33(0x1325)]&&_0x661f26(_0x43fc33(0x627),_0x43fc33(0x40b));});}catch(_0x28fb75){console[_0x247b76(0xc60)](_0x247b76(0x7e3),_0x28fb75),document[_0x247b76(0x49c)]('.battery-text')[_0x247b76(0xee5)]=_0x247b76(0xbd);}else console[_0x247b76(0x1081)]('浏览器不支持电池状态API。'),document[_0x247b76(0x49c)]('.battery-text')[_0x247b76(0xee5)]=_0x247b76(0xbd);}async function _0x5aa836(){const _0x1610f9=_0x5a7792,_0xf0923b=document[_0x1610f9(0x64f)]('album-grid-page');if(!_0xf0923b)return;const _0x45ab3f=await _0x4e1bbf[_0x1610f9(0x2d5)]['orderBy'](_0x1610f9(0x753))[_0x1610f9(0x2f4)]()[_0x1610f9(0x78f)]();_0xf0923b[_0x1610f9(0xc58)]='';if(_0x45ab3f[_0x1610f9(0x40f)]===0x0){_0xf0923b['innerHTML']=_0x1610f9(0x425);return;}_0x45ab3f[_0x1610f9(0x103)](_0x302d33=>{const _0xe03c0=_0x1610f9,_0x1a585e=document[_0xe03c0(0x124e)](_0xe03c0(0x479));_0x1a585e['className']='album-item',_0x1a585e[_0xe03c0(0xc58)]=_0xe03c0(0xbc1)+_0x302d33['coverUrl']+_0xe03c0(0xe37)+_0x302d33['name']+_0xe03c0(0x12b6)+(_0x302d33['photoCount']||0x0)+_0xe03c0(0xfb2),_0x1a585e[_0xe03c0(0xf72)](_0xe03c0(0x1080),()=>{_0x3d7739(_0x302d33['id']);}),_0xb407a5(_0x1a585e,async()=>{const _0x1e3647=_0xe03c0,_0x13fff5=await _0x54149f(_0x1e3647(0x1004),_0x1e3647(0xf99)+_0x302d33[_0x1e3647(0x6fc)]+_0x1e3647(0x752),{'confirmButtonClass':_0x1e3647(0xeed)});_0x13fff5&&(await _0x4e1bbf[_0x1e3647(0x5c4)][_0x1e3647(0xec9)](_0x1e3647(0xa6e))[_0x1e3647(0x11cd)](_0x302d33['id'])[_0x1e3647(0x3aa)](),await _0x4e1bbf['qzoneAlbums'][_0x1e3647(0x3aa)](_0x302d33['id']),await _0x5aa836(),alert(_0x1e3647(0x2ce)));}),_0xf0923b[_0xe03c0(0x99e)](_0x1a585e);});}async function _0x3d7739(_0x136329){const _0x5b9c83=_0x5a7792;_0x3e7a1b[_0x5b9c83(0x1360)]=_0x136329,await _0x32cb48(),_0xddd8ae(_0x5b9c83(0xcdb));}async function _0x32cb48(){const _0x4b92a5=_0x5a7792;if(!_0x3e7a1b[_0x4b92a5(0x1360)])return;const _0x1ccbf0=document[_0x4b92a5(0x64f)](_0x4b92a5(0x464)),_0x55d7bf=document['getElementById'](_0x4b92a5(0xb81)),_0x1ba3ec=await _0x4e1bbf['qzoneAlbums'][_0x4b92a5(0x11fc)](_0x3e7a1b[_0x4b92a5(0x1360)]);if(!_0x1ba3ec){console['error'](_0x4b92a5(0x8a9),_0x3e7a1b[_0x4b92a5(0x1360)]),_0xddd8ae(_0x4b92a5(0x5ce));return;}_0x55d7bf[_0x4b92a5(0xee5)]=_0x1ba3ec[_0x4b92a5(0x6fc)];const _0x1be687=await _0x4e1bbf[_0x4b92a5(0x5c4)][_0x4b92a5(0xec9)]('albumId')[_0x4b92a5(0x11cd)](_0x3e7a1b[_0x4b92a5(0x1360)])[_0x4b92a5(0x78f)]();_0x1ccbf0[_0x4b92a5(0xc58)]='',_0x1be687[_0x4b92a5(0x40f)]===0x0?_0x1ccbf0[_0x4b92a5(0xc58)]='<p\x20style=\x22grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这个相册还是空的，快上传第一张照片吧！</p>':_0x1be687[_0x4b92a5(0x103)](_0x3e17df=>{const _0x653e06=_0x4b92a5,_0x4fa824=document['createElement'](_0x653e06(0x479));_0x4fa824[_0x653e06(0x87d)]=_0x653e06(0xd3c),_0x4fa824[_0x653e06(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+_0x3e17df['url']+_0x653e06(0xe55)+_0x3e17df['id']+'\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1ccbf0['appendChild'](_0x4fa824);});}async function _0xbbb814(_0xc159fc){const _0x1a5277=_0x5a7792;if(!_0x3e7a1b[_0x1a5277(0x1360)])return;const _0x564fc4=await _0x4e1bbf[_0x1a5277(0x5c4)][_0x1a5277(0xec9)](_0x1a5277(0xa6e))[_0x1a5277(0x11cd)](_0x3e7a1b['activeAlbumId'])['toArray']();_0xc70aa2[_0x1a5277(0x136a)]=_0x564fc4['map'](_0xaecd49=>_0xaecd49['url']),_0xc70aa2[_0x1a5277(0x409)]=_0xc70aa2[_0x1a5277(0x136a)][_0x1a5277(0x6a2)](_0x4ba478=>_0x4ba478===_0xc159fc);if(_0xc70aa2[_0x1a5277(0x409)]===-0x1)return;document[_0x1a5277(0x64f)](_0x1a5277(0x664))['classList'][_0x1a5277(0xdda)]('visible'),_0x2da65f(),_0xc70aa2[_0x1a5277(0xb68)]=!![];}function _0x2da65f(){const _0x176064=_0x5a7792;if(_0xc70aa2[_0x176064(0x409)]===-0x1)return;const _0x2fea36=document[_0x176064(0x64f)]('photo-viewer-image'),_0x358b1e=document[_0x176064(0x64f)]('photo-viewer-prev-btn'),_0x432949=document['getElementById'](_0x176064(0x3e4));_0x2fea36[_0x176064(0x731)][_0x176064(0x131a)]=0x0,setTimeout(()=>{const _0x53e681=_0x176064;_0x2fea36[_0x53e681(0xbe8)]=_0xc70aa2[_0x53e681(0x136a)][_0xc70aa2['currentIndex']],_0x2fea36[_0x53e681(0x731)]['opacity']=0x1;},0x64),_0x358b1e[_0x176064(0x1b0)]=_0xc70aa2[_0x176064(0x409)]===0x0,_0x432949[_0x176064(0x1b0)]=_0xc70aa2[_0x176064(0x409)]===_0xc70aa2[_0x176064(0x136a)][_0x176064(0x40f)]-0x1;}function _0x26d54b(){const _0x53b74a=_0x5a7792;_0xc70aa2['currentIndex']<_0xc70aa2[_0x53b74a(0x136a)][_0x53b74a(0x40f)]-0x1&&(_0xc70aa2[_0x53b74a(0x409)]++,_0x2da65f());}function _0x245c75(){const _0x8fe3b2=_0x5a7792;_0xc70aa2['currentIndex']>0x0&&(_0xc70aa2[_0x8fe3b2(0x409)]--,_0x2da65f());}function _0x1c8f63(){const _0x3f5005=_0x5a7792;document[_0x3f5005(0x64f)](_0x3f5005(0x664))[_0x3f5005(0x418)][_0x3f5005(0x1275)](_0x3f5005(0x40a)),_0xc70aa2[_0x3f5005(0xb68)]=![],_0xc70aa2[_0x3f5005(0x136a)]=[],_0xc70aa2['currentIndex']=-0x1,document[_0x3f5005(0x64f)](_0x3f5005(0xf35))[_0x3f5005(0xbe8)]='';}function _0x1baa80(_0x5ac659){const _0x1ff767=_0x5a7792;_0x511de0=_0x5ac659,localStorage[_0x1ff767(0xd39)]('unreadPostsCount',_0x5ac659);const _0x551c00=document[_0x1ff767(0x49c)](_0x1ff767(0x7b)),_0x2d2892=_0x551c00[_0x1ff767(0x49c)](_0x1ff767(0xd84));let _0x460178=_0x551c00['querySelector'](_0x1ff767(0x457));_0x5ac659>0x0?(!_0x460178&&(_0x460178=document[_0x1ff767(0x124e)]('span'),_0x460178['className']=_0x1ff767(0x1389),_0x2d2892[_0x1ff767(0x731)][_0x1ff767(0x126)]=_0x1ff767(0xa48),_0x2d2892[_0x1ff767(0x99e)](_0x460178)),_0x460178[_0x1ff767(0xee5)]=_0x5ac659>0x63?_0x1ff767(0x13cf):_0x5ac659,_0x460178[_0x1ff767(0x731)][_0x1ff767(0x130)]=_0x1ff767(0xb37)):_0x460178&&(_0x460178['style'][_0x1ff767(0x130)]='none'),_0x1cc461();}function _0x26a3f0(){const _0x3582b9=_0x5a7792;if(_0x1dd88f)return;const _0x1cc630=_0x3e7a1b['globalSettings'][_0x3582b9(0xd5)]||0x3c;_0x1dd88f=setInterval(_0x947e24,_0x1cc630*0x3e8),_0x5b567f();}function _0x239b1c(){_0x1dd88f&&(clearInterval(_0x1dd88f),_0x1dd88f=null),_0xb6bc2c();}async function _0x947e24(){const _0x456c01=_0x5a7792;console[_0x456c01(0x1081)](_0x456c01(0x880));if(!_0x3e7a1b[_0x456c01(0x11b4)][_0x456c01(0x11c3)]){_0x239b1c();return;}const _0x4c34df=Object['values'](_0x3e7a1b[_0x456c01(0x999)])[_0x456c01(0x156)](_0x5e9bac=>!_0x5e9bac[_0x456c01(0x1167)]);_0x4c34df['forEach'](_0x129406=>{const _0x3d8b5e=_0x456c01;if(_0x129406[_0x3d8b5e(0x55f)]?.[_0x3d8b5e(0x69e)]===_0x3d8b5e(0x770)){const _0x363292=_0x129406[_0x3d8b5e(0x55f)][_0x3d8b5e(0x338)];if(!_0x363292)return;const _0x24ca4d=Date[_0x3d8b5e(0x2b5)]()-_0x363292,_0x399b3f=(_0x3e7a1b[_0x3d8b5e(0x11b4)]['blockCooldownHours']||0x1)*0x3c*0x3c*0x3e8;_0x24ca4d>_0x399b3f&&(_0x129406[_0x3d8b5e(0x55f)]['status']=_0x3d8b5e(0x6f9),_0x4a68ca(_0x129406['id']));}else{if(_0x129406[_0x3d8b5e(0x55f)]?.[_0x3d8b5e(0x69e)]===_0x3d8b5e(0xfdd)&&_0x129406['id']!==_0x3e7a1b['activeChatId']){if(_0x129406[_0x3d8b5e(0xcb3)][_0x3d8b5e(0x11c3)]===![]){console[_0x3d8b5e(0x1081)]('角色\x20\x22'+_0x129406['name']+_0x3d8b5e(0xab4));return;}Math[_0x3d8b5e(0x95f)]()<0.2&&(console['log']('角色\x20\x22'+_0x129406['name']+'\x22\x20被唤醒，准备独立行动...'),_0x42a425(_0x129406['id']));}}});const _0x2fd674=Object[_0x456c01(0xd6d)](_0x3e7a1b[_0x456c01(0x999)])['filter'](_0x4c24cc=>_0x4c24cc[_0x456c01(0x1167)]);_0x2fd674[_0x456c01(0x103)](_0x475795=>{const _0x4d1d72=_0x456c01;if(_0x475795['settings'][_0x4d1d72(0x11c3)]===![]){console[_0x4d1d72(0x1081)](_0x4d1d72(0x12a8)+_0x475795[_0x4d1d72(0x6fc)]+_0x4d1d72(0xdef));return;}_0x475795['id']!==_0x3e7a1b[_0x4d1d72(0x777)]&&Math['random']()<0.1&&(console[_0x4d1d72(0x1081)](_0x4d1d72(0x12a8)+_0x475795[_0x4d1d72(0x6fc)]+'\x22\x20被唤醒，准备独立行动...'),_0x13c1fa(_0x475795['id']));});try{const _0x39c2f4=await _0x4e1bbf[_0x456c01(0xad7)][_0x456c01(0x78f)]();if(_0x39c2f4[_0x456c01(0x40f)]===0x0)return;const _0x56d481=await _0x4e1bbf[_0x456c01(0xaf9)][_0x456c01(0xe1d)]('timestamp')[_0x456c01(0x2f4)]()[_0x456c01(0xb2e)](0xa)[_0x456c01(0x78f)]();for(const _0x258da2 of _0x39c2f4){if(_0x258da2[_0x456c01(0x11c3)]===![])continue;const _0x222a7d=_0x258da2[_0x456c01(0x963)]||0xf;if(_0x258da2[_0x456c01(0x11ea)]){const _0x1fb5be=(Date['now']()-_0x258da2['lastActionTimestamp'])/(0x3e8*0x3c);if(_0x1fb5be<_0x222a7d)continue;}if(Math[_0x456c01(0x95f)]()>0.3)continue;const _0x232eab=[];for(const _0x3e06c8 of _0x56d481){if(_0x3e06c8[_0x456c01(0x1188)]===_0x456c01(0x33e)+_0x258da2['id'])continue;const _0x2951b6=_0x3e06c8[_0x456c01(0xff)]?.[_0x456c01(0x26c)](_0xa3f66e=>_0xa3f66e[_0x456c01(0xe51)]===_0x258da2[_0x456c01(0x6fc)]),_0x4a3eea=_0x3e06c8[_0x456c01(0xff)]?.[_0x456c01(0xdf5)](-0x1)[0x0]?.[_0x456c01(0x1335)];if(_0x4a3eea===_0x258da2[_0x456c01(0x6fc)])continue;let _0x3422a9=![];if(_0x3e06c8['authorId']===_0x456c01(0xa4d)||_0x3e06c8[_0x456c01(0x1188)]['startsWith'](_0x456c01(0x1356)))_0x258da2[_0x456c01(0x22c)][_0x456c01(0xe53)](_0x3e06c8['authorId'])&&(_0x3422a9=!![]);else{if(_0x3e06c8[_0x456c01(0x1188)]['startsWith'](_0x456c01(0x33e))){const _0x487dca=parseInt(_0x3e06c8[_0x456c01(0x1188)]['replace'](_0x456c01(0x33e),'')),_0x589adc=await _0x4e1bbf[_0x456c01(0xad7)][_0x456c01(0x11fc)](_0x487dca);if(_0x589adc&&_0x589adc['associatedWith']){const _0x50c5a5=_0x258da2[_0x456c01(0x22c)][_0x456c01(0x156)](_0x2edf90=>_0x589adc['associatedWith']['includes'](_0x2edf90));_0x50c5a5[_0x456c01(0x40f)]>0x0&&(_0x3422a9=!![]);}}}(_0x3422a9||_0x2951b6)&&_0x232eab[_0x456c01(0x13ee)](_0x3e06c8);}if(_0x232eab[_0x456c01(0x40f)]>0x0||Math[_0x456c01(0x95f)]()<0.2){console[_0x456c01(0x1081)](_0x456c01(0x11bd)+_0x258da2[_0x456c01(0x6fc)]+_0x456c01(0x1310));const _0x465b0b=await _0x1957eb(_0x258da2,_0x232eab);if(_0x465b0b&&_0x465b0b[_0x456c01(0x40f)]>0x0){for(const _0x4c7ff6 of _0x465b0b){if(_0x4c7ff6[_0x456c01(0xafc)]==='qzone_comment'){const _0x4c67a0=await _0x4e1bbf[_0x456c01(0xaf9)][_0x456c01(0x11fc)](_0x4c7ff6['postId']);if(_0x4c67a0){if(!_0x4c67a0[_0x456c01(0xff)])_0x4c67a0[_0x456c01(0xff)]=[];_0x4c67a0[_0x456c01(0xff)][_0x456c01(0x13ee)]({'commenterName':_0x258da2[_0x456c01(0x6fc)],'text':_0x4c7ff6['commentText'],'replyTo':_0x4c7ff6['replyTo']||null,'timestamp':Date[_0x456c01(0x2b5)]()+Math['random']()}),await _0x4e1bbf[_0x456c01(0xaf9)]['update'](_0x4c7ff6[_0x456c01(0x6c2)],{'comments':_0x4c67a0[_0x456c01(0xff)]}),_0x1baa80(_0x511de0+0x1);}}else{if(_0x4c7ff6[_0x456c01(0xafc)]===_0x456c01(0x5e8)){const _0x5b0fe0={'type':_0x4c7ff6['postType']||_0x456c01(0x103d),'content':_0x4c7ff6['content'],'timestamp':Date['now'](),'authorId':_0x456c01(0x33e)+_0x258da2['id'],'authorOriginalName':_0x258da2[_0x456c01(0x6fc)],'visibleTo':_0x258da2[_0x456c01(0x22c)],'likes':[],'comments':[],'isDeleted':![]};await _0x4e1bbf[_0x456c01(0xaf9)][_0x456c01(0xdda)](_0x5b0fe0),console[_0x456c01(0x1081)](_0x456c01(0x11bd)+_0x258da2['name']+'\x22\x20成功发布了一条新动态。'),_0x1baa80(_0x511de0+0x1);}}}await _0x4e1bbf[_0x456c01(0xad7)]['update'](_0x258da2['id'],{'lastActionTimestamp':Date['now']()}),document[_0x456c01(0x64f)](_0x456c01(0x3dd))[_0x456c01(0x418)][_0x456c01(0xef6)](_0x456c01(0x12ef))&&await _0x40e6dd();}}}}catch(_0x1ca2e2){console[_0x456c01(0xc60)](_0x456c01(0xd53),_0x1ca2e2);}}async function _0x1957eb(_0x4b635c,_0x33e995){const _0x3d1ef8=_0x5a7792,{proxyUrl:_0x3514b5,apiKey:_0x5a96f8,model:_0xe6d63d}=_0x3e7a1b[_0x3d1ef8(0xec0)];if(!_0x3514b5||!_0x5a96f8||!_0xe6d63d)return console[_0x3d1ef8(0xc60)](_0x3d1ef8(0x7fc)),null;let _0x44004f=_0x3d1ef8(0x1108);const _0x48c012=_0x3e7a1b[_0x3d1ef8(0x3c2)]['nickname']||'我',_0xec9fd4=_0x3e7a1b['chats'][Object[_0x3d1ef8(0xc30)](_0x3e7a1b[_0x3d1ef8(0x999)])[0x0]]?.[_0x3d1ef8(0xcb3)][_0x3d1ef8(0x1047)]||'(未设置)';_0x44004f+=_0x3d1ef8(0x8d8)+_0x48c012+_0x3d1ef8(0xb7c)+_0xec9fd4+'\x0a';_0x4b635c['associatedWith']&&_0x4b635c['associatedWith'][_0x3d1ef8(0x40f)]>0x0&&_0x4b635c[_0x3d1ef8(0x22c)][_0x3d1ef8(0x103)](_0x43e4dd=>{const _0x2f830b=_0x3d1ef8,_0x311c31=_0x3e7a1b[_0x2f830b(0x999)][_0x43e4dd];_0x311c31&&!_0x311c31[_0x2f830b(0x1167)]&&(_0x44004f+=_0x2f830b(0x8d8)+_0x311c31['name']+_0x2f830b(0xbfe)+_0x311c31[_0x2f830b(0x7de)]+_0x2f830b(0x5f5)+_0x311c31[_0x2f830b(0xcb3)][_0x2f830b(0xbe5)]+'\x0a');});const _0x3f2c8e=(await Promise[_0x3d1ef8(0xfd7)](_0x33e995['map'](async _0x12a931=>{const _0x620d50=_0x3d1ef8;let _0x141206=_0x620d50(0xe8);if(_0x12a931['authorId']===_0x620d50(0xa4d))_0x141206=_0x3e7a1b['qzoneSettings']['nickname']||'用户';else{if(_0x12a931[_0x620d50(0x1188)]['startsWith'](_0x620d50(0x1356)))_0x141206=_0x5784e3(_0x12a931[_0x620d50(0xa0a)]||_0x12a931[_0x620d50(0x1188)]);else{if(_0x12a931[_0x620d50(0x1188)][_0x620d50(0x7d)](_0x620d50(0x33e))){const _0xc0a1f0=parseInt(_0x12a931[_0x620d50(0x1188)]['replace'](_0x620d50(0x33e),'')),_0xc01687=await _0x4e1bbf['npcs'][_0x620d50(0x11fc)](_0xc0a1f0);_0xc01687&&(_0x141206=_0xc01687[_0x620d50(0x6fc)]);}}}const _0x1dbf66=(_0x12a931[_0x620d50(0xff)]||[])[_0x620d50(0xb96)](_0x2c8bf0=>{const _0x501e54=_0x620d50;if(typeof _0x2c8bf0===_0x501e54(0x59a)&&_0x2c8bf0[_0x501e54(0x1335)]){const _0x33650d=_0x5784e3(_0x2c8bf0['commenterName']);return _0x501e54(0x8d8)+_0x33650d+'**:\x20'+_0x2c8bf0[_0x501e54(0x673)];}return'-\x20'+_0x2c8bf0;})['join']('\x0a');return _0x620d50(0xaa2)+_0x12a931['id']+_0x620d50(0xf4f)+_0x141206+_0x620d50(0xdea)+(_0x12a931[_0x620d50(0x3ba)]||_0x12a931[_0x620d50(0x66e)]||'')[_0x620d50(0x126f)](0x0,0x96)+_0x620d50(0xb39)+(_0x1dbf66||'(暂无评论)')+_0x620d50(0x1166);})))[_0x3d1ef8(0xd22)]('\x0a'),_0x47c1a3=_0x3d1ef8(0x33e)+_0x4b635c['id'],_0x147854=Date[_0x3d1ef8(0x2b5)]()-0xc*0x3c*0x3c*0x3e8,_0x44ea5d=await _0x4e1bbf[_0x3d1ef8(0xaf9)][_0x3d1ef8(0xec9)]('authorId')['equals'](_0x47c1a3)['and'](_0x2c2b71=>_0x2c2b71[_0x3d1ef8(0x8af)]>_0x147854)[_0x3d1ef8(0x78f)]();let _0x2f3afd='';_0x44ea5d['length']>0x0&&(_0x2f3afd='\x0a#\x20【行为倾向指令\x20(高优先级)】\x0a**你最近已经发布过动态了。**\x20为了让社区互动更自然，你本次行动的【唯一任务】就是**评论**或**回复**下面“待处理的帖子列表”中的内容。\x0a你【绝对禁止】再次发布新动态，除非你收到了直接的指令或有一个对剧情发展至关重要的、紧急的新想法。\x0a');const _0x59b36e=_0x3d1ef8(0x21b)+_0x4b635c[_0x3d1ef8(0x6fc)]+_0x3d1ef8(0xd1b)+_0x2f3afd+_0x3d1ef8(0x7df)+_0x4b635c[_0x3d1ef8(0x6fc)]+_0x3d1ef8(0x7d5)+_0x4b635c['persona']+'\x0a\x0a'+_0x44004f+_0x3d1ef8(0x682)+_0x3f2c8e+_0x3d1ef8(0x8cc);try{const _0x8a647f=[{'role':'user','content':_0x3d1ef8(0xb2c)}];let _0x218fab=_0x3514b5[_0x3d1ef8(0xe53)]('generativelanguage'),_0x1d9ada=_0x250668(_0xe6d63d,_0x5a96f8,_0x59b36e,_0x8a647f);const _0x19ea78=_0x218fab?await fetch(_0x1d9ada[_0x3d1ef8(0xe52)],_0x1d9ada[_0x3d1ef8(0x88a)]):await fetch(_0x3514b5+_0x3d1ef8(0x58b),{'method':'POST','headers':{'Content-Type':_0x3d1ef8(0x7fe),'Authorization':_0x3d1ef8(0x236)+_0x5a96f8},'body':JSON['stringify']({'model':_0xe6d63d,'messages':[{'role':_0x3d1ef8(0x905),'content':_0x59b36e},..._0x8a647f],'temperature':_0x3e7a1b['globalSettings'][_0x3d1ef8(0xa55)]||0.9})});if(!_0x19ea78['ok'])throw new Error(_0x3d1ef8(0x1fa)+_0x19ea78['statusText']);const _0x2f04ae=await _0x19ea78['json'](),_0x216b12=getGeminiResponseText(_0x2f04ae),_0x5e7946=_0x216b12[_0x3d1ef8(0x132a)](/(\[[\s\S]*\])/);if(!_0x5e7946)throw new Error(_0x3d1ef8(0xe5b));return JSON[_0x3d1ef8(0x1214)](_0x5e7946[0x0]);}catch(_0xdc9e04){return console['error'](_0x3d1ef8(0x1a8)+_0x4b635c['name']+_0x3d1ef8(0x1072),_0xdc9e04),null;}}async function _0x42a425(_0x38cc5c){const _0x43d5c7=_0x5a7792,_0x19426e=_0x3e7a1b['chats'][_0x38cc5c];if(!_0x19426e)return;const _0x53b67f=_0x19426e['settings']['actionCooldownMinutes']||0xa;if(_0x19426e[_0x43d5c7(0x11ea)]){const _0x589e0a=(Date[_0x43d5c7(0x2b5)]()-_0x19426e[_0x43d5c7(0x11ea)])/(0x3e8*0x3c);if(_0x589e0a<_0x53b67f){console['log']('角色\x20\x22'+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0x116c)+Math[_0x43d5c7(0xb15)](_0x53b67f-_0x589e0a)+_0x43d5c7(0x10ee));return;}}_0x570655(_0x38cc5c,!![]);const {proxyUrl:_0x2d080e,apiKey:_0x182b5c,model:_0x18637d}=_0x3e7a1b[_0x43d5c7(0xec0)];if(!_0x2d080e||!_0x182b5c||!_0x18637d)return;const _0x114dfa=_0x3e7a1b['qzoneSettings']['nickname'],_0x1af67c=new Date(),_0x41186c=_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0xd4e)]||_0x43d5c7(0xe77),_0x23cd2d=_0x1af67c['toLocaleString'](_0x43d5c7(0x6ec),{'timeZone':_0x41186c,'dateStyle':'full','timeStyle':_0x43d5c7(0xf1)}),_0x1005ac=new Date(_0x1af67c[_0x43d5c7(0x2b4)](_0x43d5c7(0xa63),{'timeZone':_0x41186c}));let _0x180c53='',_0x483356='',_0x585ee8,_0x2f4438=![];const _0x252185=_0x19426e['settings'][_0x43d5c7(0xd50)]||0xa,_0x13d418=_0x19426e[_0x43d5c7(0x830)][_0x43d5c7(0x156)](_0x5e80af=>!_0x5e80af[_0x43d5c7(0x5cc)])['slice'](-_0x252185),_0x4d3fd7=_0x19426e[_0x43d5c7(0x830)]['filter'](_0x28dbcf=>!_0x28dbcf[_0x43d5c7(0x5cc)])[_0x43d5c7(0xdf5)](-0x1)[0x0];if(_0x19426e['settings'][_0x43d5c7(0x35f)]){_0x180c53=_0x19a7ae(_0x1005ac);const _0x195d04=_0x19426e[_0x43d5c7(0x830)][_0x43d5c7(0x156)](_0x19e3b4=>!_0x19e3b4[_0x43d5c7(0x5cc)])[_0x43d5c7(0xdf5)](-0x1)[0x0],_0x2aab42=new Date();let _0xc7f0f9='',_0x147995=![];if(_0x195d04){const _0x410ff0=new Date(_0x195d04[_0x43d5c7(0x8af)]),_0x58ca6c=(_0x2aab42-_0x410ff0)/(0x3e8*0x3c*0x3c);if(_0x58ca6c>0xc){_0x147995=!![];const _0x33d684=Math[_0x43d5c7(0x1245)](_0x58ca6c/0x18);_0xc7f0f9=_0x43d5c7(0x9e6)+(_0x33d684>0x0?_0x33d684+'天':Math['floor'](_0x58ca6c)+'小时')+_0x43d5c7(0x12b8);}else{const _0x45d63f=Math[_0x43d5c7(0x1245)](_0x58ca6c*0x3c);if(_0x45d63f<0x5)_0xc7f0f9='你们的对话刚刚还在继续。';else _0x45d63f<0x3c?_0xc7f0f9=_0x43d5c7(0x10f7)+_0x45d63f+'分钟前聊过。':_0xc7f0f9=_0x43d5c7(0x10f7)+Math[_0x43d5c7(0x1245)](_0x58ca6c)+_0x43d5c7(0x4d9);}}else _0x147995=!![],_0xc7f0f9='这是你们的第一次互动。';let _0x544e82=_0x43d5c7(0xc34);_0x13d418[_0x43d5c7(0x40f)]>0x0&&(_0x544e82=_0x43d5c7(0x7ce)+_0x13d418[_0x43d5c7(0xb96)](_0x102c76=>{const _0x350719=_0x43d5c7,_0x292eba=_0x102c76[_0x350719(0x931)]===_0x350719(0xa4d)?_0x114dfa:_0x19426e[_0x350719(0x6fc)];return _0x292eba+':\x20'+String(_0x102c76[_0x350719(0x3ba)])['substring'](0x0,0x32)+_0x350719(0x3cd);})['join']('\x0a')),_0x147995?_0x585ee8='[情景提示]\x20'+_0xc7f0f9+_0x43d5c7(0x82f)+_0x23cd2d+_0x43d5c7(0x90)+_0x544e82:_0x585ee8=''+_0x544e82;}else _0x13d418['length']>0x0?_0x585ee8=_0x43d5c7(0x7ce)+_0x13d418[_0x43d5c7(0xb96)](_0x12f3ff=>{const _0x1417c9=_0x43d5c7,_0x589d45=_0x12f3ff[_0x1417c9(0x931)]===_0x1417c9(0xa4d)?_0x114dfa:_0x19426e[_0x1417c9(0x6fc)];return _0x589d45+':\x20'+String(_0x12f3ff[_0x1417c9(0x3ba)])['substring'](0x0,0x32)+_0x1417c9(0x3cd);})['join']('\x0a'):_0x585ee8=_0x43d5c7(0xc34);const _0x4e1328=await _0x4e1bbf[_0x43d5c7(0xaf9)][_0x43d5c7(0xe1d)](_0x43d5c7(0x8af))['reverse']()[_0x43d5c7(0xb2e)](0x5)[_0x43d5c7(0x78f)](),_0x14d956=_0x4e4575(_0x4e1328,_0x19426e),_0x5b162e=_0x14d956[_0x43d5c7(0x156)](_0x41cb4e=>_0x41cb4e[_0x43d5c7(0x1188)]===_0x38cc5c);let _0xd2f16f='';_0x5b162e[_0x43d5c7(0x40f)]>0x0&&(_0xd2f16f=_0x43d5c7(0x138f),_0x5b162e[_0x43d5c7(0x103)](_0x11091d=>{const _0x343c23=_0x43d5c7;let _0x118a6c=(_0x11091d[_0x343c23(0x66e)]||_0x11091d['content']||_0x343c23(0xb50))[_0x343c23(0x126f)](0x0,0x28)+'...';_0xd2f16f+='-\x20(ID:\x20'+_0x11091d['id']+_0x343c23(0x920)+_0x118a6c+'\x22\x0a';}));let _0x5b9ad0=[];_0x14d956[_0x43d5c7(0x40f)]>0x0&&(_0x5b9ad0=_0x14d956[_0x43d5c7(0xb96)](_0x1b178f=>{const _0x36e205=_0x43d5c7;let _0xf33f63;if(_0x1b178f['type']===_0x36e205(0x351))_0xf33f63=(_0x36e205(0xb5a)+_0x1b178f[_0x36e205(0x1150)]+_0x36e205(0x13a)+(_0x1b178f[_0x36e205(0x66e)]||''))[_0x36e205(0x126f)](0x0,0x32)+_0x36e205(0x3cd);else _0x1b178f[_0x36e205(0xafc)]===_0x36e205(0x3d9)?_0xf33f63=(_0x36e205(0x5ac)+_0x1b178f[_0x36e205(0x911)]+_0x36e205(0x13a)+(_0x1b178f[_0x36e205(0x66e)]||''))[_0x36e205(0x126f)](0x0,0x32)+_0x36e205(0x3cd):_0xf33f63=String(_0x1b178f[_0x36e205(0x66e)]||_0x1b178f[_0x36e205(0x3ba)]||_0x36e205(0xb50))[_0x36e205(0x126f)](0x0,0x32)+_0x36e205(0x3cd);return _0x36e205(0xcd6)+_0xf33f63+'\x22';}));let _0x5d4b88='';_0x5b9ad0[_0x43d5c7(0x40f)]>0x0&&(_0x5d4b88=_0x43d5c7(0x270)+_0x5b9ad0['join']('\x0a')+_0x43d5c7(0xeb3));let _0x10e26b='';if(_0x19426e['settings'][_0x43d5c7(0xde4)]&&_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0xde4)][_0x43d5c7(0x40f)]>0x0){const _0x1e5fc4=_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0xde4)][_0x43d5c7(0xb96)](_0x1f2c57=>{const _0x1ed6f6=_0x43d5c7,_0x4429c3=_0x3e7a1b[_0x1ed6f6(0x144)][_0x1ed6f6(0x137)](_0x5dd11f=>_0x5dd11f['id']===_0x1f2c57);if(!_0x4429c3||!Array[_0x1ed6f6(0x97e)](_0x4429c3[_0x1ed6f6(0x3ba)]))return'';const _0x2388ad=_0x4429c3[_0x1ed6f6(0x3ba)]['filter'](_0x52a906=>_0x52a906[_0x1ed6f6(0x9b)]!==![])[_0x1ed6f6(0xb96)](_0x5ade51=>{const _0xc0bde7=_0x1ed6f6;let _0x780b3d='\x0a###\x20条目:\x20'+(_0x5ade51['comment']||_0xc0bde7(0x497))+'\x0a';return _0x5ade51[_0xc0bde7(0xc30)][_0xc0bde7(0x40f)]>0x0&&(_0x780b3d+='**关键词:**\x20'+_0x5ade51['keys'][_0xc0bde7(0xd22)](',\x20')+'\x0a'),_0x780b3d+=_0xc0bde7(0x188)+_0x5ade51[_0xc0bde7(0x3ba)],_0x780b3d;})['join']('');return _0x2388ad?_0x1ed6f6(0x228)+_0x4429c3['name']+'\x0a'+_0x2388ad:'';})[_0x43d5c7(0x156)](Boolean)[_0x43d5c7(0xd22)]('');_0x1e5fc4&&(_0x10e26b=_0x43d5c7(0x13cc)+_0x1e5fc4+'\x0a#\x20---\x20世界书设定结束\x20---\x0a');}let _0x3c3df6='';const _0x21bb6d=_0x19426e[_0x43d5c7(0xcb3)]['linkedMemoryCount']||0xa;if(_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0x4d8)]&&_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0x4d8)][_0x43d5c7(0x40f)]>0x0){const _0xe98520=_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0x4d8)][_0x43d5c7(0xb96)](_0xdafd43=>{const _0x4ef33b=_0x43d5c7,_0x222849=_0x3e7a1b[_0x4ef33b(0x999)][_0xdafd43];if(!_0x222849)return null;const _0x410dcc=_0x222849['history'][_0x4ef33b(0xdf5)](-0x1)[0x0];return{'chat':_0x222849,'latestTimestamp':_0x410dcc?_0x410dcc[_0x4ef33b(0x8af)]:0x0};})[_0x43d5c7(0x156)](Boolean);_0xe98520[_0x43d5c7(0x102f)]((_0x3935ca,_0x310205)=>_0x310205['latestTimestamp']-_0x3935ca[_0x43d5c7(0x5aa)]),_0x3c3df6+=_0x43d5c7(0x91c);for(const _0x1652af of _0xe98520){const _0x387bf7=_0x1652af['chat'],_0x3421cf=_0x387bf7[_0x43d5c7(0x1167)]?_0x43d5c7(0x743):_0x43d5c7(0x1093),_0x1328d3=_0x1652af[_0x43d5c7(0x5aa)]>0x0?_0x43d5c7(0x8ce)+_0x4942eb(_0x1652af[_0x43d5c7(0x5aa)])+')':'';_0x3c3df6+=_0x43d5c7(0x149)+_0x3421cf+'“'+_0x387bf7['name']+_0x43d5c7(0x838)+_0x1328d3+'\x20---\x0a';const _0x3a5d34=_0x387bf7[_0x43d5c7(0x830)][_0x43d5c7(0xdf5)](-_0x21bb6d),_0x48ac03=_0x3a5d34[_0x43d5c7(0x156)](_0xcbb641=>!String(_0xcbb641[_0x43d5c7(0x3ba)])[_0x43d5c7(0xe53)]('已被用户删除'));_0x48ac03[_0x43d5c7(0x40f)]>0x0?_0x48ac03[_0x43d5c7(0x103)](_0x147a07=>{const _0x1f46fa=_0x43d5c7,_0x5d6274=_0x147a07[_0x1f46fa(0x931)]===_0x1f46fa(0xa4d)?_0x387bf7['settings']['myNickname']||'我':_0x147a07[_0x1f46fa(0x133d)]||_0x387bf7['name'];let _0x31c9b4=String(_0x147a07[_0x1f46fa(0x3ba)]);if(_0x147a07[_0x1f46fa(0xafc)]===_0x1f46fa(0x118)||_0x147a07[_0x1f46fa(0xafc)]==='user_photo')_0x31c9b4=_0x1f46fa(0x6e4)+_0x147a07['content']+']';else _0x147a07['type']==='voice_message'&&(_0x31c9b4=_0x1f46fa(0x1174)+_0x147a07[_0x1f46fa(0x3ba)]+']');_0x3c3df6+=_0x5d6274+':\x20'+_0x31c9b4+'\x0a';}):_0x3c3df6+=_0x43d5c7(0x596);}}let _0xfccd5f='';if(_0x14d956[_0x43d5c7(0x40f)]>0x0){let _0xff258c=_0x43d5c7(0x7a3);for(const _0x56589c of _0x14d956){let _0x145aa7;if(_0x56589c['authorId']===_0x43d5c7(0xa4d))_0x145aa7=_0x3e7a1b[_0x43d5c7(0x3c2)][_0x43d5c7(0x78c)];else{if(String(_0x56589c[_0x43d5c7(0x1188)])[_0x43d5c7(0x7d)](_0x43d5c7(0x33e)))_0x145aa7=_0x56589c[_0x43d5c7(0xa0a)]||_0x43d5c7(0x546);else{const _0x5e3ca6=_0x3e7a1b[_0x43d5c7(0x999)][_0x56589c[_0x43d5c7(0x1188)]];_0x145aa7=_0x5e3ca6?_0x5e3ca6[_0x43d5c7(0x6fc)]:'一位朋友';}}if(_0x56589c[_0x43d5c7(0x1188)]===_0x38cc5c)_0x145aa7+='\x20(这是你的帖子)';let _0x1a7251;if(_0x56589c[_0x43d5c7(0xafc)]===_0x43d5c7(0xe5a)){const _0x2f1fd9=_0x56589c[_0x43d5c7(0xa19)]?_0x43d5c7(0x1100)+_0x56589c[_0x43d5c7(0xa19)]+'\x22':'';let _0x4d8ec2=_0x43d5c7(0xefd);const _0x299fe3=_0x56589c[_0x43d5c7(0x32f)]['authorId'];if(_0x299fe3==='user')_0x4d8ec2=_0x3e7a1b[_0x43d5c7(0x3c2)]['nickname'];else _0x3e7a1b['chats'][_0x299fe3]&&(_0x4d8ec2=_0x3e7a1b[_0x43d5c7(0x999)][_0x299fe3][_0x43d5c7(0x6fc)]);let _0x140b7e;const _0x3879eb=_0x56589c['originalPost'];if(_0x3879eb['type']===_0x43d5c7(0x351))_0x140b7e=_0x43d5c7(0x640)+(_0x3879eb[_0x43d5c7(0x66e)]||'')+_0x43d5c7(0xd03)+(_0x3879eb[_0x43d5c7(0x1150)]||'')[_0x43d5c7(0x126f)](0x0,0x28)+_0x43d5c7(0x57c);else _0x3879eb[_0x43d5c7(0xafc)]==='image_post'?_0x140b7e=_0x43d5c7(0x8d0)+(_0x3879eb['publicText']||'')+_0x43d5c7(0xd03)+(_0x3879eb[_0x43d5c7(0x911)]||'')[_0x43d5c7(0x126f)](0x0,0x28)+_0x43d5c7(0x57c):_0x140b7e='\x22'+(_0x3879eb[_0x43d5c7(0x3ba)]||'')[_0x43d5c7(0x126f)](0x0,0x28)+_0x43d5c7(0x6fa);_0x1a7251='转发了\x20@'+_0x4d8ec2+_0x43d5c7(0x76f)+_0x2f1fd9+_0x43d5c7(0xb4c)+_0x140b7e+'】';}else{if(_0x56589c[_0x43d5c7(0xafc)]===_0x43d5c7(0x351))_0x1a7251=(_0x43d5c7(0xcfe)+_0x56589c[_0x43d5c7(0x1150)]+'\x22]\x20'+(_0x56589c['publicText']||''))[_0x43d5c7(0x126f)](0x0,0x32)+'...';else{if(_0x56589c['type']===_0x43d5c7(0x3d9))_0x1a7251=(_0x43d5c7(0x601)+_0x56589c['imageDescription']+_0x43d5c7(0x7e7)+(_0x56589c['publicText']||''))[_0x43d5c7(0x126f)](0x0,0x32)+_0x43d5c7(0x3cd);else{if(_0x56589c['type']===_0x43d5c7(0x13df)&&_0x56589c[_0x43d5c7(0x1381)]){const _0x3a157c=Array[_0x43d5c7(0x97e)](_0x56589c[_0x43d5c7(0x1381)])?_0x56589c['prompt']:[_0x56589c['prompt']];_0x1a7251=(_0x56589c[_0x43d5c7(0x66e)]||'')+(_0x43d5c7(0xb25)+_0x3a157c['length']+_0x43d5c7(0x912)+_0x3a157c[_0x43d5c7(0xd22)](',\x20')+']');}else _0x1a7251=String(_0x56589c[_0x43d5c7(0x66e)]||_0x56589c[_0x43d5c7(0x3ba)]||_0x43d5c7(0xb50))[_0x43d5c7(0x126f)](0x0,0x32)+'...';}}}_0xff258c+='-\x20(ID:\x20'+_0x56589c['id']+_0x43d5c7(0x104d)+_0x145aa7+_0x43d5c7(0xbbd)+_0x1a7251+'\x22\x0a';if(_0x56589c['comments']&&_0x56589c[_0x43d5c7(0xff)]['length']>0x0)for(const _0x90682c of _0x56589c['comments']){if(typeof _0x90682c==='object'&&_0x90682c[_0x43d5c7(0x1335)]){const _0x6db11a=_0x5784e3(_0x90682c['commenterName']);let _0x25aedd=_0x90682c[_0x43d5c7(0x10b3)]?_0x43d5c7(0x1120)+_0x90682c['meaning']+'\x27]':_0x90682c[_0x43d5c7(0x673)];_0x90682c[_0x43d5c7(0x1335)]===_0x19426e['originalName']?_0xff258c+=_0x43d5c7(0xa0e)+_0x25aedd+'\x0a':_0xff258c+='\x20\x20-\x20评论:\x20'+_0x6db11a+'\x20(本名:\x20'+_0x90682c[_0x43d5c7(0x1335)]+'):\x20'+_0x25aedd+'\x0a';}}}_0xfccd5f=_0xff258c;}const _0xa88e45=_0x43d5c7(0x8b3)+(_0x19426e['longTermMemory']&&_0x19426e['longTermMemory'][_0x43d5c7(0x40f)]>0x0?_0x19426e['longTermMemory'][_0x43d5c7(0xb96)](_0x4ccf9c=>'-\x20(记录于\x20'+_0x4942eb(_0x4ccf9c[_0x43d5c7(0x8af)])+')\x20'+_0x4ccf9c[_0x43d5c7(0x3ba)])[_0x43d5c7(0xd22)]('\x0a'):_0x43d5c7(0xd0b)),_0x134b29=_0x5871dc(_0x19426e,0x3,_0x43d5c7(0x4b6)),_0x31acce=_0x5871dc(_0x19426e,0x6,_0x43d5c7(0x4b6)),_0x3c9323=_0x5871dc(_0x19426e,0x9,_0x43d5c7(0x4b6)),_0x438eee=_0x5871dc(_0x19426e,0x1,'days'),_0x3e8270=_0x5871dc(_0x19426e,0x3,'days'),_0x3c72c3=_0x5871dc(_0x19426e,0x7,_0x43d5c7(0x82a));let _0x47ca69='';if(_0x134b29||_0x31acce||_0x3c9323||_0x438eee||_0x3e8270||_0x3c72c3){_0x47ca69+=_0x43d5c7(0xd98);if(_0x134b29)_0x47ca69+=_0x134b29;if(_0x31acce)_0x47ca69+=_0x31acce;if(_0x3c9323)_0x47ca69+=_0x3c9323;if(_0x134b29||_0x31acce||_0x3c9323)_0x47ca69+='\x0a';if(_0x438eee)_0x47ca69+=_0x438eee;if(_0x3e8270)_0x47ca69+=_0x3e8270;if(_0x3c72c3)_0x47ca69+=_0x3c72c3;}const _0x5bc8cb=_0x5530dc(_0x19426e),_0x59d0a9=_0x43d5c7(0x432)+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0x1132)+_0x19426e[_0x43d5c7(0x7de)]+_0x43d5c7(0x1c4)+_0x114dfa+_0x43d5c7(0x12da)+(_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0x35f)]?_0x43d5c7(0xb31)+_0x23cd2d+'\x20('+_0x180c53+_0x43d5c7(0x151)+_0x483356+'\x0a'+(_0x2f4438?'【重要提示】你们已经很久没聊天了！你【必须】将本次行动的重点放在使用\x20\x27text\x27\x20指令给用户发消息，主动开启一个新的、有趣的话题来重新建立联系。绝对不要只是点赞或评论动态，那会显得你很冷漠！':''):'')+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20【对话节奏铁律\x20(至关重要！)】\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】模拟真人的打字和思考习惯。**绝对不要一次性发送一大段文字！**\x20你应该将你想说的话，拆分成【多条、简短的】消息气泡来发送，每条消息最好不要超过30个字。这会让对话看起来更自然、更真实。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【决策依据】**:\x20你的所有行动都【必须深度结合你的角色设定、核心世界观、以及你们最后的对话摘要】。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20**【内容多样性铁律】**:\x20你的行动【必须】具有逻辑和多样性。你【绝对不能】发布与下方“内容禁忌”列表或“最近的动态列表”中内容相似或主题重复的动态。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20**【行为多样性指南\x20(至关重要)】**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20你的上一次独立行动是：**'+(_0x19426e[_0x43d5c7(0x248)]||'无')+_0x43d5c7(0x12ba)+_0x5d4b88+_0x43d5c7(0xeb3)+_0xd2f16f+_0x43d5c7(0x8e8)+_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0xbe5)]+_0x43d5c7(0xeb3)+_0x10e26b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x19426e['longTermMemory']&&_0x19426e[_0x43d5c7(0x518)][_0x43d5c7(0x40f)]>0x0?_0x19426e[_0x43d5c7(0x518)][_0x43d5c7(0xb96)](_0x578ee5=>_0x43d5c7(0x56b)+_0x4942eb(_0x578ee5['timestamp'])+')\x20'+_0x578ee5['content'])['join']('\x0a'):'无')+_0x43d5c7(0xeb3)+_0x47ca69+_0x43d5c7(0xf6e)+_0x3c3df6+_0x43d5c7(0xeb3)+(_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0x35f)]?'-\x20\x20\x20**当前时间**:'+_0x23cd2d+'\x20('+_0x180c53+')':'')+_0x43d5c7(0xeb3)+(_0x19426e[_0x43d5c7(0xcb3)]['enableTimePerception']?_0x43d5c7(0xc1d)+_0x483356:'')+_0x43d5c7(0x1388)+_0x5bc8cb+_0x43d5c7(0xe6f)+_0x585ee8+_0x43d5c7(0xeb3)+_0xfccd5f+'\x0a',_0x254865=[{'role':'system','content':_0x59d0a9},..._0x13d418[_0x43d5c7(0xb96)](_0x596201=>{const _0x17727d=_0x43d5c7,_0x5af4fa=_0x596201[_0x17727d(0x931)]===_0x17727d(0xa4d)?_0x114dfa:_0x19426e[_0x17727d(0x6fc)];let _0x5c74e6=_0x596201[_0x17727d(0x3ba)];return typeof _0x5c74e6!==_0x17727d(0x1251)&&(_0x5c74e6=JSON[_0x17727d(0xe3f)](_0x5c74e6)),{'role':_0x596201[_0x17727d(0x931)],'content':_0x5af4fa+':\x20'+_0x5c74e6};})];try{const _0x22ec8f=[{'role':'user','content':_0x59d0a9+_0x43d5c7(0x7d6)+_0xfccd5f}];console['log'](_0x43d5c7(0x954)+_0x19426e[_0x43d5c7(0x6fc)]+'\x22)');let _0xa71866=_0x2d080e===GEMINI_API_URL,_0xc93405=_0x250668(_0x18637d,_0x182b5c,_0x59d0a9,_0x22ec8f);const _0x45150a=_0xa71866?await fetch(_0xc93405[_0x43d5c7(0xe52)],_0xc93405[_0x43d5c7(0x88a)]):await fetch(_0x2d080e+'/v1/chat/completions',{'method':_0x43d5c7(0x2d1),'headers':{'Content-Type':_0x43d5c7(0x7fe),'Authorization':_0x43d5c7(0x236)+_0x182b5c},'body':JSON[_0x43d5c7(0xe3f)]({'model':_0x18637d,'messages':_0x22ec8f,'temperature':_0x3e7a1b[_0x43d5c7(0x11b4)][_0x43d5c7(0xa55)]||0.9})});if(!_0x45150a['ok']){const _0x1ec658=await _0x45150a[_0x43d5c7(0x6f8)]();throw new Error(_0x43d5c7(0x114e)+_0x45150a['status']+_0x43d5c7(0xc78)+JSON[_0x43d5c7(0xe3f)](_0x1ec658));}const _0x38ef40=await _0x45150a[_0x43d5c7(0x6f8)](),_0x1aecd1=_0xa71866?getGeminiResponseText(_0x38ef40):_0x38ef40[_0x43d5c7(0x4fe)][0x0][_0x43d5c7(0x854)]['content'];if(!_0x1aecd1||_0x1aecd1[_0x43d5c7(0x43a)]()===''){console['warn'](_0x43d5c7(0x3ab)+_0x19426e[_0x43d5c7(0x6fc)]+'\x22\x20的本次后台活动跳过。');return;}const _0x348380=_0x3755ce(_0x1aecd1);if(!_0x348380||_0x348380['length']===0x0){console[_0x43d5c7(0x1155)]('API格式不正确，角色\x20\x22'+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0xcaa),_0x1aecd1);return;}let _0x44f04a=Date[_0x43d5c7(0x2b5)](),_0x15e7a4=![];const _0x57f0cd=[];for(const _0x17780b of _0x348380){const _0x292ad8=String(_0x17780b[_0x43d5c7(0x3ba)]||''),_0xaa6dd2=_0x292ad8[_0x43d5c7(0x43a)]()['startsWith']('<')&&_0x292ad8[_0x43d5c7(0x43a)]()[_0x43d5c7(0x720)]('>');if(_0x17780b[_0x43d5c7(0xafc)]===_0x43d5c7(0x673)&&!_0xaa6dd2&&_0x292ad8['includes']('\x0a')){const _0x28aa8b=_0x292ad8[_0x43d5c7(0x108c)](/\n+/)['filter'](_0x21da59=>_0x21da59['trim']());_0x28aa8b[_0x43d5c7(0x103)](_0x4f911b=>{const _0x4d6a89=_0x43d5c7;_0x57f0cd[_0x4d6a89(0x13ee)]({..._0x17780b,'content':_0x4f911b});});}else _0x57f0cd['push'](_0x17780b);}for(const _0x45c7ce of _0x57f0cd){_0x19426e['lastActionType']=_0x45c7ce[_0x43d5c7(0xafc)],_0x19426e[_0x43d5c7(0x11ea)]=_0x44f04a;let _0x281fd1=null;const _0x186071={'role':_0x43d5c7(0x12c3),'senderName':_0x19426e[_0x43d5c7(0x7de)],'timestamp':_0x44f04a++};let _0x3dc826=null;switch(_0x45c7ce[_0x43d5c7(0xafc)]){case _0x43d5c7(0xff9):{const _0x47da5b=parseInt(_0x45c7ce[_0x43d5c7(0x6c2)]),_0x146dac=await _0x4e1bbf[_0x43d5c7(0xaf9)][_0x43d5c7(0x11fc)](_0x47da5b);if(_0x146dac&&_0x146dac[_0x43d5c7(0x1188)]===_0x38cc5c){await _0x4e1bbf['qzonePosts'][_0x43d5c7(0x32e)](_0x47da5b,{'isDeleted':!![]});document[_0x43d5c7(0x64f)](_0x43d5c7(0x3dd))['classList'][_0x43d5c7(0xef6)]('active')&&_0x40e6dd();const _0x570960={'role':_0x43d5c7(0x905),'type':_0x43d5c7(0xc5d),'content':'['+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0xf4b),'postId':_0x47da5b,'timestamp':_0x44f04a++};_0x19426e['history'][_0x43d5c7(0x13ee)](_0x570960),isViewingThisChat?_0x3c7e84(_0x570960,_0x19426e):(_0x19426e[_0x43d5c7(0x13c0)]=(_0x19426e[_0x43d5c7(0x13c0)]||0x0)+0x1,_0x1c47b3(_0x38cc5c,'['+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0xf4b)),_0x15e7a4=!![]);}else console[_0x43d5c7(0x1155)](_0x43d5c7(0x39a)+_0x19426e['name']+'\x22\x20尝试删除一个不存在或不属于自己的动态\x20(ID:\x20'+_0x45c7ce[_0x43d5c7(0x6c2)]+')');continue;}case _0x43d5c7(0x673):_0x281fd1={..._0x186071,'content':_0x45c7ce[_0x43d5c7(0x3ba)]};break;case _0x43d5c7(0x118):_0x281fd1={..._0x186071,'type':'ai_image','content':_0x45c7ce[_0x43d5c7(0x9af)]};break;case _0x43d5c7(0xefb):if(_0x45c7ce[_0x43d5c7(0x10b3)]){const _0x9c50ca=_0x3e7a1b[_0x43d5c7(0xa8b)]['find'](_0x5f5d14=>_0x5f5d14[_0x43d5c7(0x6fc)]===_0x45c7ce[_0x43d5c7(0x10b3)]);_0x9c50ca?_0x281fd1={..._0x186071,'type':_0x43d5c7(0xefb),'content':_0x9c50ca[_0x43d5c7(0xe52)],'meaning':_0x9c50ca['name']}:(console[_0x43d5c7(0x1155)](_0x43d5c7(0x5fa)+_0x45c7ce[_0x43d5c7(0x10b3)]+'\x22'),_0x281fd1={..._0x186071,'type':_0x43d5c7(0x673),'content':'[表情:\x20'+_0x45c7ce[_0x43d5c7(0x10b3)]+']'});}else console[_0x43d5c7(0x1155)](_0x43d5c7(0x1111),_0x45c7ce),_0x281fd1={..._0x186071,'type':_0x43d5c7(0xefb),'content':_0x45c7ce[_0x43d5c7(0xe52)],'meaning':'未知表情'};break;case _0x43d5c7(0x1396):_0x19426e[_0x43d5c7(0x69e)][_0x43d5c7(0x673)]=_0x45c7ce[_0x43d5c7(0x13be)],_0x19426e['status'][_0x43d5c7(0x91b)]=_0x45c7ce[_0x43d5c7(0x1f8)]||![],_0x19426e[_0x43d5c7(0x69e)]['lastUpdate']=Date[_0x43d5c7(0x2b5)]();break;case _0x43d5c7(0x5e8):const _0x88695e={'type':_0x45c7ce[_0x43d5c7(0x12c9)],'content':_0x45c7ce['content']||'','publicText':_0x45c7ce[_0x43d5c7(0x66e)]||'','hiddenContent':_0x45c7ce[_0x43d5c7(0x1150)]||'','image_prompt':_0x45c7ce[_0x43d5c7(0x242)]||'','timestamp':Date[_0x43d5c7(0x2b5)](),'authorId':_0x38cc5c,'authorOriginalName':_0x19426e[_0x43d5c7(0x7de)],'authorGroupId':_0x19426e['groupId'],'visibleGroupIds':null};await _0x4e1bbf['qzonePosts'][_0x43d5c7(0xdda)](_0x88695e),_0x1baa80(_0x511de0+0x1),console['log'](_0x43d5c7(0x7b0)+_0x19426e['name']+_0x43d5c7(0xaff));break;case _0x43d5c7(0xe5a):const _0x29f622=await _0x4e1bbf[_0x43d5c7(0xaf9)][_0x43d5c7(0x11fc)](parseInt(_0x45c7ce[_0x43d5c7(0x6c2)]));if(_0x29f622){const _0x565924={'type':_0x43d5c7(0xe5a),'timestamp':Date[_0x43d5c7(0x2b5)](),'authorId':_0x38cc5c,'authorGroupId':_0x19426e[_0x43d5c7(0xeb)],'authorOriginalName':_0x19426e['originalName'],'repostComment':_0x45c7ce[_0x43d5c7(0x652)]||'','originalPost':_0x29f622,'visibleGroupIds':null};await _0x4e1bbf[_0x43d5c7(0xaf9)][_0x43d5c7(0xdda)](_0x565924),_0x1baa80(_0x511de0+0x1),console['log'](_0x43d5c7(0x7b0)+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0xd58)+_0x45c7ce[_0x43d5c7(0x6c2)]);}break;case _0x43d5c7(0xc3c):const _0x406fbd=await _0x4e1bbf[_0x43d5c7(0xaf9)][_0x43d5c7(0x11fc)](parseInt(_0x45c7ce[_0x43d5c7(0x6c2)]));if(_0x406fbd){if(!_0x406fbd[_0x43d5c7(0x940)])_0x406fbd[_0x43d5c7(0x940)]=[];!_0x406fbd[_0x43d5c7(0x940)][_0x43d5c7(0xe53)](_0x19426e[_0x43d5c7(0x7de)])&&(_0x406fbd[_0x43d5c7(0x940)]['push'](_0x19426e[_0x43d5c7(0x7de)]),await _0x4e1bbf[_0x43d5c7(0xaf9)]['update'](_0x406fbd['id'],{'likes':_0x406fbd['likes']}),_0x1baa80(_0x511de0+0x1),console[_0x43d5c7(0x1081)]('后台活动:\x20角色\x20\x22'+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0x118a)+_0x45c7ce[_0x43d5c7(0x6c2)]));}break;case _0x43d5c7(0xbf2):{const _0x220644=await _0x4e1bbf[_0x43d5c7(0xaf9)][_0x43d5c7(0x11fc)](parseInt(_0x45c7ce[_0x43d5c7(0x6c2)]));if(_0x220644){if(!_0x220644[_0x43d5c7(0xff)])_0x220644[_0x43d5c7(0xff)]=[];const _0x405ed5=_0x45c7ce[_0x43d5c7(0x6fc)]||_0x19426e['originalName'],_0x28139a=(_0xf6899d,_0x342c15=null,_0x1a98bd=null)=>({'commenterName':_0x405ed5,'text':_0x1ba418(_0xf6899d,_0x19426e),'meaning':_0x342c15,'replyTo':_0x1a98bd,'timestamp':Date[_0x43d5c7(0x2b5)]()});if(_0x45c7ce[_0x43d5c7(0xc5)]){const _0x498105=_0x3e7a1b['userStickers'][_0x43d5c7(0x137)](_0x1f0941=>_0x1f0941[_0x43d5c7(0x6fc)]===_0x45c7ce[_0x43d5c7(0xc5)]);_0x498105?_0x220644[_0x43d5c7(0xff)][_0x43d5c7(0x13ee)](_0x28139a(_0x498105[_0x43d5c7(0xe52)],_0x498105['name'],_0x45c7ce[_0x43d5c7(0xe51)]||null)):(console[_0x43d5c7(0x1155)]('AI\x20尝试评论一个不存在的表情:\x20\x22'+_0x45c7ce[_0x43d5c7(0xc5)]+'\x22'),_0x220644[_0x43d5c7(0xff)]['push'](_0x28139a(_0x43d5c7(0x7af)+_0x45c7ce[_0x43d5c7(0xc5)]+']',null,_0x45c7ce[_0x43d5c7(0xe51)]||null)));}else{if(Array[_0x43d5c7(0x97e)](_0x45c7ce[_0x43d5c7(0xff)]))_0x45c7ce[_0x43d5c7(0xff)][_0x43d5c7(0x103)](_0x3a4f4a=>{const _0x11c395=_0x43d5c7;typeof _0x3a4f4a===_0x11c395(0x1251)&&_0x3a4f4a[_0x11c395(0x43a)]()&&_0x220644['comments'][_0x11c395(0x13ee)](_0x28139a(_0x3a4f4a,null,_0x45c7ce[_0x11c395(0xe51)]||null));});else typeof _0x45c7ce[_0x43d5c7(0x8f0)]===_0x43d5c7(0x1251)&&_0x45c7ce[_0x43d5c7(0x8f0)][_0x43d5c7(0x43a)]()&&_0x220644[_0x43d5c7(0xff)][_0x43d5c7(0x13ee)](_0x28139a(_0x45c7ce['commentText'],null,_0x45c7ce[_0x43d5c7(0xe51)]||null));}await _0x4e1bbf['qzonePosts'][_0x43d5c7(0x32e)](_0x220644['id'],{'comments':_0x220644[_0x43d5c7(0xff)]}),_0x1baa80(_0x511de0+0x1),console['log'](_0x43d5c7(0x7b0)+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0x678)+_0x45c7ce[_0x43d5c7(0x6c2)]);if(!_0x19426e['commentCooldowns'])_0x19426e[_0x43d5c7(0xc5c)]={};_0x19426e['commentCooldowns'][_0x45c7ce['postId']]=Date[_0x43d5c7(0x2b5)]();}continue;}case'video_call_request':!_0x42b67f['isActive']&&!_0x42b67f[_0x43d5c7(0x7f0)]&&(_0x42b67f[_0x43d5c7(0x7f0)]=!![],_0x42b67f[_0x43d5c7(0x777)]=_0x38cc5c,_0x42b67f[_0x43d5c7(0xeee)]=![],_0x42b67f[_0x43d5c7(0xbd9)]=_0x19426e['name'],_0x30a8ff());break;default:console['warn'](_0x43d5c7(0x13a2)+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0x2dd),_0x45c7ce[_0x43d5c7(0xafc)]);break;case _0x43d5c7(0x49e):{const _0x5a96d4=_0x45c7ce[_0x43d5c7(0x6fc)],_0x2590e2=_0x19426e[_0x43d5c7(0xcb3)][_0x43d5c7(0x1163)][_0x43d5c7(0x137)](_0x5d7473=>_0x5d7473[_0x43d5c7(0x6fc)]===_0x5a96d4);_0x2590e2&&(_0x19426e[_0x43d5c7(0xcb3)]['aiAvatar']=_0x2590e2[_0x43d5c7(0xe52)],await _0x303d26(_0x19426e),visibleSystemMessage={'content':'['+_0x19426e['name']+'\x20更换了头像]'},console['log'](_0x43d5c7(0x7b0)+_0x19426e[_0x43d5c7(0x6fc)]+_0x43d5c7(0x9a7)));break;}}if(_0x281fd1){_0x19426e[_0x43d5c7(0x830)][_0x43d5c7(0x13ee)](_0x281fd1),_0x19426e[_0x43d5c7(0x13c0)]=(_0x19426e[_0x43d5c7(0x13c0)]||0x0)+0x1;if(!_0x15e7a4){let _0x396ac5=_0x281fd1[_0x43d5c7(0xafc)]===_0x43d5c7(0x118)?_0x43d5c7(0x26a):_0x281fd1[_0x43d5c7(0x3ba)]||'';_0x1c47b3(_0x38cc5c,_0x396ac5),_0x15e7a4=!![];}}}await _0x4e1bbf[_0x43d5c7(0x999)][_0x43d5c7(0x4fa)](_0x19426e);}catch(_0x490339){console[_0x43d5c7(0xc60)](_0x43d5c7(0x13a2)+_0x19426e[_0x43d5c7(0x6fc)]+'\x22\x20的独立行动失败:',_0x490339);}finally{_0x570655(_0x38cc5c,![]),_0x21f6ea(),document[_0x43d5c7(0x64f)](_0x43d5c7(0x3dd))[_0x43d5c7(0x418)][_0x43d5c7(0xef6)](_0x43d5c7(0x12ef))&&_0x40e6dd();}}async function _0x13c1fa(_0x5dea80){const _0x24c597=_0x5a7792,_0x1dec9e=_0x3e7a1b[_0x24c597(0x999)][_0x5dea80];if(!_0x1dec9e||!_0x1dec9e[_0x24c597(0x1167)])return;const _0x41662f=_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0x963)]||0xa;if(_0x1dec9e[_0x24c597(0x11ea)]){const _0x5b11bd=(Date[_0x24c597(0x2b5)]()-_0x1dec9e[_0x24c597(0x11ea)])/(0x3e8*0x3c);if(_0x5b11bd<_0x41662f){console[_0x24c597(0x1081)](_0x24c597(0x12a8)+_0x1dec9e[_0x24c597(0x6fc)]+_0x24c597(0x1271));return;}}const {proxyUrl:_0x4fb604,apiKey:_0xb0fde6,model:_0x2928d6}=_0x3e7a1b[_0x24c597(0xec0)];if(!_0x4fb604||!_0xb0fde6||!_0x2928d6)return;const _0x504171=_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0x96f)]||'我',_0x3d8c52=new Date();let _0x209ad2;const _0x51657d=_0x1dec9e[_0x24c597(0x830)][_0x24c597(0x156)](_0x298fe3=>!_0x298fe3['isHidden'])[_0x24c597(0xdf5)](-0x5),_0x42a068=_0x51657d[_0x24c597(0x137)](_0x3fe540=>_0x3fe540[_0x24c597(0xafc)]===_0x24c597(0xa5d)&&!_0x3fe540[_0x24c597(0xa62)]);if(_0x42a068){const _0xdd50af=_0x1409fb(_0x1dec9e,_0x42a068['senderName']);console['log'](_0x24c597(0x423)+_0x1dec9e[_0x24c597(0x6fc)]+'\x22\x20中有未领完的红包，正在生成抢红包指令...'),_0x209ad2=_0x24c597(0x10bf)+_0xdd50af+_0x24c597(0xc20)+_0x42a068[_0x24c597(0x8af)]+'）。\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的任务是：选择【一个或多个】符合人设的角色，让他们【立刻】使用\x20\x27open_red_packet\x27\x20指令去尝试领取这个红包。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20指令格式\x0a\x20\x20\x20\x20\x20\x20\x20\x20你的回复【必须】是一个JSON数组，格式如下：\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x27[{\x22type\x22:\x20\x22open_red_packet\x22,\x20\x22name\x22:\x20\x22角色本名\x22,\x20\x22packet_timestamp\x22:\x20'+_0x42a068['timestamp']+_0x24c597(0x135b);}else{let _0x310de5='';const _0x4be7e8=_0x1dec9e[_0x24c597(0xcb3)]['timeZone']||_0x24c597(0xe77),_0x529b08=_0x3d8c52[_0x24c597(0x2b4)](_0x24c597(0x6ec),{'timeZone':_0x4be7e8,'dateStyle':_0x24c597(0xfd),'timeStyle':_0x24c597(0xf1)}),_0x351df0=new Date(_0x3d8c52['toLocaleString'](_0x24c597(0xa63),{'timeZone':_0x4be7e8}));if(_0x1dec9e['settings']['enableTimePerception']){const _0x1277df=_0x1dec9e[_0x24c597(0x830)][_0x24c597(0x156)](_0x3b8f40=>!_0x3b8f40['isHidden'])[_0x24c597(0xdf5)](-0x1)[0x0];if(_0x1277df){const _0x3bef71=new Date(_0x1277df[_0x24c597(0x8af)]),_0x337cd5=(_0x3d8c52-_0x3bef71)/(0x3e8*0x3c);_0x337cd5>0x3c?_0x310de5=_0x24c597(0xc2d)+Math['round'](_0x337cd5/0x3c)+_0x24c597(0x5de):_0x310de5=_0x24c597(0x134b)+Math[_0x24c597(0x1245)](_0x337cd5)+_0x24c597(0xb97);}else _0x310de5=_0x24c597(0x13ab);}let _0x17e859='你们最近没有有效聊天记录。';const _0x3e6c10=_0x1dec9e['settings'][_0x24c597(0xd50)]||0xa,_0x40c755=_0x1dec9e[_0x24c597(0x830)][_0x24c597(0x156)](_0x36b7a2=>!_0x36b7a2[_0x24c597(0x5cc)])['slice'](-_0x3e6c10);_0x40c755[_0x24c597(0x40f)]>0x0&&(_0x17e859='这是你们最近的对话：\x0a'+_0x40c755['map'](_0x2df4d3=>{const _0x3da90d=_0x24c597,_0x4a2918=_0x2df4d3[_0x3da90d(0x931)]==='user'?_0x504171:_0x1409fb(_0x1dec9e,_0x2df4d3[_0x3da90d(0x133d)]),_0x511324=String(_0x2df4d3[_0x3da90d(0x3ba)]||_0x2df4d3[_0x3da90d(0x854)]||'')['substring'](0x0,0x32);return _0x4a2918+':\x20'+_0x511324+_0x3da90d(0x3cd);})['join']('\x0a'));const _0x1fe700=_0x1dec9e['members'][_0x24c597(0xb96)](_0x6bc8e8=>_0x24c597(0x8d8)+_0x6bc8e8['groupNickname']+_0x24c597(0x19a)+_0x6bc8e8[_0x24c597(0x7de)]+_0x24c597(0xc1c)+_0x6bc8e8['persona'])[_0x24c597(0xd22)]('\x0a');let _0x2ee1b9='#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a',_0x33e264=![];_0x1dec9e[_0x24c597(0x5d4)]['forEach'](_0x53e876=>{const _0x9bf105=_0x24c597,_0x21b796=_0x3e7a1b[_0x9bf105(0x999)][_0x53e876['id']];_0x21b796&&_0x21b796[_0x9bf105(0x518)]&&_0x21b796['longTermMemory']['length']>0x0&&(_0x2ee1b9+=_0x9bf105(0xf23)+_0x53e876[_0x9bf105(0x287)]+_0x9bf105(0x7c7),_0x2ee1b9+=_0x21b796[_0x9bf105(0x518)][_0x9bf105(0xb96)](_0xc372ed=>'-\x20'+_0xc372ed[_0x9bf105(0x3ba)])[_0x9bf105(0xd22)]('\x0a'),_0x33e264=!![]);});!_0x33e264&&(_0x2ee1b9+='-\x20(暂无)');let _0xdc154d='';if(_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0xde4)]&&_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0xde4)][_0x24c597(0x40f)]>0x0){const _0x504feb=_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0xde4)][_0x24c597(0xb96)](_0x5f1996=>{const _0x39fa19=_0x24c597,_0x276de5=_0x3e7a1b[_0x39fa19(0x144)]['find'](_0x4f3cb0=>_0x4f3cb0['id']===_0x5f1996);if(!_0x276de5||!Array[_0x39fa19(0x97e)](_0x276de5[_0x39fa19(0x3ba)]))return'';const _0x3fb6a3=_0x276de5[_0x39fa19(0x3ba)][_0x39fa19(0x156)](_0x1f236e=>_0x1f236e[_0x39fa19(0x9b)]!==![])[_0x39fa19(0xb96)](_0x4926a4=>{const _0x350591=_0x39fa19;let _0x436481='\x0a###\x20条目:\x20'+(_0x4926a4['comment']||_0x350591(0x497))+'\x0a';return _0x4926a4[_0x350591(0xc30)][_0x350591(0x40f)]>0x0&&(_0x436481+='**关键词:**\x20'+_0x4926a4['keys'][_0x350591(0xd22)](',\x20')+'\x0a'),_0x436481+=_0x350591(0x188)+_0x4926a4['content'],_0x436481;})[_0x39fa19(0xd22)]('');return _0x3fb6a3?_0x39fa19(0x228)+_0x276de5[_0x39fa19(0x6fc)]+'\x0a'+_0x3fb6a3:'';})[_0x24c597(0x156)](Boolean)['join']('');_0x504feb&&(_0xdc154d=_0x24c597(0x13cc)+_0x504feb+_0x24c597(0xf0f));}let _0x5be5e2='';const _0x3ab492=_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0x86d)]||0xa;if(_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0x4d8)]&&_0x1dec9e['settings'][_0x24c597(0x4d8)][_0x24c597(0x40f)]>0x0){const _0x1f0c29=_0x1dec9e[_0x24c597(0xcb3)]['linkedMemoryChatIds'][_0x24c597(0xb96)](_0x38cbee=>{const _0x5d1498=_0x24c597,_0x21088f=_0x3e7a1b[_0x5d1498(0x999)][_0x38cbee];if(!_0x21088f)return null;const _0x4c3dfa=_0x21088f[_0x5d1498(0x830)]['slice'](-0x1)[0x0];return{'chat':_0x21088f,'latestTimestamp':_0x4c3dfa?_0x4c3dfa[_0x5d1498(0x8af)]:0x0};})[_0x24c597(0x156)](Boolean);_0x1f0c29['sort']((_0x36665d,_0x5723be)=>_0x5723be['latestTimestamp']-_0x36665d['latestTimestamp']),_0x5be5e2+='\x0a\x0a#\x20参考记忆\x20(至关重要！群内角色必须【主动】将这些参考记忆中的【关键信息和事件】，自然地融入到当前的对话中，以体现你们拥有完整的共同记忆。)\x0a';for(const _0x58bf4c of _0x1f0c29){const _0x36b3fb=_0x58bf4c[_0x24c597(0xc09)],_0x464700=_0x36b3fb[_0x24c597(0x1167)]?_0x24c597(0x743):_0x24c597(0x1093),_0x310c37=_0x58bf4c['latestTimestamp']>0x0?_0x24c597(0x8ce)+_0x4942eb(_0x58bf4c[_0x24c597(0x5aa)])+')':'';_0x5be5e2+=_0x24c597(0x149)+_0x464700+'“'+_0x36b3fb[_0x24c597(0x6fc)]+_0x24c597(0x838)+_0x310c37+_0x24c597(0xa89);const _0x34a90b=_0x36b3fb[_0x24c597(0x830)][_0x24c597(0xdf5)](-_0x3ab492),_0x5e7fe6=_0x34a90b['filter'](_0x2235e1=>!String(_0x2235e1['content'])[_0x24c597(0xe53)](_0x24c597(0xce2)));_0x5e7fe6[_0x24c597(0x40f)]>0x0?_0x5e7fe6[_0x24c597(0x103)](_0x3d2714=>{const _0xb74408=_0x24c597,_0x3c0df4=_0x3d2714[_0xb74408(0x931)]==='user'?_0x36b3fb[_0xb74408(0xcb3)]['myNickname']||'我':_0x3d2714[_0xb74408(0x133d)]||_0x36b3fb['name'];let _0xd706c2=String(_0x3d2714[_0xb74408(0x3ba)]);if(_0x3d2714['type']===_0xb74408(0x118)||_0x3d2714['type']===_0xb74408(0xb11))_0xd706c2=_0xb74408(0x6e4)+_0x3d2714[_0xb74408(0x3ba)]+']';else _0x3d2714[_0xb74408(0xafc)]===_0xb74408(0xe76)&&(_0xd706c2=_0xb74408(0x1174)+_0x3d2714['content']+']');_0x5be5e2+=_0x3c0df4+':\x20'+_0xd706c2+'\x0a';}):_0x5be5e2+='(暂无有效聊天记录)\x0a';}}const _0x3afa1d=await _0x4e1bbf['qzonePosts'][_0x24c597(0xe1d)]('timestamp')[_0x24c597(0x2f4)]()[_0x24c597(0xb2e)](0x5)[_0x24c597(0x78f)]();let _0x5acaa1='';const _0x22c414=new Set();for(const _0xb69289 of _0x1dec9e['members']){const _0x4fd249=_0x3e7a1b[_0x24c597(0x999)][_0xb69289['id']];if(_0x4fd249){const _0x507ccf=_0x4e4575(_0x3afa1d,_0x4fd249);_0x507ccf['forEach'](_0x28f4ed=>_0x22c414[_0x24c597(0xdda)](_0x28f4ed));}}const _0x4b7b2e=new Set(_0x1dec9e[_0x24c597(0x5d4)][_0x24c597(0xb96)](_0x14cfdf=>_0x14cfdf[_0x24c597(0x7de)])),_0x97bd34=[..._0x22c414]['filter'](_0x37fac8=>{const _0x113cbd=_0x24c597,_0xe17560=_0x37fac8[_0x113cbd(0x940)]&&_0x37fac8[_0x113cbd(0x940)][_0x113cbd(0x26c)](_0x3b2f74=>_0x4b7b2e[_0x113cbd(0x2a6)](_0x3b2f74)),_0x11476c=_0x37fac8[_0x113cbd(0xff)]&&_0x37fac8[_0x113cbd(0xff)]['some'](_0x2e705d=>typeof _0x2e705d===_0x113cbd(0x59a)&&_0x4b7b2e['has'](_0x2e705d['commenterName']));return!_0xe17560&&!_0x11476c;});if(_0x97bd34[_0x24c597(0x40f)]>0x0){let _0x15a066=_0x24c597(0xff6);for(const _0x1726d6 of _0x97bd34){let _0x2dfc9e=_0x1726d6[_0x24c597(0x1188)]==='user'?_0x504171:_0x3e7a1b[_0x24c597(0x999)][_0x1726d6[_0x24c597(0x1188)]]?.[_0x24c597(0x6fc)]||_0x24c597(0x99f),_0x170d64;if(_0x1726d6[_0x24c597(0xafc)]===_0x24c597(0xe5a)){const _0x98578f=_0x1726d6[_0x24c597(0xa19)]?_0x24c597(0x717)+_0x1726d6[_0x24c597(0xa19)]+'”':'';let _0x14422c=_0x24c597(0xefd);const _0x297008=_0x1726d6[_0x24c597(0x32f)][_0x24c597(0x1188)];if(_0x297008===_0x24c597(0xa4d))_0x14422c=_0x3e7a1b[_0x24c597(0x3c2)][_0x24c597(0x78c)];else _0x3e7a1b[_0x24c597(0x999)][_0x297008]&&(_0x14422c=_0x3e7a1b[_0x24c597(0x999)][_0x297008][_0x24c597(0x6fc)]);let _0x4aa210;const _0x2c9567=_0x1726d6['originalPost'];if(_0x2c9567[_0x24c597(0xafc)]===_0x24c597(0x351))_0x4aa210=_0x24c597(0x640)+(_0x2c9567[_0x24c597(0x66e)]||'')+_0x24c597(0x1365)+(_0x2c9567[_0x24c597(0x1150)]||'')['substring'](0x0,0x28)+_0x24c597(0xc32);else _0x2c9567[_0x24c597(0xafc)]===_0x24c597(0x3d9)?_0x4aa210=_0x24c597(0x8d0)+(_0x2c9567[_0x24c597(0x66e)]||'')+_0x24c597(0x1365)+(_0x2c9567[_0x24c597(0x911)]||'')[_0x24c597(0x126f)](0x0,0x28)+_0x24c597(0xc32):_0x4aa210='“'+(_0x2c9567['content']||'')['substring'](0x0,0x28)+_0x24c597(0xcbf);_0x170d64=_0x24c597(0xe1a)+_0x14422c+'\x20的动态\x20'+_0x98578f+_0x24c597(0xb4c)+_0x4aa210+'】';}else{if(_0x1726d6['type']===_0x24c597(0x351))_0x170d64=('[一张图片，其隐藏文字为：“'+_0x1726d6[_0x24c597(0x1150)]+_0x24c597(0x13a)+(_0x1726d6[_0x24c597(0x66e)]||''))[_0x24c597(0x126f)](0x0,0x32)+_0x24c597(0x3cd);else _0x1726d6[_0x24c597(0xafc)]===_0x24c597(0x3d9)?_0x170d64=(_0x24c597(0x5ac)+_0x1726d6[_0x24c597(0x911)]+'”]\x20'+(_0x1726d6['publicText']||''))[_0x24c597(0x126f)](0x0,0x32)+_0x24c597(0x3cd):_0x170d64=String(_0x1726d6[_0x24c597(0x66e)]||_0x1726d6['content']||_0x24c597(0xb50))[_0x24c597(0x126f)](0x0,0x32)+_0x24c597(0x3cd);}_0x15a066+=_0x24c597(0x469)+_0x1726d6['id']+_0x24c597(0x104d)+_0x2dfc9e+',\x20内容:\x20\x22'+_0x170d64+'\x22\x0a';if(_0x1726d6[_0x24c597(0xff)]&&_0x1726d6[_0x24c597(0xff)][_0x24c597(0x40f)]>0x0)for(const _0x52b2d3 of _0x1726d6[_0x24c597(0xff)]){if(typeof _0x52b2d3==='object'&&_0x52b2d3[_0x24c597(0x1335)]){const _0x7092bd=_0x5784e3(_0x52b2d3[_0x24c597(0x1335)]);let _0x49a2f5=_0x52b2d3[_0x24c597(0x10b3)]?'[表情:\x20\x27'+_0x52b2d3[_0x24c597(0x10b3)]+'\x27]':_0x52b2d3[_0x24c597(0x673)];_0x15a066+='\x20\x20-\x20评论:\x20'+_0x7092bd+_0x24c597(0xbfe)+_0x52b2d3[_0x24c597(0x1335)]+_0x24c597(0xc1c)+_0x49a2f5+'\x0a';}}}_0x5acaa1=_0x15a066;}const _0x465be6=_0x5871dc(_0x1dec9e,0x3,_0x24c597(0x4b6)),_0xf19a1d=_0x5871dc(_0x1dec9e,0x6,_0x24c597(0x4b6)),_0x548874=_0x5871dc(_0x1dec9e,0x9,'hours'),_0x44dc78=_0x5871dc(_0x1dec9e,0x1,_0x24c597(0x82a)),_0x342a1c=_0x5871dc(_0x1dec9e,0x3,'days'),_0x1c218b=_0x5871dc(_0x1dec9e,0x7,'days');let _0x3e43d5='';if(_0x465be6||_0xf19a1d||_0x548874||_0x44dc78||_0x342a1c||_0x1c218b){_0x3e43d5+=_0x24c597(0xbe9);if(_0x465be6)_0x3e43d5+=_0x465be6;if(_0xf19a1d)_0x3e43d5+=_0xf19a1d;if(_0x548874)_0x3e43d5+=_0x548874;if(_0x465be6||_0xf19a1d||_0x548874)_0x3e43d5+='\x0a';if(_0x44dc78)_0x3e43d5+=_0x44dc78;if(_0x342a1c)_0x3e43d5+=_0x342a1c;if(_0x1c218b)_0x3e43d5+=_0x1c218b;}const _0x4647b5=_0x2beb71(_0x1dec9e);_0x209ad2=_0x24c597(0x5bf)+_0x1dec9e[_0x24c597(0x6fc)]+_0x24c597(0xac5)+(_0x1dec9e['settings'][_0x24c597(0x35f)]?_0x24c597(0x1376)+_0x529b08+'。':'')+_0x24c597(0xeb3)+(_0x310de5?_0x310de5+'\x20':'')+_0x24c597(0xa3f)+_0x2ee1b9+_0x24c597(0x13de)+_0x504171+_0x24c597(0x113)+_0x1dec9e[_0x24c597(0x6fc)]+_0x24c597(0xeb3)+_0xdc154d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20长期记忆\x20(最高优先级，这是群内已经确立的事实，所有角色必须严格遵守)\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x1dec9e[_0x24c597(0x518)]&&_0x1dec9e[_0x24c597(0x518)][_0x24c597(0x40f)]>0x0?_0x1dec9e[_0x24c597(0x518)][_0x24c597(0xb96)](_0x4bf437=>'-\x20'+_0x4bf437[_0x24c597(0x3ba)])[_0x24c597(0xd22)]('\x0a'):'-\x20(暂无)')+_0x24c597(0x929)+_0x3e43d5+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x5be5e2+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20群成员列表及人设\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x1fe700+_0x24c597(0xfa4)+_0x4647b5+_0x24c597(0x1e1)+_0x504171+_0x24c597(0x12ea)+_0x1dec9e[_0x24c597(0xcb3)][_0x24c597(0x1047)]+_0x24c597(0x9f0)+_0x17e859+_0x24c597(0xd38)+_0x5acaa1+_0x24c597(0x1300);}const _0x13391a=_0x1dec9e[_0x24c597(0x830)][_0x24c597(0x156)](_0x30ecf2=>!_0x30ecf2[_0x24c597(0x5cc)])[_0x24c597(0xdf5)](-0xa),_0x49f77a=[{'role':'system','content':_0x209ad2},..._0x13391a[_0x24c597(0xb96)](_0xc607c3=>{const _0x1ff3f7=_0x24c597,_0x2eb664=_0xc607c3[_0x1ff3f7(0x931)]===_0x1ff3f7(0xa4d)?_0x504171:_0x1409fb(_0x1dec9e,_0xc607c3[_0x1ff3f7(0x133d)]);let _0x4919db=_0xc607c3[_0x1ff3f7(0x3ba)];if(_0xc607c3['type']==='ai_image'||_0xc607c3[_0x1ff3f7(0xafc)]===_0x1ff3f7(0xb11))_0x4919db=_0x1ff3f7(0x11c9)+_0xc607c3[_0x1ff3f7(0x3ba)]+'\x27]';else{if(_0xc607c3[_0x1ff3f7(0xafc)]===_0x1ff3f7(0xe76))_0x4919db=_0x1ff3f7(0x4ad)+_0xc607c3['content']+'\x27]';else typeof _0x4919db!=='string'&&(_0x4919db=_0x1ff3f7(0xd7));}return{'role':_0x1ff3f7(0xa4d),'content':_0x2eb664+':\x20'+_0x4919db};})];try{const _0xa68b88=[{'role':_0x24c597(0xa4d),'content':_0x209ad2}];let _0x2e9bc3=_0x4fb604===GEMINI_API_URL,_0x594e80=_0x250668(_0x2928d6,_0xb0fde6,_0x209ad2,_0xa68b88);const _0x50f998=_0x2e9bc3?await fetch(_0x594e80['url'],_0x594e80[_0x24c597(0x88a)]):await fetch(_0x4fb604+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x24c597(0x7fe),'Authorization':_0x24c597(0x236)+_0xb0fde6},'body':JSON[_0x24c597(0xe3f)]({'model':_0x2928d6,'messages':_0xa68b88,'temperature':_0x3e7a1b[_0x24c597(0x11b4)]['apiTemperature']||0.9})});if(!_0x50f998['ok'])throw new Error((await _0x50f998[_0x24c597(0x6f8)]())[_0x24c597(0xc60)]['message']);const _0x50fb62=await _0x50f998[_0x24c597(0x6f8)](),_0x27dbf0=_0x2e9bc3?_0x50fb62[_0x24c597(0xfd3)][0x0][_0x24c597(0x3ba)][_0x24c597(0x100d)][0x0][_0x24c597(0x673)]:_0x50fb62['choices'][0x0][_0x24c597(0x854)][_0x24c597(0x3ba)],_0x377a7b=_0x3755ce(_0x27dbf0);if(!_0x377a7b||_0x377a7b['length']===0x0){console['warn'](_0x24c597(0x12a8)+_0x1dec9e[_0x24c597(0x6fc)]+_0x24c597(0x1168));return;}let _0x471914=Date['now'](),_0xf21cb2=![],_0xba9c91='',_0x45b24d='';const _0xdc3276=[];for(const _0x151ffb of _0x377a7b){const _0x264548=String(_0x151ffb['content']||''),_0x4ab5e6=_0x264548[_0x24c597(0x43a)]()[_0x24c597(0x7d)]('<')&&_0x264548[_0x24c597(0x43a)]()[_0x24c597(0x720)]('>');if(_0x151ffb[_0x24c597(0xafc)]===_0x24c597(0x673)&&!_0x4ab5e6&&_0x264548[_0x24c597(0xe53)]('\x0a')){const _0x3ae07d=_0x264548['split'](/\n+/)[_0x24c597(0x156)](_0x1b3da1=>_0x1b3da1[_0x24c597(0x43a)]());_0x3ae07d[_0x24c597(0x103)](_0x5abf47=>{const _0x3ed80a=_0x24c597;_0xdc3276[_0x3ed80a(0x13ee)]({..._0x151ffb,'content':_0x5abf47});});}else _0xdc3276[_0x24c597(0x13ee)](_0x151ffb);}for(const _0x49b9d1 of _0xdc3276){if(!_0x49b9d1||!_0x49b9d1[_0x24c597(0xafc)]||!_0x49b9d1[_0x24c597(0x6fc)])continue;const _0x869258=_0x1409fb(_0x1dec9e,_0x49b9d1['name']);let _0x109e33=null,_0x5e5973=null;const _0x1c8a7e={'role':_0x24c597(0x12c3),'senderName':_0x49b9d1['name'],'timestamp':_0x471914++};if(_0x49b9d1[_0x24c597(0xafc)]===_0x24c597(0x1045)){const _0x152356=_0x1dec9e['history'][_0x24c597(0x137)](_0x389d18=>_0x389d18[_0x24c597(0x8af)]===_0x49b9d1['packet_timestamp']);if(_0x152356&&!_0x152356[_0x24c597(0xa62)]&&!(_0x152356[_0x24c597(0x19f)]&&_0x152356[_0x24c597(0x19f)][_0x49b9d1[_0x24c597(0x6fc)]])){let _0x1d04df=0x0;const _0x4f4cca=_0x152356[_0x24c597(0xef)]-Object[_0x24c597(0xd6d)](_0x152356[_0x24c597(0x19f)]||{})[_0x24c597(0x213)]((_0x582412,_0x28af81)=>_0x582412+_0x28af81,0x0),_0x282a29=_0x152356[_0x24c597(0xe7c)]-Object[_0x24c597(0xc30)](_0x152356[_0x24c597(0x19f)]||{})[_0x24c597(0x40f)];if(_0x282a29>0x0){if(_0x282a29===0x1)_0x1d04df=_0x4f4cca;else{const _0x5afda9=0.01,_0x47f724=_0x4f4cca-(_0x282a29-0x1)*_0x5afda9;_0x1d04df=Math[_0x24c597(0x95f)]()*(_0x47f724-_0x5afda9)+_0x5afda9;}_0x1d04df=parseFloat(_0x1d04df[_0x24c597(0xc89)](0x2));if(!_0x152356[_0x24c597(0x19f)])_0x152356['claimedBy']={};_0x152356[_0x24c597(0x19f)][_0x49b9d1['name']]=_0x1d04df,_0x1dec9e[_0x24c597(0x830)]['push']({'role':_0x24c597(0x905),'type':_0x24c597(0xac1),'content':_0x869258+_0x24c597(0x933)+_0x1409fb(_0x1dec9e,_0x152356[_0x24c597(0x133d)])+_0x24c597(0x2b1),'timestamp':Date[_0x24c597(0x2b5)]()});let _0x1fcc19=_0x24c597(0x7dc)+_0x869258+_0x24c597(0x397)+_0x1d04df[_0x24c597(0xc89)](0x2)+_0x24c597(0x892);if(Object[_0x24c597(0xc30)](_0x152356[_0x24c597(0x19f)])['length']>=_0x152356[_0x24c597(0xe7c)]){_0x152356['isFullyClaimed']=!![],_0x1dec9e['history']['push']({'role':_0x24c597(0x905),'type':_0x24c597(0xac1),'content':_0x1409fb(_0x1dec9e,_0x152356[_0x24c597(0x133d)])+_0x24c597(0xcf4),'timestamp':Date['now']()+0x1});let _0x272713={'name':'','amount':-0x1};Object['entries'](_0x152356[_0x24c597(0x19f)])[_0x24c597(0x103)](([_0x403163,_0x4ec02b])=>{_0x4ec02b>_0x272713['amount']&&(_0x272713={'name':_0x403163,'amount':_0x4ec02b});});if(_0x272713['name']){const _0x26bce5=_0x1409fb(_0x1dec9e,_0x272713['name']);_0x1fcc19+=_0x24c597(0x1126)+_0x26bce5+'！';}}_0x1fcc19+='\x20请根据这个结果发表你的评论。]',_0x1dec9e[_0x24c597(0x830)][_0x24c597(0x13ee)]({'role':_0x24c597(0x905),'content':_0x1fcc19,'timestamp':Date[_0x24c597(0x2b5)]()+0x2,'isHidden':!![]});}}_0xf21cb2=!![];continue;}switch(_0x49b9d1[_0x24c597(0xafc)]){case _0x24c597(0xefb):if(_0x49b9d1[_0x24c597(0x10b3)]){const _0x146b6f=_0x3e7a1b[_0x24c597(0xa8b)]['find'](_0x1ca7a6=>_0x1ca7a6['name']===_0x49b9d1[_0x24c597(0x10b3)]);_0x146b6f?_0x5e5973={..._0x1c8a7e,'type':_0x24c597(0xefb),'content':_0x146b6f[_0x24c597(0xe52)],'meaning':_0x146b6f[_0x24c597(0x6fc)]}:(console[_0x24c597(0x1155)]('AI\x20(群聊后台)\x20尝试使用一个不存在的表情:\x20\x22'+_0x49b9d1[_0x24c597(0x10b3)]+'\x22'),_0x5e5973={..._0x1c8a7e,'type':_0x24c597(0x673),'content':_0x24c597(0x7af)+_0x49b9d1[_0x24c597(0x10b3)]+']'});}else console[_0x24c597(0x1155)](_0x24c597(0xe59),_0x49b9d1),_0x5e5973={..._0x1c8a7e,'type':_0x24c597(0xefb),'content':_0x49b9d1['url'],'meaning':_0x24c597(0x7ef)};break;case'qzone_post':const _0x23b142={'type':_0x49b9d1[_0x24c597(0x12c9)]||_0x24c597(0x103d),'content':_0x49b9d1[_0x24c597(0x3ba)],'timestamp':Date[_0x24c597(0x2b5)](),'authorId':_0x3e7a1b[_0x24c597(0x999)][Object[_0x24c597(0xc30)](_0x3e7a1b['chats'])['find'](_0x4bb63f=>_0x3e7a1b[_0x24c597(0x999)][_0x4bb63f]['originalName']===_0x49b9d1[_0x24c597(0x6fc)])]?.['id']||_0x49b9d1[_0x24c597(0x6fc)],'authorOriginalName':_0x49b9d1[_0x24c597(0x6fc)],'visibleGroupIds':null};await _0x4e1bbf[_0x24c597(0xaf9)][_0x24c597(0xdda)](_0x23b142),_0x1baa80(_0x511de0+0x1),_0x109e33={'content':'['+_0x869258+_0x24c597(0xe13)};break;case'qzone_comment':const _0x245161=await _0x4e1bbf[_0x24c597(0xaf9)][_0x24c597(0x11fc)](parseInt(_0x49b9d1[_0x24c597(0x6c2)]));if(_0x245161){if(!_0x245161[_0x24c597(0xff)])_0x245161[_0x24c597(0xff)]=[];_0x245161[_0x24c597(0xff)][_0x24c597(0x13ee)]({'commenterName':_0x49b9d1[_0x24c597(0x6fc)],'text':_0x49b9d1[_0x24c597(0x8f0)],'timestamp':Date[_0x24c597(0x2b5)]()}),await _0x4e1bbf['qzonePosts']['update'](_0x245161['id'],{'comments':_0x245161['comments']}),_0x1baa80(_0x511de0+0x1),_0x109e33={'content':'['+_0x869258+_0x24c597(0x689)};}break;case _0x24c597(0xc3c):const _0x56aac0=await _0x4e1bbf[_0x24c597(0xaf9)][_0x24c597(0x11fc)](parseInt(_0x49b9d1['postId']));if(_0x56aac0){if(!_0x56aac0['likes'])_0x56aac0[_0x24c597(0x940)]=[];!_0x56aac0[_0x24c597(0x940)][_0x24c597(0xe53)](_0x49b9d1['name'])&&(_0x56aac0[_0x24c597(0x940)][_0x24c597(0x13ee)](_0x49b9d1['name']),await _0x4e1bbf[_0x24c597(0xaf9)]['update'](_0x56aac0['id'],{'likes':_0x56aac0['likes']}),_0x1baa80(_0x511de0+0x1),_0x109e33={'content':'['+_0x869258+_0x24c597(0xd4b)});}break;case _0x24c597(0x118):_0x5e5973={..._0x1c8a7e,'type':_0x24c597(0x118),'content':_0x49b9d1[_0x24c597(0x9af)],'image_prompt':msgData[_0x24c597(0x242)]};break;default:if(_0x49b9d1[_0x24c597(0xafc)]===_0x24c597(0xcde)){const _0x1d3a37=typeof _0x49b9d1[_0x24c597(0x590)]===_0x24c597(0x1251)?_0x49b9d1[_0x24c597(0x590)]['split']('\x0a')['filter'](_0x5ac047=>_0x5ac047[_0x24c597(0x43a)]()):Array[_0x24c597(0x97e)](_0x49b9d1[_0x24c597(0x590)])?_0x49b9d1['options']:[];if(_0x1d3a37[_0x24c597(0x40f)]<0x2)continue;_0x5e5973={..._0x1c8a7e,..._0x49b9d1,'options':_0x1d3a37,'votes':{},'isClosed':![]};}else{const _0x40cc22=_0x49b9d1[_0x24c597(0x3ba)]||_0x49b9d1[_0x24c597(0x854)];_0x5e5973={..._0x1c8a7e,..._0x49b9d1};if(_0x40cc22)_0x5e5973['content']=_0x40cc22;}break;}if(_0x109e33)_0x1dec9e['history']['push']({'role':'system','type':_0x24c597(0xac1),'content':_0x109e33[_0x24c597(0x3ba)],'timestamp':_0x471914++});else _0x5e5973&&(_0x1dec9e[_0x24c597(0x830)]['push'](_0x5e5973),!_0x45b24d&&(_0x45b24d=_0x869258,_0xba9c91=_0x5e5973['type']==='ai_image'?_0x24c597(0x26a):_0x5e5973[_0x24c597(0x3ba)]||'['+_0x5e5973[_0x24c597(0xafc)]+']'));_0xf21cb2=!![];}_0xf21cb2&&(_0x1dec9e[_0x24c597(0x11ea)]=Date[_0x24c597(0x2b5)](),_0x1dec9e['unreadCount']=(_0x1dec9e['unreadCount']||0x0)+_0x377a7b[_0x24c597(0x156)](_0x4be680=>_0x4be680[_0x24c597(0xafc)]!==_0x24c597(0x5e8)&&_0x4be680['type']!==_0x24c597(0xbf2)&&_0x4be680[_0x24c597(0xafc)]!==_0x24c597(0xc3c))[_0x24c597(0x40f)],_0x45b24d&&_0xba9c91&&_0x1c47b3(_0x5dea80,_0x45b24d+':\x20'+_0xba9c91),await _0x4e1bbf[_0x24c597(0x999)][_0x24c597(0x4fa)](_0x1dec9e));}catch(_0x5e8de9){console[_0x24c597(0xc60)]('群聊\x20\x22'+_0x1dec9e[_0x24c597(0x6fc)]+_0x24c597(0x1138),_0x5e8de9);}finally{_0x21f6ea();}}function _0x1f54e5(_0x307778,_0x3406a0,_0x19b952){const _0xee5364=_0x5a7792,_0xcff462=document[_0xee5364(0x64f)](_0x19b952);if(!_0xcff462)return;if(!_0x307778||_0x307778['trim']()===''){_0xcff462[_0xee5364(0xc58)]='';return;}const _0x19fc7f=_0x307778[_0xee5364(0x137f)](/\s*\.message-bubble\.user\s+([^{]+\{)/g,_0x3406a0+'\x20.message-bubble.user\x20$1')['replace'](/\s*\.message-bubble\.ai\s+([^{]+\{)/g,_0x3406a0+'\x20.message-bubble.ai\x20$1')[_0xee5364(0x137f)](/\s*\.message-bubble\s+([^{]+\{)/g,_0x3406a0+'\x20.message-bubble\x20$1');_0xcff462[_0xee5364(0xc58)]=_0x19fc7f;}async function _0x29eae3(){const _0x4a33fd=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x29dad5=_0x3e7a1b['chats'][_0x3e7a1b['activeChatId']],_0x209a7e=document[_0x4a33fd(0x64f)](_0x4a33fd(0x466));if(!_0x209a7e)return;const _0xbbc034=document[_0x4a33fd(0x49c)]('input[name=\x22theme-select\x22]:checked')?.[_0x4a33fd(0xbed)]||_0x4a33fd(0xf5d),_0x885301=document[_0x4a33fd(0x64f)](_0x4a33fd(0x4d1))[_0x4a33fd(0xbed)],_0x68269c=document['getElementById'](_0x4a33fd(0x13a0))['value'],_0x80c7da=_0x29dad5['settings']['background'];_0x209a7e[_0x4a33fd(0x12e1)][_0x4a33fd(0xb3d)]=_0xbbc034,_0x209a7e[_0x4a33fd(0x731)][_0x4a33fd(0xee2)]('--chat-font-size',_0x885301+'px');_0x80c7da&&_0x80c7da['startsWith']('data:image')?(_0x209a7e[_0x4a33fd(0x731)][_0x4a33fd(0x4d6)]=_0x4a33fd(0xec1)+_0x80c7da+')',_0x209a7e[_0x4a33fd(0x731)]['backgroundColor']=_0x4a33fd(0xb2a)):(_0x209a7e[_0x4a33fd(0x731)][_0x4a33fd(0x4d6)]='none',_0x209a7e[_0x4a33fd(0x731)][_0x4a33fd(0xc8b)]=_0x80c7da||'#f0f2f5');_0x209a7e[_0x4a33fd(0xc58)]='';const _0x40b460={'role':'ai','content':_0x4a33fd(0xa8e),'timestamp':0x1,'senderName':_0x29dad5[_0x4a33fd(0x6fc)]},_0x3aa654=await _0x3209f4(_0x40b460,_0x29dad5);if(_0x3aa654)_0x209a7e['appendChild'](_0x3aa654);const _0x257b74={'role':_0x4a33fd(0xa4d),'content':_0x4a33fd(0x84),'timestamp':0x2},_0x212d3e=await _0x3209f4(_0x257b74,_0x29dad5);if(_0x212d3e)_0x209a7e['appendChild'](_0x212d3e);const _0x2b0c56=document[_0x4a33fd(0x124e)](_0x4a33fd(0x479));_0x2b0c56['style']['cssText']=_0x4a33fd(0x10ce),_0x2b0c56[_0x4a33fd(0xee5)]=_0x4a33fd(0x446),_0x209a7e[_0x4a33fd(0x99e)](_0x2b0c56);const _0x351d86=document[_0x4a33fd(0x64f)]('lyrics-vertical-pos')['value'],_0x12cefa=document['getElementById'](_0x4a33fd(0x92c))[_0x4a33fd(0xbed)],_0x4c7be8=parseInt(document[_0x4a33fd(0x64f)]('lyrics-offset-input')[_0x4a33fd(0xbed)])||0xa;_0x351d86==='top'?_0x2b0c56[_0x4a33fd(0x731)][_0x4a33fd(0x4ed)]=_0x4c7be8+'px':_0x2b0c56[_0x4a33fd(0x731)][_0x4a33fd(0x8da)]=_0x4c7be8+'px';switch(_0x12cefa){case _0x4a33fd(0xbbf):_0x2b0c56[_0x4a33fd(0x731)]['left']=_0x4a33fd(0xebe);break;case'right':_0x2b0c56[_0x4a33fd(0x731)]['right']=_0x4a33fd(0xebe);break;default:_0x2b0c56[_0x4a33fd(0x731)][_0x4a33fd(0xbbf)]=_0x4a33fd(0x111c),_0x2b0c56[_0x4a33fd(0x731)]['transform']=_0x4a33fd(0xc00);break;}_0x1f54e5(_0x68269c,_0x4a33fd(0x12dc),_0x4a33fd(0xa64));}async function _0x211af4(){const _0x3ad300=_0x5a7792;await _0x43aa5e(),document[_0x3ad300(0x64f)](_0x3ad300(0x6e5))['classList'][_0x3ad300(0xdda)]('visible');}async function _0x43aa5e(){const _0x33f5c2=_0x5a7792,_0x34a781=document[_0x33f5c2(0x64f)](_0x33f5c2(0x12a0)),_0x1006f9=await _0x4e1bbf['qzoneGroups']['toArray']();_0x34a781['innerHTML']='',_0x1006f9[_0x33f5c2(0x40f)]===0x0&&(_0x34a781[_0x33f5c2(0xc58)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分组</p>'),_0x1006f9[_0x33f5c2(0x103)](_0x20a0f0=>{const _0xeaedf5=_0x33f5c2,_0x29d0f2=document[_0xeaedf5(0x124e)](_0xeaedf5(0x479));_0x29d0f2['className']=_0xeaedf5(0x6c3),_0x29d0f2['innerHTML']=_0xeaedf5(0x112d)+_0x20a0f0[_0xeaedf5(0x6fc)]+_0xeaedf5(0x138d)+_0x20a0f0['id']+_0xeaedf5(0x9fd),_0x34a781[_0xeaedf5(0x99e)](_0x29d0f2);});}async function _0x279c58(){const _0x24c98a=_0x5a7792,_0x153e82=document[_0x24c98a(0x64f)]('new-group-name-input'),_0x9f47b=_0x153e82['value'][_0x24c98a(0x43a)]();if(!_0x9f47b){alert(_0x24c98a(0xb18));return;}const _0x1fada8=await _0x4e1bbf[_0x24c98a(0xc1a)][_0x24c98a(0xec9)](_0x24c98a(0x6fc))[_0x24c98a(0x11cd)](_0x9f47b)[_0x24c98a(0x5dd)]();if(_0x1fada8){alert(_0x24c98a(0xce9)+_0x9f47b+_0x24c98a(0xe1b));return;}await _0x4e1bbf['qzoneGroups'][_0x24c98a(0xdda)]({'name':_0x9f47b}),_0x153e82['value']='',await _0x43aa5e();}async function _0x32869a(_0x4e4aab){const _0x4c01f4=_0x5a7792,_0x4313b4=await _0x54149f(_0x4c01f4(0x13d2),'删除分组后，该组内的好友将变为“未分组”。确定要删除吗？',{'confirmButtonClass':_0x4c01f4(0xeed)});if(_0x4313b4){await _0x4e1bbf[_0x4c01f4(0xc1a)][_0x4c01f4(0x3aa)](_0x4e4aab);const _0x515cb5=await _0x4e1bbf[_0x4c01f4(0x999)][_0x4c01f4(0xec9)](_0x4c01f4(0xeb))[_0x4c01f4(0x11cd)](_0x4e4aab)[_0x4c01f4(0x78f)]();for(const _0x8496e2 of _0x515cb5){_0x8496e2[_0x4c01f4(0xeb)]=null,await _0x4e1bbf[_0x4c01f4(0x999)]['put'](_0x8496e2);if(_0x3e7a1b[_0x4c01f4(0x999)][_0x8496e2['id']])_0x3e7a1b['chats'][_0x8496e2['id']][_0x4c01f4(0xeb)]=null;}await _0x43aa5e();}}function _0x2bd5c2(_0x2b8b5b){const _0x5d6d66=_0x5a7792,_0x27c10b=_0x3e7a1b[_0x5d6d66(0x999)][_0x3e7a1b[_0x5d6d66(0x777)]];document[_0x5d6d66(0x64f)](_0x5d6d66(0xcc6))[_0x5d6d66(0x731)][_0x5d6d66(0x130)]=_0x27c10b[_0x5d6d66(0x1167)]?_0x5d6d66(0xb37):_0x5d6d66(0x1209);if(_0x2a27ef)return;_0x5096e4=_0x2b8b5b,document[_0x5d6d66(0x64f)](_0x5d6d66(0x3cb))['classList'][_0x5d6d66(0xdda)](_0x5d6d66(0x40a));}function _0x4a722d(){const _0x7853e6=_0x5a7792;document['getElementById'](_0x7853e6(0x3cb))[_0x7853e6(0x418)][_0x7853e6(0x1275)](_0x7853e6(0x40a)),_0x5096e4=null;}async function _0x2b6683(){const _0x5915e0=_0x5a7792;if(!_0x5096e4)return;const _0x1e622b=_0x5096e4,_0x1b6199=_0x3e7a1b[_0x5915e0(0x999)][_0x3e7a1b[_0x5915e0(0x777)]],_0x244f85=_0x1b6199[_0x5915e0(0x830)][_0x5915e0(0x137)](_0x10bbda=>_0x10bbda[_0x5915e0(0x8af)]===_0x1e622b);if(!_0x244f85)return;_0x4a722d();let _0x2f9ac5;const _0x403f65=_0x244f85[_0x5915e0(0xafc)]&&[_0x5915e0(0xe76),_0x5915e0(0x118),_0x5915e0(0xcda),_0x5915e0(0x460)]['includes'](_0x244f85[_0x5915e0(0xafc)]);if(_0x403f65){let _0x5ac06d={'type':_0x244f85[_0x5915e0(0xafc)]};if(_0x244f85[_0x5915e0(0xafc)]==='voice_message')_0x5ac06d[_0x5915e0(0x3ba)]=_0x244f85[_0x5915e0(0x3ba)];else{if(_0x244f85[_0x5915e0(0xafc)]==='ai_image')_0x5ac06d['description']=_0x244f85[_0x5915e0(0x3ba)];else{if(_0x244f85[_0x5915e0(0xafc)]===_0x5915e0(0xcda))_0x5ac06d[_0x5915e0(0x12fc)]=_0x244f85[_0x5915e0(0x12fc)],_0x5ac06d['note']=_0x244f85[_0x5915e0(0x939)];else _0x244f85[_0x5915e0(0xafc)]===_0x5915e0(0x460)&&(_0x5ac06d['title']=_0x244f85[_0x5915e0(0x1250)],_0x5ac06d['description']=_0x244f85[_0x5915e0(0x9af)],_0x5ac06d[_0x5915e0(0x4b5)]=_0x244f85[_0x5915e0(0x4b5)],_0x5ac06d[_0x5915e0(0x3ba)]=_0x244f85[_0x5915e0(0x3ba)]);}}_0x2f9ac5=JSON[_0x5915e0(0xe3f)](_0x5ac06d,null,0x2);}else typeof _0x244f85[_0x5915e0(0x3ba)]===_0x5915e0(0x59a)?_0x2f9ac5=JSON[_0x5915e0(0xe3f)](_0x244f85[_0x5915e0(0x3ba)],null,0x2):_0x2f9ac5=_0x244f85[_0x5915e0(0x3ba)];const _0x349100={'voice':{'type':'voice_message','content':_0x5915e0(0x31b)},'image':{'type':'ai_image','description':_0x5915e0(0xf89)},'transfer':{'type':'transfer','amount':5.2,'note':_0x5915e0(0x951)},'link':{'type':'share_link','title':_0x5915e0(0x858),'description':_0x5915e0(0x162),'source_name':_0x5915e0(0x7bb),'content':_0x5915e0(0x2ee)}},_0x3f3023=_0x5915e0(0x108a)+JSON['stringify'](_0x349100[_0x5915e0(0x75e)])+_0x5915e0(0x27c)+JSON[_0x5915e0(0xe3f)](_0x349100[_0x5915e0(0x980)])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x5915e0(0xe3f)](_0x349100['transfer'])+_0x5915e0(0x8e2)+JSON['stringify'](_0x349100[_0x5915e0(0x5f0)])+_0x5915e0(0x977),_0x218a00=await _0x41e3f8(_0x5915e0(0xaa3),_0x5915e0(0x419),_0x2f9ac5,_0x5915e0(0x444),_0x3f3023);_0x218a00!==null&&await _0x270a27(_0x1e622b,_0x218a00,!![]);}async function _0xedb5e6(){const _0x247ebb=_0x5a7792;if(!_0x5096e4)return;const _0x688843=_0x3e7a1b[_0x247ebb(0x999)][_0x3e7a1b['activeChatId']],_0x165183=_0x688843[_0x247ebb(0x830)][_0x247ebb(0x137)](_0x13bf0b=>_0x13bf0b[_0x247ebb(0x8af)]===_0x5096e4);if(!_0x165183)return;let _0x38a084;typeof _0x165183[_0x247ebb(0x3ba)]==='object'?_0x38a084=JSON[_0x247ebb(0xe3f)](_0x165183['content']):_0x38a084=String(_0x165183[_0x247ebb(0x3ba)]);try{await navigator[_0x247ebb(0xf7d)][_0x247ebb(0x10b8)](_0x38a084),await _0x28974b(_0x247ebb(0x964),'消息内容已复制到剪贴板。');}catch(_0x1ceb72){await _0x28974b('复制失败',_0x247ebb(0xbd0));}_0x4a722d();}async function _0x1e21e3(){const _0x51398e=_0x5a7792;if(!_0x5096e4)return;try{await navigator[_0x51398e(0xf7d)][_0x51398e(0x10b8)](_0x5096e4),await _0x28974b(_0x51398e(0x964),_0x51398e(0x7a6)+_0x5096e4+_0x51398e(0x3a8));}catch(_0x47a8fd){await _0x28974b(_0x51398e(0x15b),_0x51398e(0xbd0));}_0x4a722d();}function _0x55bb3d(_0x44a22a=''){const _0x4e91df=_0x5a7792,_0x46c1f9=document[_0x4e91df(0x124e)](_0x4e91df(0x479));_0x46c1f9[_0x4e91df(0x87d)]=_0x4e91df(0x104a);const _0x3564db={'voice':{'type':'voice_message','content':'在这里输入语音内容'},'image':{'type':'ai_image','description':'在这里输入图片描述'},'transfer':{'type':_0x4e91df(0xcda),'amount':5.2,'note':_0x4e91df(0x951)},'link':{'type':_0x4e91df(0x460),'title':_0x4e91df(0x858),'description':_0x4e91df(0x162),'source_name':_0x4e91df(0x7bb),'content':_0x4e91df(0x2ee)},'offline':{'type':_0x4e91df(0x9cb),'content':_0x4e91df(0x78d)},'quote':{'type':_0x4e91df(0x94d),'target_timestamp':0x499602d2,'reply_content':_0x4e91df(0x7f6)}};return _0x46c1f9[_0x4e91df(0xc58)]=_0x4e91df(0x3b7)+_0x44a22a+_0x4e91df(0x13c7)+JSON[_0x4e91df(0xe3f)](_0x3564db['voice'])+_0x4e91df(0xf41)+JSON['stringify'](_0x3564db['image'])+'\x27>图片</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x4e91df(0xe3f)](_0x3564db[_0x4e91df(0xcda)])+_0x4e91df(0x327)+JSON[_0x4e91df(0xe3f)](_0x3564db['link'])+'\x27>链接</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x4e91df(0xe3f)](_0x3564db[_0x4e91df(0x12df)])+_0x4e91df(0x12b4)+JSON[_0x4e91df(0xe3f)](_0x3564db[_0x4e91df(0x2fa)])+'\x27>引用</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x46c1f9[_0x4e91df(0x49c)](_0x4e91df(0x7c3))['addEventListener'](_0x4e91df(0x1080),()=>{const _0x5f3cc6=_0x4e91df;document['querySelectorAll'](_0x5f3cc6(0x1363))[_0x5f3cc6(0x40f)]>0x1?_0x46c1f9['remove']():alert(_0x5f3cc6(0x206));}),_0x46c1f9[_0x4e91df(0x233)](_0x4e91df(0x1375))[_0x4e91df(0x103)](_0x1d17af=>{const _0x305d34=_0x4e91df;_0x1d17af[_0x305d34(0xf72)](_0x305d34(0x1080),()=>{const _0x333218=_0x305d34,_0x4a2837=_0x1d17af['dataset'][_0x333218(0xc98)],_0x5b071e=_0x46c1f9['querySelector']('textarea');if(_0x4a2837&&_0x5b071e)try{const _0x4f1929=JSON['parse'](_0x4a2837);_0x5b071e[_0x333218(0xbed)]=JSON['stringify'](_0x4f1929,null,0x2),_0x5b071e[_0x333218(0x1218)]();}catch(_0x5992f5){console[_0x333218(0xc60)](_0x333218(0x6c5),_0x5992f5);}});}),_0x46c1f9;}function _0x4f5854(){const _0x21fab9=_0x5a7792;if(!_0x5096e4)return;const _0x5cb7ab=_0x5096e4,_0x5b1173=_0x3e7a1b[_0x21fab9(0x999)][_0x3e7a1b[_0x21fab9(0x777)]],_0xe7bfc0=_0x5b1173[_0x21fab9(0x830)][_0x21fab9(0x137)](_0x26344c=>_0x26344c[_0x21fab9(0x8af)]===_0x5cb7ab);if(!_0xe7bfc0)return;_0x4a722d();const _0x55a727=document[_0x21fab9(0x64f)](_0x21fab9(0xb60)),_0x4a935e=document['getElementById'](_0x21fab9(0x105));_0x4a935e[_0x21fab9(0xc58)]='';let _0x4d765f;if(_0xe7bfc0[_0x21fab9(0x2fa)]){const _0x24bf92={'type':_0x21fab9(0x94d),'target_timestamp':_0xe7bfc0[_0x21fab9(0x2fa)][_0x21fab9(0x8af)],'reply_content':_0xe7bfc0[_0x21fab9(0x3ba)]};_0x4d765f=JSON['stringify'](_0x24bf92,null,0x2);}else{if(_0xe7bfc0[_0x21fab9(0xafc)]&&[_0x21fab9(0xe76),_0x21fab9(0x118),'transfer','offline_text',_0x21fab9(0x460)][_0x21fab9(0xe53)](_0xe7bfc0[_0x21fab9(0xafc)])){let _0x18311c={'type':_0xe7bfc0[_0x21fab9(0xafc)]};if(_0xe7bfc0[_0x21fab9(0xafc)]==='voice_message')_0x18311c[_0x21fab9(0x3ba)]=_0xe7bfc0[_0x21fab9(0x3ba)];else{if(_0xe7bfc0['type']===_0x21fab9(0x118))_0x18311c[_0x21fab9(0x9af)]=_0xe7bfc0[_0x21fab9(0x3ba)];else{if(_0xe7bfc0['type']==='transfer')_0x18311c[_0x21fab9(0x12fc)]=_0xe7bfc0[_0x21fab9(0x12fc)],_0x18311c[_0x21fab9(0x939)]=_0xe7bfc0[_0x21fab9(0x939)];else{if(_0xe7bfc0[_0x21fab9(0xafc)]===_0x21fab9(0x9cb))_0xe7bfc0['content']?_0x18311c[_0x21fab9(0x3ba)]=_0xe7bfc0[_0x21fab9(0x3ba)]:(_0x18311c[_0x21fab9(0x344)]=_0xe7bfc0[_0x21fab9(0x344)],_0x18311c['description']=_0xe7bfc0[_0x21fab9(0x9af)]);else _0xe7bfc0[_0x21fab9(0xafc)]==='share_link'&&(_0x18311c[_0x21fab9(0x1250)]=_0xe7bfc0[_0x21fab9(0x1250)],_0x18311c[_0x21fab9(0x9af)]=_0xe7bfc0[_0x21fab9(0x9af)],_0x18311c[_0x21fab9(0x4b5)]=_0xe7bfc0[_0x21fab9(0x4b5)],_0x18311c['content']=_0xe7bfc0[_0x21fab9(0x3ba)]);}}}_0x4d765f=JSON['stringify'](_0x18311c,null,0x2);}else typeof _0xe7bfc0[_0x21fab9(0x3ba)]===_0x21fab9(0x59a)?_0x4d765f=JSON[_0x21fab9(0xe3f)](_0xe7bfc0[_0x21fab9(0x3ba)],null,0x2):_0x4d765f=_0xe7bfc0[_0x21fab9(0x3ba)];}const _0x33fc1f=_0x55bb3d(_0x4d765f);_0x4a935e['appendChild'](_0x33fc1f);const _0x3d760c=document['getElementById'](_0x21fab9(0xf0a)),_0x32d5b2=_0x3d760c[_0x21fab9(0xc66)](!![]);_0x3d760c['parentNode'][_0x21fab9(0x3d4)](_0x32d5b2,_0x3d760c),_0x32d5b2[_0x21fab9(0xf72)](_0x21fab9(0x1080),()=>{const _0x2ce968=_0x21fab9,_0x1cc7f5=_0x55bb3d();_0x4a935e[_0x2ce968(0x99e)](_0x1cc7f5),_0x1cc7f5[_0x2ce968(0x49c)](_0x2ce968(0x444))['focus']();});const _0x484188=document[_0x21fab9(0x64f)](_0x21fab9(0x732)),_0xd75a3a=_0x484188[_0x21fab9(0xc66)](!![]);_0x484188[_0x21fab9(0x9be)][_0x21fab9(0x3d4)](_0xd75a3a,_0x484188),_0xd75a3a[_0x21fab9(0xf72)](_0x21fab9(0x1080),()=>{const _0x36f669=_0x21fab9;_0x55a727[_0x36f669(0x418)]['remove']('visible');});const _0x56de9a=document[_0x21fab9(0x64f)]('save-advanced-editor-btn'),_0x89a16b=_0x56de9a[_0x21fab9(0xc66)](!![]);_0x56de9a[_0x21fab9(0x9be)]['replaceChild'](_0x89a16b,_0x56de9a),_0x89a16b[_0x21fab9(0xf72)](_0x21fab9(0x1080),()=>{_0x270a27(_0x5cb7ab);}),_0x55a727[_0x21fab9(0x418)][_0x21fab9(0xdda)](_0x21fab9(0x40a));}async function _0xedb5e6(){const _0x244e5a=_0x5a7792;if(!_0x5096e4)return;const _0x1a7150=_0x3e7a1b['chats'][_0x3e7a1b[_0x244e5a(0x777)]],_0x4ab055=_0x1a7150[_0x244e5a(0x830)][_0x244e5a(0x137)](_0x4c099a=>_0x4c099a['timestamp']===_0x5096e4);if(!_0x4ab055)return;let _0x3fb7e0;if(_0x4ab055[_0x244e5a(0xafc)]===_0x244e5a(0x9cb))_0x4ab055[_0x244e5a(0x3ba)]?_0x3fb7e0=_0x4ab055[_0x244e5a(0x3ba)]:_0x3fb7e0='「'+(_0x4ab055[_0x244e5a(0x344)]||'')+'」\x0a'+(_0x4ab055[_0x244e5a(0x9af)]||'');else typeof _0x4ab055[_0x244e5a(0x3ba)]==='object'?_0x3fb7e0=JSON[_0x244e5a(0xe3f)](_0x4ab055['content']):_0x3fb7e0=String(_0x4ab055['content']);try{await navigator[_0x244e5a(0xf7d)]['writeText'](_0x3fb7e0),await _0x28974b(_0x244e5a(0x964),_0x244e5a(0x730));}catch(_0x25bb9d){await _0x28974b(_0x244e5a(0x15b),_0x244e5a(0xbd0));}_0x4a722d();}function _0x439e36(_0x5b9d44){const _0x275342=_0x5a7792,_0x5b0932=_0x5b9d44[_0x275342(0x43a)]();if(_0x5b0932[_0x275342(0x7d)]('{')&&_0x5b0932[_0x275342(0x720)]('}'))try{const _0x3cbf90=JSON['parse'](_0x5b0932);if(_0x3cbf90[_0x275342(0xafc)])return _0x3cbf90;}catch(_0x5baf10){}if(_0x442b6b['test'](_0x5b0932))return{'type':_0x275342(0xefb),'content':_0x5b0932};return{'type':_0x275342(0x673),'content':_0x5b0932};}async function _0x270a27(_0x35ce62,_0x4fb6fe=null){const _0x1d5661=_0x5a7792;if(!_0x35ce62)return;const _0x3753c7=_0x3e7a1b[_0x1d5661(0x999)][_0x3e7a1b[_0x1d5661(0x777)]],_0x403745=_0x3753c7[_0x1d5661(0x830)][_0x1d5661(0x6a2)](_0x165bce=>_0x165bce['timestamp']===_0x35ce62);if(_0x403745===-0x1)return;const _0x106b6d=_0x3753c7[_0x1d5661(0x830)][_0x403745];let _0x1f17a5=[];const _0x38bbc2=_0x4fb6fe!==null?[_0x4fb6fe]:Array[_0x1d5661(0xb3a)](document[_0x1d5661(0x233)](_0x1d5661(0xe67)))['map'](_0x5273d1=>_0x5273d1['value']);for(const _0x5d59ed of _0x38bbc2){if(!_0x5d59ed[_0x1d5661(0x43a)]())continue;const _0x554089=_0x439e36(_0x5d59ed['trim']()),_0x48d3cf={'role':_0x106b6d[_0x1d5661(0x931)],'senderName':_0x106b6d['senderName'],'timestamp':_0x106b6d[_0x1d5661(0x8af)]};switch(_0x554089[_0x1d5661(0xafc)]){case _0x1d5661(0x673):_0x48d3cf[_0x1d5661(0xafc)]=_0x1d5661(0x673),_0x48d3cf[_0x1d5661(0x3ba)]=_0x554089[_0x1d5661(0x3ba)];break;case'offline_text':_0x48d3cf[_0x1d5661(0xafc)]='offline_text';_0x554089[_0x1d5661(0x3ba)]?_0x48d3cf[_0x1d5661(0x3ba)]=_0x554089[_0x1d5661(0x3ba)]:(_0x48d3cf[_0x1d5661(0x344)]=_0x554089[_0x1d5661(0x344)],_0x48d3cf['description']=_0x554089['description']);break;case _0x1d5661(0x94d):_0x48d3cf['type']='quote_reply',_0x48d3cf[_0x1d5661(0x3ba)]=_0x554089[_0x1d5661(0x13d3)];const _0xc19c0f=_0x3753c7['history'][_0x1d5661(0x137)](_0x182002=>_0x182002[_0x1d5661(0x8af)]===_0x554089['target_timestamp']);if(_0xc19c0f){let _0x2f1207=_0xc19c0f[_0x1d5661(0x133d)];_0xc19c0f['role']===_0x1d5661(0xa4d)&&(_0x2f1207=_0x3e7a1b['qzoneSettings'][_0x1d5661(0x78c)]||_0x1d5661(0x1028)),_0x48d3cf[_0x1d5661(0x2fa)]={'timestamp':_0x554089['target_timestamp'],'senderName':_0x2f1207,'content':String(_0xc19c0f[_0x1d5661(0x3ba)]||'')};}else _0x48d3cf[_0x1d5661(0x2fa)]={'timestamp':_0x554089['target_timestamp'],'senderName':_0x1d5661(0x100b),'content':'原始消息已删除或不存在'};break;case _0x1d5661(0xe76):case _0x1d5661(0x118):case _0x1d5661(0xb11):_0x48d3cf['type']=_0x554089['type'],_0x48d3cf[_0x1d5661(0x3ba)]=_0x554089['content']||_0x554089[_0x1d5661(0x9af)];if(_0x554089[_0x1d5661(0x10b3)])_0x48d3cf['meaning']=_0x554089[_0x1d5661(0x10b3)];break;case'sticker':{_0x48d3cf['type']=_0x1d5661(0xefb);let _0x170afc=![];if(_0x554089[_0x1d5661(0x10b3)]){const _0x405a82=_0x3e7a1b[_0x1d5661(0xa8b)][_0x1d5661(0x137)](_0x2b38d9=>_0x2b38d9[_0x1d5661(0x6fc)]===_0x554089[_0x1d5661(0x10b3)]);_0x405a82?(_0x48d3cf[_0x1d5661(0x3ba)]=_0x405a82[_0x1d5661(0xe52)],_0x48d3cf['meaning']=_0x405a82[_0x1d5661(0x6fc)],console['log'](_0x1d5661(0x79b)),_0x170afc=!![]):(_0x48d3cf[_0x1d5661(0xafc)]=_0x1d5661(0x673),_0x48d3cf[_0x1d5661(0x3ba)]=_0x1d5661(0x7af)+_0x554089[_0x1d5661(0x10b3)]+']',console[_0x1d5661(0x1155)](_0x1d5661(0xfcd),_0x554089['meaning']),_0x170afc=!![]);}if(!_0x170afc&&_0x554089[_0x1d5661(0xe52)]){_0x48d3cf['content']=_0x554089[_0x1d5661(0xe52)];const _0x58b91b=_0x3e7a1b[_0x1d5661(0xa8b)][_0x1d5661(0x137)](_0x5a6966=>_0x5a6966[_0x1d5661(0xe52)]===_0x554089[_0x1d5661(0xe52)]);if(_0x554089[_0x1d5661(0x10b3)]&&(!_0x58b91b||_0x58b91b['name']===_0x554089['meaning']))_0x48d3cf[_0x1d5661(0x10b3)]=_0x554089['meaning'];else _0x58b91b?_0x48d3cf[_0x1d5661(0x10b3)]=_0x58b91b[_0x1d5661(0x6fc)]:_0x48d3cf[_0x1d5661(0x10b3)]=_0x1d5661(0x7ef);console[_0x1d5661(0x1081)](_0x1d5661(0xf6f),_0x48d3cf[_0x1d5661(0x10b3)]),_0x170afc=!![];}if(!_0x170afc&&_0x554089[_0x1d5661(0x3ba)]&&typeof _0x554089['content']==='string'&&_0x442b6b[_0x1d5661(0x4af)](_0x554089[_0x1d5661(0x3ba)])){_0x48d3cf[_0x1d5661(0x3ba)]=_0x554089[_0x1d5661(0x3ba)];const _0x25b670=_0x3e7a1b[_0x1d5661(0xa8b)][_0x1d5661(0x137)](_0x129382=>_0x129382['url']===_0x554089['content']);_0x48d3cf[_0x1d5661(0x10b3)]=_0x25b670?_0x25b670[_0x1d5661(0x6fc)]:_0x1d5661(0x7ef),console[_0x1d5661(0x1081)](_0x1d5661(0x88d),_0x48d3cf[_0x1d5661(0x10b3)]),_0x170afc=!![];}if(!_0x170afc){console[_0x1d5661(0xc60)](_0x1d5661(0xaaf),_0x554089);continue;}break;}case _0x1d5661(0xcda):_0x48d3cf[_0x1d5661(0xafc)]=_0x1d5661(0xcda),_0x48d3cf['amount']=_0x554089[_0x1d5661(0x12fc)],_0x48d3cf[_0x1d5661(0x939)]=_0x554089[_0x1d5661(0x939)];break;case'share_link':_0x48d3cf[_0x1d5661(0xafc)]='share_link',_0x48d3cf['title']=_0x554089[_0x1d5661(0x1250)],_0x48d3cf[_0x1d5661(0x9af)]=_0x554089[_0x1d5661(0x9af)],_0x48d3cf[_0x1d5661(0x4b5)]=_0x554089[_0x1d5661(0x4b5)],_0x48d3cf[_0x1d5661(0x3ba)]=_0x554089[_0x1d5661(0x3ba)];break;default:Object[_0x1d5661(0x27d)](_0x48d3cf,_0x554089);break;}_0x1f17a5[_0x1d5661(0x13ee)](_0x48d3cf);}if(_0x1f17a5[_0x1d5661(0x40f)]===0x0){document['getElementById'](_0x1d5661(0xb60))[_0x1d5661(0x418)][_0x1d5661(0x1275)]('visible');return;}_0x3753c7[_0x1d5661(0x830)][_0x1d5661(0x10f9)](_0x403745,0x1,..._0x1f17a5);let _0x302588=_0x35ce62;for(let _0x1fa907=_0x403745;_0x1fa907<_0x3753c7[_0x1d5661(0x830)][_0x1d5661(0x40f)];_0x1fa907++){_0x3753c7[_0x1d5661(0x830)][_0x1fa907]['timestamp']=_0x302588,_0x302588++;}await _0x4e1bbf[_0x1d5661(0x999)][_0x1d5661(0x4fa)](_0x3753c7),document['getElementById'](_0x1d5661(0xb60))[_0x1d5661(0x418)][_0x1d5661(0x1275)](_0x1d5661(0x40a)),_0x4817d1(_0x3e7a1b[_0x1d5661(0x777)]),await _0x28974b('成功',_0x1d5661(0x6fb));}function _0x3a5b4d(_0xf4e66d){const _0x4a1a51=_0x5a7792;_0x3dd5a2=_0xf4e66d,document[_0x4a1a51(0x64f)](_0x4a1a51(0x47f))[_0x4a1a51(0x418)][_0x4a1a51(0xdda)](_0x4a1a51(0x40a));}function _0x204624(){const _0x3554de=_0x5a7792;document[_0x3554de(0x64f)]('post-actions-modal')[_0x3554de(0x418)]['remove'](_0x3554de(0x40a)),_0x3dd5a2=null;}async function _0x5e82d8(){const _0x2a2f5f=_0x5a7792;if(!_0x3dd5a2)return;const _0xd34b84=_0x3dd5a2,_0x2c4eae=await _0x4e1bbf[_0x2a2f5f(0xaf9)][_0x2a2f5f(0x11fc)](_0xd34b84);if(!_0x2c4eae)return;_0x204624();let _0x47dcac;if(_0x2c4eae['type']===_0x2a2f5f(0x103d))_0x47dcac=_0x2c4eae[_0x2a2f5f(0x3ba)];else{const _0x3abf4a={'type':_0x2c4eae[_0x2a2f5f(0xafc)],'publicText':_0x2c4eae[_0x2a2f5f(0x66e)]||''};if(_0x2c4eae['type']==='image_post')_0x3abf4a[_0x2a2f5f(0xd07)]=_0x2c4eae[_0x2a2f5f(0xd07)],_0x3abf4a[_0x2a2f5f(0x911)]=_0x2c4eae[_0x2a2f5f(0x911)];else _0x2c4eae[_0x2a2f5f(0xafc)]===_0x2a2f5f(0x351)&&(_0x3abf4a['hiddenContent']=_0x2c4eae[_0x2a2f5f(0x1150)]);_0x47dcac=JSON['stringify'](_0x3abf4a,null,0x2);}const _0x229254={'shuoshuo':_0x2a2f5f(0x92),'image':{'type':_0x2a2f5f(0x3d9),'publicText':'','imageUrl':_0x2a2f5f(0xdf7),'imageDescription':''},'text_image':{'type':_0x2a2f5f(0x351),'publicText':'','hiddenContent':''}},_0x845fda='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22format-helpers\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-type=\x22text\x22>说说</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON[_0x2a2f5f(0xe3f)](_0x229254['image'])+_0x2a2f5f(0xf56)+JSON[_0x2a2f5f(0xe3f)](_0x229254[_0x2a2f5f(0x351)])+'\x27>文字图</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x160fa2=await _0x41e3f8(_0x2a2f5f(0x79a),'在此修改内容...',_0x47dcac,'textarea',_0x845fda);setTimeout(()=>{const _0x4b8ddb=_0x2a2f5f,_0x29804=document[_0x4b8ddb(0x49c)]('#custom-modal-body\x20.format-btn[data-type=\x22text\x22]');_0x29804&&_0x29804['addEventListener'](_0x4b8ddb(0x1080),()=>{const _0x591844=_0x4b8ddb,_0x55ed73=document[_0x591844(0x64f)](_0x591844(0x35e));_0x55ed73[_0x591844(0xbed)]=_0x229254[_0x591844(0x103d)],_0x55ed73[_0x591844(0x1218)]();});},0x64),_0x160fa2!==null&&await _0x3547e9(_0xd34b84,_0x160fa2);}async function _0x3547e9(_0x36b714,_0x3ca088){const _0xd4df94=_0x5a7792,_0x5040e9=await _0x4e1bbf[_0xd4df94(0xaf9)][_0xd4df94(0x11fc)](_0x36b714);if(!_0x5040e9)return;const _0x1cdf89=_0x3ca088[_0xd4df94(0x43a)]();try{const _0x55af20=JSON['parse'](_0x1cdf89);_0x5040e9[_0xd4df94(0xafc)]=_0x55af20[_0xd4df94(0xafc)]||_0xd4df94(0x3d9),_0x5040e9[_0xd4df94(0x66e)]=_0x55af20[_0xd4df94(0x66e)]||'',_0x5040e9['imageUrl']=_0x55af20[_0xd4df94(0xd07)]||'',_0x5040e9[_0xd4df94(0x911)]=_0x55af20[_0xd4df94(0x911)]||'',_0x5040e9[_0xd4df94(0x1150)]=_0x55af20[_0xd4df94(0x1150)]||'',_0x5040e9['content']='';}catch(_0x255688){_0x5040e9[_0xd4df94(0xafc)]=_0xd4df94(0x103d),_0x5040e9[_0xd4df94(0x3ba)]=_0x1cdf89,_0x5040e9[_0xd4df94(0x66e)]='',_0x5040e9[_0xd4df94(0xd07)]='',_0x5040e9['imageDescription']='',_0x5040e9[_0xd4df94(0x1150)]='';}await _0x4e1bbf[_0xd4df94(0xaf9)][_0xd4df94(0x4fa)](_0x5040e9),await _0x40e6dd(),await _0x28974b('成功',_0xd4df94(0x89d));}async function _0x6c2020(){const _0x3dbd6e=_0x5a7792;if(!_0x3dd5a2)return;const _0x4c01ef=await _0x4e1bbf[_0x3dbd6e(0xaf9)][_0x3dbd6e(0x11fc)](_0x3dd5a2);if(!_0x4c01ef)return;let _0x3f2523=_0x4c01ef['content']||_0x4c01ef[_0x3dbd6e(0x66e)]||_0x4c01ef[_0x3dbd6e(0x1150)]||_0x4c01ef[_0x3dbd6e(0x911)]||'（无文字内容）';try{await navigator[_0x3dbd6e(0xf7d)][_0x3dbd6e(0x10b8)](_0x3f2523),await _0x28974b(_0x3dbd6e(0x964),_0x3dbd6e(0x107b));}catch(_0x1234bc){await _0x28974b(_0x3dbd6e(0x15b),_0x3dbd6e(0xbd0));}_0x204624();}let _0x3c5979=new Set();async function _0x20ce3f(){const _0x4ed171=_0x5a7792,_0x47fefc=await _0x217169('创建群聊',[{'text':_0x4ed171(0x98c),'value':_0x4ed171(0xe57)},{'text':'创建旁观群聊\x20(我围观)','value':_0x4ed171(0x1172)}]);if(_0x47fefc==='normal'){_0x3c5979['clear']();const _0x41e974=document[_0x4ed171(0x64f)](_0x4ed171(0xb8d)),_0x2a87d6=_0x41e974[_0x4ed171(0xc66)](!![]);_0x41e974[_0x4ed171(0x9be)][_0x4ed171(0x3d4)](_0x2a87d6,_0x41e974),_0x2a87d6[_0x4ed171(0xf72)](_0x4ed171(0x1080),_0x1b556e),await _0x580275(),_0xddd8ae(_0x4ed171(0x3f2));}else _0x47fefc===_0x4ed171(0x1172)&&_0x92b14c();}async function _0x92b14c(){const _0x2e455d=_0x5a7792;_0x3c5979[_0x2e455d(0x1057)]();const _0x1a12a4=document[_0x2e455d(0x64f)](_0x2e455d(0xb8d)),_0x73e9a3=_0x1a12a4[_0x2e455d(0xc66)](!![]);_0x1a12a4[_0x2e455d(0x9be)][_0x2e455d(0x3d4)](_0x73e9a3,_0x1a12a4),_0x73e9a3['addEventListener'](_0x2e455d(0x1080),_0x24dfcb),await _0xb94b81(),_0xddd8ae(_0x2e455d(0x3f2));}async function _0xb94b81(){const _0x2b4c39=_0x5a7792,_0x1d90f2=document[_0x2b4c39(0x64f)](_0x2b4c39(0xc2b));_0x1d90f2[_0x2b4c39(0xc58)]='';const _0x36f606=Object[_0x2b4c39(0xd6d)](_0x3e7a1b[_0x2b4c39(0x999)])['filter'](_0x1804ba=>!_0x1804ba['isGroup']),_0x9fce39=await _0x4e1bbf[_0x2b4c39(0xad7)]['toArray']();if(_0x36f606['length']===0x0&&_0x9fce39[_0x2b4c39(0x40f)]===0x0){_0x1d90f2[_0x2b4c39(0xc58)]=_0x2b4c39(0xc0c);return;}_0x36f606[_0x2b4c39(0x103)](_0x3b1afd=>{const _0x7d2894=_0x2b4c39,_0x5dabf1=document[_0x7d2894(0x124e)](_0x7d2894(0x479));_0x5dabf1[_0x7d2894(0x87d)]=_0x7d2894(0x6e3),_0x5dabf1[_0x7d2894(0x12e1)][_0x7d2894(0xd6f)]=_0x3b1afd['id'],_0x5dabf1[_0x7d2894(0xc58)]=_0x7d2894(0x11a2)+(_0x3b1afd['settings'][_0x7d2894(0x93)]||_0x54e358)+_0x7d2894(0x258)+_0x3b1afd[_0x7d2894(0x6fc)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x1d90f2[_0x7d2894(0x99e)](_0x5dabf1);}),_0x9fce39[_0x2b4c39(0x103)](_0x18e09=>{const _0x42b4b4=_0x2b4c39,_0x3640d4=document[_0x42b4b4(0x124e)](_0x42b4b4(0x479));_0x3640d4[_0x42b4b4(0x87d)]=_0x42b4b4(0x6e3),_0x3640d4[_0x42b4b4(0x12e1)][_0x42b4b4(0xd6f)]=_0x18e09['id'],_0x3640d4[_0x42b4b4(0x12e1)][_0x42b4b4(0xe97)]=_0x42b4b4(0x8c1),_0x3640d4['innerHTML']=_0x42b4b4(0x11a2)+(_0x18e09[_0x42b4b4(0x1265)]||_0x480024)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x18e09[_0x42b4b4(0x6fc)]+_0x42b4b4(0x37c),_0x1d90f2[_0x42b4b4(0x99e)](_0x3640d4);}),_0x2ecf66();}async function _0x24dfcb(){const _0x26e0db=_0x5a7792;if(_0x3c5979[_0x26e0db(0x9dd)]<0x2){alert('旁观群聊至少需要选择2个成员。');return;}const _0x55995f=await _0x41e3f8('设置群名',_0x26e0db(0x1349),_0x26e0db(0xd23));if(!_0x55995f||!_0x55995f[_0x26e0db(0x43a)]())return;const _0x87e702=_0x26e0db(0x802)+Date['now'](),_0x2f7fcf=[],_0x1b2691=await _0x4e1bbf[_0x26e0db(0xad7)][_0x26e0db(0x78f)]();for(const _0x30868b of _0x3c5979){const _0xabb9b3=document[_0x26e0db(0x49c)](_0x26e0db(0x9fb)+_0x30868b+'\x22]')[_0x26e0db(0x12e1)][_0x26e0db(0xe97)]===_0x26e0db(0x8c1);if(_0xabb9b3){const _0x7d730b=_0x1b2691[_0x26e0db(0x137)](_0x2a23d2=>_0x2a23d2['id']===parseInt(_0x30868b));_0x7d730b&&_0x2f7fcf[_0x26e0db(0x13ee)]({'id':_0x26e0db(0x33e)+_0x7d730b['id'],'originalName':_0x7d730b[_0x26e0db(0x6fc)],'groupNickname':_0x7d730b[_0x26e0db(0x6fc)],'persona':_0x7d730b[_0x26e0db(0x324)],'avatar':_0x7d730b[_0x26e0db(0x1265)]||_0x480024,'isNpc':!![]});}else{const _0xcc5a06=_0x3e7a1b['chats'][_0x30868b];_0xcc5a06&&_0x2f7fcf[_0x26e0db(0x13ee)]({'id':_0x30868b,'originalName':_0xcc5a06[_0x26e0db(0x7de)],'groupNickname':_0xcc5a06[_0x26e0db(0x6fc)],'persona':_0xcc5a06[_0x26e0db(0xcb3)]['aiPersona'],'avatar':_0xcc5a06[_0x26e0db(0xcb3)][_0x26e0db(0x93)]||_0x54e358,'isNpc':![]});}}const _0x49305b={'id':_0x87e702,'name':_0x55995f[_0x26e0db(0x43a)](),'isGroup':!![],'isSpectatorGroup':!![],'members':_0x2f7fcf,'settings':{'maxMemory':0xa,'groupAvatar':_0x9bc039,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[{'role':_0x26e0db(0x905),'content':_0x26e0db(0x5b0),'timestamp':Date['now'](),'isHidden':!![]}],'musicData':{'totalTime':0x0}};_0x3e7a1b[_0x26e0db(0x999)][_0x87e702]=_0x49305b,await _0x4e1bbf[_0x26e0db(0x999)][_0x26e0db(0x4fa)](_0x49305b),await _0x21f6ea(),_0xddd8ae(_0x26e0db(0xbb6)),_0x59a090(_0x87e702);}async function _0x580275(){const _0x18652d=_0x5a7792,_0x5dfab7=document['getElementById'](_0x18652d(0xc2b));_0x5dfab7[_0x18652d(0xc58)]='';const _0x141fbd=Object[_0x18652d(0xd6d)](_0x3e7a1b['chats'])[_0x18652d(0x156)](_0x143dd5=>!_0x143dd5[_0x18652d(0x1167)]),_0x179071=await _0x4e1bbf[_0x18652d(0xad7)]['toArray']();if(_0x141fbd['length']===0x0&&_0x179071[_0x18652d(0x40f)]===0x0){_0x5dfab7[_0x18652d(0xc58)]=_0x18652d(0x998);return;}_0x141fbd[_0x18652d(0x103)](_0x212265=>{const _0x71ba8=_0x18652d,_0x911dbc=document[_0x71ba8(0x124e)](_0x71ba8(0x479));_0x911dbc[_0x71ba8(0x87d)]='contact-picker-item',_0x911dbc[_0x71ba8(0x12e1)][_0x71ba8(0xd6f)]=_0x212265['id'],_0x911dbc[_0x71ba8(0xc58)]=_0x71ba8(0x11a2)+(_0x212265['settings'][_0x71ba8(0x93)]||_0x54e358)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x212265[_0x71ba8(0x6fc)]+'\x20<small\x20style=\x22color:#888;\x22>(角色)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5dfab7['appendChild'](_0x911dbc);}),_0x179071['forEach'](_0x4689c9=>{const _0x14c444=_0x18652d,_0x13bbd8=document[_0x14c444(0x124e)](_0x14c444(0x479));_0x13bbd8[_0x14c444(0x87d)]='contact-picker-item',_0x13bbd8[_0x14c444(0x12e1)][_0x14c444(0xd6f)]=_0x14c444(0x33e)+_0x4689c9['id'],_0x13bbd8[_0x14c444(0xc58)]=_0x14c444(0x11a2)+(_0x4689c9[_0x14c444(0x1265)]||_0x480024)+_0x14c444(0x258)+_0x4689c9[_0x14c444(0x6fc)]+'\x20<small\x20style=\x22color:#007722;\x22>(NPC)</small></span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5dfab7[_0x14c444(0x99e)](_0x13bbd8);}),_0x2ecf66();}function _0x2ecf66(){const _0x41397b=_0x5a7792,_0x36fbe4=document[_0x41397b(0x64f)](_0x41397b(0xb8d));_0x36fbe4['textContent']=_0x41397b(0x117)+_0x3c5979[_0x41397b(0x9dd)]+')',_0x36fbe4['disabled']=_0x3c5979[_0x41397b(0x9dd)]<0x2;}async function _0x1b556e(){const _0x324447=_0x5a7792;if(_0x3c5979[_0x324447(0x9dd)]<0x2){alert('创建群聊至少需要选择2个联系人。');return;}const _0x56b9aa=await _0x41e3f8(_0x324447(0x849),_0x324447(0x1349),'我们的群聊');if(!_0x56b9aa||!_0x56b9aa[_0x324447(0x43a)]())return;const _0x581a40=_0x324447(0x802)+Date[_0x324447(0x2b5)](),_0x261144=[],_0x3678b8=await _0x4e1bbf[_0x324447(0xad7)][_0x324447(0x78f)]();for(const _0x120646 of _0x3c5979){if(_0x120646[_0x324447(0x7d)](_0x324447(0x33e))){const _0x41a581=parseInt(_0x120646[_0x324447(0x137f)](_0x324447(0x33e),'')),_0x26c70c=_0x3678b8[_0x324447(0x137)](_0x4c70bb=>_0x4c70bb['id']===_0x41a581);_0x26c70c&&_0x261144[_0x324447(0x13ee)]({'id':_0x120646,'originalName':_0x26c70c['name'],'groupNickname':_0x26c70c['name'],'persona':_0x26c70c[_0x324447(0x324)],'avatar':_0x26c70c[_0x324447(0x1265)]||_0x480024,'isNpc':!![]});}else{const _0x4d49c3=_0x3e7a1b[_0x324447(0x999)][_0x120646];_0x4d49c3&&_0x261144[_0x324447(0x13ee)]({'id':_0x120646,'originalName':_0x4d49c3['originalName'],'groupNickname':_0x4d49c3[_0x324447(0x6fc)],'persona':_0x4d49c3[_0x324447(0xcb3)]['aiPersona'],'avatar':_0x4d49c3['settings'][_0x324447(0x93)]||_0x54e358,'isNpc':![]});}}const _0x46f14d={'id':_0x581a40,'name':_0x56b9aa[_0x324447(0x43a)](),'isGroup':!![],'members':_0x261144,'settings':{'myPersona':_0x324447(0xd09),'myNickname':'我','maxMemory':0xa,'groupAvatar':_0x9bc039,'myAvatar':_0x60cf2,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[]},'history':[],'musicData':{'totalTime':0x0}};_0x3e7a1b['chats'][_0x581a40]=_0x46f14d,await _0x4e1bbf[_0x324447(0x999)][_0x324447(0x4fa)](_0x46f14d),await _0x21f6ea(),_0xddd8ae('chat-list-screen'),_0x59a090(_0x581a40);}function _0x583985(){const _0x3159bb=_0x5a7792;if(!_0x3e7a1b[_0x3159bb(0x777)]||!_0x3e7a1b[_0x3159bb(0x999)][_0x3e7a1b[_0x3159bb(0x777)]][_0x3159bb(0x1167)])return;_0x4d6b29(),_0xddd8ae(_0x3159bb(0x1230));}function _0x4d6b29(){const _0x25e693=_0x5a7792,_0x1f327a=document[_0x25e693(0x64f)]('member-management-list'),_0x4d068f=_0x3e7a1b[_0x25e693(0x999)][_0x3e7a1b[_0x25e693(0x777)]];_0x1f327a[_0x25e693(0xc58)]='',_0x4d068f[_0x25e693(0x5d4)][_0x25e693(0x103)](_0x5944eb=>{const _0x5d12d0=_0x25e693,_0x1d3622=document[_0x5d12d0(0x124e)](_0x5d12d0(0x479));_0x1d3622[_0x5d12d0(0x87d)]=_0x5d12d0(0x1342),_0x1d3622[_0x5d12d0(0xc58)]=_0x5d12d0(0x531)+_0x5944eb[_0x5d12d0(0x1265)]+_0x5d12d0(0xcb2)+_0x5944eb[_0x5d12d0(0x287)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-member-btn\x22\x20data-member-id=\x22'+_0x5944eb['id']+'\x22\x20title=\x22移出群聊\x22>-</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1f327a[_0x5d12d0(0x99e)](_0x1d3622);});}async function _0x2705f2(_0x1b5b61){const _0x32936a=_0x5a7792,_0x49557d=_0x3e7a1b['chats'][_0x3e7a1b[_0x32936a(0x777)]],_0x3fe0e5=_0x49557d[_0x32936a(0x5d4)]['findIndex'](_0x8253ab=>_0x8253ab['id']===_0x1b5b61);if(_0x3fe0e5===-0x1)return;if(_0x49557d['members'][_0x32936a(0x40f)]<=0x2){alert(_0x32936a(0x4cf));return;}const _0x5d1335=_0x49557d[_0x32936a(0x5d4)][_0x3fe0e5][_0x32936a(0x287)],_0x62440a=await _0x54149f('移出成员',_0x32936a(0xd66)+_0x5d1335+_0x32936a(0x85d),{'confirmButtonClass':_0x32936a(0xeed)});_0x62440a&&(_0x49557d[_0x32936a(0x5d4)][_0x32936a(0x10f9)](_0x3fe0e5,0x1),await _0x4e1bbf['chats'][_0x32936a(0x4fa)](_0x49557d),_0x4d6b29(),document['getElementById'](_0x32936a(0x11c4))[_0x32936a(0x1080)]());}async function _0x211ff8(){const _0x1a8ea3=_0x5a7792,_0x257807=document[_0x1a8ea3(0x64f)](_0x1a8ea3(0xb8d)),_0x400f48=_0x257807[_0x1a8ea3(0xc66)](!![]);_0x257807[_0x1a8ea3(0x9be)][_0x1a8ea3(0x3d4)](_0x400f48,_0x257807),_0x400f48['addEventListener'](_0x1a8ea3(0x1080),_0x1921c2),await _0x23cf35(),_0xddd8ae(_0x1a8ea3(0x3f2));}async function _0x23cf35(){const _0x2c51b0=_0x5a7792,_0x762a81=document[_0x2c51b0(0x64f)](_0x2c51b0(0xc2b));_0x762a81[_0x2c51b0(0xc58)]='',_0x3c5979['clear']();const _0x115236=_0x3e7a1b[_0x2c51b0(0x999)][_0x3e7a1b['activeChatId']],_0xe11686=new Set(_0x115236[_0x2c51b0(0x5d4)][_0x2c51b0(0xb96)](_0x1a9ee7=>_0x1a9ee7['id'])),_0x2d3016=Object[_0x2c51b0(0xd6d)](_0x3e7a1b[_0x2c51b0(0x999)])[_0x2c51b0(0x156)](_0x17de47=>!_0x17de47[_0x2c51b0(0x1167)]&&!_0xe11686[_0x2c51b0(0x2a6)](_0x17de47['id'])),_0x1633fa=(await _0x4e1bbf[_0x2c51b0(0xad7)][_0x2c51b0(0x78f)]())[_0x2c51b0(0x156)](_0x4c8cb3=>!_0xe11686[_0x2c51b0(0x2a6)](_0x2c51b0(0x33e)+_0x4c8cb3['id']));_0x2d3016[_0x2c51b0(0x40f)]===0x0&&_0x1633fa[_0x2c51b0(0x40f)]===0x0?(_0x762a81[_0x2c51b0(0xc58)]=_0x2c51b0(0x9f7),document[_0x2c51b0(0x64f)](_0x2c51b0(0xb8d))[_0x2c51b0(0x731)][_0x2c51b0(0x130)]=_0x2c51b0(0x1209)):(document[_0x2c51b0(0x64f)](_0x2c51b0(0xb8d))['style'][_0x2c51b0(0x130)]=_0x2c51b0(0xb37),_0x2d3016[_0x2c51b0(0x103)](_0x1c96eb=>{const _0x4c23ef=_0x2c51b0,_0x7f4516=document['createElement'](_0x4c23ef(0x479));_0x7f4516[_0x4c23ef(0x87d)]=_0x4c23ef(0x6e3),_0x7f4516[_0x4c23ef(0x12e1)]['contactId']=_0x1c96eb['id'],_0x7f4516[_0x4c23ef(0x12e1)]['contactType']='character',_0x7f4516[_0x4c23ef(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22'+(_0x1c96eb[_0x4c23ef(0xcb3)]['aiAvatar']||_0x54e358)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x1c96eb[_0x4c23ef(0x6fc)]+_0x4c23ef(0xd9b),_0x762a81[_0x4c23ef(0x99e)](_0x7f4516);}),_0x1633fa[_0x2c51b0(0x103)](_0x3742ec=>{const _0x32ac5f=_0x2c51b0,_0x548279=document[_0x32ac5f(0x124e)](_0x32ac5f(0x479));_0x548279['className']=_0x32ac5f(0x6e3),_0x548279[_0x32ac5f(0x12e1)][_0x32ac5f(0xd6f)]=_0x32ac5f(0x33e)+_0x3742ec['id'],_0x548279['dataset'][_0x32ac5f(0xc14)]='npc',_0x548279['dataset']['npcId']=_0x3742ec['id'],_0x548279['innerHTML']=_0x32ac5f(0x45d)+(_0x3742ec[_0x32ac5f(0x1265)]||_0x480024)+_0x32ac5f(0xabf)+_0x3742ec[_0x32ac5f(0x6fc)]+_0x32ac5f(0x109d),_0x762a81[_0x32ac5f(0x99e)](_0x548279);})),_0x2ecf66();}async function _0x1921c2(){const _0x3406c2=_0x5a7792;if(_0x3c5979[_0x3406c2(0x9dd)]===0x0){alert('请至少选择一个要添加的联系人。');return;}const _0xac4448=_0x3e7a1b['chats'][_0x3e7a1b[_0x3406c2(0x777)]],_0x3f1ac1=await _0x4e1bbf[_0x3406c2(0xad7)]['toArray']();for(const _0x4a6cf1 of _0x3c5979){const _0x5acec1=document[_0x3406c2(0x49c)](_0x3406c2(0x9fb)+_0x4a6cf1+'\x22]');if(!_0x5acec1)continue;const _0x3fba96=_0x5acec1[_0x3406c2(0x12e1)]['contactType'];if(_0x3fba96===_0x3406c2(0x186)){const _0x20fabd=_0x3e7a1b[_0x3406c2(0x999)][_0x4a6cf1];_0x20fabd&&_0xac4448[_0x3406c2(0x5d4)][_0x3406c2(0x13ee)]({'id':_0x4a6cf1,'originalName':_0x20fabd['originalName'],'groupNickname':_0x20fabd[_0x3406c2(0x6fc)],'persona':_0x20fabd[_0x3406c2(0xcb3)][_0x3406c2(0xbe5)],'avatar':_0x20fabd[_0x3406c2(0xcb3)][_0x3406c2(0x93)]||_0x54e358,'isNpc':![]});}else{if(_0x3fba96===_0x3406c2(0x130e)){const _0x3534be=parseInt(_0x5acec1[_0x3406c2(0x12e1)][_0x3406c2(0x106f)]),_0x407324=_0x3f1ac1['find'](_0x27a3d4=>_0x27a3d4['id']===_0x3534be);_0x407324&&_0xac4448[_0x3406c2(0x5d4)]['push']({'id':'npc_'+_0x3534be,'originalName':_0x407324[_0x3406c2(0x6fc)],'groupNickname':_0x407324['name'],'persona':_0x407324[_0x3406c2(0x324)],'avatar':_0x407324[_0x3406c2(0x1265)]||_0x480024,'isNpc':!![]});}}}await _0x4e1bbf[_0x3406c2(0x999)][_0x3406c2(0x4fa)](_0xac4448),_0x583985();}function _0x4dd112(){_0x585d1c=!![],_0x228ec3(null);}function _0x2a31e1(_0x470bef,_0x5ef725){const _0x4087b0=setInterval(()=>{const _0x1577cd=_0x2bd6,_0x22663f=Date[_0x1577cd(0x2b5)](),_0x3fcf83=_0x5ef725-_0x22663f;if(_0x3fcf83<0x0){clearInterval(_0x4087b0),_0x470bef[_0x1577cd(0xc58)]='<span>已</span><span>超</span><span>时</span>';return;}const _0x49e9e6=Math[_0x1577cd(0x1245)](_0x3fcf83%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x5790f8=Math[_0x1577cd(0x1245)](_0x3fcf83%(0x3e8*0x3c)/0x3e8),_0x350f04=String(_0x49e9e6)[_0x1577cd(0xf2)](0x2,'0'),_0x2680b5=String(_0x5790f8)['padStart'](0x2,'0');_0x470bef[_0x1577cd(0xc58)]=_0x1577cd(0xe36)+_0x350f04[_0x1577cd(0x1377)](0x0)+_0x1577cd(0x12c2)+_0x350f04[_0x1577cd(0x1377)](0x1)+_0x1577cd(0x1253)+_0x2680b5[_0x1577cd(0x1377)](0x0)+_0x1577cd(0x12c2)+_0x2680b5[_0x1577cd(0x1377)](0x1)+'</span>';},0x3e8);return _0x4087b0;}function _0x59f355(){for(const _0x2a1a87 in _0x2d89bb){clearInterval(_0x2d89bb[_0x2a1a87]);}_0x2d89bb={};}async function _0x9aac99(_0x5bb44c){const _0x1c6abf=_0x5a7792,_0x237e34=_0x3e7a1b['chats'][_0x3e7a1b[_0x1c6abf(0x777)]];if(!_0x237e34)return;const _0x504548=_0x237e34['history'][_0x1c6abf(0x137)](_0x34ea08=>_0x34ea08[_0x1c6abf(0x8af)]===_0x5bb44c);if(!_0x504548||![_0x1c6abf(0x1034),_0x1c6abf(0xd20)][_0x1c6abf(0xe53)](_0x504548['type'])){console[_0x1c6abf(0xc60)](_0x1c6abf(0x82d),_0x5bb44c);return;}let _0x3fdcc1='';if(_0x504548['type']===_0x1c6abf(0x1034)){let _0x1b7f54;switch(_0x504548[_0x1c6abf(0x69e)]){case _0x1c6abf(0x6a8):const _0x2a9596=_0x504548[_0x1c6abf(0xfa)]||'对方',_0x25776e=_0x1409fb(_0x237e34,_0x2a9596);_0x1b7f54='由\x20'+_0x25776e+_0x1c6abf(0x1109);break;case'rejected':_0x1b7f54=_0x1c6abf(0x119e);break;default:_0x1b7f54=_0x1c6abf(0x1318);break;}_0x3fdcc1=_0x1c6abf(0x7fa)+_0x504548[_0x1c6abf(0xec5)]+_0x1c6abf(0x7f)+Number(_0x504548[_0x1c6abf(0x12fc)])['toFixed'](0x2)+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>状态:</strong>\x20'+_0x1b7f54+_0x1c6abf(0xfe7);}else{if(_0x504548[_0x1c6abf(0xafc)]===_0x1c6abf(0xd20)){let _0x4e9176,_0x33a43a;_0x237e34[_0x1c6abf(0x1167)]?(_0x4e9176=_0x1409fb(_0x237e34,_0x504548['senderName']),_0x33a43a=_0x1409fb(_0x237e34,_0x504548[_0x1c6abf(0xce7)])):_0x504548[_0x1c6abf(0x931)]===_0x1c6abf(0xa4d)?(_0x4e9176=_0x237e34[_0x1c6abf(0xcb3)][_0x1c6abf(0x96f)]||'我',_0x33a43a=_0x237e34[_0x1c6abf(0x6fc)]):(_0x4e9176=_0x237e34[_0x1c6abf(0x6fc)],_0x33a43a=_0x237e34[_0x1c6abf(0xcb3)][_0x1c6abf(0x96f)]||'我'),_0x3fdcc1=_0x1c6abf(0x34a)+_0x4e9176+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>接收方:</strong>\x20'+_0x33a43a+_0x1c6abf(0x13c2)+_0x504548[_0x1c6abf(0xec5)]+'<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<strong>金额:</strong>\x20¥'+Number(_0x504548[_0x1c6abf(0x12fc)])[_0x1c6abf(0xc89)](0x2)+_0x1c6abf(0xfe7);}}await _0x28974b(_0x1c6abf(0x1082),_0x3fdcc1);}async function _0x2fd72f(_0x2287a0,_0x163024){const _0x228069=_0x5a7792,_0x55996e=_0x3e7a1b['chats'][_0x3e7a1b[_0x228069(0x777)]];if(!_0x55996e)return;const _0x100985=_0x55996e[_0x228069(0x830)][_0x228069(0x6a2)](_0x4812b6=>_0x4812b6[_0x228069(0x8af)]===_0x2287a0);if(_0x100985===-0x1)return;const _0xdc17cc=_0x55996e[_0x228069(0x830)][_0x100985];_0xdc17cc[_0x228069(0x69e)]=_0x163024;let _0x22a1f9;const _0x15693f=_0x55996e[_0x228069(0x1167)]?_0x55996e[_0x228069(0xcb3)][_0x228069(0x96f)]||'我':'我';_0x163024==='paid'?(_0xdc17cc[_0x228069(0xfa)]=_0x15693f,_0x22a1f9=_0x228069(0x7dc)+_0x15693f+_0x228069(0x13e1)+_0xdc17cc['senderName']+_0x228069(0x1bd)+_0x2287a0+_0x228069(0xe0a)):_0x22a1f9='[系统提示：你\x20('+_0x15693f+_0x228069(0x3c4)+_0xdc17cc[_0x228069(0x133d)]+'\x20的外卖代付请求（时间戳:\x20'+_0x2287a0+_0x228069(0x1005);const _0x38dd9c={'role':_0x228069(0x905),'content':_0x22a1f9,'timestamp':Date[_0x228069(0x2b5)](),'isHidden':!![]};_0x55996e['history'][_0x228069(0x13ee)](_0x38dd9c),await _0x4e1bbf[_0x228069(0x999)]['put'](_0x55996e),_0x4817d1(_0x3e7a1b[_0x228069(0x777)]);}let _0x42b67f={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x40ef52=null;async function _0x1c8477(){const _0x33ef60=_0x5a7792;if(!_0x3e7a1b[_0x33ef60(0x777)]||_0x42b67f[_0x33ef60(0xb30)]||_0x42b67f[_0x33ef60(0x7f0)])return;const _0x197459=_0x3e7a1b[_0x33ef60(0x999)][_0x3e7a1b[_0x33ef60(0x777)]];_0x42b67f[_0x33ef60(0xeee)]=_0x197459[_0x33ef60(0x1167)],_0x42b67f[_0x33ef60(0x7f0)]=!![],_0x42b67f['initiator']='user',_0x42b67f[_0x33ef60(0x777)]=_0x197459['id'],_0x42b67f[_0x33ef60(0xed6)]=!![];_0x197459[_0x33ef60(0x1167)]?(document[_0x33ef60(0x64f)]('outgoing-call-avatar')[_0x33ef60(0xbe8)]=_0x197459[_0x33ef60(0xcb3)][_0x33ef60(0x96a)]||_0x60cf2,document[_0x33ef60(0x64f)](_0x33ef60(0x566))[_0x33ef60(0xee5)]=_0x197459[_0x33ef60(0xcb3)][_0x33ef60(0x96f)]||'我'):(document[_0x33ef60(0x64f)](_0x33ef60(0xc2a))[_0x33ef60(0xbe8)]=_0x197459[_0x33ef60(0xcb3)][_0x33ef60(0x93)]||_0x54e358,document['getElementById'](_0x33ef60(0x566))[_0x33ef60(0xee5)]=_0x197459[_0x33ef60(0x6fc)]);document[_0x33ef60(0x49c)](_0x33ef60(0xa67))['textContent']=_0x197459[_0x33ef60(0x1167)]?_0x33ef60(0x13a5):_0x33ef60(0xd06),_0xddd8ae(_0x33ef60(0x9eb));const _0x7db098={'role':_0x33ef60(0x905),'content':_0x197459[_0x33ef60(0x1167)]?_0x33ef60(0xa3c)+(_0x197459['settings'][_0x33ef60(0x96f)]||'我')+_0x33ef60(0xffa):_0x33ef60(0x65a),'timestamp':Date['now'](),'isHidden':!![]};_0x197459[_0x33ef60(0x830)][_0x33ef60(0x13ee)](_0x7db098),await _0x4e1bbf['chats'][_0x33ef60(0x4fa)](_0x197459),await _0x20a638();}function _0xa524bc(){const _0x5bab5d=_0x5a7792,_0xab2778=_0x3e7a1b[_0x5bab5d(0x999)][_0x42b67f['activeChatId']];if(!_0xab2778)return;_0x42b67f[_0x5bab5d(0xb30)]=!![],_0x42b67f['isAwaitingResponse']=![],_0x42b67f[_0x5bab5d(0x1336)]=Date['now'](),_0x42b67f[_0x5bab5d(0x10f2)]=[];const _0x1a6c14=_0xab2778[_0x5bab5d(0x830)][_0x5bab5d(0xdf5)](-0xa);_0x42b67f[_0x5bab5d(0x98e)]=_0x1a6c14['map'](_0x2d0414=>{const _0x4572dc=_0x5bab5d,_0x1a82e8=_0x2d0414[_0x4572dc(0x931)]===_0x4572dc(0xa4d)?_0xab2778['settings'][_0x4572dc(0x96f)]||'我':_0x2d0414[_0x4572dc(0x133d)]||_0xab2778['name'];return _0x1a82e8+':\x20'+String(_0x2d0414[_0x4572dc(0x3ba)])[_0x4572dc(0x126f)](0x0,0x32)+_0x4572dc(0x3cd);})[_0x5bab5d(0xd22)]('\x0a'),_0x5d07ec(),document[_0x5bab5d(0x64f)](_0x5bab5d(0x490))[_0x5bab5d(0xc58)]='<em>'+(_0x42b67f['isGroupCall']?_0x5bab5d(0x10f6):_0x5bab5d(0xfde))+_0x5bab5d(0x5ee),_0xddd8ae('video-call-screen'),document['getElementById'](_0x5bab5d(0xa92))[_0x5bab5d(0x731)]['display']=_0x42b67f[_0x5bab5d(0xed6)]?_0x5bab5d(0xb37):'none',document[_0x5bab5d(0x64f)](_0x5bab5d(0x11a1))[_0x5bab5d(0x731)][_0x5bab5d(0x130)]=_0x42b67f['isUserParticipating']?_0x5bab5d(0x1209):_0x5bab5d(0xb37);if(_0x40ef52)clearInterval(_0x40ef52);_0x40ef52=setInterval(_0x46bd79,0x3e8),_0x46bd79(),_0x58fc54();}async function _0x56cd92(){const _0x5edb5e=_0x5a7792;if(!_0x42b67f[_0x5edb5e(0xb30)])return;const _0x57feba=Math[_0x5edb5e(0x1245)]((Date[_0x5edb5e(0x2b5)]()-_0x42b67f['startTime'])/0x3e8),_0x6e49eb=Math[_0x5edb5e(0x1245)](_0x57feba/0x3c)+'分'+_0x57feba%0x3c+'秒',_0xbd91b3=_0x5edb5e(0x194)+_0x6e49eb,_0x1a5133=_0x3e7a1b[_0x5edb5e(0x999)][_0x42b67f[_0x5edb5e(0x777)]];if(_0x1a5133){const _0x576782=[];_0x42b67f['isGroupCall']?(_0x42b67f[_0x5edb5e(0x90f)][_0x5edb5e(0x103)](_0x41417e=>_0x576782['push']({'name':_0x41417e[_0x5edb5e(0x7de)],'avatar':_0x41417e[_0x5edb5e(0x1265)]})),_0x42b67f[_0x5edb5e(0xed6)]&&_0x576782[_0x5edb5e(0x319)]({'name':_0x1a5133[_0x5edb5e(0xcb3)]['myNickname']||'我','avatar':_0x1a5133['settings'][_0x5edb5e(0x96a)]||_0x60cf2})):(_0x576782[_0x5edb5e(0x13ee)]({'name':_0x1a5133['name'],'avatar':_0x1a5133[_0x5edb5e(0xcb3)][_0x5edb5e(0x93)]||_0x54e358}),_0x576782[_0x5edb5e(0x319)]({'name':'我','avatar':_0x1a5133[_0x5edb5e(0xcb3)]['myAvatar']||_0x54e358}));const _0x5930fb={'chatId':_0x42b67f[_0x5edb5e(0x777)],'timestamp':Date['now'](),'duration':_0x57feba,'participants':_0x576782,'transcript':[..._0x42b67f['callHistory']]};await _0x4e1bbf[_0x5edb5e(0xbdb)][_0x5edb5e(0xdda)](_0x5930fb),console[_0x5edb5e(0x1081)](_0x5edb5e(0x170),_0x5930fb);let _0x70ec2d={'role':_0x42b67f[_0x5edb5e(0xc50)]===_0x5edb5e(0xa4d)?_0x5edb5e(0xa4d):_0x5edb5e(0x12c3),'content':_0xbd91b3,'timestamp':Date[_0x5edb5e(0x2b5)]()};_0x1a5133[_0x5edb5e(0x1167)]&&_0x70ec2d['role']==='assistant'&&(_0x70ec2d[_0x5edb5e(0x133d)]=_0x42b67f[_0x5edb5e(0xbd9)]||_0x1a5133['members'][0x0]?.[_0x5edb5e(0x7de)]||_0x1a5133[_0x5edb5e(0x6fc)]);_0x1a5133['history'][_0x5edb5e(0x13ee)](_0x70ec2d);const _0x985274=_0x42b67f['callHistory'][_0x5edb5e(0xb96)](_0x34ae00=>{const _0x200e0b=_0x5edb5e,_0x1c5bf0=_0x34ae00[_0x200e0b(0x931)]==='user'?_0x1a5133['settings'][_0x200e0b(0x96f)]||'我':_0x34ae00['senderName'];return _0x1c5bf0+':\x20'+_0x34ae00[_0x200e0b(0x3ba)];})[_0x5edb5e(0xd22)]('\x0a');_0x42a14c(_0x1a5133['id'],_0x985274);const _0x414661={'role':_0x5edb5e(0x905),'content':'[系统指令：视频通话刚刚结束。请你以角色的口吻，向用户主动发送一两条消息，来自然地总结这次通话的要点、确认达成的约定，或者表达你的感受。]','timestamp':Date['now']()+0x1,'isHidden':!![]};_0x1a5133[_0x5edb5e(0x830)][_0x5edb5e(0x13ee)](_0x414661),await _0x4e1bbf[_0x5edb5e(0x999)][_0x5edb5e(0x4fa)](_0x1a5133);}clearInterval(_0x40ef52),_0x40ef52=null,_0x42b67f={'isActive':![],'isAwaitingResponse':![],'isGroupCall':![],'activeChatId':null,'initiator':null,'startTime':null,'participants':[],'isUserParticipating':!![],'callHistory':[],'preCallContext':''},_0x1a5133&&(_0x59a090(_0x1a5133['id']),_0x20a638());}function _0x5d07ec(){const _0x5d8b26=_0x5a7792,_0x2203ff=document[_0x5d8b26(0x64f)](_0x5d8b26(0xdbc));_0x2203ff['innerHTML']='';const _0x14e697=_0x3e7a1b[_0x5d8b26(0x999)][_0x42b67f[_0x5d8b26(0x777)]];if(!_0x14e697)return;let _0x11e741=[];_0x42b67f['isGroupCall']?(_0x11e741=[..._0x42b67f['participants']],_0x42b67f['isUserParticipating']&&_0x11e741[_0x5d8b26(0x319)]({'id':_0x5d8b26(0xa4d),'name':_0x14e697['settings']['myNickname']||'我','avatar':_0x14e697[_0x5d8b26(0xcb3)][_0x5d8b26(0x96a)]||_0x60cf2})):_0x11e741[_0x5d8b26(0x13ee)]({'id':'ai','name':_0x14e697[_0x5d8b26(0x6fc)],'avatar':_0x14e697[_0x5d8b26(0xcb3)]['aiAvatar']||_0x54e358}),_0x11e741['forEach'](_0x9bf849=>{const _0xb07f50=_0x5d8b26,_0x412ccc=document[_0xb07f50(0x124e)](_0xb07f50(0x479));_0x412ccc[_0xb07f50(0x87d)]=_0xb07f50(0x508),_0x412ccc[_0xb07f50(0x12e1)][_0xb07f50(0x5e5)]=_0x9bf849['id'];const _0x11bc4e=_0x9bf849[_0xb07f50(0x287)]||_0x9bf849[_0xb07f50(0x6fc)];_0x412ccc['innerHTML']=_0xb07f50(0xa8d)+_0x9bf849['avatar']+_0xb07f50(0x48f)+_0x11bc4e+_0xb07f50(0x812)+_0x11bc4e+_0xb07f50(0x9df),_0x2203ff[_0xb07f50(0x99e)](_0x412ccc);});}function _0x132a18(){const _0x79fad1=_0x5a7792;if(!_0x42b67f[_0x79fad1(0xb30)]||_0x42b67f[_0x79fad1(0xed6)])return;_0x42b67f[_0x79fad1(0xed6)]=!![],_0x5d07ec(),document[_0x79fad1(0x64f)](_0x79fad1(0xa92))[_0x79fad1(0x731)][_0x79fad1(0x130)]=_0x79fad1(0xb37),document[_0x79fad1(0x64f)](_0x79fad1(0x11a1))[_0x79fad1(0x731)][_0x79fad1(0x130)]=_0x79fad1(0x1209),_0x58fc54(_0x79fad1(0x1285));}function _0x46bd79(){const _0x2fcadc=_0x5a7792;if(!_0x42b67f[_0x2fcadc(0xb30)])return;const _0x52ffee=Math[_0x2fcadc(0x1245)]((Date[_0x2fcadc(0x2b5)]()-_0x42b67f[_0x2fcadc(0x1336)])/0x3e8),_0x4d0f4b=Math[_0x2fcadc(0x1245)](_0x52ffee/0x3c),_0x4a3c61=_0x52ffee%0x3c;document[_0x2fcadc(0x64f)](_0x2fcadc(0x447))['textContent']=String(_0x4d0f4b)[_0x2fcadc(0xf2)](0x2,'0')+':'+String(_0x4a3c61)[_0x2fcadc(0xf2)](0x2,'0');}function _0x30a8ff(){const _0x41ac92=_0x5a7792,_0x2f3ac8=_0x3e7a1b[_0x41ac92(0x999)][_0x3e7a1b[_0x41ac92(0x777)]];if(!_0x2f3ac8)return;if(_0x2f3ac8[_0x41ac92(0x1167)]){const _0x3fd3e1=_0x42b67f[_0x41ac92(0xbd9)]||_0x2f3ac8[_0x41ac92(0x5d4)][0x0]?.[_0x41ac92(0x6fc)]||_0x41ac92(0x2a5);document[_0x41ac92(0x64f)](_0x41ac92(0x252))[_0x41ac92(0xbe8)]=_0x2f3ac8[_0x41ac92(0xcb3)][_0x41ac92(0x63a)]||_0x9bc039,document[_0x41ac92(0x64f)](_0x41ac92(0x840))[_0x41ac92(0xee5)]=_0x2f3ac8[_0x41ac92(0x6fc)],document[_0x41ac92(0x49c)](_0x41ac92(0x79c))['textContent']=_0x3fd3e1+_0x41ac92(0x69f);}else document[_0x41ac92(0x64f)](_0x41ac92(0x252))[_0x41ac92(0xbe8)]=_0x2f3ac8[_0x41ac92(0xcb3)][_0x41ac92(0x93)]||_0x54e358,document[_0x41ac92(0x64f)](_0x41ac92(0x840))[_0x41ac92(0xee5)]=_0x2f3ac8[_0x41ac92(0x6fc)],document[_0x41ac92(0x49c)](_0x41ac92(0x79c))[_0x41ac92(0xee5)]=_0x41ac92(0x7f7);document[_0x41ac92(0x64f)](_0x41ac92(0xe46))[_0x41ac92(0x418)][_0x41ac92(0xdda)]('visible');}function _0x1d1d7f(){const _0x3f8df4=_0x5a7792;document[_0x3f8df4(0x64f)](_0x3f8df4(0xe46))[_0x3f8df4(0x418)]['remove']('visible');}async function _0x58fc54(_0x38ea5e=null){const _0x325b36=_0x5a7792;if(!_0x42b67f['isActive'])return;const _0x5d7a3a=_0x3e7a1b['chats'][_0x42b67f[_0x325b36(0x777)]],{proxyUrl:_0x25f32a,apiKey:_0x519b66,model:_0x1360b1}=_0x3e7a1b['apiConfig'],_0x354173=document[_0x325b36(0x64f)](_0x325b36(0x490)),_0xe442b0=_0x5d7a3a['settings'][_0x325b36(0x96f)]||'我';let _0x9df597='';if(_0x5d7a3a[_0x325b36(0xcb3)]['linkedWorldBookIds']&&_0x5d7a3a[_0x325b36(0xcb3)][_0x325b36(0xde4)][_0x325b36(0x40f)]>0x0){const _0x3cc729=_0x5d7a3a['settings'][_0x325b36(0xde4)]['map'](_0x31495e=>{const _0x49ec05=_0x325b36,_0x15df32=_0x3e7a1b['worldBooks'][_0x49ec05(0x137)](_0x146124=>_0x146124['id']===_0x31495e);return _0x15df32&&_0x15df32[_0x49ec05(0x3ba)]?_0x49ec05(0x228)+_0x15df32[_0x49ec05(0x6fc)]+'\x0a'+_0x15df32['content']:'';})[_0x325b36(0x156)](Boolean)[_0x325b36(0xd22)]('');_0x3cc729&&(_0x9df597='#\x20---\x20世界书\x20(World\x20Book)\x20---\x0a#\x20【最高优先级规则：世界观设定】\x0a#\x20你【必须】将以下所有“世界书”中的设定，视为绝对的、不可动摇的背景事实。\x0a#\x20你的所有回复和行为都【绝对不能】与这些设定产生任何冲突。\x0a'+_0x3cc729+_0x325b36(0xf0f));}if(_0x38ea5e&&_0x42b67f[_0x325b36(0xed6)]){const _0x42c077=Date[_0x325b36(0x2b5)](),_0x1fac59=document['createElement'](_0x325b36(0x479));_0x1fac59['className']='call-message-bubble\x20user-speech',_0x1fac59[_0x325b36(0xee5)]=_0x38ea5e,_0x1fac59['dataset'][_0x325b36(0x8af)]=_0x42c077,_0xb407a5(_0x1fac59,()=>_0x548b73(_0x42c077)),_0x354173[_0x325b36(0x99e)](_0x1fac59),_0x354173[_0x325b36(0xed7)]=_0x354173[_0x325b36(0x1ba)],_0x42b67f['callHistory'][_0x325b36(0x13ee)]({'role':_0x325b36(0xa4d),'content':_0x38ea5e,'timestamp':_0x42c077});}let _0x2bed1c;if(_0x42b67f[_0x325b36(0xeee)]){const _0x10f220=_0x42b67f[_0x325b36(0x90f)][_0x325b36(0xb96)](_0x2aeb64=>_0x2aeb64[_0x325b36(0x6fc)]);_0x42b67f[_0x325b36(0xed6)]&&_0x10f220['unshift'](_0xe442b0),_0x2bed1c=_0x325b36(0x18b)+_0xe442b0+_0x325b36(0xb8a)+_0xe442b0+_0x325b36(0xdd1)+_0x42b67f[_0x325b36(0x98e)]+_0x325b36(0x13c3)+_0x10f220[_0x325b36(0xd22)]('、\x20')+'。\x0a\x20\x20\x20\x20\x20\x20\x20\x20**通话刚刚开始...**\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+_0x9df597+'\x20//\x20<--\x20【核心】注入世界书\x0a\x20\x20\x20\x20\x20\x20\x20\x20现在，请根据【通话前摘要】和下面的【通话实时记录】，继续进行对话。\x0a\x20\x20\x20\x20\x20\x20\x20\x20';}else{let _0x431f7a=_0x42b67f[_0x325b36(0xc50)]===_0x325b36(0xa4d)?_0x325b36(0x10c9):'用户刚刚接听了你主动发起的视频通话。';_0x2bed1c=_0x325b36(0x9e0)+_0x5d7a3a[_0x325b36(0x6fc)]+'\x20('+_0x5d7a3a['settings']['aiPersona']+')，并以【第三人称旁观视角】来描述TA在视频通话中的所有动作和语言。\x0a\x20\x20\x20\x20\x20\x20\x20\x20#\x20核心规则\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20**【【【视角铁律】】】**:\x20你的回复【绝对不能】使用第一人称“我”。必须使用第三人称，如“他”、“她”、或直接使用角色名“'+_0x5d7a3a['name']+_0x325b36(0xaa9)+_0xe442b0+_0x325b36(0x1233)+_0x5d7a3a['settings'][_0x325b36(0x1047)]+_0x325b36(0x1f7)+_0x431f7a+_0x325b36(0xb5e)+_0x42b67f['preCallContext']+_0x325b36(0x548);}const _0x303c75=[{'role':'system','content':_0x2bed1c},..._0x42b67f[_0x325b36(0x10f2)][_0x325b36(0xb96)](_0x3fa8e0=>({'role':_0x3fa8e0['role'],'content':_0x3fa8e0['content']}))];if(_0x42b67f[_0x325b36(0x10f2)][_0x325b36(0x40f)]===0x0){const _0x50ecbb=_0x42b67f[_0x325b36(0xc50)]===_0x325b36(0xa4d)?_0x325b36(0x65e):'*对方按下了接听键...*';_0x303c75[_0x325b36(0x13ee)]({'role':_0x325b36(0xa4d),'content':_0x50ecbb});}try{let _0x3bb518=_0x25f32a===GEMINI_API_URL,_0x5486f9=_0x250668(_0x1360b1,_0x519b66,_0x2bed1c,_0x303c75);const _0x29e404=_0x3bb518?await fetch(_0x5486f9[_0x325b36(0xe52)],_0x5486f9[_0x325b36(0x88a)]):await fetch(_0x25f32a+_0x325b36(0x58b),{'method':_0x325b36(0x2d1),'headers':{'Content-Type':_0x325b36(0x7fe),'Authorization':_0x325b36(0x236)+_0x519b66},'body':JSON[_0x325b36(0xe3f)]({'model':_0x1360b1,'messages':_0x303c75,'temperature':_0x3e7a1b[_0x325b36(0x11b4)]['apiTemperature']||0.8})});if(!_0x29e404['ok'])throw new Error((await _0x29e404[_0x325b36(0x6f8)]())[_0x325b36(0xc60)][_0x325b36(0x854)]);const _0xa3b2e9=await _0x29e404['json'](),_0x4df329=_0x3bb518?_0xa3b2e9[_0x325b36(0xfd3)][0x0][_0x325b36(0x3ba)][_0x325b36(0x100d)][0x0][_0x325b36(0x673)]:_0xa3b2e9[_0x325b36(0x4fe)][0x0][_0x325b36(0x854)][_0x325b36(0x3ba)],_0x334085=_0x354173['querySelector']('em');if(_0x334085)_0x334085[_0x325b36(0x1275)]();if(_0x42b67f[_0x325b36(0xeee)]){const _0x407724=_0x3755ce(_0x4df329);_0x407724[_0x325b36(0x103)](_0x5e9bab=>{const _0x3174e8=_0x325b36;if(!_0x5e9bab['name']||_0x5e9bab[_0x3174e8(0x6fc)]===_0xe442b0||!_0x5e9bab[_0x3174e8(0x788)])return;const _0x11c19e=Date[_0x3174e8(0x2b5)]()+Math['random'](),_0x3a56d7=document[_0x3174e8(0x124e)](_0x3174e8(0x479));_0x3a56d7['className']='call-message-bubble\x20ai-speech',_0x3a56d7[_0x3174e8(0xc58)]='<strong>'+_0x5e9bab[_0x3174e8(0x6fc)]+_0x3174e8(0x290)+_0x5e9bab[_0x3174e8(0x788)],_0x3a56d7[_0x3174e8(0x12e1)][_0x3174e8(0x8af)]=_0x11c19e,_0xb407a5(_0x3a56d7,()=>_0x548b73(_0x11c19e)),_0x354173[_0x3174e8(0x99e)](_0x3a56d7),_0x42b67f['callHistory'][_0x3174e8(0x13ee)]({'role':_0x3174e8(0x12c3),'content':_0x5e9bab[_0x3174e8(0x6fc)]+':\x20'+_0x5e9bab[_0x3174e8(0x788)],'timestamp':_0x11c19e});const _0x58b3ef=_0x42b67f[_0x3174e8(0x90f)]['find'](_0x127614=>_0x127614[_0x3174e8(0x6fc)]===_0x5e9bab[_0x3174e8(0x6fc)]);if(_0x58b3ef){const _0x2701f8=document[_0x3174e8(0x49c)](_0x3174e8(0xf91)+_0x58b3ef['id']+_0x3174e8(0xa30));_0x2701f8&&(_0x2701f8[_0x3174e8(0x418)][_0x3174e8(0xdda)](_0x3174e8(0x6ba)),setTimeout(()=>_0x2701f8[_0x3174e8(0x418)][_0x3174e8(0x1275)]('speaking'),0x7d0));}});}else{const _0x54c4ca=Date[_0x325b36(0x2b5)](),_0x58faf0=document[_0x325b36(0x124e)]('div');_0x58faf0[_0x325b36(0x87d)]='call-message-bubble\x20ai-speech',_0x58faf0[_0x325b36(0xee5)]=_0x4df329,_0x58faf0[_0x325b36(0x12e1)][_0x325b36(0x8af)]=_0x54c4ca,_0xb407a5(_0x58faf0,()=>_0x548b73(_0x54c4ca)),_0x354173['appendChild'](_0x58faf0),_0x42b67f[_0x325b36(0x10f2)]['push']({'role':_0x325b36(0x12c3),'content':_0x4df329,'timestamp':_0x54c4ca});const _0x40f592=document[_0x325b36(0x49c)](_0x325b36(0xcf7));_0x40f592&&(_0x40f592[_0x325b36(0x418)][_0x325b36(0xdda)](_0x325b36(0x6ba)),setTimeout(()=>_0x40f592[_0x325b36(0x418)]['remove'](_0x325b36(0x6ba)),0x7d0));}_0x354173[_0x325b36(0xed7)]=_0x354173[_0x325b36(0x1ba)];}catch(_0x172e93){const _0x967a59=document['createElement'](_0x325b36(0x479));_0x967a59['className']=_0x325b36(0xea),_0x967a59[_0x325b36(0x731)][_0x325b36(0x23c)]='#ff8a80',_0x967a59['textContent']=_0x325b36(0x10d5)+_0x172e93['message']+']',_0x354173[_0x325b36(0x99e)](_0x967a59),_0x354173[_0x325b36(0xed7)]=_0x354173['scrollHeight'],_0x42b67f['callHistory'][_0x325b36(0x13ee)]({'role':_0x325b36(0x12c3),'content':_0x325b36(0x10d5)+_0x172e93[_0x325b36(0x854)]+']'});}}function _0x28e158(_0x104770){const _0x2690f7=_0x5a7792;document[_0x2690f7(0x64f)](_0x2690f7(0x1015))[_0x2690f7(0x731)]['display']=_0x104770?_0x2690f7(0x1209):'flex',document[_0x2690f7(0x64f)](_0x2690f7(0x6b5))[_0x2690f7(0x731)][_0x2690f7(0x130)]=_0x104770?'flex':_0x2690f7(0x1209);}async function _0x2fd72f(_0xf9c9c0,_0x5c9177){const _0xa4e8bd=_0x5a7792,_0x207f2f=_0x3e7a1b[_0xa4e8bd(0x999)][_0x3e7a1b[_0xa4e8bd(0x777)]];if(!_0x207f2f)return;const _0x51488b=_0x207f2f[_0xa4e8bd(0x830)]['findIndex'](_0x3ed3a9=>_0x3ed3a9[_0xa4e8bd(0x8af)]===_0xf9c9c0);if(_0x51488b===-0x1)return;const _0x482e00=_0x207f2f[_0xa4e8bd(0x830)][_0x51488b];_0x482e00[_0xa4e8bd(0x69e)]=_0x5c9177;let _0x565f79;const _0xdf42a3=_0x207f2f['isGroup']?_0x207f2f[_0xa4e8bd(0xcb3)]['myNickname']||'我':'我';_0x5c9177==='paid'?(_0x482e00[_0xa4e8bd(0xfa)]=_0xdf42a3,_0x565f79=_0xa4e8bd(0x7dc)+_0xdf42a3+_0xa4e8bd(0x13e1)+_0x482e00[_0xa4e8bd(0x133d)]+_0xa4e8bd(0x1bd)+_0xf9c9c0+_0xa4e8bd(0xe0a)):_0x565f79=_0xa4e8bd(0x7dc)+_0xdf42a3+')\x20拒绝了\x20'+_0x482e00[_0xa4e8bd(0x133d)]+_0xa4e8bd(0xa5a)+_0xf9c9c0+_0xa4e8bd(0x1005);const _0x440404={'role':_0xa4e8bd(0x905),'content':_0x565f79,'timestamp':Date[_0xa4e8bd(0x2b5)](),'isHidden':!![]};_0x207f2f[_0xa4e8bd(0x830)][_0xa4e8bd(0x13ee)](_0x440404),await _0x4e1bbf[_0xa4e8bd(0x999)][_0xa4e8bd(0x4fa)](_0x207f2f),_0x4817d1(_0x3e7a1b['activeChatId']),_0x5c9177===_0xa4e8bd(0x6a8)&&_0x20a638();}async function _0x4601ee(_0x36aa7f,_0x1f4326){const _0x325880=_0x5a7792,_0x43224f=_0x3e7a1b[_0x325880(0x999)][_0x36aa7f];if(!_0x43224f)return;let _0x32ccdd;_0x43224f[_0x325880(0x1167)]?_0x32ccdd=_0x1409fb(_0x43224f,_0x1f4326):_0x32ccdd=_0x43224f['name'];const _0x1bfb86=document[_0x325880(0x64f)](_0x325880(0x4f8));_0x1bfb86[_0x325880(0x418)][_0x325880(0x1275)]('pat-animation'),void _0x1bfb86['offsetWidth'],_0x1bfb86['classList']['add'](_0x325880(0x43c));const _0xa844d5=await _0x41e3f8(_0x325880(0x52b)+_0x32ccdd+'”','（可选）输入后缀','',_0x325880(0x673));if(_0xa844d5===null)return;const _0x371872=_0x1409fb(_0x43224f,_0x3e7a1b[_0x325880(0x3c2)][_0x325880(0x78c)]),_0x5be3ec=_0x371872+'\x20拍了拍\x20“'+_0x32ccdd+'”\x20'+_0xa844d5[_0x325880(0x43a)](),_0x5d22ef={'role':'system','type':_0x325880(0xac1),'content':_0x5be3ec,'timestamp':Date[_0x325880(0x2b5)]()};_0x43224f[_0x325880(0x830)][_0x325880(0x13ee)](_0x5d22ef);const _0x30498e=_0x325880(0xf00)+_0x371872+_0x325880(0x1223)+_0x1f4326+'）'+_0xa844d5[_0x325880(0x43a)]()+_0x325880(0x291),_0x3748cd={'role':'system','content':_0x30498e,'timestamp':Date[_0x325880(0x2b5)]()+0x1,'isHidden':!![]};_0x43224f[_0x325880(0x830)]['push'](_0x3748cd),await _0x4e1bbf[_0x325880(0x999)][_0x325880(0x4fa)](_0x43224f),_0x3e7a1b[_0x325880(0x777)]===_0x36aa7f&&_0x3c7e84(_0x5d22ef,_0x43224f),await _0x21f6ea();}let _0x3b0920=null,_0x391510=![],_0xd84f16=new Set();function _0x548b73(_0x53bd03){const _0x1ab7b9=_0x5a7792;_0x3b0920=_0x53bd03,document[_0x1ab7b9(0x64f)](_0x1ab7b9(0xd30))['classList'][_0x1ab7b9(0xdda)](_0x1ab7b9(0x40a));}function _0x39f1ef(){const _0x781176=_0x5a7792;document[_0x781176(0x64f)](_0x781176(0xd30))[_0x781176(0x418)][_0x781176(0x1275)](_0x781176(0x40a)),_0x3b0920=null;}async function _0xef7f6a(){const _0x323975=_0x5a7792;if(!_0x3b0920)return;const _0x5daaf2=_0x3b0920,_0x41c946=_0x42b67f[_0x323975(0x10f2)][_0x323975(0x137)](_0x8975cc=>_0x8975cc[_0x323975(0x8af)]===_0x5daaf2);if(!_0x41c946)return;_0x39f1ef();let _0x24ef9e=_0x41c946[_0x323975(0x3ba)];if(_0x42b67f[_0x323975(0xeee)]&&_0x41c946['role']===_0x323975(0x12c3)){const _0x46fee5=_0x41c946[_0x323975(0x3ba)][_0x323975(0x108c)](':\x20');_0x46fee5[_0x323975(0x40f)]>0x1&&(_0x24ef9e=_0x46fee5[_0x323975(0xdf5)](0x1)[_0x323975(0xd22)](':\x20'));}const _0x4e5dbc=await _0x41e3f8(_0x323975(0x11d7),_0x323975(0x49b),_0x24ef9e,_0x323975(0x444));_0x4e5dbc!==null&&await _0x8af63a(_0x5daaf2,_0x4e5dbc);}async function _0x8af63a(_0x2c46dd,_0x5b371f){const _0x1d6679=_0x5a7792,_0x44fcb1=_0x42b67f[_0x1d6679(0x10f2)][_0x1d6679(0x137)](_0x2415ca=>_0x2415ca[_0x1d6679(0x8af)]===_0x2c46dd);if(_0x44fcb1){let _0x4d0fd9=_0x5b371f;if(_0x42b67f[_0x1d6679(0xeee)]&&_0x44fcb1['role']===_0x1d6679(0x12c3)){const _0x10915b=_0x44fcb1['content']['split'](':\x20'),_0x34faf6=_0x10915b[0x0];_0x4d0fd9=_0x34faf6+':\x20'+_0x5b371f;}_0x44fcb1[_0x1d6679(0x3ba)]=_0x4d0fd9;const _0x48e48a=document[_0x1d6679(0x49c)](_0x1d6679(0x1346)+_0x2c46dd+'\x22]');if(_0x48e48a){if(_0x42b67f[_0x1d6679(0xeee)]&&_0x44fcb1[_0x1d6679(0x931)]==='assistant'){const _0x435d29=_0x44fcb1[_0x1d6679(0x3ba)][_0x1d6679(0x108c)](':\x20'),_0x1ed559=_0x435d29[0x0];_0x48e48a[_0x1d6679(0xc58)]=_0x1d6679(0x3a6)+_0x1ed559+_0x1d6679(0x290)+_0x5b371f;}else _0x48e48a['textContent']=_0x5b371f;}}await _0x28974b('成功','通话消息已更新！');}async function _0x2e461a(){const _0x279231=_0x5a7792;if(!_0x3b0920)return;const _0x469d3b=await _0x54149f(_0x279231(0x75c),_0x279231(0xeb6),{'confirmButtonClass':'btn-danger'});if(_0x469d3b){const _0x1ad5a0=_0x3b0920;_0x39f1ef();const _0x49a334=_0x42b67f[_0x279231(0x10f2)]['findIndex'](_0x24f9ef=>_0x24f9ef[_0x279231(0x8af)]===_0x1ad5a0);_0x49a334>-0x1&&_0x42b67f[_0x279231(0x10f2)][_0x279231(0x10f9)](_0x49a334,0x1);const _0xc82b2e=document[_0x279231(0x49c)](_0x279231(0x1346)+_0x1ad5a0+'\x22]');_0xc82b2e&&_0xc82b2e[_0x279231(0x1275)]();}else _0x39f1ef();}function _0x268b16(_0x4d1ddc){const _0x229db6=_0x5a7792;_0x459f6e=_0x4d1ddc;const _0x5a9b4b=_0x3e7a1b[_0x229db6(0x999)][_0x3e7a1b[_0x229db6(0x777)]],_0x368917=_0x5a9b4b[_0x229db6(0x830)][_0x229db6(0x137)](_0x1df082=>_0x1df082[_0x229db6(0x8af)]===_0x4d1ddc);_0x368917&&(document[_0x229db6(0x64f)](_0x229db6(0x374))[_0x229db6(0xee5)]=_0x368917[_0x229db6(0x133d)]),document[_0x229db6(0x64f)](_0x229db6(0x1309))['classList'][_0x229db6(0xdda)](_0x229db6(0x40a));}function _0x5e89d0(){const _0xf220f2=_0x5a7792;document[_0xf220f2(0x64f)](_0xf220f2(0x1309))[_0xf220f2(0x418)][_0xf220f2(0x1275)](_0xf220f2(0x40a)),_0x459f6e=null;}async function _0x2c9f3b(_0x5133a2){const _0x20e765=_0x5a7792;if(!_0x459f6e)return;const _0x360952=_0x459f6e,_0x4ce6c7=_0x3e7a1b[_0x20e765(0x999)][_0x3e7a1b[_0x20e765(0x777)]],_0x5e3dd5=_0x4ce6c7[_0x20e765(0x830)]['findIndex'](_0x26e2c5=>_0x26e2c5[_0x20e765(0x8af)]===_0x360952);if(_0x5e3dd5===-0x1)return;const _0xbcf936=_0x4ce6c7['history'][_0x5e3dd5];_0xbcf936[_0x20e765(0x69e)]=_0x5133a2;let _0x3bd19b;if(_0x5133a2==='declined'){const _0x52079e={'role':_0x20e765(0xa4d),'type':_0x20e765(0xcda),'isRefund':!![],'amount':_0xbcf936[_0x20e765(0x12fc)],'note':'已拒收对方转账','timestamp':Date['now']()};_0x4ce6c7['history'][_0x20e765(0x13ee)](_0x52079e),_0x3bd19b='[系统提示：你拒绝并退还了“'+_0xbcf936[_0x20e765(0x133d)]+_0x20e765(0x36c);}else _0x3bd19b=_0x20e765(0x1118)+_0xbcf936['senderName']+_0x20e765(0x36c);const _0xbe6f7d={'role':_0x20e765(0x905),'content':_0x3bd19b,'timestamp':Date[_0x20e765(0x2b5)]()+0x1,'isHidden':!![]};_0x4ce6c7[_0x20e765(0x830)][_0x20e765(0x13ee)](_0xbe6f7d),await _0x4e1bbf[_0x20e765(0x999)][_0x20e765(0x4fa)](_0x4ce6c7),_0x5e89d0(),_0x4817d1(_0x3e7a1b[_0x20e765(0x777)]),_0x21f6ea();}function _0x3ead3d(_0x4949de){const _0x63599b=_0x5a7792;_0x46c8df=null;if(_0x4949de){const _0x8825f7=_0x4949de[_0x63599b(0x49c)](_0x63599b(0x272));_0x8825f7&&(_0x8825f7['placeholder']=_0x63599b(0x1165));}}async function _0x5bff46(){const _0x4eb382=_0x5a7792,_0x266a71=document[_0x4eb382(0x64f)]('memories-list');_0x266a71[_0x4eb382(0xc58)]='';const _0x214625=await _0x4e1bbf[_0x4eb382(0x1125)][_0x4eb382(0xe1d)]('timestamp')[_0x4eb382(0x2f4)]()[_0x4eb382(0x78f)]();if(_0x214625['length']===0x0){_0x266a71[_0x4eb382(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里还没有共同的回忆和约定呢~</p>';return;}_0x214625[_0x4eb382(0x102f)]((_0xec73e6,_0x5417e0)=>{const _0x1235c5=_0x4eb382,_0x45d266=_0xec73e6['type']==='countdown'&&_0xec73e6[_0x1235c5(0xb73)]>Date[_0x1235c5(0x2b5)](),_0x3e0d7c=_0x5417e0[_0x1235c5(0xafc)]==='countdown'&&_0x5417e0[_0x1235c5(0xb73)]>Date[_0x1235c5(0x2b5)]();if(_0x45d266&&!_0x3e0d7c)return-0x1;if(!_0x45d266&&_0x3e0d7c)return 0x1;if(_0x45d266&&_0x3e0d7c)return _0xec73e6[_0x1235c5(0xb73)]-_0x5417e0[_0x1235c5(0xb73)];return 0x0;}),_0x214625['forEach'](_0x51a7a4=>{const _0xb96b6a=_0x4eb382;let _0x30e549;_0x51a7a4[_0xb96b6a(0xafc)]===_0xb96b6a(0x110)&&_0x51a7a4[_0xb96b6a(0xb73)]>Date[_0xb96b6a(0x2b5)]()?_0x30e549=_0x5216ca(_0x51a7a4):_0x30e549=_0x4f3fe5(_0x51a7a4),_0x266a71['appendChild'](_0x30e549);}),_0x4dff8c();}function _0x4f3fe5(_0x39c3d2){const _0x28ee47=_0x5a7792,_0x2a2429=document[_0x28ee47(0x124e)]('div');_0x2a2429['className']=_0x28ee47(0x69c);const _0x43c0d4=new Date(_0x39c3d2[_0x28ee47(0x8af)]),_0x54b923=_0x43c0d4['getFullYear']()+'-'+String(_0x43c0d4[_0x28ee47(0x38b)]()+0x1)[_0x28ee47(0xf2)](0x2,'0')+'-'+String(_0x43c0d4['getDate']())[_0x28ee47(0xf2)](0x2,'0')+'\x20'+String(_0x43c0d4[_0x28ee47(0xdb)]())['padStart'](0x2,'0')+':'+String(_0x43c0d4[_0x28ee47(0x14f)]())[_0x28ee47(0xf2)](0x2,'0');let _0x6b382d,_0x2f78a8;if(_0x39c3d2[_0x28ee47(0xafc)]===_0x28ee47(0x110)&&_0x39c3d2[_0x28ee47(0xb73)])_0x6b382d=_0x28ee47(0x8c2)+_0x39c3d2[_0x28ee47(0x9af)],_0x2f78a8=_0x422b3c('在\x20'+new Date(_0x39c3d2[_0x28ee47(0xb73)])[_0x28ee47(0x2b4)]()+_0x28ee47(0xe79))[_0x28ee47(0x137f)](/\n/g,_0x28ee47(0x917));else{let _0x4b5286='我们的回忆';if(_0x39c3d2[_0x28ee47(0x1188)]){const _0x9e0629=_0x3e7a1b[_0x28ee47(0x999)][_0x39c3d2[_0x28ee47(0x1188)]];_0x9e0629?_0x4b5286=_0x9e0629[_0x28ee47(0x6fc)]:_0x4b5286=_0x39c3d2[_0x28ee47(0x5b7)]||_0x28ee47(0x99f);}else _0x39c3d2[_0x28ee47(0x5b7)]&&(_0x4b5286=_0x39c3d2['authorName']);_0x6b382d=_0x4b5286+'\x20的日记',_0x2f78a8=_0x422b3c(_0x39c3d2[_0x28ee47(0x9af)]);}return _0x2a2429[_0x28ee47(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22date\x22>'+_0x54b923+_0x28ee47(0x5eb)+_0x6b382d+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22>'+_0x2f78a8+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0xb407a5(_0x2a2429,async()=>{const _0x5e8dce=_0x28ee47,_0x27c3b9=await _0x54149f(_0x5e8dce(0x104c),_0x5e8dce(0x30d),{'confirmButtonClass':_0x5e8dce(0xeed)});_0x27c3b9&&(await _0x4e1bbf[_0x5e8dce(0x1125)][_0x5e8dce(0x3aa)](_0x39c3d2['id']),_0x5bff46());}),_0x2a2429;}function _0x5216ca(_0x4de2d5){const _0xf4baa3=_0x5a7792,_0x672a64=document['createElement']('div');_0x672a64[_0xf4baa3(0x87d)]=_0xf4baa3(0x665);const _0x5dcf6b=new Date(_0x4de2d5[_0xf4baa3(0xb73)]),_0x366153=_0x5dcf6b['toLocaleString']('zh-CN',{'dateStyle':'full','timeStyle':'short'});return _0x672a64['innerHTML']=_0xf4baa3(0x1046)+_0x4de2d5[_0xf4baa3(0x9af)]+_0xf4baa3(0xb99)+_0x4de2d5[_0xf4baa3(0xb73)]+'\x22>--天--时--分--秒</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22target-date\x22>目标时间:\x20'+_0x366153+_0xf4baa3(0x897),_0xb407a5(_0x672a64,async()=>{const _0x435565=_0xf4baa3,_0x11dfe5=await _0x54149f(_0x435565(0xd15),_0x435565(0xe32),{'confirmButtonClass':_0x435565(0xeed)});_0x11dfe5&&(await _0x4e1bbf[_0x435565(0x1125)][_0x435565(0x3aa)](_0x4de2d5['id']),_0x5bff46());}),_0x672a64;}let _0x4b694a=[];function _0x4dff8c(){const _0x11b4ef=_0x5a7792;_0x4b694a[_0x11b4ef(0x103)](_0x47b0e6=>clearInterval(_0x47b0e6)),_0x4b694a=[],document['querySelectorAll'](_0x11b4ef(0xb1c))[_0x11b4ef(0x103)](_0x5310bb=>{const _0x295556=_0x11b4ef,_0x304c98=parseInt(_0x5310bb[_0x295556(0x12e1)][_0x295556(0xb73)]);let _0x4259ab;const _0x4a8232=()=>{const _0x5ebee0=_0x295556,_0x4b4e62=Date[_0x5ebee0(0x2b5)](),_0x36fa6c=_0x304c98-_0x4b4e62;if(_0x36fa6c<0x0){_0x5310bb['textContent']='约定达成！',clearInterval(_0x4259ab),setTimeout(()=>_0x5bff46(),0x7d0);return;}const _0x4242fe=Math[_0x5ebee0(0x1245)](_0x36fa6c/(0x3e8*0x3c*0x3c*0x18)),_0x28267d=Math[_0x5ebee0(0x1245)](_0x36fa6c%(0x3e8*0x3c*0x3c*0x18)/(0x3e8*0x3c*0x3c)),_0x42266d=Math[_0x5ebee0(0x1245)](_0x36fa6c%(0x3e8*0x3c*0x3c)/(0x3e8*0x3c)),_0x590303=Math[_0x5ebee0(0x1245)](_0x36fa6c%(0x3e8*0x3c)/0x3e8);_0x5310bb['textContent']=_0x4242fe+'天\x20'+_0x28267d+'时\x20'+_0x42266d+'分\x20'+_0x590303+'秒';};_0x4a8232(),_0x4259ab=setInterval(_0x4a8232,0x3e8),_0x4b694a[_0x295556(0x13ee)](_0x4259ab);});}async function _0x4a68ca(_0x47d727){const _0x213239=_0x5a7792,_0x10b967=_0x3e7a1b[_0x213239(0x999)][_0x47d727];if(!_0x10b967)return;await _0x28974b(_0x213239(0x289),_0x213239(0xdce)+_0x10b967[_0x213239(0x6fc)]+_0x213239(0x1073));const {proxyUrl:_0x1ca6c3,apiKey:_0x5dce77,model:_0x320411}=_0x3e7a1b[_0x213239(0xec0)];if(!_0x1ca6c3||!_0x5dce77||!_0x320411){await _0x28974b('配置错误',_0x213239(0xb7b));return;}const _0x268256=_0x10b967[_0x213239(0x830)][_0x213239(0xdf5)](-0x5)[_0x213239(0xb96)](_0x1dbeb9=>{const _0x455d7f=_0x213239,_0x15e90e=_0x1dbeb9[_0x455d7f(0x931)]===_0x455d7f(0xa4d)?_0x10b967[_0x455d7f(0xcb3)][_0x455d7f(0x96f)]||'我':_0x1dbeb9['senderName']||_0x10b967[_0x455d7f(0x6fc)];return _0x15e90e+':\x20'+String(_0x1dbeb9['content'])[_0x455d7f(0x126f)](0x0,0x32)+_0x455d7f(0x3cd);})[_0x213239(0xd22)]('\x0a');let _0x2d1ab6='';if(_0x10b967[_0x213239(0xcb3)]['linkedWorldBookIds']&&_0x10b967['settings'][_0x213239(0xde4)][_0x213239(0x40f)]>0x0){const _0x56c1ce=_0x10b967[_0x213239(0xcb3)][_0x213239(0xde4)][_0x213239(0xb96)](_0x3338dd=>{const _0x5e0f69=_0x213239,_0x1f9138=_0x3e7a1b['worldBooks'][_0x5e0f69(0x137)](_0x50b777=>_0x50b777['id']===_0x3338dd);if(!_0x1f9138||!Array[_0x5e0f69(0x97e)](_0x1f9138[_0x5e0f69(0x3ba)]))return'';const _0x48c3d8=_0x1f9138['content'][_0x5e0f69(0xb96)](_0x42ba41=>{const _0x530be4=_0x5e0f69;let _0x422cf6='\x0a###\x20条目:\x20'+(_0x42ba41['comment']||'无备注')+'\x0a';return _0x42ba41['keys'][_0x530be4(0x40f)]>0x0&&(_0x422cf6+=_0x530be4(0x1202)+_0x42ba41[_0x530be4(0xc30)][_0x530be4(0xd22)](',\x20')+'\x0a'),_0x422cf6+=_0x530be4(0x188)+_0x42ba41[_0x530be4(0x3ba)],_0x422cf6;})[_0x5e0f69(0xd22)]('\x0a');return _0x48c3d8?_0x5e0f69(0x228)+_0x1f9138[_0x5e0f69(0x6fc)]+'\x0a'+_0x48c3d8:'';})[_0x213239(0x156)](Boolean)['join']('');_0x56c1ce&&(_0x2d1ab6=_0x213239(0x1a0)+_0x56c1ce+'\x0a');}const _0x5a0ba2=_0x213239(0x914)+_0x10b967[_0x213239(0x6fc)]+_0x213239(0x77e)+_0x10b967['settings'][_0x213239(0xbe5)]+_0x213239(0xeb3)+_0x2d1ab6+_0x213239(0xb75)+_0x268256+_0x213239(0x656);try{const _0x5b77d0=[{'role':'system','content':_0x5a0ba2},{'role':'user','content':_0x213239(0xf7a)}];let _0x2e3764=_0x1ca6c3===GEMINI_API_URL,_0x301672=_0x250668(_0x320411,_0x5dce77,_0x5a0ba2,_0x5b77d0);const _0x558c4b=_0x2e3764?await fetch(_0x301672[_0x213239(0xe52)],_0x301672[_0x213239(0x88a)]):await fetch(_0x1ca6c3+_0x213239(0x58b),{'method':'POST','headers':{'Content-Type':_0x213239(0x7fe),'Authorization':_0x213239(0x236)+_0x5dce77},'body':JSON[_0x213239(0xe3f)]({'model':_0x320411,'messages':_0x5b77d0,'temperature':_0x3e7a1b[_0x213239(0x11b4)]['apiTemperature']||0.9})});if(!_0x558c4b['ok']){const _0x36fde8=await _0x558c4b[_0x213239(0x6f8)]();throw new Error(_0x213239(0xfdb)+_0x558c4b[_0x213239(0x69e)]+_0x213239(0xc78)+_0x36fde8[_0x213239(0xc60)][_0x213239(0x854)]);}const _0x56a955=await _0x558c4b['json']();let _0x516581=_0x2e3764?_0x56a955[_0x213239(0xfd3)][0x0][_0x213239(0x3ba)][_0x213239(0x100d)][0x0][_0x213239(0x673)]:_0x56a955[_0x213239(0x4fe)][0x0][_0x213239(0x854)][_0x213239(0x3ba)];_0x516581=_0x516581[_0x213239(0x137f)](/^```json\s*/,'')[_0x213239(0x137f)](/```$/,'');const _0x4e9743=_0x516581[_0x213239(0x43a)](),_0xce47af=JSON[_0x213239(0x1214)](_0x4e9743);_0xce47af['decision']===_0x213239(0xd93)&&_0xce47af[_0x213239(0x35a)]?(_0x10b967[_0x213239(0x55f)][_0x213239(0x69e)]=_0x213239(0x839),_0x10b967[_0x213239(0x55f)]['applicationReason']=_0xce47af['reason'],_0x3e7a1b[_0x213239(0x999)][_0x47d727]=_0x10b967,_0x21f6ea(),await _0x28974b(_0x213239(0xdc2),'“'+_0x10b967[_0x213239(0x6fc)]+_0x213239(0x41f))):(await _0x28974b('AI决策','“'+_0x10b967[_0x213239(0x6fc)]+_0x213239(0x11dd)),_0x10b967['relationship'][_0x213239(0x69e)]=_0x213239(0x770),_0x10b967['relationship']['blockedTimestamp']=Date[_0x213239(0x2b5)]());}catch(_0x5eab02){await _0x28974b('执行出错','为“'+_0x10b967[_0x213239(0x6fc)]+_0x213239(0x3fe)+_0x5eab02[_0x213239(0x854)]+_0x213239(0x348)),_0x10b967['relationship'][_0x213239(0x69e)]=_0x213239(0x770),_0x10b967[_0x213239(0x55f)][_0x213239(0x338)]=Date[_0x213239(0x2b5)]();}finally{await _0x4e1bbf[_0x213239(0x999)][_0x213239(0x4fa)](_0x10b967),_0x4817d1(_0x47d727);}}function _0x42e362(){const _0x1b83c6=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x28f759=_0x3e7a1b[_0x1b83c6(0x999)][_0x3e7a1b[_0x1b83c6(0x777)]];_0x28f759[_0x1b83c6(0x1167)]?_0x5b44a4():document[_0x1b83c6(0x64f)](_0x1b83c6(0x1000))[_0x1b83c6(0x418)][_0x1b83c6(0xdda)](_0x1b83c6(0x40a));}function _0x5b44a4(){const _0xf0c9ea=_0x5a7792,_0x1f4c58=document[_0xf0c9ea(0x64f)](_0xf0c9ea(0xd44)),_0x1a51b4=_0x3e7a1b['chats'][_0x3e7a1b['activeChatId']];document[_0xf0c9ea(0x64f)](_0xf0c9ea(0x9c1))[_0xf0c9ea(0xbed)]='',document[_0xf0c9ea(0x64f)](_0xf0c9ea(0x527))[_0xf0c9ea(0xbed)]='',document[_0xf0c9ea(0x64f)](_0xf0c9ea(0xc6c))[_0xf0c9ea(0xbed)]='',document['getElementById']('rp-direct-amount')[_0xf0c9ea(0xbed)]='',document['getElementById'](_0xf0c9ea(0x1054))['value']='',document[_0xf0c9ea(0x64f)](_0xf0c9ea(0x13d0))[_0xf0c9ea(0xee5)]=_0xf0c9ea(0xf59),document[_0xf0c9ea(0x64f)](_0xf0c9ea(0xd5f))[_0xf0c9ea(0xee5)]=_0xf0c9ea(0xf59);const _0x18852a=document[_0xf0c9ea(0x64f)](_0xf0c9ea(0x61d));_0x18852a['innerHTML']='',_0x1a51b4[_0xf0c9ea(0x5d4)][_0xf0c9ea(0x103)](_0x947676=>{const _0x1c4eb5=_0xf0c9ea,_0x5ac0ed=document[_0x1c4eb5(0x124e)](_0x1c4eb5(0x1176));_0x5ac0ed[_0x1c4eb5(0xbed)]=_0x947676['originalName'],_0x5ac0ed[_0x1c4eb5(0xee5)]=_0x947676[_0x1c4eb5(0x287)],_0x18852a[_0x1c4eb5(0x99e)](_0x5ac0ed);}),document[_0xf0c9ea(0x64f)](_0xf0c9ea(0x240))[_0xf0c9ea(0x1080)](),_0x1f4c58[_0xf0c9ea(0x418)][_0xf0c9ea(0xdda)](_0xf0c9ea(0x40a));}async function _0x3e2365(){const _0x393eb5=_0x5a7792,_0x4b3e18=_0x3e7a1b[_0x393eb5(0x999)][_0x3e7a1b['activeChatId']],_0x5bc616=parseFloat(document['getElementById'](_0x393eb5(0x9c1))[_0x393eb5(0xbed)]),_0x2d1dad=parseInt(document[_0x393eb5(0x64f)](_0x393eb5(0x527))[_0x393eb5(0xbed)]),_0x4d8509=document[_0x393eb5(0x64f)](_0x393eb5(0xc6c))[_0x393eb5(0xbed)][_0x393eb5(0x43a)]();if(isNaN(_0x5bc616)||_0x5bc616<=0x0){alert(_0x393eb5(0x9c));return;}if(isNaN(_0x2d1dad)||_0x2d1dad<=0x0){alert(_0x393eb5(0x1225));return;}if(_0x5bc616/_0x2d1dad<0.01){alert(_0x393eb5(0x9bc));return;}const _0x322595=_0x4b3e18[_0x393eb5(0xcb3)][_0x393eb5(0x96f)]||'我',_0x53d211={'role':_0x393eb5(0xa4d),'senderName':_0x322595,'type':_0x393eb5(0xa5d),'packetType':_0x393eb5(0xa1c),'timestamp':Date['now'](),'totalAmount':_0x5bc616,'count':_0x2d1dad,'greeting':_0x4d8509||_0x393eb5(0xe11),'claimedBy':{},'isFullyClaimed':![]};_0x4b3e18[_0x393eb5(0x830)][_0x393eb5(0x13ee)](_0x53d211),await _0x4e1bbf[_0x393eb5(0x999)]['put'](_0x4b3e18),_0x3c7e84(_0x53d211,_0x4b3e18),_0x21f6ea(),document[_0x393eb5(0x64f)](_0x393eb5(0xd44))[_0x393eb5(0x418)][_0x393eb5(0x1275)](_0x393eb5(0x40a));}async function _0x1950ee(){const _0x31bc42=_0x5a7792,_0x44c3be=_0x3e7a1b[_0x31bc42(0x999)][_0x3e7a1b[_0x31bc42(0x777)]],_0x185619=parseFloat(document['getElementById'](_0x31bc42(0x985))[_0x31bc42(0xbed)]),_0x5691bc=document[_0x31bc42(0x64f)](_0x31bc42(0x61d))[_0x31bc42(0xbed)],_0x2dbfa3=document[_0x31bc42(0x64f)](_0x31bc42(0x1054))[_0x31bc42(0xbed)][_0x31bc42(0x43a)]();if(isNaN(_0x185619)||_0x185619<=0x0){alert(_0x31bc42(0x1357));return;}if(!_0x5691bc){alert('请选择一个接收人！');return;}const _0x475ec1=_0x44c3be[_0x31bc42(0xcb3)][_0x31bc42(0x96f)]||'我',_0x1e5295={'role':_0x31bc42(0xa4d),'senderName':_0x475ec1,'type':_0x31bc42(0xa5d),'packetType':_0x31bc42(0xc33),'timestamp':Date[_0x31bc42(0x2b5)](),'totalAmount':_0x185619,'count':0x1,'greeting':_0x2dbfa3||_0x31bc42(0xaa0),'receiverName':_0x5691bc,'claimedBy':{},'isFullyClaimed':![]};_0x44c3be[_0x31bc42(0x830)][_0x31bc42(0x13ee)](_0x1e5295),await _0x4e1bbf[_0x31bc42(0x999)][_0x31bc42(0x4fa)](_0x44c3be),_0x3c7e84(_0x1e5295,_0x44c3be),_0x21f6ea(),document[_0x31bc42(0x64f)](_0x31bc42(0xd44))[_0x31bc42(0x418)][_0x31bc42(0x1275)](_0x31bc42(0x40a));}async function _0x326b59(_0x29b0a6){const _0x16285e=_0x5a7792,_0x102f6a=_0x3e7a1b['activeChatId'],_0x125dc6=await _0x4e1bbf[_0x16285e(0x999)][_0x16285e(0x11fc)](_0x102f6a);if(!_0x125dc6)return;_0x3e7a1b[_0x16285e(0x999)][_0x102f6a]=_0x125dc6;const _0x2f2fad=_0x125dc6[_0x16285e(0x830)][_0x16285e(0x137)](_0x9b9253=>_0x9b9253[_0x16285e(0x8af)]===_0x29b0a6);if(!_0x2f2fad)return;const _0x341191=_0x3e7a1b['qzoneSettings'][_0x16285e(0x78c)]||_0x16285e(0x1028),_0x81bf49=_0x2f2fad[_0x16285e(0x19f)]&&_0x2f2fad[_0x16285e(0x19f)][_0x341191];if(_0x2f2fad[_0x16285e(0x13d4)]===_0x16285e(0xc33)&&_0x2f2fad[_0x16285e(0xc12)]!==_0x341191&&Object[_0x16285e(0xc30)](_0x2f2fad[_0x16285e(0x19f)])[_0x16285e(0x40f)]>0x0||_0x2f2fad[_0x16285e(0xa62)]||_0x81bf49){_0xa569d2(_0x2f2fad);return;}const _0x2eb9fb=await _0x25fbcd(_0x2f2fad);_0x2eb9fb!==null&&(await _0x4817d1(_0x102f6a),await _0x28974b(_0x16285e(0xa68),_0x16285e(0xf90)+_0x1409fb(_0x125dc6,_0x2f2fad['senderName'])+'\x20的红包，金额为\x20'+_0x2eb9fb['toFixed'](0x2)+_0x16285e(0x892)));const _0x13dd73=_0x3e7a1b[_0x16285e(0x999)][_0x102f6a]['history']['find'](_0x281ed4=>_0x281ed4[_0x16285e(0x8af)]===_0x29b0a6);_0x13dd73&&_0xa569d2(_0x13dd73);}async function _0x25fbcd(_0x6f1eea){const _0x3ecff1=_0x5a7792,_0x256f2d=_0x3e7a1b['chats'][_0x3e7a1b['activeChatId']];let _0x25302b=Date['now']();const _0x235e31=_0x3e7a1b[_0x3ecff1(0x3c2)][_0x3ecff1(0x78c)]||'{{user}}',_0x209b54=_0x6f1eea[_0x3ecff1(0xe7c)]-Object['keys'](_0x6f1eea['claimedBy']||{})[_0x3ecff1(0x40f)];if(_0x209b54<=0x0)return _0x6f1eea[_0x3ecff1(0xa62)]=!![],await _0x4e1bbf[_0x3ecff1(0x999)][_0x3ecff1(0x4fa)](_0x256f2d),await _0x28974b(_0x3ecff1(0x7a8),_0x3ecff1(0xfd4)),null;let _0x261027=0x0;const _0x3628b9=_0x6f1eea[_0x3ecff1(0xef)]-Object[_0x3ecff1(0xd6d)](_0x6f1eea[_0x3ecff1(0x19f)]||{})[_0x3ecff1(0x213)]((_0x450cf5,_0x5b204d)=>_0x450cf5+_0x5b204d,0x0);if(_0x6f1eea[_0x3ecff1(0x13d4)]===_0x3ecff1(0xa1c)){if(_0x209b54===0x1)_0x261027=_0x3628b9;else{const _0x763f98=0.01,_0x325acf=_0x3628b9-(_0x209b54-0x1)*_0x763f98;_0x261027=Math[_0x3ecff1(0x95f)]()*(_0x325acf-_0x763f98)+_0x763f98;}}else _0x261027=_0x6f1eea[_0x3ecff1(0xef)];_0x261027=parseFloat(_0x261027[_0x3ecff1(0xc89)](0x2));if(!_0x6f1eea['claimedBy'])_0x6f1eea[_0x3ecff1(0x19f)]={};_0x6f1eea[_0x3ecff1(0x19f)][_0x235e31]=_0x261027;const _0x3d25a8=Object[_0x3ecff1(0xc30)](_0x6f1eea[_0x3ecff1(0x19f)])['length']>=_0x6f1eea['count'];_0x3d25a8&&(_0x6f1eea[_0x3ecff1(0xa62)]=!![]);const _0x27c59f=_0x1409fb(_0x256f2d,_0x235e31),_0x4f6e23=_0x1409fb(_0x256f2d,_0x6f1eea['senderName']),_0x56fee2={'role':_0x3ecff1(0x905),'type':_0x3ecff1(0xac1),'content':'你领取了\x20'+_0x4f6e23+_0x3ecff1(0x2b1),'timestamp':_0x25302b++};_0x256f2d['history'][_0x3ecff1(0x13ee)](_0x56fee2);let _0x41473f;if(_0x3d25a8){const _0x584188={'role':_0x3ecff1(0x905),'type':_0x3ecff1(0xac1),'content':_0x4f6e23+_0x3ecff1(0xcf4),'timestamp':_0x25302b++};_0x256f2d[_0x3ecff1(0x830)][_0x3ecff1(0x13ee)](_0x584188);let _0x1d38eb={'name':'','amount':-0x1};_0x6f1eea[_0x3ecff1(0x13d4)]===_0x3ecff1(0xa1c)&&_0x6f1eea[_0x3ecff1(0xe7c)]>0x1&&Object[_0x3ecff1(0x1052)](_0x6f1eea[_0x3ecff1(0x19f)])[_0x3ecff1(0x103)](([_0x2ba190,_0x4d3a63])=>{const _0x1cb3ff=_0x3ecff1;_0x4d3a63>_0x1d38eb[_0x1cb3ff(0x12fc)]&&(_0x1d38eb={'name':_0x2ba190,'amount':_0x4d3a63});});const _0x34333d=_0x1d38eb[_0x3ecff1(0x6fc)]?_0x1409fb(_0x256f2d,_0x1d38eb[_0x3ecff1(0x6fc)]):'无';_0x41473f=_0x3ecff1(0xa3c)+_0x27c59f+')\x20领取了最后一个红包。红包已被领完，手气王是\x20'+_0x34333d+_0x3ecff1(0xc62);}else _0x41473f=_0x3ecff1(0xa3c)+_0x27c59f+_0x3ecff1(0x62f)+_0x6f1eea['timestamp']+')。红包还未领完，你现在可以使用\x20\x27open_red_packet\x27\x20指令来尝试领取。]';const _0x2fd091={'role':_0x3ecff1(0x905),'content':_0x41473f,'timestamp':_0x25302b++,'isHidden':!![]};return _0x256f2d[_0x3ecff1(0x830)][_0x3ecff1(0x13ee)](_0x2fd091),await _0x4e1bbf[_0x3ecff1(0x999)][_0x3ecff1(0x4fa)](_0x256f2d),_0x261027;}async function _0xa569d2(_0x32d4ab){const _0x46c2df=_0x5a7792;if(!_0x32d4ab){console[_0x46c2df(0xc60)](_0x46c2df(0x676));return;}const _0x243c45=_0x3e7a1b[_0x46c2df(0x999)][_0x3e7a1b[_0x46c2df(0x777)]];if(!_0x243c45)return;const _0x163374=document[_0x46c2df(0x64f)](_0x46c2df(0xdad)),_0x2fdea5=_0x3e7a1b[_0x46c2df(0x3c2)][_0x46c2df(0x78c)]||_0x46c2df(0x1028),_0x2fadd5=_0x1409fb(_0x243c45,_0x32d4ab[_0x46c2df(0x133d)]);document['getElementById'](_0x46c2df(0xfb7))[_0x46c2df(0xee5)]=_0x2fadd5,document[_0x46c2df(0x64f)](_0x46c2df(0xdd6))['textContent']=_0x32d4ab[_0x46c2df(0xdf9)]||_0x46c2df(0xe11);const _0x7dd58b=document[_0x46c2df(0x64f)]('rp-details-my-amount');_0x32d4ab['claimedBy']&&_0x32d4ab[_0x46c2df(0x19f)][_0x2fdea5]?(_0x7dd58b['querySelector'](_0x46c2df(0x6ad))[_0x46c2df(0xee5)]=_0x32d4ab['claimedBy'][_0x2fdea5][_0x46c2df(0xc89)](0x2),_0x7dd58b['style'][_0x46c2df(0x130)]=_0x46c2df(0xb37)):_0x7dd58b[_0x46c2df(0x731)][_0x46c2df(0x130)]=_0x46c2df(0x1209);const _0x10bb2c=Object[_0x46c2df(0xc30)](_0x32d4ab[_0x46c2df(0x19f)]||{})[_0x46c2df(0x40f)],_0x55fb28=Object['values'](_0x32d4ab[_0x46c2df(0x19f)]||{})[_0x46c2df(0x213)]((_0x3f3600,_0x50636b)=>_0x3f3600+_0x50636b,0x0);let _0x334e2f=_0x10bb2c+'/'+_0x32d4ab[_0x46c2df(0xe7c)]+_0x46c2df(0x120b)+_0x55fb28[_0x46c2df(0xc89)](0x2)+'/'+_0x32d4ab[_0x46c2df(0xef)]['toFixed'](0x2)+'元。';if(!_0x32d4ab[_0x46c2df(0xa62)]&&_0x10bb2c<_0x32d4ab[_0x46c2df(0xe7c)]){const _0x23b82c=Math[_0x46c2df(0x1245)]((_0x32d4ab[_0x46c2df(0x8af)]+0x18*0x3c*0x3c*0x3e8-Date['now']())/(0x3e8*0x3c*0x3c));if(_0x23b82c>0x0)_0x334e2f+=_0x46c2df(0xb27)+_0x23b82c+_0x46c2df(0x11c5);}document[_0x46c2df(0x64f)]('rp-details-summary')[_0x46c2df(0xee5)]=_0x334e2f;const _0x4bf7d6=document['getElementById'](_0x46c2df(0x745));_0x4bf7d6[_0x46c2df(0xc58)]='';const _0x35eb0d=Object[_0x46c2df(0x1052)](_0x32d4ab[_0x46c2df(0x19f)]||{});let _0x49fe3a={'name':'','amount':-0x1};_0x32d4ab['packetType']===_0x46c2df(0xa1c)&&_0x32d4ab[_0x46c2df(0xa62)]&&_0x35eb0d[_0x46c2df(0x40f)]>0x1&&_0x35eb0d[_0x46c2df(0x103)](([_0x53b694,_0x14e470])=>{const _0x56fc5e=_0x46c2df;_0x14e470>_0x49fe3a[_0x56fc5e(0x12fc)]&&(_0x49fe3a={'name':_0x53b694,'amount':_0x14e470});}),_0x35eb0d[_0x46c2df(0x102f)]((_0x4ec263,_0x44a4eb)=>_0x44a4eb[0x1]-_0x4ec263[0x1]),_0x35eb0d['forEach'](([_0x3c2d45,_0x2d1bf6])=>{const _0xbdff5e=_0x46c2df,_0x4618e7=document[_0xbdff5e(0x124e)](_0xbdff5e(0x479));_0x4618e7[_0xbdff5e(0x87d)]=_0xbdff5e(0x280);let _0x5085a7='';_0x49fe3a[_0xbdff5e(0x6fc)]&&_0x3c2d45===_0x49fe3a[_0xbdff5e(0x6fc)]&&(_0x5085a7=_0xbdff5e(0x8a7));const _0x5519bd=_0x1409fb(_0x243c45,_0x3c2d45);_0x4618e7[_0xbdff5e(0xc58)]=_0xbdff5e(0xee9)+_0x5519bd+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>'+_0x2d1bf6[_0xbdff5e(0xc89)](0x2)+_0xbdff5e(0x139f)+_0x5085a7+_0xbdff5e(0x783),_0x4bf7d6[_0xbdff5e(0x99e)](_0x4618e7);}),_0x163374[_0x46c2df(0x418)][_0x46c2df(0xdda)](_0x46c2df(0x40a));}document[_0x5a7792(0x64f)](_0x5a7792(0x923))[_0x5a7792(0xf72)](_0x5a7792(0x1080),()=>{const _0x171054=_0x5a7792;document[_0x171054(0x64f)](_0x171054(0xdad))['classList'][_0x171054(0x1275)](_0x171054(0x40a));}),window[_0x5a7792(0x1114)]=_0x326b59;function _0x3fd58b(){const _0x47f7a0=_0x5a7792,_0x50aeb4=document['getElementById'](_0x47f7a0(0x103a));document[_0x47f7a0(0x64f)](_0x47f7a0(0x10a7))[_0x47f7a0(0xbed)]='';const _0x50bd8c=document['getElementById'](_0x47f7a0(0x6c9));_0x50bd8c[_0x47f7a0(0xc58)]='',_0x4b9f2d(),_0x4b9f2d(),_0x50aeb4[_0x47f7a0(0x418)][_0x47f7a0(0xdda)](_0x47f7a0(0x40a));}function _0x4b9f2d(){const _0x483ae4=_0x5a7792,_0x5f11ac=document[_0x483ae4(0x64f)](_0x483ae4(0x6c9)),_0x4c521f=document[_0x483ae4(0x124e)](_0x483ae4(0x479));_0x4c521f[_0x483ae4(0x87d)]=_0x483ae4(0xa94),_0x4c521f[_0x483ae4(0xc58)]=_0x483ae4(0x121f),_0x4c521f[_0x483ae4(0x49c)](_0x483ae4(0xda1))[_0x483ae4(0xf72)]('click',()=>{const _0x1bca7b=_0x483ae4;_0x5f11ac[_0x1bca7b(0x507)][_0x1bca7b(0x40f)]>0x2?_0x4c521f['remove']():alert(_0x1bca7b(0x11ab));}),_0x5f11ac['appendChild'](_0x4c521f);}async function _0x51b63f(){const _0x18185e=_0x5a7792;if(!_0x3e7a1b[_0x18185e(0x777)])return;const _0x45cb1a=document['getElementById'](_0x18185e(0x10a7))[_0x18185e(0xbed)][_0x18185e(0x43a)]();if(!_0x45cb1a){alert('请输入投票问题！');return;}const _0x258b46=Array[_0x18185e(0xb3a)](document[_0x18185e(0x233)](_0x18185e(0x562)))[_0x18185e(0xb96)](_0x5eadbb=>_0x5eadbb['value'][_0x18185e(0x43a)]())[_0x18185e(0x156)](_0x2433ca=>_0x2433ca);if(_0x258b46[_0x18185e(0x40f)]<0x2){alert('请至少输入2个有效的投票选项！');return;}const _0x5c8b7d=_0x3e7a1b[_0x18185e(0x999)][_0x3e7a1b[_0x18185e(0x777)]],_0x73a423=_0x5c8b7d[_0x18185e(0x1167)]?_0x5c8b7d[_0x18185e(0xcb3)][_0x18185e(0x96f)]||'我':'我',_0x4dd4b5={'role':'user','senderName':_0x73a423,'type':_0x18185e(0xcde),'timestamp':Date[_0x18185e(0x2b5)](),'question':_0x45cb1a,'options':_0x258b46,'votes':{},'isClosed':![]};_0x5c8b7d[_0x18185e(0x830)][_0x18185e(0x13ee)](_0x4dd4b5),await _0x4e1bbf[_0x18185e(0x999)][_0x18185e(0x4fa)](_0x5c8b7d),_0x3c7e84(_0x4dd4b5,_0x5c8b7d),_0x21f6ea(),document['getElementById'](_0x18185e(0x103a))[_0x18185e(0x418)][_0x18185e(0x1275)](_0x18185e(0x40a));}async function _0x47a317(_0x4cc1b6,_0x2f58b6){const _0xb4fd41=_0x5a7792,_0x3f43c4=_0x3e7a1b[_0xb4fd41(0x999)][_0x3e7a1b[_0xb4fd41(0x777)]],_0x7ea5a0=_0x3f43c4['history'][_0xb4fd41(0x137)](_0x13391e=>_0x13391e['timestamp']===_0x4cc1b6),_0x394eea=_0x3f43c4[_0xb4fd41(0x1167)]?_0x3f43c4[_0xb4fd41(0xcb3)][_0xb4fd41(0x96f)]||'我':'我';if(!_0x7ea5a0||_0x7ea5a0[_0xb4fd41(0x11ad)]){_0x7ea5a0&&_0x7ea5a0[_0xb4fd41(0x11ad)]&&_0x19d3ac(_0x4cc1b6);return;}const _0x17a9f5=_0x7ea5a0[_0xb4fd41(0x9ad)][_0x2f58b6]&&_0x7ea5a0[_0xb4fd41(0x9ad)][_0x2f58b6][_0xb4fd41(0xe53)](_0x394eea);if(!_0x17a9f5){for(const _0xca63a1 in _0x7ea5a0[_0xb4fd41(0x9ad)]){const _0x5650d4=_0x7ea5a0[_0xb4fd41(0x9ad)][_0xca63a1]['indexOf'](_0x394eea);_0x5650d4>-0x1&&_0x7ea5a0['votes'][_0xca63a1][_0xb4fd41(0x10f9)](_0x5650d4,0x1);}!_0x7ea5a0[_0xb4fd41(0x9ad)][_0x2f58b6]&&(_0x7ea5a0[_0xb4fd41(0x9ad)][_0x2f58b6]=[]),_0x7ea5a0['votes'][_0x2f58b6][_0xb4fd41(0x13ee)](_0x394eea);}let _0x4c2cdc=null;!_0x17a9f5&&(_0x4c2cdc='[系统提示：用户\x20('+_0x394eea+_0xb4fd41(0xabb)+_0x2f58b6+_0xb4fd41(0xbdf));if(_0x4c2cdc){const _0x4498d1={'role':_0xb4fd41(0x905),'content':_0x4c2cdc,'timestamp':Date[_0xb4fd41(0x2b5)](),'isHidden':!![]};_0x3f43c4['history']['push'](_0x4498d1);}await _0x4e1bbf[_0xb4fd41(0x999)][_0xb4fd41(0x4fa)](_0x3f43c4),_0x4817d1(_0x3e7a1b['activeChatId']);}async function _0x3b9a7e(_0x2656ea){const _0x58277c=_0x5a7792,_0x4ca38b=_0x3e7a1b[_0x58277c(0x999)][_0x3e7a1b['activeChatId']],_0x133662=_0x4ca38b['history'][_0x58277c(0x137)](_0x533f8b=>_0x533f8b[_0x58277c(0x8af)]===_0x2656ea);if(!_0x133662||_0x133662[_0x58277c(0x11ad)])return;const _0x3b233c=await _0x54149f(_0x58277c(0x1127),_0x58277c(0x11df));if(_0x3b233c){_0x133662['isClosed']=!![];const _0x4325ad=_0x133662[_0x58277c(0x590)]['map'](_0x1ddfa3=>'“'+_0x1ddfa3+'”('+(_0x133662[_0x58277c(0x9ad)][_0x1ddfa3]?.[_0x58277c(0x40f)]||0x0)+'票)')[_0x58277c(0xd22)]('，'),_0x20ab1d=_0x58277c(0xb5f)+_0x4325ad+'。]',_0x59b362={'role':'system','content':_0x20ab1d,'timestamp':Date[_0x58277c(0x2b5)](),'isHidden':!![]};_0x4ca38b[_0x58277c(0x830)]['push'](_0x59b362),await _0x4e1bbf[_0x58277c(0x999)]['put'](_0x4ca38b),_0x4817d1(_0x3e7a1b[_0x58277c(0x777)]);}}function _0x19d3ac(_0xee1d6d){const _0x45c2f7=_0x5a7792,_0x5a4a34=_0x3e7a1b[_0x45c2f7(0x999)][_0x3e7a1b[_0x45c2f7(0x777)]],_0xfd62be=_0x5a4a34[_0x45c2f7(0x830)][_0x45c2f7(0x137)](_0x25b17b=>_0x25b17b['timestamp']===_0xee1d6d);if(!_0xfd62be||!_0xfd62be['isClosed'])return;let _0x40462d=_0x45c2f7(0x1c3)+_0xfd62be[_0x45c2f7(0x3c7)]+_0x45c2f7(0xdd7);Object[_0x45c2f7(0xc30)](_0xfd62be[_0x45c2f7(0x9ad)])[_0x45c2f7(0x40f)]===0x0?_0x40462d+=_0x45c2f7(0x1343):_0xfd62be[_0x45c2f7(0x590)][_0x45c2f7(0x103)](_0x1e2120=>{const _0x41de0c=_0x45c2f7,_0x58cfd7=_0xfd62be[_0x41de0c(0x9ad)][_0x1e2120]||[],_0x3ba9ea=_0x58cfd7[_0x41de0c(0xb96)](_0x51d695=>_0x1409fb(_0x5a4a34,_0x51d695))[_0x41de0c(0xd22)]('、\x20');_0x40462d+=_0x41de0c(0xcf)+_0x1e2120+'\x20('+_0x58cfd7[_0x41de0c(0x40f)]+_0x41de0c(0x52d)+(_0x58cfd7[_0x41de0c(0x40f)]>0x0?_0x3ba9ea:'无人投票')+_0x41de0c(0x66a);}),_0x28974b(_0x45c2f7(0x234),_0x40462d);}function _0x5ee89d(){const _0x1beea1=_0x5a7792;if(!_0x3e7a1b[_0x1beea1(0x777)])return;const _0x1069a0=_0x3e7a1b[_0x1beea1(0x999)][_0x3e7a1b[_0x1beea1(0x777)]];document[_0x1beea1(0x64f)](_0x1beea1(0x1bf))['textContent']='“'+_0x1069a0[_0x1beea1(0x6fc)]+_0x1beea1(0x7a0),_0x3f1e08(),document[_0x1beea1(0x64f)]('ai-avatar-library-modal')[_0x1beea1(0x418)][_0x1beea1(0xdda)](_0x1beea1(0x40a));}function _0x3f1e08(){const _0x425df9=_0x5a7792,_0x4d6772=document['getElementById'](_0x425df9(0x63f));_0x4d6772[_0x425df9(0xc58)]='';const _0x16aa3a=_0x3e7a1b['chats'][_0x3e7a1b['activeChatId']],_0x448be9=_0x16aa3a[_0x425df9(0xcb3)]['aiAvatarLibrary']||[];if(_0x448be9['length']===0x0){_0x4d6772['innerHTML']=_0x425df9(0xf01);return;}_0x448be9[_0x425df9(0x103)]((_0x332c36,_0x3a87f0)=>{const _0x239fe8=_0x425df9,_0x1e4310=document['createElement'](_0x239fe8(0x479));_0x1e4310['className']=_0x239fe8(0xa01),_0x1e4310[_0x239fe8(0x1250)]=_0x332c36['name'],_0x1e4310['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22sticker-image-container\x22\x20style=\x22background-image:\x20url('+_0x332c36['url']+_0x239fe8(0x101c)+_0x332c36[_0x239fe8(0x6fc)]+_0x239fe8(0xd82);const _0x1ee9c5=document['createElement']('div');_0x1ee9c5[_0x239fe8(0x87d)]='delete-btn',_0x1ee9c5[_0x239fe8(0xc58)]='×',_0x1ee9c5[_0x239fe8(0x731)][_0x239fe8(0x130)]=_0x239fe8(0xb37),_0x1ee9c5[_0x239fe8(0x113a)]=async _0x35c532=>{const _0x32d59e=_0x239fe8;_0x35c532[_0x32d59e(0x61c)]();const _0x577349=await _0x54149f('删除头像','确定要从头像库中删除“'+_0x332c36[_0x32d59e(0x6fc)]+_0x32d59e(0xeb8),{'confirmButtonClass':_0x32d59e(0xeed)});_0x577349&&(_0x16aa3a['settings'][_0x32d59e(0x1163)][_0x32d59e(0x10f9)](_0x3a87f0,0x1),await _0x4e1bbf[_0x32d59e(0x999)][_0x32d59e(0x4fa)](_0x16aa3a),_0x3f1e08());},_0x1e4310[_0x239fe8(0x99e)](_0x1ee9c5),_0x4d6772[_0x239fe8(0x99e)](_0x1e4310);});}async function _0x41d758(){const _0x3ba034=_0x5a7792,_0x158669=await _0x41e3f8(_0x3ba034(0xc9b),_0x3ba034(0x3ca));if(!_0x158669||!_0x158669['trim']())return;const _0x30f290=await _0x41e3f8('添加头像',_0x3ba034(0x1c6),'',_0x3ba034(0xe52));if(!_0x30f290||!_0x30f290['trim']()['startsWith'](_0x3ba034(0x2b8))){alert('请输入有效的图片URL！');return;}const _0x4f5364=_0x3e7a1b[_0x3ba034(0x999)][_0x3e7a1b['activeChatId']];!_0x4f5364[_0x3ba034(0xcb3)][_0x3ba034(0x1163)]&&(_0x4f5364['settings'][_0x3ba034(0x1163)]=[]),_0x4f5364[_0x3ba034(0xcb3)]['aiAvatarLibrary'][_0x3ba034(0x13ee)]({'name':_0x158669['trim'](),'url':_0x30f290[_0x3ba034(0x43a)]()}),await _0x4e1bbf[_0x3ba034(0x999)]['put'](_0x4f5364),_0x3f1e08();}function _0x5cf6e2(){const _0xb8a573=_0x5a7792;document[_0xb8a573(0x64f)](_0xb8a573(0x1b4))[_0xb8a573(0x418)]['remove'](_0xb8a573(0x40a));}function _0x2d4a49(){const _0x14aa67=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x4c3c6e=_0x3e7a1b[_0x14aa67(0x999)][_0x3e7a1b[_0x14aa67(0x777)]];document[_0x14aa67(0x64f)]('my-avatar-library-title')[_0x14aa67(0xee5)]='“'+(_0x4c3c6e[_0x14aa67(0xcb3)][_0x14aa67(0x96f)]||'我')+_0x14aa67(0x7a0),_0x485b3f(),document['getElementById'](_0x14aa67(0x13c4))[_0x14aa67(0x418)][_0x14aa67(0xdda)](_0x14aa67(0x40a));}function _0x485b3f(){const _0x4b75bb=_0x5a7792,_0x115b0b=document[_0x4b75bb(0x64f)](_0x4b75bb(0xfee));_0x115b0b[_0x4b75bb(0xc58)]='';const _0xb0ce2f=_0x3e7a1b[_0x4b75bb(0x999)][_0x3e7a1b['activeChatId']],_0x39b49b=_0xb0ce2f[_0x4b75bb(0xcb3)][_0x4b75bb(0x83a)]||[];if(_0x39b49b[_0x4b75bb(0x40f)]===0x0){_0x115b0b['innerHTML']='<p\x20style=\x22color:\x20var(--text-secondary);\x20grid-column:\x201\x20/\x20-1;\x20text-align:\x20center;\x22>这个头像库还是空的，点击右上角“添加”吧！</p>';return;}_0x39b49b[_0x4b75bb(0x103)]((_0x471ac9,_0x74d1a5)=>{const _0x453e50=_0x4b75bb,_0x1e9127=document[_0x453e50(0x124e)]('div');_0x1e9127[_0x453e50(0x87d)]=_0x453e50(0xa01),_0x1e9127[_0x453e50(0x1250)]=_0x471ac9[_0x453e50(0x6fc)],_0x1e9127[_0x453e50(0xc58)]=_0x453e50(0xdff)+_0x471ac9['url']+_0x453e50(0x101c)+_0x471ac9[_0x453e50(0x6fc)]+_0x453e50(0xd82);const _0x451086=document[_0x453e50(0x124e)](_0x453e50(0x479));_0x451086[_0x453e50(0x87d)]=_0x453e50(0xb41),_0x451086[_0x453e50(0xc58)]='×',_0x451086[_0x453e50(0x731)]['display']='block',_0x451086[_0x453e50(0x113a)]=async _0x47536e=>{const _0x5c8284=_0x453e50;_0x47536e[_0x5c8284(0x61c)]();const _0x33db0f=await _0x54149f(_0x5c8284(0xdbe),_0x5c8284(0x1286)+_0x471ac9[_0x5c8284(0x6fc)]+_0x5c8284(0xeb8),{'confirmButtonClass':_0x5c8284(0xeed)});_0x33db0f&&(_0xb0ce2f['settings']['myAvatarLibrary'][_0x5c8284(0x10f9)](_0x74d1a5,0x1),await _0x4e1bbf['chats']['put'](_0xb0ce2f),_0x485b3f());},_0x1e9127['appendChild'](_0x451086),_0x115b0b[_0x453e50(0x99e)](_0x1e9127);});}async function _0x588e4e(){const _0x4ec2d5=_0x5a7792,_0x17db01=await _0x41e3f8(_0x4ec2d5(0xc9b),_0x4ec2d5(0x3ca));if(!_0x17db01||!_0x17db01['trim']())return;const _0x10d43f=await _0x41e3f8(_0x4ec2d5(0xc9b),_0x4ec2d5(0x1c6),'',_0x4ec2d5(0xe52));if(!_0x10d43f||!_0x10d43f['trim']()[_0x4ec2d5(0x7d)](_0x4ec2d5(0x2b8))){alert(_0x4ec2d5(0x429));return;}const _0x100a04=_0x3e7a1b[_0x4ec2d5(0x999)][_0x3e7a1b[_0x4ec2d5(0x777)]];!_0x100a04['settings'][_0x4ec2d5(0x83a)]&&(_0x100a04['settings'][_0x4ec2d5(0x83a)]=[]),_0x100a04[_0x4ec2d5(0xcb3)][_0x4ec2d5(0x83a)][_0x4ec2d5(0x13ee)]({'name':_0x17db01[_0x4ec2d5(0x43a)](),'url':_0x10d43f[_0x4ec2d5(0x43a)]()}),await _0x4e1bbf['chats'][_0x4ec2d5(0x4fa)](_0x100a04),_0x485b3f();}async function _0x3425b9(_0x5d01f6){const _0x286556=_0x5a7792,_0x5bba85=_0x5d01f6['target'][_0x286556(0x91e)][0x0];if(!_0x5bba85)return;const _0x432e76=await new Promise(_0x14449c=>{const _0x2bfc12=_0x286556,_0x585e22=new FileReader();_0x585e22[_0x2bfc12(0x139d)]=()=>_0x14449c(_0x585e22[_0x2bfc12(0x8f)]),_0x585e22[_0x2bfc12(0xb4)](_0x5bba85);}),_0x2cb715=await _0x41e3f8(_0x286556(0x10fd),_0x286556(0x641));if(!_0x2cb715||!_0x2cb715[_0x286556(0x43a)]())return;const _0x471078=_0x3e7a1b[_0x286556(0x999)][_0x3e7a1b[_0x286556(0x777)]];!_0x471078[_0x286556(0xcb3)]['myAvatarLibrary']&&(_0x471078[_0x286556(0xcb3)][_0x286556(0x83a)]=[]),_0x471078[_0x286556(0xcb3)][_0x286556(0x83a)][_0x286556(0x13ee)]({'name':_0x2cb715['trim'](),'url':_0x432e76}),await _0x4e1bbf['chats'][_0x286556(0x4fa)](_0x471078),_0x485b3f(),_0x5d01f6['target'][_0x286556(0xbed)]=null;}async function _0x1912cb(_0x44822f){const _0x5505df=_0x5a7792,_0x5ed252=_0x3e7a1b[_0x5505df(0x999)][_0x3e7a1b[_0x5505df(0x777)]];if(!_0x5ed252)return;const _0x275dbe=_0x44822f[_0x5505df(0x43a)]()[_0x5505df(0x108c)]('\x0a'),_0x49ab61=[],_0xa6ded=_0x5505df(0x171);let _0x3213c8=0x0;for(const _0x556231 of _0x275dbe){const _0x2b3b25=_0x556231[_0x5505df(0x43a)]();if(!_0x2b3b25||_0x2b3b25['includes'](_0x5505df(0x2b8))||_0x2b3b25[_0x5505df(0xe53)]('填入'))continue;let _0x238aae=null,_0x29a5b7=null;const _0x5a6bc3=_0x2b3b25[_0x5505df(0x132a)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x5a6bc3)_0x238aae=_0x5a6bc3[0x1],_0x29a5b7=_0x5a6bc3[0x2];else{const _0x377738=_0x2b3b25[_0x5505df(0x108c)](/\s+/);_0x377738['length']>=0x2&&(_0x29a5b7=_0x377738[_0x5505df(0xa90)](),_0x238aae=_0x377738[_0x5505df(0xd22)]('\x20'));}_0x238aae&&_0x29a5b7&&_0x29a5b7[_0x5505df(0xe53)]('.')?_0x49ab61[_0x5505df(0x13ee)]({'name':_0x238aae,'url':_0xa6ded+_0x29a5b7}):_0x3213c8++;}if(_0x3213c8>0x0)await _0x28974b(_0x5505df(0xdf1),'有\x20'+_0x3213c8+'\x20行的格式不正确，已被跳过。');if(_0x49ab61[_0x5505df(0x40f)]>0x0){if(!_0x5ed252[_0x5505df(0xcb3)]['myAvatarLibrary'])_0x5ed252[_0x5505df(0xcb3)][_0x5505df(0x83a)]=[];_0x5ed252[_0x5505df(0xcb3)][_0x5505df(0x83a)][_0x5505df(0x13ee)](..._0x49ab61),await _0x4e1bbf[_0x5505df(0x999)][_0x5505df(0x4fa)](_0x5ed252),_0x485b3f(),await _0x28974b(_0x5505df(0x583),_0x5505df(0xc37)+_0x49ab61[_0x5505df(0x40f)]+'\x20个新头像！');}else _0x3213c8===0x0&&alert(_0x5505df(0xea1));}function _0x41e336(){const _0xbb891a=_0x5a7792;document[_0xbb891a(0x64f)](_0xbb891a(0x13c4))[_0xbb891a(0x418)][_0xbb891a(0x1275)](_0xbb891a(0x40a));}function _0x507536(){const _0x59d3f6=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x575853=_0x3e7a1b[_0x59d3f6(0x999)][_0x3e7a1b[_0x59d3f6(0x777)]];document[_0x59d3f6(0x64f)](_0x59d3f6(0xccf))[_0x59d3f6(0xee5)]='“'+_0x575853[_0x59d3f6(0x6fc)]+_0x59d3f6(0x7a0),_0x31c59f(),document[_0x59d3f6(0x64f)](_0x59d3f6(0x547))['classList'][_0x59d3f6(0xdda)]('visible');}function _0x31c59f(){const _0x2e9a1e=_0x5a7792,_0x4a46a9=document['getElementById'](_0x2e9a1e(0x680));_0x4a46a9[_0x2e9a1e(0xc58)]='';const _0x4dce65=_0x3e7a1b[_0x2e9a1e(0x999)][_0x3e7a1b['activeChatId']],_0x503381=_0x4dce65['settings']['groupAvatarLibrary']||[];if(_0x503381[_0x2e9a1e(0x40f)]===0x0){_0x4a46a9[_0x2e9a1e(0xc58)]=_0x2e9a1e(0xf01);return;}_0x503381['forEach']((_0x49dc81,_0x4d8a3f)=>{const _0x3d2836=_0x2e9a1e,_0x4a806a=document[_0x3d2836(0x124e)](_0x3d2836(0x479));_0x4a806a[_0x3d2836(0x87d)]=_0x3d2836(0xa01),_0x4a806a[_0x3d2836(0x1250)]=_0x49dc81['name'],_0x4a806a[_0x3d2836(0xc58)]=_0x3d2836(0xdff)+_0x49dc81['url']+_0x3d2836(0x101c)+_0x49dc81[_0x3d2836(0x6fc)]+_0x3d2836(0xd82);const _0x5cab2a=document[_0x3d2836(0x124e)](_0x3d2836(0x479));_0x5cab2a[_0x3d2836(0x87d)]='delete-btn',_0x5cab2a[_0x3d2836(0xc58)]='×',_0x5cab2a[_0x3d2836(0x731)]['display']='block',_0x5cab2a[_0x3d2836(0x113a)]=async _0xb5b481=>{const _0x21f925=_0x3d2836;_0xb5b481[_0x21f925(0x61c)]();const _0x806fdd=await _0x54149f(_0x21f925(0xdbe),_0x21f925(0xbeb)+_0x49dc81['name']+_0x21f925(0xeb8),{'confirmButtonClass':_0x21f925(0xeed)});_0x806fdd&&(_0x4dce65[_0x21f925(0xcb3)][_0x21f925(0x1ee)][_0x21f925(0x10f9)](_0x4d8a3f,0x1),await _0x4e1bbf[_0x21f925(0x999)]['put'](_0x4dce65),_0x31c59f());},_0x4a806a[_0x3d2836(0x99e)](_0x5cab2a),_0x4a46a9[_0x3d2836(0x99e)](_0x4a806a);});}async function _0x40d06f(){const _0x56b2e0=_0x5a7792,_0x194563=await _0x41e3f8(_0x56b2e0(0xc9b),_0x56b2e0(0x882));if(!_0x194563||!_0x194563[_0x56b2e0(0x43a)]())return;const _0x466c1a=await _0x41e3f8(_0x56b2e0(0xc9b),_0x56b2e0(0x1c6),'','url');if(!_0x466c1a||!_0x466c1a[_0x56b2e0(0x43a)]()[_0x56b2e0(0x7d)](_0x56b2e0(0x2b8))){alert(_0x56b2e0(0x429));return;}const _0x58ee09=_0x3e7a1b['chats'][_0x3e7a1b[_0x56b2e0(0x777)]];!_0x58ee09[_0x56b2e0(0xcb3)][_0x56b2e0(0x1ee)]&&(_0x58ee09[_0x56b2e0(0xcb3)][_0x56b2e0(0x1ee)]=[]),_0x58ee09['settings'][_0x56b2e0(0x1ee)][_0x56b2e0(0x13ee)]({'name':_0x194563['trim'](),'url':_0x466c1a[_0x56b2e0(0x43a)]()}),await _0x4e1bbf[_0x56b2e0(0x999)][_0x56b2e0(0x4fa)](_0x58ee09),_0x31c59f();}function _0x1cbee8(){const _0xa44dd8=_0x5a7792;document[_0xa44dd8(0x64f)](_0xa44dd8(0x547))['classList']['remove']('visible');}async function _0x54c83c(_0x26d65f){const _0x342d84=_0x5a7792,_0x31081a=_0x342d84(0x638),_0x5ee68d=await _0x41e3f8(_0x342d84(0x10ed),_0x31081a,'','textarea');_0x5ee68d&&_0x5ee68d['trim']()&&await _0x2d9c66(_0x26d65f,_0x5ee68d);}async function _0x2d9c66(_0x5f4d13,_0x18d2ce){const _0x54b486=_0x5a7792,_0xab4a52=_0x3e7a1b[_0x54b486(0x999)][_0x3e7a1b[_0x54b486(0x777)]];if(!_0xab4a52)return;const _0x420757=_0x18d2ce[_0x54b486(0x43a)]()[_0x54b486(0x108c)]('\x0a'),_0x3c0806=[],_0x8ccd7=_0x54b486(0x171);let _0x17d34a=0x0;for(const _0x55038c of _0x420757){const _0x3742eb=_0x55038c[_0x54b486(0x43a)]();if(!_0x3742eb||_0x3742eb[_0x54b486(0xe53)](_0x54b486(0x2b8))||_0x3742eb[_0x54b486(0xe53)]('填入'))continue;let _0x56e9bc=null,_0x4f4d6d=null;const _0x586e53=_0x3742eb[_0x54b486(0x132a)](/^([\u4e00-\u9fa5]+)([a-zA-Z0-9]+\..+)$/);if(_0x586e53)_0x56e9bc=_0x586e53[0x1],_0x4f4d6d=_0x586e53[0x2];else{const _0x2e3657=_0x3742eb[_0x54b486(0x108c)](/\s+/);_0x2e3657[_0x54b486(0x40f)]>=0x2&&(_0x4f4d6d=_0x2e3657['pop'](),_0x56e9bc=_0x2e3657['join']('\x20'));}_0x56e9bc&&_0x4f4d6d&&_0x4f4d6d[_0x54b486(0xe53)]('.')?_0x3c0806['push']({'name':_0x56e9bc,'url':_0x8ccd7+_0x4f4d6d}):(_0x17d34a++,console['warn']('批量导入格式错误，已跳过此行:',_0x3742eb));}_0x17d34a>0x0&&await _0x28974b('部分导入失败','有\x20'+_0x17d34a+_0x54b486(0x8f8));if(_0x3c0806[_0x54b486(0x40f)]>0x0){if(_0x5f4d13==='ai'){if(!_0xab4a52[_0x54b486(0xcb3)]['aiAvatarLibrary'])_0xab4a52[_0x54b486(0xcb3)]['aiAvatarLibrary']=[];_0xab4a52['settings'][_0x54b486(0x1163)][_0x54b486(0x13ee)](..._0x3c0806),await _0x4e1bbf['chats'][_0x54b486(0x4fa)](_0xab4a52),_0x3f1e08();}else{if(_0x5f4d13===_0x54b486(0xa40)){if(!_0xab4a52[_0x54b486(0xcb3)][_0x54b486(0x1ee)])_0xab4a52[_0x54b486(0xcb3)][_0x54b486(0x1ee)]=[];_0xab4a52[_0x54b486(0xcb3)]['groupAvatarLibrary'][_0x54b486(0x13ee)](..._0x3c0806),await _0x4e1bbf[_0x54b486(0x999)]['put'](_0xab4a52),_0x31c59f();}}await _0x28974b('导入成功',_0x54b486(0xc37)+_0x3c0806[_0x54b486(0x40f)]+'\x20个新头像！');}else _0x17d34a===0x0&&alert('没有找到可导入的内容。请检查您粘贴的格式是否正确。');}async function _0x34c172(){const _0x45361d=_0x5a7792,_0x3382ba=await _0x41e3f8(_0x45361d(0xc9b),_0x45361d(0x882));if(!_0x3382ba||!_0x3382ba[_0x45361d(0x43a)]())return;const _0x28bfaa=await _0x41e3f8('添加头像',_0x45361d(0x1c6),'','url');if(!_0x28bfaa||!_0x28bfaa[_0x45361d(0x43a)]()[_0x45361d(0x7d)]('http')){alert(_0x45361d(0x429));return;}const _0x260e31=_0x3e7a1b[_0x45361d(0x999)][_0x3e7a1b[_0x45361d(0x777)]];!_0x260e31['settings'][_0x45361d(0x1ee)]&&(_0x260e31['settings'][_0x45361d(0x1ee)]=[]),_0x260e31[_0x45361d(0xcb3)][_0x45361d(0x1ee)][_0x45361d(0x13ee)]({'name':_0x3382ba['trim'](),'url':_0x28bfaa[_0x45361d(0x43a)]()}),await _0x4e1bbf[_0x45361d(0x999)][_0x45361d(0x4fa)](_0x260e31),_0x31c59f();}function _0x1c87a0(_0x4c0c97){return new Promise(_0xdffd74=>{const _0x80672=_0x2bd6,_0x3a5cce=document['getElementById'](_0x80672(0x172)),_0x208c39=document['getElementById'](_0x80672(0x1010)),_0x57ca2f=document[_0x80672(0x64f)](_0x80672(0x1257)),_0x3e809e=document[_0x80672(0x64f)](_0x80672(0x713));_0x208c39[_0x80672(0xee5)]=_0x4c0c97[_0x80672(0x9b6)]?'取消置顶':'置顶聊天';const _0x3fcd5b=_0x208c39[_0x80672(0xc66)](!![]);_0x208c39['parentNode'][_0x80672(0x3d4)](_0x3fcd5b,_0x208c39),_0x3fcd5b[_0x80672(0x113a)]=()=>{const _0x447593=_0x80672;_0x3a5cce[_0x447593(0x418)]['remove'](_0x447593(0x40a)),_0xdffd74(_0x447593(0x12cc));};const _0x149f73=_0x57ca2f['cloneNode'](!![]);_0x57ca2f['parentNode'][_0x80672(0x3d4)](_0x149f73,_0x57ca2f),_0x149f73['onclick']=()=>{const _0x19bc01=_0x80672;_0x3a5cce[_0x19bc01(0x418)]['remove']('visible'),_0xdffd74('delete');};const _0x195848=_0x3e809e[_0x80672(0xc66)](!![]);_0x3e809e[_0x80672(0x9be)][_0x80672(0x3d4)](_0x195848,_0x3e809e),_0x195848[_0x80672(0x113a)]=()=>{const _0x2681f0=_0x80672;_0x3a5cce[_0x2681f0(0x418)][_0x2681f0(0x1275)]('visible'),_0xdffd74(null);},_0x3a5cce[_0x80672(0x418)]['add']('visible');});}function _0x16a875(){const _0x5d2c00=_0x5a7792,_0x587ff8=document[_0x5d2c00(0x64f)](_0x5d2c00(0xed5)),_0x13ceac=_0x3e7a1b[_0x5d2c00(0x11b4)]['cphoneWallpaper'];_0x13ceac?_0x587ff8[_0x5d2c00(0x731)][_0x5d2c00(0x4d6)]=_0x5d2c00(0xec1)+_0x13ceac+')':_0x587ff8[_0x5d2c00(0x731)][_0x5d2c00(0x4d6)]=_0x5d2c00(0xb03);}function _0x5f4cf3(){const _0x58999b=_0x5a7792;if(!_0x3e7a1b[_0x58999b(0x11b4)][_0x58999b(0x328)])return;for(const _0x13c6fc in _0x3e7a1b[_0x58999b(0x11b4)][_0x58999b(0x328)]){const _0x11b1ad=document[_0x58999b(0x64f)](_0x58999b(0x11e9)+_0x13c6fc);_0x11b1ad&&(_0x11b1ad[_0x58999b(0xbe8)]=_0x3e7a1b[_0x58999b(0x11b4)][_0x58999b(0x328)][_0x13c6fc]);}}function _0x453102(){const _0x3ddbe9=_0x5a7792,_0x358fed=document[_0x3ddbe9(0x64f)](_0x3ddbe9(0x93a));if(!_0x358fed)return;_0x358fed[_0x3ddbe9(0xc58)]='';const _0x3c7970={'qq':'QQ','album':'相册','browser':_0x3ddbe9(0xabd),'taobao':'淘宝','memo':_0x3ddbe9(0x7a1),'diary':'日记','amap':'高德地图','usage':_0x3ddbe9(0x579),'music':_0x3ddbe9(0x46a),'ephone':'Ephone'};for(const _0x1fdf7f in _0x3e7a1b[_0x3ddbe9(0x11b4)][_0x3ddbe9(0x328)]){const _0x2c3a8a=_0x3e7a1b[_0x3ddbe9(0x11b4)][_0x3ddbe9(0x328)][_0x1fdf7f],_0x23390d=_0x3c7970[_0x1fdf7f]||_0x3ddbe9(0xdd5),_0x3e43db=document['createElement'](_0x3ddbe9(0x479));_0x3e43db[_0x3ddbe9(0x87d)]='icon-setting-item',_0x3e43db[_0x3ddbe9(0x12e1)][_0x3ddbe9(0x221)]=_0x1fdf7f,_0x3e43db['innerHTML']=_0x3ddbe9(0x645)+_0x2c3a8a+_0x3ddbe9(0xa7b)+_0x23390d+_0x3ddbe9(0x400),_0x358fed['appendChild'](_0x3e43db);}}function _0x5dc542(){const _0x2d719e=_0x5a7792;if(!_0x3e7a1b[_0x2d719e(0x11b4)][_0x2d719e(0xdaa)])return;for(const _0x49bebb in _0x3e7a1b[_0x2d719e(0x11b4)]['appIcons']){const _0x1ffd2c=document[_0x2d719e(0x64f)](_0x2d719e(0x133f)+_0x49bebb);_0x1ffd2c&&(_0x1ffd2c['src']=_0x3e7a1b['globalSettings']['appIcons'][_0x49bebb]);}}function _0x3e916b(){const _0x43db09=_0x5a7792,_0x30cd7f=document[_0x43db09(0x64f)](_0x43db09(0x10a0));if(!_0x30cd7f)return;_0x30cd7f[_0x43db09(0xc58)]='';const _0x3f07c6={'qq':'QQ','world-book':_0x43db09(0x181),'wallpaper':_0x43db09(0x93f),'renderer':_0x43db09(0x106a),'api-settings':_0x43db09(0xbec),'font':'字体','char-phone':_0x43db09(0xaf3),'douban':_0x43db09(0x539),'preset':'预设','tutorial':'教程','werewolf':'狼人杀','x':'X'};for(const _0x36bc3c in _0x3e7a1b[_0x43db09(0x11b4)][_0x43db09(0xdaa)]){const _0x452e73=_0x3e7a1b[_0x43db09(0x11b4)][_0x43db09(0xdaa)][_0x36bc3c],_0x3295a4=_0x3f07c6[_0x36bc3c]||_0x43db09(0xaf3),_0x3467d6=document[_0x43db09(0x124e)](_0x43db09(0x479));_0x3467d6[_0x43db09(0x87d)]=_0x43db09(0x105c),_0x3467d6[_0x43db09(0x12e1)]['iconId']=_0x36bc3c,_0x3467d6[_0x43db09(0xc58)]=_0x43db09(0x645)+_0x452e73+_0x43db09(0xa7b)+_0x3295a4+_0x43db09(0x400),_0x30cd7f[_0x43db09(0x99e)](_0x3467d6);}}function _0xbc6d58(_0x8e0a27){const _0x4f1989=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x117960=_0x3e7a1b[_0x4f1989(0x999)][_0x3e7a1b[_0x4f1989(0x777)]];if(!_0x117960||!_0x117960['history'])return;const _0x5c3bd0=_0x117960[_0x4f1989(0x830)]['find'](_0x5e2209=>_0x5e2209[_0x4f1989(0x8af)]===_0x8e0a27);if(!_0x5c3bd0||_0x5c3bd0[_0x4f1989(0xafc)]!==_0x4f1989(0x460)){console[_0x4f1989(0xc60)](_0x4f1989(0x41e),_0x8e0a27);return;}document[_0x4f1989(0x64f)](_0x4f1989(0x3ea))[_0x4f1989(0xee5)]=_0x5c3bd0[_0x4f1989(0x4b5)]||'文章详情';const _0xd71e40=document[_0x4f1989(0x64f)]('browser-content');_0xd71e40[_0x4f1989(0xc58)]=_0x4f1989(0xad5)+(_0x5c3bd0[_0x4f1989(0x1250)]||_0x4f1989(0x533))+'</h1>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-meta\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>来源:\x20'+(_0x5c3bd0['source_name']||'未知')+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22article-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>'+(_0x5c3bd0[_0x4f1989(0x3ba)]||_0x4f1989(0xe8c))[_0x4f1989(0x137f)](/\n/g,'</p><p>')+_0x4f1989(0x8a6),_0xddd8ae(_0x4f1989(0x461));}function _0x3cc413(){const _0x161890=_0x5a7792;_0xddd8ae(_0x161890(0x9aa));}function _0x3cc413(){const _0x4eb9e9=_0x5a7792;_0xddd8ae(_0x4eb9e9(0x9aa));}function _0x39a3ff(){const _0x52c6ce=_0x5a7792;if(!_0x3e7a1b[_0x52c6ce(0x777)])return;document['getElementById'](_0x52c6ce(0xd5d))[_0x52c6ce(0xbed)]='',document[_0x52c6ce(0x64f)]('link-description-input')[_0x52c6ce(0xbed)]='',document[_0x52c6ce(0x64f)](_0x52c6ce(0x67c))['value']='',document[_0x52c6ce(0x64f)]('link-content-input')[_0x52c6ce(0xbed)]='',document['getElementById']('share-link-modal')[_0x52c6ce(0x418)][_0x52c6ce(0xdda)](_0x52c6ce(0x40a));}async function _0x1a37b8(){const _0x40063a=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x42a119=document['getElementById'](_0x40063a(0xd5d))['value'][_0x40063a(0x43a)]();if(!_0x42a119){alert('标题是必填项哦！');return;}const _0x3c50d2=document[_0x40063a(0x64f)](_0x40063a(0xbfb))[_0x40063a(0xbed)][_0x40063a(0x43a)](),_0x3405fb=document[_0x40063a(0x64f)](_0x40063a(0x67c))['value'][_0x40063a(0x43a)](),_0x16b8e0=document[_0x40063a(0x64f)](_0x40063a(0xe89))['value'][_0x40063a(0x43a)](),_0x26fa7e=_0x3e7a1b[_0x40063a(0x999)][_0x3e7a1b[_0x40063a(0x777)]],_0x105002={'role':_0x40063a(0xa4d),'type':_0x40063a(0x460),'timestamp':Date[_0x40063a(0x2b5)](),'title':_0x42a119,'description':_0x3c50d2,'source_name':_0x3405fb,'content':_0x16b8e0,'thumbnail_url':null};_0x26fa7e[_0x40063a(0x830)][_0x40063a(0x13ee)](_0x105002),await _0x4e1bbf[_0x40063a(0x999)]['put'](_0x26fa7e),_0x3c7e84(_0x105002,_0x26fa7e),_0x21f6ea(),document[_0x40063a(0x64f)]('share-link-modal')['classList'][_0x40063a(0x1275)](_0x40063a(0x40a));}function _0x4e4575(_0x20a962,_0x457cab){const _0x4f83f5=_0x5a7792;if(!_0x457cab||!_0x457cab['id'])return[];const _0x164035=_0x457cab[_0x4f83f5(0xeb)],_0x32bed8=_0x457cab['id'];return _0x20a962[_0x4f83f5(0x156)](_0x438a62=>{const _0x46b8b8=_0x4f83f5;if(_0x438a62['authorId']===_0x46b8b8(0xa4d)){if(_0x438a62[_0x46b8b8(0xb80)]&&_0x438a62['visibleGroupIds'][_0x46b8b8(0x40f)]>0x0)return _0x164035&&_0x438a62['visibleGroupIds'][_0x46b8b8(0xe53)](_0x164035);return!![];}if(String(_0x438a62[_0x46b8b8(0x1188)])[_0x46b8b8(0x7d)]('npc_')){if(Array[_0x46b8b8(0x97e)](_0x438a62[_0x46b8b8(0x632)]))return _0x438a62['visibleTo'][_0x46b8b8(0xe53)](_0x32bed8);return![];}const _0x41bde1=_0x3e7a1b[_0x46b8b8(0x999)][_0x438a62[_0x46b8b8(0x1188)]];if(!_0x41bde1)return![];const _0x5bb3a4=_0x41bde1[_0x46b8b8(0xeb)],_0x225718=_0x5bb3a4&&_0x164035&&_0x5bb3a4===_0x164035,_0x4d3751=!_0x5bb3a4&&!_0x164035;return _0x225718||_0x4d3751;});}function _0x2f9ff9(_0x32f0de){const _0x5e46be=_0x5a7792,_0x21d79f=document[_0x5e46be(0x64f)]('phone-screen'),_0x1746d5=document[_0x5e46be(0x64f)](_0x5e46be(0x1c7)),_0x2ac622=_0x32f0de==='dark';_0x21d79f['classList']['toggle'](_0x5e46be(0x1313),_0x2ac622),_0x1746d5&&(_0x1746d5[_0x5e46be(0xf1d)]=_0x2ac622),localStorage['setItem']('ephone-theme',_0x32f0de);}function _0x377800(){const _0x222735=_0x5a7792,_0x2c17ab=document[_0x222735(0x64f)](_0x222735(0x1c7)),_0x27fa93=_0x2c17ab[_0x222735(0xf1d)]?_0x222735(0xfd9):'light';_0x2f9ff9(_0x27fa93);}function _0x2c3c67(){const _0x4b61f0=_0x5a7792;if(!_0x3e7a1b[_0x4b61f0(0x777)])return;_0x17f3c1(),_0xddd8ae('long-term-memory-screen');}function _0x17f3c1(){const _0x52a72e=_0x5a7792,_0x4d619f=document[_0x52a72e(0x64f)](_0x52a72e(0x53f)),_0x4e257c=_0x3e7a1b[_0x52a72e(0x999)][_0x3e7a1b['activeChatId']];_0x4d619f[_0x52a72e(0xc58)]='';let _0xfa2910=[];_0x4e257c[_0x52a72e(0x1167)]?_0x4e257c[_0x52a72e(0x5d4)]['forEach'](_0x591f3e=>{const _0x2f597f=_0x52a72e,_0x11df2c=_0x3e7a1b[_0x2f597f(0x999)][_0x591f3e['id']];if(_0x11df2c&&_0x11df2c['longTermMemory']){const _0x177a82=_0x11df2c[_0x2f597f(0x518)][_0x2f597f(0xb96)](_0x3af403=>({..._0x3af403,'authorName':_0x591f3e[_0x2f597f(0x287)],'authorChatId':_0x591f3e['id']}));_0xfa2910['push'](..._0x177a82);}}):_0x4e257c[_0x52a72e(0x518)]&&(_0xfa2910=_0x4e257c[_0x52a72e(0x518)][_0x52a72e(0xb96)](_0x4e17bd=>({..._0x4e17bd,'authorName':_0x4e257c[_0x52a72e(0x6fc)],'authorChatId':_0x4e257c['id']})));if(_0xfa2910['length']===0x0){_0x4d619f[_0x52a72e(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>这里还没有任何长期记忆。</p>';return;}_0xfa2910['sort']((_0x1710f0,_0x37a31b)=>_0x37a31b['timestamp']-_0x1710f0['timestamp']),_0xfa2910['forEach']((_0x2f3029,_0x598a3a)=>{const _0x359f70=_0x52a72e,_0x2b7941=document[_0x359f70(0x124e)](_0x359f70(0x479));_0x2b7941[_0x359f70(0x87d)]=_0x359f70(0x69c),_0x2b7941[_0x359f70(0x731)][_0x359f70(0x1101)]=_0x359f70(0xf5d),_0x2b7941[_0x359f70(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20flex-start;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22content\x22\x20style=\x22padding:\x200;\x20flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20新增：显示记忆来源\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8em;\x20color:\x20#999;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x20'+_0x2f3029['authorName']+_0x359f70(0x1228)+_0x2f3029[_0x359f70(0x3ba)]['replace'](/\n/g,_0x359f70(0x917))+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x208px;\x20flex-shrink:\x200;\x20margin-left:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22memory-action-btn\x20edit-memory-btn\x22\x20data-author-id=\x22'+_0x2f3029['authorChatId']+_0x359f70(0x3fb)+_0x2f3029['timestamp']+_0x359f70(0x9a8)+_0x2f3029[_0x359f70(0x1b2)]+_0x359f70(0x3fb)+_0x2f3029['timestamp']+'\x22\x20title=\x22删除\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x4d619f['appendChild'](_0x2b7941);});}async function _0x21f789(){const _0x1a35da=_0x5a7792,_0x464cc4=_0x3e7a1b['chats'][_0x3e7a1b[_0x1a35da(0x777)]];if(!_0x464cc4)return;let _0x1e05b5=_0x464cc4;if(_0x464cc4[_0x1a35da(0x1167)]){const _0x208481=_0x464cc4['members']['map'](_0x2b270c=>({'text':'为“'+_0x2b270c[_0x1a35da(0x287)]+_0x1a35da(0xf6d),'value':_0x2b270c['id']})),_0x2ab9d7=await _0x217169('选择记忆所属角色',_0x208481);if(!_0x2ab9d7)return;_0x1e05b5=_0x3e7a1b[_0x1a35da(0x999)][_0x2ab9d7];if(!_0x1e05b5){alert(_0x1a35da(0xc96));return;}}const _0x95c8bf=await _0x41e3f8('为“'+_0x1e05b5['name']+_0x1a35da(0xf6d),_0x1a35da(0x91d),'','textarea');if(_0x95c8bf&&_0x95c8bf['trim']()){if(!_0x1e05b5[_0x1a35da(0x518)])_0x1e05b5['longTermMemory']=[];_0x1e05b5[_0x1a35da(0x518)][_0x1a35da(0x13ee)]({'content':_0x95c8bf['trim'](),'timestamp':Date[_0x1a35da(0x2b5)](),'source':_0x1a35da(0x417)}),await _0x4e1bbf[_0x1a35da(0x999)][_0x1a35da(0x4fa)](_0x1e05b5),_0x17f3c1();}}async function _0x44a669(_0x39bad7,_0x50514a){const _0x1a5dba=_0x5a7792,_0x13b5df=_0x3e7a1b['chats'][_0x39bad7];if(!_0x13b5df||!_0x13b5df[_0x1a5dba(0x518)])return;const _0x3fbbb9=_0x13b5df[_0x1a5dba(0x518)]['findIndex'](_0x572f50=>_0x572f50['timestamp']===_0x50514a);if(_0x3fbbb9===-0x1)return;const _0x5c2afb=_0x13b5df['longTermMemory'][_0x3fbbb9],_0x4767a5=await _0x41e3f8(_0x1a5dba(0x129),'请修改记忆要点：',_0x5c2afb['content'],_0x1a5dba(0x444));_0x4767a5&&_0x4767a5[_0x1a5dba(0x43a)]()&&(_0x5c2afb[_0x1a5dba(0x3ba)]=_0x4767a5[_0x1a5dba(0x43a)](),await _0x4e1bbf[_0x1a5dba(0x999)]['put'](_0x13b5df),_0x17f3c1());}async function _0x3b5ff8(_0x36784c,_0xb897c1){const _0x11604d=_0x5a7792,_0x1adae1=await _0x54149f(_0x11604d(0x13d2),_0x11604d(0xa4b),{'confirmButtonClass':_0x11604d(0xeed)});if(_0x1adae1){const _0x98e32f=_0x3e7a1b['chats'][_0x36784c];if(!_0x98e32f||!_0x98e32f[_0x11604d(0x518)])return;_0x98e32f['longTermMemory']=_0x98e32f[_0x11604d(0x518)][_0x11604d(0x156)](_0x5bfa32=>_0x5bfa32[_0x11604d(0x8af)]!==_0xb897c1),await _0x4e1bbf[_0x11604d(0x999)]['put'](_0x98e32f),_0x17f3c1();}}async function _0x186147(){const _0x15e4ca=_0x5a7792,_0x5663bf=await _0x54149f(_0x15e4ca(0x12fe),_0x15e4ca(0x1df));_0x5663bf&&await _0x388991(_0x3e7a1b[_0x15e4ca(0x777)],!![]);}async function _0xd14fdc(_0x3947a9){const _0x3c90c5=_0x5a7792,_0x33f1d7=_0x3e7a1b[_0x3c90c5(0x999)][_0x3947a9];if(!_0x33f1d7||!_0x33f1d7[_0x3c90c5(0xcb3)][_0x3c90c5(0x1141)])return;const _0x430d54=_0x33f1d7[_0x3c90c5(0xefe)]||0x0,_0x21d270=_0x33f1d7[_0x3c90c5(0x830)][_0x3c90c5(0x156)](_0x208300=>_0x208300['timestamp']>_0x430d54&&!_0x208300[_0x3c90c5(0x5cc)]);_0x21d270['length']>=_0x33f1d7[_0x3c90c5(0xcb3)][_0x3c90c5(0x10e2)]&&(console[_0x3c90c5(0x1081)](_0x3c90c5(0xaf2)+_0x21d270['length']+'/'+_0x33f1d7['settings'][_0x3c90c5(0x10e2)]+_0x3c90c5(0xe63)),await _0x388991(_0x3947a9));}async function _0x42a14c(_0x5ec2ed,_0xd4bb9d){const _0x5b3a3d=_0x5a7792,_0x1cebbc=_0x3e7a1b[_0x5b3a3d(0x999)][_0x5ec2ed];if(!_0x1cebbc||!_0xd4bb9d)throw new Error(_0x5b3a3d(0x108f));const _0x2f7076=_0x3e7a1b['qzoneSettings'][_0x5b3a3d(0x78c)]||'用户';let _0x16657b,_0xc9cb9c=_0x1cebbc;const _0x4dd3b9=new Date()[_0x5b3a3d(0x16c)]('zh-CN',{'year':'numeric','month':_0x5b3a3d(0x572),'day':_0x5b3a3d(0x1229)});if(_0x1cebbc[_0x5b3a3d(0x1167)]){let _0x2eebc8=null;_0x42b67f[_0x5b3a3d(0xbd9)]&&(_0x2eebc8=_0x1cebbc[_0x5b3a3d(0x5d4)][_0x5b3a3d(0x137)](_0x4f7c96=>_0x4f7c96['originalName']===_0x42b67f[_0x5b3a3d(0xbd9)]));!_0x2eebc8&&(_0x2eebc8=_0x1cebbc['members']['find'](_0x56638b=>_0x56638b['id']!=='user'&&_0x42b67f[_0x5b3a3d(0x90f)][_0x5b3a3d(0x26c)](_0x463d5a=>_0x463d5a['id']===_0x56638b['id'])));!_0x2eebc8&&(_0x2eebc8=_0x1cebbc[_0x5b3a3d(0x5d4)][_0x5b3a3d(0x137)](_0x3b2e2b=>_0x3b2e2b['id']!=='user'));if(!_0x2eebc8)throw new Error(_0x5b3a3d(0x18c));const _0x5f36ba=_0x3e7a1b['chats'][_0x2eebc8['id']];if(!_0x5f36ba)throw new Error(_0x5b3a3d(0xbc7)+_0x2eebc8['groupNickname']+_0x5b3a3d(0xf3));const _0x59cbb1=_0x1cebbc[_0x5b3a3d(0xcb3)]['myPersona']||_0x5b3a3d(0x9ef);_0x16657b=_0x5b3a3d(0x54e)+_0x2eebc8[_0x5b3a3d(0x7de)]+_0x5b3a3d(0xa16)+_0x2f7076+_0x5b3a3d(0x11f5)+_0x4dd3b9+_0x5b3a3d(0x382)+_0x4dd3b9+_0x5b3a3d(0x3f1)+_0x5f36ba['settings'][_0x5b3a3d(0xbe5)]+_0x5b3a3d(0xd1a)+_0x59cbb1+_0x5b3a3d(0x1290)+_0xd4bb9d+_0x5b3a3d(0x13d)+_0x2eebc8['originalName']+_0x5b3a3d(0x8a4),_0xc9cb9c=_0x5f36ba;}else _0x16657b=_0x5b3a3d(0x54e)+_0x1cebbc['originalName']+_0x5b3a3d(0x10c4)+_0x2f7076+_0x5b3a3d(0x10e0)+_0x4dd3b9+_0x5b3a3d(0x585)+_0x4dd3b9+_0x5b3a3d(0x122a)+_0x1cebbc[_0x5b3a3d(0xcb3)][_0x5b3a3d(0xbe5)]+'\x0a\x0a#\x20你的聊天对象（用户）的人设\x0a'+_0x1cebbc[_0x5b3a3d(0xcb3)][_0x5b3a3d(0x1047)]+_0x5b3a3d(0xfca)+_0xd4bb9d+_0x5b3a3d(0x13d)+_0x1cebbc[_0x5b3a3d(0x7de)]+_0x5b3a3d(0x8a4);try{const _0x9639b=_0x3e7a1b[_0x5b3a3d(0xec0)][_0x5b3a3d(0x64b)]&&_0x3e7a1b['apiConfig'][_0x5b3a3d(0x2d3)]&&_0x3e7a1b[_0x5b3a3d(0xec0)][_0x5b3a3d(0x31f)],{proxyUrl:_0x1818ea,apiKey:_0x2182af,model:_0x213b53}=_0x9639b?{'proxyUrl':_0x3e7a1b['apiConfig'][_0x5b3a3d(0x64b)],'apiKey':_0x3e7a1b[_0x5b3a3d(0xec0)][_0x5b3a3d(0x2d3)],'model':_0x3e7a1b[_0x5b3a3d(0xec0)][_0x5b3a3d(0x31f)]}:_0x3e7a1b[_0x5b3a3d(0xec0)];if(!_0x1818ea||!_0x2182af||!_0x213b53)throw new Error('API未配置，无法进行总结。');let _0x502bc1=_0x1818ea[_0x5b3a3d(0xe53)]('generativelanguage'),_0x46939b=_0x250668(_0x213b53,_0x2182af,_0x16657b,[{'role':_0x5b3a3d(0xa4d),'content':'请开始总结。'}]);const _0x191cd7=_0x502bc1?await fetch(_0x46939b['url'],_0x46939b[_0x5b3a3d(0x88a)]):await fetch(_0x1818ea+_0x5b3a3d(0x58b),{'method':_0x5b3a3d(0x2d1),'headers':{'Content-Type':_0x5b3a3d(0x7fe),'Authorization':_0x5b3a3d(0x236)+_0x2182af},'body':JSON[_0x5b3a3d(0xe3f)]({'model':_0x213b53,'messages':[{'role':_0x5b3a3d(0x905),'content':_0x16657b},{'role':_0x5b3a3d(0xa4d),'content':_0x5b3a3d(0x647)}],'temperature':0.1})});if(!_0x191cd7['ok']){const _0x16d889=await _0x191cd7[_0x5b3a3d(0x6f8)]()[_0x5b3a3d(0x1201)](()=>({'error':{'message':_0x191cd7[_0x5b3a3d(0x132c)]}}));throw new Error(_0x5b3a3d(0xfdb)+_0x191cd7[_0x5b3a3d(0x69e)]+'\x20-\x20'+_0x16d889['error'][_0x5b3a3d(0x854)]);}const _0x2eb875=await _0x191cd7[_0x5b3a3d(0x6f8)]();let _0x37b16c=_0x502bc1?getGeminiResponseText(_0x2eb875):_0x2eb875[_0x5b3a3d(0x4fe)][0x0][_0x5b3a3d(0x854)]['content'];_0x37b16c=_0x37b16c[_0x5b3a3d(0x137f)](/^```json\s*/,'')[_0x5b3a3d(0x137f)](/```$/,'')['trim']();const _0x47c583=JSON[_0x5b3a3d(0x1214)](_0x37b16c);if(_0x47c583[_0x5b3a3d(0x1119)]&&_0x47c583[_0x5b3a3d(0x1119)]['trim']()){const _0x5c152d={'content':_0x5b3a3d(0xc51)+(_0x1cebbc['isGroup']?'群聊':'')+'通话中，'+_0x47c583[_0x5b3a3d(0x1119)][_0x5b3a3d(0x43a)]()+')','timestamp':Date[_0x5b3a3d(0x2b5)](),'source':_0x1cebbc[_0x5b3a3d(0x1167)]?_0x5b3a3d(0x47a):_0x5b3a3d(0x8ed)};if(!_0xc9cb9c[_0x5b3a3d(0x518)])_0xc9cb9c[_0x5b3a3d(0x518)]=[];return _0xc9cb9c['longTermMemory']['push'](_0x5c152d),await _0x4e1bbf[_0x5b3a3d(0x999)][_0x5b3a3d(0x4fa)](_0xc9cb9c),console[_0x5b3a3d(0x1081)](_0x5b3a3d(0xbe)+_0xc9cb9c[_0x5b3a3d(0x6fc)]+'”的长期记忆中。'),!![];}else throw new Error(_0x5b3a3d(0x10d9));}catch(_0x550a54){console[_0x5b3a3d(0xc60)](_0x5b3a3d(0x224),_0x550a54);throw _0x550a54;}}function _0x4f0430(_0x35fad2){const _0x5c9bf6=_0x5a7792,_0x548530=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯','什么','怎么','为什么','哪个','一些','这个','那个','还有']),_0x5f1596=_0x35fad2[_0x5c9bf6(0x132a)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x307145=new Map();let _0x1be563=0x0;_0x5f1596['forEach'](_0x100db2=>{const _0x2ba3a1=_0x5c9bf6;if(_0x100db2[_0x2ba3a1(0x40f)]>0x1&&!_0x548530['has'](_0x100db2)){const _0x3093b6=(_0x307145[_0x2ba3a1(0x11fc)](_0x100db2)||0x0)+0x1;_0x307145[_0x2ba3a1(0x125e)](_0x100db2,_0x3093b6);if(_0x3093b6>_0x1be563)_0x1be563=_0x3093b6;}});const _0x45dc5b=[],_0x18cfba=[],_0x2ef09e=_0x1be563*0.9,_0x403215=_0x1be563*0.6;_0x307145[_0x5c9bf6(0x103)]((_0x4b2698,_0x1b7408)=>{const _0x266584=_0x5c9bf6;if(_0x4b2698>=_0x2ef09e)_0x45dc5b[_0x266584(0x13ee)](_0x1b7408);else _0x4b2698>=_0x403215&&_0x18cfba['push'](_0x1b7408);});const _0x151df8=new Set(_0x45dc5b),_0x2ebb27=_0x18cfba[_0x5c9bf6(0x156)](_0x3c5451=>!_0x151df8[_0x5c9bf6(0x2a6)](_0x3c5451))[_0x5c9bf6(0xdf5)](0x0,0x5);return{'coreKeywords':_0x45dc5b['slice'](0x0,0x3),'situationalKeywords':_0x2ebb27};}function _0x5871dc(_0x3eba49,_0x1a278f,_0x5306a1){const _0x373f5a=_0x5a7792;let _0x51fba8;_0x5306a1==='hours'?_0x51fba8=Date[_0x373f5a(0x2b5)]()-_0x1a278f*0x3c*0x3c*0x3e8:_0x51fba8=Date[_0x373f5a(0x2b5)]()-_0x1a278f*0x18*0x3c*0x3c*0x3e8;const _0x5eb7b7=_0x3eba49[_0x373f5a(0x830)][_0x373f5a(0x156)](_0x3be80b=>_0x3be80b[_0x373f5a(0x8af)]>_0x51fba8&&!_0x3be80b[_0x373f5a(0x5cc)]);if(_0x5eb7b7[_0x373f5a(0x40f)]<0x3)return'';const _0x53ec87=_0x5eb7b7[_0x373f5a(0xb96)](_0x38a4f4=>{const _0x2dc172=_0x373f5a;if(typeof _0x38a4f4['content']===_0x2dc172(0x1251))return _0x38a4f4[_0x2dc172(0x3ba)];if(_0x38a4f4[_0x2dc172(0xafc)]===_0x2dc172(0xe76))return _0x38a4f4[_0x2dc172(0x3ba)];if(_0x38a4f4[_0x2dc172(0xafc)]===_0x2dc172(0x9cb))return(_0x38a4f4['dialogue']||'')+'\x20'+(_0x38a4f4[_0x2dc172(0x9af)]||'');return'';})[_0x373f5a(0xd22)]('\x20'),_0x28e386=new Set(['的','是','了','在','我','你','他','她','它','我们','你们','他们','这','那','一个','也','和','与','或','但','然而','所以','因此','就','都','地','得','着','过','吧','吗','呢','啊','哦','嗯']),_0x50bf73=_0x53ec87[_0x373f5a(0x132a)](/[\u4e00-\u9fa5]+|[a-zA-Z0-9]+/g)||[],_0x366330=new Map();_0x50bf73[_0x373f5a(0x103)](_0x37f778=>{const _0x105a8d=_0x373f5a;_0x37f778[_0x105a8d(0x40f)]>0x1&&!_0x28e386[_0x105a8d(0x2a6)](_0x37f778)&&_0x366330['set'](_0x37f778,(_0x366330[_0x105a8d(0x11fc)](_0x37f778)||0x0)+0x1);});const _0x37dbac=[..._0x366330[_0x373f5a(0x1052)]()]['sort']((_0x578497,_0x42bde1)=>_0x42bde1[0x1]-_0x578497[0x1])[_0x373f5a(0xb96)](_0x42c099=>_0x42c099[0x0]);if(_0x37dbac['length']===0x0)return'';let _0xa8e50b;return _0x5306a1===_0x373f5a(0x4b6)?_0xa8e50b='最近'+_0x1a278f+'小时核心议题':_0x1a278f===0x1?_0xa8e50b=_0x373f5a(0x868):_0xa8e50b='最近'+_0x1a278f+_0x373f5a(0x100a),_0x373f5a(0x9e1)+_0xa8e50b+'**:\x20关于\x20**'+_0x37dbac['slice'](0x0,0x3)[_0x373f5a(0xd22)]('、\x20')+_0x373f5a(0xa3b);}function _0x3de073(_0x1b8436){const _0x46347b=_0x5a7792;if(!_0x1b8436||typeof _0x1b8436!=='string')return null;const _0x22a8bb=_0x1b8436['replace'](/^```json\s*/,'')[_0x46347b(0x137f)](/```$/,'')[_0x46347b(0x43a)](),_0x4aff7b=_0x22a8bb[_0x46347b(0x132a)](/{[\s\S]*}/);if(_0x4aff7b)try{const _0x49f584=JSON[_0x46347b(0x1214)](_0x4aff7b[0x0]);return console[_0x46347b(0x1081)]('容错解析：策略1成功\x20(找到并解析了完整的JSON对象)'),_0x49f584;}catch(_0x55de07){console[_0x46347b(0x1155)](_0x46347b(0x143));}const _0x279241=_0x22a8bb[_0x46347b(0x132a)](/"summary"\s*:\s*"((?:[^"\\]|\\.)*)"/);if(_0x279241&&_0x279241[0x1])return console[_0x46347b(0x1081)](_0x46347b(0x1131)),{'summary':_0x279241[0x1]['replace'](/\\"/g,'\x22')};if(_0x22a8bb)return console[_0x46347b(0x1081)](_0x46347b(0x80a)),{'summary':_0x22a8bb};return null;}async function _0x5ac5c5(_0x26ad2c){const _0x3c0ecf=_0x5a7792;let _0x2fdf5b=_0x3e7a1b[_0x3c0ecf(0x999)][_0x26ad2c];if(!_0x2fdf5b)return;let _0x299295=_0x2fdf5b;if(_0x2fdf5b[_0x3c0ecf(0x1167)]){const _0x1171d8=_0x2fdf5b[_0x3c0ecf(0x5d4)][_0x3c0ecf(0xb96)](_0x384e0c=>{const _0x21c20c=_0x3c0ecf,_0x372913=_0x3e7a1b[_0x21c20c(0x999)][_0x384e0c['id']];if(_0x372913&&_0x372913[_0x21c20c(0x518)]&&_0x372913[_0x21c20c(0x518)][_0x21c20c(0x40f)]>=0x2)return{'text':_0x21c20c(0x386)+_0x384e0c[_0x21c20c(0x287)]+_0x21c20c(0x487)+_0x372913[_0x21c20c(0x518)][_0x21c20c(0x40f)]+'条)','value':_0x384e0c['id']};return null;})[_0x3c0ecf(0x156)](Boolean);if(_0x1171d8['length']===0x0){alert(_0x3c0ecf(0x10b1));return;}const _0x591d6f=await _0x217169(_0x3c0ecf(0x12ae),_0x1171d8);if(!_0x591d6f)return;_0x299295=_0x3e7a1b[_0x3c0ecf(0x999)][_0x591d6f];}if(!_0x299295[_0x3c0ecf(0x518)]||_0x299295[_0x3c0ecf(0x518)][_0x3c0ecf(0x40f)]<0x2){alert('“'+_0x299295[_0x3c0ecf(0x6fc)]+_0x3c0ecf(0x1354));return;}const _0x550577=_0x299295['longTermMemory']['length'],_0x2a6997=await _0x217169(_0x3c0ecf(0xdd),[{'text':_0x3c0ecf(0x1e9)+_0x550577+'条)','value':_0x3c0ecf(0xfd7)},{'text':_0x3c0ecf(0xa33),'value':'20'},{'text':_0x3c0ecf(0x633),'value':'50'},{'text':_0x3c0ecf(0xaf7),'value':'100'},{'text':_0x3c0ecf(0x823),'value':_0x3c0ecf(0xea0)}]['filter'](_0x43b42b=>_0x43b42b[_0x3c0ecf(0xbed)]==='all'||_0x43b42b['value']===_0x3c0ecf(0xea0)||parseInt(_0x43b42b[_0x3c0ecf(0xbed)])<_0x550577));if(_0x2a6997===null)return;let _0x126611,_0x21af89=_0x550577;if(_0x2a6997===_0x3c0ecf(0xfd7))_0x126611=[..._0x299295[_0x3c0ecf(0x518)]];else{if(_0x2a6997===_0x3c0ecf(0xea0)){const _0x2cc49c=await _0x41e3f8(_0x3c0ecf(0x9c4),_0x3c0ecf(0x12a9)+_0x550577+'\x20条)');if(_0x2cc49c===null)return;const _0x38d1b1=parseInt(_0x2cc49c);if(isNaN(_0x38d1b1)||_0x38d1b1<0x2||_0x38d1b1>_0x550577){alert(_0x3c0ecf(0xf8e)+_0x550577+_0x3c0ecf(0xe19));return;}_0x21af89=_0x38d1b1,_0x126611=_0x299295['longTermMemory'][_0x3c0ecf(0xdf5)](-_0x21af89);}else _0x21af89=parseInt(_0x2a6997),_0x21af89>=_0x550577?(_0x126611=[..._0x299295['longTermMemory']],_0x21af89=_0x550577):_0x126611=_0x299295['longTermMemory'][_0x3c0ecf(0xdf5)](-_0x21af89);}const _0x5d2e4f=await _0x41e3f8('设置精炼字数',_0x3c0ecf(0xc90),_0x3c0ecf(0xc04));if(_0x5d2e4f===null)return;const _0x57159b=parseInt(_0x5d2e4f);if(isNaN(_0x57159b)||_0x57159b<0x14){alert(_0x3c0ecf(0xf52));return;}const _0x154597=await _0x54149f(_0x3c0ecf(0x4b7),_0x3c0ecf(0x516)+_0x21af89+_0x3c0ecf(0x1c8)+_0x57159b+_0x3c0ecf(0x133e),{'confirmButtonClass':_0x3c0ecf(0xeed),'confirmText':_0x3c0ecf(0xd9c)});if(!_0x154597)return;const _0x2741cb=_0x126611[_0x3c0ecf(0xb96)](_0x51f40d=>'-\x20'+_0x51f40d[_0x3c0ecf(0x3ba)])[_0x3c0ecf(0xd22)]('\x0a'),_0x28d3d7=_0x3e7a1b[_0x3c0ecf(0x3c2)][_0x3c0ecf(0x78c)]||'用户',_0x10bfaf=new Date()['toLocaleDateString']('zh-CN',{'year':_0x3c0ecf(0x1229),'month':_0x3c0ecf(0x572),'day':_0x3c0ecf(0x1229)}),_0x570b15=_0x3c0ecf(0x54e)+_0x299295[_0x3c0ecf(0x7de)]+_0x3c0ecf(0xb92)+_0x28d3d7+_0x3c0ecf(0x620)+_0x10bfaf+_0x3c0ecf(0x13e)+_0x10bfaf+'”这个信息，将其转换为【具体的公历日期】。\x0a4.\x20\x20**【风格要求】**:\x20你的总结应该像一份清晰的个人档案或事件回顾，而不是一篇情感散文。请删除重复、琐碎或纯粹的情感宣泄，只保留对情节和关系发展至关重要的部分。\x0a5.\x20\x20**【【【长度铁律】】】**:\x20你的总结【必须】非常精炼，总长度应控制在\x20**'+_0x57159b+'\x20字左右**。\x0a6.\x20\x20**【输出格式】**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20`{\x22summary\x22:\x20\x22在这里写下你以第一人称视角，总结好的核心事实与计划。\x22}`\x0a\x0a#\x20你的角色设定\x20(必须严格遵守)\x0a'+_0x299295[_0x3c0ecf(0xcb3)][_0x3c0ecf(0xbe5)]+_0x3c0ecf(0xd1a)+_0x299295[_0x3c0ecf(0xcb3)][_0x3c0ecf(0x1047)]+_0x3c0ecf(0x4c6)+_0x2741cb+_0x3c0ecf(0x13d)+_0x299295[_0x3c0ecf(0x7de)]+_0x3c0ecf(0xb2);await _0x28974b(_0x3c0ecf(0x2f7),_0x3c0ecf(0xc72));try{const _0x4a57ec=_0x3e7a1b[_0x3c0ecf(0xec0)][_0x3c0ecf(0x64b)]&&_0x3e7a1b[_0x3c0ecf(0xec0)][_0x3c0ecf(0x2d3)]&&_0x3e7a1b[_0x3c0ecf(0xec0)][_0x3c0ecf(0x31f)],{proxyUrl:_0x181d0e,apiKey:_0x3e86c3,model:_0x3689cf}=_0x4a57ec?{'proxyUrl':_0x3e7a1b['apiConfig'][_0x3c0ecf(0x64b)],'apiKey':_0x3e7a1b[_0x3c0ecf(0xec0)][_0x3c0ecf(0x2d3)],'model':_0x3e7a1b['apiConfig'][_0x3c0ecf(0x31f)]}:_0x3e7a1b['apiConfig'];if(!_0x181d0e||!_0x3e86c3||!_0x3689cf)throw new Error(_0x3c0ecf(0x392));let _0x5c8e9f=_0x181d0e[_0x3c0ecf(0xe53)](_0x3c0ecf(0x742)),_0x558790=_0x250668(_0x3689cf,_0x3e86c3,_0x570b15,[{'role':_0x3c0ecf(0xa4d),'content':_0x3c0ecf(0x4cb)}]);const _0x362fa9=_0x5c8e9f?await fetch(_0x558790[_0x3c0ecf(0xe52)],_0x558790[_0x3c0ecf(0x88a)]):await fetch(_0x181d0e+_0x3c0ecf(0x58b),{'method':_0x3c0ecf(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0x3c0ecf(0x236)+_0x3e86c3},'body':JSON['stringify']({'model':_0x3689cf,'messages':[{'role':'system','content':_0x570b15},{'role':_0x3c0ecf(0xa4d),'content':_0x3c0ecf(0x4cb)}],'temperature':0.2})});if(!_0x362fa9['ok'])throw new Error(_0x3c0ecf(0x1fa)+_0x362fa9[_0x3c0ecf(0x132c)]);const _0x99ea=await _0x362fa9['json']();let _0x2e257f=_0x5c8e9f?getGeminiResponseText(_0x99ea):_0x99ea[_0x3c0ecf(0x4fe)][0x0][_0x3c0ecf(0x854)][_0x3c0ecf(0x3ba)];const _0x371e13=_0x3de073(_0x2e257f);if(_0x371e13&&_0x371e13[_0x3c0ecf(0x1119)]&&typeof _0x371e13[_0x3c0ecf(0x1119)]===_0x3c0ecf(0x1251)&&_0x371e13['summary'][_0x3c0ecf(0x43a)]()){const _0x1777e4=await _0x54149f(_0x3c0ecf(0xef4),_0x3c0ecf(0x6f3)+_0x21af89+'\x20条旧记忆总结为以下核心记忆：<br><br><div\x20class=\x22scrollable-content-preview\x22>'+_0x371e13['summary']['trim']()+_0x3c0ecf(0x7ca),{'confirmText':_0x3c0ecf(0x18e),'cancelText':_0x3c0ecf(0x107a),'confirmButtonClass':_0x3c0ecf(0xeed)});if(_0x1777e4){const _0x3ef244={'content':_0x371e13[_0x3c0ecf(0x1119)]['trim'](),'timestamp':Date[_0x3c0ecf(0x2b5)](),'source':'refined'},_0x1a9693=_0x550577-_0x21af89,_0xb91457=_0x1a9693>0x0?_0x299295['longTermMemory'][_0x3c0ecf(0xdf5)](0x0,_0x1a9693):[];_0x299295[_0x3c0ecf(0x518)]=[..._0xb91457,_0x3ef244],_0x299295[_0x3c0ecf(0xefe)]=Date[_0x3c0ecf(0x2b5)](),await _0x4e1bbf[_0x3c0ecf(0x999)][_0x3c0ecf(0x4fa)](_0x299295),document[_0x3c0ecf(0x64f)](_0x3c0ecf(0x33f))[_0x3c0ecf(0x418)]['contains'](_0x3c0ecf(0x12ef))&&_0x17f3c1(),await _0x28974b('精炼成功',_0x3c0ecf(0x559)+_0x21af89+'\x20条记忆精炼为\x201\x20条核心记忆！');}else await _0x28974b(_0x3c0ecf(0xe83),_0x3c0ecf(0x8df));}else throw new Error(_0x3c0ecf(0x10d9));}catch(_0x51add5){console['error'](_0x3c0ecf(0x4c5),_0x51add5),await _0x28974b(_0x3c0ecf(0xade),_0x3c0ecf(0x10f3)+_0x51add5[_0x3c0ecf(0x854)]);}}async function _0x388991(_0x23bad1,_0x1aeb59=![]){const _0x20f414=_0x5a7792,_0x1f5494=_0x3e7a1b[_0x20f414(0x999)][_0x23bad1];if(!_0x1f5494)return;const _0x560c62=_0x1f5494[_0x20f414(0xefe)]||0x0,_0x281df4=_0x1aeb59?_0x1f5494[_0x20f414(0x830)][_0x20f414(0x156)](_0xaed194=>!_0xaed194[_0x20f414(0x5cc)]||_0xaed194[_0x20f414(0x931)]===_0x20f414(0x905)&&_0xaed194[_0x20f414(0x3ba)][_0x20f414(0xe53)](_0x20f414(0x11e2)))[_0x20f414(0xdf5)](-(_0x1f5494['settings']['autoMemoryInterval']||0x14)):_0x1f5494[_0x20f414(0x830)][_0x20f414(0x156)](_0x2ee4de=>_0x2ee4de[_0x20f414(0x8af)]>_0x560c62&&(!_0x2ee4de[_0x20f414(0x5cc)]||_0x2ee4de[_0x20f414(0x931)]==='system'&&_0x2ee4de['content'][_0x20f414(0xe53)](_0x20f414(0x11e2))));if(_0x281df4[_0x20f414(0x40f)]<0x5){if(_0x1aeb59)alert(_0x20f414(0xa20));return;}const _0x344ce2=_0x3e7a1b[_0x20f414(0x3c2)]['nickname']||'用户',_0x59af45=_0x281df4[_0x20f414(0xb96)](_0x60f78e=>{const _0xa7b61a=_0x20f414;if(_0x60f78e['isHidden']&&_0x60f78e[_0xa7b61a(0x931)]===_0xa7b61a(0x905)&&_0x60f78e[_0xa7b61a(0x3ba)][_0xa7b61a(0xe53)](_0xa7b61a(0x11e2)))return _0x60f78e[_0xa7b61a(0x3ba)];let _0xbdcb00;_0x60f78e[_0xa7b61a(0x931)]===_0xa7b61a(0xa4d)?_0xbdcb00=_0x344ce2:_0xbdcb00=_0x60f78e[_0xa7b61a(0x133d)]||_0x1f5494[_0xa7b61a(0x7de)];let _0x39e3e9='';if(_0x60f78e['type']===_0xa7b61a(0x9cb)){if(_0x60f78e[_0xa7b61a(0x3ba)])_0x39e3e9=_0x60f78e['content'];else{const _0x36b212=_0x60f78e['dialogue']?'「'+_0x60f78e['dialogue']+'」':'',_0x37a25b=_0x60f78e['description']?'('+_0x60f78e[_0xa7b61a(0x9af)]+')':'';_0x39e3e9=(_0x36b212+'\x20'+_0x37a25b)[_0xa7b61a(0x43a)]();}}else _0x39e3e9=String(_0x60f78e[_0xa7b61a(0x3ba)]);return _0xbdcb00+':\x20'+_0x39e3e9;})['join']('\x0a');let _0x129543;if(_0x1f5494[_0x20f414(0x1167)])_0x129543='\x0a#\x20你的任务\x0a你是一个高级的“记忆分配专家”。你的任务是阅读下面的群聊记录，并为【每一个参与的AI角色】生成一段【个性化的、第一人称】的长期记忆。\x0a#\x20核心规则\x0a1.\x20\x20**视角铁律**:\x20每一条总结都【必须】使用【第一人称视角\x20(\x22我\x22)】。\x0a2.\x20\x20**内容核心**:\x20重点总结：我说过的话、我做过的事、别人对我说的话、与我相关的事、以及对我个人很重要的群聊事件、关键信息和心理活动。\x0a3.\x20\x20**【简洁性铁律】**:\x20每条个人记忆总结【绝对不能超过60个字】。\x0a4.\x20\x20**【省略规则】**:\x20如果一个角色在本次对话中【完全没有参与或提及】，你可以省略TA的记忆。\x0a5.\x20\x20**输出格式**:\x20你的回复【必须且只能】是一个JSON对象，格式如下：\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22summaries\x22:\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名A\x22:\x20\x22我今天在群里和大家讨论了电影，感觉很开心。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22角色的本名B\x22:\x20\x22我在群里和'+_0x344ce2+_0x20f414(0x267)+_0x59af45+_0x20f414(0xdb3)+_0x1f5494[_0x20f414(0x5d4)][_0x20f414(0xb96)](_0x2dd207=>'-\x20'+_0x2dd207[_0x20f414(0x287)]+'\x20(本名:\x20'+_0x2dd207['originalName']+')')[_0x20f414(0xd22)]('\x0a')+_0x20f414(0x357);else{const _0x15ef2a=new Date()['toLocaleDateString'](_0x20f414(0x6ec),{'year':_0x20f414(0x1229),'month':_0x20f414(0x572),'day':_0x20f414(0x1229)});_0x129543='\x0a#\x20你的任务\x0a你就是角色“'+_0x1f5494[_0x20f414(0x7de)]+'”。请你回顾一下刚才和“'+_0x344ce2+'”的对话，然后用【第一人称\x20(\x22我\x22)】的口吻，总结出一段简短的、客观的、包含关键信息的记忆。\x0a\x0a#\x20当前时间\x0a-\x20**今天是：'+_0x15ef2a+_0x20f414(0x1067)+_0x15ef2a+_0x20f414(0x2b7)+new Date(Date[_0x20f414(0x2b5)]()+0x5265c00)[_0x20f414(0x16c)](_0x20f414(0x6ec),{'month':_0x20f414(0x572),'day':_0x20f414(0x1229)})+_0x20f414(0xacc)+_0x1f5494['settings'][_0x20f414(0xbe5)]+_0x20f414(0x9a9)+_0x1f5494[_0x20f414(0xcb3)]['myPersona']+_0x20f414(0x847)+_0x59af45+'\x0a\x0a现在，请以“'+_0x1f5494['originalName']+'”的身份，开始你的客观总结。';}try{const _0x82df02=_0x3e7a1b[_0x20f414(0xec0)][_0x20f414(0x64b)]&&_0x3e7a1b[_0x20f414(0xec0)][_0x20f414(0x2d3)]&&_0x3e7a1b['apiConfig'][_0x20f414(0x31f)],{proxyUrl:_0x59e141,apiKey:_0x31c864,model:_0x1b52c4}=_0x82df02?{'proxyUrl':_0x3e7a1b[_0x20f414(0xec0)][_0x20f414(0x64b)],'apiKey':_0x3e7a1b[_0x20f414(0xec0)]['secondaryApiKey'],'model':_0x3e7a1b[_0x20f414(0xec0)]['secondaryModel']}:_0x3e7a1b[_0x20f414(0xec0)];if(!_0x59e141||!_0x31c864||!_0x1b52c4)throw new Error(_0x20f414(0xba3));let _0x21b93b=_0x59e141[_0x20f414(0xe53)]('generativelanguage'),_0x169634=_0x250668(_0x1b52c4,_0x31c864,_0x129543,[{'role':'user','content':_0x20f414(0x647)}]);const _0x39a229=_0x21b93b?await fetch(_0x169634[_0x20f414(0xe52)],_0x169634['data']):await fetch(_0x59e141+_0x20f414(0x58b),{'method':_0x20f414(0x2d1),'headers':{'Content-Type':_0x20f414(0x7fe),'Authorization':_0x20f414(0x236)+_0x31c864},'body':JSON['stringify']({'model':_0x1b52c4,'messages':[{'role':_0x20f414(0x905),'content':_0x129543},{'role':_0x20f414(0xa4d),'content':_0x20f414(0x647)}],'temperature':0.2})});if(!_0x39a229['ok'])throw new Error(_0x20f414(0x1fa)+_0x39a229[_0x20f414(0x132c)]);const _0x190ff6=await _0x39a229['json']();let _0x55a5bc=_0x21b93b?getGeminiResponseText(_0x190ff6):_0x190ff6['choices'][0x0][_0x20f414(0x854)][_0x20f414(0x3ba)];_0x55a5bc=_0x55a5bc['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x20f414(0x43a)]();const _0x350287=JSON[_0x20f414(0x1214)](_0x55a5bc);if(_0x1f5494[_0x20f414(0x1167)]){if(_0x350287[_0x20f414(0x65d)]&&typeof _0x350287[_0x20f414(0x65d)]===_0x20f414(0x59a)){let _0x53a5de=0x0;for(const _0x55b4de in _0x350287['summaries']){const _0x3fca94=_0x350287[_0x20f414(0x65d)][_0x55b4de];if(_0x3fca94&&_0x3fca94[_0x20f414(0x43a)]()){const _0x3f1c07=Object[_0x20f414(0xd6d)](_0x3e7a1b[_0x20f414(0x999)])[_0x20f414(0x137)](_0x233bf8=>_0x233bf8[_0x20f414(0x7de)]===_0x55b4de);if(_0x3f1c07){const _0x37436a={'content':_0x3fca94[_0x20f414(0x43a)](),'timestamp':Date[_0x20f414(0x2b5)](),'source':_0x20f414(0x2d2)+_0x1f5494['name']};if(!_0x3f1c07[_0x20f414(0x518)])_0x3f1c07[_0x20f414(0x518)]=[];_0x3f1c07[_0x20f414(0x518)][_0x20f414(0x13ee)](_0x37436a),await _0x4e1bbf['chats']['put'](_0x3f1c07),_0x53a5de++;}}}if(_0x53a5de>0x0)console[_0x20f414(0x1081)](_0x20f414(0xb5b)+_0x53a5de+_0x20f414(0x449));else throw new Error('AI返回了空的或格式不正确的总结内容。');}else throw new Error(_0x20f414(0xe4f));}else{if(_0x350287[_0x20f414(0x1119)]&&_0x350287['summary']['trim']()){const _0x254455={'content':_0x350287[_0x20f414(0x1119)][_0x20f414(0x43a)](),'timestamp':Date['now'](),'source':'auto'};_0x1f5494[_0x20f414(0x518)][_0x20f414(0x13ee)](_0x254455),await _0x4e1bbf[_0x20f414(0x999)]['put'](_0x1f5494),console[_0x20f414(0x1081)](_0x20f414(0x11fe));}else throw new Error('AI返回了空的或格式不正确的总结内容。');}_0x1f5494[_0x20f414(0xefe)]=_0x281df4['slice'](-0x1)[0x0][_0x20f414(0x8af)],await _0x4e1bbf[_0x20f414(0x999)]['put'](_0x1f5494),document[_0x20f414(0x64f)](_0x20f414(0x33f))['classList']['contains'](_0x20f414(0x12ef))&&_0x17f3c1();}catch(_0x34e44d){console['error'](_0x20f414(0x2fe),_0x34e44d),await _0x28974b(_0x20f414(0x118b),_0x20f414(0x549)+_0x34e44d[_0x20f414(0x854)]);}}function _0x110873(){const _0x3f8bde=_0x5a7792;if(!_0x5096e4)return;const _0x585bc5=_0x3e7a1b['chats'][_0x3e7a1b[_0x3f8bde(0x777)]],_0x21c4bb=_0x585bc5[_0x3f8bde(0x830)][_0x3f8bde(0x137)](_0x245add=>_0x245add[_0x3f8bde(0x8af)]===_0x5096e4);if(!_0x21c4bb)return;let _0x52925f;_0x21c4bb[_0x3f8bde(0x931)]===_0x3f8bde(0xa4d)?_0x52925f=_0x585bc5[_0x3f8bde(0x1167)]?_0x585bc5[_0x3f8bde(0xcb3)]['myNickname']||'我':'我':_0x585bc5['isGroup']?_0x52925f=_0x1409fb(_0x585bc5,_0x21c4bb[_0x3f8bde(0x133d)]):_0x52925f=_0x585bc5[_0x3f8bde(0x6fc)];const _0x249eec=String(_0x21c4bb['content']||'');let _0x3eeaaa='';if(typeof _0x21c4bb[_0x3f8bde(0x3ba)]==='string'&&_0x442b6b[_0x3f8bde(0x4af)](_0x21c4bb[_0x3f8bde(0x3ba)]))_0x3eeaaa=_0x3f8bde(0x4fb);else{if(_0x21c4bb[_0x3f8bde(0xafc)]===_0x3f8bde(0x118)||_0x21c4bb[_0x3f8bde(0xafc)]==='user_photo')_0x3eeaaa=_0x3f8bde(0x26a);else _0x21c4bb['type']==='voice_message'?_0x3eeaaa=_0x3f8bde(0x28a):_0x3eeaaa=_0x249eec['substring'](0x0,0x32)+(_0x249eec[_0x3f8bde(0x40f)]>0x32?_0x3f8bde(0x3cd):'');}_0x170cc3={'timestamp':_0x21c4bb[_0x3f8bde(0x8af)],'senderName':_0x52925f,'content':_0x249eec};const _0x54ca41=document[_0x3f8bde(0x64f)](_0x3f8bde(0xc4c));_0x54ca41[_0x3f8bde(0x49c)](_0x3f8bde(0xdbf))[_0x3f8bde(0xee5)]=_0x3f8bde(0x2d4)+_0x170cc3[_0x3f8bde(0x133d)]+':',_0x54ca41[_0x3f8bde(0x49c)]('.text')[_0x3f8bde(0xee5)]=_0x3eeaaa,_0x54ca41[_0x3f8bde(0x731)]['display']=_0x3f8bde(0xb37),_0x4a722d(),document[_0x3f8bde(0x64f)]('chat-input')[_0x3f8bde(0x1218)]();}function _0x34ff23(){const _0x5e692a=_0x5a7792;_0x170cc3=null,document[_0x5e692a(0x64f)]('reply-preview-bar')[_0x5e692a(0x731)]['display']=_0x5e692a(0x1209);}let _0x459f6e=null;function _0x268b16(_0x26621c){const _0x3ce7c5=_0x5a7792;_0x459f6e=_0x26621c;const _0x477d6a=_0x3e7a1b['chats'][_0x3e7a1b[_0x3ce7c5(0x777)]],_0x1b253c=_0x477d6a[_0x3ce7c5(0x830)][_0x3ce7c5(0x137)](_0x1caa4d=>_0x1caa4d[_0x3ce7c5(0x8af)]===_0x26621c);_0x1b253c&&(document[_0x3ce7c5(0x64f)](_0x3ce7c5(0x374))[_0x3ce7c5(0xee5)]=_0x1b253c[_0x3ce7c5(0x133d)]),document[_0x3ce7c5(0x64f)](_0x3ce7c5(0x1309))[_0x3ce7c5(0x418)][_0x3ce7c5(0xdda)]('visible');}function _0x5e89d0(){const _0x3aa447=_0x5a7792;document[_0x3aa447(0x64f)]('transfer-actions-modal')['classList'][_0x3aa447(0x1275)]('visible'),_0x459f6e=null;}async function _0x2c9f3b(_0x2fa601){const _0x5068a8=_0x5a7792;if(!_0x459f6e)return;const _0x4c22c5=_0x459f6e,_0x4f76cd=_0x3e7a1b[_0x5068a8(0x999)][_0x3e7a1b['activeChatId']],_0x33f66a=_0x4f76cd[_0x5068a8(0x830)]['findIndex'](_0x4aa057=>_0x4aa057[_0x5068a8(0x8af)]===_0x4c22c5);if(_0x33f66a===-0x1)return;const _0x4d91ce=_0x4f76cd[_0x5068a8(0x830)][_0x33f66a];_0x4d91ce[_0x5068a8(0x69e)]=_0x2fa601;let _0x44972e;if(_0x2fa601===_0x5068a8(0x860)){const _0x2197e3={'role':_0x5068a8(0xa4d),'type':_0x5068a8(0xcda),'isRefund':!![],'amount':_0x4d91ce[_0x5068a8(0x12fc)],'note':_0x5068a8(0x13b5),'timestamp':Date['now']()};_0x4f76cd[_0x5068a8(0x830)][_0x5068a8(0x13ee)](_0x2197e3),_0x44972e='[系统提示：你拒绝并退还了“'+_0x4d91ce['senderName']+'”的转账。]';}else _0x44972e=_0x5068a8(0x1118)+_0x4d91ce[_0x5068a8(0x133d)]+_0x5068a8(0x36c);const _0x5db120={'role':_0x5068a8(0x905),'content':_0x44972e,'timestamp':Date[_0x5068a8(0x2b5)]()+0x1,'isHidden':!![]};_0x4f76cd[_0x5068a8(0x830)][_0x5068a8(0x13ee)](_0x5db120),await _0x4e1bbf['chats'][_0x5068a8(0x4fa)](_0x4f76cd),_0x5e89d0(),_0x4817d1(_0x3e7a1b[_0x5068a8(0x777)]),_0x21f6ea();}async function _0x2868c5(){const _0x4dadb0=_0x5a7792;_0xddd8ae(_0x4dadb0(0x12c0));const _0x27bbeb=document['getElementById'](_0x4dadb0(0x119d)),_0x423fca=document[_0x4dadb0(0x64f)](_0x4dadb0(0xfb));_0x27bbeb[_0x4dadb0(0xc58)]='',_0x423fca[_0x4dadb0(0xee5)]=_0x4dadb0(0x670);const _0x161378=await _0x4e1bbf[_0x4dadb0(0xbdb)]['orderBy'](_0x4dadb0(0x8af))[_0x4dadb0(0x2f4)]()[_0x4dadb0(0x78f)]();if(_0x161378[_0x4dadb0(0x40f)]===0x0){_0x27bbeb['innerHTML']=_0x4dadb0(0x5ef);return;}_0x161378['forEach'](_0x4932ab=>{const _0x540cf3=_0x4dadb0,_0x554b36=_0x4f73e4(_0x4932ab);_0xb407a5(_0x554b36,async()=>{const _0x3ebeda=_0x2bd6,_0x3412a9=await _0x41e3f8('自定义通话名称',_0x3ebeda(0x53c),_0x4932ab[_0x3ebeda(0x3ce)]||'');if(_0x3412a9===null)return;await _0x4e1bbf['callRecords'][_0x3ebeda(0x32e)](_0x4932ab['id'],{'customName':_0x3412a9[_0x3ebeda(0x43a)]()}),await _0x2868c5(),await _0x28974b('成功',_0x3ebeda(0x187));}),_0x27bbeb[_0x540cf3(0x99e)](_0x554b36);});}function _0x4f73e4(_0x10fb50){const _0x315c51=_0x5a7792,_0x177a6d=document[_0x315c51(0x124e)](_0x315c51(0x479));_0x177a6d['className']=_0x315c51(0x1224),_0x177a6d[_0x315c51(0x12e1)][_0x315c51(0x806)]=_0x10fb50['id'];const _0x5b4555=_0x3e7a1b[_0x315c51(0x999)][_0x10fb50[_0x315c51(0x367)]],_0x3ddf93=_0x5b4555?_0x5b4555[_0x315c51(0x6fc)]:_0x315c51(0xe10),_0x330aee=new Date(_0x10fb50[_0x315c51(0x8af)]),_0x1378aa=_0x330aee[_0x315c51(0xf87)]()+'-'+String(_0x330aee[_0x315c51(0x38b)]()+0x1)[_0x315c51(0xf2)](0x2,'0')+'-'+String(_0x330aee['getDate']())[_0x315c51(0xf2)](0x2,'0')+'\x20'+String(_0x330aee[_0x315c51(0xdb)]())[_0x315c51(0xf2)](0x2,'0')+':'+String(_0x330aee[_0x315c51(0x14f)]())[_0x315c51(0xf2)](0x2,'0'),_0x75ef71=Math[_0x315c51(0x1245)](_0x10fb50[_0x315c51(0x25e)]/0x3c)+'分'+_0x10fb50[_0x315c51(0x25e)]%0x3c+'秒',_0x2adedd=_0x10fb50['participants'][_0x315c51(0xb96)](_0x439f43=>_0x315c51(0x86)+_0x439f43['avatar']+_0x315c51(0xa7b)+_0x439f43['name']+_0x315c51(0xab)+_0x439f43[_0x315c51(0x6fc)]+'\x22>')[_0x315c51(0xd22)]('');return _0x177a6d[_0x315c51(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22date\x22>'+_0x1378aa+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22duration\x22>'+_0x75ef71+_0x315c51(0x3ec)+(_0x10fb50['customName']?_0x315c51(0x6e8)+_0x10fb50[_0x315c51(0x3ce)]+_0x315c51(0x4b1):'')+_0x315c51(0xb1b)+_0x2adedd+_0x315c51(0xb74)+_0x3ddf93+_0x315c51(0xcb1),_0x177a6d;}async function _0x33f10f(_0xd31a9){const _0x2290da=_0x5a7792,_0x5685b9=await _0x4e1bbf['callRecords']['get'](_0xd31a9);if(!_0x5685b9)return;const _0x463e4d=document[_0x2290da(0x64f)](_0x2290da(0xc65)),_0x5cdbf8=document['getElementById']('transcript-modal-title'),_0x356f9a=document[_0x2290da(0x64f)](_0x2290da(0x125b));_0x5cdbf8['textContent']=_0x2290da(0xbd4)+new Date(_0x5685b9[_0x2290da(0x8af)])[_0x2290da(0x2b4)]()+_0x2290da(0x1240)+Math[_0x2290da(0x1245)](_0x5685b9[_0x2290da(0x25e)]/0x3c)+'分'+_0x5685b9[_0x2290da(0x25e)]%0x3c+'秒)',_0x356f9a[_0x2290da(0xc58)]='';const _0x4a7dd3=document[_0x2290da(0x64f)](_0x2290da(0x10e4)),_0x20271d=document['getElementById'](_0x2290da(0x1208));!_0x5685b9[_0x2290da(0x20c)]||_0x5685b9[_0x2290da(0x20c)][_0x2290da(0x40f)]===0x0?(_0x356f9a['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x22>这次通话没有留下文字记录。</p>',_0x20271d[_0x2290da(0x731)][_0x2290da(0x130)]=_0x2290da(0x1209)):(_0x20271d[_0x2290da(0x731)]['display']=_0x2290da(0xb37),_0x5685b9[_0x2290da(0x20c)]['forEach'](_0x147d40=>{const _0x42a52b=_0x2290da,_0x1ac4c3=document[_0x42a52b(0x124e)]('div');_0x1ac4c3[_0x42a52b(0x87d)]=_0x42a52b(0xd5c)+_0x147d40['role'],_0x1ac4c3[_0x42a52b(0xee5)]=_0x147d40['content'],_0x356f9a[_0x42a52b(0x99e)](_0x1ac4c3);}));const _0x38d36e=_0x4a7dd3['cloneNode'](!![]);_0x4a7dd3[_0x2290da(0x9be)][_0x2290da(0x3d4)](_0x38d36e,_0x4a7dd3);const _0x2fa9cf=_0x20271d[_0x2290da(0xc66)](!![]);_0x20271d[_0x2290da(0x9be)][_0x2290da(0x3d4)](_0x2fa9cf,_0x20271d),_0x38d36e[_0x2290da(0xf72)](_0x2290da(0x1080),async()=>{const _0x48d4ae=_0x2290da,_0x437387=await _0x54149f('确认删除','确定要永久删除这条通话记录吗？此操作不可恢复。',{'confirmButtonClass':_0x48d4ae(0xeed)});_0x437387&&(_0x463e4d[_0x48d4ae(0x418)]['remove'](_0x48d4ae(0x40a)),await _0x4e1bbf['callRecords']['delete'](_0xd31a9),await _0x2868c5(),alert(_0x48d4ae(0x1307)));}),_0x2fa9cf[_0x2290da(0xf72)]('click',async()=>{const _0x32aa39=_0x2290da,_0x212234=await _0x54149f(_0x32aa39(0x12fe),_0x32aa39(0x12ec),{'confirmText':_0x32aa39(0xe38)});if(!_0x212234)return;_0x463e4d[_0x32aa39(0x418)][_0x32aa39(0x1275)](_0x32aa39(0x40a));const _0x653fac=_0x3e7a1b[_0x32aa39(0x999)][_0x5685b9[_0x32aa39(0x367)]];if(!_0x653fac){alert(_0x32aa39(0x70d));return;}await _0x28974b(_0x32aa39(0x2f7),'正在请求AI进行手动总结...');try{const _0x56b0b4=_0x5685b9[_0x32aa39(0x20c)][_0x32aa39(0xb96)](_0x44ebd9=>{const _0xe960ac=_0x32aa39,_0x570e22=_0x44ebd9[_0xe960ac(0x931)]===_0xe960ac(0xa4d)?_0x653fac[_0xe960ac(0xcb3)]['myNickname']||'我':_0x44ebd9[_0xe960ac(0x133d)]||_0x653fac[_0xe960ac(0x6fc)];return _0x570e22+':\x20'+_0x44ebd9['content'];})[_0x32aa39(0xd22)]('\x0a');await _0x42a14c(_0x5685b9[_0x32aa39(0x367)],_0x56b0b4),await _0x28974b(_0x32aa39(0x7b5),_0x32aa39(0x4c8)+_0x653fac['name']+_0x32aa39(0x1016));}catch(_0x3dd5ca){await _0x28974b('总结失败',_0x32aa39(0x99a)+_0x3dd5ca[_0x32aa39(0x854)]);}});const _0x3b5458=document[_0x2290da(0x64f)](_0x2290da(0xdba)),_0x47e008=_0x3b5458[_0x2290da(0xc66)](!![]);_0x3b5458['parentNode'][_0x2290da(0x3d4)](_0x47e008,_0x3b5458),_0x47e008[_0x2290da(0xf72)](_0x2290da(0x1080),()=>{const _0x5c241a=_0x2290da;_0x463e4d[_0x5c241a(0x418)][_0x5c241a(0x1275)]('visible');}),_0x463e4d['classList'][_0x2290da(0xdda)]('visible');}async function _0x5b14a4(){const _0x3a9915=_0x5a7792;if(!_0x3e7a1b[_0x3a9915(0x777)]||_0x3e7a1b[_0x3a9915(0x999)][_0x3e7a1b[_0x3a9915(0x777)]][_0x3a9915(0x1167)])return;const _0x3f1cd9=_0x3e7a1b[_0x3a9915(0x999)][_0x3e7a1b['activeChatId']],_0x521a9c=await _0x41e3f8('编辑对方状态',_0x3a9915(0x70),_0x3f1cd9[_0x3a9915(0x69e)]['text']);_0x521a9c!==null&&(_0x3f1cd9[_0x3a9915(0x69e)][_0x3a9915(0x673)]=_0x521a9c[_0x3a9915(0x43a)]()||'在线',_0x3f1cd9[_0x3a9915(0x69e)][_0x3a9915(0x91b)]=![],_0x3f1cd9['status'][_0x3a9915(0xea4)]=Date['now'](),await _0x4e1bbf['chats'][_0x3a9915(0x4fa)](_0x3f1cd9),_0x4817d1(_0x3e7a1b[_0x3a9915(0x777)]),_0x21f6ea(),await _0x28974b(_0x3a9915(0x27b),'“'+_0x3f1cd9[_0x3a9915(0x6fc)]+_0x3a9915(0xcfa)+_0x3f1cd9['status'][_0x3a9915(0x673)]));}async function _0xba611b(){const _0x47c2df=_0x5a7792,_0x3c6bde=document[_0x47c2df(0x64f)](_0x47c2df(0x1137)),_0x4753a=document[_0x47c2df(0x64f)](_0x47c2df(0x485));_0x4753a[_0x47c2df(0xc58)]='';const _0x1f2a68=Object[_0x47c2df(0xd6d)](_0x3e7a1b[_0x47c2df(0x999)]);_0x1f2a68['forEach'](_0x14456d=>{const _0x1d2721=_0x47c2df,_0x23c63a=document[_0x1d2721(0x124e)](_0x1d2721(0x479));_0x23c63a['className']=_0x1d2721(0x6e3),_0x23c63a[_0x1d2721(0xc58)]=_0x1d2721(0x1fd)+_0x14456d['id']+_0x1d2721(0x776)+(_0x14456d[_0x1d2721(0x1167)]?_0x14456d[_0x1d2721(0xcb3)]['groupAvatar']:_0x14456d[_0x1d2721(0xcb3)][_0x1d2721(0x93)]||_0x54e358)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x14456d['name']+_0x1d2721(0xd25),_0x4753a[_0x1d2721(0x99e)](_0x23c63a);}),_0x3c6bde[_0x47c2df(0x418)][_0x47c2df(0xdda)](_0x47c2df(0x40a));}function _0x185356(_0x397d3f){const _0x580521=_0x5a7792,_0x360d41=document['getElementById'](_0x580521(0xa8f));if(!_0x360d41[_0x580521(0x418)][_0x580521(0xef6)](_0x580521(0x40a))){if(_0x397d3f)_0x397d3f();return;}_0x360d41['classList'][_0x580521(0x1275)](_0x580521(0x40a)),setTimeout(()=>{const _0x330db4=_0x580521;document[_0x330db4(0x64f)](_0x330db4(0x1261))['classList'][_0x330db4(0x1275)](_0x330db4(0x40a));if(_0x397d3f)_0x397d3f();},0x190);}function _0x485f9f(_0x496d7e){const _0x4eb0c1=_0x5a7792;if(!_0x496d7e)return[];const _0x46e286=String(_0x496d7e)[_0x4eb0c1(0x108c)](/\r\n?|\n/),_0x2b8a42=[],_0x37beec=/\[(\d{2}):(\d{2})[.:](\d{2,3})\]/g;for(const _0x46b83a of _0x46e286){const _0x7c5f5b=_0x46b83a[_0x4eb0c1(0x137f)](_0x37beec,'')['trim']();if(!_0x7c5f5b)continue;_0x37beec[_0x4eb0c1(0x3b4)]=0x0;let _0x5b4bef;while((_0x5b4bef=_0x37beec[_0x4eb0c1(0x97c)](_0x46b83a))!==null){const _0x2ac212=parseInt(_0x5b4bef[0x1],0xa),_0x4c426e=parseInt(_0x5b4bef[0x2],0xa),_0x107101=parseInt(_0x5b4bef[0x3]['padEnd'](0x3,'0'),0xa),_0x4ce520=_0x2ac212*0x3c+_0x4c426e+_0x107101/0x3e8;_0x2b8a42[_0x4eb0c1(0x13ee)]({'time':_0x4ce520,'text':_0x7c5f5b});}}return _0x2b8a42['sort']((_0x28d657,_0x12cc78)=>_0x28d657[_0x4eb0c1(0x12b1)]-_0x12cc78['time']);}function _0x1b36d1(){const _0x2bd681=_0x5a7792,_0x21729c=document[_0x2bd681(0x64f)](_0x2bd681(0xdfa));_0x21729c[_0x2bd681(0xc58)]='';if(!_0x1c083c[_0x2bd681(0xc35)]||_0x1c083c['parsedLyrics'][_0x2bd681(0x40f)]===0x0){_0x21729c['innerHTML']=_0x2bd681(0xef1);return;}_0x1c083c[_0x2bd681(0xc35)][_0x2bd681(0x103)]((_0x507cd3,_0x409e61)=>{const _0x16549f=_0x2bd681,_0x25c737=document[_0x16549f(0x124e)]('div');_0x25c737['className']=_0x16549f(0x13cb),_0x25c737[_0x16549f(0xee5)]=_0x507cd3[_0x16549f(0x673)],_0x25c737[_0x16549f(0x12e1)][_0x16549f(0xf84)]=_0x409e61,_0x21729c[_0x16549f(0x99e)](_0x25c737);}),_0x21729c[_0x2bd681(0x731)][_0x2bd681(0x70b)]='translateY(0px)';}function _0x14491f(_0x4f202a){const _0x3a1723=_0x5a7792;if(_0x1c083c[_0x3a1723(0xc35)][_0x3a1723(0x40f)]===0x0)return;let _0x49c1aa=-0x1;for(let _0x43d0ab=0x0;_0x43d0ab<_0x1c083c[_0x3a1723(0xc35)][_0x3a1723(0x40f)];_0x43d0ab++){if(_0x4f202a>=_0x1c083c[_0x3a1723(0xc35)][_0x43d0ab]['time'])_0x49c1aa=_0x43d0ab;else break;}if(_0x49c1aa===_0x1c083c['currentLyricIndex'])return;_0x1c083c[_0x3a1723(0x1249)]=_0x49c1aa,_0x5577aa();const _0x3b0325=document[_0x3a1723(0x64f)]('single-lyric-display');_0x3b0325&&(_0x49c1aa>-0x1&&_0x1c083c[_0x3a1723(0xc35)][_0x49c1aa]?_0x3b0325[_0x3a1723(0xee5)]=_0x1c083c[_0x3a1723(0xc35)][_0x49c1aa]['text']:_0x3b0325['textContent']=_0x3a1723(0x273));const _0xad41f3=document['getElementById'](_0x3a1723(0x9fc));_0xad41f3[_0x3a1723(0x418)][_0x3a1723(0xef6)]('visible')&&(_0x49c1aa>-0x1&&_0x1c083c[_0x3a1723(0xc35)][_0x49c1aa]?_0xad41f3[_0x3a1723(0xee5)]=_0x1c083c[_0x3a1723(0xc35)][_0x49c1aa][_0x3a1723(0x673)]:_0xad41f3[_0x3a1723(0xee5)]='♪');}function _0x5577aa(_0x46d6c7=![]){const _0x140cac=_0x5a7792,_0x47ad7f=_0x46d6c7?_0x140cac(0xc40):'#music-lyrics-container\x20#music-lyrics-list',_0xfaf7cb=_0x46d6c7?'#fullscreen-lyrics-container':'#music-lyrics-container',_0x29f2bc=document[_0x140cac(0x49c)](_0x47ad7f),_0x43acde=document[_0x140cac(0x49c)](_0xfaf7cb);if(!_0x29f2bc||!_0x43acde)return;const _0x25510d=_0x29f2bc['querySelectorAll'](_0x140cac(0x1044));_0x25510d[_0x140cac(0x103)](_0x206b77=>_0x206b77['classList']['remove'](_0x140cac(0x12ef)));if(_0x1c083c[_0x140cac(0x1249)]===-0x1){_0x29f2bc[_0x140cac(0x731)][_0x140cac(0x70b)]=_0x140cac(0x13d6);return;}const _0x23dbbb=_0x29f2bc[_0x140cac(0x49c)]('.lyric-line[data-index=\x22'+_0x1c083c[_0x140cac(0x1249)]+'\x22]');if(_0x23dbbb){_0x23dbbb[_0x140cac(0x418)][_0x140cac(0xdda)](_0x140cac(0x12ef));const _0x545652=_0x43acde['offsetHeight'],_0x36731a=_0x545652/2.2-_0x23dbbb[_0x140cac(0x1a4)]-_0x23dbbb[_0x140cac(0xbb)]/0x2;_0x29f2bc['style'][_0x140cac(0x70b)]=_0x140cac(0x100e)+_0x36731a+_0x140cac(0x9a5);}}function _0x564c3c(_0x43eb67){const _0xaeb17e=_0x5a7792;if(isNaN(_0x43eb67)||_0x43eb67<0x0)return _0xaeb17e(0x81b);const _0xc2cf90=Math['floor'](_0x43eb67/0x3c),_0x27745c=Math[_0xaeb17e(0x1245)](_0x43eb67%0x3c);return _0xc2cf90+':'+String(_0x27745c)[_0xaeb17e(0xf2)](0x2,'0');}let _0x4cdd6b=0x0,_0x9f6b7e;function _0x11fbd9(){_0x9f6b7e&&cancelAnimationFrame(_0x9f6b7e);function _0x2b40fa(){const _0x44e630=_0x2bd6;if(!_0x1c083c['isPlaying']||!_0x51e4a1[_0x44e630(0x25e)])return;const _0x35aefb=performance['now'](),_0xdb2e02=_0x51e4a1[_0x44e630(0x76)],_0x119700=_0x51e4a1[_0x44e630(0x25e)],_0x2796cb=_0xdb2e02/_0x119700*0x64;document[_0x44e630(0x64f)](_0x44e630(0x773))[_0x44e630(0x731)][_0x44e630(0x1123)]=_0x2796cb+'%',_0x35aefb-_0x4cdd6b>0x3e8&&(document['getElementById']('music-current-time')['textContent']=_0x564c3c(_0xdb2e02),document['getElementById'](_0x44e630(0x68d))['textContent']=_0x564c3c(_0x119700),_0x4cdd6b=_0x35aefb),_0x14491f(_0xdb2e02),_0x9f6b7e=requestAnimationFrame(_0x2b40fa);}_0x9f6b7e=requestAnimationFrame(_0x2b40fa);}function _0xaa49c5(){const _0x6c97f6=_0x5a7792;if(!lastRawAiResponse){alert(_0x6c97f6(0x122c));return;}const _0x500f86=document['getElementById'](_0x6c97f6(0x316)),_0xdccd97=document['getElementById'](_0x6c97f6(0xdf6));_0xdccd97[_0x6c97f6(0xc58)]='';const _0x6cfcc2=_0x3755ce(lastRawAiResponse);if(_0x6cfcc2&&_0x6cfcc2[_0x6c97f6(0x40f)]>0x0)_0x6cfcc2[_0x6c97f6(0x103)](_0x161a34=>{const _0x2bbf8b=_0x6c97f6;if(typeof _0x161a34==='object'&&_0x161a34!==null)try{const _0x2a9ce6=JSON[_0x2bbf8b(0xe3f)](_0x161a34,null,0x2),_0x5572c0=_0x4b129f(_0x2a9ce6);_0xdccd97[_0x2bbf8b(0x99e)](_0x5572c0);}catch(_0x595675){console['error']('在导演模式下\x20stringify\x20失败:',_0x161a34,_0x595675);}else{if(typeof _0x161a34==='string'){const _0x194b25=_0x4b129f(_0x161a34);_0xdccd97[_0x2bbf8b(0x99e)](_0x194b25),console['warn']('在导演模式中发现一个无效的片段\x20(来自parseAiResponse的文本回退):',_0x161a34);}}});else{const _0x247698=_0x4b129f(lastRawAiResponse);_0xdccd97[_0x6c97f6(0x99e)](_0x247698);}_0x500f86[_0x6c97f6(0x418)][_0x6c97f6(0xdda)](_0x6c97f6(0x40a));}function _0x4b129f(_0x37c503=''){const _0xe8837d=_0x5a7792,_0x2c5bec=document['createElement'](_0xe8837d(0x479));_0x2c5bec[_0xe8837d(0x87d)]=_0xe8837d(0xe0f);const _0x2bb7e2={'text':{'type':_0xe8837d(0x673),'content':_0xe8837d(0x7c5)},'sticker':{'type':'sticker','url':'https://...','meaning':'表情含义'},'image':{'type':'ai_image','description':_0xe8837d(0xc7)},'voice':{'type':_0xe8837d(0xe76),'content':'在这里输入语音内容...'},'transfer':{'type':'transfer','amount':5.2,'note':_0xe8837d(0x951)},'offline':{'type':_0xe8837d(0x9cb),'content':'「在这里输入对话内容」\x5cn(在这里输入动作或环境描写)'},'quote':{'type':_0xe8837d(0x94d),'target_timestamp':0x499602d2,'reply_content':_0xe8837d(0x7f6)}};return _0x2c5bec['innerHTML']=_0xe8837d(0x2f1)+_0x37c503+_0xe8837d(0x13c7)+JSON[_0xe8837d(0xe3f)](_0x2bb7e2[_0xe8837d(0x673)])+_0xe8837d(0x1159)+JSON[_0xe8837d(0xe3f)](_0x2bb7e2[_0xe8837d(0xefb)])+_0xe8837d(0x74c)+JSON[_0xe8837d(0xe3f)](_0x2bb7e2['image'])+_0xe8837d(0xf54)+JSON[_0xe8837d(0xe3f)](_0x2bb7e2[_0xe8837d(0x75e)])+_0xe8837d(0xf41)+JSON[_0xe8837d(0xe3f)](_0x2bb7e2['transfer'])+_0xe8837d(0x327)+JSON[_0xe8837d(0xe3f)](_0x2bb7e2[_0xe8837d(0x12df)])+'\x27>线下</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20【核心修改2】在这里添加新的“引用”按钮\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22format-btn\x22\x20data-template=\x27'+JSON['stringify'](_0x2bb7e2['quote'])+_0xe8837d(0xa74),_0x2c5bec[_0xe8837d(0x49c)](_0xe8837d(0x7c3))[_0xe8837d(0xf72)](_0xe8837d(0x1080),()=>{_0x2c5bec['remove']();}),_0x2c5bec[_0xe8837d(0x233)]('.format-btn')[_0xe8837d(0x103)](_0x17f0e1=>{const _0x258430=_0xe8837d;_0x17f0e1[_0x258430(0xf72)](_0x258430(0x1080),()=>{const _0x4048ee=_0x258430,_0x4eb56c=_0x17f0e1[_0x4048ee(0x12e1)][_0x4048ee(0xc98)],_0x7be92c=_0x2c5bec[_0x4048ee(0x49c)]('textarea');if(_0x4eb56c&&_0x7be92c)try{const _0x15dbc3=JSON[_0x4048ee(0x1214)](_0x4eb56c);_0x7be92c[_0x4048ee(0xbed)]=JSON['stringify'](_0x15dbc3,null,0x2),_0x7be92c[_0x4048ee(0x1218)]();}catch(_0x1326fb){console['error'](_0x4048ee(0x6c5),_0x1326fb);}});}),_0x2c5bec;}async function _0x137e47(){const _0x337c04=_0x5a7792,_0x30d2aa=_0x3e7a1b['chats'][_0x3e7a1b[_0x337c04(0x777)]];if(!_0x30d2aa)return;const _0x4c386f=document[_0x337c04(0x64f)]('ai-response-editor-container'),_0x1f6c39=_0x4c386f[_0x337c04(0x233)](_0x337c04(0x444)),_0x573b22=Array['from'](_0x1f6c39)['map'](_0x8383be=>_0x8383be[_0x337c04(0xbed)][_0x337c04(0x43a)]())[_0x337c04(0x156)](Boolean);if(_0x573b22[_0x337c04(0x40f)]===0x0){_0x30d2aa[_0x337c04(0x830)]=_0x30d2aa[_0x337c04(0x830)]['filter'](_0x553d2a=>!lastResponseTimestamps[_0x337c04(0xe53)](_0x553d2a['timestamp'])),await _0x4e1bbf['chats'][_0x337c04(0x4fa)](_0x30d2aa),_0x4817d1(_0x3e7a1b['activeChatId']),_0x21f6ea(),document[_0x337c04(0x64f)]('ai-response-editor-modal')[_0x337c04(0x418)][_0x337c04(0x1275)](_0x337c04(0x40a)),lastRawAiResponse='',lastResponseTimestamps=[];return;}let _0x4fa4f7=[];for(const _0x1490b0 of _0x573b22){try{const _0x40bbc9=JSON[_0x337c04(0x1214)](_0x1490b0);_0x4fa4f7[_0x337c04(0x13ee)](_0x40bbc9);}catch(_0xbec96){console[_0x337c04(0x1155)](_0x337c04(0xe70),_0x1490b0);}}_0x30d2aa[_0x337c04(0x830)]=_0x30d2aa['history'][_0x337c04(0x156)](_0x3b7ba6=>!lastResponseTimestamps[_0x337c04(0xe53)](_0x3b7ba6['timestamp']));let _0x48e81a=[],_0x57a836=Date[_0x337c04(0x2b5)]();for(const _0x2a3846 of _0x4fa4f7){if(!_0x2a3846||typeof _0x2a3846!==_0x337c04(0x59a)||!_0x2a3846['type']){console[_0x337c04(0x1155)]('在导演模式保存时，发现无效的指令对象，已跳过:',_0x2a3846);continue;}let _0x14b385=null;const _0x25b6b2={'role':_0x337c04(0x12c3),'senderName':_0x2a3846['name']||_0x30d2aa['originalName'],'timestamp':_0x57a836++};switch(_0x2a3846[_0x337c04(0xafc)]){case _0x337c04(0x6b1):{console[_0x337c04(0x1081)](_0x337c04(0xa60));const _0x154315='[这是你上一轮的内部思考]\x0a-\x20分析:\x20'+(_0x2a3846['analysis']||'无')+'\x0a-\x20策略:\x20'+(_0x2a3846['strategy']||'无')+_0x337c04(0x1147)+JSON[_0x337c04(0xe3f)](_0x2a3846[_0x337c04(0x11fb)]||{}),_0x1f94c3={'role':_0x337c04(0x905),'content':_0x154315,'timestamp':_0x57a836++,'isHidden':!![]};_0x30d2aa['history'][_0x337c04(0x13ee)](_0x1f94c3),_0x48e81a[_0x337c04(0x13ee)](_0x1f94c3[_0x337c04(0x8af)]);continue;}case _0x337c04(0x673):_0x14b385={..._0x25b6b2,'content':String(_0x2a3846[_0x337c04(0x3ba)]||_0x2a3846['message'])};break;case _0x337c04(0xefb):{let _0x2279eb=![];if(_0x2a3846[_0x337c04(0xe52)]&&_0x2a3846['meaning'])_0x14b385={..._0x25b6b2,'type':'sticker','content':_0x2a3846[_0x337c04(0xe52)],'meaning':_0x2a3846[_0x337c04(0x10b3)]},console[_0x337c04(0x1081)](_0x337c04(0x1014)),_0x2279eb=!![];else{if(_0x2a3846[_0x337c04(0x10b3)]){const _0x53efae=_0x3e7a1b[_0x337c04(0xa8b)][_0x337c04(0x137)](_0x144b55=>_0x144b55[_0x337c04(0x6fc)]===_0x2a3846['meaning']);_0x53efae?(_0x14b385={..._0x25b6b2,'type':'sticker','content':_0x53efae[_0x337c04(0xe52)],'meaning':_0x53efae[_0x337c04(0x6fc)]},console['log']('导演模式保存(Sticker):\x20使用了\x20meaning\x20查找'),_0x2279eb=!![]):(_0x14b385={..._0x25b6b2,'type':_0x337c04(0x673),'content':'[表情:\x20'+_0x2a3846[_0x337c04(0x10b3)]+']'},console[_0x337c04(0x1155)]('导演模式保存(Sticker):\x20提供了\x20meaning\x20但未找到对应表情:',_0x2a3846[_0x337c04(0x10b3)]),_0x2279eb=!![]);}else{if(_0x2a3846[_0x337c04(0xe52)]){_0x14b385={..._0x25b6b2,'type':_0x337c04(0xefb),'content':_0x2a3846[_0x337c04(0xe52)]};const _0x49fdc6=_0x3e7a1b[_0x337c04(0xa8b)][_0x337c04(0x137)](_0x43928b=>_0x43928b[_0x337c04(0xe52)]===_0x2a3846[_0x337c04(0xe52)]);_0x14b385['meaning']=_0x49fdc6?_0x49fdc6[_0x337c04(0x6fc)]:'未知表情',console['log'](_0x337c04(0x108e),_0x14b385[_0x337c04(0x10b3)]),_0x2279eb=!![];}else{if(_0x2a3846[_0x337c04(0x3ba)]&&typeof _0x2a3846[_0x337c04(0x3ba)]==='string'&&_0x442b6b['test'](_0x2a3846[_0x337c04(0x3ba)])){_0x14b385={..._0x25b6b2,'type':_0x337c04(0xefb),'content':_0x2a3846['content']};const _0x238f24=_0x3e7a1b['userStickers'][_0x337c04(0x137)](_0x2ab471=>_0x2ab471[_0x337c04(0xe52)]===_0x2a3846[_0x337c04(0x3ba)]);_0x14b385['meaning']=_0x238f24?_0x238f24['name']:_0x337c04(0x7ef),console[_0x337c04(0x1081)](_0x337c04(0xf28),_0x14b385[_0x337c04(0x10b3)]),_0x2279eb=!![];}}}}if(!_0x2279eb){console['error'](_0x337c04(0xd0),_0x2a3846);continue;}break;}case _0x337c04(0x118):_0x14b385={..._0x25b6b2,'type':_0x337c04(0x118),'content':_0x2a3846[_0x337c04(0x9af)]};break;case _0x337c04(0x13df):_0x14b385={..._0x25b6b2,'type':'naiimag','imageUrl':_0x2a3846[_0x337c04(0xd07)],'prompt':_0x2a3846[_0x337c04(0x1381)],'fullPrompt':_0x2a3846[_0x337c04(0x936)]};break;case _0x337c04(0xe76):_0x14b385={..._0x25b6b2,'type':_0x337c04(0xe76),'content':_0x2a3846['content']};break;case'transfer':_0x14b385={..._0x25b6b2,'type':_0x337c04(0xcda),'amount':_0x2a3846[_0x337c04(0x12fc)],'note':_0x2a3846['note'],'receiverName':_0x2a3846[_0x337c04(0x13f)]||'我'};break;case'waimai_request':_0x14b385={..._0x25b6b2,'type':_0x337c04(0x1034),'productInfo':_0x2a3846[_0x337c04(0xec5)],'amount':_0x2a3846[_0x337c04(0x12fc)],'status':'pending','countdownEndTime':Date['now']()+0xf*0x3c*0x3e8};break;case'offline_text':_0x14b385={..._0x25b6b2,..._0x2a3846};break;case _0x337c04(0x543):{const _0x4f001b=_0x4dc8ec[_0x30d2aa['id']];if(_0x4f001b){const _0x5d726b=_0x4f001b['history']['findLastIndex'](_0x28c84e=>_0x28c84e['player']===0x2);if(_0x5d726b>-0x1){const _0xf9fcfc=_0x4f001b[_0x337c04(0x830)][_0x5d726b];_0x4f001b[_0x337c04(0x9e4)][_0xf9fcfc['y']][_0xf9fcfc['x']]=0x0,_0x4f001b[_0x337c04(0x830)][_0x337c04(0x10f9)](_0x5d726b,0x1),console[_0x337c04(0x1081)](_0x337c04(0x1315)+_0xf9fcfc['x']+',\x20'+_0xf9fcfc['y']+_0x337c04(0x12f1));}}const _0x25424c=parseInt(_0x2a3846['x']),_0x219a8f=parseInt(_0x2a3846['y']);!isNaN(_0x25424c)&&!isNaN(_0x219a8f)?_0x5a14d4({'x':_0x25424c,'y':_0x219a8f},!![]):console[_0x337c04(0x1155)](_0x337c04(0x118e),_0x2a3846);continue;}case _0x337c04(0x12a5):{if(!_0x30d2aa[_0x337c04(0x1167)]){_0x2a3846[_0x337c04(0xa3a)]&&(_0x30d2aa[_0x337c04(0x12d9)]=String(_0x2a3846[_0x337c04(0xa3a)]));_0x2a3846['random_jottings']&&(_0x30d2aa[_0x337c04(0xb9d)]=String(_0x2a3846[_0x337c04(0xe04)]));!Array[_0x337c04(0x97e)](_0x30d2aa[_0x337c04(0x7ea)])&&(_0x30d2aa[_0x337c04(0x7ea)]=[]);_0x30d2aa[_0x337c04(0x7ea)]['push']({'heartfeltVoice':_0x30d2aa[_0x337c04(0x12d9)],'randomJottings':_0x30d2aa['randomJottings'],'timestamp':Date[_0x337c04(0x2b5)]()});_0x30d2aa['thoughtsHistory'][_0x337c04(0x40f)]>0x32&&_0x30d2aa[_0x337c04(0x7ea)][_0x337c04(0x1312)]();const _0x15d1b6=_0x337c04(0xbf6)+_0x30d2aa['heartfeltVoice']+_0x337c04(0xeb1)+_0x30d2aa[_0x337c04(0xb9d)],_0x518e77={'role':'system','content':_0x15d1b6,'timestamp':Date['now'](),'isHidden':!![]};}continue;}case _0x337c04(0x94d):{const _0x57003e=_0x30d2aa['history'][_0x337c04(0x137)](_0x140012=>_0x140012[_0x337c04(0x8af)]===_0x2a3846['target_timestamp']);let _0x306efc=null;if(_0x57003e){let _0x31ddb8=_0x57003e[_0x337c04(0x133d)];_0x57003e[_0x337c04(0x931)]===_0x337c04(0xa4d)&&(_0x31ddb8=_0x30d2aa[_0x337c04(0x1167)]?_0x30d2aa[_0x337c04(0xcb3)]['myNickname']||'我':_0x3e7a1b[_0x337c04(0x3c2)][_0x337c04(0x78c)]||_0x337c04(0x1028)),_0x306efc={'timestamp':_0x2a3846[_0x337c04(0xf0b)],'senderName':_0x31ddb8,'content':String(_0x57003e[_0x337c04(0x3ba)]||'')};}else _0x306efc={'timestamp':_0x2a3846[_0x337c04(0xf0b)],'senderName':_0x337c04(0x100b),'content':'原始消息已删除或不存在'};_0x14b385={..._0x25b6b2,'content':_0x2a3846[_0x337c04(0x13d3)],'quote':_0x306efc};break;}default:console[_0x337c04(0x1155)](_0x337c04(0x11de),_0x2a3846['type']);break;}_0x14b385&&(_0x30d2aa['history']['push'](_0x14b385),_0x48e81a[_0x337c04(0x13ee)](_0x14b385['timestamp']));}await _0x4e1bbf[_0x337c04(0x999)]['put'](_0x30d2aa),_0x4817d1(_0x3e7a1b[_0x337c04(0x777)]),_0x21f6ea(),document[_0x337c04(0x64f)](_0x337c04(0x316))['classList'][_0x337c04(0x1275)](_0x337c04(0x40a)),lastRawAiResponse=_0x573b22['join']('\x0a\x0a'),lastResponseTimestamps=_0x48e81a,await _0x28974b('导演模式',_0x337c04(0xa1a));}async function _0x3d2e1a(){const _0x23b156=_0x5a7792;if(!_0x5096e4)return;const _0x4b2be6=0x2*0x3c*0x3e8,_0x11e17e=_0x5096e4,_0x45d780=Date['now']();if(_0x45d780-_0x11e17e>_0x4b2be6){_0x4a722d(),await _0x28974b(_0x23b156(0x5b1),'该消息发送已超过2分钟，无法撤回。');return;}await _0xf74a8(_0x11e17e,!![]),_0x4a722d();}async function _0xf74a8(_0x3fb656,_0xcd1b4d){const _0x3bfa84=_0x5a7792,_0x5dd992=_0x3e7a1b[_0x3bfa84(0x999)][_0x3e7a1b['activeChatId']];if(!_0x5dd992)return;const _0x1b2b08=_0x5dd992[_0x3bfa84(0x830)][_0x3bfa84(0x6a2)](_0x287f27=>_0x287f27[_0x3bfa84(0x8af)]===_0x3fb656);if(_0x1b2b08===-0x1)return;const _0x240332=_0x5dd992[_0x3bfa84(0x830)][_0x1b2b08],_0x3bc9a8={'originalType':_0x240332[_0x3bfa84(0xafc)]||_0x3bfa84(0x673),'originalContent':_0x240332[_0x3bfa84(0x3ba)],'originalMeaning':_0x240332[_0x3bfa84(0x10b3)],'originalQuote':_0x240332[_0x3bfa84(0x2fa)]};_0x240332['type']=_0x3bfa84(0x11f2),_0x240332[_0x3bfa84(0x3ba)]=_0xcd1b4d?_0x3bfa84(0x136e):_0x3bfa84(0x365),_0x240332[_0x3bfa84(0x52f)]=_0x3bc9a8,delete _0x240332[_0x3bfa84(0x10b3)],delete _0x240332[_0x3bfa84(0x2fa)];if(_0xcd1b4d){const _0x3473a0=_0x5dd992[_0x3bfa84(0x1167)]?_0x5dd992['settings'][_0x3bfa84(0x96f)]||'我':'我';let _0xe007a0='';if(_0x3bc9a8[_0x3bfa84(0xc0f)]===_0x3bfa84(0xefb))_0xe007a0='[表情，含义:\x20'+(_0x3bc9a8[_0x3bfa84(0xf18)]||'未知')+']';else _0x3bc9a8[_0x3bfa84(0xc0f)]==='ai_image'||_0x3bc9a8[_0x3bfa84(0xc0f)]==='user_photo'?_0xe007a0=_0x3bfa84(0x115e)+_0x3bc9a8[_0x3bfa84(0x13a3)]+']':_0xe007a0='“'+String(_0x3bc9a8[_0x3bfa84(0x13a3)])+'”';const _0x14b770={'role':_0x3bfa84(0x905),'content':_0x3bfa84(0xf00)+_0x3473a0+'）刚刚撤回了一条消息。撤回前的内容是：'+_0xe007a0+_0x3bfa84(0xcca),'timestamp':Date['now'](),'isHidden':!![]};_0x5dd992[_0x3bfa84(0x830)]['push'](_0x14b770);}await _0x4e1bbf['chats']['put'](_0x5dd992),_0x4817d1(_0x3e7a1b[_0x3bfa84(0x777)]),_0xcd1b4d&&(_0x21f6ea(),_0x20a638());}async function _0x1dd65(){const _0x3b6e91=_0x5a7792;await _0xfb5430(),document[_0x3b6e91(0x64f)](_0x3b6e91(0xb63))[_0x3b6e91(0x418)][_0x3b6e91(0xdda)]('visible');}async function _0xfb5430(){const _0x2b9176=_0x5a7792,_0x136b0d=document['getElementById'](_0x2b9176(0x584)),_0x50a615=await _0x4e1bbf[_0x2b9176(0x10bb)]['toArray']();_0x136b0d['innerHTML']='',_0x50a615['length']===0x0&&(_0x136b0d[_0x2b9176(0xc58)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>'),_0x50a615[_0x2b9176(0x103)](_0x14f1ba=>{const _0x24a8c2=_0x2b9176,_0xc115af=document['createElement'](_0x24a8c2(0x479));_0xc115af['className']=_0x24a8c2(0x6c3),_0xc115af[_0x24a8c2(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x14f1ba[_0x24a8c2(0x6fc)]+_0x24a8c2(0x138d)+_0x14f1ba['id']+_0x24a8c2(0x9fd),_0x136b0d[_0x24a8c2(0x99e)](_0xc115af);});}async function _0x518fe7(){const _0x1ea837=_0x5a7792,_0x5184ee=document[_0x1ea837(0x64f)](_0x1ea837(0x7f8)),_0x4d69d1=_0x5184ee[_0x1ea837(0xbed)]['trim']();if(!_0x4d69d1){alert(_0x1ea837(0x1b9));return;}const _0x190ff2=await _0x4e1bbf[_0x1ea837(0x10bb)][_0x1ea837(0xec9)](_0x1ea837(0x6fc))['equals'](_0x4d69d1)[_0x1ea837(0x5dd)]();if(_0x190ff2){alert('分类\x20\x22'+_0x4d69d1+_0x1ea837(0xc4e));return;}await _0x4e1bbf[_0x1ea837(0x10bb)][_0x1ea837(0xdda)]({'name':_0x4d69d1}),_0x5184ee[_0x1ea837(0xbed)]='',await _0xfb5430();}async function _0x17d874(_0x284d8f){const _0x4088cd=_0x5a7792,_0x2e5cfe=await _0x54149f(_0x4088cd(0x13d2),'删除分类后，该分类下的所有世界书将变为“未分类”。确定要删除吗？',{'confirmButtonClass':_0x4088cd(0xeed)});if(_0x2e5cfe){await _0x4e1bbf[_0x4088cd(0x10bb)][_0x4088cd(0x3aa)](_0x284d8f);const _0x124153=await _0x4e1bbf[_0x4088cd(0x144)][_0x4088cd(0xec9)]('categoryId')['equals'](_0x284d8f)[_0x4088cd(0x78f)]();for(const _0x4ca3ce of _0x124153){_0x4ca3ce[_0x4088cd(0xcd3)]=null,await _0x4e1bbf[_0x4088cd(0x144)][_0x4088cd(0x4fa)](_0x4ca3ce);const _0x23da3c=_0x3e7a1b[_0x4088cd(0x144)][_0x4088cd(0x137)](_0x26c489=>_0x26c489['id']===_0x4ca3ce['id']);if(_0x23da3c)_0x23da3c[_0x4088cd(0xcd3)]=null;}await _0xfb5430();}}async function _0x492665(){const _0x3e8f49=_0x5a7792;if(!_0x5096e4)return;const _0x451051=_0x5096e4;_0x4a722d();const _0x38bf06=_0x3e7a1b[_0x3e8f49(0x999)][_0x3e7a1b['activeChatId']],_0x1f9dac=_0x38bf06[_0x3e8f49(0x830)][_0x3e8f49(0x137)](_0x2102e8=>_0x2102e8['timestamp']===_0x451051);if(!_0x1f9dac)return;let _0x18f853=String(_0x1f9dac[_0x3e8f49(0x3ba)]||'')[_0x3e8f49(0x126f)](0x0,0x32)+_0x3e8f49(0x3cd);if(_0x1f9dac[_0x3e8f49(0xafc)]==='ai_image')_0x18f853=_0x3e8f49(0x8d0)+_0x18f853;const _0x374979=await _0x54149f(_0x3e8f49(0xc3d),_0x3e8f49(0x13a1)+_0x18f853+'”',{'confirmText':_0x3e8f49(0x577)});if(_0x374979){const _0x1a8c04=_0x38bf06['settings'][_0x3e8f49(0x96f)]||'我';!Array['isArray'](_0x38bf06[_0x3e8f49(0xb1d)])&&(_0x38bf06[_0x3e8f49(0xb1d)]=[]);const _0x4b10f3={'id':'anno_'+Date[_0x3e8f49(0x2b5)](),'messageTimestamp':_0x451051,'publisher':_0x1a8c04,'publishedAt':Date[_0x3e8f49(0x2b5)](),'isPinned':![]};_0x38bf06['announcements'][_0x3e8f49(0x13ee)](_0x4b10f3);const _0x53cab9={'role':_0x3e8f49(0x905),'type':'pat_message','content':_0x1a8c04+_0x3e8f49(0x1352),'timestamp':Date['now']()};_0x38bf06[_0x3e8f49(0x830)][_0x3e8f49(0x13ee)](_0x53cab9),await _0x4e1bbf['chats']['put'](_0x38bf06),_0x3c7e84(_0x53cab9,_0x38bf06),_0x21f6ea(),await _0x28974b('成功',_0x3e8f49(0xdf));}}async function _0x25d9f7(){const _0xbf2ca5=_0x5a7792,_0x1571d8=_0x3e7a1b[_0xbf2ca5(0x999)][_0x3e7a1b[_0xbf2ca5(0x777)]],_0x2a3526=_0x1571d8['announcements']||[];if(!_0x1571d8||_0x2a3526[_0xbf2ca5(0x40f)]===0x0){_0x28974b('提示',_0xbf2ca5(0x10d2));return;}const _0x2489a9=document[_0xbf2ca5(0x64f)](_0xbf2ca5(0x510));_0x2489a9[_0xbf2ca5(0xc58)]='',_0x2a3526['sort']((_0x42c80e,_0x2d0cd2)=>(_0x2d0cd2[_0xbf2ca5(0x9b6)]?0x1:0x0)-(_0x42c80e[_0xbf2ca5(0x9b6)]?0x1:0x0));for(const _0xbad467 of _0x2a3526){const _0x2a306c=_0x1571d8[_0xbf2ca5(0x830)][_0xbf2ca5(0x137)](_0x592e70=>_0x592e70[_0xbf2ca5(0x8af)]===_0xbad467[_0xbf2ca5(0x361)]),_0x19a751=document[_0xbf2ca5(0x124e)](_0xbf2ca5(0x479));_0x19a751['className']='announcement-item-wrapper';if(_0x2a306c){const _0x3f66e8=await _0x3209f4(_0x2a306c,_0x1571d8);_0x3f66e8&&_0x19a751[_0xbf2ca5(0x99e)](_0x3f66e8);}else _0x19a751['innerHTML']=_0xbf2ca5(0x109a);_0xbad467['isPinned']&&(_0x19a751['innerHTML']+=_0xbf2ca5(0xa7)),_0x19a751[_0xbf2ca5(0xc58)]+='<div\x20class=\x22announcement-item-actions\x22\x20data-anno-id=\x22'+_0xbad467['id']+_0xbf2ca5(0x669),_0x2489a9['appendChild'](_0x19a751);}document[_0xbf2ca5(0x64f)](_0xbf2ca5(0x1f2))[_0xbf2ca5(0x418)]['add']('visible');}let _0x56d000=null;function _0x30bae6(_0xf0eee5){const _0x48cb3a=_0x5a7792;_0x56d000=_0xf0eee5;const _0x240923=_0x3e7a1b[_0x48cb3a(0x999)][_0x3e7a1b[_0x48cb3a(0x777)]],_0x5ca3c1=_0x240923[_0x48cb3a(0xb1d)][_0x48cb3a(0x137)](_0x238499=>_0x238499['id']===_0xf0eee5);if(!_0x5ca3c1)return;const _0x2aad3d=document['getElementById'](_0x48cb3a(0x498));_0x2aad3d[_0x48cb3a(0xee5)]=_0x5ca3c1[_0x48cb3a(0x9b6)]?'取消置顶':_0x48cb3a(0x560),document[_0x48cb3a(0x64f)](_0x48cb3a(0x103b))[_0x48cb3a(0x418)]['add'](_0x48cb3a(0x40a));}async function _0x27e17e(){const _0x40e4a9=_0x5a7792;if(!_0x56d000)return;const _0x4adde7=_0x3e7a1b[_0x40e4a9(0x999)][_0x3e7a1b[_0x40e4a9(0x777)]],_0xe978b=_0x4adde7[_0x40e4a9(0xb1d)][_0x40e4a9(0x137)](_0x15cfbb=>_0x15cfbb['id']===_0x56d000);_0xe978b&&(_0xe978b[_0x40e4a9(0x9b6)]=!_0xe978b[_0x40e4a9(0x9b6)],await _0x4e1bbf[_0x40e4a9(0x999)]['put'](_0x4adde7),_0x25d9f7()),document[_0x40e4a9(0x64f)](_0x40e4a9(0x103b))[_0x40e4a9(0x418)][_0x40e4a9(0x1275)](_0x40e4a9(0x40a));}async function _0x1963e7(){const _0xb03264=_0x5a7792;if(!_0x56d000)return;const _0x50ed1f=await _0x54149f(_0xb03264(0x13d2),_0xb03264(0x1077),{'confirmButtonClass':_0xb03264(0xeed)});if(_0x50ed1f){const _0x3498c7=_0x3e7a1b[_0xb03264(0x999)][_0x3e7a1b['activeChatId']];_0x3498c7[_0xb03264(0xb1d)]=_0x3498c7[_0xb03264(0xb1d)][_0xb03264(0x156)](_0x472606=>_0x472606['id']!==_0x56d000),await _0x4e1bbf['chats'][_0xb03264(0x4fa)](_0x3498c7),_0x25d9f7();}document[_0xb03264(0x64f)](_0xb03264(0x103b))[_0xb03264(0x418)]['remove']('visible');}let _0x21ae61=![],_0x84d9ce={'ai':null,'my':null};function _0x4cc18d(_0x4f2026=_0x5a7792(0xc09)){const _0x23c426=_0x5a7792,_0x54ee54=document[_0x23c426(0x64f)](_0x23c426(0x957));if(!_0x3e7a1b[_0x23c426(0x777)])return;const _0x4b6fec=_0x3e7a1b[_0x23c426(0x999)][_0x3e7a1b[_0x23c426(0x777)]];_0x21ae61=_0x4f2026==='member';if(_0x21ae61){const _0x3de818=_0x4b6fec[_0x23c426(0x5d4)][_0x23c426(0x137)](_0x36b90e=>_0x36b90e['id']===_0x246a68);if(!_0x3de818)return;_0x84d9ce['my']=_0x3de818[_0x23c426(0xc82)]||'',_0x1b9477(!![],_0x3de818['avatar'],_0x3de818[_0x23c426(0xc82)]);}else _0x84d9ce['ai']=_0x4b6fec[_0x23c426(0xcb3)][_0x23c426(0xeba)]||'',_0x84d9ce['my']=_0x4b6fec[_0x23c426(0xcb3)][_0x23c426(0x5b4)]||'',_0x1b9477(![]);_0x54ee54[_0x23c426(0x418)][_0x23c426(0xdda)](_0x23c426(0x40a));}function _0x1b9477(_0x483418=![],_0x4381d3=null,_0x443e45=null){const _0x4d1e79=_0x5a7792,_0x31dd11=document[_0x4d1e79(0x64f)]('ai-frame-grid'),_0x16e537=document[_0x4d1e79(0x64f)]('my-frame-grid'),_0x5c0fdd=_0x3e7a1b[_0x4d1e79(0x999)][_0x3e7a1b[_0x4d1e79(0x777)]];_0x31dd11[_0x4d1e79(0xc58)]='',_0x16e537['innerHTML']='',document[_0x4d1e79(0x49c)](_0x4d1e79(0x9b4))[_0x4d1e79(0x731)]['display']=_0x483418?_0x4d1e79(0x1209):_0x4d1e79(0x1026),document[_0x4d1e79(0x64f)](_0x4d1e79(0xe31))[_0x4d1e79(0x731)]['display']=_0x4d1e79(0xb37),document[_0x4d1e79(0x64f)](_0x4d1e79(0xbe1))[_0x4d1e79(0x731)][_0x4d1e79(0x130)]=_0x4d1e79(0x1209),document[_0x4d1e79(0x64f)]('ai-frame-tab')[_0x4d1e79(0x418)][_0x4d1e79(0xdda)](_0x4d1e79(0x12ef)),document[_0x4d1e79(0x64f)](_0x4d1e79(0xd24))[_0x4d1e79(0x418)][_0x4d1e79(0x1275)](_0x4d1e79(0x12ef));if(_0x483418)_0x1f4fc7[_0x4d1e79(0x103)](_0x36531b=>{const _0x50f177=_0x4d1e79,_0x5e272b=_0x4a39f9(_0x36531b,'my',_0x4381d3);_0x36531b[_0x50f177(0xe52)]===_0x443e45&&_0x5e272b[_0x50f177(0x418)][_0x50f177(0xdda)](_0x50f177(0xbe6)),_0x31dd11[_0x50f177(0x99e)](_0x5e272b);});else{const _0xc2d318=_0x5c0fdd['settings'][_0x4d1e79(0x93)]||_0x54e358,_0x27fe08=_0x5c0fdd[_0x4d1e79(0xcb3)][_0x4d1e79(0x96a)]||(_0x5c0fdd[_0x4d1e79(0x1167)]?_0x60cf2:_0x54e358);_0x1f4fc7[_0x4d1e79(0x103)](_0x2450ad=>{const _0xde4f90=_0x4d1e79,_0x1c17cc=_0x4a39f9(_0x2450ad,'ai',_0xc2d318);if(_0x2450ad[_0xde4f90(0xe52)]===_0x84d9ce['ai'])_0x1c17cc[_0xde4f90(0x418)]['add'](_0xde4f90(0xbe6));_0x31dd11[_0xde4f90(0x99e)](_0x1c17cc);const _0x129609=_0x4a39f9(_0x2450ad,'my',_0x27fe08);if(_0x2450ad[_0xde4f90(0xe52)]===_0x84d9ce['my'])_0x129609[_0xde4f90(0x418)][_0xde4f90(0xdda)](_0xde4f90(0xbe6));_0x16e537['appendChild'](_0x129609);});}}function _0x4a39f9(_0x2d1e04,_0x7285a9,_0x299ad2){const _0x2d5d80=_0x5a7792,_0x5847f5=document[_0x2d5d80(0x124e)]('div');return _0x5847f5[_0x2d5d80(0x87d)]=_0x2d5d80(0x1267),_0x5847f5[_0x2d5d80(0x12e1)][_0x2d5d80(0xa07)]=_0x2d1e04[_0x2d5d80(0xe52)],_0x5847f5[_0x2d5d80(0x1250)]=_0x2d1e04[_0x2d5d80(0x6fc)],_0x5847f5[_0x2d5d80(0xc58)]=_0x2d5d80(0x7b7)+_0x299ad2+'\x22\x20class=\x22preview-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x2d1e04[_0x2d5d80(0xe52)]?_0x2d5d80(0x86)+_0x2d1e04[_0x2d5d80(0xe52)]+_0x2d5d80(0x1089):'')+_0x2d5d80(0x781),_0x5847f5[_0x2d5d80(0xf72)]('click',()=>{const _0x1fd1be=_0x2d5d80;_0x84d9ce[_0x7285a9]=_0x2d1e04[_0x1fd1be(0xe52)];const _0x4ac9c4=_0x7285a9==='ai'?document[_0x1fd1be(0x64f)](_0x1fd1be(0x831)):document[_0x1fd1be(0x64f)]('my-frame-grid');_0x4ac9c4[_0x1fd1be(0x233)](_0x1fd1be(0xf93))['forEach'](_0x38aabe=>_0x38aabe[_0x1fd1be(0x418)][_0x1fd1be(0x1275)](_0x1fd1be(0xbe6))),_0x5847f5[_0x1fd1be(0x418)][_0x1fd1be(0xdda)](_0x1fd1be(0xbe6));}),_0x5847f5;}async function _0xda4eb0(){const _0x4f7992=_0x5a7792;if(!_0x3e7a1b[_0x4f7992(0x777)])return;const _0x1aeaff=_0x3e7a1b[_0x4f7992(0x999)][_0x3e7a1b[_0x4f7992(0x777)]];if(_0x21ae61){const _0x54ab3d=_0x1aeaff[_0x4f7992(0x5d4)]['find'](_0x5d5b86=>_0x5d5b86['id']===_0x246a68);_0x54ab3d&&(_0x54ab3d['avatarFrame']=_0x84d9ce['my']);}else _0x1aeaff[_0x4f7992(0xcb3)][_0x4f7992(0xeba)]=_0x84d9ce['ai'],_0x1aeaff['settings'][_0x4f7992(0x5b4)]=_0x84d9ce['my'];await _0x4e1bbf[_0x4f7992(0x999)][_0x4f7992(0x4fa)](_0x1aeaff);if(!_0x21ae61&&!_0x1aeaff['isGroup']){const _0x32d5b7=_0x1aeaff['id'];for(const _0x38f3d2 of Object[_0x4f7992(0xd6d)](_0x3e7a1b[_0x4f7992(0x999)])){if(_0x38f3d2[_0x4f7992(0x1167)]&&_0x38f3d2[_0x4f7992(0x5d4)]){const _0x3ba4ab=_0x38f3d2[_0x4f7992(0x5d4)][_0x4f7992(0x137)](_0xdf40f3=>_0xdf40f3['id']===_0x32d5b7);_0x3ba4ab&&(_0x3ba4ab['avatarFrame']=_0x1aeaff['settings']['aiAvatarFrame'],await _0x4e1bbf[_0x4f7992(0x999)][_0x4f7992(0x4fa)](_0x38f3d2),console[_0x4f7992(0x1081)](_0x4f7992(0x1075)+_0x32d5b7+_0x4f7992(0x305)+_0x38f3d2[_0x4f7992(0x6fc)]+'\x22'));}}}document[_0x4f7992(0x64f)]('avatar-frame-modal')[_0x4f7992(0x418)][_0x4f7992(0x1275)](_0x4f7992(0x40a)),_0x4817d1(_0x3e7a1b['activeChatId']),alert(_0x4f7992(0x306)),_0x21ae61=![];}function _0x135c1f(){const _0x13922b=_0x5a7792;_0x391510=!_0x391510;const _0x1c8121=document[_0x13922b(0x64f)](_0x13922b(0x1344)),_0x3e5c13=document[_0x13922b(0x64f)](_0x13922b(0x204)),_0x1a32a1=document[_0x13922b(0x64f)](_0x13922b(0xbcb));document[_0x13922b(0x233)](_0x13922b(0x10ec))[_0x13922b(0x103)](_0x39f3c8=>{const _0x2698b4=_0x13922b;_0x39f3c8[_0x2698b4(0x418)]['toggle'](_0x2698b4(0xeea),_0x391510);}),_0x391510?(_0x1c8121[_0x13922b(0xee5)]='完成',_0x3e5c13[_0x13922b(0x731)][_0x13922b(0x130)]=_0x13922b(0x1026),_0xd84f16[_0x13922b(0x1057)](),_0x1a32a1[_0x13922b(0xf1d)]=![],_0x400475()):(_0x1c8121[_0x13922b(0xee5)]='管理',_0x3e5c13[_0x13922b(0x731)][_0x13922b(0x130)]=_0x13922b(0x1209),document['querySelectorAll']('.frame-item.selected')[_0x13922b(0x103)](_0x356811=>{const _0x336464=_0x13922b;_0x356811[_0x336464(0x418)]['remove'](_0x336464(0xbe6));}));}function _0x400475(){const _0xba6818=_0x5a7792,_0x564205=document['getElementById'](_0xba6818(0x12eb));_0x564205['textContent']=_0xba6818(0x83c)+_0xd84f16['size']+')';}function _0x3ad3b7(){const _0x3f9f6e=_0x5a7792,_0x530eb8=document[_0x3f9f6e(0x64f)]('select-all-frames-checkbox')[_0x3f9f6e(0xf1d)],_0x306dc5=document[_0x3f9f6e(0x49c)]('.frame-content[style*=\x22display:\x20block\x22]\x20.frame-grid');if(!_0x306dc5)return;_0x306dc5['querySelectorAll'](_0x3f9f6e(0x9f9))[_0x3f9f6e(0x103)](_0x165422=>{const _0x4d0277=_0x3f9f6e,_0x232628=parseInt(_0x165422[_0x4d0277(0x49c)](_0x4d0277(0x49a))[_0x4d0277(0x12e1)]['id']);if(isNaN(_0x232628))return;_0x165422[_0x4d0277(0x418)][_0x4d0277(0x5cf)](_0x4d0277(0xbe6),_0x530eb8),_0x530eb8?_0xd84f16['add'](_0x232628):_0xd84f16[_0x4d0277(0x3aa)](_0x232628);}),_0x400475();}async function _0x502f64(){const _0x243df6=_0x5a7792;if(_0xd84f16[_0x243df6(0x9dd)]===0x0)return;const _0x5187a9=await _0x54149f(_0x243df6(0x13d2),_0x243df6(0x164)+_0xd84f16[_0x243df6(0x9dd)]+'\x20个自定义头像框吗？',{'confirmButtonClass':_0x243df6(0xeed)});if(_0x5187a9){const _0x14ba73=[..._0xd84f16];await _0x4e1bbf[_0x243df6(0x297)][_0x243df6(0x303)](_0x14ba73),_0x135c1f(),_0x1b9477(_0x21ae61),await _0x28974b(_0x243df6(0x121d),_0x243df6(0x9fe));}}function _0x39cff1(_0x1f8f8d){const _0x4e8e77=_0x5a7792,_0x779bc7=document[_0x4e8e77(0x64f)]('global-custom-style');_0x779bc7&&(_0x779bc7[_0x4e8e77(0xc58)]=_0x1f8f8d||'');}async function _0x1d69ad(_0x43eadd){const _0x33cfe8=_0x5a7792;if(!_0x1c083c['isActive']||!_0x1c083c['activeChatId'])return;const _0xa86561=_0x3e7a1b[_0x33cfe8(0x999)][_0x1c083c['activeChatId']];if(!_0xa86561)return;const _0xbeb5da=_0xa86561['isGroup']?_0xa86561[_0x33cfe8(0xcb3)][_0x33cfe8(0x96f)]||'我':'我',_0x17cd49=_0x33cfe8(0xa3c)+_0xbeb5da+')\x20'+_0x43eadd+']',_0x1bca2d={'role':_0x33cfe8(0x905),'content':_0x17cd49,'timestamp':Date[_0x33cfe8(0x2b5)](),'isHidden':!![]};_0xa86561[_0x33cfe8(0x830)][_0x33cfe8(0x13ee)](_0x1bca2d),await _0x4e1bbf[_0x33cfe8(0x999)]['put'](_0xa86561);}async function _0x37a758(){const _0x355259=_0x5a7792;if(_0x3b4859['size']===0x0)return;const _0xb8e1a9=_0x3e7a1b[_0x355259(0x999)][_0x3e7a1b['activeChatId']];if(!_0xb8e1a9)return;const _0x312fc5=document['getElementById']('selection-screenshot-btn'),_0x3dfdcc=_0x312fc5['textContent'];_0x312fc5['textContent']=_0x355259(0x2ec),_0x312fc5['disabled']=!![];const _0x3c3bc3=document['createElement'](_0x355259(0x479)),_0x592e25=document[_0x355259(0x64f)](_0x355259(0x4f8));_0x3c3bc3[_0x355259(0x731)][_0x355259(0x1123)]=_0x592e25[_0x355259(0x387)]+'px',_0x3c3bc3[_0x355259(0x731)][_0x355259(0x126)]=_0x355259(0xa9a),_0x3c3bc3[_0x355259(0x731)][_0x355259(0x4ed)]=_0x355259(0x4ef),_0x3c3bc3[_0x355259(0x731)][_0x355259(0xbbf)]=_0x355259(0x4ef),_0x3c3bc3['style']['display']=_0x355259(0x1026),_0x3c3bc3['style']['flexDirection']='column',_0x3c3bc3[_0x355259(0x731)][_0x355259(0x877)]=_0x355259(0x126b);const _0x288f6c=document[_0x355259(0x64f)](_0x355259(0x9aa));_0x3c3bc3[_0x355259(0x731)][_0x355259(0x4d6)]=_0x288f6c[_0x355259(0x731)][_0x355259(0x4d6)],_0x3c3bc3[_0x355259(0x731)][_0x355259(0xfd6)]=_0x288f6c['style'][_0x355259(0xfd6)]||(document[_0x355259(0x64f)](_0x355259(0x4f8))[_0x355259(0x418)][_0x355259(0xef6)](_0x355259(0x1313))?_0x355259(0xfd8):'#f0f2f5');const _0x3c5d27=document['createElement'](_0x355259(0x731));_0x3c5d27[_0x355259(0xc58)]=_0x355259(0x619),document[_0x355259(0x798)]['appendChild'](_0x3c5d27);try{const _0x35d82f=_0x288f6c[_0x355259(0x49c)](_0x355259(0x113b))[_0x355259(0xc66)](!![]);_0x35d82f[_0x355259(0x418)][_0x355259(0xdda)](_0x355259(0x6be));const _0x3edcb1=document['createElement']('div'),_0x3e51b3=document['getElementById']('chat-messages');_0x3edcb1['style'][_0x355259(0x130)]=_0x355259(0x1026),_0x3edcb1[_0x355259(0x731)]['flexDirection']=_0x355259(0x96d),_0x3edcb1['style']['gap']=_0x355259(0x8fe),_0x3edcb1[_0x355259(0x731)][_0x355259(0xebf)]=_0x355259(0x1136),_0x3edcb1[_0x355259(0x731)][_0x355259(0x1123)]='100%',_0x3edcb1[_0x355259(0x731)][_0x355259(0x381)]='border-box',_0x3edcb1['dataset'][_0x355259(0xb3d)]=_0x3e51b3[_0x355259(0x12e1)][_0x355259(0xb3d)],_0x3edcb1[_0x355259(0x731)][_0x355259(0xee2)](_0x355259(0x336),_0x3e51b3[_0x355259(0x731)][_0x355259(0xce3)](_0x355259(0x336)));const _0x2750fd=_0x288f6c['querySelector'](_0x355259(0x6ac))[_0x355259(0xc66)](!![]),_0x5e2f7d=[..._0x3b4859]['sort']((_0x790491,_0x2b5502)=>_0x790491-_0x2b5502);_0x5e2f7d[_0x355259(0x103)](_0x18942c=>{const _0x3e1ba1=_0x355259,_0x564d70=document[_0x3e1ba1(0x49c)]('.message-bubble[data-timestamp=\x22'+_0x18942c+'\x22]');if(_0x564d70){const _0x3fed9a=_0x564d70[_0x3e1ba1(0x2fc)]('.message-wrapper');_0x3fed9a&&_0x3edcb1[_0x3e1ba1(0x99e)](_0x3fed9a['cloneNode'](!![]));}}),_0x3c3bc3[_0x355259(0x99e)](_0x35d82f),_0x3c3bc3[_0x355259(0x99e)](_0x3edcb1),_0x3c3bc3['appendChild'](_0x2750fd),document['body'][_0x355259(0x99e)](_0x3c3bc3);const _0xc89b22=Array['from'](_0x3c3bc3['getElementsByTagName'](_0x355259(0x756))),_0x4d9c25=_0xc89b22[_0x355259(0xb96)](_0x249b95=>new Promise((_0x3cc07a,_0x457847)=>{const _0x3c06e8=_0x355259;if(_0x249b95[_0x3c06e8(0xbe8)][_0x3c06e8(0x7d)](_0x3c06e8(0x1b8))){_0x3cc07a();return;}const _0x54601b=new Image();_0x54601b[_0x3c06e8(0x123a)]='anonymous',_0x54601b['onload']=_0x3cc07a,_0x54601b[_0x3c06e8(0x36b)]=_0x3cc07a,_0x54601b[_0x3c06e8(0xbe8)]=_0x249b95[_0x3c06e8(0xbe8)];}));await Promise[_0x355259(0xfd7)](_0x4d9c25);const _0x5b6469=await html2canvas(_0x3c3bc3,{'allowTaint':!![],'useCORS':!![],'backgroundColor':null,'scale':window[_0x355259(0x81f)]||0x2});_0x5b6469[_0x355259(0x2c7)](function(_0x5263b0){const _0x378b5f=_0x355259,_0x17f374=URL[_0x378b5f(0xb29)](_0x5263b0),_0x1d3950=document[_0x378b5f(0x124e)]('a');_0x1d3950[_0x378b5f(0x1134)]=_0x378b5f(0x174)+_0xb8e1a9[_0x378b5f(0x6fc)]+'-'+Date[_0x378b5f(0x2b5)]()+_0x378b5f(0xcc4),_0x1d3950['href']=_0x17f374,document[_0x378b5f(0x872)][_0x378b5f(0x99e)](_0x1d3950),_0x1d3950['click'](),document[_0x378b5f(0x872)][_0x378b5f(0x24c)](_0x1d3950),URL[_0x378b5f(0x74f)](_0x17f374);},_0x355259(0xc99));}catch(_0x279ffa){console['error'](_0x355259(0x9bd),_0x279ffa),await _0x28974b(_0x355259(0x129b),'生成截图时发生错误，请检查控制台获取详情。');}finally{document[_0x355259(0x872)][_0x355259(0x24c)](_0x3c3bc3),document['head'][_0x355259(0x24c)](_0x3c5d27),_0x312fc5['textContent']=_0x3dfdcc,_0x312fc5[_0x355259(0x1b0)]=![],_0x5ec8b6();}}function _0x422b3c(_0x337ca3){const _0x52d448=_0x5a7792;if(!_0x337ca3||typeof _0x337ca3!==_0x52d448(0x1251))return'';return _0x337ca3=_0x337ca3[_0x52d448(0x137f)](/!h\{(.*?)\}/g,'<span\x20class=\x22diary-highlight\x22>$1</span>'),_0x337ca3=_0x337ca3[_0x52d448(0x137f)](/!u\{(.*?)\}/g,'<span\x20class=\x22diary-underline\x22>$1</span>'),_0x337ca3=_0x337ca3[_0x52d448(0x137f)](/!e\{(.*?)\}/g,_0x52d448(0xbcf)),_0x337ca3=_0x337ca3['replace'](/!w\{(.*?)\}/g,_0x52d448(0x125c)),_0x337ca3=_0x337ca3[_0x52d448(0x137f)](/!m\{(.*?)\}/g,_0x52d448(0xf8b)),_0x337ca3=_0x337ca3[_0x52d448(0x137f)](/\|\|(.*?)\|\|/g,_0x52d448(0x116f)),_0x337ca3=_0x337ca3['replace'](/\*\*(.*?)\*\*/g,_0x52d448(0x563)),_0x337ca3=_0x337ca3['replace'](/\~\~(.*?)\~\~/g,_0x52d448(0xb04)),_0x337ca3=_0x337ca3[_0x52d448(0x137f)](/\*(.*?)\*/g,_0x52d448(0x56e)),_0x337ca3;}async function _0x571467(){const _0x56bc88=_0x5a7792;console[_0x56bc88(0x1081)](_0x56bc88(0x11db));let _0x16e74d=0x0;const _0x17ba6e=Object[_0x56bc88(0xd6d)](_0x3e7a1b[_0x56bc88(0x999)]);for(const _0x2a5576 of _0x17ba6e){let _0x56c620=![];for(const _0x458084 of _0x2a5576[_0x56bc88(0x830)]){_0x458084[_0x56bc88(0xafc)]==='red_packet'&&_0x458084[_0x56bc88(0x13d4)]===_0x56bc88(0xc33)&&_0x458084[_0x56bc88(0x931)]===_0x56bc88(0x12c3)&&_0x458084[_0x56bc88(0xed1)](_0x56bc88(0x13f))&&!_0x458084[_0x56bc88(0xed1)](_0x56bc88(0xc12))&&(_0x458084[_0x56bc88(0xc12)]=_0x458084[_0x56bc88(0x13f)],delete _0x458084['receiver'],_0x56c620=!![],_0x16e74d++);}_0x56c620&&(console[_0x56bc88(0x1081)](_0x56bc88(0x867)+_0x2a5576[_0x56bc88(0x6fc)]+'\x22\x20中发现并修复了旧红包数据。'),await _0x4e1bbf['chats'][_0x56bc88(0x4fa)](_0x2a5576));}_0x16e74d>0x0?(console[_0x56bc88(0x1081)](_0x56bc88(0x570)+_0x16e74d+_0x56bc88(0xbb1)),alert(_0x56bc88(0xc8)+_0x16e74d+_0x56bc88(0x509)),location[_0x56bc88(0x10ea)]()):console['log'](_0x56bc88(0x2ca));}function _0x267b3d(_0x21837a){const _0x101c1b=_0x5a7792,_0x52a515=_0x3e7a1b['chats'][_0x21837a];if(!_0x52a515||_0x52a515[_0x101c1b(0x1167)])return;document[_0x101c1b(0x64f)](_0x101c1b(0x1302))[_0x101c1b(0xee5)]=_0x52a515[_0x101c1b(0x12d9)]||_0x101c1b(0x3cd),document[_0x101c1b(0x64f)]('profile-random-jottings')['textContent']=_0x52a515[_0x101c1b(0xb9d)]||'...';const _0x20d634=document[_0x101c1b(0x64f)](_0x101c1b(0xee7));_0x20d634[_0x101c1b(0x418)][_0x101c1b(0xdda)]('visible');}function _0x56d2c2(){const _0x2d44d3=_0x5a7792;document[_0x2d44d3(0x64f)]('profile-main-content')[_0x2d44d3(0x731)]['display']=_0x2d44d3(0x1209),document[_0x2d44d3(0x64f)]('profile-thoughts-history-view')[_0x2d44d3(0x731)][_0x2d44d3(0x130)]='flex',_0x5b5c7d();}function _0x1ec9a4(){const _0x380060=_0x5a7792;document[_0x380060(0x64f)](_0x380060(0x835))[_0x380060(0x731)]['display']=_0x380060(0x1209),document[_0x380060(0x64f)](_0x380060(0xc6))['style'][_0x380060(0x130)]=_0x380060(0x1026);}function _0x5b5c7d(){const _0x4e0fef=_0x5a7792,_0xf95eeb=document[_0x4e0fef(0x64f)](_0x4e0fef(0xcce)),_0x4b04d2=_0x3e7a1b['chats'][_0x3e7a1b[_0x4e0fef(0x777)]];_0xf95eeb[_0x4e0fef(0xc58)]='';if(!_0x4b04d2||!_0x4b04d2[_0x4e0fef(0x7ea)]||_0x4b04d2[_0x4e0fef(0x7ea)][_0x4e0fef(0x40f)]===0x0){_0xf95eeb[_0x4e0fef(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20#8a8a8a;\x20padding:\x2030px\x200;\x22>这里还没有历史记录哦。</p>';return;}const _0x5b8169=[..._0x4b04d2[_0x4e0fef(0x7ea)]][_0x4e0fef(0x2f4)](),_0x48f95b=_0x5b8169[_0x4e0fef(0xdf5)](0x0,_0x4bfd24);_0x48f95b[_0x4e0fef(0x103)](_0x3d5152=>{const _0x8a8505=_0x4e0fef,_0x1a4e27=_0x33b03c(_0x3d5152);_0xf95eeb[_0x8a8505(0x99e)](_0x1a4e27);}),_0x502e19=_0x48f95b[_0x4e0fef(0x40f)],_0x5b8169[_0x4e0fef(0x40f)]>_0x502e19&&appendLoadMoreThoughtsButton(_0xf95eeb);}async function _0x2b08a1(){const _0x69d729=_0x5a7792;if(_0x3ca822)return;_0x3ca822=!![];const _0x349122=document['getElementById'](_0x69d729(0xcce)),_0x6fb2d1=_0x3e7a1b['chats'][_0x3e7a1b[_0x69d729(0x777)]];if(!_0x6fb2d1){_0x3ca822=![];return;}_0x429707(_0x349122,_0x69d729(0x8da)),await new Promise(_0x5e77a2=>setTimeout(_0x5e77a2,0x1f4));const _0x1dcf24=[..._0x6fb2d1[_0x69d729(0x7ea)]]['reverse'](),_0xd40d46=_0x1dcf24[_0x69d729(0x40f)],_0x109ec6=_0x502e19,_0xe27159=_0x502e19+_0x4bfd24,_0xdead45=_0x1dcf24[_0x69d729(0xdf5)](_0x109ec6,_0xe27159);_0x23b212(_0x349122),_0xdead45[_0x69d729(0x103)](_0x75dbf7=>{const _0xa9911f=_0x69d729,_0x35f7f6=_0x33b03c(_0x75dbf7);_0x349122[_0xa9911f(0x99e)](_0x35f7f6);}),_0x502e19+=_0xdead45[_0x69d729(0x40f)],_0x3ca822=![];}function _0x33b03c(_0x4d7b1f){const _0x325e00=_0x5a7792,_0x2fcd66=document[_0x325e00(0x124e)](_0x325e00(0x479));_0x2fcd66['className']=_0x325e00(0xf64);const _0x2e5f72=new Date(_0x4d7b1f[_0x325e00(0x8af)]),_0x3d6c40=_0x2e5f72[_0x325e00(0xf87)]()+'-'+String(_0x2e5f72['getMonth']()+0x1)['padStart'](0x2,'0')+'-'+String(_0x2e5f72[_0x325e00(0x12e)]())[_0x325e00(0xf2)](0x2,'0')+'\x20'+String(_0x2e5f72[_0x325e00(0xdb)]())[_0x325e00(0xf2)](0x2,'0')+':'+String(_0x2e5f72[_0x325e00(0x14f)]())[_0x325e00(0xf2)](0x2,'0');return _0x2fcd66['innerHTML']=_0x325e00(0x66f)+_0x4d7b1f['timestamp']+_0x325e00(0xab0)+_0x3d6c40+_0x325e00(0xf63)+_0x4d7b1f[_0x325e00(0x12d9)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22jottings\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22label\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><path\x20d=\x22M12\x2019l7-7\x203\x203-7\x207-3-3z\x22></path><path\x20d=\x22M18\x2013l-1.5-7.5L2\x202l3.5\x2014.5L13\x2018l5-5z\x22></path><path\x20d=\x22M2\x202l7.586\x207.586\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20散记\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22text\x22>'+_0x4d7b1f[_0x325e00(0xb9d)]+_0x325e00(0x113f),_0x2fcd66;}async function _0x5c828a(_0x7b0c32){const _0x372bee=_0x5a7792,_0x3fe12a=_0x7b0c32['target'][_0x372bee(0x91e)][0x0];if(!_0x3fe12a)return;try{let _0x5a5061,_0x4f504c=null;if(_0x3fe12a[_0x372bee(0x6fc)][_0x372bee(0x720)](_0x372bee(0xec))){const _0x101e52=await _0x3fe12a['text']();_0x5a5061=JSON['parse'](_0x101e52);}else{if(_0x3fe12a[_0x372bee(0x6fc)]['endsWith'](_0x372bee(0xcc4))){const _0x3bf516=await _0x3fe12a['arrayBuffer']();_0x5a5061=await _0x12846e(_0x3bf516),_0x4f504c=await new Promise(_0x712f33=>{const _0x28ceb1=_0x372bee,_0x3c1dae=new FileReader();_0x3c1dae[_0x28ceb1(0x139d)]=()=>_0x712f33(_0x3c1dae['result']),_0x3c1dae[_0x28ceb1(0xb4)](_0x3fe12a);});}else throw new Error(_0x372bee(0x1320));}await _0x19aa6f(_0x5a5061,_0x4f504c);}catch(_0x2c9b49){console['error'](_0x372bee(0x1fc),_0x2c9b49),await _0x28974b(_0x372bee(0xae3),_0x372bee(0x8ab)+_0x2c9b49['message']);}finally{_0x7b0c32[_0x372bee(0xf5b)][_0x372bee(0xbed)]=null;}}function _0x12846e(_0x35fd2c){return new Promise((_0x52bd75,_0x28205d)=>{const _0x2fcf7f=_0x2bd6,_0x2110a5=new DataView(_0x35fd2c);if(_0x2110a5[_0x2fcf7f(0xc3f)](0x0)!==0x89504e47||_0x2110a5[_0x2fcf7f(0xc3f)](0x4)!==0xd0a1a0a)return _0x28205d(new Error('文件不是一个有效的PNG。'));let _0x50a64d=0x8;const _0x444410=new TextDecoder();while(_0x50a64d<_0x2110a5[_0x2fcf7f(0xe74)]){const _0xcd9c80=_0x2110a5[_0x2fcf7f(0xc3f)](_0x50a64d),_0x16bd46=_0x444410['decode'](_0x35fd2c[_0x2fcf7f(0xdf5)](_0x50a64d+0x4,_0x50a64d+0x8));if(_0x16bd46==='tEXt'){const _0x39c2d=new Uint8Array(_0x35fd2c,_0x50a64d+0x8,_0xcd9c80),_0xe5f7a9=_0x39c2d['indexOf'](0x0);if(_0xe5f7a9!==-0x1){const _0x264a77=_0x444410[_0x2fcf7f(0x8be)](_0x39c2d[_0x2fcf7f(0xdf5)](0x0,_0xe5f7a9));if(_0x264a77===_0x2fcf7f(0x230)){const _0x3c4246=_0x444410[_0x2fcf7f(0x8be)](_0x39c2d[_0x2fcf7f(0xdf5)](_0xe5f7a9+0x1));try{const _0x5ba5e2=atob(_0x3c4246),_0x8be145=new Uint8Array(_0x5ba5e2[_0x2fcf7f(0x40f)]);for(let _0x3ab7fc=0x0;_0x3ab7fc<_0x5ba5e2[_0x2fcf7f(0x40f)];_0x3ab7fc++){_0x8be145[_0x3ab7fc]=_0x5ba5e2['charCodeAt'](_0x3ab7fc);}const _0x380961=new TextDecoder(_0x2fcf7f(0xf83))['decode'](_0x8be145);_0x52bd75(JSON[_0x2fcf7f(0x1214)](_0x380961));return;}catch(_0x37737d){return _0x28205d(new Error(_0x2fcf7f(0x3b5)+_0x37737d[_0x2fcf7f(0x854)]));}}}}_0x50a64d+=0x4+0x4+_0xcd9c80+0x4;}_0x28205d(new Error(_0x2fcf7f(0x1d0)));});}function _0x263d29(_0xb58456){const _0x52d85f=_0x5a7792;if(_0xb58456[_0x52d85f(0x88a)]?.[_0x52d85f(0x10fa)]?.[_0x52d85f(0x1052)]?.[_0x52d85f(0x40f)]>0x0)return console[_0x52d85f(0x1081)](_0x52d85f(0x5a7)),_0xb58456[_0x52d85f(0x88a)][_0x52d85f(0x10fa)][_0x52d85f(0x1052)];if(_0xb58456[_0x52d85f(0xa61)]?.[_0x52d85f(0x10fa)]?.[_0x52d85f(0x1052)]?.[_0x52d85f(0x40f)]>0x0)return console[_0x52d85f(0x1081)](_0x52d85f(0x101d)),_0xb58456[_0x52d85f(0xa61)][_0x52d85f(0x10fa)]['entries'];if(_0xb58456[_0x52d85f(0x88a)]?.['extensions']?.[_0x52d85f(0x10fa)]?.[_0x52d85f(0x1052)]?.['length']>0x0)return console[_0x52d85f(0x1081)](_0x52d85f(0xe7b)),_0xb58456['data'][_0x52d85f(0xa61)][_0x52d85f(0x10fa)][_0x52d85f(0x1052)];const _0x55a79b=['character_book',_0x52d85f(0x994),_0x52d85f(0x455),_0x52d85f(0x48a)];for(const _0x141520 of _0x55a79b){if(_0xb58456[_0x141520]?.['entries']?.[_0x52d85f(0x40f)]>0x0)return console['log'](_0x52d85f(0xd94)+_0x141520+'\x20中找到世界书。'),_0xb58456[_0x141520][_0x52d85f(0x1052)];}return console[_0x52d85f(0x1081)]('诊断：未在此角色卡中找到任何有效的世界书数据。'),null;}async function _0x19aa6f(_0xe84c69,_0x14fc9d=null){const _0x434929=_0x5a7792,_0x2b8b8b=_0xe84c69[_0x434929(0x88a)]||_0xe84c69;if(!_0x2b8b8b['name'])throw new Error(_0x434929(0x769));let _0x5b5f09=null;const _0x549660=_0x263d29(_0xe84c69);if(_0x549660){const _0x2739f8=_0x549660[_0x434929(0x156)](_0x3e6805=>_0x3e6805[_0x434929(0x9b)]&&_0x3e6805[_0x434929(0x3ba)])[_0x434929(0xb96)](_0x1557ca=>({'keys':_0x1557ca[_0x434929(0xc30)]||[],'comment':_0x1557ca[_0x434929(0x652)]||'','content':_0x1557ca[_0x434929(0x3ba)][_0x434929(0x137f)](/<memory>|<\/memory>/g,'')[_0x434929(0x43a)]()}));if(_0x2739f8[_0x434929(0x40f)]>0x0){const _0x45c8e4={'id':_0x434929(0x734)+Date[_0x434929(0x2b5)](),'name':_0x2b8b8b['name']+_0x434929(0x8d3),'content':_0x2739f8,'categoryId':null};await _0x4e1bbf[_0x434929(0x144)][_0x434929(0xdda)](_0x45c8e4),_0x3e7a1b[_0x434929(0x144)][_0x434929(0x13ee)](_0x45c8e4),_0x5b5f09=_0x45c8e4['id'];}}let _0x994f4=_0x2b8b8b[_0x434929(0x9af)]||_0xe84c69[_0x434929(0x9af)]||'无';_0x994f4=_0x994f4[_0x434929(0x137f)](/```yaml/g,'')[_0x434929(0x137f)](/```/g,'')[_0x434929(0x137f)](/<\/?info>/g,'')[_0x434929(0x137f)](/<\/?character>/g,'')[_0x434929(0x137f)](/<\/?writing_rule>/g,'')[_0x434929(0x137f)](/\[OOC：.*?\]/g,'')[_0x434929(0x43a)]();let _0x4760b4=_0x434929(0x1076)+_0x994f4+'\x0a\x0a';if(_0x2b8b8b['personality'])_0x4760b4+=_0x434929(0x800)+_0x2b8b8b[_0x434929(0x20f)]+'\x0a\x0a';if(_0x2b8b8b[_0x434929(0xc41)])_0x4760b4+=_0x434929(0x1002)+_0x2b8b8b[_0x434929(0xc41)]+'\x0a\x0a';if(_0x2b8b8b[_0x434929(0x900)])_0x4760b4+=_0x434929(0xa2b)+_0x2b8b8b[_0x434929(0x900)]+'\x0a\x0a';const _0xca8f0b=_0x2b8b8b['name'],_0xeade2f=_0x2b8b8b[_0x434929(0x6fc)],_0x5d3893='chat_'+Date[_0x434929(0x2b5)](),_0x90f2e9={'id':_0x5d3893,'name':_0xca8f0b['trim'](),'originalName':_0xeade2f[_0x434929(0x43a)](),'isGroup':![],'relationship':{'status':_0x434929(0xfdd)},'status':{'text':'在线','lastUpdate':Date['now'](),'isBusy':![]},'settings':{'aiPersona':_0x4760b4,'myPersona':_0x434929(0xd09),'maxMemory':0xa,'aiAvatar':_0x54e358,'myAvatar':_0x54e358,'background':'','theme':_0x434929(0xf5d),'fontSize':0xd,'customCss':'','linkedWorldBookIds':_0x5b5f09?[_0x5b5f09]:[],'aiAvatarLibrary':[]},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[]};_0x14fc9d&&(_0x90f2e9[_0x434929(0xcb3)][_0x434929(0x93)]=_0x14fc9d,_0x90f2e9[_0x434929(0xcb3)]['aiAvatarLibrary'][_0x434929(0x13ee)]({'name':'默认头像','url':_0x14fc9d}));const _0xc772c4=_0x2b8b8b['first_mes']||_0xe84c69['first_mes'];if(_0xc772c4&&typeof _0xc772c4==='string'){const _0x40c864=document[_0x434929(0x124e)]('div');_0x40c864[_0x434929(0xc58)]=_0xc772c4;const _0x4531dc=(_0x40c864[_0x434929(0xee5)]||_0x40c864[_0x434929(0xbef)]||'')['replace'](/原作者UR.*?开局/s,'')[_0x434929(0x43a)]();_0x4531dc&&_0x90f2e9[_0x434929(0x830)][_0x434929(0x13ee)]({'role':_0x434929(0x12c3),'senderName':_0x90f2e9[_0x434929(0x7de)],'content':_0x4531dc,'timestamp':Date[_0x434929(0x2b5)]()});}_0x3e7a1b['chats'][_0x5d3893]=_0x90f2e9,await _0x4e1bbf['chats']['put'](_0x90f2e9),_0x21f6ea();let _0x43d727=_0x434929(0x238)+_0x90f2e9['name']+'”\x20已成功导入！';_0x5b5f09&&(_0x43d727+=_0x434929(0xac0)),await _0x28974b(_0x434929(0x5f2),_0x43d727);}async function _0x545e0a(){const _0x344c95=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x4708b5=_0x3e7a1b[_0x344c95(0x999)][_0x3e7a1b['activeChatId']],_0xe9185=_0x4708b5['settings'][_0x344c95(0x13b)];if(!_0xe9185||_0xe9185[_0x344c95(0x40f)]===0x0){alert('这个角色没有可用的备选开场白。');return;}const _0x5e9104=_0xe9185[_0x344c95(0xb96)]((_0x557bec,_0x357e7d)=>{const _0x5d3853=_0x344c95,_0x4c0d47=_0x557bec[_0x5d3853(0x137f)](/<[^>]*>/g,'')[_0x5d3853(0x43a)]()[_0x5d3853(0x126f)](0x0,0x14);return{'text':_0x5d3853(0x1098)+(_0x357e7d+0x1)+':\x20'+_0x4c0d47+_0x5d3853(0x3cd),'value':_0x357e7d};}),_0xc76c06=await _0x217169(_0x344c95(0x11d),_0x5e9104);if(_0xc76c06!==null){const _0x4d42b4=await _0x54149f(_0x344c95(0x12fe),'切换开场将会【清空并替换】当前的所有聊天记录。确定要继续吗？',{'confirmButtonClass':'btn-danger','confirmText':_0x344c95(0x441)});if(_0x4d42b4){const _0x1e6abe=_0xe9185[_0xc76c06],_0x291bb5={'role':'assistant','senderName':_0x4708b5['originalName'],'content':_0x1e6abe,'timestamp':Date[_0x344c95(0x2b5)]()};_0x4708b5[_0x344c95(0x830)]=[_0x291bb5],await _0x4e1bbf['chats'][_0x344c95(0x4fa)](_0x4708b5),_0x4817d1(_0x4708b5['id']),document[_0x344c95(0x64f)](_0x344c95(0x201))['classList'][_0x344c95(0x1275)](_0x344c95(0x40a)),await _0x28974b('成功',_0x344c95(0xa45));}}}function _0x20cd0b(_0x112041={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x304bdf=_0x5a7792,_0x5671fe=document[_0x304bdf(0x124e)](_0x304bdf(0x479));_0x5671fe[_0x304bdf(0x87d)]=_0x304bdf(0x104a);const _0x1f1cfc=_0x112041['enabled']!==![]?'checked':'';return _0x5671fe[_0x304bdf(0xc58)]=_0x304bdf(0x13b0)+_0x1f1cfc+_0x304bdf(0x9b1)+(_0x112041[_0x304bdf(0x652)]||'')+_0x304bdf(0x1af)+(_0x112041[_0x304bdf(0xc30)]||[])[_0x304bdf(0xd22)](',\x20')+_0x304bdf(0xbae)+(_0x112041['content']||'')+_0x304bdf(0x19d),_0x5671fe['querySelector'](_0x304bdf(0x7c3))[_0x304bdf(0xf72)](_0x304bdf(0x1080),()=>{const _0xa03883=_0x304bdf;_0x5671fe[_0xa03883(0x1275)]();}),_0x5671fe;}async function _0x4d834e(){const _0xacb69=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x115e50=_0x3e7a1b[_0xacb69(0x777)],_0x34a2db=document[_0xacb69(0x64f)](_0xacb69(0x11f8));if(!_0x34a2db[_0xacb69(0x418)]['contains']('visible')){const _0x402fe8=document[_0xacb69(0x49c)](_0xacb69(0x1247));_0x34a2db[_0xacb69(0x731)][_0xacb69(0x4ed)]=_0x402fe8[_0xacb69(0xbb)]+'px',_0x34a2db[_0xacb69(0x731)][_0xacb69(0x130)]=_0xacb69(0xb37),(!_0x4dc8ec[_0x115e50]||!_0x4dc8ec[_0x115e50][_0xacb69(0xb30)])&&_0xb62760(_0x115e50),_0x4d13d0(_0x115e50),setTimeout(async()=>{const _0x33a861=_0xacb69;_0x34a2db['classList'][_0x33a861(0xdda)](_0x33a861(0x40a));const _0x4cca8f={'role':_0x33a861(0x905),'content':_0x33a861(0x61a),'timestamp':Date[_0x33a861(0x2b5)](),'isHidden':!![]};_0x3e7a1b['chats'][_0x115e50]['history']['push'](_0x4cca8f),await _0x4e1bbf[_0x33a861(0x999)][_0x33a861(0x4fa)](_0x3e7a1b[_0x33a861(0x999)][_0x115e50]);},0xa);}else await _0x476258();}async function _0x476258(){const _0x4a26a5=_0x5a7792;if(!_0x3e7a1b[_0x4a26a5(0x777)])return;const _0x5a9947=_0x3e7a1b[_0x4a26a5(0x777)],_0x5ca304=document[_0x4a26a5(0x64f)](_0x4a26a5(0x11f8));_0x5ca304['classList'][_0x4a26a5(0x1275)](_0x4a26a5(0x40a)),setTimeout(()=>{const _0x8e115e=_0x4a26a5;_0x5ca304[_0x8e115e(0x731)]['display']=_0x8e115e(0x1209);},0x12c);if(_0x4dc8ec[_0x5a9947]){_0x4dc8ec[_0x5a9947][_0x4a26a5(0xb30)]=![];const _0x4d6bee={'role':'system','content':_0x4a26a5(0xa5c),'timestamp':Date[_0x4a26a5(0x2b5)](),'isHidden':!![]};_0x3e7a1b[_0x4a26a5(0x999)][_0x5a9947]['history'][_0x4a26a5(0x13ee)](_0x4d6bee),await _0x4e1bbf['chats'][_0x4a26a5(0x4fa)](_0x3e7a1b[_0x4a26a5(0x999)][_0x5a9947]);}}function _0xb62760(_0x381825){const _0x301bc9=_0x5a7792,_0x2f0a22=document[_0x301bc9(0x64f)](_0x301bc9(0x8f9)),_0xa1419b=document[_0x301bc9(0x64f)](_0x301bc9(0x11f8)),_0x14e45c=document[_0x301bc9(0x64f)](_0x301bc9(0xd7b)),_0x3ad3dd=_0xa1419b[_0x301bc9(0x387)]-0x28,_0x4c7382=_0xa1419b[_0x301bc9(0xbb)]-_0x14e45c[_0x301bc9(0xbb)]-0x28,_0x5fd1ac=Math[_0x301bc9(0x1245)](Math[_0x301bc9(0x2de)](_0x3ad3dd,_0x4c7382)),_0x4c28b7=0xf,_0x14623f=Math[_0x301bc9(0x1245)](_0x5fd1ac/_0x4c28b7),_0x48878c=_0x14623f*_0x4c28b7;_0x2f0a22[_0x301bc9(0x1123)]=_0x48878c,_0x2f0a22[_0x301bc9(0x877)]=_0x48878c,_0x4dc8ec[_0x381825]={'isActive':!![],'board':Array(_0x4c28b7)[_0x301bc9(0x134a)](0x0)['map'](()=>Array(_0x4c28b7)['fill'](0x0)),'currentPlayer':0x1,'history':[],'isGameOver':![],'GRID_SIZE':_0x4c28b7,'CELL_SIZE':_0x14623f};}function _0x4d13d0(_0x786f8b){const _0xd9183c=_0x5a7792,_0x44fdc5=_0x4dc8ec[_0x786f8b];if(!_0x44fdc5)return;const _0x248a46=document['getElementById'](_0xd9183c(0x8f9)),_0x5a40cd=_0x248a46[_0xd9183c(0x1370)]('2d'),{GRID_SIZE:_0x13c7a8,CELL_SIZE:_0x2b3fe5}=_0x44fdc5,_0x222fb6=_0x2b3fe5/0x2;_0x5a40cd[_0xd9183c(0xab9)](0x0,0x0,_0x248a46[_0xd9183c(0x1123)],_0x248a46[_0xd9183c(0x877)]),_0x5a40cd[_0xd9183c(0xee1)]=_0xd9183c(0xc31),_0x5a40cd[_0xd9183c(0xc97)](0x0,0x0,_0x248a46[_0xd9183c(0x1123)],_0x248a46[_0xd9183c(0x877)]),_0x5a40cd['strokeStyle']=_0xd9183c(0x61b),_0x5a40cd[_0xd9183c(0x1130)]=0x1;for(let _0x592fd2=0x0;_0x592fd2<_0x13c7a8;_0x592fd2++){_0x5a40cd[_0xd9183c(0x5fd)](),_0x5a40cd[_0xd9183c(0x13cd)](_0x222fb6,_0x222fb6+_0x592fd2*_0x2b3fe5),_0x5a40cd[_0xd9183c(0x1078)](_0x248a46[_0xd9183c(0x1123)]-_0x222fb6,_0x222fb6+_0x592fd2*_0x2b3fe5),_0x5a40cd['stroke'](),_0x5a40cd[_0xd9183c(0x5fd)](),_0x5a40cd[_0xd9183c(0x13cd)](_0x222fb6+_0x592fd2*_0x2b3fe5,_0x222fb6),_0x5a40cd[_0xd9183c(0x1078)](_0x222fb6+_0x592fd2*_0x2b3fe5,_0x248a46['height']-_0x222fb6),_0x5a40cd[_0xd9183c(0x1038)]();}for(let _0x4327a1=0x0;_0x4327a1<_0x13c7a8;_0x4327a1++){for(let _0x5f19eb=0x0;_0x5f19eb<_0x13c7a8;_0x5f19eb++){_0x44fdc5[_0xd9183c(0x9e4)][_0x4327a1][_0x5f19eb]!==0x0&&_0xeff3e4(_0x5a40cd,_0x5f19eb,_0x4327a1,_0x44fdc5[_0xd9183c(0x9e4)][_0x4327a1][_0x5f19eb],_0x44fdc5);}}}function _0xeff3e4(_0x5427a4,_0x4353a4,_0x4ec094,_0x610640,_0x41dac0){const _0x19690b=_0x5a7792,{CELL_SIZE:_0x44eb56}=_0x41dac0,_0x30e488=_0x44eb56/0x2,_0x4a127e=_0x44eb56/0x2-0x2;_0x5427a4['beginPath'](),_0x5427a4[_0x19690b(0xfb9)](_0x30e488+_0x4353a4*_0x44eb56,_0x30e488+_0x4ec094*_0x44eb56,_0x4a127e,0x0,0x2*Math['PI']),_0x610640===0x1?_0x5427a4[_0x19690b(0xee1)]=_0x19690b(0x29c):_0x5427a4[_0x19690b(0xee1)]='white',_0x5427a4[_0x19690b(0x134a)]();}function _0x3008d4(_0x2f44a9){const _0xd35e6d=_0x5a7792,_0x36568d=_0x3e7a1b[_0xd35e6d(0x777)],_0x24e11a=_0x4dc8ec[_0x36568d];if(!_0x24e11a||_0x24e11a['isGameOver']||_0x24e11a[_0xd35e6d(0x1322)]!==0x1)return;const _0xaedc00=document['getElementById']('gomoku-board'),_0x29c4f2=_0xaedc00[_0xd35e6d(0x1370)]('2d'),_0x540cf4=_0xaedc00[_0xd35e6d(0x528)](),_0x25c6de=_0x2f44a9[_0xd35e6d(0x663)]-_0x540cf4['left'],_0x1cf9e1=_0x2f44a9[_0xd35e6d(0xdcc)]-_0x540cf4[_0xd35e6d(0x4ed)],_0x27cdff=Math[_0xd35e6d(0xb15)]((_0x25c6de-_0x24e11a['CELL_SIZE']/0x2)/_0x24e11a[_0xd35e6d(0x50e)]),_0xff0254=Math[_0xd35e6d(0xb15)]((_0x1cf9e1-_0x24e11a[_0xd35e6d(0x50e)]/0x2)/_0x24e11a[_0xd35e6d(0x50e)]);_0x4d13d0(_0x36568d);if(_0x27cdff>=0x0&&_0x27cdff<_0x24e11a[_0xd35e6d(0x9ed)]&&_0xff0254>=0x0&&_0xff0254<_0x24e11a[_0xd35e6d(0x9ed)]&&_0x24e11a[_0xd35e6d(0x9e4)][_0xff0254][_0x27cdff]===0x0){const _0x5f2a1d=_0x24e11a[_0xd35e6d(0x50e)]/0x2-0x2;_0x29c4f2[_0xd35e6d(0x5fd)](),_0x29c4f2['arc'](_0x24e11a['CELL_SIZE']/0x2+_0x27cdff*_0x24e11a[_0xd35e6d(0x50e)],_0x24e11a[_0xd35e6d(0x50e)]/0x2+_0xff0254*_0x24e11a[_0xd35e6d(0x50e)],_0x5f2a1d,0x0,0x2*Math['PI']),_0x29c4f2[_0xd35e6d(0xee1)]=_0xd35e6d(0x163),_0x29c4f2[_0xd35e6d(0x134a)]();}}function _0x2cc8c6(_0x4849ee){const _0x2e6752=_0x5a7792,_0x17232f=_0x3e7a1b[_0x2e6752(0x777)],_0x15e2db=_0x4dc8ec[_0x17232f];if(!_0x15e2db||_0x15e2db[_0x2e6752(0xe0e)]||_0x15e2db['currentPlayer']!==0x1)return;const _0x45a3a8=document[_0x2e6752(0x64f)](_0x2e6752(0x8f9)),_0x205aca=_0x45a3a8['getBoundingClientRect'](),_0x33c187=_0x4849ee[_0x2e6752(0x663)]-_0x205aca['left'],_0x20e9c2=_0x4849ee[_0x2e6752(0xdcc)]-_0x205aca['top'],_0x1cfe19=Math[_0x2e6752(0xb15)]((_0x33c187-_0x15e2db[_0x2e6752(0x50e)]/0x2)/_0x15e2db[_0x2e6752(0x50e)]),_0x3922ef=Math[_0x2e6752(0xb15)]((_0x20e9c2-_0x15e2db[_0x2e6752(0x50e)]/0x2)/_0x15e2db['CELL_SIZE']);_0x1cfe19>=0x0&&_0x1cfe19<_0x15e2db[_0x2e6752(0x9ed)]&&_0x3922ef>=0x0&&_0x3922ef<_0x15e2db[_0x2e6752(0x9ed)]&&_0x15e2db[_0x2e6752(0x9e4)][_0x3922ef][_0x1cfe19]===0x0&&(_0x15e2db[_0x2e6752(0x9e4)][_0x3922ef][_0x1cfe19]=0x1,_0x15e2db[_0x2e6752(0x830)][_0x2e6752(0x13ee)]({'x':_0x1cfe19,'y':_0x3922ef,'player':0x1}),_0x4d13d0(_0x17232f),_0x59ca57(_0x1cfe19,_0x3922ef,0x1,_0x15e2db)?(_0x15e2db['isGameOver']=!![],setTimeout(()=>alert('恭喜你，你赢了！'),0x64),_0x59f1af(_0x2e6752(0xa4d))):_0x15e2db[_0x2e6752(0x1322)]=0x2);}function _0x5a14d4(_0x279e5f,_0x459107=![]){const _0x5a6066=_0x5a7792,_0x575c71=_0x3e7a1b[_0x5a6066(0x777)],_0x1df162=_0x4dc8ec[_0x575c71];if(!_0x1df162||_0x1df162[_0x5a6066(0xe0e)])return;if(!_0x459107&&_0x1df162['currentPlayer']!==0x2)return;const {x:_0x4ddf37,y:_0x57cf25}=_0x279e5f;_0x4ddf37>=0x0&&_0x4ddf37<_0x1df162[_0x5a6066(0x9ed)]&&_0x57cf25>=0x0&&_0x57cf25<_0x1df162['GRID_SIZE']&&_0x1df162[_0x5a6066(0x9e4)][_0x57cf25][_0x4ddf37]===0x0?(_0x1df162[_0x5a6066(0x9e4)][_0x57cf25][_0x4ddf37]=0x2,_0x1df162['history'][_0x5a6066(0x13ee)]({'x':_0x4ddf37,'y':_0x57cf25,'player':0x2}),_0x4d13d0(_0x575c71),_0x59ca57(_0x4ddf37,_0x57cf25,0x2,_0x1df162)?(_0x1df162['isGameOver']=!![],setTimeout(()=>alert(_0x5a6066(0x11f0)),0x64),_0x59f1af('ai')):_0x1df162[_0x5a6066(0x1322)]=0x1):(console['warn']('AI\x20的下棋指令无效或位置已被占据:',_0x279e5f),_0x1df162[_0x5a6066(0x1322)]=0x1);}function _0x59ca57(_0x321076,_0x5b1630,_0x441765,_0x2b9526){const {board:_0x4ad1cb,GRID_SIZE:_0x342259}=_0x2b9526,_0x2e1e02=[[0x1,0x0],[0x0,0x1],[0x1,0x1],[0x1,-0x1]];for(const [_0x3e0715,_0x7356c0]of _0x2e1e02){let _0x325447=0x1;for(let _0x44d917=0x1;_0x44d917<0x5;_0x44d917++){const _0x108320=_0x321076+_0x44d917*_0x3e0715,_0x2ac95d=_0x5b1630+_0x44d917*_0x7356c0;if(_0x108320>=0x0&&_0x108320<_0x342259&&_0x2ac95d>=0x0&&_0x2ac95d<_0x342259&&_0x4ad1cb[_0x2ac95d][_0x108320]===_0x441765)_0x325447++;else break;}for(let _0x34affb=0x1;_0x34affb<0x5;_0x34affb++){const _0x5115d7=_0x321076-_0x34affb*_0x3e0715,_0x579784=_0x5b1630-_0x34affb*_0x7356c0;if(_0x5115d7>=0x0&&_0x5115d7<_0x342259&&_0x579784>=0x0&&_0x579784<_0x342259&&_0x4ad1cb[_0x579784][_0x5115d7]===_0x441765)_0x325447++;else break;}if(_0x325447>=0x5)return!![];}return![];}function _0xec60af(_0x502106){const _0x56e296=_0x5a7792;if(!_0x502106||!_0x502106[_0x56e296(0xb30)])return'';let _0x28b195=_0x56e296(0x90a);_0x28b195+=_0x502106[_0x56e296(0x9e4)]['map'](_0x2ca586=>_0x2ca586[_0x56e296(0xd22)]('\x20'))[_0x56e296(0xd22)]('\x0a');let _0x56c5f9=_0x56e296(0x778);return _0x56c5f9+=_0x502106['history'][_0x56e296(0xb96)](_0x15d653=>'玩家'+_0x15d653[_0x56e296(0xbb4)]+_0x56e296(0x102)+_0x15d653['x']+','+_0x15d653['y']+')')[_0x56e296(0xd22)]('\x20->\x20'),'\x0a#\x20当前五子棋局势\x0a'+_0x28b195+_0x56e296(0xb93)+_0x56c5f9+'\x0a\x0a#\x20【【【五子棋核心规则与强制思考步骤\x20(最高优先级指令！)】】】\x0a\x0a###\x20**【【【落子铁律\x20(绝对禁止！)】】】**\x0a你【绝对不能】选择一个棋盘上已经是\x201\x20或\x202\x20的坐标。你的落子点【必须】是\x200。\x0a---\x0a\x0a###\x20**第一步：逻辑分析\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【规则定义】**:\x20\x0a\x20\x20\x20\x20-\x20\x20\x20棋子:\x201代表用户(黑棋)，2代表你(白棋)。\x0a\x20\x20\x20\x20-\x20\x20\x20获胜条件:\x20横、竖、斜线上有【连续五个】自己的棋子。\x0a\x0a2.\x20\x20**【防守分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“四子连线”的威胁？**\x20如果有，我必须下在哪个坐标才能堵住？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查用户(1)是否有“活三”的威胁？**\x20如果有，最佳的防守点是哪里？\x0a\x0a3.\x20\x20**【进攻分析\x20(必须执行)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有“一步胜利”的机会？**\x20(即已有四子连线)\x20如果有，我应该下在哪里？\x0a\x20\x20\x20\x20-\x20\x20\x20**检查我(2)是否有制造“活四”或“双三”的机会？**\x20如果有，最佳的进攻点是哪里？\x0a\x0a###\x20**第二步：决策与扮演\x20(内部思考，不要输出)**\x0a\x0a1.\x20\x20**【决策】**:\x20综合以上攻防分析，我的最佳棋步是落在坐标\x20(x,\x20y)。\x0a\x0a2.\x20\x20**【融入角色扮演】**:\x0a\x20\x20\x20\x20-\x20\x20\x20我的性格是：(在此处回顾你的人设)。\x0a\x20\x20\x20\x20-\x20\x20\x20根据我的性格，我应该：\x0a\x20\x20\x20\x20\x20\x20\x20\x20a)\x20**(聪明/好胜型)**\x20下在刚刚分析出的最佳位置。\x0a\x20\x20\x20\x20\x20\x20\x20\x20b)\x20**(迷糊/放水型)**\x20故意选择一个次优的位置，但【前提是不能让用户立刻获胜】。\x0a\x20\x20\x20\x20\x20\x20\x20\x20c)\x20**(其他性格)**\x20根据性格特点，选择一个合理的棋步。\x0a\x0a3.\x20\x20**【构思台词】**:\x20根据我选择的棋步和我的性格，我应该说一句什么样的台词来评论棋局？\x0a\x0a---\x0a###\x20**第三步：生成最终回复\x20(你的唯一输出)**\x0a\x0a现在，根据你第二步的最终决策，生成你的行动。\x0a-\x20\x20\x20你的回复【必须且只能】是一个JSON数组。\x0a-\x20\x20\x20**绝对不要**在最终回复中包含任何上述的思考过程。\x0a-\x20\x20\x20格式:\x20`[{\x22type\x22:\x20\x22gomoku_move\x22,\x20\x22name\x22:\x20\x22你的角色本名\x22,\x20\x22x\x22:\x20(0-14),\x20\x22y\x22:\x20(0-14)},\x20{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你的台词...\x22}]`\x0a';}async function _0x59f1af(_0x2b363f){const _0xf40a48=_0x5a7792,_0x45cb06=_0x3e7a1b[_0xf40a48(0x777)],_0x21fb04=_0x3e7a1b[_0xf40a48(0x999)][_0x45cb06];if(!_0x21fb04)return;const _0xef302d=_0x21fb04[_0xf40a48(0x1167)]?_0x21fb04[_0xf40a48(0xcb3)][_0xf40a48(0x96f)]||'我':'我',_0x457370=_0x21fb04[_0xf40a48(0x1167)]?_0xf40a48(0x110a):_0x21fb04[_0xf40a48(0x6fc)],_0x12f8ac=_0x2b363f===_0xf40a48(0xa4d)?_0xef302d:_0x457370,_0x2a2495=_0x2b363f===_0xf40a48(0xa4d)?_0xf40a48(0xfc7):_0xf40a48(0xda8),_0x46120c=_0xf40a48(0x282)+_0x12f8ac+'\x20获胜。也就是说，'+_0x2a2495+'。]',_0x88e16={'role':'system','content':_0x46120c,'timestamp':Date[_0xf40a48(0x2b5)](),'isHidden':!![]};_0x21fb04[_0xf40a48(0x830)][_0xf40a48(0x13ee)](_0x88e16),await _0x4e1bbf[_0xf40a48(0x999)][_0xf40a48(0x4fa)](_0x21fb04),console['log'](_0xf40a48(0x3ee)+_0x2b363f);}let _0x369182=![];async function _0x515ef1(){const _0x55493e=_0x5a7792,_0x5d83dd=document['getElementById'](_0x55493e(0x3c0)),_0x2073a9=document[_0x55493e(0x64f)](_0x55493e(0xfdc)),_0xa63f86=document[_0x55493e(0x64f)]('shopping-screen');_0x5d83dd['innerHTML']='',_0x2073a9[_0x55493e(0xc58)]='';const [_0x13d529,_0x5ac9b1]=await Promise[_0x55493e(0xfd7)]([_0x4e1bbf[_0x55493e(0x760)][_0x55493e(0x78f)](),_0x4e1bbf['shoppingCategories'][_0x55493e(0xe1d)](_0x55493e(0x6fc))[_0x55493e(0x78f)]()]);_0xa63f86['classList'][_0x55493e(0x5cf)](_0x55493e(0xeea),_0x369182);const _0x27a9e2=document['createElement'](_0x55493e(0xcd));_0x27a9e2[_0x55493e(0x87d)]=_0x55493e(0xc84),_0x27a9e2[_0x55493e(0xee5)]='全部',_0x27a9e2[_0x55493e(0x12e1)][_0x55493e(0xcd3)]=_0x55493e(0xfd7);if(activeShoppingCategoryId===_0x55493e(0xfd7))_0x27a9e2[_0x55493e(0x418)]['add']('active');_0x2073a9[_0x55493e(0x99e)](_0x27a9e2),_0x5ac9b1['forEach'](_0x16b953=>{const _0x3a7409=_0x55493e,_0x1d6cad=document['createElement'](_0x3a7409(0xcd));_0x1d6cad[_0x3a7409(0x87d)]=_0x3a7409(0xc84),_0x1d6cad[_0x3a7409(0xee5)]=_0x16b953[_0x3a7409(0x6fc)],_0x1d6cad[_0x3a7409(0x12e1)][_0x3a7409(0xcd3)]=_0x16b953['id'];if(activeShoppingCategoryId===_0x16b953['id'])_0x1d6cad[_0x3a7409(0x418)][_0x3a7409(0xdda)](_0x3a7409(0x12ef));_0x2073a9['appendChild'](_0x1d6cad);});let _0x29a111;activeShoppingCategoryId==='all'?_0x29a111=_0x13d529:_0x29a111=_0x13d529[_0x55493e(0x156)](_0x2bf1a4=>_0x2bf1a4[_0x55493e(0xcd3)]===activeShoppingCategoryId);if(_0x29a111[_0x55493e(0x40f)]===0x0){const _0x3e0d62=activeShoppingCategoryId===_0x55493e(0xfd7)?_0x55493e(0xc59):_0x55493e(0xb8);_0x5d83dd[_0x55493e(0xc58)]=_0x55493e(0xa24)+_0x3e0d62+_0x55493e(0x12de);return;}_0x29a111[_0x55493e(0x103)](_0x32f31d=>{const _0x4c0757=_0x55493e,_0x4bbc5f=document[_0x4c0757(0x124e)]('div');_0x4bbc5f[_0x4c0757(0x87d)]='product-item',_0x4bbc5f[_0x4c0757(0x12e1)]['id']=_0x32f31d['id'];const _0x239fe6='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22product-management-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22edit-product-btn\x22>编辑</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22delete-product-btn\x22>删除</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20';_0x4bbc5f['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+_0x239fe6+_0x4c0757(0x531)+_0x32f31d[_0x4c0757(0xd07)]+_0x4c0757(0x10e)+_0x32f31d[_0x4c0757(0x6fc)]+_0x4c0757(0x71e)+_0x32f31d[_0x4c0757(0xd5b)][_0x4c0757(0xc89)](0x2)+_0x4c0757(0x88),_0x5d83dd[_0x4c0757(0x99e)](_0x4bbc5f);});}function _0x31800a(_0x4c445d){activeShoppingCategoryId=_0x4c445d,_0x515ef1(),_0x5201ec();}function _0x5201ec(){const _0x214e06=_0x5a7792,_0x379f2a=document[_0x214e06(0x64f)](_0x214e06(0xe8d));if(!_0x379f2a)return;const _0x1840c4=_0x369182&&activeShoppingCategoryId!==_0x214e06(0xfd7);_0x379f2a[_0x214e06(0x731)][_0x214e06(0x130)]=_0x1840c4?_0x214e06(0x1026):'none';}async function _0x36fea9(){const _0x5d272c=_0x5a7792;if(activeShoppingCategoryId===_0x5d272c(0xfd7))return;const _0x45c095=activeShoppingCategoryId,_0xa787b9=await _0x4e1bbf[_0x5d272c(0x135)][_0x5d272c(0x11fc)](_0x45c095);if(!_0xa787b9){alert('错误：找不到要删除的分类。');return;}const _0x65b500=_0x5d272c(0xf34)+_0xa787b9['name']+'”\x20吗？\x0a\x0a此操作【不会】删除分类下的商品，它们将被移至“未分类”。',_0x503383=await _0x54149f(_0x5d272c(0x32d),_0x65b500,{'confirmButtonClass':'btn-danger','confirmText':_0x5d272c(0x13d2)});_0x503383&&(await _0x5d28ff(_0x45c095),activeShoppingCategoryId=_0x5d272c(0xfd7),await _0x515ef1(),_0x5201ec(),await _0x28974b('成功',_0x5d272c(0x12bf)+_0xa787b9[_0x5d272c(0x6fc)]+_0x5d272c(0x1050)));}async function _0x3ebb10(){const _0x4f774e=_0x5a7792;activeShoppingCategoryId=_0x4f774e(0xfd7),await _0x515ef1(),_0xddd8ae('shopping-screen'),_0x5201ec();}async function _0x515ef1(){const _0x4980a7=_0x5a7792,_0x227a4f=document['getElementById'](_0x4980a7(0x3c0)),_0x84f584=document['getElementById']('product-category-tabs'),_0x3cff38=document[_0x4980a7(0x64f)](_0x4980a7(0xd49));_0x227a4f['innerHTML']='',_0x84f584[_0x4980a7(0xc58)]='';const [_0x428e00,_0x48bece]=await Promise[_0x4980a7(0xfd7)]([_0x4e1bbf[_0x4980a7(0x760)][_0x4980a7(0x78f)](),_0x4e1bbf[_0x4980a7(0x135)][_0x4980a7(0xe1d)](_0x4980a7(0x6fc))[_0x4980a7(0x78f)]()]);_0x3cff38[_0x4980a7(0x418)][_0x4980a7(0x5cf)](_0x4980a7(0xeea),_0x369182);const _0x4a6127=document[_0x4980a7(0x124e)]('button');_0x4a6127[_0x4980a7(0x87d)]=_0x4980a7(0xc84),_0x4a6127[_0x4980a7(0xee5)]='全部',_0x4a6127[_0x4980a7(0x12e1)][_0x4980a7(0xcd3)]='all';if(activeShoppingCategoryId==='all')_0x4a6127[_0x4980a7(0x418)]['add'](_0x4980a7(0x12ef));_0x84f584['appendChild'](_0x4a6127),_0x48bece['forEach'](_0x41427c=>{const _0x399e80=_0x4980a7,_0x17420f=document[_0x399e80(0x124e)](_0x399e80(0xcd));_0x17420f[_0x399e80(0x87d)]=_0x399e80(0xc84),_0x17420f[_0x399e80(0xee5)]=_0x41427c[_0x399e80(0x6fc)],_0x17420f[_0x399e80(0x12e1)][_0x399e80(0xcd3)]=_0x41427c['id'];if(activeShoppingCategoryId===_0x41427c['id'])_0x17420f[_0x399e80(0x418)][_0x399e80(0xdda)]('active');_0x84f584[_0x399e80(0x99e)](_0x17420f);});let _0x4a9b47;activeShoppingCategoryId===_0x4980a7(0xfd7)?_0x4a9b47=_0x428e00:_0x4a9b47=_0x428e00['filter'](_0x199be0=>_0x199be0[_0x4980a7(0xcd3)]===activeShoppingCategoryId);if(_0x4a9b47[_0x4980a7(0x40f)]===0x0){const _0x2d2978=activeShoppingCategoryId==='all'?_0x4980a7(0xc59):_0x4980a7(0xb8);_0x227a4f[_0x4980a7(0xc58)]=_0x4980a7(0xa24)+_0x2d2978+'</p>';return;}_0x4a9b47[_0x4980a7(0x103)](_0x1f0a5d=>{const _0x9000bf=_0x4980a7,_0x458855=document[_0x9000bf(0x124e)]('div');_0x458855['className']=_0x9000bf(0x12f),_0x458855[_0x9000bf(0x12e1)]['id']=_0x1f0a5d['id'];const _0x351316=_0x369182?_0x9000bf(0x827):'';_0x458855['innerHTML']=_0x9000bf(0x781)+_0x351316+_0x9000bf(0xa8d)+_0x1f0a5d[_0x9000bf(0xd07)]+_0x9000bf(0x10e7)+_0x1f0a5d[_0x9000bf(0x6fc)]+_0x9000bf(0x114c)+_0x1f0a5d[_0x9000bf(0xd5b)][_0x9000bf(0xc89)](0x2)+_0x9000bf(0x301),_0x227a4f['appendChild'](_0x458855);});}async function _0x2e14cf(_0xe15cd,_0x10de92=0x1,_0x251876=null){const _0x515e04=_0x5a7792,_0x3438af=_0x251876?_0x1ac43d[_0x515e04(0x137)](_0x149aef=>_0x149aef[_0x515e04(0xa51)]===_0xe15cd&&_0x149aef[_0x515e04(0x31a)]?.[_0x515e04(0x6fc)]===_0x251876['name']):_0x1ac43d[_0x515e04(0x137)](_0x337a16=>_0x337a16[_0x515e04(0xa51)]===_0xe15cd&&!_0x337a16[_0x515e04(0x31a)]);if(_0x3438af)_0x3438af[_0x515e04(0x416)]+=_0x10de92;else{const _0x264538=await _0x4e1bbf[_0x515e04(0x760)][_0x515e04(0x11fc)](_0xe15cd);_0x264538&&_0x1ac43d[_0x515e04(0x13ee)]({'productId':_0x264538['id'],'quantity':_0x10de92,'variation':_0x251876});}_0x2b0736();}function _0x833f93(_0x13a4d2,_0x32f1e2){const _0x42f1ac=_0x5a7792,_0x36ff01=_0x1ac43d[_0x42f1ac(0x6a2)](_0x2b74d5=>_0x2b74d5['productId']===_0x13a4d2);_0x36ff01>-0x1&&(_0x1ac43d[_0x36ff01][_0x42f1ac(0x416)]+=_0x32f1e2,_0x1ac43d[_0x36ff01]['quantity']<=0x0&&_0x1ac43d[_0x42f1ac(0x10f9)](_0x36ff01,0x1),_0x2b0736(),_0x3e2fbb());}function _0x2b0736(){const _0x22135a=_0x5a7792,_0x92a7c5=_0x1ac43d[_0x22135a(0x213)]((_0x201779,_0x5b75ce)=>_0x201779+_0x5b75ce[_0x22135a(0x416)],0x0);document[_0x22135a(0x64f)](_0x22135a(0x10cb))[_0x22135a(0xee5)]=_0x92a7c5,document['getElementById'](_0x22135a(0xb0))[_0x22135a(0xee5)]='购物车('+_0x92a7c5+')',document[_0x22135a(0x64f)](_0x22135a(0xafb))['textContent']=_0x22135a(0x6d9)+_0x92a7c5+')';}function _0x3815ca(){const _0x3569a8=_0x5a7792;_0x3e2fbb(),_0xddd8ae(_0x3569a8(0x1160));}async function _0x3e2fbb(){const _0xb614f2=_0x5a7792,_0x334ecd=document[_0xb614f2(0x64f)](_0xb614f2(0x88b));_0x334ecd[_0xb614f2(0xc58)]='';let _0x4e0643=0x0;if(_0x1ac43d[_0xb614f2(0x40f)]===0x0)_0x334ecd[_0xb614f2(0xc58)]=_0xb614f2(0x3f3);else{const _0xcca046=_0x1ac43d[_0xb614f2(0xb96)](_0x5747ec=>_0x5747ec[_0xb614f2(0xa51)]),_0x5cf8bb=await _0x4e1bbf[_0xb614f2(0x760)][_0xb614f2(0xec9)]('id')[_0xb614f2(0x4a0)](_0xcca046)[_0xb614f2(0x78f)](),_0x11e675=new Map(_0x5cf8bb[_0xb614f2(0xb96)](_0x292f79=>[_0x292f79['id'],_0x292f79]));_0x1ac43d[_0xb614f2(0x103)](_0x4193ce=>{const _0x4c12fa=_0xb614f2,_0x3e9842=_0x11e675[_0x4c12fa(0x11fc)](_0x4193ce['productId']);if(_0x3e9842){const _0x321772=document[_0x4c12fa(0x124e)](_0x4c12fa(0x479));_0x321772[_0x4c12fa(0x87d)]='cart-item';const _0x5d649c=_0x4193ce[_0x4c12fa(0x31a)]?'<div\x20class=\x22cart-item-variation\x22\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin-top:\x204px;\x22>款式:\x20'+_0x4193ce['variation'][_0x4c12fa(0x6fc)]+_0x4c12fa(0x4b1):'';_0x321772[_0x4c12fa(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22cart-item-checkbox\x22\x20data-id=\x22'+_0x3e9842['id']+_0x4c12fa(0x10b6)+(_0x4193ce[_0x4c12fa(0x31a)]?.[_0x4c12fa(0xd07)]||_0x3e9842['imageUrl'])+_0x4c12fa(0xd85)+_0x3e9842['name']+_0x4c12fa(0x7c6)+_0x5d649c+_0x4c12fa(0x1226)+(_0x4193ce[_0x4c12fa(0x31a)]?.[_0x4c12fa(0xd5b)]||_0x3e9842['price'])[_0x4c12fa(0xc89)](0x2)+_0x4c12fa(0xf39)+_0x3e9842['id']+_0x4c12fa(0xbd5)+_0x4193ce[_0x4c12fa(0x416)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22quantity-btn\x20increase-qty-btn\x22\x20data-id=\x22'+_0x3e9842['id']+_0x4c12fa(0xf2c),_0x334ecd[_0x4c12fa(0x99e)](_0x321772);}});}_0x45393a();}async function _0x45393a(){const _0x17e7ce=_0x5a7792;let _0x49316a=0x0;const _0x196b2e=document[_0x17e7ce(0x233)](_0x17e7ce(0x845)),_0x14eaa1=Array[_0x17e7ce(0xb3a)](_0x196b2e)[_0x17e7ce(0xb96)](_0x1b836b=>parseInt(_0x1b836b[_0x17e7ce(0x12e1)]['id']));if(_0x14eaa1[_0x17e7ce(0x40f)]>0x0){const _0x5c39ae=await _0x4e1bbf[_0x17e7ce(0x760)][_0x17e7ce(0xec9)]('id')[_0x17e7ce(0x4a0)](_0x14eaa1)['toArray'](),_0x311850=new Map(_0x5c39ae[_0x17e7ce(0xb96)](_0x56ab17=>[_0x56ab17['id'],_0x56ab17]));_0x1ac43d[_0x17e7ce(0x103)](_0x2308ba=>{const _0x1c0c6b=_0x17e7ce;if(_0x14eaa1['includes'](_0x2308ba[_0x1c0c6b(0xa51)])){const _0x383811=_0x311850[_0x1c0c6b(0x11fc)](_0x2308ba['productId']);if(_0x383811){const _0x58e1ab=_0x2308ba[_0x1c0c6b(0x31a)]?_0x2308ba[_0x1c0c6b(0x31a)]['price']:_0x383811[_0x1c0c6b(0xd5b)];_0x49316a+=_0x58e1ab*_0x2308ba['quantity'];}}});}document[_0x17e7ce(0x64f)]('cart-total')[_0x17e7ce(0xee5)]=_0x17e7ce(0xbea)+_0x49316a['toFixed'](0x2);}async function _0x403682(){const _0x1363b3=_0x5a7792,_0x5b3506=_0x3e7a1b[_0x1363b3(0x999)][_0x3e7a1b[_0x1363b3(0x777)]];if(!_0x5b3506||!_0x5b3506[_0x1363b3(0x1167)])return;const _0x23c93a=document[_0x1363b3(0x64f)](_0x1363b3(0x10a8)),_0x38cacb=document[_0x1363b3(0x64f)](_0x1363b3(0x39f));_0x38cacb[_0x1363b3(0xc58)]='';const _0x34a5ab=_0x5b3506[_0x1363b3(0xcb3)][_0x1363b3(0x96f)]||'我',_0x563196=_0x5b3506[_0x1363b3(0x5d4)]['filter'](_0x11c773=>_0x11c773[_0x1363b3(0x287)]!==_0x34a5ab);_0x563196[_0x1363b3(0x103)](_0x2a7328=>{const _0x521162=_0x1363b3,_0x5787cb=document[_0x521162(0x124e)](_0x521162(0x479));_0x5787cb[_0x521162(0x87d)]=_0x521162(0x6e3),_0x5787cb[_0x521162(0x12e1)]['recipientName']=_0x2a7328[_0x521162(0x7de)],_0x5787cb[_0x521162(0xc58)]=_0x521162(0xf26)+(_0x2a7328[_0x521162(0x1265)]||_0x480024)+_0x521162(0xcb2)+_0x2a7328[_0x521162(0x287)]+_0x521162(0xd25),_0x38cacb['appendChild'](_0x5787cb);}),document[_0x1363b3(0x64f)](_0x1363b3(0x330))[_0x1363b3(0xf1d)]=![],_0x23c93a['classList'][_0x1363b3(0xdda)](_0x1363b3(0x40a));}async function _0xb6e78(){const _0x300b3e=_0x5a7792,_0x4e32e0=_0x3e7a1b[_0x300b3e(0x999)][_0x3e7a1b[_0x300b3e(0x777)]],_0x325d8f=_0x1ac43d['filter'](_0x5d6e66=>document[_0x300b3e(0x49c)](_0x300b3e(0x7d7)+_0x5d6e66[_0x300b3e(0xa51)]+_0x300b3e(0x24f)));if(_0x325d8f['length']===0x0){alert(_0x300b3e(0x8a8));return;}if(_0x4e32e0[_0x300b3e(0x1167)])_0x403682();else{const _0x323ef6=await _0x54149f(_0x300b3e(0x4f4),_0x300b3e(0xf81),{'confirmText':_0x300b3e(0x10e3)});_0x323ef6&&await _0x38d949(_0x325d8f);}}async function _0x38d949(_0x1b16ec,_0x8462fd=null){const _0x578b06=_0x5a7792;if(!_0x3e7a1b[_0x578b06(0x777)])return;const _0x5e35df=_0x3e7a1b[_0x578b06(0x999)][_0x3e7a1b[_0x578b06(0x777)]],_0x5f3c05=_0x1b16ec[_0x578b06(0xb96)](_0x573eec=>_0x573eec[_0x578b06(0xa51)]),_0x2ea20a=await _0x4e1bbf['shoppingProducts'][_0x578b06(0xec9)]('id')[_0x578b06(0x4a0)](_0x5f3c05)['toArray'](),_0x3d533f=new Map(_0x2ea20a[_0x578b06(0xb96)](_0x5b91de=>[_0x5b91de['id'],_0x5b91de])),_0x415d93=_0x1b16ec[_0x578b06(0xb96)](_0x4279b1=>{const _0x37d1d3=_0x578b06,_0x6204a0=_0x3d533f[_0x37d1d3(0x11fc)](_0x4279b1[_0x37d1d3(0xa51)]);return _0x4279b1['variation']?{'name':_0x6204a0['name']+_0x37d1d3(0xc78)+_0x4279b1[_0x37d1d3(0x31a)]['name'],'price':_0x4279b1[_0x37d1d3(0x31a)][_0x37d1d3(0xd5b)],'imageUrl':_0x4279b1[_0x37d1d3(0x31a)][_0x37d1d3(0xd07)]||_0x6204a0[_0x37d1d3(0xd07)],'quantity':_0x4279b1[_0x37d1d3(0x416)]}:{'name':_0x6204a0[_0x37d1d3(0x6fc)],'price':_0x6204a0[_0x37d1d3(0xd5b)],'imageUrl':_0x6204a0[_0x37d1d3(0xd07)],'quantity':_0x4279b1[_0x37d1d3(0x416)]};}),_0x137dfe={'role':_0x578b06(0xa4d),'type':_0x578b06(0x11f7),'timestamp':Date[_0x578b06(0x2b5)](),'items':_0x415d93,'total':_0x415d93['reduce']((_0x325bbe,_0x58810f)=>_0x325bbe+_0x58810f['price']*_0x58810f[_0x578b06(0x416)],0x0),'recipients':_0x8462fd};_0x5e35df[_0x578b06(0x830)]['push'](_0x137dfe);if(_0x8462fd&&_0x8462fd[_0x578b06(0x40f)]>0x0){const _0x326779=_0x8462fd[_0x578b06(0xb96)](_0x4f98f6=>_0x1409fb(_0x5e35df,_0x4f98f6))[_0x578b06(0xd22)]('、'),_0x58beab={'role':_0x578b06(0x905),'content':'[系统提示：用户\x20('+(_0x5e35df[_0x578b06(0xcb3)][_0x578b06(0x96f)]||'我')+_0x578b06(0x703)+_0x326779+_0x578b06(0x375),'timestamp':Date[_0x578b06(0x2b5)]()+0x1,'isHidden':!![]};_0x5e35df[_0x578b06(0x830)]['push'](_0x58beab);}await _0x4e1bbf['chats']['put'](_0x5e35df),_0x3c7e84(_0x137dfe,_0x5e35df),_0x21f6ea(),_0x1ac43d=_0x1ac43d['filter'](_0xb4f19a=>!_0x1b16ec[_0x578b06(0x26c)](_0x10ad2b=>_0x10ad2b['productId']===_0xb4f19a[_0x578b06(0xa51)])),_0x2b0736(),_0xddd8ae('chat-interface-screen'),await _0x28974b('成功',_0x578b06(0xe2b));}function _0x5c9470(_0x58e8fe){const _0x239789=_0x5a7792,_0x40e1ff=_0x3e7a1b['chats'][_0x3e7a1b[_0x239789(0x777)]],_0x3a7529=_0x40e1ff['history'][_0x239789(0x137)](_0x37fa4c=>_0x37fa4c[_0x239789(0x8af)]===_0x58e8fe);if(!_0x3a7529||_0x3a7529[_0x239789(0xafc)]!==_0x239789(0x11f7))return;const _0x1621e4=document[_0x239789(0x64f)](_0x239789(0x363));let _0x3a0b47='';_0x3a7529[_0x239789(0xd8c)]['forEach'](_0x43f0cf=>{const _0x4cf794=_0x239789;_0x3a0b47+='<tr><td\x20class=\x22item-name\x22>'+_0x43f0cf[_0x4cf794(0x6fc)]+_0x4cf794(0x1151)+_0x43f0cf[_0x4cf794(0x416)]+'</td><td\x20class=\x22item-price\x22>¥'+_0x43f0cf[_0x4cf794(0xd5b)]['toFixed'](0x2)+_0x4cf794(0x84a)+(_0x43f0cf[_0x4cf794(0xd5b)]*_0x43f0cf[_0x4cf794(0x416)])['toFixed'](0x2)+_0x4cf794(0x895);}),_0x1621e4[_0x239789(0xc58)]=_0x239789(0x133c)+new Date(_0x3a7529[_0x239789(0x8af)])[_0x239789(0x2b4)]()+_0x239789(0xb69)+_0x3a0b47+_0x239789(0x28b)+_0x3a7529[_0x239789(0x1306)][_0x239789(0xc89)](0x2)+_0x239789(0xdf0),document[_0x239789(0x64f)](_0x239789(0x431))[_0x239789(0x418)][_0x239789(0xdda)]('visible');}async function _0x309cfe(_0x52e080=null){const _0x1ae0f4=_0x5a7792;_0x500637=_0x52e080;const _0x4f5e1c=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0x94c)),_0x39ddb9=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0x28d)),_0x3364ec=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0x833)),_0x42bcdb=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0xa37)),_0x561fcc=document['getElementById'](_0x1ae0f4(0x1079)),_0x36cf64=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0x7b6)),_0x4149f3=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0x12cf)),_0x277c22=document[_0x1ae0f4(0x64f)](_0x1ae0f4(0xe15));_0x277c22['innerHTML']='',_0x4149f3[_0x1ae0f4(0xc58)]=_0x1ae0f4(0xab5);const _0x160758=await _0x4e1bbf[_0x1ae0f4(0x135)][_0x1ae0f4(0x78f)]();_0x160758[_0x1ae0f4(0x103)](_0xe708d7=>{const _0x48d28c=_0x1ae0f4,_0x3e58e9=document[_0x48d28c(0x124e)]('option');_0x3e58e9['value']=_0xe708d7['id'],_0x3e58e9['textContent']=_0xe708d7[_0x48d28c(0x6fc)],_0x4149f3[_0x48d28c(0x99e)](_0x3e58e9);});if(_0x52e080){_0x39ddb9[_0x1ae0f4(0xee5)]=_0x1ae0f4(0x94f);const _0xe2fa39=await _0x4e1bbf[_0x1ae0f4(0x760)][_0x1ae0f4(0x11fc)](_0x52e080);_0x3364ec[_0x1ae0f4(0xbed)]=_0xe2fa39[_0x1ae0f4(0x6fc)],_0x42bcdb[_0x1ae0f4(0xbed)]=_0xe2fa39['price'],_0x561fcc['value']=_0xe2fa39[_0x1ae0f4(0x9af)]||'',_0x36cf64[_0x1ae0f4(0xbe8)]=_0xe2fa39[_0x1ae0f4(0xd07)],_0x4149f3[_0x1ae0f4(0xbed)]=_0xe2fa39[_0x1ae0f4(0xcd3)]||'',_0xe2fa39[_0x1ae0f4(0x349)]&&_0xe2fa39[_0x1ae0f4(0x349)]['length']>0x0&&_0xe2fa39[_0x1ae0f4(0x349)]['forEach'](_0x3235b5=>_0x2a1e5c(_0x3235b5));}else _0x39ddb9[_0x1ae0f4(0xee5)]=_0x1ae0f4(0x8b2),_0x3364ec['value']='',_0x42bcdb[_0x1ae0f4(0xbed)]='',_0x561fcc[_0x1ae0f4(0xbed)]='',_0x36cf64[_0x1ae0f4(0xbe8)]=_0x1ae0f4(0x7f9),_0x4149f3[_0x1ae0f4(0xbed)]='';_0x4f5e1c[_0x1ae0f4(0x418)]['add']('visible');}async function _0x3f95c0(){const _0x4e5454=_0x5a7792,_0x2a719c=document['getElementById'](_0x4e5454(0x833))[_0x4e5454(0xbed)][_0x4e5454(0x43a)](),_0x5d3d8a=parseFloat(document[_0x4e5454(0x64f)](_0x4e5454(0xa37))[_0x4e5454(0xbed)]),_0x424487=document[_0x4e5454(0x64f)](_0x4e5454(0x1079))[_0x4e5454(0xbed)][_0x4e5454(0x43a)](),_0x2f5e4b=document['getElementById']('product-image-preview')[_0x4e5454(0xbe8)],_0x48421e=parseInt(document[_0x4e5454(0x64f)](_0x4e5454(0x12cf))['value'])||null;if(!_0x2a719c){alert('商品名称不能为空！');return;}if(isNaN(_0x5d3d8a)||_0x5d3d8a<0x0){alert(_0x4e5454(0x11b));return;}const _0x7d816=[];document[_0x4e5454(0x233)](_0x4e5454(0xf21))[_0x4e5454(0x103)](_0x59f73a=>{const _0x64cb4a=_0x4e5454,_0x5daf06=_0x59f73a[_0x64cb4a(0x49c)](_0x64cb4a(0x13a7))['value']['trim'](),_0x13b158=parseFloat(_0x59f73a['querySelector'](_0x64cb4a(0xec2))[_0x64cb4a(0xbed)]),_0x567063=_0x59f73a[_0x64cb4a(0x49c)]('.variation-image-preview')['src'];_0x5daf06&&!isNaN(_0x13b158)&&_0x13b158>=0x0&&_0x7d816['push']({'name':_0x5daf06,'price':_0x13b158,'imageUrl':_0x567063[_0x64cb4a(0xe53)](_0x64cb4a(0xe93))?null:_0x567063});});const _0x114203={'name':_0x2a719c,'price':_0x5d3d8a,'description':_0x424487,'imageUrl':_0x2f5e4b,'categoryId':_0x48421e,'variations':_0x7d816};_0x500637?await _0x4e1bbf[_0x4e5454(0x760)][_0x4e5454(0x32e)](_0x500637,_0x114203):await _0x4e1bbf[_0x4e5454(0x760)][_0x4e5454(0xdda)](_0x114203),document[_0x4e5454(0x64f)](_0x4e5454(0x94c))['classList'][_0x4e5454(0x1275)](_0x4e5454(0x40a)),await _0x515ef1();}async function _0x111c32(){const _0x115890=_0x5a7792;await _0x340b03(),_0xddd8ae(_0x115890(0x16e));}async function _0x340b03(){const _0x2cd03a=_0x5a7792,_0x40c13b=document[_0x2cd03a(0x64f)](_0x2cd03a(0xaf)),_0x24b3e0=document[_0x2cd03a(0x64f)](_0x2cd03a(0x74e));_0x40c13b['innerHTML']='',_0x24b3e0['innerHTML']='';const _0x287a72=await _0x4e1bbf[_0x2cd03a(0xc93)][_0x2cd03a(0x78f)]();if(_0x287a72[_0x2cd03a(0x40f)]===0x0){_0x24b3e0[_0x2cd03a(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0xb35982=document[_0x2cd03a(0x124e)](_0x2cd03a(0xcd));_0xb35982['className']=_0x2cd03a(0xe4a),_0xb35982['textContent']=_0x2cd03a(0x9c7),_0xb35982[_0x2cd03a(0x12e1)][_0x2cd03a(0xcd3)]=_0x2cd03a(0x3fa),_0x40c13b[_0x2cd03a(0x99e)](_0xb35982);const _0x53b933=document[_0x2cd03a(0x124e)](_0x2cd03a(0x479));_0x53b933[_0x2cd03a(0x87d)]='rules-category-pane\x20active',_0x53b933['dataset'][_0x2cd03a(0xcd3)]=_0x2cd03a(0x3fa),_0x24b3e0[_0x2cd03a(0x99e)](_0x53b933);const _0x158119=Object[_0x2cd03a(0xd6d)](_0x3e7a1b['chats'])[_0x2cd03a(0x156)](_0x1acd7f=>!_0x1acd7f[_0x2cd03a(0x1167)]&&_0x287a72[_0x2cd03a(0x26c)](_0x4ea51b=>_0x4ea51b[_0x2cd03a(0x367)]===_0x1acd7f['id']));_0x158119[_0x2cd03a(0x103)](_0x17ebdc=>{const _0x256e9e=_0x2cd03a,_0x505e64=document['createElement'](_0x256e9e(0xcd));_0x505e64['className']=_0x256e9e(0x9b8),_0x505e64[_0x256e9e(0xee5)]=_0x17ebdc[_0x256e9e(0x6fc)],_0x505e64[_0x256e9e(0x12e1)][_0x256e9e(0xcd3)]=_0x17ebdc['id'],_0x40c13b[_0x256e9e(0x99e)](_0x505e64);const _0x50c0e9=document[_0x256e9e(0x124e)](_0x256e9e(0x479));_0x50c0e9[_0x256e9e(0x87d)]=_0x256e9e(0xa2e),_0x50c0e9[_0x256e9e(0x12e1)][_0x256e9e(0xcd3)]=_0x17ebdc['id'],_0x24b3e0[_0x256e9e(0x99e)](_0x50c0e9);}),_0x287a72[_0x2cd03a(0x103)](_0x5bcec0=>{const _0x2b4538=_0x2cd03a,_0x479a35=_0xc7a2bc(_0x5bcec0),_0x5d388b=_0x24b3e0[_0x2b4538(0x49c)](_0x2b4538(0x93e)+_0x5bcec0[_0x2b4538(0x367)]+'\x22]');_0x5d388b&&_0x5d388b[_0x2b4538(0x99e)](_0x479a35);}),document['querySelectorAll']('.rules-tab')[_0x2cd03a(0x103)](_0x159c7c=>{const _0x335bf2=_0x2cd03a;_0x159c7c[_0x335bf2(0xf72)]('click',()=>_0x1cde7a(_0x159c7c['dataset'][_0x335bf2(0xcd3)]));});}function _0xc7a2bc(_0xa66a41){const _0x493d29=_0x5a7792,_0x219f54=document[_0x493d29(0x124e)](_0x493d29(0x479));return _0x219f54[_0x493d29(0x87d)]=_0x493d29(0x5a9)+(_0xa66a41[_0x493d29(0x158)]?_0x493d29(0x9b):''),_0x219f54['dataset'][_0x493d29(0xde8)]=_0xa66a41['id'],_0x219f54['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0xa66a41['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0xa66a41[_0x493d29(0xc28)]+_0x493d29(0x897),_0x219f54[_0x493d29(0xf72)](_0x493d29(0x1080),()=>_0x537fb5(_0xa66a41['id'])),_0xb407a5(_0x219f54,()=>_0x138d0b(_0xa66a41['id'])),_0x219f54;}async function _0x537fb5(_0x3dc96e=null){const _0x4412cc=_0x5a7792;_0xa5232a=_0x3dc96e;const _0x463327=document[_0x4412cc(0x64f)](_0x4412cc(0x671)),_0x3186c1=document['getElementById'](_0x4412cc(0x921)),_0x209b38=document[_0x4412cc(0x64f)](_0x4412cc(0x1391)),_0x5c823c=document[_0x4412cc(0x64f)](_0x4412cc(0x24a)),_0x3aab8d=document[_0x4412cc(0x64f)](_0x4412cc(0xda4)),_0x185a02=document[_0x4412cc(0x64f)](_0x4412cc(0xf66)),_0x9a5d5f=document[_0x4412cc(0x64f)]('rule-enabled-switch');_0x5c823c[_0x4412cc(0xc58)]='<option\x20value=\x22global\x22>公用\x20(所有角色)</option>',Object[_0x4412cc(0xd6d)](_0x3e7a1b['chats'])[_0x4412cc(0x156)](_0x2add7e=>!_0x2add7e['isGroup'])[_0x4412cc(0x103)](_0x430aab=>{const _0xc8ed0e=_0x4412cc;_0x5c823c[_0xc8ed0e(0xc58)]+=_0xc8ed0e(0x695)+_0x430aab['id']+'\x22>'+_0x430aab['name']+_0xc8ed0e(0x4ca);});if(_0x3dc96e){_0x3186c1[_0x4412cc(0xee5)]=_0x4412cc(0xcf1);const _0x31e33d=await _0x4e1bbf[_0x4412cc(0xc93)][_0x4412cc(0x11fc)](_0x3dc96e);_0x209b38[_0x4412cc(0xbed)]=_0x31e33d[_0x4412cc(0x6fc)],_0x5c823c[_0x4412cc(0xbed)]=_0x31e33d[_0x4412cc(0x367)],_0x3aab8d['value']=_0x31e33d[_0x4412cc(0xc28)],_0x185a02[_0x4412cc(0xbed)]=_0x31e33d[_0x4412cc(0xc98)],_0x9a5d5f['checked']=_0x31e33d['isEnabled'];}else _0x3186c1[_0x4412cc(0xee5)]='创建新规则',_0x209b38[_0x4412cc(0xbed)]='',_0x5c823c['value']='global',_0x3aab8d[_0x4412cc(0xbed)]='',_0x185a02[_0x4412cc(0xbed)]='',_0x9a5d5f[_0x4412cc(0xf1d)]=!![];_0x463327[_0x4412cc(0x418)][_0x4412cc(0xdda)](_0x4412cc(0x40a));}async function _0x441f4b(){const _0x5774e8=_0x5a7792,_0x516196=document[_0x5774e8(0x64f)]('rule-name-input')[_0x5774e8(0xbed)]['trim'](),_0x56e54d=document[_0x5774e8(0x64f)](_0x5774e8(0xda4))[_0x5774e8(0xbed)][_0x5774e8(0x43a)]();if(!_0x516196||!_0x56e54d){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x56e54d);}catch(_0x200a68){alert('正则表达式格式错误:\x20'+_0x200a68['message']);return;}const _0x2e83c1={'name':_0x516196,'chatId':document[_0x5774e8(0x64f)](_0x5774e8(0x24a))[_0x5774e8(0xbed)],'regex':_0x56e54d,'template':document['getElementById']('rule-template-input')[_0x5774e8(0xbed)],'isEnabled':document[_0x5774e8(0x64f)](_0x5774e8(0x5a8))[_0x5774e8(0xf1d)]};_0xa5232a?await _0x4e1bbf['renderingRules']['update'](_0xa5232a,_0x2e83c1):await _0x4e1bbf[_0x5774e8(0xc93)][_0x5774e8(0xdda)](_0x2e83c1),document[_0x5774e8(0x64f)](_0x5774e8(0x671))[_0x5774e8(0x418)][_0x5774e8(0x1275)](_0x5774e8(0x40a)),await _0x340b03();}async function _0x138d0b(_0x2487f5){const _0xb30b6=_0x5a7792,_0xc8d7be=await _0x54149f('删除规则',_0xb30b6(0x211),{'confirmButtonClass':_0xb30b6(0xeed)});_0xc8d7be&&(await _0x4e1bbf[_0xb30b6(0xc93)][_0xb30b6(0x3aa)](_0x2487f5),await _0x340b03());}async function _0x4e596c(_0x26e4ba,_0x424be2){const _0x487482=_0x5a7792;if(_0x26e4ba[_0x487482(0x43a)]()[_0x487482(0x7d)]('<')||!_0x26e4ba['includes']('[')&&!_0x26e4ba[_0x487482(0xe53)]('{'))return _0x26e4ba;const _0x5756fa=await _0x4e1bbf[_0x487482(0xc93)][_0x487482(0xec9)]('chatId')[_0x487482(0x11cd)](_0x487482(0x3fa))['or']('chatId')['equals'](_0x424be2)[_0x487482(0x78f)]();let _0x3aefec=_0x26e4ba;for(const _0x2bc237 of _0x5756fa[_0x487482(0x156)](_0x2eb32=>_0x2eb32[_0x487482(0x158)])){try{const _0x1cb97e=new RegExp(_0x2bc237[_0x487482(0xc28)],'g');_0x1cb97e[_0x487482(0x4af)](_0x3aefec)&&(_0x3aefec=_0x3aefec[_0x487482(0x137f)](_0x1cb97e,_0x2bc237['template']));}catch(_0xf2b48a){console[_0x487482(0xc60)]('渲染规则\x20['+_0x2bc237[_0x487482(0x6fc)]+_0x487482(0xf1a),_0xf2b48a);}}return _0x3aefec;}async function _0x111c32(){const _0x3d19b2=_0x5a7792;await _0x340b03(),_0xddd8ae(_0x3d19b2(0x16e));}async function _0x340b03(){const _0x3cfddc=_0x5a7792,_0xf669b0=document['getElementById'](_0x3cfddc(0xaf)),_0x27f9c4=document[_0x3cfddc(0x64f)]('rules-content-container');_0xf669b0[_0x3cfddc(0xc58)]='',_0x27f9c4[_0x3cfddc(0xc58)]='';const _0x31f92f=await _0x4e1bbf[_0x3cfddc(0xc93)][_0x3cfddc(0x78f)]();if(_0x31f92f[_0x3cfddc(0x40f)]===0x0){_0x27f9c4['innerHTML']='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2050px;\x22>还没有任何渲染规则。点击右上角“+”创建第一个吧！</p>';return;}const _0x406796=document['createElement'](_0x3cfddc(0xcd));_0x406796[_0x3cfddc(0x87d)]=_0x3cfddc(0xe4a),_0x406796['textContent']='公用规则',_0x406796[_0x3cfddc(0x12e1)][_0x3cfddc(0xcd3)]=_0x3cfddc(0x3fa),_0xf669b0[_0x3cfddc(0x99e)](_0x406796);const _0x5d91c0=document['createElement'](_0x3cfddc(0x479));_0x5d91c0[_0x3cfddc(0x87d)]=_0x3cfddc(0xbc4),_0x5d91c0['dataset']['categoryId']=_0x3cfddc(0x3fa),_0x27f9c4[_0x3cfddc(0x99e)](_0x5d91c0);const _0x47ee45=Object[_0x3cfddc(0xd6d)](_0x3e7a1b['chats'])[_0x3cfddc(0x156)](_0x491197=>!_0x491197[_0x3cfddc(0x1167)]&&_0x31f92f[_0x3cfddc(0x26c)](_0x30e9a8=>_0x30e9a8[_0x3cfddc(0x367)]===_0x491197['id']));_0x47ee45['forEach'](_0x2cf74d=>{const _0x21dcb8=_0x3cfddc,_0x32627e=document[_0x21dcb8(0x124e)]('button');_0x32627e['className']=_0x21dcb8(0x9b8),_0x32627e[_0x21dcb8(0xee5)]=_0x2cf74d[_0x21dcb8(0x6fc)],_0x32627e['dataset'][_0x21dcb8(0xcd3)]=_0x2cf74d['id'],_0xf669b0[_0x21dcb8(0x99e)](_0x32627e);const _0x220156=document[_0x21dcb8(0x124e)](_0x21dcb8(0x479));_0x220156[_0x21dcb8(0x87d)]=_0x21dcb8(0xa2e),_0x220156[_0x21dcb8(0x12e1)][_0x21dcb8(0xcd3)]=_0x2cf74d['id'],_0x27f9c4[_0x21dcb8(0x99e)](_0x220156);}),_0x31f92f[_0x3cfddc(0x103)](_0x581f12=>{const _0x4270d3=_0x3cfddc,_0x3dc8c7=_0xc7a2bc(_0x581f12),_0x399d33=_0x27f9c4[_0x4270d3(0x49c)](_0x4270d3(0x93e)+_0x581f12['chatId']+'\x22]');_0x399d33&&_0x399d33[_0x4270d3(0x99e)](_0x3dc8c7);}),document[_0x3cfddc(0x233)](_0x3cfddc(0x6fd))[_0x3cfddc(0x103)](_0x200d9d=>{const _0x549c07=_0x3cfddc;_0x200d9d[_0x549c07(0xf72)]('click',()=>_0x1cde7a(_0x200d9d[_0x549c07(0x12e1)][_0x549c07(0xcd3)]));});}function _0xc7a2bc(_0x5035ce){const _0x59285d=_0x5a7792,_0x4c9925=document[_0x59285d(0x124e)]('div');return _0x4c9925[_0x59285d(0x87d)]=_0x59285d(0x5a9)+(_0x5035ce[_0x59285d(0x158)]?_0x59285d(0x9b):''),_0x4c9925[_0x59285d(0x12e1)][_0x59285d(0xde8)]=_0x5035ce['id'],_0x4c9925['innerHTML']=_0x59285d(0x3e0)+_0x5035ce['name']+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x5035ce[_0x59285d(0xc28)]+_0x59285d(0x897),_0x4c9925[_0x59285d(0xf72)](_0x59285d(0x1080),()=>_0x537fb5(_0x5035ce['id'])),_0xb407a5(_0x4c9925,()=>_0x138d0b(_0x5035ce['id'])),_0x4c9925;}async function _0x537fb5(_0x2663b8=null){const _0x3d3b85=_0x5a7792;_0xa5232a=_0x2663b8;const _0x25e580=document[_0x3d3b85(0x64f)](_0x3d3b85(0x671)),_0x269cc8=document[_0x3d3b85(0x64f)]('rule-editor-title'),_0x43b41f=document[_0x3d3b85(0x64f)](_0x3d3b85(0x1391)),_0x16e7ae=document['getElementById'](_0x3d3b85(0x24a)),_0x2e6256=document[_0x3d3b85(0x64f)]('rule-regex-input'),_0x578de7=document[_0x3d3b85(0x64f)]('rule-template-input'),_0x401293=document[_0x3d3b85(0x64f)](_0x3d3b85(0x5a8));_0x16e7ae[_0x3d3b85(0xc58)]='<option\x20value=\x22global\x22>公用\x20(所有角色)</option>',Object[_0x3d3b85(0xd6d)](_0x3e7a1b[_0x3d3b85(0x999)])[_0x3d3b85(0x156)](_0x5020bd=>!_0x5020bd['isGroup'])[_0x3d3b85(0x103)](_0x58f7d1=>{const _0x4e4599=_0x3d3b85;_0x16e7ae['innerHTML']+='<option\x20value=\x22'+_0x58f7d1['id']+'\x22>'+_0x58f7d1[_0x4e4599(0x6fc)]+_0x4e4599(0x4ca);});if(_0x2663b8){_0x269cc8[_0x3d3b85(0xee5)]=_0x3d3b85(0xcf1);const _0x5f462a=await _0x4e1bbf['renderingRules'][_0x3d3b85(0x11fc)](_0x2663b8);_0x43b41f['value']=_0x5f462a[_0x3d3b85(0x6fc)],_0x16e7ae[_0x3d3b85(0xbed)]=_0x5f462a[_0x3d3b85(0x367)],_0x2e6256[_0x3d3b85(0xbed)]=_0x5f462a['regex'],_0x578de7[_0x3d3b85(0xbed)]=_0x5f462a[_0x3d3b85(0xc98)],_0x401293[_0x3d3b85(0xf1d)]=_0x5f462a[_0x3d3b85(0x158)];}else _0x269cc8['textContent']=_0x3d3b85(0x73c),_0x43b41f[_0x3d3b85(0xbed)]='',_0x16e7ae[_0x3d3b85(0xbed)]=_0x3d3b85(0x3fa),_0x2e6256[_0x3d3b85(0xbed)]='',_0x578de7[_0x3d3b85(0xbed)]='',_0x401293[_0x3d3b85(0xf1d)]=!![];_0x25e580['classList'][_0x3d3b85(0xdda)](_0x3d3b85(0x40a));}async function _0x441f4b(){const _0x4514bf=_0x5a7792,_0x728e0e=document[_0x4514bf(0x64f)](_0x4514bf(0x1391))[_0x4514bf(0xbed)][_0x4514bf(0x43a)](),_0x26eb2b=document['getElementById'](_0x4514bf(0xda4))['value'][_0x4514bf(0x43a)]();if(!_0x728e0e||!_0x26eb2b){alert('规则名称和正则表达式不能为空！');return;}try{new RegExp(_0x26eb2b);}catch(_0x2615c4){alert(_0x4514bf(0x807)+_0x2615c4[_0x4514bf(0x854)]);return;}const _0x44bdf2={'name':_0x728e0e,'chatId':document['getElementById'](_0x4514bf(0x24a))[_0x4514bf(0xbed)],'regex':_0x26eb2b,'template':document[_0x4514bf(0x64f)](_0x4514bf(0xf66))[_0x4514bf(0xbed)],'isEnabled':document['getElementById'](_0x4514bf(0x5a8))[_0x4514bf(0xf1d)]};_0xa5232a?await _0x4e1bbf[_0x4514bf(0xc93)][_0x4514bf(0x32e)](_0xa5232a,_0x44bdf2):await _0x4e1bbf['renderingRules'][_0x4514bf(0xdda)](_0x44bdf2),document[_0x4514bf(0x64f)](_0x4514bf(0x671))[_0x4514bf(0x418)][_0x4514bf(0x1275)](_0x4514bf(0x40a)),await _0x340b03();}async function _0x138d0b(_0x2aed2e){const _0x5ef5c=_0x5a7792,_0x2f7d33=await _0x54149f(_0x5ef5c(0x11a),_0x5ef5c(0x211),{'confirmButtonClass':_0x5ef5c(0xeed)});_0x2f7d33&&(await _0x4e1bbf[_0x5ef5c(0xc93)][_0x5ef5c(0x3aa)](_0x2aed2e),await _0x340b03());}async function _0x4e596c(_0x53fa27,_0x3065e2){const _0xdca3df=_0x5a7792;if(_0x53fa27[_0xdca3df(0x43a)]()[_0xdca3df(0x7d)]('<')||!_0x53fa27['includes']('[')&&!_0x53fa27[_0xdca3df(0xe53)]('{'))return _0x53fa27;if(!_0x34b644[_0x3065e2]){console[_0xdca3df(0x1081)](_0xdca3df(0x1122)+_0x3065e2);const _0xad275f=await _0x4e1bbf[_0xdca3df(0xc93)][_0xdca3df(0xec9)](_0xdca3df(0x367))[_0xdca3df(0x11cd)]('global')['or'](_0xdca3df(0x367))['equals'](_0x3065e2)[_0xdca3df(0x78f)]();_0x34b644[_0x3065e2]=_0xad275f[_0xdca3df(0x156)](_0x4f58a8=>_0x4f58a8['isEnabled']);}const _0x19df6a=_0x34b644[_0x3065e2];let _0x5c6024=_0x53fa27;for(const _0xe7e99b of _0x19df6a){try{const _0x4ebde4=new RegExp(_0xe7e99b[_0xdca3df(0xc28)],'g');let _0x281a27=_0x5c6024;_0x4ebde4['test'](_0x281a27)&&(_0x5c6024=_0x5c6024[_0xdca3df(0x137f)](_0x4ebde4,_0xe7e99b[_0xdca3df(0xc98)]));}catch(_0x433a8c){console[_0xdca3df(0xc60)]('渲染规则\x20['+_0xe7e99b[_0xdca3df(0x6fc)]+_0xdca3df(0xf1a),_0x433a8c);}}return _0x5c6024;}function _0x2027ae(_0x7bae7b){const _0x138239=_0x5a7792;if(!_0x7bae7b)return'';const _0x3774ef=new Date(),_0x1c1d13=new Date(_0x7bae7b),_0x11afa9=String(_0x1c1d13[_0x138239(0xdb)]())[_0x138239(0xf2)](0x2,'0'),_0x53d305=String(_0x1c1d13[_0x138239(0x14f)]())['padStart'](0x2,'0'),_0x2b0705=_0x11afa9+':'+_0x53d305;if(_0x3774ef[_0x138239(0x859)]()===_0x1c1d13['toDateString']())return _0x2b0705;const _0xfdc984=new Date();_0xfdc984[_0x138239(0x42b)](_0x3774ef[_0x138239(0x12e)]()-0x1);if(_0xfdc984[_0x138239(0x859)]()===_0x1c1d13[_0x138239(0x859)]())return _0x138239(0x135e)+_0x2b0705;const _0x1187a1=_0x1c1d13[_0x138239(0xf87)](),_0x4a6004=String(_0x1c1d13['getMonth']()+0x1)[_0x138239(0xf2)](0x2,'0'),_0x29f50b=String(_0x1c1d13[_0x138239(0x12e)]())[_0x138239(0xf2)](0x2,'0');return _0x3774ef[_0x138239(0xf87)]()===_0x1187a1?_0x4a6004+'月'+_0x29f50b+'日\x20'+_0x2b0705:_0x1187a1+'年'+_0x4a6004+'月'+_0x29f50b+'日\x20'+_0x2b0705;}function _0x100722(_0x840fd0){const _0x160dc2=_0x5a7792,_0x451d66=document[_0x160dc2(0x124e)](_0x160dc2(0x479));_0x451d66[_0x160dc2(0x87d)]=_0x160dc2(0x1293);const _0x110309=document[_0x160dc2(0x124e)](_0x160dc2(0x479));return _0x110309[_0x160dc2(0x87d)]=_0x160dc2(0xfcc),_0x110309[_0x160dc2(0xee5)]=_0x2027ae(_0x840fd0),_0x451d66[_0x160dc2(0x99e)](_0x110309),_0x451d66;}async function _0x55b560(){const _0x1a3952=_0x5a7792,_0x3934ee=_0x3e7a1b[_0x1a3952(0x999)][_0x3e7a1b[_0x1a3952(0x777)]];if(!_0x3934ee||!lastResponseTimestamps||lastResponseTimestamps['length']===0x0){alert(_0x1a3952(0x7e6));return;}_0x3934ee[_0x1a3952(0x830)]=_0x3934ee[_0x1a3952(0x830)][_0x1a3952(0x156)](_0xc2b603=>!lastResponseTimestamps['includes'](_0xc2b603[_0x1a3952(0x8af)])),await _0x4e1bbf[_0x1a3952(0x999)][_0x1a3952(0x4fa)](_0x3934ee),await _0x4817d1(_0x3e7a1b['activeChatId']),_0x4ce7a9();}async function _0x3fb80a(){const _0x5f496c=_0x5a7792,_0x38897c=_0x3e7a1b[_0x5f496c(0x999)][_0x3e7a1b[_0x5f496c(0x777)]];if(!_0x38897c)return;const _0xe89675=_0x38897c[_0x5f496c(0x830)][_0x5f496c(0x100c)](_0x1f125a=>_0x1f125a[_0x5f496c(0x931)]===_0x5f496c(0xa4d)&&!_0x1f125a[_0x5f496c(0x5cc)]);if(_0xe89675===-0x1){alert(_0x5f496c(0x66d));return;}const _0xd8b207=_0x38897c['history'][_0x5f496c(0x100c)](_0x48f199=>_0x48f199[_0x5f496c(0x931)]===_0x5f496c(0x12c3));if(_0xd8b207<_0xe89675){alert(_0x5f496c(0x667));return;}_0x38897c['history'][_0x5f496c(0x10f9)](_0xe89675+0x1),await _0x4e1bbf[_0x5f496c(0x999)][_0x5f496c(0x4fa)](_0x38897c),await _0x4817d1(_0x3e7a1b['activeChatId']),await _0x20a638();}async function _0x532436(){const _0x33e406=_0x5a7792;if(!_0x42b67f[_0x33e406(0xb30)])return;const _0x48a814=_0x42b67f[_0x33e406(0x10f2)]['findLastIndex'](_0x17a4c6=>_0x17a4c6[_0x33e406(0x931)]===_0x33e406(0xa4d));if(_0x48a814===-0x1){alert(_0x33e406(0xcfc));return;}_0x42b67f['callHistory'][_0x33e406(0x10f9)](_0x48a814+0x1);const _0x402902=document['getElementById']('video-call-main');_0x402902[_0x33e406(0xc58)]='',_0x42b67f[_0x33e406(0x10f2)][_0x33e406(0x103)](_0xf6c978=>{const _0x49c1fb=_0x33e406,_0x155648=document['createElement'](_0x49c1fb(0x479));_0x155648['className']='call-message-bubble\x20'+_0xf6c978[_0x49c1fb(0x931)]+_0x49c1fb(0x1051),_0x155648[_0x49c1fb(0x12e1)][_0x49c1fb(0x8af)]=_0xf6c978[_0x49c1fb(0x8af)],_0xf6c978[_0x49c1fb(0x931)]===_0x49c1fb(0xa4d)?_0x155648[_0x49c1fb(0xee5)]=_0xf6c978[_0x49c1fb(0x3ba)]:_0x155648['innerHTML']=_0xf6c978['content'],_0xb407a5(_0x155648,()=>_0x548b73(_0xf6c978['timestamp'])),_0x402902[_0x49c1fb(0x99e)](_0x155648);}),_0x402902[_0x33e406(0xed7)]=_0x402902[_0x33e406(0x1ba)],_0x58fc54(null);}async function _0x2a53bc(){const _0x2a498a=_0x5a7792,_0xd5db6=_0x3e7a1b['chats'][_0x3e7a1b['activeChatId']];if(!_0xd5db6)return;_0x570655(_0xd5db6['id'],!![]);const _0x3578e4=document[_0x2a498a(0x64f)](_0x2a498a(0x11ec));!_0xd5db6[_0x2a498a(0x1167)]&&(_0x3578e4[_0x2a498a(0x731)][_0x2a498a(0x131a)]=0x0,setTimeout(()=>{const _0x9578c7=_0x2a498a;_0x3578e4[_0x9578c7(0xee5)]=_0x9578c7(0x137a),_0x3578e4[_0x9578c7(0x418)][_0x9578c7(0xdda)](_0x9578c7(0x850)),_0x3578e4['style'][_0x9578c7(0x131a)]=0x1;},0xc8));try{const {proxyUrl:_0x6360a,apiKey:_0x9af15d,model:_0x3f4a1b}=_0x3e7a1b[_0x2a498a(0xec0)];if(!_0x6360a||!_0x9af15d||!_0x3f4a1b)throw new Error('API未配置');const _0x330f4f=parseInt(_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0xd50)])||0xa,_0x1468f2=_0xd5db6[_0x2a498a(0x830)][_0x2a498a(0xdf5)](-_0x330f4f),_0x3e77a9=new Date(),_0x29efe4=new Date(_0x3e77a9[_0x2a498a(0x767)]()+_0x3e77a9[_0x2a498a(0x120f)]()*0xea60+0x36ee80*0x8),_0xdebbd3=_0x29efe4[_0x2a498a(0x2b4)](_0x2a498a(0x6ec),{'timeZone':_0x2a498a(0xe77),'dateStyle':_0x2a498a(0xfd),'timeStyle':'short'}),_0x53397f=_0x19a7ae(_0x29efe4),_0xfd0eaf=_0xd5db6[_0x2a498a(0xcb3)]['myNickname']||'我';let _0xe5ec72='';if(_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0xde4)]&&_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0xde4)]['length']>0x0){const _0x443280=_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0xde4)][_0x2a498a(0xb96)](_0x2b13cb=>{const _0x382e7d=_0x2a498a,_0x476940=_0x3e7a1b[_0x382e7d(0x144)][_0x382e7d(0x137)](_0x140ac5=>_0x140ac5['id']===_0x2b13cb);if(!_0x476940||!Array[_0x382e7d(0x97e)](_0x476940[_0x382e7d(0x3ba)]))return'';const _0x419e1c=_0x476940[_0x382e7d(0x3ba)]['filter'](_0x59d78b=>_0x59d78b[_0x382e7d(0x9b)]!==![])[_0x382e7d(0xb96)](_0x2e65ad=>{const _0x311ef2=_0x382e7d;let _0x5ad7f3=_0x311ef2(0x265)+(_0x2e65ad[_0x311ef2(0x652)]||_0x311ef2(0x497))+'\x0a';if(_0x2e65ad[_0x311ef2(0xc30)][_0x311ef2(0x40f)]>0x0)_0x5ad7f3+=_0x311ef2(0x1202)+_0x2e65ad[_0x311ef2(0xc30)][_0x311ef2(0xd22)](',\x20')+'\x0a';return _0x5ad7f3+=_0x311ef2(0x188)+_0x2e65ad[_0x311ef2(0x3ba)],_0x5ad7f3;})['join']('');return _0x419e1c?_0x382e7d(0x228)+_0x476940[_0x382e7d(0x6fc)]+'\x0a'+_0x419e1c:'';})[_0x2a498a(0x156)](Boolean)[_0x2a498a(0xd22)]('');_0x443280&&(_0xe5ec72=_0x2a498a(0x13cc)+_0x443280+_0x2a498a(0xf0f));}let _0x1c917b='';if(_0x1c083c[_0x2a498a(0xb30)]&&_0x1c083c[_0x2a498a(0x777)]===_0xd5db6['id']){const _0x53f87a=_0x1c083c[_0x2a498a(0x409)]>-0x1?_0x1c083c[_0x2a498a(0x11ce)][_0x1c083c[_0x2a498a(0x409)]]:null;_0x1c917b='\x0a\x0a#\x20当前音乐情景...\x0a(省略详细内容，与triggerAiResponse一致)';}const _0x137b63=_0xec60af(_0x4dc8ec[_0xd5db6['id']]);let _0x1c4c61='';_0xd5db6[_0x2a498a(0x19e)]&&_0xd5db6[_0x2a498a(0x19e)]['length']>0x0&&(_0x1c4c61=_0x2a498a(0xebd)+_0xd5db6['nameHistory'][_0x2a498a(0xd22)](',\x20')+_0x2a498a(0x10f1));let _0x532303='';const _0x35d64b=_0x3e7a1b[_0x2a498a(0x3c2)][_0x2a498a(0x78c)]||'用户';_0x532303+=_0x2a498a(0x2ab)+_0x35d64b+'\x22。\x0a';const _0x3552ed=Object[_0x2a498a(0xd6d)](_0x3e7a1b[_0x2a498a(0x999)])[_0x2a498a(0x156)](_0xe45476=>_0xe45476[_0x2a498a(0x1167)]&&_0xe45476['members'][_0x2a498a(0x26c)](_0x501a3d=>_0x501a3d['id']===_0xd5db6['id']));_0x3552ed[_0x2a498a(0x40f)]>0x0&&(_0x532303+=_0x2a498a(0x84b),_0x3552ed[_0x2a498a(0x103)](_0x4b24eb=>{const _0x117f57=_0x2a498a,_0x23e074=_0x4b24eb[_0x117f57(0xcb3)]['myNickname']||_0x35d64b;_0x532303+=_0x117f57(0xcd7)+_0x4b24eb[_0x117f57(0x6fc)]+_0x117f57(0x10fc)+_0x23e074+'”。\x0a';}));_0x532303+='当你在任何系统提示、动态评论或挂载的群聊记忆中看到这些名字时，它们都指代的是【你的聊天对象】。';const _0x268ae6=_0x5530dc(_0xd5db6),_0x58423b=_0x2a498a(0x317)+_0xd5db6[_0x2a498a(0x7de)]+_0x2a498a(0x643)+_0xdebbd3+'\x20('+_0x53397f+_0x2a498a(0x944)+(_0x1c917b?_0x2a498a(0xb21)+_0x1c917b:'你们没有在听歌。')+_0x2a498a(0x959)+(_0xd5db6[_0x2a498a(0x518)]&&_0xd5db6[_0x2a498a(0x518)][_0x2a498a(0x40f)]>0x0?_0xd5db6['longTermMemory'][_0x2a498a(0xb96)](_0x582c4e=>'-\x20'+_0x582c4e[_0x2a498a(0x3ba)])[_0x2a498a(0xd22)]('\x0a'):_0x2a498a(0xd0b))+'\x0a\x0a#\x20你的角色设定\x0a'+_0xd5db6['settings'][_0x2a498a(0xbe5)]+_0x2a498a(0x81d)+_0xd5db6[_0x2a498a(0x7de)]+_0x2a498a(0xd67)+_0xd5db6[_0x2a498a(0x6fc)]+_0x2a498a(0x10e6)+_0xfd0eaf+_0x2a498a(0x137d)+_0x532303+_0x2a498a(0xf7e)+_0x1c4c61+'\x0a\x20\x20\x20\x20'+_0xe5ec72+_0x2a498a(0x748)+_0x268ae6+_0x2a498a(0x1033)+(_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0x1163)]&&_0xd5db6[_0x2a498a(0xcb3)]['aiAvatarLibrary'][_0x2a498a(0x40f)]>0x0?_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0x1163)][_0x2a498a(0xb96)](_0x32f6b7=>'-\x20'+_0x32f6b7[_0x2a498a(0x6fc)])[_0x2a498a(0xd22)]('\x0a'):_0x2a498a(0x586))+_0x2a498a(0x4f6)+(_0xd5db6['settings'][_0x2a498a(0x83a)]&&_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0x83a)][_0x2a498a(0x40f)]>0x0?_0xd5db6[_0x2a498a(0xcb3)][_0x2a498a(0x83a)]['map'](_0x11c39b=>'-\x20'+_0x11c39b[_0x2a498a(0x6fc)])[_0x2a498a(0xd22)]('\x0a'):_0x2a498a(0x586))+_0x2a498a(0x6dd)+_0xd5db6['settings'][_0x2a498a(0x1047)]+_0x2a498a(0x8ba),_0x1b07a7=_0x1468f2[_0x2a498a(0xb96)](_0x2da9a3=>({'role':_0x2da9a3[_0x2a498a(0x931)],'content':String(_0x2da9a3[_0x2a498a(0x3ba)])}));_0x1b07a7[_0x2a498a(0x13ee)]({'role':_0x2a498a(0xa4d),'content':_0x2a498a(0x1e4)});let _0x2bbbcc=_0x6360a===GEMINI_API_URL,_0x40bf93=_0x250668(_0x3f4a1b,_0x9af15d,_0x58423b,_0x1b07a7);const _0x4d44eb=_0x2bbbcc?await fetch(_0x40bf93[_0x2a498a(0xe52)],_0x40bf93[_0x2a498a(0x88a)]):await fetch(_0x6360a+_0x2a498a(0x58b),{'method':_0x2a498a(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0x2a498a(0x236)+_0x9af15d},'body':JSON[_0x2a498a(0xe3f)]({'model':_0x3f4a1b,'messages':[{'role':_0x2a498a(0x905),'content':_0x58423b},..._0x1b07a7],'temperature':_0x3e7a1b[_0x2a498a(0x11b4)][_0x2a498a(0xa55)]||0.8})});if(!_0x4d44eb['ok']){const _0x458ecb=await _0x4d44eb['json']();throw new Error('API\x20请求失败:\x20'+_0x458ecb[_0x2a498a(0xc60)][_0x2a498a(0x854)]);}const _0x3434f2=await _0x4d44eb['json'](),_0x3d8441=getGeminiResponseText(_0x3434f2),_0x1b0594=_0x3755ce(_0x3d8441),_0x3b1898=[];for(const _0xfd19a9 of _0x1b0594){if(_0xfd19a9[_0x2a498a(0xafc)]===_0x2a498a(0x673)&&typeof _0xfd19a9[_0x2a498a(0x3ba)]===_0x2a498a(0x1251)&&_0xfd19a9[_0x2a498a(0x3ba)][_0x2a498a(0xe53)]('\x0a')){const _0x5a9e11=_0xfd19a9[_0x2a498a(0x3ba)][_0x2a498a(0x108c)](/\n+/)[_0x2a498a(0x156)](_0x8fe107=>_0x8fe107[_0x2a498a(0x43a)]());_0x5a9e11['forEach'](_0x216d19=>{const _0x24ca21=_0x2a498a;_0x3b1898[_0x24ca21(0x13ee)]({..._0xfd19a9,'content':_0x216d19});});}else _0x3b1898[_0x2a498a(0x13ee)](_0xfd19a9);}let _0x5a5c7f=Date[_0x2a498a(0x2b5)]();for(const _0xe7c56 of _0x3b1898){const _0x85d3cc={'role':_0x2a498a(0x12c3),'senderName':_0xd5db6[_0x2a498a(0x7de)],'timestamp':_0x5a5c7f++,'content':_0xe7c56[_0x2a498a(0x3ba)]||_0xe7c56[_0x2a498a(0x854)],'type':_0xe7c56[_0x2a498a(0xafc)]||_0x2a498a(0x673)};if(_0xe7c56[_0x2a498a(0xafc)]===_0x2a498a(0x12a5)){if(!_0xd5db6[_0x2a498a(0x1167)]){if(_0xe7c56['heartfelt_voice'])_0xd5db6[_0x2a498a(0x12d9)]=String(_0xe7c56[_0x2a498a(0xa3a)]);if(_0xe7c56['random_jottings'])_0xd5db6[_0x2a498a(0xb9d)]=String(_0xe7c56[_0x2a498a(0xe04)]);}continue;}_0xd5db6[_0x2a498a(0x830)][_0x2a498a(0x13ee)](_0x85d3cc),_0x3c7e84(_0x85d3cc,_0xd5db6),await new Promise(_0x3631f2=>setTimeout(_0x3631f2,Math[_0x2a498a(0x95f)]()*0x3e8+0x320));}await _0x4e1bbf[_0x2a498a(0x999)][_0x2a498a(0x4fa)](_0xd5db6),_0x21f6ea();}catch(_0x15f88d){console[_0x2a498a(0xc60)]('推进剧情失败:',_0x15f88d),await _0x28974b(_0x2a498a(0x5b1),_0x2a498a(0x1a6)+_0x15f88d[_0x2a498a(0x854)]);}finally{_0x570655(_0xd5db6['id'],![]);if(!_0xd5db6['isGroup']&&document['getElementById'](_0x2a498a(0x11ec))){const _0x19e658=document['getElementById'](_0x2a498a(0x11ec));_0x19e658['style'][_0x2a498a(0x131a)]=0x0,setTimeout(()=>{const _0x324367=_0x2a498a;_0x19e658['textContent']=_0xd5db6[_0x324367(0x6fc)],_0x19e658[_0x324367(0x418)][_0x324367(0x1275)]('typing-status'),_0x19e658['style']['opacity']=0x1;},0xc8);}}}function _0x5e1ec8(){const _0x12350b=_0x5a7792,_0x99bf32=document[_0x12350b(0x64f)](_0x12350b(0xc4a)),_0x5dc109=_0x3e7a1b['globalSettings'][_0x12350b(0xe5f)]||_0x294cf9;_0x5dc109&&_0x5dc109[_0x12350b(0x43a)]()&&(_0x99bf32['src']=_0x5dc109,_0x99bf32['play']()[_0x12350b(0x1201)](_0x1f01ac=>console[_0x12350b(0x1081)](_0x12350b(0x10a2),_0x1f01ac)));}function _0x320954(){const _0x34ad38=_0x5a7792;if(!_0x3e7a1b['globalSettings'][_0x34ad38(0x9cc)])return;for(const _0x16f843 in _0x3e7a1b[_0x34ad38(0x11b4)][_0x34ad38(0x9cc)]){const _0x4dc3ef=document[_0x34ad38(0x64f)](_0x16f843),_0x233014=_0x3e7a1b[_0x34ad38(0x11b4)][_0x34ad38(0x9cc)][_0x16f843];_0x4dc3ef&&(_0x4dc3ef['tagName']===_0x34ad38(0x7bf)?_0x4dc3ef[_0x34ad38(0xbe8)]=_0x233014:_0x4dc3ef[_0x34ad38(0xee5)]=_0x233014);}}function _0x44b2ac(){return new Promise(_0x565517=>{const _0x2241c5=_0x2bd6,_0x4b7340=document[_0x2241c5(0x124e)](_0x2241c5(0x62b));_0x4b7340[_0x2241c5(0xafc)]='file',_0x4b7340[_0x2241c5(0x5fb)]=_0x2241c5(0xa65),_0x4b7340[_0x2241c5(0x2ef)]=_0x34c926=>{const _0x1e76d1=_0x2241c5,_0x18f825=_0x34c926[_0x1e76d1(0xf5b)][_0x1e76d1(0x91e)][0x0];if(_0x18f825){const _0x5ab627=new FileReader();_0x5ab627[_0x1e76d1(0x139d)]=_0x4fc0a7=>{const _0x550da2=_0x1e76d1;_0x565517(_0x4fc0a7[_0x550da2(0xf5b)][_0x550da2(0x8f)]);},_0x5ab627['readAsDataURL'](_0x18f825);}else _0x565517(null);},_0x4b7340[_0x2241c5(0x1080)]();});}async function _0x141062(_0x2bdf00){const _0x2f68ce=_0x5a7792,_0x3f76b5=_0x2bdf00['id'],_0x361b28=_0x2bdf00[_0x2f68ce(0xee5)],_0x38301b=await _0x41e3f8('修改文字','请输入新的内容：',_0x361b28);if(_0x38301b!==null&&_0x38301b[_0x2f68ce(0x43a)]()!==''){const _0x3bcae0=_0x38301b['trim']();_0x2bdf00[_0x2f68ce(0xee5)]=_0x3bcae0,_0x3e7a1b[_0x2f68ce(0x11b4)][_0x2f68ce(0x9cc)][_0x3f76b5]=_0x3bcae0,await _0x4e1bbf[_0x2f68ce(0x11b4)][_0x2f68ce(0x4fa)](_0x3e7a1b[_0x2f68ce(0x11b4)]),alert(_0x2f68ce(0x3a5));}}async function _0x145e8e(_0x8908ba){const _0x431ba2=_0x5a7792,_0x57fd29=_0x8908ba['id'],_0x3c81a3=await _0x217169(_0x431ba2(0xbac),[{'text':_0x431ba2(0x9ba),'value':'local'},{'text':_0x431ba2(0xe00),'value':_0x431ba2(0xe52)}]);let _0xb36a66=null;if(_0x3c81a3===_0x431ba2(0x2a2))_0xb36a66=await _0x44b2ac();else _0x3c81a3===_0x431ba2(0xe52)&&(_0xb36a66=await _0x41e3f8(_0x431ba2(0xbac),_0x431ba2(0x13a4),_0x8908ba[_0x431ba2(0xbe8)],_0x431ba2(0xe52)));if(_0xb36a66&&_0xb36a66[_0x431ba2(0x43a)]()){const _0xf885a9=_0xb36a66[_0x431ba2(0x43a)]();_0x8908ba[_0x431ba2(0xbe8)]=_0xf885a9,_0x3e7a1b[_0x431ba2(0x11b4)][_0x431ba2(0x9cc)][_0x57fd29]=_0xf885a9,await _0x4e1bbf[_0x431ba2(0x11b4)][_0x431ba2(0x4fa)](_0x3e7a1b[_0x431ba2(0x11b4)]),alert(_0x431ba2(0xcc9));}else _0x3c81a3===_0x431ba2(0xe52)&&_0xb36a66!==null&&alert(_0x431ba2(0x51d));}const _0x4a8b3f={'getSongCache'(_0x141dd6,_0x15bc55){const _0x1c6bba=_0x5a7792,_0x2264b4=(_0x15bc55||_0x1c6bba(0xfd7))+':'+_0x141dd6;if(_0x3e7a1b[_0x1c6bba(0xe2d)]&&_0x3e7a1b[_0x1c6bba(0xe2d)][_0x1c6bba(0x7ff)]){const _0x193cf7=_0x3e7a1b['cache'][_0x1c6bba(0x7ff)][_0x1c6bba(0x11fc)](_0x2264b4);if(_0x193cf7&&Date[_0x1c6bba(0x2b5)]()-_0x193cf7['timestamp']<0x36ee80)return _0x193cf7['data'];}return null;},'setSongCache'(_0x482148,_0x1e927c,_0x5c2973){const _0x1322c6=_0x5a7792,_0x35bd45=(_0x5c2973||'all')+':'+_0x482148;if(!_0x3e7a1b[_0x1322c6(0xe2d)])_0x3e7a1b[_0x1322c6(0xe2d)]={};if(!_0x3e7a1b[_0x1322c6(0xe2d)][_0x1322c6(0x7ff)])_0x3e7a1b[_0x1322c6(0xe2d)][_0x1322c6(0x7ff)]=new Map();_0x3e7a1b['cache']['songs'][_0x1322c6(0x125e)](_0x35bd45,{'data':_0x1e927c,'timestamp':Date['now']()});}};typeof Http_Get_External===_0x5a7792(0x3a3)&&(window[_0x5a7792(0xdc9)]=function(_0x3495b8){return new Promise(_0x822b20=>{const _0x1674aa=_0x2bd6;fetch(_0x3495b8)[_0x1674aa(0x102e)](_0x7eb5b9=>_0x7eb5b9[_0x1674aa(0x6f8)]()[_0x1674aa(0x1201)](()=>_0x7eb5b9[_0x1674aa(0x673)]()))[_0x1674aa(0x102e)](_0x822b20)['catch'](()=>_0x822b20(null));});});async function _0x245135(_0x38361c){return await Http_Get_External(_0x38361c);}function _0x56a229(_0x5e54e3){return new Promise(_0x4934f2=>{const _0xafeccc=_0x2bd6,_0x3e7dfb=new Audio();_0x3e7dfb[_0xafeccc(0xf72)](_0xafeccc(0x131d),()=>_0x4934f2(!![]),{'once':!![]}),_0x3e7dfb[_0xafeccc(0xf72)](_0xafeccc(0xc60),()=>_0x4934f2(![]),{'once':!![]}),_0x3e7dfb[_0xafeccc(0xbe8)]=_0x5e54e3;});}async function _0x46d5f2(_0x4e453f,_0x19c697){const _0x5027d7=_0x5a7792;try{let _0x3f8d60=_0x4e453f['replace'](/\s/g,'');_0x19c697&&(_0x3f8d60+='\x20'+_0x19c697[_0x5027d7(0x137f)](/\s/g,''));const _0x433da3=_0x5027d7(0xbd2)+encodeURIComponent(_0x3f8d60);console[_0x5027d7(0x1081)](_0x5027d7(0x276),_0x433da3);const _0x5c3718=await fetch(_0x433da3);if(!_0x5c3718['ok'])throw new Error(_0x5027d7(0x43e)+_0x5c3718[_0x5027d7(0x69e)]);const _0x340f56=await _0x5c3718['json']();if(_0x340f56[_0x5027d7(0x11d0)]!==0xc8||!_0x340f56[_0x5027d7(0x88a)]||_0x340f56['data']['length']===0x0)return console[_0x5027d7(0x1081)](_0x5027d7(0x795),_0x340f56),[];return _0x340f56[_0x5027d7(0x88a)][_0x5027d7(0xb96)](_0x54ef84=>({'name':_0x54ef84[_0x5027d7(0xc6f)],'artist':_0x54ef84[_0x5027d7(0xd9f)],'id':_0x54ef84['id'],'cover':_0x54ef84[_0x5027d7(0x844)]||_0x5027d7(0x707),'source':_0x5027d7(0x396)}))[_0x5027d7(0xdf5)](0x0,0x1e);}catch(_0x57e32d){return console[_0x5027d7(0xc60)]('网易云音乐搜索失败:',_0x57e32d),[];}}async function _0x46268f(_0x3c7b37){const _0x230cd4=_0x5a7792;try{_0x3c7b37=_0x3c7b37['replace'](/\s/g,'');const _0x5091ce=await _0x245135(_0x230cd4(0x3c9)+encodeURIComponent(_0x3c7b37));if(!_0x5091ce?.[_0x230cd4(0x88a)]?.[_0x230cd4(0x40f)])return[];return _0x5091ce['data'][_0x230cd4(0xb96)](_0x3a6ddc=>({'name':_0x3a6ddc[_0x230cd4(0xc6f)],'artist':_0x3a6ddc['singer'],'id':_0x3a6ddc['id'],'cover':_0x3a6ddc[_0x230cd4(0x844)]||_0x230cd4(0x462),'source':_0x230cd4(0xc47)}))['slice'](0x0,0x1e);}catch(_0x2b6b04){return console[_0x230cd4(0xc60)](_0x230cd4(0xdcb),_0x2b6b04),[];}}async function _0x43ea06(){const _0x54ab65=_0x5a7792,_0x8dac5f=await _0x41e3f8(_0x54ab65(0x109e),'请输入\x20歌名\x20或\x20歌名-歌手');if(!_0x8dac5f||!_0x8dac5f[_0x54ab65(0x43a)]())return;await _0x28974b('请稍候...',_0x54ab65(0x6f6));let _0x1a57d4=_0x8dac5f[_0x54ab65(0x43a)](),_0x21e2dd='';if(_0x8dac5f[_0x54ab65(0xe53)]('-')||_0x8dac5f[_0x54ab65(0xe53)]('–')){const _0x207a88=_0x8dac5f[_0x54ab65(0x108c)](/[-–]/);_0x1a57d4=_0x207a88[0x0][_0x54ab65(0x43a)](),_0x21e2dd=_0x207a88['slice'](0x1)['join']('\x20')[_0x54ab65(0x43a)]();}const [_0x56c443,_0x588565]=await Promise[_0x54ab65(0xfd7)]([_0x46d5f2(_0x1a57d4,_0x21e2dd),_0x46268f(_0x1a57d4)]),_0x150045=[..._0x56c443,..._0x588565];if(_0x150045[_0x54ab65(0x40f)]===0x0){await _0x28974b(_0x54ab65(0x12f4),_0x54ab65(0xb3f));return;}const _0x2f756=document[_0x54ab65(0x64f)](_0x54ab65(0x896)),_0x46c02e=document[_0x54ab65(0x64f)](_0x54ab65(0x11b2));_0x46c02e[_0x54ab65(0xc58)]='',document[_0x54ab65(0x64f)]('select-all-music-search')[_0x54ab65(0xf1d)]=![],_0x150045[_0x54ab65(0x103)](_0x125951=>{const _0x14feeb=_0x54ab65,_0x457a99=document[_0x14feeb(0x124e)](_0x14feeb(0x479));_0x457a99[_0x14feeb(0x87d)]=_0x14feeb(0x11d2),_0x457a99[_0x14feeb(0x12e1)]['songJson']=JSON[_0x14feeb(0xe3f)](_0x125951),_0x457a99['innerHTML']=_0x14feeb(0x135d)+_0x125951[_0x14feeb(0x6fc)]+_0x14feeb(0x1fb)+_0x125951['artist']+_0x14feeb(0x8ff)+(_0x125951[_0x14feeb(0xfeb)]===_0x14feeb(0x396)?_0x14feeb(0x46a):_0x14feeb(0x1060))+_0x14feeb(0x127c),_0x46c02e[_0x14feeb(0x99e)](_0x457a99);}),_0x2f756['classList'][_0x54ab65(0xdda)](_0x54ab65(0x40a));}async function _0x24fad6(_0x2fbf82){const _0x2c1125=_0x5a7792;let _0x1e226b=null,_0x4a5427=_0x2fbf82['source'];const _0x443613=_0x2fbf82[_0x2c1125(0xfeb)]==='netease'?_0x2c1125(0x1148)+_0x2fbf82['id']:_0x2c1125(0xefa)+_0x2fbf82['id'];let _0x3affe4=await _0x245135(_0x443613);_0x3affe4?.['data']?.[_0x2c1125(0xe52)]&&(_0x1e226b={'url':_0x3affe4[_0x2c1125(0x88a)]['url'],'id':_0x2fbf82['id'],'source':_0x2fbf82[_0x2c1125(0xfeb)]});if(!_0x1e226b){const _0x170cdf=_0x2fbf82['source']===_0x2c1125(0x396)?_0x2c1125(0xc47):_0x2c1125(0x396),_0x27bb72=_0x170cdf==='tencent'?await _0x46268f(_0x2fbf82['name']):await _0x46d5f2(_0x2fbf82[_0x2c1125(0x6fc)],_0x2fbf82['artist']);if(_0x27bb72[_0x2c1125(0x40f)]>0x0){const _0x2606ab=_0x170cdf===_0x2c1125(0x396)?'https://api.vkeys.cn/v2/music/netease?id='+_0x27bb72[0x0]['id']:'https://api.vkeys.cn/v2/music/tencent?id='+_0x27bb72[0x0]['id'],_0x42964f=await _0x245135(_0x2606ab);_0x42964f?.[_0x2c1125(0x88a)]?.[_0x2c1125(0xe52)]&&(_0x1e226b={'url':_0x42964f[_0x2c1125(0x88a)][_0x2c1125(0xe52)],'id':_0x27bb72[0x0]['id'],'source':_0x170cdf},_0x4a5427=_0x170cdf);}}if(_0x1e226b){_0x1e226b[_0x2c1125(0xe52)]&&typeof _0x1e226b[_0x2c1125(0xe52)]==='string'&&(_0x1e226b[_0x2c1125(0xe52)]=_0x1e226b[_0x2c1125(0xe52)][_0x2c1125(0x137f)](/^http:\/\//i,'https://'));_0x2fbf82['cover']&&typeof _0x2fbf82['cover']===_0x2c1125(0x1251)&&(_0x2fbf82['cover']=_0x2fbf82[_0x2c1125(0x844)][_0x2c1125(0x137f)](/^http:\/\//i,_0x2c1125(0x607)));const _0x1cb591=await _0x339136(_0x1e226b['id'],_0x4a5427)||'';return{'name':_0x2fbf82[_0x2c1125(0x6fc)],'artist':_0x2fbf82['artist'],'src':_0x1e226b[_0x2c1125(0xe52)],'cover':_0x2fbf82[_0x2c1125(0x844)],'isLocal':![],'lrcContent':_0x1cb591};}return null;}async function _0x339136(_0x4ba45e,_0x2bf9c0){const _0x11d04b=_0x5a7792,_0x507aeb=_0x2bf9c0===_0x11d04b(0x396)?_0x11d04b(0x10cd)+_0x4ba45e:_0x11d04b(0x1178)+_0x4ba45e,_0x5b09ac=await _0x245135(_0x507aeb);if(_0x5b09ac?.[_0x11d04b(0x88a)]){const _0x19d7f9=_0x5b09ac['data'][_0x11d04b(0x793)]||_0x5b09ac[_0x11d04b(0x88a)][_0x11d04b(0x220)]||'',_0xf51e68=_0x5b09ac['data'][_0x11d04b(0xc2e)]||_0x5b09ac[_0x11d04b(0x88a)]['tlyric']||'';return _0x19d7f9+'\x0a'+_0xf51e68;}return'';}async function _0x5a42e4(_0x1a1038){const _0x15e3e3=_0x5a7792;if(_0x1a1038<0x0||_0x1a1038>=_0x1c083c[_0x15e3e3(0x11ce)]['length'])return;const _0x385326=await _0x217169(_0x15e3e3(0xedc),[{'text':_0x15e3e3(0xe3d),'value':_0x15e3e3(0xb2b)},{'text':'📋\x20直接粘贴歌词文本','value':_0x15e3e3(0x320)}]);let _0x14f54f=null;if(_0x385326===_0x15e3e3(0xb2b))_0x14f54f=await new Promise(_0x5429ab=>{const _0x226a2f=_0x15e3e3,_0x42c167=document[_0x226a2f(0x64f)](_0x226a2f(0x109)),_0x72929f=_0x3c13fa=>{const _0x1512d4=_0x226a2f,_0x4b4071=_0x3c13fa[_0x1512d4(0xf5b)][_0x1512d4(0x91e)][0x0];if(_0x4b4071){const _0xbbebf0=new FileReader();_0xbbebf0[_0x1512d4(0x139d)]=_0x36b521=>_0x5429ab(_0x36b521['target'][_0x1512d4(0x8f)]),_0xbbebf0[_0x1512d4(0x36b)]=()=>_0x5429ab(null),_0xbbebf0[_0x1512d4(0x1308)](_0x4b4071);}else _0x5429ab(null);_0x42c167[_0x1512d4(0xd74)](_0x1512d4(0x834),_0x72929f),_0x42c167[_0x1512d4(0xbed)]='';};_0x42c167[_0x226a2f(0xf72)](_0x226a2f(0x834),_0x72929f,{'once':!![]}),_0x42c167[_0x226a2f(0x1080)]();});else{if(_0x385326===_0x15e3e3(0x320)){const _0x2619a0=await _0x41e3f8(_0x15e3e3(0xf2a),_0x15e3e3(0xe48),'',_0x15e3e3(0x444));if(_0x2619a0)_0x14f54f=_0x2619a0[_0x15e3e3(0x137f)](/\[/g,'\x0a[')[_0x15e3e3(0x43a)]();}}_0x14f54f!==null&&(_0x1c083c[_0x15e3e3(0x11ce)][_0x1a1038]['lrcContent']=_0x14f54f,await _0x16961a(),_0x1c083c[_0x15e3e3(0x409)]===_0x1a1038&&(_0x1c083c[_0x15e3e3(0xc35)]=_0x485f9f(_0x14f54f),_0x1b36d1(),_0x5577aa()),await _0x28974b('成功','《'+_0x1c083c['playlist'][_0x1a1038]['name']+'》的歌词已成功保存！'));}async function _0x4c9730(){const _0x314804=_0x5a7792;if(_0x1c083c[_0x314804(0x409)]===-0x1)return;const _0x1cd465=_0x1c083c[_0x314804(0x11ce)][_0x1c083c['currentIndex']];if(!_0x1cd465)return;_0x1cd465[_0x314804(0x6d2)]=!_0x1cd465[_0x314804(0x6d2)],await _0x16961a();const _0xbf39ef=document[_0x314804(0x49c)](_0x314804(0xc4f)),_0x8f2efd=document['getElementById'](_0x314804(0x1387));_0xbf39ef[_0x314804(0x418)]['toggle'](_0x314804(0x9f),_0x1cd465[_0x314804(0x6d2)]),_0x8f2efd['classList']['toggle'](_0x314804(0x12ef),_0x1cd465['isBgClear']);}function _0x50d454(){const _0xca8314=_0x5a7792,_0x13c75a=document[_0xca8314(0x64f)]('music-player-avatar-display'),_0x34f417=document[_0xca8314(0x64f)](_0xca8314(0x85e));_0x13c75a&&_0x34f417&&(_0x13c75a[_0xca8314(0x418)][_0xca8314(0x5cf)](_0xca8314(0x40a)),_0x34f417['classList'][_0xca8314(0x5cf)](_0xca8314(0x12ef)));}function _0x3c5735(){const _0x190145=_0x5a7792,_0x377839=document[_0x190145(0x49c)]('.music-player-window'),_0x49e6dc=document[_0x190145(0x64f)](_0x190145(0xa8f));_0x377839&&_0x49e6dc&&(_0x377839[_0x190145(0x418)]['toggle'](_0x190145(0xffd)),_0x49e6dc['classList'][_0x190145(0x5cf)](_0x190145(0x5d9)));}window[_0x5a7792(0x10ad)]=_0x3c5735;async function _0x1a37ab(){const _0x3e2579=_0x5a7792;if(_0x1c083c[_0x3e2579(0x11ce)]['length']===0x0){alert(_0x3e2579(0x534));return;}const _0x4e74f0=await _0x54149f('确认清理无效歌曲？',_0x3e2579(0x1179),{'confirmText':_0x3e2579(0xbce)});if(!_0x4e74f0)return;await _0x28974b(_0x3e2579(0x2f7),_0x3e2579(0x10f5)+_0x1c083c[_0x3e2579(0x11ce)][_0x3e2579(0x40f)]+_0x3e2579(0x654));const _0x2ce708=_0x1c083c[_0x3e2579(0x11ce)]['length'],_0x3741a3=[],_0x3b37b9=[],_0x138939=_0x1c083c[_0x3e2579(0x11ce)][_0x3e2579(0xb96)](async _0x35e4e1=>{const _0x514e9e=_0x3e2579;if(_0x35e4e1[_0x514e9e(0x1102)]){_0x3741a3[_0x514e9e(0x13ee)](_0x35e4e1);return;}const _0x2fc5ff=await _0x56a229(_0x35e4e1[_0x514e9e(0xbe8)]);_0x2fc5ff?_0x3741a3[_0x514e9e(0x13ee)](_0x35e4e1):(_0x3b37b9[_0x514e9e(0x13ee)](_0x35e4e1['name']),console[_0x514e9e(0x1155)]('无效链接:\x20'+_0x35e4e1[_0x514e9e(0x6fc)]+_0x514e9e(0xc78)+_0x35e4e1[_0x514e9e(0xbe8)]));});await Promise[_0x3e2579(0xfd7)](_0x138939);const _0xffb9b7=_0x2ce708-_0x3741a3[_0x3e2579(0x40f)];if(_0xffb9b7>0x0){const _0xa15145=_0x1c083c[_0x3e2579(0x11ce)][_0x1c083c[_0x3e2579(0x409)]],_0xc8b994=_0x3b37b9[_0x3e2579(0xe53)](_0xa15145?.['name']);_0x1c083c[_0x3e2579(0x11ce)]=_0x3741a3,await _0x16961a();if(_0xc8b994)_0x51e4a1['pause'](),_0x51e4a1['src']='',_0x1c083c[_0x3e2579(0x409)]=_0x1c083c[_0x3e2579(0x11ce)][_0x3e2579(0x40f)]>0x0?0x0:-0x1,_0x1c083c['isPlaying']=![];else _0xa15145&&(_0x1c083c[_0x3e2579(0x409)]=_0x1c083c[_0x3e2579(0x11ce)][_0x3e2579(0x6a2)](_0x28bd56=>_0x28bd56[_0x3e2579(0xbe8)]===_0xa15145['src']));_0x36d83c(),_0x320333(),await _0x28974b(_0x3e2579(0x111),'成功移除了\x20'+_0xffb9b7+_0x3e2579(0x3f9)+_0x3b37b9[_0x3e2579(0xd22)]('\x0a-\x20'));}else await _0x28974b(_0x3e2579(0x10f4),_0x3e2579(0x141));}function _0x4e3634(){const _0x378552=_0x5a7792,_0x518777=document[_0x378552(0x64f)]('phone-screen');_0x518777[_0x378552(0x418)][_0x378552(0x5cf)](_0x378552(0xe66),!!_0x3e7a1b[_0x378552(0x11b4)]['showStatusBar']);}async function _0x33f749(){const _0x2072ce=_0x5a7792,_0x1b7c5e=document[_0x2072ce(0x64f)](_0x2072ce(0x6ea)),_0x143296=document[_0x2072ce(0x64f)](_0x2072ce(0x391));_0x143296[_0x2072ce(0xc58)]='';const _0x3de532=[];_0x3de532[_0x2072ce(0x13ee)]({'text':_0x2072ce(0xcd4),'value':'all','isDanger':!![]});const _0x31058d=_0x3e7a1b[_0x2072ce(0x3c2)]['nickname']||'我';_0x3de532[_0x2072ce(0x13ee)]({'text':'仅清空\x20'+_0x31058d+'\x20的动态\x20(用户)','value':_0x2072ce(0xa4d)}),Object[_0x2072ce(0xd6d)](_0x3e7a1b['chats'])[_0x2072ce(0x103)](_0x240a00=>{const _0x34dfd2=_0x2072ce;!_0x240a00['isGroup']&&_0x3de532[_0x34dfd2(0x13ee)]({'text':_0x34dfd2(0x112a)+_0x240a00['name']+_0x34dfd2(0x969),'value':_0x240a00['id']});});try{const _0x126227=await _0x4e1bbf[_0x2072ce(0xad7)]['toArray']();_0x126227[_0x2072ce(0x40f)]>0x0&&(_0x3de532[_0x2072ce(0x13ee)]({'isSeparator':!![],'text':_0x2072ce(0xb33)}),_0x126227[_0x2072ce(0x103)](_0x55d155=>{const _0x28b896=_0x2072ce;_0x3de532['push']({'text':_0x28b896(0x112a)+_0x55d155['name']+_0x28b896(0x100f),'value':_0x28b896(0x33e)+_0x55d155['id']});}));}catch(_0x5f3247){console[_0x2072ce(0xc60)](_0x2072ce(0x842),_0x5f3247);}_0x3de532['forEach'](_0x2c8f02=>{const _0x3707d8=_0x2072ce;if(_0x2c8f02[_0x3707d8(0x86b)]){const _0x5060aa=document[_0x3707d8(0x124e)](_0x3707d8(0x479));_0x5060aa['textContent']=_0x2c8f02[_0x3707d8(0x673)],_0x5060aa[_0x3707d8(0x731)][_0x3707d8(0x42f)]=_0x3707d8(0xdde),_0x143296[_0x3707d8(0x99e)](_0x5060aa);return;}const _0x3eb97d=document[_0x3707d8(0x124e)](_0x3707d8(0x479));_0x3eb97d[_0x3707d8(0x87d)]=_0x3707d8(0xf65),_0x2c8f02[_0x3707d8(0xf05)]&&_0x3eb97d['classList'][_0x3707d8(0xdda)]('danger-option'),_0x3eb97d[_0x3707d8(0x12e1)]['targetId']=_0x2c8f02[_0x3707d8(0xbed)],_0x3eb97d['innerHTML']=_0x3707d8(0x50c)+_0x2c8f02[_0x3707d8(0x673)]+_0x3707d8(0xd82),_0x143296[_0x3707d8(0x99e)](_0x3eb97d);}),_0x1b7c5e[_0x2072ce(0x418)][_0x2072ce(0xdda)](_0x2072ce(0x40a));}async function _0x19af58(){const _0x25c97e=_0x5a7792,_0x3a4b2c=document[_0x25c97e(0x233)](_0x25c97e(0xc06));if(_0x3a4b2c['length']===0x0){alert(_0x25c97e(0x346));return;}const _0x5c4530=Array[_0x25c97e(0xb3a)](_0x3a4b2c)[_0x25c97e(0xb96)](_0x404771=>_0x404771[_0x25c97e(0x12e1)]['targetId']);let _0x5ebe99=[];_0x5c4530['includes'](_0x25c97e(0xfd7))?_0x5ebe99[_0x25c97e(0x13ee)](_0x25c97e(0x436)):(_0x5c4530[_0x25c97e(0xe53)](_0x25c97e(0xa4d))&&_0x5ebe99[_0x25c97e(0x13ee)]('“'+_0x3e7a1b['qzoneSettings'][_0x25c97e(0x78c)]+'”'),_0x5c4530[_0x25c97e(0x103)](_0x2ef71f=>{const _0x31d2a1=_0x25c97e,_0x5717a0=_0x3e7a1b['chats'][_0x2ef71f];_0x5717a0&&_0x5ebe99['push']('“'+_0x5717a0[_0x31d2a1(0x6fc)]+'”');}));const _0x16999e=_0x25c97e(0xd37)+_0x5ebe99['join']('、\x20')+'\x20的所有动态，且无法恢复！',_0x2e0ffe=await _0x54149f(_0x25c97e(0x1e2),_0x16999e,{'confirmButtonClass':_0x25c97e(0xeed),'confirmText':_0x25c97e(0x2a0)});if(!_0x2e0ffe)return;try{_0x5c4530[_0x25c97e(0xe53)]('all')?await _0x4e1bbf['qzonePosts'][_0x25c97e(0x1057)]():await _0x4e1bbf['qzonePosts'][_0x25c97e(0xec9)](_0x25c97e(0x1188))[_0x25c97e(0x4a0)](_0x5c4530)[_0x25c97e(0x3aa)](),_0x10d3d6=await _0x4e1bbf['qzonePosts'][_0x25c97e(0xe1d)](_0x25c97e(0x8af))[_0x25c97e(0x2f4)]()['toArray'](),_0x2bcd5c=0x0,await _0x40e6dd(),document[_0x25c97e(0x64f)](_0x25c97e(0x6ea))[_0x25c97e(0x418)]['remove']('visible'),await _0x28974b('操作成功',_0x25c97e(0x309));}catch(_0x483cb7){console[_0x25c97e(0xc60)]('清空动态时出错:',_0x483cb7),await _0x28974b(_0x25c97e(0x5b1),_0x25c97e(0xaa4)+_0x483cb7[_0x25c97e(0x854)]);}}async function _0x4918a7(_0x1efbcf){const _0x51bafe=_0x5a7792,_0x11a4a3=await _0x54149f('确认删除',_0x51bafe(0xcd0),{'confirmButtonClass':_0x51bafe(0xeed),'confirmText':'确认删除'});if(_0x11a4a3){const _0x5f3d1e=_0x3e7a1b[_0x51bafe(0x999)][_0x3e7a1b['activeChatId']];if(!_0x5f3d1e||!_0x5f3d1e[_0x51bafe(0x7ea)])return;const _0x1c6835=_0x5f3d1e[_0x51bafe(0x7ea)][_0x51bafe(0x6a2)](_0x79dc1=>_0x79dc1['timestamp']===_0x1efbcf);if(_0x1c6835===-0x1)return;const _0x39fa96=_0x1c6835===_0x5f3d1e['thoughtsHistory'][_0x51bafe(0x40f)]-0x1;_0x5f3d1e[_0x51bafe(0x7ea)]=_0x5f3d1e[_0x51bafe(0x7ea)][_0x51bafe(0x156)](_0x446b09=>_0x446b09['timestamp']!==_0x1efbcf);if(_0x39fa96){if(_0x5f3d1e[_0x51bafe(0x7ea)][_0x51bafe(0x40f)]>0x0){const _0x1d85f2=_0x5f3d1e[_0x51bafe(0x7ea)][_0x5f3d1e[_0x51bafe(0x7ea)][_0x51bafe(0x40f)]-0x1];_0x5f3d1e[_0x51bafe(0x12d9)]=_0x1d85f2[_0x51bafe(0x12d9)],_0x5f3d1e[_0x51bafe(0xb9d)]=_0x1d85f2[_0x51bafe(0xb9d)];const _0x4c542f=document[_0x51bafe(0x64f)]('profile-heartfelt-voice'),_0x5370aa=document[_0x51bafe(0x64f)](_0x51bafe(0xf1f));if(_0x4c542f)_0x4c542f[_0x51bafe(0xee5)]=_0x5f3d1e['heartfeltVoice'];if(_0x5370aa)_0x5370aa[_0x51bafe(0xee5)]=_0x5f3d1e[_0x51bafe(0xb9d)];console[_0x51bafe(0x1081)]('已删除最新心声，当前心声已回滚至上一条。');}else{_0x5f3d1e[_0x51bafe(0x12d9)]='...',_0x5f3d1e[_0x51bafe(0xb9d)]=_0x51bafe(0x3cd);const _0x3505ad=document[_0x51bafe(0x64f)](_0x51bafe(0x1302)),_0x23f92e=document[_0x51bafe(0x64f)](_0x51bafe(0xf1f));if(_0x3505ad)_0x3505ad['textContent']=_0x5f3d1e[_0x51bafe(0x12d9)];if(_0x23f92e)_0x23f92e[_0x51bafe(0xee5)]=_0x5f3d1e[_0x51bafe(0xb9d)];console[_0x51bafe(0x1081)](_0x51bafe(0x1219));}}await _0x4e1bbf['chats'][_0x51bafe(0x4fa)](_0x5f3d1e),_0x5b5c7d(),await _0x28974b('成功',_0x51bafe(0x437));}}document[_0x5a7792(0x64f)]('thoughts-history-list')[_0x5a7792(0xf72)]('click',_0x418abf=>{const _0x3d4684=_0x5a7792,_0x530e0e=_0x418abf[_0x3d4684(0xf5b)][_0x3d4684(0x2fc)]('.thought-delete-btn');if(_0x530e0e){const _0x14c2db=parseInt(_0x530e0e[_0x3d4684(0x12e1)][_0x3d4684(0x8af)]);!isNaN(_0x14c2db)&&_0x4918a7(_0x14c2db);}});async function _0x34a203(){const _0x3efe06=_0x5a7792,_0x3292cf=document[_0x3efe06(0x64f)](_0x3efe06(0x119));_0x3292cf[_0x3efe06(0xc58)]=_0x3efe06(0x189);const _0x4d19d8=await _0x4e1bbf[_0x3efe06(0x1032)][_0x3efe06(0xec9)](_0x3efe06(0xafc))[_0x3efe06(0x11cd)](_0x3efe06(0xb7))[_0x3efe06(0x78f)]();_0x4d19d8[_0x3efe06(0x103)](_0x4654a0=>{const _0x2c098c=_0x3efe06,_0x42363f=document[_0x2c098c(0x124e)]('option');_0x42363f[_0x2c098c(0xbed)]=_0x4654a0['id'],_0x42363f[_0x2c098c(0xee5)]=_0x4654a0['name'],_0x3292cf[_0x2c098c(0x99e)](_0x42363f);});}async function _0x22b9f2(){const _0x556c1b=_0x5a7792,_0x105019=document['getElementById'](_0x556c1b(0x119)),_0x593952=parseInt(_0x105019[_0x556c1b(0xbed)]);if(isNaN(_0x593952))return;const _0x33fd05=await _0x4e1bbf[_0x556c1b(0x1032)]['get'](_0x593952);if(_0x33fd05){const _0x9e9d6c=document['getElementById'](_0x556c1b(0x1b6));_0x9e9d6c['value']=_0x33fd05[_0x556c1b(0xbed)],_0x39cff1(_0x33fd05['value']);}}async function _0xb60f61(){const _0x5d6c64=_0x5a7792,_0x5d568f=await _0x41e3f8(_0x5d6c64(0x1260),'请输入预设名称');if(!_0x5d568f||!_0x5d568f['trim']())return;const _0x306e19=document['getElementById'](_0x5d6c64(0x1b6))['value'],_0x317caa=await _0x4e1bbf[_0x5d6c64(0x1032)][_0x5d6c64(0xec9)]({'name':_0x5d568f[_0x5d6c64(0x43a)](),'type':_0x5d6c64(0xb7)})['first']();if(_0x317caa){const _0x1a8d90=await _0x54149f('覆盖预设',_0x5d6c64(0x1189)+_0x5d568f[_0x5d6c64(0x43a)]()+_0x5d6c64(0x862),{'confirmButtonClass':'btn-danger'});if(!_0x1a8d90)return;await _0x4e1bbf[_0x5d6c64(0x1032)][_0x5d6c64(0x32e)](_0x317caa['id'],{'value':_0x306e19});}else await _0x4e1bbf[_0x5d6c64(0x1032)][_0x5d6c64(0xdda)]({'name':_0x5d568f['trim'](),'type':_0x5d6c64(0xb7),'value':_0x306e19});await _0x34a203(),alert('CSS\x20预设已保存！');}async function _0x13a8ca(){const _0x3fd1c2=_0x5a7792,_0x579a2d=document[_0x3fd1c2(0x64f)]('css-preset-select'),_0x3acc6f=parseInt(_0x579a2d[_0x3fd1c2(0xbed)]);if(isNaN(_0x3acc6f)){alert(_0x3fd1c2(0x677));return;}const _0x586b6d=await _0x4e1bbf[_0x3fd1c2(0x1032)][_0x3fd1c2(0x11fc)](_0x3acc6f);if(!_0x586b6d)return;const _0x23f22a=await _0x54149f(_0x3fd1c2(0xd87),'确定要删除预设\x20“'+_0x586b6d[_0x3fd1c2(0x6fc)]+_0x3fd1c2(0x2dc),{'confirmButtonClass':_0x3fd1c2(0xeed)});_0x23f22a&&(await _0x4e1bbf[_0x3fd1c2(0x1032)][_0x3fd1c2(0x3aa)](_0x3acc6f),await _0x34a203(),alert(_0x3fd1c2(0x13ea)));}async function _0x1d9c51(){const _0x35c4f9=_0x5a7792,_0x169012=document[_0x35c4f9(0x64f)](_0x35c4f9(0x1d5));_0x169012[_0x35c4f9(0xc58)]=_0x35c4f9(0x189);const _0x515ca2=await _0x4e1bbf[_0x35c4f9(0x1032)]['where'](_0x35c4f9(0xafc))['equals'](_0x35c4f9(0x14b))[_0x35c4f9(0x78f)]();_0x515ca2[_0x35c4f9(0x103)](_0x2b0668=>{const _0xe3068d=_0x35c4f9,_0x599801=document['createElement'](_0xe3068d(0x1176));_0x599801[_0xe3068d(0xbed)]=_0x2b0668['id'],_0x599801[_0xe3068d(0xee5)]=_0x2b0668['name'],_0x169012[_0xe3068d(0x99e)](_0x599801);});}async function _0x3b28d9(){const _0x37121b=_0x5a7792,_0x2f9d4f=document['getElementById']('font-preset-select'),_0x4aed04=parseInt(_0x2f9d4f[_0x37121b(0xbed)]);if(isNaN(_0x4aed04))return;const _0xeb1ee4=await _0x4e1bbf['appearancePresets'][_0x37121b(0x11fc)](_0x4aed04);if(_0xeb1ee4){const _0x466f22=document[_0x37121b(0x64f)](_0x37121b(0xd18));_0x466f22[_0x37121b(0xbed)]=_0xeb1ee4[_0x37121b(0xbed)],_0x397027(_0xeb1ee4['value'],!![]);}}async function _0x32da0b(){const _0x44e13d=_0x5a7792,_0xd6cbc4=await _0x41e3f8(_0x44e13d(0xf11),_0x44e13d(0x58a));if(!_0xd6cbc4||!_0xd6cbc4[_0x44e13d(0x43a)]())return;const _0x596c35=document[_0x44e13d(0x64f)](_0x44e13d(0xd18))[_0x44e13d(0xbed)][_0x44e13d(0x43a)]();if(!_0x596c35){alert('字体URL不能为空！');return;}const _0x3bc584=await _0x4e1bbf[_0x44e13d(0x1032)][_0x44e13d(0xec9)]({'name':_0xd6cbc4[_0x44e13d(0x43a)](),'type':_0x44e13d(0x14b)})[_0x44e13d(0x5dd)]();if(_0x3bc584){const _0x5c6c77=await _0x54149f(_0x44e13d(0x260),_0x44e13d(0x1189)+_0xd6cbc4[_0x44e13d(0x43a)]()+_0x44e13d(0x862),{'confirmButtonClass':'btn-danger'});if(!_0x5c6c77)return;await _0x4e1bbf[_0x44e13d(0x1032)][_0x44e13d(0x32e)](_0x3bc584['id'],{'value':_0x596c35});}else await _0x4e1bbf[_0x44e13d(0x1032)][_0x44e13d(0xdda)]({'name':_0xd6cbc4[_0x44e13d(0x43a)](),'type':_0x44e13d(0x14b),'value':_0x596c35});await _0x1d9c51(),alert(_0x44e13d(0x12ed));}async function _0x1fe802(){const _0x3724c9=_0x5a7792,_0x2c70bc=document['getElementById']('font-preset-select'),_0x3f911a=parseInt(_0x2c70bc[_0x3724c9(0xbed)]);if(isNaN(_0x3f911a)){alert(_0x3724c9(0x677));return;}const _0x13ff25=await _0x4e1bbf['appearancePresets'][_0x3724c9(0x11fc)](_0x3f911a);if(!_0x13ff25)return;const _0x3d7130=await _0x54149f(_0x3724c9(0xd87),_0x3724c9(0xd3d)+_0x13ff25[_0x3724c9(0x6fc)]+_0x3724c9(0x2dc),{'confirmButtonClass':_0x3724c9(0xeed)});_0x3d7130&&(await _0x4e1bbf['appearancePresets'][_0x3724c9(0x3aa)](_0x3f911a),await _0x1d9c51(),alert(_0x3724c9(0x13ea)));}async function _0x3dac19(){const _0x574d01=_0x5a7792,_0xdc0538=document[_0x574d01(0x64f)](_0x574d01(0x529));_0xdc0538[_0x574d01(0xc58)]=_0x574d01(0x189);const _0x3ec7db=await _0x4e1bbf[_0x574d01(0x1032)][_0x574d01(0xec9)](_0x574d01(0xafc))[_0x574d01(0x11cd)](_0x574d01(0x947))[_0x574d01(0x78f)]();_0x3ec7db[_0x574d01(0x103)](_0x2e1d22=>{const _0x23fe67=_0x574d01,_0x48f91c=document[_0x23fe67(0x124e)](_0x23fe67(0x1176));_0x48f91c[_0x23fe67(0xbed)]=_0x2e1d22['id'],_0x48f91c[_0x23fe67(0xee5)]=_0x2e1d22[_0x23fe67(0x6fc)],_0xdc0538[_0x23fe67(0x99e)](_0x48f91c);});const _0x19f64b={'wallpaper':_0x3e7a1b['globalSettings']['wallpaper'],'cphoneWallpaper':_0x3e7a1b[_0x574d01(0x11b4)][_0x574d01(0xcbc)],'globalChatBackground':_0x3e7a1b[_0x574d01(0x11b4)][_0x574d01(0xcb4)],'appIcons':_0x3e7a1b[_0x574d01(0x11b4)]['appIcons'],'cphoneAppIcons':_0x3e7a1b[_0x574d01(0x11b4)]['cphoneAppIcons'],'chatActionButtonsOrder':_0x3e7a1b[_0x574d01(0x11b4)][_0x574d01(0x502)],'theme':localStorage[_0x574d01(0x2f5)](_0x574d01(0xae6))||_0x574d01(0xa4c),'showStatusBar':_0x3e7a1b['globalSettings'][_0x574d01(0x390)],'notificationSoundUrl':_0x3e7a1b[_0x574d01(0x11b4)][_0x574d01(0xe5f)],'widgetData':_0x3e7a1b['globalSettings']['widgetData']};let _0x4d4950=null;for(const _0x3fe3fe of _0x3ec7db){if(JSON[_0x574d01(0xe3f)](_0x3fe3fe[_0x574d01(0xbed)])===JSON[_0x574d01(0xe3f)](_0x19f64b)){_0x4d4950=_0x3fe3fe['id'];break;}}_0x4d4950?_0xdc0538[_0x574d01(0xbed)]=_0x4d4950:_0xdc0538[_0x574d01(0xbed)]='';}async function _0x1f55e8(){const _0x30229b=_0x5a7792,_0x2bdce4=document[_0x30229b(0x64f)](_0x30229b(0x529)),_0x126b00=parseInt(_0x2bdce4[_0x30229b(0xbed)]);if(isNaN(_0x126b00))return;const _0x2f962=await _0x4e1bbf[_0x30229b(0x1032)][_0x30229b(0x11fc)](_0x126b00);if(_0x2f962&&_0x2f962[_0x30229b(0xbed)]){const _0x4b9875=_0x2f962[_0x30229b(0xbed)];Object[_0x30229b(0x27d)](_0x3e7a1b[_0x30229b(0x11b4)],_0x4b9875),_0x2f9ff9(_0x4b9875[_0x30229b(0xb3d)]||_0x30229b(0xa4c)),await _0x4e1bbf['globalSettings'][_0x30229b(0x4fa)](_0x3e7a1b[_0x30229b(0x11b4)]),_0x11d2f9(),_0x16a875(),_0x5dc542(),_0x5f4cf3(),_0x4e3634(),_0x320954(),_0x309ef1(),alert(_0x30229b(0x63e)+_0x2f962[_0x30229b(0x6fc)]+'”');}}async function _0x37232c(){const _0x3fc5d0=_0x5a7792,_0x3b2216=await _0x41e3f8('保存外观预设',_0x3fc5d0(0x58a));if(!_0x3b2216||!_0x3b2216[_0x3fc5d0(0x43a)]())return;const _0x40367f={'wallpaper':_0x3e7a1b[_0x3fc5d0(0x11b4)][_0x3fc5d0(0x6fe)],'cphoneWallpaper':_0x3e7a1b[_0x3fc5d0(0x11b4)][_0x3fc5d0(0xcbc)],'globalChatBackground':_0x3e7a1b[_0x3fc5d0(0x11b4)][_0x3fc5d0(0xcb4)],'appIcons':_0x3e7a1b[_0x3fc5d0(0x11b4)]['appIcons'],'cphoneAppIcons':_0x3e7a1b['globalSettings']['cphoneAppIcons'],'chatActionButtonsOrder':_0x3e7a1b['globalSettings'][_0x3fc5d0(0x502)],'theme':localStorage[_0x3fc5d0(0x2f5)](_0x3fc5d0(0xae6))||_0x3fc5d0(0xa4c),'showStatusBar':_0x3e7a1b[_0x3fc5d0(0x11b4)][_0x3fc5d0(0x390)],'notificationSoundUrl':_0x3e7a1b['globalSettings']['notificationSoundUrl'],'widgetData':_0x3e7a1b['globalSettings'][_0x3fc5d0(0x9cc)]},_0x23b9f9=await _0x4e1bbf['appearancePresets'][_0x3fc5d0(0xec9)]({'name':_0x3b2216[_0x3fc5d0(0x43a)](),'type':_0x3fc5d0(0x947)})[_0x3fc5d0(0x5dd)]();if(_0x23b9f9){const _0x33d712=await _0x54149f('覆盖预设',_0x3fc5d0(0x1189)+_0x3b2216[_0x3fc5d0(0x43a)]()+'”\x20的预设已存在。要覆盖它吗？',{'confirmButtonClass':'btn-danger'});if(!_0x33d712)return;await _0x4e1bbf[_0x3fc5d0(0x1032)][_0x3fc5d0(0x32e)](_0x23b9f9['id'],{'value':_0x40367f});}else await _0x4e1bbf[_0x3fc5d0(0x1032)][_0x3fc5d0(0xdda)]({'name':_0x3b2216[_0x3fc5d0(0x43a)](),'type':_0x3fc5d0(0x947),'value':_0x40367f});await _0x3dac19(),alert(_0x3fc5d0(0xba5));}async function _0x2327a9(){const _0x26d774=_0x5a7792,_0x187788=document[_0x26d774(0x64f)]('appearance-preset-select'),_0x1c23eb=parseInt(_0x187788['value']);if(isNaN(_0x1c23eb)){alert(_0x26d774(0x677));return;}const _0x23aa31=await _0x4e1bbf['appearancePresets'][_0x26d774(0x11fc)](_0x1c23eb);if(!_0x23aa31)return;const _0x55fa20=await _0x54149f(_0x26d774(0xd87),_0x26d774(0xd3d)+_0x23aa31[_0x26d774(0x6fc)]+_0x26d774(0x2dc),{'confirmButtonClass':_0x26d774(0xeed)});_0x55fa20&&(await _0x4e1bbf[_0x26d774(0x1032)][_0x26d774(0x3aa)](_0x1c23eb),await _0x3dac19(),alert(_0x26d774(0x13ea)));}async function _0x1e1ae9(){const _0xfc2461=_0x5a7792,_0x4bd3ad=document['getElementById'](_0xfc2461(0x326));_0x4bd3ad[_0xfc2461(0xc58)]=_0xfc2461(0x189);const _0x50a58b=await _0x4e1bbf[_0xfc2461(0x1032)][_0xfc2461(0xec9)](_0xfc2461(0xafc))[_0xfc2461(0x11cd)](_0xfc2461(0x191))[_0xfc2461(0x78f)]();_0x50a58b[_0xfc2461(0x103)](_0x4549d9=>{const _0x4d3cb3=_0xfc2461,_0xa61f91=document[_0x4d3cb3(0x124e)]('option');_0xa61f91['value']=_0x4549d9['id'],_0xa61f91[_0x4d3cb3(0xee5)]=_0x4549d9['name'],_0x4bd3ad[_0x4d3cb3(0x99e)](_0xa61f91);});}async function _0x222103(){const _0xda01a6=_0x5a7792,_0x11653b=document[_0xda01a6(0x64f)](_0xda01a6(0x326)),_0x17d6eb=parseInt(_0x11653b['value']);if(isNaN(_0x17d6eb))return;const _0x149fa3=await _0x4e1bbf[_0xda01a6(0x1032)]['get'](_0x17d6eb);if(_0x149fa3){const _0x442997=_0x149fa3[_0xda01a6(0xbed)][_0xda01a6(0x13ba)]||_0xda01a6(0xf5d),_0x129610=_0x149fa3[_0xda01a6(0xbed)][_0xda01a6(0xea0)]||'',_0x176855=document[_0xda01a6(0x49c)](_0xda01a6(0x35c)+_0x442997+'\x22]');_0x176855&&(_0x176855['checked']=!![]);const _0x2a6cc5=document[_0xda01a6(0x64f)](_0xda01a6(0x13a0));_0x2a6cc5[_0xda01a6(0xbed)]=_0x129610,_0x29eae3();}}async function _0x2ce3ab(){const _0x1dc981=_0x5a7792,_0x48096f=await _0x41e3f8('保存主题预设',_0x1dc981(0x58a));if(!_0x48096f||!_0x48096f[_0x1dc981(0x43a)]())return;const _0x5afe05=document['querySelector'](_0x1dc981(0x1301)),_0x30073e=_0x5afe05?_0x5afe05[_0x1dc981(0xbed)]:_0x1dc981(0xf5d),_0x4664df=document[_0x1dc981(0x64f)](_0x1dc981(0x13a0))[_0x1dc981(0xbed)][_0x1dc981(0x43a)](),_0x3a3040={'base':_0x30073e,'custom':_0x4664df},_0x1de695=await _0x4e1bbf[_0x1dc981(0x1032)][_0x1dc981(0xec9)]({'name':_0x48096f['trim'](),'type':_0x1dc981(0x191)})[_0x1dc981(0x5dd)]();if(_0x1de695){const _0x24a52b=await _0x54149f('覆盖预设',_0x1dc981(0x1189)+_0x48096f[_0x1dc981(0x43a)]()+_0x1dc981(0x862),{'confirmButtonClass':_0x1dc981(0xeed)});if(!_0x24a52b)return;await _0x4e1bbf[_0x1dc981(0x1032)][_0x1dc981(0x32e)](_0x1de695['id'],{'value':_0x3a3040});}else await _0x4e1bbf['appearancePresets'][_0x1dc981(0xdda)]({'name':_0x48096f[_0x1dc981(0x43a)](),'type':_0x1dc981(0x191),'value':_0x3a3040});await _0x1e1ae9(),alert(_0x1dc981(0x401));}async function _0x3d0697(){const _0x2e3e3d=_0x5a7792,_0x39d5ec=document[_0x2e3e3d(0x64f)](_0x2e3e3d(0x326)),_0x275c07=parseInt(_0x39d5ec['value']);if(isNaN(_0x275c07)){alert(_0x2e3e3d(0x677));return;}const _0x4b7486=await _0x4e1bbf[_0x2e3e3d(0x1032)][_0x2e3e3d(0x11fc)](_0x275c07);if(!_0x4b7486)return;const _0x2cd24d=await _0x54149f(_0x2e3e3d(0xd87),_0x2e3e3d(0xd3d)+_0x4b7486['name']+'”\x20吗？',{'confirmButtonClass':_0x2e3e3d(0xeed)});_0x2cd24d&&(await _0x4e1bbf[_0x2e3e3d(0x1032)][_0x2e3e3d(0x3aa)](_0x275c07),await _0x1e1ae9(),alert(_0x2e3e3d(0x13ea)));}async function _0x33e846(){const _0x2c3ab7=_0x5a7792;await _0x26c540(),document[_0x2c3ab7(0x64f)]('sticker-category-manager-modal')[_0x2c3ab7(0x418)]['add'](_0x2c3ab7(0x40a));}async function _0x26c540(){const _0x449c39=_0x5a7792,_0xbf582f=document[_0x449c39(0x64f)](_0x449c39(0x11c8)),_0x6817fb=await _0x4e1bbf[_0x449c39(0xd8d)][_0x449c39(0x78f)]();_0xbf582f[_0x449c39(0xc58)]='';if(_0x6817fb[_0x449c39(0x40f)]===0x0){_0xbf582f[_0x449c39(0xc58)]='<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-secondary);\x22>还没有任何分类</p>';return;}_0x6817fb[_0x449c39(0x103)](_0x14e50e=>{const _0x20ad59=_0x449c39,_0x13f929=document[_0x20ad59(0x124e)](_0x20ad59(0x479));_0x13f929[_0x20ad59(0x87d)]='existing-group-item',_0x13f929['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22group-name\x22>'+_0x14e50e[_0x20ad59(0x6fc)]+_0x20ad59(0x138d)+_0x14e50e['id']+_0x20ad59(0x9fd),_0xbf582f[_0x20ad59(0x99e)](_0x13f929);});}async function _0x6753ea(){const _0x254e83=_0x5a7792,_0x50d543=document[_0x254e83(0x64f)](_0x254e83(0x551)),_0x15a663=_0x50d543[_0x254e83(0xbed)][_0x254e83(0x43a)]();if(!_0x15a663){alert('分类名不能为空！');return;}const _0x55f433=await _0x4e1bbf['stickerCategories'][_0x254e83(0xec9)](_0x254e83(0x6fc))['equals'](_0x15a663)[_0x254e83(0x5dd)]();if(_0x55f433){alert(_0x254e83(0x1095)+_0x15a663+_0x254e83(0xc4e));return;}await _0x4e1bbf[_0x254e83(0xd8d)]['add']({'name':_0x15a663}),_0x50d543[_0x254e83(0xbed)]='',await _0x26c540();}async function _0x1410bb(_0x3dc238){const _0x265f04=_0x5a7792,_0x294c8c=await _0x4e1bbf['stickerCategories'][_0x265f04(0x11fc)](_0x3dc238);if(!_0x294c8c)return;const _0x1307a5=await _0x4e1bbf['userStickers'][_0x265f04(0xec9)]('categoryId')[_0x265f04(0x11cd)](_0x3dc238)['count'](),_0x623037=_0x1307a5>0x0?_0x265f04(0xc95)+_0x294c8c[_0x265f04(0x6fc)]+_0x265f04(0x313)+_0x1307a5+_0x265f04(0x1330):_0x265f04(0xc95)+_0x294c8c['name']+_0x265f04(0x6ee),_0x3c0e74=await _0x54149f('确认删除分类',_0x623037,{'confirmButtonClass':'btn-danger'});if(_0x3c0e74)try{await _0x4e1bbf['transaction']('rw',_0x4e1bbf[_0x265f04(0xd8d)],_0x4e1bbf[_0x265f04(0xa8b)],async()=>{const _0x4f13dd=_0x265f04,_0x305152=await _0x4e1bbf['userStickers']['where'](_0x4f13dd(0xcd3))[_0x4f13dd(0x11cd)](_0x3dc238)[_0x4f13dd(0xd3a)]();_0x305152[_0x4f13dd(0x40f)]>0x0&&await _0x4e1bbf[_0x4f13dd(0xa8b)]['bulkDelete'](_0x305152),await _0x4e1bbf['stickerCategories'][_0x4f13dd(0x3aa)](_0x3dc238);}),_0x3e7a1b[_0x265f04(0xa8b)]=await _0x4e1bbf['userStickers'][_0x265f04(0x78f)](),_0x110329===_0x3dc238&&(_0x110329=_0x265f04(0xfd7)),await _0x26c540(),await _0x8ea9d0(),alert(_0x265f04(0xeef)+_0x294c8c['name']+_0x265f04(0xfa6));}catch(_0x1447a4){console[_0x265f04(0xc60)]('删除分类及表情时出错:',_0x1447a4),alert(_0x265f04(0x358));}}function _0x3defe2(_0xddf504){const _0x5228dc=_0x5a7792;_0x110329=_0xddf504,document[_0x5228dc(0x233)](_0x5228dc(0xee3))['forEach'](_0x5599ab=>{const _0x1a3962=_0x5228dc;_0x5599ab[_0x1a3962(0x418)][_0x1a3962(0x5cf)](_0x1a3962(0x12ef),String(_0x5599ab[_0x1a3962(0x12e1)][_0x1a3962(0xcd3)])===String(_0xddf504));}),_0x8ea9d0(![]);const _0x2c4db1=document[_0x5228dc(0x64f)](_0x5228dc(0x1135));if(_0x2c4db1)_0x2c4db1[_0x5228dc(0xf1d)]=![];}async function _0x1ad24e(){const _0x17c65d=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x4ab5dd=_0x3e7a1b['chats'][_0x3e7a1b[_0x17c65d(0x777)]];if(!_0x4ab5dd)return;try{const _0xa5b0f3={'type':'EPhoneSingleChat','version':0x1,'chatData':_0x4ab5dd},_0x1a20ea=new Blob([JSON[_0x17c65d(0xe3f)](_0xa5b0f3,null,0x2)],{'type':_0x17c65d(0x7fe)}),_0x55fab1=URL['createObjectURL'](_0x1a20ea),_0x289f58=document[_0x17c65d(0x124e)]('a');_0x289f58[_0x17c65d(0x1210)]=_0x55fab1,_0x289f58['download']='EPhone-Chat-'+_0x4ab5dd[_0x17c65d(0x6fc)]+'-'+new Date()[_0x17c65d(0x5f8)]()[_0x17c65d(0x108c)]('T')[0x0]+_0x17c65d(0xec),_0x289f58[_0x17c65d(0x1080)](),URL[_0x17c65d(0x74f)](_0x55fab1),await _0x28974b(_0x17c65d(0x43f),'与“'+_0x4ab5dd[_0x17c65d(0x6fc)]+_0x17c65d(0xfc1));}catch(_0x1bc87){console[_0x17c65d(0xc60)]('导出单个聊天时出错:',_0x1bc87),await _0x28974b(_0x17c65d(0xf17),_0x17c65d(0xcba)+_0x1bc87['message']);}}async function _0x2ad236(_0x3ae62c){const _0x183948=_0x5a7792;if(!_0x3ae62c||!_0x3e7a1b[_0x183948(0x777)])return;const _0x1e42cd=_0x3e7a1b[_0x183948(0x777)],_0x22dd76=_0x3e7a1b[_0x183948(0x999)][_0x1e42cd];try{const _0x53a694=await _0x3ae62c[_0x183948(0x673)](),_0x2ec0ee=JSON[_0x183948(0x1214)](_0x53a694);if(_0x2ec0ee[_0x183948(0xafc)]!==_0x183948(0xd42)||!_0x2ec0ee['chatData'])throw new Error(_0x183948(0x12b0));const _0xe06345=await _0x54149f(_0x183948(0xf68),_0x183948(0xc81)+_0x22dd76[_0x183948(0x6fc)]+_0x183948(0x7db),{'confirmButtonClass':_0x183948(0xeed),'confirmText':_0x183948(0x1061)});if(!_0xe06345)return;const _0x34e76e=_0x2ec0ee[_0x183948(0xe33)];_0x34e76e['id']=_0x1e42cd,await _0x4e1bbf[_0x183948(0x999)][_0x183948(0x4fa)](_0x34e76e),_0x3e7a1b['chats'][_0x1e42cd]=_0x34e76e,await _0x28974b('导入成功',_0x183948(0x4be)),_0x4817d1(_0x1e42cd),_0x21f6ea(),document[_0x183948(0x64f)](_0x183948(0x11c4))[_0x183948(0x1080)]();}catch(_0x1f34bc){console[_0x183948(0xc60)](_0x183948(0x9c6),_0x1f34bc),await _0x28974b(_0x183948(0xae3),_0x183948(0xde)+_0x1f34bc['message']);}}function _0x3342b4(){const _0x28bd9f=_0x5a7792;_0x1d6a02(),_0xddd8ae(_0x28bd9f(0x10a9));}function _0x1d6a02(){const _0x298a65=_0x5a7792,_0x178afa=document['getElementById'](_0x298a65(0x6a1));_0x178afa['innerHTML']='';const _0x30ae00=Object[_0x298a65(0xd6d)](_0x3e7a1b[_0x298a65(0x999)])[_0x298a65(0x156)](_0x4cbacc=>!_0x4cbacc[_0x298a65(0x1167)]);if(_0x30ae00[_0x298a65(0x40f)]===0x0){_0x178afa['innerHTML']=_0x298a65(0xdd4);return;}_0x30ae00['forEach'](_0xccd164=>{const _0x3d0474=_0x298a65,_0x1e1ee7=document['createElement'](_0x3d0474(0x479));_0x1e1ee7[_0x3d0474(0x87d)]=_0x3d0474(0x11c7),_0x1e1ee7['innerHTML']=_0x3d0474(0xa8d)+(_0xccd164[_0x3d0474(0xcb3)][_0x3d0474(0x93)]||_0x54e358)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0xccd164[_0x3d0474(0x6fc)]+_0x3d0474(0xd82),_0x1e1ee7[_0x3d0474(0xf72)](_0x3d0474(0x1080),()=>_0x5ef715(_0xccd164['id'])),_0x178afa[_0x3d0474(0x99e)](_0x1e1ee7);});}async function _0x5ef715(_0x45e7c7){const _0x3dd053=_0x5a7792;_0x10ae3d=_0x45e7c7,console[_0x3dd053(0x1081)](_0x3dd053(0xf04)+_0x45e7c7+'\x20的手机'),_0x16a875(),_0x5f4cf3(),_0x58d2b5(),_0xddd8ae(_0x3dd053(0xed5));}function _0x30fea4(){const _0x56c8b9=_0x5a7792;_0x10ae3d=null,console[_0x56c8b9(0x1081)](_0x56c8b9(0xb9e)),_0xddd8ae(_0x56c8b9(0xd89));}function _0x58d2b5(){const _0xc0ced8=_0x5a7792,_0x22db23=new Date(),_0x15d5f8=_0x22db23['toLocaleTimeString'](_0xc0ced8(0x6ec),{'hour':_0xc0ced8(0xe3e),'minute':'2-digit'}),_0x3b1e95=_0x22db23[_0xc0ced8(0x16c)](_0xc0ced8(0x6ec),{'weekday':_0xc0ced8(0x572),'month':_0xc0ced8(0x572),'day':_0xc0ced8(0x1229)});document[_0xc0ced8(0x64f)]('char-main-time')[_0xc0ced8(0xee5)]=_0x15d5f8,document['getElementById'](_0xc0ced8(0xd29))[_0xc0ced8(0xee5)]=_0x3b1e95,_0xdfc697(_0xc0ced8(0x55e));}function _0xdfc697(_0x380017){const _0x57cc8d=_0x5a7792;document['querySelectorAll'](_0x57cc8d(0xc9))[_0x57cc8d(0x103)](_0x5884fc=>_0x5884fc[_0x57cc8d(0x418)]['remove'](_0x57cc8d(0x12ef))),document[_0x57cc8d(0x64f)](_0x380017)['classList']['add'](_0x57cc8d(0x12ef));}window[_0x5a7792(0x9f1)]=_0xdfc697;async function _0x2208c6(_0x2d96dd){const _0x228458=_0x5a7792;if(!_0x10ae3d)return;const _0x34367c=_0x3e7a1b[_0x228458(0x999)][_0x10ae3d];await _0x2c80a9(_0x10ae3d,_0x2d96dd);switch(_0x2d96dd){case'qq':_0x4cdae1(),_0xdfc697('char-qq-screen');break;case _0x228458(0x603):_0x314a4a(),_0xdfc697(_0x228458(0x56f));break;case'browser':_0x2a38dc(),_0xdfc697(_0x228458(0x281));break;case _0x228458(0x128e):_0x59a86c(),_0xdfc697(_0x228458(0x12f9));break;case _0x228458(0xeff):_0x2c8f58(),_0xdfc697(_0x228458(0x13e3));break;case'diary':_0x498f46(),_0xdfc697(_0x228458(0xab1));break;case _0x228458(0x147):_0x44217f(),_0xdfc697(_0x228458(0xc26));break;case _0x228458(0xb0e):_0x472563(),_0xdfc697('char-music-screen');break;case'usage':_0x1fab74(),_0xdfc697('char-usage-screen');break;}}async function _0x314a4a(){const _0x3069e8=_0x5a7792,_0x5b2666=document['getElementById'](_0x3069e8(0xb66));_0x5b2666[_0x3069e8(0xc58)]='';if(!_0x10ae3d)return;const _0x170a79=_0x3e7a1b[_0x3069e8(0x999)][_0x10ae3d],_0x43f634=_0x170a79[_0x3069e8(0xbd1)]||[];if(_0x43f634['length']===0x0){_0x5b2666[_0x3069e8(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的相册还是空的，<br>点击右上角刷新按钮生成一些照片吧！</p>';return;}const _0x374a79=_0x3069e8(0x716);_0x43f634[_0x3069e8(0x103)](_0xddf38d=>{const _0x3ba0ce=_0x3069e8,_0x2d6607=document[_0x3ba0ce(0x124e)](_0x3ba0ce(0x479));_0x2d6607['className']=_0x3ba0ce(0xed4),_0x2d6607[_0x3ba0ce(0x12e1)][_0x3ba0ce(0x9af)]=_0xddf38d[_0x3ba0ce(0x9af)],_0x5b2666['appendChild'](_0x2d6607);if(_0x3e7a1b[_0x3ba0ce(0x11b4)][_0x3ba0ce(0xc83)]){_0x2d6607[_0x3ba0ce(0x731)][_0x3ba0ce(0xfd6)]=_0x3ba0ce(0xf2d);const _0x3fd821=/[^\x00-\x7F]/[_0x3ba0ce(0x4af)](_0xddf38d[_0x3ba0ce(0x242)]),_0x3d12c8=_0xddf38d[_0x3ba0ce(0x242)]&&_0xddf38d['image_prompt'][_0x3ba0ce(0x43a)]()&&!_0x3fd821,_0xaaeeb9=_0x3d12c8?_0xddf38d[_0x3ba0ce(0x242)]:_0x3ba0ce(0x34b),_0x4e2e60=_0x3ba0ce(0xb1f)+encodeURIComponent(_0xaaeeb9),_0x205839=new Image();_0x205839[_0x3ba0ce(0x139d)]=function(){const _0x2c0bbd=_0x3ba0ce;_0x2d6607[_0x2c0bbd(0x731)][_0x2c0bbd(0x4d6)]=_0x2c0bbd(0xec1)+this['src']+')';},_0x205839[_0x3ba0ce(0x36b)]=function(){const _0xba3495=_0x3ba0ce;_0x2d6607[_0xba3495(0x731)]['backgroundImage']=_0xba3495(0xec1)+_0x374a79+')';},_0x205839[_0x3ba0ce(0xbe8)]=_0x4e2e60;}else{_0x2d6607[_0x3ba0ce(0x731)][_0x3ba0ce(0xfd6)]='#f0f2f5',_0x2d6607[_0x3ba0ce(0x731)][_0x3ba0ce(0xb94)]=_0x3ba0ce(0xa49);const _0x24da2d=document[_0x3ba0ce(0x124e)]('p');_0x24da2d[_0x3ba0ce(0x87d)]=_0x3ba0ce(0x1213),_0x24da2d[_0x3ba0ce(0xee5)]=_0xddf38d[_0x3ba0ce(0x9af)]||'(这张照片没有描述)',_0x2d6607[_0x3ba0ce(0x99e)](_0x24da2d);}});}function _0x2a38dc(){const _0x2df522=_0x5a7792,_0x4f5e23=document[_0x2df522(0x64f)]('char-browser-history');_0x4f5e23[_0x2df522(0xc58)]='';if(!_0x10ae3d)return;const _0x25c53b=_0x3e7a1b[_0x2df522(0x999)][_0x10ae3d],_0x564d30=[_0x25c53b[_0x2df522(0x6fc)],'爱好','旅游','美食','新闻',..._0x25c53b[_0x2df522(0xcb3)][_0x2df522(0xbe5)][_0x2df522(0x108c)](/，|。|\s/)['slice'](0x0,0x5)],_0x2373b7=['知乎',_0x2df522(0xfea),_0x2df522(0x190),'微博',_0x2df522(0x76e)];for(let _0x336bef=0x0;_0x336bef<0xf;_0x336bef++){const _0x2fbb56=_0x564d30[Math[_0x2df522(0x1245)](Math['random']()*_0x564d30[_0x2df522(0x40f)])],_0x9678c4=_0x2373b7[Math['floor'](Math[_0x2df522(0x95f)]()*_0x2373b7['length'])],_0x1d200d=document['createElement'](_0x2df522(0x479));_0x1d200d[_0x2df522(0x87d)]='char-browser-item',_0x1d200d['innerHTML']=_0x2df522(0x77)+_0x2fbb56+_0x2df522(0xc78)+_0x9678c4+_0x2df522(0x3b2)+_0x9678c4['toLowerCase']()+_0x2df522(0x47d)+_0x2fbb56+_0x2df522(0x9df),_0x4f5e23[_0x2df522(0x99e)](_0x1d200d);}}function _0x59a86c(){const _0x3a3406=_0x5a7792,_0x3d8e1d=document[_0x3a3406(0x64f)]('char-product-grid');_0x3d8e1d['innerHTML']='';if(!_0x10ae3d)return;const _0x7b4538=_0x3e7a1b[_0x3a3406(0x999)][_0x10ae3d],_0x3b0236=_0x7b4538[_0x3a3406(0x1ec)]?.[_0x3a3406(0x6d5)]||[];if(_0x3b0236[_0x3a3406(0x40f)]===0x0){_0x3d8e1d['innerHTML']=_0x3a3406(0x37e);return;}_0x3b0236[_0x3a3406(0x103)](_0x24a27a=>{const _0x402291=_0x3a3406,_0x360f03=document['createElement'](_0x402291(0x479));_0x360f03[_0x402291(0x87d)]=_0x402291(0x87b),_0x360f03[_0x402291(0x12e1)][_0x402291(0x35a)]=_0x24a27a['reason'];let _0x344ce4;if(_0x3e7a1b['globalSettings'][_0x402291(0xc83)]){const _0x32b69c=_0x402291(0xb1f)+encodeURIComponent(_0x24a27a[_0x402291(0x242)]||_0x402291(0xc9d));_0x344ce4='<img\x20src=\x22'+_0x32b69c+'\x22\x20class=\x22product-image\x22>';}else _0x344ce4='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-description-overlay\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20class=\x22char-photo-description\x22>'+(_0x24a27a['reason']||_0x402291(0xa96))+_0x402291(0x53b);_0x360f03[_0x402291(0xc58)]=_0x402291(0x1295)+_0x344ce4+_0x402291(0x7a9)+_0x24a27a[_0x402291(0x3a0)]+_0x402291(0x1cf)+(_0x24a27a[_0x402291(0xd5b)]||0x0)['toFixed'](0x2)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-product-status\x22>'+_0x24a27a[_0x402291(0x69e)]+_0x402291(0x9bb),_0x3d8e1d[_0x402291(0x99e)](_0x360f03);});}function _0x47f3f4(){const _0x98ec48=_0x5a7792;_0xdfc697(_0x98ec48(0x55e));}function _0x36778f(){const _0x2d9203=_0x5a7792,_0x308e22=document[_0x2d9203(0x64f)]('char-chat-list');_0x308e22[_0x2d9203(0xc58)]='';if(!_0x10ae3d)return;const _0x40802b=Object[_0x2d9203(0xd6d)](_0x3e7a1b[_0x2d9203(0x999)])[_0x2d9203(0x156)](_0x460ad6=>{const _0x37c9b8=_0x2d9203;if(_0x460ad6['id']===_0x10ae3d)return!![];if(_0x460ad6[_0x37c9b8(0x1167)]&&_0x460ad6[_0x37c9b8(0x5d4)][_0x37c9b8(0x26c)](_0x5de310=>_0x5de310['id']===_0x10ae3d))return!![];return![];});_0x40802b[_0x2d9203(0x103)](_0xeba73d=>{const _0x329848=_0x2d9203,_0x18646f=_0x8b7c37(_0xeba73d);_0x308e22[_0x329848(0x99e)](_0x18646f);});}async function _0x2c80a9(_0x50eb2f,_0x858523){const _0x47f7c1=_0x5a7792,_0x4b78ad=_0x3e7a1b[_0x47f7c1(0x999)][_0x50eb2f];if(!_0x4b78ad)return;!_0x4b78ad['appUsageLog']&&(_0x4b78ad[_0x47f7c1(0x73b)]=[]),_0x4b78ad[_0x47f7c1(0x73b)][_0x47f7c1(0x13ee)]({'appName':_0x858523,'timestamp':Date[_0x47f7c1(0x2b5)]()}),_0x4b78ad[_0x47f7c1(0x73b)]['length']>0x32&&_0x4b78ad[_0x47f7c1(0x73b)][_0x47f7c1(0x1312)](),await _0x4e1bbf[_0x47f7c1(0x999)]['put'](_0x4b78ad);}function _0x1fab74(){const _0x955be8=_0x5a7792,_0xb665e7=document[_0x955be8(0x64f)](_0x955be8(0xb0d));_0xb665e7[_0x955be8(0xc58)]='';const _0xe9a96b=_0x3e7a1b['chats'][_0x10ae3d],_0x41ff96=(_0xe9a96b[_0x955be8(0x73b)]||[])['slice']()[_0x955be8(0x2f4)]();if(_0x41ff96[_0x955be8(0x40f)]===0x0){_0xb665e7['innerHTML']=_0x955be8(0x2e3);return;}const _0x39dc9f={'qq':'QQ','album':'相册','browser':_0x955be8(0xabd),'taobao':'淘宝','memo':_0x955be8(0x7a1),'diary':'日记','amap':_0x955be8(0xc5b),'usage':_0x955be8(0x579)};_0x41ff96[_0x955be8(0x103)](_0x2d17fa=>{const _0x4b4ee3=_0x955be8,_0x5d9c13=document['createElement'](_0x4b4ee3(0x479));_0x5d9c13[_0x4b4ee3(0x87d)]=_0x4b4ee3(0x1351),_0x5d9c13[_0x4b4ee3(0xc58)]=_0x4b4ee3(0x1284)+new Date(_0x2d17fa[_0x4b4ee3(0x8af)])[_0x4b4ee3(0x2b4)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22action\x22>打开了\x20<strong>'+(_0x39dc9f[_0x2d17fa[_0x4b4ee3(0xdc6)]]||_0x2d17fa[_0x4b4ee3(0xdc6)])+_0x4b4ee3(0x38f),_0xb665e7[_0x4b4ee3(0x99e)](_0x5d9c13);});}async function _0x20467b(_0x4f79a3){const _0x573ad9=_0x5a7792,_0x30d180=_0x3e7a1b[_0x573ad9(0x999)][_0x10ae3d];if(!_0x30d180)return;const _0x2a28ba={'role':_0x573ad9(0x12c3),'senderName':_0x30d180[_0x573ad9(0x7de)],'type':_0x573ad9(0x10a3),'content':_0x4f79a3,'imageUrl':_0x573ad9(0x2e4),'timestamp':Date[_0x573ad9(0x2b5)]()};_0x30d180[_0x573ad9(0x830)][_0x573ad9(0x13ee)](_0x2a28ba),await _0x4e1bbf[_0x573ad9(0x999)][_0x573ad9(0x4fa)](_0x30d180),_0x3e7a1b[_0x573ad9(0x777)]===_0x10ae3d&&_0x3c7e84(_0x2a28ba,_0x30d180),await _0x28974b(_0x573ad9(0x25b),'“'+_0x30d180[_0x573ad9(0x6fc)]+_0x573ad9(0xeb5));}async function _0x46e48b(_0x1741b1){const _0x26d8dd=_0x5a7792,_0x1e8800=_0x3e7a1b[_0x26d8dd(0x999)][_0x10ae3d];if(!_0x1e8800||!_0x1e8800[_0x26d8dd(0x5b6)])return;const _0x20cb5f=_0x1e8800[_0x26d8dd(0x5b6)][_0x26d8dd(0x137)](_0x39538b=>_0x39538b['id']===_0x1741b1);if(_0x20cb5f){_0x2d8791=_0x20cb5f;const _0x556f01=document[_0x26d8dd(0x64f)]('char-memo-detail-title'),_0x3583f5=document[_0x26d8dd(0x64f)](_0x26d8dd(0x124a)),_0x392101=document[_0x26d8dd(0x64f)](_0x26d8dd(0x2b2));if(_0x556f01)_0x556f01[_0x26d8dd(0xee5)]=_0x20cb5f['title'];if(_0x3583f5)_0x3583f5[_0x26d8dd(0xbed)]=_0x20cb5f[_0x26d8dd(0x3ba)];const _0xf8a01c=await _0x4e1bbf['favorites'][_0x26d8dd(0xec9)]({'type':_0x26d8dd(0x5b2),'content.id':_0x1741b1})['first']();_0x392101[_0x26d8dd(0x418)][_0x26d8dd(0x5cf)](_0x26d8dd(0x12ef),!!_0xf8a01c),_0xdfc697(_0x26d8dd(0x928));}}function _0x2c8f58(){const _0x39c1a9=_0x5a7792,_0x244962=document[_0x39c1a9(0x64f)]('char-memo-list');_0x244962['innerHTML']='';const _0x917786=_0x3e7a1b[_0x39c1a9(0x999)][_0x10ae3d],_0xb7cd56=(_0x917786['memos']||[])['slice']()[_0x39c1a9(0x2f4)]();if(_0xb7cd56[_0x39c1a9(0x40f)]===0x0){_0x244962[_0x39c1a9(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>还没有备忘录。</p>';return;}_0xb7cd56['forEach'](_0x51bebd=>{const _0x225fc4=_0x39c1a9,_0x4fc6c3=document[_0x225fc4(0x124e)](_0x225fc4(0x479));_0x4fc6c3[_0x225fc4(0x87d)]=_0x225fc4(0x13b3),_0x4fc6c3[_0x225fc4(0xc58)]=_0x225fc4(0xcd8)+_0x51bebd[_0x225fc4(0x1250)]+_0x225fc4(0xb88)+(_0x51bebd[_0x225fc4(0x3ba)]||'')['split']('\x0a')[0x0]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4fc6c3[_0x225fc4(0xf72)](_0x225fc4(0x1080),()=>_0x46e48b(_0x51bebd['id'])),_0xb407a5(_0x4fc6c3,()=>deleteMemo(_0x51bebd['id'])),_0x244962[_0x225fc4(0x99e)](_0x4fc6c3);});}async function _0x5668c6(_0x248501=null){const _0x12bbd3=_0x5a7792;_0x4424d7=null;const _0x198eb4=await _0x41e3f8(_0x12bbd3(0x37f),_0x12bbd3(0xf02));if(_0x198eb4===null||!_0x198eb4['trim']())return;const _0x12a188=await _0x41e3f8(_0x12bbd3(0xd5e)+_0x198eb4,_0x12bbd3(0x4ce),'',_0x12bbd3(0x444));_0x12a188!==null&&(await _0x5ef7c5({'title':_0x198eb4['trim'](),'content':_0x12a188}),_0xdfc697(_0x12bbd3(0x13e3)));}async function _0x5ef7c5(_0x5a148c){const _0x16175d=_0x5a7792,_0x1a3f24=_0x3e7a1b[_0x16175d(0x999)][_0x10ae3d];if(!_0x1a3f24['memos'])_0x1a3f24['memos']=[];_0x1a3f24[_0x16175d(0x5b6)][_0x16175d(0x13ee)]({'id':Date['now'](),'title':_0x5a148c[_0x16175d(0x1250)],'content':_0x5a148c[_0x16175d(0x3ba)]}),await _0x4e1bbf[_0x16175d(0x999)]['put'](_0x1a3f24),_0x2c8f58();}async function _0x5ef7c5(_0x419bcf){const _0x4e1caf=_0x5a7792,_0x208eeb=_0x3e7a1b[_0x4e1caf(0x999)][_0x10ae3d];if(!_0x208eeb['memos'])_0x208eeb[_0x4e1caf(0x5b6)]=[];if(_0x4424d7){const _0x19c492=_0x208eeb[_0x4e1caf(0x5b6)]['find'](_0x7aedba=>_0x7aedba['id']===_0x4424d7);if(_0x19c492)_0x19c492[_0x4e1caf(0x3ba)]=_0x419bcf;}else _0x208eeb[_0x4e1caf(0x5b6)][_0x4e1caf(0x13ee)]({'id':Date['now'](),'content':_0x419bcf});await _0x4e1bbf['chats'][_0x4e1caf(0x4fa)](_0x208eeb),_0x2c8f58(),_0x4424d7=null;}async function _0x499be8(){const _0x4e8fc2=_0x5a7792;if(!_0x10ae3d)return;const _0x51004c=_0x3e7a1b[_0x4e8fc2(0x999)][_0x10ae3d];if(!_0x51004c)return;await _0x28974b('请稍候...',_0x4e8fc2(0x5ad)+_0x51004c[_0x4e8fc2(0x6fc)]+_0x4e8fc2(0x1392));const {proxyUrl:_0x5500bb,apiKey:_0x19e2ce,model:_0x5717b6}=_0x3e7a1b[_0x4e8fc2(0xec0)];if(!_0x5500bb||!_0x19e2ce||!_0x5717b6){alert(_0x4e8fc2(0x1ce));return;}const _0x44a9c4=_0x3e7a1b[_0x4e8fc2(0x3c2)][_0x4e8fc2(0x78c)]===_0x4e8fc2(0x1028)||!_0x3e7a1b['qzoneSettings']['nickname']?'用户':_0x3e7a1b[_0x4e8fc2(0x3c2)][_0x4e8fc2(0x78c)],_0x4e57cc=_0x51004c[_0x4e8fc2(0x518)]&&_0x51004c[_0x4e8fc2(0x518)][_0x4e8fc2(0x40f)]>0x0?_0x51004c[_0x4e8fc2(0x518)][_0x4e8fc2(0xb96)](_0xbbcff0=>'-\x20(记录于\x20'+_0x4942eb(_0xbbcff0[_0x4e8fc2(0x8af)])+')\x20'+_0xbbcff0[_0x4e8fc2(0x3ba)])[_0x4e8fc2(0xd22)]('\x0a'):'无',_0x8dc4b8=_0x51004c[_0x4e8fc2(0xcb3)]['maxMemory']||0xa,_0x3ccfb7=_0x51004c[_0x4e8fc2(0x830)][_0x4e8fc2(0xdf5)](-_0x8dc4b8)[_0x4e8fc2(0xb96)](_0x25b116=>(_0x25b116['role']===_0x4e8fc2(0xa4d)?_0x44a9c4:_0x51004c['name'])+':\x20'+String(_0x25b116[_0x4e8fc2(0x3ba)])[_0x4e8fc2(0x126f)](0x0,0x1e)+_0x4e8fc2(0x3cd))[_0x4e8fc2(0xd22)]('\x0a'),_0x532e87=(_0x51004c[_0x4e8fc2(0xcb3)][_0x4e8fc2(0xde4)]||[])[_0x4e8fc2(0xb96)](_0x452b76=>_0x3e7a1b['worldBooks']['find'](_0x13dc87=>_0x13dc87['id']===_0x452b76))[_0x4e8fc2(0x156)](Boolean)[_0x4e8fc2(0xb96)](_0x1eb854=>'\x0a##\x20世界书《'+_0x1eb854['name']+_0x4e8fc2(0xc4d)+_0x1eb854[_0x4e8fc2(0x3ba)]['filter'](_0xaae17e=>_0xaae17e[_0x4e8fc2(0x9b)])[_0x4e8fc2(0xb96)](_0x2bdf3f=>'-\x20'+_0x2bdf3f[_0x4e8fc2(0x3ba)])[_0x4e8fc2(0xd22)]('\x0a'))[_0x4e8fc2(0xd22)](''),_0xee6dd6=_0x5871dc(_0x51004c,0x3,_0x4e8fc2(0x4b6)),_0x46d48a=_0x5871dc(_0x51004c,0x6,_0x4e8fc2(0x4b6)),_0x4d822d=_0x5871dc(_0x51004c,0x9,_0x4e8fc2(0x4b6)),_0x51a07f=_0x5871dc(_0x51004c,0x1,_0x4e8fc2(0x82a)),_0x57d971=_0x5871dc(_0x51004c,0x3,_0x4e8fc2(0x82a)),_0x4be255=_0x5871dc(_0x51004c,0x7,'days');let _0x382992='';if(_0xee6dd6||_0x46d48a||_0x4d822d||_0x51a07f||_0x57d971||_0x4be255){_0x382992+=_0x4e8fc2(0xd98);if(_0xee6dd6)_0x382992+=_0xee6dd6;if(_0x46d48a)_0x382992+=_0x46d48a;if(_0x4d822d)_0x382992+=_0x4d822d;if(_0xee6dd6||_0x46d48a||_0x4d822d)_0x382992+='\x0a';if(_0x51a07f)_0x382992+=_0x51a07f;if(_0x57d971)_0x382992+=_0x57d971;if(_0x4be255)_0x382992+=_0x4be255;}const _0x4f063d=_0x51004c[_0x4e8fc2(0xcb3)][_0x4e8fc2(0x1047)]||_0x4e8fc2(0x9ef),_0x2c3d0d=_0x4e8fc2(0xaad)+_0x51004c[_0x4e8fc2(0x6fc)]+_0x4e8fc2(0xcc0)+new Date()[_0x4e8fc2(0x16c)]('zh-CN')+_0x4e8fc2(0x31c)+_0x44a9c4+_0x4e8fc2(0x12a)+_0x51004c[_0x4e8fc2(0xcb3)]['aiPersona']+_0x4e8fc2(0x8c6)+_0x4f063d+_0x4e8fc2(0x7e5)+_0x4e57cc+'\x0a'+_0x532e87+'\x0a'+_0x382992+_0x4e8fc2(0x12f5)+_0x44a9c4+_0x4e8fc2(0x10be)+_0x3ccfb7+_0x4e8fc2(0x1399);try{const _0x104145=[{'role':_0x4e8fc2(0xa4d),'content':_0x4e8fc2(0x891)}];let _0x3e90a5=_0x5500bb[_0x4e8fc2(0xe53)]('generativelanguage'),_0x456933=_0x250668(_0x5717b6,_0x19e2ce,_0x2c3d0d,_0x104145);const _0x48fdab=_0x3e90a5?await fetch(_0x456933[_0x4e8fc2(0xe52)],_0x456933[_0x4e8fc2(0x88a)]):await fetch(_0x5500bb+_0x4e8fc2(0x58b),{'method':'POST','headers':{'Content-Type':_0x4e8fc2(0x7fe),'Authorization':_0x4e8fc2(0x236)+_0x19e2ce},'body':JSON[_0x4e8fc2(0xe3f)]({'model':_0x5717b6,'messages':[{'role':_0x4e8fc2(0x905),'content':_0x2c3d0d},..._0x104145],'temperature':_0x3e7a1b[_0x4e8fc2(0x11b4)][_0x4e8fc2(0xa55)]||0.95})});if(!_0x48fdab['ok'])throw new Error('API\x20错误:\x20'+_0x48fdab[_0x4e8fc2(0x132c)]);const _0x341c6c=await _0x48fdab[_0x4e8fc2(0x6f8)](),_0x5b1f97=getGeminiResponseText(_0x341c6c),_0x17a3b6=_0x5b1f97[_0x4e8fc2(0x132a)](/(\[[\s\S]*\])/);if(!_0x17a3b6||!_0x17a3b6[0x0])throw new Error(_0x4e8fc2(0x909)+_0x5b1f97);const _0x2b3ab3=_0x17a3b6[0x0];let _0x270e92;try{_0x270e92=JSON[_0x4e8fc2(0x1214)](_0x2b3ab3);}catch(_0x4e2f39){throw new Error(_0x4e8fc2(0xc8c)+_0x4e2f39[_0x4e8fc2(0x854)]+_0x4e8fc2(0xa91)+_0x5b1f97);}_0x51004c[_0x4e8fc2(0x1326)]=_0x270e92[_0x4e8fc2(0xb96)](_0x1df4c2=>({'id':Date[_0x4e8fc2(0x2b5)]()+Math[_0x4e8fc2(0x95f)](),'title':_0x1df4c2[_0x4e8fc2(0x1250)],'content':_0x1df4c2[_0x4e8fc2(0x3ba)],'timestamp':Date['now']()})),await _0x4e1bbf[_0x4e8fc2(0x999)]['put'](_0x51004c),await _0x498f46();}catch(_0xae36ac){console[_0x4e8fc2(0xc60)](_0x4e8fc2(0x4fd),_0xae36ac),await _0x28974b(_0x4e8fc2(0x129b),_0x4e8fc2(0xf5)+_0xae36ac[_0x4e8fc2(0x854)]);}}async function _0x19fde0(){const _0x5eb585=_0x5a7792;if(!_0x10ae3d)return;const _0x492c1e=_0x3e7a1b[_0x5eb585(0x999)][_0x10ae3d];if(!_0x492c1e)return;await _0x28974b(_0x5eb585(0x2f7),'正在请求“'+_0x492c1e[_0x5eb585(0x6fc)]+_0x5eb585(0xc39));const {proxyUrl:_0x14c35d,apiKey:_0x13960e,model:_0x367a04}=_0x3e7a1b['apiConfig'];if(!_0x14c35d||!_0x13960e||!_0x367a04)return;const _0x31ca96=_0x3e7a1b[_0x5eb585(0x3c2)][_0x5eb585(0x78c)]==='{{user}}'||!_0x3e7a1b[_0x5eb585(0x3c2)][_0x5eb585(0x78c)]?'用户':_0x3e7a1b[_0x5eb585(0x3c2)]['nickname'],_0x2fb650=_0x492c1e[_0x5eb585(0x518)]&&_0x492c1e['longTermMemory'][_0x5eb585(0x40f)]>0x0?_0x492c1e['longTermMemory'][_0x5eb585(0xb96)](_0x2ee0ce=>_0x5eb585(0x56b)+_0x4942eb(_0x2ee0ce[_0x5eb585(0x8af)])+')\x20'+_0x2ee0ce[_0x5eb585(0x3ba)])['join']('\x0a'):'无',_0x590a37=_0x492c1e[_0x5eb585(0xcb3)][_0x5eb585(0xd50)]||0xa,_0x53c990=_0x492c1e['history'][_0x5eb585(0xdf5)](-_0x590a37)[_0x5eb585(0xb96)](_0x5baf2c=>(_0x5baf2c['role']===_0x5eb585(0xa4d)?_0x31ca96:_0x492c1e[_0x5eb585(0x6fc)])+':\x20'+String(_0x5baf2c[_0x5eb585(0x3ba)])[_0x5eb585(0x126f)](0x0,0x1e)+_0x5eb585(0x3cd))['join']('\x0a'),_0x1cd106=(_0x492c1e[_0x5eb585(0xcb3)][_0x5eb585(0xde4)]||[])[_0x5eb585(0xb96)](_0x5990d6=>_0x3e7a1b[_0x5eb585(0x144)][_0x5eb585(0x137)](_0x3f218f=>_0x3f218f['id']===_0x5990d6))['filter'](Boolean)[_0x5eb585(0xb96)](_0xcda788=>_0x5eb585(0x1272)+_0xcda788[_0x5eb585(0x6fc)]+_0x5eb585(0xc4d)+_0xcda788[_0x5eb585(0x3ba)][_0x5eb585(0x156)](_0x5a446a=>_0x5a446a[_0x5eb585(0x9b)])[_0x5eb585(0xb96)](_0xdeba46=>'-\x20'+_0xdeba46['content'])[_0x5eb585(0xd22)]('\x0a'))[_0x5eb585(0xd22)](''),_0x2c6c1a=_0x5eb585(0xf32)+_0x492c1e[_0x5eb585(0x6fc)]+_0x5eb585(0x73d)+new Date()['toLocaleDateString']('zh-CN')+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你生成的日记标题日期【必须】是今天或今天以前的日期。\x0a\x20\x20\x20\x20-\x20\x20\x20【绝对禁止】生成任何未来的日期！\x0a2.\x20\x20**【【【沉浸感铁律】】】**:\x20日记必须使用【第一人称视角\x20(\x22我\x22)】来写，并且要充满角色的个人情感、思考和秘密。在日记中描述自己的行为或想法时，【绝对禁止】使用第三人称“他”或“她”\x20(TA)。\x0a3.\x20\x20**【【【长度铁律】】】**:\x20日记的正文长度【必须不少于300字】。\x0a4.\x20\x20**【【【格式铁律\x20(最高优先级)】】】**:\x20你的回复【必须且只能】是一个JSON数组，且数组中【只包含一个】对象，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22这篇日记的标题，例如：9月20日\x20晴\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22这里是日记的详细正文，必须支持换行符\x5cn，并且必须巧妙地使用下面的【日记专属Markdown语法】来丰富文本表现力。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a5.\x20\x20**【【【日记专属Markdown语法\x20(必须使用！)】】】**:\x0a\x20\x20\x20\x20-\x20\x20\x20`**加粗文字**`:\x20用于强调。\x0a\x20\x20\x20\x20-\x20\x20\x20`~~划掉的文字~~`:\x20用于表示改变主意或自我否定。\x0a\x20\x20\x20\x20-\x20\x20\x20`!h{黄色高亮}`:\x20用于标记关键词或重要信息。\x0a\x20\x20\x20\x20-\x20\x20\x20`!u{粉色下划线}`:\x20用于标注人名、地名或特殊名词。\x0a\x20\x20\x20\x20-\x20\x20\x20`!e{粉色强调}`:\x20用于表达强烈的情绪。\x0a\x20\x20\x20\x20-\x20\x20\x20`!w{手写体}`:\x20用于写下引言、歌词或特殊笔记。\x0a\x20\x20\x20\x20-\x20\x20\x20`!m{凌乱的手写体}`:\x20用于表达激动、慌乱或潦草记录时的心情。\x0a\x20\x20\x20\x20-\x20\x20\x20`||涂黑||`:\x20用于隐藏秘密或敏感词汇(每次涂黑2~5个字)。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x492c1e[_0x5eb585(0xcb3)]['aiPersona']+_0x5eb585(0x7e5)+_0x2fb650+'\x0a'+_0x1cd106+_0x5eb585(0x448)+_0x31ca96+'”的对话摘要**:\x0a'+_0x53c990+_0x5eb585(0x13c1);try{const _0x319a8f=[{'role':_0x5eb585(0xa4d),'content':'请根据你的设定，写一篇新日记。'}];let _0x4e79c8=_0x14c35d['includes'](_0x5eb585(0x742)),_0x4e84f1=_0x250668(_0x367a04,_0x13960e,_0x2c6c1a,_0x319a8f);const _0x5e36a6=_0x4e79c8?await fetch(_0x4e84f1[_0x5eb585(0xe52)],_0x4e84f1[_0x5eb585(0x88a)]):await fetch(_0x14c35d+_0x5eb585(0x58b),{'method':_0x5eb585(0x2d1),'headers':{'Content-Type':_0x5eb585(0x7fe),'Authorization':_0x5eb585(0x236)+_0x13960e},'body':JSON['stringify']({'model':_0x367a04,'messages':[{'role':_0x5eb585(0x905),'content':_0x2c6c1a},..._0x319a8f],'temperature':_0x3e7a1b[_0x5eb585(0x11b4)][_0x5eb585(0xa55)]||0.95})});if(!_0x5e36a6['ok'])throw new Error(_0x5eb585(0x1fa)+_0x5e36a6[_0x5eb585(0x132c)]);const _0x33880d=await _0x5e36a6['json'](),_0x55cd9d=getGeminiResponseText(_0x33880d),_0x48f7cc=_0x55cd9d['match'](/(\[[\s\S]*\])/);if(!_0x48f7cc||!_0x48f7cc[0x0])throw new Error(_0x5eb585(0x909)+_0x55cd9d);const _0x3f2cfb=_0x48f7cc[0x0];let _0x49cf87;try{_0x49cf87=JSON['parse'](_0x3f2cfb)[0x0];}catch(_0x47589f){throw new Error(_0x5eb585(0xc8c)+_0x47589f['message']+'\x0a\x0aAI原始返回内容:\x0a'+_0x55cd9d);}if(!_0x492c1e[_0x5eb585(0x1326)])_0x492c1e[_0x5eb585(0x1326)]=[];_0x492c1e[_0x5eb585(0x1326)][_0x5eb585(0x13ee)]({'id':Date[_0x5eb585(0x2b5)](),'title':_0x49cf87['title'],'content':_0x49cf87[_0x5eb585(0x3ba)],'timestamp':Date[_0x5eb585(0x2b5)]()}),await _0x4e1bbf[_0x5eb585(0x999)][_0x5eb585(0x4fa)](_0x492c1e),await _0x498f46();}catch(_0x153f5f){console[_0x5eb585(0xc60)](_0x5eb585(0x3fd),_0x153f5f),await _0x28974b(_0x5eb585(0x129b),_0x5eb585(0xb70)+_0x153f5f['message']);}}function _0x498f46(){const _0x57389a=_0x5a7792,_0x585d4b=document[_0x57389a(0x64f)](_0x57389a(0x637));_0x585d4b[_0x57389a(0xc58)]='';const _0x28350e=_0x3e7a1b['chats'][_0x10ae3d],_0x472675=(_0x28350e['diary']||[])[_0x57389a(0xdf5)]()[_0x57389a(0x2f4)]();if(_0x472675[_0x57389a(0x40f)]===0x0){_0x585d4b[_0x57389a(0xc58)]=_0x57389a(0x1040);return;}_0x472675[_0x57389a(0x103)](_0x171379=>{const _0x2b0838=_0x57389a,_0x358b15=document[_0x2b0838(0x124e)]('div');_0x358b15[_0x2b0838(0x87d)]=_0x2b0838(0x13b3),_0x358b15['innerHTML']=_0x2b0838(0x819)+_0x171379[_0x2b0838(0x1250)]+_0x2b0838(0x325)+new Date(_0x171379[_0x2b0838(0x8af)])[_0x2b0838(0x16c)]()+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x358b15[_0x2b0838(0xf72)](_0x2b0838(0x1080),()=>_0x44a10a(_0x171379['id'])),_0xb407a5(_0x358b15,()=>_0x111624(_0x171379['id'])),_0x585d4b['appendChild'](_0x358b15);});}async function _0x44a10a(_0x448f4f){const _0x40744a=_0x5a7792,_0x246b48=_0x3e7a1b['chats'][_0x10ae3d];if(!_0x246b48||!_0x246b48[_0x40744a(0x1326)])return;const _0x287679=_0x246b48[_0x40744a(0x1326)]['find'](_0x4ae563=>_0x4ae563['id']===_0x448f4f);if(_0x287679){_0x4260cc=_0x287679;const _0x1f4adf=document[_0x40744a(0x64f)]('char-diary-detail-title'),_0x52c353=document[_0x40744a(0x64f)](_0x40744a(0xbab)),_0x2b59e1=document[_0x40744a(0x64f)]('favorite-diary-btn');_0x1f4adf[_0x40744a(0xee5)]=_0x287679[_0x40744a(0x1250)];const _0xfc7f29=_0x422b3c(_0x287679[_0x40744a(0x3ba)])['split']('\x0a')[_0x40744a(0xb96)](_0x5e20f3=>_0x40744a(0xb23)+(_0x5e20f3||_0x40744a(0xed3))+_0x40744a(0x12de))[_0x40744a(0xd22)]('');_0x52c353[_0x40744a(0xc58)]=_0xfc7f29;const _0x2855b2=await _0x4e1bbf[_0x40744a(0x1232)][_0x40744a(0xec9)]({'type':_0x40744a(0x138b),'content.id':_0x448f4f})['first']();_0x2b59e1[_0x40744a(0x418)][_0x40744a(0x5cf)](_0x40744a(0x12ef),!!_0x2855b2),_0xdfc697(_0x40744a(0xb36));}}async function _0x4b56ba(){const _0x3363c6=_0x5a7792;if(!_0x4260cc||!_0x10ae3d)return;const _0x1ca484=_0x4260cc,_0x3fb7a2=_0x3e7a1b['chats'][_0x10ae3d],_0x31ee23=document[_0x3363c6(0x64f)](_0x3363c6(0xd5a)),_0x54f03a=await _0x4e1bbf[_0x3363c6(0x1232)][_0x3363c6(0xec9)]({'type':'char_diary','content.id':_0x1ca484['id']})[_0x3363c6(0x5dd)]();if(_0x54f03a)await _0x4e1bbf[_0x3363c6(0x1232)][_0x3363c6(0x3aa)](_0x54f03a['id']),_0x31ee23[_0x3363c6(0x418)][_0x3363c6(0x1275)](_0x3363c6(0x12ef)),await _0x28974b(_0x3363c6(0x722),_0x3363c6(0x611));else{const _0x56aba1={'type':'char_diary','content':{'id':_0x1ca484['id'],'title':_0x1ca484[_0x3363c6(0x1250)],'content':_0x1ca484[_0x3363c6(0x3ba)],'timestamp':_0x1ca484[_0x3363c6(0x8af)],'characterId':_0x10ae3d,'characterName':_0x3fb7a2[_0x3363c6(0x6fc)]},'timestamp':Date['now']()};await _0x4e1bbf[_0x3363c6(0x1232)][_0x3363c6(0xdda)](_0x56aba1),_0x31ee23[_0x3363c6(0x418)][_0x3363c6(0xdda)]('active'),await _0x28974b(_0x3363c6(0x722),_0x3363c6(0xa31));}}async function _0x30eb37(){const _0x50a66b=_0x5a7792;if(!_0x2d8791||!_0x10ae3d)return;const _0x536332=_0x2d8791,_0x4f7292=_0x3e7a1b['chats'][_0x10ae3d],_0x4fc023=document[_0x50a66b(0x64f)](_0x50a66b(0x2b2)),_0x37b3ca=await _0x4e1bbf[_0x50a66b(0x1232)]['where']({'type':'char_memo','content.id':_0x536332['id']})[_0x50a66b(0x5dd)]();if(_0x37b3ca)await _0x4e1bbf[_0x50a66b(0x1232)]['delete'](_0x37b3ca['id']),_0x4fc023[_0x50a66b(0x418)][_0x50a66b(0x1275)]('active'),await _0x28974b('操作成功',_0x50a66b(0x611));else{const _0x555d59={'type':_0x50a66b(0x5b2),'content':{'id':_0x536332['id'],'title':_0x536332[_0x50a66b(0x1250)],'content':_0x536332[_0x50a66b(0x3ba)],'timestamp':_0x536332['timestamp'],'characterId':_0x10ae3d,'characterName':_0x4f7292[_0x50a66b(0x6fc)]},'timestamp':Date[_0x50a66b(0x2b5)]()};await _0x4e1bbf[_0x50a66b(0x1232)]['add'](_0x555d59),_0x4fc023[_0x50a66b(0x418)][_0x50a66b(0xdda)]('active'),await _0x28974b(_0x50a66b(0x722),'已成功收藏到“我的收藏”页面！');}}async function _0x111624(_0x3868bd){const _0x343ba7=_0x5a7792,_0x1a9ed6=await _0x54149f(_0x343ba7(0x6f),_0x343ba7(0x569),{'confirmButtonClass':_0x343ba7(0xeed)});if(_0x1a9ed6){const _0x1e7f5b=_0x3e7a1b[_0x343ba7(0x999)][_0x10ae3d];_0x1e7f5b['diary']=_0x1e7f5b['diary'][_0x343ba7(0x156)](_0x3bdca1=>_0x3bdca1['id']!==_0x3868bd),await _0x4e1bbf[_0x343ba7(0x999)]['put'](_0x1e7f5b),_0x498f46();}}async function _0x4cdae1(){const _0x484edc=_0x5a7792,_0x57fb2e=document['getElementById'](_0x484edc(0x136d));_0x57fb2e['innerHTML']='';const _0x45c686=_0x3e7a1b[_0x484edc(0x999)][_0x10ae3d];if(!_0x45c686)return;const _0x5e0620=_0x45c686[_0x484edc(0xcb3)][_0x484edc(0x96f)]||(_0x3e7a1b[_0x484edc(0x3c2)][_0x484edc(0x78c)]||'我'),_0xa892e6=_0x45c686['history'][_0x484edc(0x156)](_0x32a06=>!_0x32a06[_0x484edc(0x5cc)])[_0x484edc(0xdf5)](-0x1)[0x0]||{'content':_0x484edc(0x3cd)};let _0x34e9c1=_0x484edc(0x3cd);if(_0xa892e6){if(typeof _0xa892e6[_0x484edc(0x3ba)]===_0x484edc(0x1251))_0x34e9c1=_0xa892e6['content'];else{if(Array['isArray'](_0xa892e6[_0x484edc(0x3ba)])&&_0xa892e6['content'][0x0]?.['type']==='image_url')_0x34e9c1=_0x484edc(0x26a);else{if(_0xa892e6[_0x484edc(0xafc)]){const _0x326002={'voice_message':_0x484edc(0x28a),'transfer':_0x484edc(0xeac),'ai_image':_0x484edc(0x26a)};_0x34e9c1=_0x326002[_0xa892e6[_0x484edc(0xafc)]]||'['+_0xa892e6['type']+']';}}}}const _0x4b4b2d=_0x45c686[_0x484edc(0xcb3)][_0x484edc(0x96a)]||_0x54e358,_0x520518=_0x45c686['settings'][_0x484edc(0x5b4)]||'';let _0x50762b;_0x520518?_0x50762b=_0x484edc(0x879)+_0x4b4b2d+_0x484edc(0xc24)+_0x520518+_0x484edc(0x9a3):_0x50762b=_0x484edc(0xc77)+_0x4b4b2d+_0x484edc(0x6a6);const _0x1c006e=document[_0x484edc(0x124e)]('div');_0x1c006e[_0x484edc(0x87d)]=_0x484edc(0xb83),_0x1c006e['dataset'][_0x484edc(0xa83)]='-1',_0x1c006e['innerHTML']=_0x484edc(0xeb3)+_0x50762b+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22name-line\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x5e0620+_0x484edc(0xfbc)+String(_0x34e9c1)['substring'](0x0,0x14)+_0x484edc(0x4a5),_0x57fb2e['appendChild'](_0x1c006e);const _0x36560e=await _0x4e1bbf[_0x484edc(0xad7)][_0x484edc(0x78f)](),_0x42d15e=new Map(_0x36560e['map'](_0x19e7e7=>[_0x19e7e7[_0x484edc(0x6fc)],_0x19e7e7])),_0xa2c2a7=_0x45c686[_0x484edc(0xd17)]||[];if(_0xa2c2a7[_0x484edc(0x40f)]===0x0&&!_0x1c006e){_0x57fb2e[_0x484edc(0xc58)]=_0x484edc(0xdbb);return;}_0xa2c2a7[_0x484edc(0x103)]((_0x5aca55,_0x211845)=>{const _0x4675c2=_0x484edc;if(_0x5aca55['type']===_0x4675c2(0x744))return;const _0x2a7154=document[_0x4675c2(0x124e)](_0x4675c2(0x479));_0x2a7154[_0x4675c2(0x87d)]='chat-list-item',_0x2a7154[_0x4675c2(0x12e1)][_0x4675c2(0xa83)]=_0x211845;let _0x469504,_0x2dabf3,_0x1cc8ec;if(_0x5aca55[_0x4675c2(0xafc)]==='group'){_0x1cc8ec=_0x5aca55[_0x4675c2(0x1221)]+_0x4675c2(0xd47),_0x469504=_0x5aca55[_0x4675c2(0x9a4)][_0x4675c2(0xdf5)](-0x1)[0x0]||{'content':_0x4675c2(0x3cd)};const _0x229aa4=_0x4675c2(0x1146)+_0x5aca55[_0x4675c2(0x1221)]+'\x27',_0x100ae8=_0x3e7a1b[_0x4675c2(0x11b4)][_0x4675c2(0xc83)]?_0x4675c2(0xb1f)+encodeURIComponent(_0x229aa4):_0x9bc039;_0x2dabf3=_0x4675c2(0xe1c)+_0x100ae8+_0x4675c2(0x2b0);}else{_0x1cc8ec=_0x5aca55[_0x4675c2(0x13e5)]['name'],_0x469504=_0x5aca55[_0x4675c2(0x9a4)]['slice'](-0x1)[0x0]||{'content':_0x4675c2(0x3cd)};const _0x42ebf7=_0x42d15e[_0x4675c2(0x11fc)](_0x1cc8ec);let _0x342b8f=_0x42ebf7&&_0x42ebf7[_0x4675c2(0x1265)]?_0x42ebf7[_0x4675c2(0x1265)]:_0x3e7a1b[_0x4675c2(0x11b4)]['enableAiDrawing']?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x5aca55[_0x4675c2(0x13e5)][_0x4675c2(0x597)]||_0x4675c2(0x63d)):_0x480024;_0x2dabf3='<div\x20class=\x22avatar-group\x22><img\x20src=\x22'+_0x342b8f+_0x4675c2(0x2b0);}let _0x4370d9=_0x4675c2(0x3cd);_0x469504&&_0x469504[_0x4675c2(0x3ba)]&&(_0x4370d9=_0x469504[_0x4675c2(0x3ba)]),_0x2a7154[_0x4675c2(0xc58)]=_0x4675c2(0x781)+_0x2dabf3+_0x4675c2(0xfc8)+_0x1cc8ec+_0x4675c2(0x53d)+String(_0x4370d9)[_0x4675c2(0x126f)](0x0,0x14)+_0x4675c2(0x12d7),_0x57fb2e['appendChild'](_0x2a7154);});}async function _0x2103cb(){const _0x268349=_0x5a7792;if(!_0x10ae3d)return;const _0xebdcf2=_0x3e7a1b['chats'][_0x10ae3d];if(!_0xebdcf2)return;await _0x28974b('请稍候...',_0x268349(0xfe4)+_0xebdcf2[_0x268349(0x6fc)]+'”的记忆和人设，生成全新的社交动态...');const {proxyUrl:_0x266d1a,apiKey:_0x11bb60,model:_0x255c1c}=_0x3e7a1b[_0x268349(0xec0)];if(!_0x266d1a||!_0x11bb60||!_0x255c1c){alert(_0x268349(0x1ce));return;}const _0x2d4258=await _0x4e1bbf[_0x268349(0xad7)]['toArray'](),_0x815026=_0x2d4258[_0x268349(0x156)](_0x1dc3c8=>_0x1dc3c8[_0x268349(0x22c)]&&_0x1dc3c8[_0x268349(0x22c)][_0x268349(0xe53)](_0x10ae3d));let _0x35df6a=_0x268349(0x12a7);_0x815026[_0x268349(0x40f)]>0x0?(_0x35df6a+=_0x268349(0xc73),_0x815026[_0x268349(0x103)](_0x34fb79=>{const _0x343512=_0x268349;_0x35df6a+='-\x20**姓名**:\x20'+_0x34fb79[_0x343512(0x6fc)]+_0x343512(0x754)+_0x34fb79[_0x343512(0x324)]+'\x0a';})):_0x35df6a+='（你目前没有绑定的NPC伙伴，可以自由创造新的NPC。）\x0a';const _0x3878ed=_0x3e7a1b['qzoneSettings'][_0x268349(0x78c)]==='{{user}}'||!_0x3e7a1b[_0x268349(0x3c2)][_0x268349(0x78c)]?'用户':_0x3e7a1b[_0x268349(0x3c2)][_0x268349(0x78c)],_0x3b3d4c=_0xebdcf2[_0x268349(0xcb3)][_0x268349(0x96f)]||_0x3878ed,_0x4d5d2d=_0xebdcf2['longTermMemory']&&_0xebdcf2[_0x268349(0x518)][_0x268349(0x40f)]>0x0?_0xebdcf2['longTermMemory'][_0x268349(0xb96)](_0x47820f=>_0x268349(0x56b)+_0x4942eb(_0x47820f['timestamp'])+')\x20'+_0x47820f[_0x268349(0x3ba)])[_0x268349(0xd22)]('\x0a'):'无',_0x3adc32=_0xebdcf2[_0x268349(0xcb3)][_0x268349(0xd50)]||0xa,_0x2918ba=_0xebdcf2['history'][_0x268349(0xdf5)](-_0x3adc32)[_0x268349(0xb96)](_0xb84615=>(_0xb84615[_0x268349(0x931)]==='user'?_0x3b3d4c:_0xebdcf2[_0x268349(0x6fc)])+':\x20'+String(_0xb84615[_0x268349(0x3ba)])[_0x268349(0x126f)](0x0,0x1e)+_0x268349(0x3cd))['join']('\x0a'),_0x3a37d7=(_0xebdcf2[_0x268349(0xcb3)][_0x268349(0xde4)]||[])['map'](_0x157e59=>_0x3e7a1b[_0x268349(0x144)][_0x268349(0x137)](_0x402f8c=>_0x402f8c['id']===_0x157e59))[_0x268349(0x156)](Boolean)[_0x268349(0xb96)](_0x12f1fd=>_0x268349(0x1272)+_0x12f1fd[_0x268349(0x6fc)]+'》设定\x20(你可以将其中角色作为聊天对象):\x0a'+_0x12f1fd['content'][_0x268349(0x156)](_0x40f9b0=>_0x40f9b0[_0x268349(0x9b)])[_0x268349(0xb96)](_0x2d45d8=>'-\x20'+_0x2d45d8[_0x268349(0x3ba)])[_0x268349(0xd22)]('\x0a'))[_0x268349(0xd22)](''),_0x4273b5=_0xebdcf2[_0x268349(0x7de)]||_0xebdcf2['name'],_0x5d6b61=_0x2beb71(_0xebdcf2),_0x30aa2a='\x0a#\x20你的任务\x0a你是一个虚拟社交生活模拟器，扮演角色“'+_0xebdcf2[_0x268349(0x6fc)]+_0x268349(0x8f7)+_0x4273b5+_0x268349(0x26e)+_0x4273b5+_0x268349(0xa5)+_0x4273b5+_0x268349(0x9da)+_0xebdcf2[_0x268349(0xcb3)][_0x268349(0xbe5)]+_0x268349(0xd0c)+_0x4d5d2d+_0x268349(0x668)+_0x3a37d7+'\x0a-\x20**最近与用户的互动**:\x20'+_0x2918ba+'\x0a'+_0x35df6a+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x5d6b61+_0x268349(0x10de);try{const _0x237099=[{'role':_0x268349(0xa4d),'content':_0x268349(0xbd8)}];let _0xb78f18=_0x266d1a[_0x268349(0xe53)](_0x268349(0x742)),_0x82d55a=_0x250668(_0x255c1c,_0x11bb60,_0x30aa2a,_0x237099);const _0x6626f=_0xb78f18?await fetch(_0x82d55a[_0x268349(0xe52)],_0x82d55a[_0x268349(0x88a)]):await fetch(_0x266d1a+_0x268349(0x58b),{'method':'POST','headers':{'Content-Type':_0x268349(0x7fe),'Authorization':'Bearer\x20'+_0x11bb60},'body':JSON['stringify']({'model':_0x255c1c,'messages':[{'role':_0x268349(0x905),'content':_0x30aa2a},..._0x237099],'temperature':_0x3e7a1b[_0x268349(0x11b4)][_0x268349(0xa55)]||0.9})});if(!_0x6626f['ok'])throw new Error(_0x268349(0x1fa)+_0x6626f[_0x268349(0x132c)]);const _0x4fbbc9=await _0x6626f['json'](),_0x2f9721=getGeminiResponseText(_0x4fbbc9),_0x47f718=_0x2f9721[_0x268349(0x132a)](/(\[[\s\S]*\])/);if(!_0x47f718||!_0x47f718[0x0])throw new Error(_0x268349(0x909)+_0x2f9721);const _0x25fd02=_0x47f718[0x0];let _0x4d62c0;try{_0x4d62c0=JSON[_0x268349(0x1214)](_0x25fd02);}catch(_0x4e5542){throw new Error(_0x268349(0xc8c)+_0x4e5542[_0x268349(0x854)]+'\x0a\x0aAI原始返回内容:\x0a'+_0x2f9721);}_0xebdcf2[_0x268349(0xd17)]=_0x4d62c0,await _0x4e1bbf[_0x268349(0x999)][_0x268349(0x4fa)](_0xebdcf2),await _0x4cdae1();const _0x3f6c30={'role':_0x268349(0x905),'content':_0x268349(0x69a),'timestamp':Date['now'](),'isHidden':!![]};_0xebdcf2[_0x268349(0x830)][_0x268349(0x13ee)](_0x3f6c30),await _0x4e1bbf[_0x268349(0x999)][_0x268349(0x4fa)](_0xebdcf2),_0x20a638();}catch(_0x50ae84){console['error']('生成模拟聊天失败:',_0x50ae84),await _0x28974b(_0x268349(0x129b),'无法生成模拟聊天记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x50ae84[_0x268349(0x854)]);}}async function _0x3d91c8(){const _0x2afd21=_0x5a7792;if(!_0x10ae3d)return;const _0x4b4c9f=_0x3e7a1b[_0x2afd21(0x999)][_0x10ae3d];if(!_0x4b4c9f)return;try{const {proxyUrl:_0x18f9be,apiKey:_0x39f483,model:_0x24b094}=_0x3e7a1b['apiConfig'];if(!_0x18f9be||!_0x39f483||!_0x24b094)throw new Error('API未配置，无法生成对话。');const _0x33d77a=parseInt(_0x4b4c9f['settings'][_0x2afd21(0xd50)])||0xa,_0x131467=_0x4b4c9f[_0x2afd21(0x830)]['slice'](-_0x33d77a),_0x268e32=_0x4b4c9f[_0x2afd21(0xcb3)][_0x2afd21(0x96f)]||'我',_0xf88d1c=_0x4b4c9f[_0x2afd21(0xcb3)][_0x2afd21(0x1047)]||'用户',_0x77e86e='#\x20长期记忆\x20(必须严格遵守)\x0a'+(_0x4b4c9f[_0x2afd21(0x518)]&&_0x4b4c9f[_0x2afd21(0x518)][_0x2afd21(0x40f)]>0x0?_0x4b4c9f[_0x2afd21(0x518)]['map'](_0x28a76c=>'-\x20'+_0x28a76c[_0x2afd21(0x3ba)])[_0x2afd21(0xd22)]('\x0a'):'-\x20(暂无)');let _0x3cdd18='';if(_0x4b4c9f[_0x2afd21(0xcb3)][_0x2afd21(0xde4)]&&_0x4b4c9f['settings'][_0x2afd21(0xde4)]['length']>0x0){const _0xbb841f=_0x4b4c9f[_0x2afd21(0xcb3)]['linkedWorldBookIds'][_0x2afd21(0xb96)](_0x3232f6=>{const _0x4d2e43=_0x2afd21,_0x26d1dc=_0x3e7a1b[_0x4d2e43(0x144)]['find'](_0x5e65ec=>_0x5e65ec['id']===_0x3232f6);if(!_0x26d1dc||!Array[_0x4d2e43(0x97e)](_0x26d1dc[_0x4d2e43(0x3ba)]))return'';const _0xcbd9b1=_0x26d1dc['content']['filter'](_0x4d9932=>_0x4d9932[_0x4d2e43(0x9b)]!==![])[_0x4d2e43(0xb96)](_0x394179=>_0x4d2e43(0x265)+(_0x394179['comment']||_0x4d2e43(0x497))+_0x4d2e43(0x8b0)+_0x394179[_0x4d2e43(0x3ba)])[_0x4d2e43(0xd22)]('');return _0xcbd9b1?_0x4d2e43(0x228)+_0x26d1dc[_0x4d2e43(0x6fc)]+'\x0a'+_0xcbd9b1:'';})[_0x2afd21(0x156)](Boolean)[_0x2afd21(0xd22)]('');_0xbb841f&&(_0x3cdd18=_0x2afd21(0x1a0)+_0xbb841f+'\x0a');}const _0x3a2134=_0x5871dc(_0x4b4c9f,0x3,_0x2afd21(0x4b6)),_0x527d6d=_0x5871dc(_0x4b4c9f,0x6,_0x2afd21(0x4b6)),_0x5ba565=_0x5871dc(_0x4b4c9f,0x9,_0x2afd21(0x4b6)),_0x4332c6=_0x5871dc(_0x4b4c9f,0x1,_0x2afd21(0x82a)),_0xda355b=_0x5871dc(_0x4b4c9f,0x3,'days'),_0x38383a=_0x5871dc(_0x4b4c9f,0x7,'days');let _0x5c4cc8='';if(_0x3a2134||_0x527d6d||_0x5ba565||_0x4332c6||_0xda355b||_0x38383a){_0x5c4cc8+=_0x2afd21(0xd98);if(_0x3a2134)_0x5c4cc8+=_0x3a2134;if(_0x527d6d)_0x5c4cc8+=_0x527d6d;if(_0x5ba565)_0x5c4cc8+=_0x5ba565;if(_0x3a2134||_0x527d6d||_0x5ba565)_0x5c4cc8+='\x0a';if(_0x4332c6)_0x5c4cc8+=_0x4332c6;if(_0xda355b)_0x5c4cc8+=_0xda355b;if(_0x38383a)_0x5c4cc8+=_0x38383a;}const _0x4feca5=_0x5530dc(_0x4b4c9f),_0xa61e61='\x0a#\x20你的核心任务\x0a你正在扮演角色“'+_0x4b4c9f['originalName']+_0x2afd21(0x1276)+_0x4b4c9f[_0x2afd21(0xcb3)][_0x2afd21(0xbe5)]+'\x0a#\x20可用表情包\x20(必须严格遵守！)\x0a-\x20当你需要发送表情时，你【必须】从下面的列表中【精确地选择一个】含义（meaning）。\x0a-\x20【绝对禁止】使用任何不在列表中的表情含义！\x0a'+_0x4feca5+_0x2afd21(0xd1a)+_0xf88d1c+_0x2afd21(0xac2)+_0x4b4c9f['originalName']+_0x2afd21(0x10eb)+_0x268e32+'\x22\x0a'+_0x3cdd18+'\x0a'+_0x77e86e+'\x0a'+_0x5c4cc8+_0x2afd21(0x192)+_0x131467['map'](_0x18c48b=>(_0x18c48b[_0x2afd21(0x931)]==='user'?_0x268e32:_0x4b4c9f[_0x2afd21(0x6fc)])+':\x20'+String(_0x18c48b['content']))[_0x2afd21(0xd22)]('\x0a')+_0x2afd21(0x884),_0x57d291=_0x131467[_0x2afd21(0xb96)](_0x9af334=>({'role':_0x9af334[_0x2afd21(0x931)],'content':(_0x9af334['role']===_0x2afd21(0xa4d)?_0x268e32:_0x4b4c9f[_0x2afd21(0x6fc)])+':\x20'+String(_0x9af334[_0x2afd21(0x3ba)])}));let _0xebe7b8=_0x18f9be[_0x2afd21(0xe53)](_0x2afd21(0x742)),_0x4853c0=_0x250668(_0x24b094,_0x39f483,_0xa61e61,_0x57d291);const _0x48a0d9=_0xebe7b8?await fetch(_0x4853c0[_0x2afd21(0xe52)],_0x4853c0[_0x2afd21(0x88a)]):await fetch(_0x18f9be+_0x2afd21(0x58b),{'method':_0x2afd21(0x2d1),'headers':{'Content-Type':_0x2afd21(0x7fe),'Authorization':_0x2afd21(0x236)+_0x39f483},'body':JSON[_0x2afd21(0xe3f)]({'model':_0x24b094,'messages':[{'role':_0x2afd21(0x905),'content':_0xa61e61},..._0x57d291],'temperature':_0x3e7a1b['globalSettings'][_0x2afd21(0xa55)]||0.8})});if(!_0x48a0d9['ok'])throw new Error(_0x2afd21(0xfdb)+(await _0x48a0d9['json']())['error'][_0x2afd21(0x854)]);const _0x45dc88=await _0x48a0d9[_0x2afd21(0x6f8)](),_0x1f756a=getGeminiResponseText(_0x45dc88),_0x159c0f=_0x3755ce(_0x1f756a);if(!_0x159c0f||_0x159c0f['length']===0x0)throw new Error(_0x2afd21(0x552));let _0x3080e0=0x0,_0x3296e5=Date[_0x2afd21(0x2b5)]();for(const _0x4c70fc of _0x159c0f){const _0x534df6={'role':'assistant','senderName':_0x4b4c9f[_0x2afd21(0x7de)],'timestamp':_0x3296e5++};let _0x44fa47=null;switch(_0x4c70fc[_0x2afd21(0xafc)]){case _0x2afd21(0x673):_0x44fa47={..._0x534df6,'content':String(_0x4c70fc[_0x2afd21(0x3ba)]||_0x4c70fc['message'])};break;case'sticker':if(_0x4c70fc[_0x2afd21(0x10b3)]){const _0x5442e5=_0x3e7a1b[_0x2afd21(0xa8b)][_0x2afd21(0x137)](_0x5cf002=>_0x5cf002[_0x2afd21(0x6fc)]===_0x4c70fc[_0x2afd21(0x10b3)]);_0x5442e5?_0x44fa47={..._0x534df6,'type':_0x2afd21(0xefb),'content':_0x5442e5[_0x2afd21(0xe52)],'meaning':_0x5442e5[_0x2afd21(0x6fc)]}:(console[_0x2afd21(0x1155)](_0x2afd21(0x1248)+_0x4c70fc['meaning']+'\x22'),_0x44fa47={..._0x534df6,'type':_0x2afd21(0x673),'content':_0x2afd21(0x7af)+_0x4c70fc[_0x2afd21(0x10b3)]+']'});}else console['warn'](_0x2afd21(0x578),_0x4c70fc),_0x44fa47={..._0x534df6,'type':_0x2afd21(0xefb),'content':_0x4c70fc[_0x2afd21(0xe52)],'meaning':_0x2afd21(0x7ef)};break;}_0x44fa47&&(_0x4b4c9f[_0x2afd21(0x830)][_0x2afd21(0x13ee)](_0x44fa47),_0x3080e0++);}_0x3080e0>0x0&&(_0x4b4c9f[_0x2afd21(0x13c0)]=(_0x4b4c9f[_0x2afd21(0x13c0)]||0x0)+_0x3080e0),await _0x4e1bbf[_0x2afd21(0x999)][_0x2afd21(0x4fa)](_0x4b4c9f),await _0x21f6ea(),_0x3080e0>0x0&&_0x1c47b3(_0x4b4c9f['id'],'发来了\x20'+_0x3080e0+_0x2afd21(0x779));}catch(_0x2def3d){console[_0x2afd21(0xc60)]('从CPhone推进真实对话失败:',_0x2def3d),await _0x28974b(_0x2afd21(0x5b1),_0x2afd21(0x61e)+_0x2def3d[_0x2afd21(0x854)]);}}async function _0x5a25b3(){const _0x37dd4b=_0x5a7792;if(_0x302616||!_0x10ae3d)return;_0x302616=!![];const _0x5abfe0=document[_0x37dd4b(0x64f)](_0x37dd4b(0xa13)),_0x24490a=_0x3e7a1b[_0x37dd4b(0x999)][_0x10ae3d];if(!_0x24490a){_0x302616=![];return;}_0x429707(_0x5abfe0,_0x37dd4b(0x4ed));const _0x2fba2b=_0x5abfe0['scrollHeight'];await new Promise(_0x5f471c=>setTimeout(_0x5f471c,0x1f4));const _0x5b34f1=_0x24490a[_0x37dd4b(0x830)][_0x37dd4b(0x40f)],_0x51fa3f=_0x3e7a1b['globalSettings'][_0x37dd4b(0xd63)]||0x32,_0x2119f1=_0x5b34f1-_0x257fa1,_0x4792c2=Math[_0x37dd4b(0x804)](0x0,_0x2119f1-_0x51fa3f),_0x27d214=_0x24490a[_0x37dd4b(0x830)][_0x37dd4b(0xdf5)](_0x4792c2,_0x2119f1);_0x23b212(_0x5abfe0);if(_0x27d214[_0x37dd4b(0x40f)]===0x0){_0x302616=![];return;}for(const _0x599004 of _0x27d214[_0x37dd4b(0x2f4)]()){const _0x40ca1d={..._0x599004,'role':_0x599004[_0x37dd4b(0x931)]===_0x37dd4b(0xa4d)?_0x37dd4b(0x12c3):_0x37dd4b(0xa4d)},_0x358ca4={'id':_0x37dd4b(0xac3),'isGroup':![],'name':_0x24490a['name'],'settings':{..._0x24490a[_0x37dd4b(0xcb3)],'myAvatar':_0x24490a[_0x37dd4b(0xcb3)]['aiAvatar'],'myAvatarFrame':_0x24490a[_0x37dd4b(0xcb3)][_0x37dd4b(0xeba)],'aiAvatar':_0x24490a[_0x37dd4b(0xcb3)][_0x37dd4b(0x96a)],'aiAvatarFrame':_0x24490a[_0x37dd4b(0xcb3)][_0x37dd4b(0x5b4)]}},_0x2d2dad=await _0x3209f4(_0x40ca1d,_0x358ca4);_0x2d2dad&&_0x5abfe0[_0x37dd4b(0x7f5)](_0x2d2dad);}_0x257fa1+=_0x27d214[_0x37dd4b(0x40f)];const _0x28e4aa=_0x5abfe0[_0x37dd4b(0x1ba)];_0x5abfe0[_0x37dd4b(0xed7)]=_0x28e4aa-_0x2fba2b,_0x302616=![];}async function _0x2d6914(_0x181e2e){const _0x1f295f=_0x5a7792,_0x53e2c2=_0x3e7a1b['chats'][_0x10ae3d];if(!_0x53e2c2)return;_0x3b731f=_0x181e2e===-0x1?_0x1f295f(0x744):_0x53e2c2['simulatedConversations'][_0x181e2e]?.[_0x1f295f(0xafc)];const _0x2b200b=document['getElementById'](_0x1f295f(0xa13));_0x2b200b[_0x1f295f(0xc58)]='',_0x2b200b['dataset']['theme']=_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0xb3d)]||_0x1f295f(0xf5d);const _0x3b4e5e=document[_0x1f295f(0x64f)](_0x1f295f(0x4f8))[_0x1f295f(0x418)][_0x1f295f(0xef6)](_0x1f295f(0x1313));_0x2b200b[_0x1f295f(0x731)][_0x1f295f(0xfd6)]=_0x3b4e5e?_0x1f295f(0xfd8):_0x1f295f(0x3f0);let _0x4c3ce7,_0x164f89=[];const _0x1a5e03=await _0x4e1bbf[_0x1f295f(0xad7)][_0x1f295f(0x78f)](),_0x586772=new Map(_0x1a5e03[_0x1f295f(0xb96)](_0x21a88a=>[_0x21a88a[_0x1f295f(0x6fc)],_0x21a88a]));if(_0x181e2e===-0x1){_0x3b731f=_0x1f295f(0x744);const _0x12679a=document[_0x1f295f(0x64f)](_0x1f295f(0x784)),_0x27bcea=document[_0x1f295f(0x64f)](_0x1f295f(0x30c));_0x2b200b[_0x1f295f(0xc58)]='',_0x12679a[_0x1f295f(0xee5)]=_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0x96f)]||(_0x3e7a1b[_0x1f295f(0x3c2)][_0x1f295f(0x78c)]||'我'),_0x27bcea[_0x1f295f(0x1323)]='与\x20'+(_0x53e2c2['settings']['myNickname']||'我')+'\x20的对话\x20(只读)',_0x257fa1=0x0,_0x302616=![];const _0xf194c8=_0x53e2c2[_0x1f295f(0x830)],_0x208555=_0x3e7a1b['globalSettings'][_0x1f295f(0xd63)]||0x32,_0x4aefc1=_0xf194c8[_0x1f295f(0xdf5)](-_0x208555);_0x4c3ce7={'id':_0x1f295f(0xac3),'isGroup':![],'name':_0x53e2c2[_0x1f295f(0x6fc)],'settings':{..._0x53e2c2[_0x1f295f(0xcb3)],'myAvatar':_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0x93)],'myAvatarFrame':_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0xeba)],'aiAvatar':_0x53e2c2['settings'][_0x1f295f(0x96a)],'aiAvatarFrame':_0x53e2c2['settings']['myAvatarFrame']}},_0x164f89=_0x4aefc1[_0x1f295f(0xb96)](_0x3ed999=>({..._0x3ed999,'role':_0x3ed999[_0x1f295f(0x931)]===_0x1f295f(0xa4d)?_0x1f295f(0x12c3):_0x1f295f(0xa4d)})),_0x257fa1=_0x4aefc1[_0x1f295f(0x40f)];}else{const _0x4a451c=_0x53e2c2['simulatedConversations'][_0x181e2e];if(!_0x4a451c)return;_0x3b731f=_0x4a451c['type'];const _0x4a58a4=document[_0x1f295f(0x64f)](_0x1f295f(0x784)),_0x53c1e1=document[_0x1f295f(0x64f)](_0x1f295f(0x30c));if(_0x4a451c[_0x1f295f(0xafc)]===_0x1f295f(0xa40))_0x4a58a4['textContent']=_0x4a451c[_0x1f295f(0x1221)]+'\x20('+(_0x4a451c['participants'][_0x1f295f(0x40f)]+0x1)+')',_0x53c1e1[_0x1f295f(0x1323)]='在\x20'+_0x4a451c[_0x1f295f(0x1221)]+_0x1f295f(0xc08),_0x4c3ce7={'id':_0x1f295f(0xfec),'isGroup':!![],'name':_0x4a451c[_0x1f295f(0x1221)],'originalName':_0x53e2c2['originalName'],'members':_0x4a451c['participants'][_0x1f295f(0xb96)](_0x590e78=>{const _0x1e28e1=_0x1f295f,_0x4023ce=_0x586772[_0x1e28e1(0x11fc)](_0x590e78[_0x1e28e1(0x6fc)]);let _0x3c085b=_0x4023ce&&_0x4023ce[_0x1e28e1(0x1265)]?_0x4023ce[_0x1e28e1(0x1265)]:_0x3e7a1b[_0x1e28e1(0x11b4)][_0x1e28e1(0xc83)]?'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x590e78[_0x1e28e1(0x597)]||_0x1e28e1(0x63d)):_0x480024;return{'originalName':_0x590e78[_0x1e28e1(0x6fc)],'groupNickname':_0x590e78[_0x1e28e1(0x6fc)],'avatar':_0x3c085b};}),'settings':{..._0x53e2c2['settings'],'myNickname':_0x53e2c2[_0x1f295f(0x6fc)],'myAvatar':_0x53e2c2['settings'][_0x1f295f(0x93)],'myAvatarFrame':_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0xeba)]}};else{_0x4a58a4[_0x1f295f(0xee5)]=_0x4a451c['participant'][_0x1f295f(0x6fc)],_0x53c1e1[_0x1f295f(0x1323)]='与\x20'+_0x4a451c[_0x1f295f(0x13e5)]['name']+'\x20的对话';const _0x44eaaa=_0x586772[_0x1f295f(0x11fc)](_0x4a451c[_0x1f295f(0x13e5)][_0x1f295f(0x6fc)]),_0xa75f10=_0x44eaaa&&_0x44eaaa['avatar']?_0x44eaaa['avatar']:_0x3e7a1b[_0x1f295f(0x11b4)][_0x1f295f(0xc83)]?_0x1f295f(0xb1f)+encodeURIComponent(_0x4a451c[_0x1f295f(0x13e5)][_0x1f295f(0x597)]||_0x1f295f(0x63d)):_0x480024;_0x4c3ce7={'id':_0x1f295f(0xbcc),'isGroup':![],'name':_0x4a451c[_0x1f295f(0x13e5)][_0x1f295f(0x6fc)],'originalName':_0x53e2c2['originalName'],'settings':{..._0x53e2c2[_0x1f295f(0xcb3)],'myAvatar':_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0x93)],'myAvatarFrame':_0x53e2c2[_0x1f295f(0xcb3)][_0x1f295f(0xeba)],'aiAvatar':_0xa75f10,'aiAvatarFrame':''}};}_0x164f89=_0x4a451c[_0x1f295f(0x9a4)];}for(const _0x2cdfe4 of _0x164f89){let _0x1f66ee=_0x2cdfe4[_0x1f295f(0x931)];if(_0x181e2e!==-0x1){const _0x391dab=_0x2cdfe4[_0x1f295f(0xeeb)]===(_0x53e2c2[_0x1f295f(0x7de)]||_0x53e2c2[_0x1f295f(0x6fc)]);_0x1f66ee=_0x391dab?_0x1f295f(0xa4d):_0x1f295f(0x12c3);}const _0x5f2f9c={'role':_0x1f66ee,'senderName':_0x2cdfe4[_0x1f295f(0xeeb)]||(_0x1f66ee===_0x1f295f(0xa4d)?_0x4c3ce7[_0x1f295f(0xcb3)][_0x1f295f(0x96f)]:_0x4c3ce7['name']),'timestamp':_0x2cdfe4['timestamp']||Date[_0x1f295f(0x2b5)]()+Math[_0x1f295f(0x95f)]()};if(_0x2cdfe4[_0x1f295f(0xafc)]===_0x1f295f(0xefb)&&_0x2cdfe4['meaning']){const _0x5e4a5c=_0x3e7a1b[_0x1f295f(0xa8b)]['find'](_0x20b893=>_0x20b893['name']===_0x2cdfe4[_0x1f295f(0x10b3)]);_0x5e4a5c?(_0x5f2f9c[_0x1f295f(0x3ba)]=_0x5e4a5c['url'],_0x5f2f9c['meaning']=_0x2cdfe4[_0x1f295f(0x10b3)],_0x5f2f9c[_0x1f295f(0xafc)]='sticker'):(console[_0x1f295f(0x1155)](_0x1f295f(0x10d3)+_0x2cdfe4[_0x1f295f(0x10b3)]+'\x22\x20在库中未找到。'),_0x5f2f9c[_0x1f295f(0x3ba)]='[表情:\x20'+_0x2cdfe4['meaning']+']',_0x5f2f9c[_0x1f295f(0xafc)]=_0x1f295f(0x673));}else _0x5f2f9c['content']=_0x2cdfe4[_0x1f295f(0x3ba)],_0x5f2f9c['type']=_0x2cdfe4[_0x1f295f(0xafc)]||_0x1f295f(0x673);const _0x37a74f=await _0x3209f4(_0x5f2f9c,_0x4c3ce7);_0x37a74f&&_0x2b200b[_0x1f295f(0x99e)](_0x37a74f);}_0xdfc697(_0x1f295f(0x20d)),setTimeout(()=>_0x2b200b[_0x1f295f(0xed7)]=_0x2b200b[_0x1f295f(0x1ba)],0x0);}function _0x20ebef(){const _0x152c3d=_0x5a7792;document[_0x152c3d(0x64f)](_0x152c3d(0x1097))[_0x152c3d(0x418)]['remove'](_0x152c3d(0x40a));}async function _0x172c8c(){const _0x3f4e6e=_0x5a7792;if(!_0x10ae3d)return;const _0x17c1f7=_0x3e7a1b[_0x3f4e6e(0x999)][_0x10ae3d];if(!_0x17c1f7){await _0x28974b('操作失败',_0x3f4e6e(0x46b));return;}await _0x28974b(_0x3f4e6e(0x2f7),_0x3f4e6e(0x5ad)+_0x17c1f7['name']+_0x3f4e6e(0x12ee));const {proxyUrl:_0x10de4f,apiKey:_0x511def,model:_0x2d51c5}=_0x3e7a1b['apiConfig'];if(!_0x10de4f||!_0x511def||!_0x2d51c5){alert(_0x3f4e6e(0x1ce));return;}const _0x2bca24=_0x3e7a1b[_0x3f4e6e(0x3c2)][_0x3f4e6e(0x78c)]===_0x3f4e6e(0x1028)||!_0x3e7a1b['qzoneSettings'][_0x3f4e6e(0x78c)]?'用户':_0x3e7a1b[_0x3f4e6e(0x3c2)][_0x3f4e6e(0x78c)],_0x459e65=_0x17c1f7[_0x3f4e6e(0x518)]&&_0x17c1f7[_0x3f4e6e(0x518)][_0x3f4e6e(0x40f)]>0x0?_0x17c1f7[_0x3f4e6e(0x518)]['map'](_0x507725=>_0x3f4e6e(0x56b)+_0x4942eb(_0x507725[_0x3f4e6e(0x8af)])+')\x20'+_0x507725[_0x3f4e6e(0x3ba)])[_0x3f4e6e(0xd22)]('\x0a'):'无',_0x7f853c=_0x17c1f7[_0x3f4e6e(0xcb3)][_0x3f4e6e(0xd50)]||0xa,_0x3b52c1=_0x17c1f7[_0x3f4e6e(0x830)][_0x3f4e6e(0xdf5)](-_0x7f853c)[_0x3f4e6e(0xb96)](_0x502c01=>(_0x502c01[_0x3f4e6e(0x931)]===_0x3f4e6e(0xa4d)?_0x2bca24:_0x17c1f7[_0x3f4e6e(0x6fc)])+':\x20'+String(_0x502c01[_0x3f4e6e(0x3ba)])[_0x3f4e6e(0x126f)](0x0,0x1e)+'...')[_0x3f4e6e(0xd22)]('\x0a'),_0x465370=(_0x17c1f7[_0x3f4e6e(0xcb3)][_0x3f4e6e(0xde4)]||[])[_0x3f4e6e(0xb96)](_0x108500=>_0x3e7a1b[_0x3f4e6e(0x144)]['find'](_0x2aa278=>_0x2aa278['id']===_0x108500))[_0x3f4e6e(0x156)](Boolean)[_0x3f4e6e(0xb96)](_0x5aca31=>_0x3f4e6e(0x1272)+_0x5aca31['name']+_0x3f4e6e(0xc4d)+_0x5aca31[_0x3f4e6e(0x3ba)][_0x3f4e6e(0x156)](_0x25a3b4=>_0x25a3b4['enabled'])['map'](_0x44f48b=>'-\x20'+_0x44f48b[_0x3f4e6e(0x3ba)])['join']('\x0a'))[_0x3f4e6e(0xd22)](''),_0x4fbfbf=_0x5871dc(_0x17c1f7,0x3,_0x3f4e6e(0x4b6)),_0x153484=_0x5871dc(_0x17c1f7,0x6,_0x3f4e6e(0x4b6)),_0x5ec712=_0x5871dc(_0x17c1f7,0x9,_0x3f4e6e(0x4b6)),_0x5d202d=_0x5871dc(_0x17c1f7,0x1,_0x3f4e6e(0x82a)),_0x587563=_0x5871dc(_0x17c1f7,0x3,_0x3f4e6e(0x82a)),_0x3e3878=_0x5871dc(_0x17c1f7,0x7,'days');let _0x37fbf3='';if(_0x4fbfbf||_0x153484||_0x5ec712||_0x5d202d||_0x587563||_0x3e3878){_0x37fbf3+=_0x3f4e6e(0xd98);if(_0x4fbfbf)_0x37fbf3+=_0x4fbfbf;if(_0x153484)_0x37fbf3+=_0x153484;if(_0x5ec712)_0x37fbf3+=_0x5ec712;if(_0x4fbfbf||_0x153484||_0x5ec712)_0x37fbf3+='\x0a';if(_0x5d202d)_0x37fbf3+=_0x5d202d;if(_0x587563)_0x37fbf3+=_0x587563;if(_0x3e3878)_0x37fbf3+=_0x3e3878;}const _0x1e15b7=_0x3f4e6e(0x9d2)+_0x17c1f7[_0x3f4e6e(0x6fc)]+'”，并根据其人设、记忆和最近的互动，构思出【8到10张】TA最近可能会拍摄或珍藏在手机相册里的照片。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20照片内容必须完全符合角色的性格、爱好、职业和生活环境。\x0a2.\x20\x20**多样性**:\x20照片主题要丰富，可以包括自拍、风景、食物、宠物、朋友合影、工作场景等。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一张照片，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是照片背后的故事或角色的心情日记，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张照片的、详细的【英文】关键词。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20绝对禁止】**:\x20绝对禁止包含任何中文字符、句子、特殊符号、或任何可能涉及敏感（NSFW）、暴力、血腥、政治的内容！也禁止真人！\x0a\x20\x20\x20\x20-\x20**【image_prompt\x20必须是】**:\x20必须是纯英文的、用逗号分隔的【关键词组合】\x20(e.g.,\x20\x221boy,\x20solo,\x20basketball\x20jersey,\x20in\x20locker\x20room,\x20smiling,\x20selfie\x22)。\x0a\x20\x20\x20\x20-\x20**【画风指令】**:\x20在\x20prompt\x20的末尾，总是加上画风指令，例如：\x20`best\x20quality,\x20masterpiece,\x20anime\x20style,\x20cinematic\x20lighting`\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0x17c1f7[_0x3f4e6e(0xcb3)]['aiPersona']+'\x0a'+_0x459e65+'\x0a'+_0x465370+'\x0a'+_0x37fbf3+_0x3f4e6e(0x12f5)+_0x2bca24+'”的对话摘要**:\x0a'+_0x3b52c1+_0x3f4e6e(0x9a1);try{const _0x5922b5=[{'role':_0x3f4e6e(0xa4d),'content':_0x3f4e6e(0x85)}];let _0x2b5b0b=_0x10de4f[_0x3f4e6e(0xe53)]('generativelanguage'),_0x23e991=_0x250668(_0x2d51c5,_0x511def,_0x1e15b7,_0x5922b5);const _0xf7cb68=_0x2b5b0b?await fetch(_0x23e991[_0x3f4e6e(0xe52)],_0x23e991[_0x3f4e6e(0x88a)]):await fetch(_0x10de4f+_0x3f4e6e(0x58b),{'method':_0x3f4e6e(0x2d1),'headers':{'Content-Type':_0x3f4e6e(0x7fe),'Authorization':'Bearer\x20'+_0x511def},'body':JSON[_0x3f4e6e(0xe3f)]({'model':_0x2d51c5,'messages':[{'role':_0x3f4e6e(0x905),'content':_0x1e15b7},..._0x5922b5],'temperature':_0x3e7a1b['globalSettings'][_0x3f4e6e(0xa55)]||0.9})});if(!_0xf7cb68['ok'])throw new Error(_0x3f4e6e(0x1fa)+_0xf7cb68[_0x3f4e6e(0x132c)]);const _0x1e5941=await _0xf7cb68['json'](),_0x1a165c=getGeminiResponseText(_0x1e5941),_0x5c26a4=_0x1a165c[_0x3f4e6e(0x132a)](/(\[[\s\S]*\])/);if(!_0x5c26a4||!_0x5c26a4[0x0])throw new Error(_0x3f4e6e(0x909)+_0x1a165c);const _0x239452=_0x5c26a4[0x0];let _0x48ba42;try{_0x48ba42=JSON['parse'](_0x239452);}catch(_0x57e525){throw new Error(_0x3f4e6e(0xc8c)+_0x57e525['message']+_0x3f4e6e(0xa91)+_0x1a165c);}_0x17c1f7['simulatedAlbum']=_0x48ba42,await _0x4e1bbf[_0x3f4e6e(0x999)][_0x3f4e6e(0x4fa)](_0x17c1f7),await _0x314a4a();}catch(_0x2eeab4){console[_0x3f4e6e(0xc60)](_0x3f4e6e(0xbd3),_0x2eeab4),await _0x28974b(_0x3f4e6e(0x129b),'无法生成模拟相册，请检查API配置或稍后再试。\x0a错误:\x20'+_0x2eeab4[_0x3f4e6e(0x854)]);}}async function _0x314a4a(){const _0x3c8383=_0x5a7792,_0x2dee99=document[_0x3c8383(0x64f)](_0x3c8383(0xb66));_0x2dee99[_0x3c8383(0xc58)]='';if(!_0x10ae3d)return;const _0x579be2=_0x3e7a1b[_0x3c8383(0x999)][_0x10ae3d],_0x5308b3=_0x579be2['simulatedAlbum']||[];if(_0x5308b3[_0x3c8383(0x40f)]===0x0){_0x2dee99[_0x3c8383(0xc58)]=_0x3c8383(0x124b);return;}const _0x32a65a=_0x3c8383(0x716);_0x5308b3[_0x3c8383(0x103)](_0x22d023=>{const _0x24a801=_0x3c8383,_0x432f20=document[_0x24a801(0x124e)]('div');_0x432f20[_0x24a801(0x87d)]=_0x24a801(0xed4),_0x432f20[_0x24a801(0x12e1)][_0x24a801(0x9af)]=_0x22d023['description'],_0x2dee99['appendChild'](_0x432f20);if(_0x3e7a1b[_0x24a801(0x11b4)][_0x24a801(0xc83)]){_0x432f20[_0x24a801(0x731)]['backgroundColor']=_0x24a801(0xf2d);const _0x4081d6=/[^\x00-\x7F]/[_0x24a801(0x4af)](_0x22d023[_0x24a801(0x242)]),_0x4775f9=_0x22d023[_0x24a801(0x242)]&&_0x22d023['image_prompt'][_0x24a801(0x43a)]()&&!_0x4081d6,_0xf8b2ff=_0x4775f9?_0x22d023[_0x24a801(0x242)]:_0x24a801(0x34b),_0x4abf08='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0xf8b2ff),_0x1469c0=new Image();_0x1469c0['onload']=function(){const _0x58724f=_0x24a801;_0x432f20['style'][_0x58724f(0x4d6)]=_0x58724f(0xec1)+this[_0x58724f(0xbe8)]+')';},_0x1469c0[_0x24a801(0x36b)]=function(){const _0x54772a=_0x24a801;_0x432f20[_0x54772a(0x731)]['backgroundImage']='url('+_0x32a65a+')';},_0x1469c0[_0x24a801(0xbe8)]=_0x4abf08;}else{_0x432f20[_0x24a801(0x731)][_0x24a801(0xfd6)]='#f0f2f5',_0x432f20[_0x24a801(0x731)][_0x24a801(0xb94)]=_0x24a801(0xa49);const _0x40934f=document[_0x24a801(0x124e)]('p');_0x40934f[_0x24a801(0x87d)]=_0x24a801(0x1213),_0x40934f[_0x24a801(0xee5)]=_0x22d023[_0x24a801(0x9af)]||_0x24a801(0x8c0),_0x432f20['appendChild'](_0x40934f);}});}async function _0x551f53(){const _0x46285e=_0x5a7792;if(!_0x10ae3d)return;const _0x27a547=_0x3e7a1b[_0x46285e(0x999)][_0x10ae3d];if(!_0x27a547)return;await _0x28974b(_0x46285e(0x2f7),_0x46285e(0xc0d)+_0x27a547['name']+'”的网上冲浪足迹...');const {proxyUrl:_0x392df5,apiKey:_0x34f9e5,model:_0xf81810}=_0x3e7a1b[_0x46285e(0xec0)];if(!_0x392df5||!_0x34f9e5||!_0xf81810){alert('API未配置，无法生成内容。');return;}const _0x5de906=_0x3e7a1b[_0x46285e(0x3c2)][_0x46285e(0x78c)]==='{{user}}'||!_0x3e7a1b[_0x46285e(0x3c2)][_0x46285e(0x78c)]?'用户':_0x3e7a1b['qzoneSettings'][_0x46285e(0x78c)],_0xf35dcb=_0x27a547[_0x46285e(0x518)]&&_0x27a547[_0x46285e(0x518)]['length']>0x0?_0x27a547[_0x46285e(0x518)][_0x46285e(0xb96)](_0xce313f=>_0x46285e(0x56b)+_0x4942eb(_0xce313f[_0x46285e(0x8af)])+')\x20'+_0xce313f['content'])['join']('\x0a'):'无',_0x56adda=_0x27a547['settings'][_0x46285e(0xd50)]||0xa,_0x4e8718=_0x27a547['history'][_0x46285e(0xdf5)](-_0x56adda)[_0x46285e(0xb96)](_0x555a07=>(_0x555a07['role']==='user'?_0x5de906:_0x27a547[_0x46285e(0x6fc)])+':\x20'+String(_0x555a07['content'])[_0x46285e(0x126f)](0x0,0x1e)+'...')[_0x46285e(0xd22)]('\x0a'),_0x270a73=(_0x27a547[_0x46285e(0xcb3)][_0x46285e(0xde4)]||[])[_0x46285e(0xb96)](_0x2a732d=>_0x3e7a1b['worldBooks'][_0x46285e(0x137)](_0x504157=>_0x504157['id']===_0x2a732d))[_0x46285e(0x156)](Boolean)[_0x46285e(0xb96)](_0x1be79f=>_0x46285e(0x1272)+_0x1be79f[_0x46285e(0x6fc)]+_0x46285e(0xc4d)+_0x1be79f['content'][_0x46285e(0x156)](_0x20a205=>_0x20a205[_0x46285e(0x9b)])['map'](_0x22862c=>'-\x20'+_0x22862c['content'])[_0x46285e(0xd22)]('\x0a'))[_0x46285e(0xd22)](''),_0x2f2e4b=_0x5871dc(_0x27a547,0x3,_0x46285e(0x4b6)),_0xca0c5c=_0x5871dc(_0x27a547,0x6,_0x46285e(0x4b6)),_0x8a42eb=_0x5871dc(_0x27a547,0x9,_0x46285e(0x4b6)),_0x36f950=_0x5871dc(_0x27a547,0x1,_0x46285e(0x82a)),_0x49bb3e=_0x5871dc(_0x27a547,0x3,_0x46285e(0x82a)),_0xe3743f=_0x5871dc(_0x27a547,0x7,_0x46285e(0x82a));let _0x3efbc1='';if(_0x2f2e4b||_0xca0c5c||_0x8a42eb||_0x36f950||_0x49bb3e||_0xe3743f){_0x3efbc1+=_0x46285e(0xd98);if(_0x2f2e4b)_0x3efbc1+=_0x2f2e4b;if(_0xca0c5c)_0x3efbc1+=_0xca0c5c;if(_0x8a42eb)_0x3efbc1+=_0x8a42eb;if(_0x2f2e4b||_0xca0c5c||_0x8a42eb)_0x3efbc1+='\x0a';if(_0x36f950)_0x3efbc1+=_0x36f950;if(_0x49bb3e)_0x3efbc1+=_0x49bb3e;if(_0xe3743f)_0x3efbc1+=_0xe3743f;}const _0x46d5d8=_0x27a547[_0x46285e(0xcb3)][_0x46285e(0x1047)]||_0x46285e(0x9ef),_0x2ce29e=_0x46285e(0x9d2)+_0x27a547['name']+_0x46285e(0x617)+_0x27a547[_0x46285e(0xcb3)]['aiPersona']+_0x46285e(0x86a)+_0x46d5d8+_0x46285e(0x7e5)+_0xf35dcb+'\x0a'+_0x270a73+'\x0a'+_0x3efbc1+_0x46285e(0x12f5)+_0x5de906+_0x46285e(0x10be)+_0x4e8718+'\x0a\x0a现在，请开始生成这组【纯文本】的浏览记录。';try{const _0x59b816=[{'role':_0x46285e(0xa4d),'content':_0x46285e(0x7a5)}];let _0x2574ab=_0x392df5[_0x46285e(0xe53)]('generativelanguage'),_0x2c725c=_0x250668(_0xf81810,_0x34f9e5,_0x2ce29e,_0x59b816);const _0x1d597d=_0x2574ab?await fetch(_0x2c725c[_0x46285e(0xe52)],_0x2c725c[_0x46285e(0x88a)]):await fetch(_0x392df5+_0x46285e(0x58b),{'method':_0x46285e(0x2d1),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x34f9e5},'body':JSON['stringify']({'model':_0xf81810,'messages':[{'role':'system','content':_0x2ce29e},..._0x59b816],'temperature':_0x3e7a1b[_0x46285e(0x11b4)]['apiTemperature']||0.9})});if(!_0x1d597d['ok'])throw new Error(_0x46285e(0x1fa)+_0x1d597d[_0x46285e(0x132c)]);const _0x548965=await _0x1d597d[_0x46285e(0x6f8)](),_0x2dbc3a=getGeminiResponseText(_0x548965),_0x5efc7b=_0x2dbc3a[_0x46285e(0x132a)](/(\[[\s\S]*\])/);if(!_0x5efc7b||!_0x5efc7b[0x0])throw new Error(_0x46285e(0x909)+_0x2dbc3a);const _0x57e822=_0x5efc7b[0x0];let _0x1cc8bc;try{_0x1cc8bc=JSON[_0x46285e(0x1214)](_0x57e822);}catch(_0x72d9c5){throw new Error(_0x46285e(0xc8c)+_0x72d9c5['message']+_0x46285e(0xa91)+_0x2dbc3a);}_0x27a547['simulatedBrowserHistory']=_0x1cc8bc,await _0x4e1bbf[_0x46285e(0x999)]['put'](_0x27a547),await _0x2a38dc();}catch(_0x59fd30){console['error']('生成模拟浏览器历史失败:',_0x59fd30),await _0x28974b(_0x46285e(0x129b),_0x46285e(0xef9)+_0x59fd30[_0x46285e(0x854)]);}}function _0x2a38dc(){const _0x42ac7c=_0x5a7792,_0x1505a8=document[_0x42ac7c(0x64f)](_0x42ac7c(0xfba));_0x1505a8[_0x42ac7c(0xc58)]='';if(!_0x10ae3d)return;const _0x213308=_0x3e7a1b[_0x42ac7c(0x999)][_0x10ae3d],_0x3a38fb=_0x213308[_0x42ac7c(0x1064)]||[];if(_0x3a38fb['length']===0x0){_0x1505a8[_0x42ac7c(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的浏览器空空如也，<br>点击右上角刷新按钮生成一些记录吧！</p>';return;}_0x3a38fb[_0x42ac7c(0x103)]((_0xeaf05f,_0x35afce)=>{const _0x143e9c=_0x42ac7c,_0x1d3cce=document[_0x143e9c(0x124e)]('div');_0x1d3cce[_0x143e9c(0x87d)]=_0x143e9c(0x1366),_0x1d3cce[_0x143e9c(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>'+_0xeaf05f[_0x143e9c(0x1250)]+_0x143e9c(0x1066)+_0xeaf05f[_0x143e9c(0xe52)]+_0x143e9c(0x9df),_0x1d3cce['addEventListener'](_0x143e9c(0x1080),()=>_0x5f08d5(_0x35afce)),_0x1505a8['appendChild'](_0x1d3cce);});}async function _0x5f08d5(_0x4b251f){const _0x26d521=_0x5a7792,_0x27f0ac=_0x3e7a1b['chats'][_0x10ae3d],_0x20ffeb=_0x27f0ac[_0x26d521(0x1064)][_0x4b251f];if(!_0x20ffeb)return;_0x3a52bc=_0x20ffeb,_0x466c7d(_0x20ffeb),_0xdfc697(_0x26d521(0x184));const _0x115661=document[_0x26d521(0x64f)](_0x26d521(0xcfb)),_0x563ce6=await _0x4e1bbf['favorites'][_0x26d521(0xec9)]({'type':_0x26d521(0x12d1),'content.url':_0x20ffeb[_0x26d521(0xe52)]})[_0x26d521(0x5dd)]();_0x115661[_0x26d521(0x418)][_0x26d521(0x5cf)](_0x26d521(0x12ef),!!_0x563ce6);}async function _0x4c8f46(){const _0x1b49dc=_0x5a7792;if(!_0x3a52bc||!_0x10ae3d)return;const _0x2e8dd7=_0x3a52bc,_0x5dbbdc=_0x3e7a1b[_0x1b49dc(0x999)][_0x10ae3d],_0x5b2470=document[_0x1b49dc(0x64f)](_0x1b49dc(0xcfb)),_0x5a1bfc=await _0x4e1bbf['favorites'][_0x1b49dc(0xec9)]({'type':_0x1b49dc(0x12d1),'content.url':_0x2e8dd7['url']})[_0x1b49dc(0x5dd)]();if(_0x5a1bfc)await _0x4e1bbf[_0x1b49dc(0x1232)]['delete'](_0x5a1bfc['id']),_0x5b2470[_0x1b49dc(0x418)][_0x1b49dc(0x1275)]('active'),await _0x28974b(_0x1b49dc(0x722),_0x1b49dc(0x611));else{const _0x3d3ef0={'type':_0x1b49dc(0x12d1),'content':{..._0x2e8dd7,'characterId':_0x10ae3d,'characterName':_0x5dbbdc['name']},'timestamp':Date[_0x1b49dc(0x2b5)]()};await _0x4e1bbf['favorites'][_0x1b49dc(0xdda)](_0x3d3ef0),_0x5b2470[_0x1b49dc(0x418)][_0x1b49dc(0xdda)](_0x1b49dc(0x12ef)),await _0x28974b('操作成功',_0x1b49dc(0xa31));}}function _0x466c7d(_0x5bed73){const _0x238fc1=_0x5a7792,_0x64e3a=document['getElementById']('char-article-title'),_0x15f824=document[_0x238fc1(0x64f)](_0x238fc1(0x1104));_0x64e3a['textContent']=_0x5bed73[_0x238fc1(0x1250)],_0x15f824[_0x238fc1(0xc58)]='',_0x5bed73[_0x238fc1(0xafc)]===_0x238fc1(0x980)?_0x15f824[_0x238fc1(0xc58)]=_0x238fc1(0x9b0)+(_0x5bed73[_0x238fc1(0x1250)]||_0x238fc1(0x111a))+'</p>':_0x15f824[_0x238fc1(0xc58)]=_0x238fc1(0xb23)+(_0x5bed73['content']||_0x238fc1(0x13d5))['replace'](/\n/g,_0x238fc1(0x75))+'</p>';}async function _0x1c0173(){const _0x2839aa=_0x5a7792;if(!_0x10ae3d)return;const _0xd90b87=_0x3e7a1b[_0x2839aa(0x999)][_0x10ae3d];if(!_0xd90b87)return;await _0x28974b(_0x2839aa(0x2f7),_0x2839aa(0xc0d)+_0xd90b87[_0x2839aa(0x6fc)]+_0x2839aa(0x2bf));const {proxyUrl:_0x2b285b,apiKey:_0x5283d7,model:_0x10992b}=_0x3e7a1b['apiConfig'];if(!_0x2b285b||!_0x5283d7||!_0x10992b){alert(_0x2839aa(0xb6a));return;}const _0x2315e4=_0x3e7a1b[_0x2839aa(0x3c2)][_0x2839aa(0x78c)]===_0x2839aa(0x1028)||!_0x3e7a1b['qzoneSettings'][_0x2839aa(0x78c)]?'用户':_0x3e7a1b[_0x2839aa(0x3c2)][_0x2839aa(0x78c)],_0xf487a5=_0xd90b87['longTermMemory']&&_0xd90b87[_0x2839aa(0x518)][_0x2839aa(0x40f)]>0x0?_0xd90b87['longTermMemory'][_0x2839aa(0xb96)](_0x3da8c4=>_0x2839aa(0x56b)+_0x4942eb(_0x3da8c4[_0x2839aa(0x8af)])+')\x20'+_0x3da8c4[_0x2839aa(0x3ba)])[_0x2839aa(0xd22)]('\x0a'):'无',_0x1d5573=_0xd90b87[_0x2839aa(0xcb3)][_0x2839aa(0xd50)]||0xa,_0x4e5323=_0xd90b87[_0x2839aa(0x830)]['slice'](-_0x1d5573)[_0x2839aa(0xb96)](_0x5af66d=>(_0x5af66d[_0x2839aa(0x931)]==='user'?_0x2315e4:_0xd90b87[_0x2839aa(0x6fc)])+':\x20'+String(_0x5af66d[_0x2839aa(0x3ba)])[_0x2839aa(0x126f)](0x0,0x1e)+_0x2839aa(0x3cd))[_0x2839aa(0xd22)]('\x0a'),_0x27c788=(_0xd90b87[_0x2839aa(0xcb3)][_0x2839aa(0xde4)]||[])['map'](_0x5ac4f1=>_0x3e7a1b[_0x2839aa(0x144)]['find'](_0x371822=>_0x371822['id']===_0x5ac4f1))[_0x2839aa(0x156)](Boolean)['map'](_0x1d962f=>_0x2839aa(0x1272)+_0x1d962f[_0x2839aa(0x6fc)]+_0x2839aa(0xc4d)+_0x1d962f[_0x2839aa(0x3ba)][_0x2839aa(0x156)](_0x31e411=>_0x31e411[_0x2839aa(0x9b)])['map'](_0x4ed46a=>'-\x20'+_0x4ed46a[_0x2839aa(0x3ba)])[_0x2839aa(0xd22)]('\x0a'))['join'](''),_0x197abe=_0x5871dc(_0xd90b87,0x3,_0x2839aa(0x4b6)),_0x54bcd0=_0x5871dc(_0xd90b87,0x6,_0x2839aa(0x4b6)),_0x48007b=_0x5871dc(_0xd90b87,0x9,_0x2839aa(0x4b6)),_0x364e08=_0x5871dc(_0xd90b87,0x1,'days'),_0x87ed63=_0x5871dc(_0xd90b87,0x3,_0x2839aa(0x82a)),_0xb8f74e=_0x5871dc(_0xd90b87,0x7,'days');let _0x2a4d12='';if(_0x197abe||_0x54bcd0||_0x48007b||_0x364e08||_0x87ed63||_0xb8f74e){_0x2a4d12+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x197abe)_0x2a4d12+=_0x197abe;if(_0x54bcd0)_0x2a4d12+=_0x54bcd0;if(_0x48007b)_0x2a4d12+=_0x48007b;if(_0x197abe||_0x54bcd0||_0x48007b)_0x2a4d12+='\x0a';if(_0x364e08)_0x2a4d12+=_0x364e08;if(_0x87ed63)_0x2a4d12+=_0x87ed63;if(_0xb8f74e)_0x2a4d12+=_0xb8f74e;}const _0x3681a7='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0xd90b87[_0x2839aa(0x6fc)]+'”，并根据其人设、记忆和最近的互动，虚构出TA最近的淘宝购物记录和账户余额。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**余额铁律\x20(最高优先级)**:\x20你【必须】根据角色的【经济状况】设定一个合理的\x20`totalBalance`\x20(总余额)。例如，富有的角色应该有更高的余额，而学生或经济拮据的角色则应该有较低的余额。\x0a2.\x20\x20**合理性**:\x20购买记录必须完全符合角色的性格、爱好和经济状况。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22totalBalance\x22:\x2012345.67,\x20//\x20(这是一个示例数字，你必须根据角色的经济状况生成一个全新的、合理的余额！)\x0a\x20\x20\x20\x20\x20\x20\x22purchases\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22itemName\x22:\x20\x22一个具体、生动的商品名称\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x20128.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22已签收\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22reason\x22:\x20\x22这是角色购买这件商品的内心独白或理由，必须使用第一人称“我”来写。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22一段用于生成这张商品图片的、详细的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**purchases**:\x20一个包含12到15个商品对象的数组。\x0a\x20\x20\x20\x20-\x20**status\x20(订单状态)**:\x20只能从\x20\x22已签收\x22,\x20\x22待发货\x22,\x20\x22运输中\x22,\x20\x22待评价\x22\x20中选择。\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0xd90b87[_0x2839aa(0xcb3)][_0x2839aa(0xbe5)]+'\x0a-\x20**你的长期记忆**:\x0a'+_0xf487a5+'\x0a'+_0x27c788+'\x0a'+_0x2a4d12+_0x2839aa(0x12f5)+_0x2315e4+'”的对话摘要**:\x0a'+_0x4e5323+_0x2839aa(0x727);try{const _0x386920=[{'role':_0x2839aa(0xa4d),'content':_0x2839aa(0x176)}];let _0x28daa3=_0x2b285b['includes'](_0x2839aa(0x742)),_0x344450=_0x250668(_0x10992b,_0x5283d7,_0x3681a7,_0x386920);const _0x227f65=_0x28daa3?await fetch(_0x344450[_0x2839aa(0xe52)],_0x344450['data']):await fetch(_0x2b285b+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x2839aa(0x7fe),'Authorization':_0x2839aa(0x236)+_0x5283d7},'body':JSON[_0x2839aa(0xe3f)]({'model':_0x10992b,'messages':[{'role':_0x2839aa(0x905),'content':_0x3681a7},..._0x386920],'temperature':_0x3e7a1b[_0x2839aa(0x11b4)][_0x2839aa(0xa55)]||0.9})});if(!_0x227f65['ok'])throw new Error('API\x20错误:\x20'+_0x227f65[_0x2839aa(0x132c)]);const _0x321bbb=await _0x227f65[_0x2839aa(0x6f8)](),_0x9c0ff=getGeminiResponseText(_0x321bbb),_0x35c5e4=_0x9c0ff['match'](/({[\s\S]*})/);if(!_0x35c5e4)throw new Error(_0x2839aa(0x11d4));const _0x5371b2=JSON[_0x2839aa(0x1214)](_0x35c5e4[0x0]);!_0x5371b2[_0x2839aa(0x6d5)]&&(_0x5371b2[_0x2839aa(0x6d5)]=[]),_0xd90b87['simulatedTaobaoHistory']=_0x5371b2,await _0x4e1bbf[_0x2839aa(0x999)][_0x2839aa(0x4fa)](_0xd90b87),await _0x59a86c();}catch(_0x181a55){console[_0x2839aa(0xc60)]('生成模拟淘宝记录失败:',_0x181a55),await _0x28974b(_0x2839aa(0x129b),'无法生成购物记录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x181a55['message']);}}function _0xe6af39(){const _0x237f4f=_0x5a7792;_0x6a35ba(),_0xdfc697(_0x237f4f(0x5ff));}function _0x6a35ba(){const _0x2a0009=_0x5a7792,_0x46aa9c=document[_0x2a0009(0x64f)](_0x2a0009(0x219));_0x46aa9c['innerHTML']='';const _0x4a5cef=_0x3e7a1b[_0x2a0009(0x999)][_0x10ae3d],_0x3a0047=_0x4a5cef[_0x2a0009(0x1ec)]||{},_0x31433d=_0x3a0047[_0x2a0009(0x6d5)]||[],_0x1f45af=_0x3a0047[_0x2a0009(0x7eb)]||0x0,_0xf07286=document[_0x2a0009(0x124e)](_0x2a0009(0x479));_0xf07286['style'][_0x2a0009(0x42f)]=_0x2a0009(0x8c4),_0xf07286[_0x2a0009(0xc58)]=_0x2a0009(0x103c)+_0x1f45af['toFixed'](0x2)+_0x2a0009(0x1017),_0x46aa9c[_0x2a0009(0x99e)](_0xf07286);const _0x536f3d=document['createElement']('h3');_0x536f3d['textContent']=_0x2a0009(0x1158),_0x536f3d['style'][_0x2a0009(0x42f)]=_0x2a0009(0xd3f),_0x46aa9c['appendChild'](_0x536f3d);if(_0x31433d['length']===0x0){_0x46aa9c[_0x2a0009(0xc58)]+=_0x2a0009(0x5f3);return;}_0x31433d[_0x2a0009(0x103)](_0x50ab81=>{const _0x4c97f1=_0x2a0009,_0x5d6665=document[_0x4c97f1(0x124e)](_0x4c97f1(0x479));_0x5d6665['style'][_0x4c97f1(0x42f)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20justify-content:\x20space-between;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20center;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x2015px\x200;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-bottom:\x201px\x20solid\x20#f0f0f0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x5d6665[_0x4c97f1(0xc58)]=_0x4c97f1(0x5e1)+_0x50ab81[_0x4c97f1(0x3a0)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p\x20style=\x22font-size:\x2012px;\x20color:\x20#8a8a8a;\x20margin:\x200;\x22>'+_0x50ab81[_0x4c97f1(0x69e)]+_0x4c97f1(0x11a9)+(_0x50ab81['price']||0x0)['toFixed'](0x2)+_0x4c97f1(0x9df),_0x46aa9c[_0x4c97f1(0x99e)](_0x5d6665);});}async function _0x55ca61(){const _0xac1378=_0x5a7792;if(!_0x10ae3d)return;const _0xf8f437=_0x3e7a1b['chats'][_0x10ae3d];if(!_0xf8f437)return;await _0x28974b(_0xac1378(0x2f7),_0xac1378(0x5ad)+_0xf8f437[_0xac1378(0x6fc)]+_0xac1378(0x564));const {proxyUrl:_0x294d56,apiKey:_0x79d83c,model:_0x52744c}=_0x3e7a1b[_0xac1378(0xec0)];if(!_0x294d56||!_0x79d83c||!_0x52744c){alert(_0xac1378(0x1ce));return;}const _0x312407=_0x3e7a1b[_0xac1378(0x3c2)]['nickname']===_0xac1378(0x1028)||!_0x3e7a1b[_0xac1378(0x3c2)]['nickname']?'用户':_0x3e7a1b['qzoneSettings'][_0xac1378(0x78c)],_0x1604c2=_0xf8f437[_0xac1378(0x518)]&&_0xf8f437[_0xac1378(0x518)][_0xac1378(0x40f)]>0x0?_0xf8f437[_0xac1378(0x518)][_0xac1378(0xb96)](_0x4db663=>_0xac1378(0x56b)+_0x4942eb(_0x4db663['timestamp'])+')\x20'+_0x4db663[_0xac1378(0x3ba)])[_0xac1378(0xd22)]('\x0a'):'无',_0x4a4410=_0xf8f437['settings'][_0xac1378(0xd50)]||0xa,_0x4e5e58=_0xf8f437['history'][_0xac1378(0xdf5)](-_0x4a4410)[_0xac1378(0xb96)](_0x59e28a=>(_0x59e28a['role']==='user'?_0x312407:_0xf8f437['name'])+':\x20'+String(_0x59e28a[_0xac1378(0x3ba)])[_0xac1378(0x126f)](0x0,0x1e)+'...')[_0xac1378(0xd22)]('\x0a'),_0x1ac3a1=(_0xf8f437[_0xac1378(0xcb3)][_0xac1378(0xde4)]||[])[_0xac1378(0xb96)](_0x57d9cc=>_0x3e7a1b[_0xac1378(0x144)][_0xac1378(0x137)](_0x16a485=>_0x16a485['id']===_0x57d9cc))[_0xac1378(0x156)](Boolean)[_0xac1378(0xb96)](_0xf11734=>'\x0a##\x20世界书《'+_0xf11734[_0xac1378(0x6fc)]+_0xac1378(0xc4d)+_0xf11734[_0xac1378(0x3ba)][_0xac1378(0x156)](_0x4e5299=>_0x4e5299[_0xac1378(0x9b)])['map'](_0x589478=>'-\x20'+_0x589478['content'])['join']('\x0a'))[_0xac1378(0xd22)](''),_0x5a200e=_0x5871dc(_0xf8f437,0x3,_0xac1378(0x4b6)),_0x5baa31=_0x5871dc(_0xf8f437,0x6,_0xac1378(0x4b6)),_0x292955=_0x5871dc(_0xf8f437,0x9,'hours'),_0x4cbbf3=_0x5871dc(_0xf8f437,0x1,_0xac1378(0x82a)),_0x77d52c=_0x5871dc(_0xf8f437,0x3,_0xac1378(0x82a)),_0x58c0f3=_0x5871dc(_0xf8f437,0x7,'days');let _0x412be7='';if(_0x5a200e||_0x5baa31||_0x292955||_0x4cbbf3||_0x77d52c||_0x58c0f3){_0x412be7+='\x0a#\x20智能总结\x20(基于不同时间维度的对话回顾)\x0a';if(_0x5a200e)_0x412be7+=_0x5a200e;if(_0x5baa31)_0x412be7+=_0x5baa31;if(_0x292955)_0x412be7+=_0x292955;if(_0x5a200e||_0x5baa31||_0x292955)_0x412be7+='\x0a';if(_0x4cbbf3)_0x412be7+=_0x4cbbf3;if(_0x77d52c)_0x412be7+=_0x77d52c;if(_0x58c0f3)_0x412be7+=_0x58c0f3;}const _0x48e4a0=_0xf8f437['settings']['myPersona']||'(未设置)',_0x1b0c62=_0xac1378(0x9d2)+_0xf8f437[_0xac1378(0x6fc)]+'”，并根据其人设、记忆和最近的互动，虚构出【12到20条】TA最近可能会写在手机备忘录里的内容。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**创造性与合理性**:\x20备忘录内容必须完全符合角色的性格、爱好、职业和生活环境。可以是购物清单、待办事项、灵感片段、一些随笔和感悟、草稿等。\x0a2.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个JSON数组格式的字符串。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`[`\x20开始，并以\x20`]`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON数组前后添加任何多余的文字、解释、或\x20markdown\x20标记\x20(如\x20```json)。\x0a\x20\x20\x20\x20-\x20数组中的每个元素都是一个对象，代表一条备忘录，格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22备忘录的标题，例如：购物清单\x20或\x20周末计划\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22备忘录的详细内容，必须支持换行符\x5cn。\x22\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20\x20\x20```\x0a\x0a#\x20供你参考的上下文\x0a-\x20**你的角色设定**:\x20'+_0xf8f437[_0xac1378(0xcb3)]['aiPersona']+_0xac1378(0x86a)+_0x48e4a0+_0xac1378(0x7e5)+_0x1604c2+'\x0a'+_0x1ac3a1+'\x0a'+_0x412be7+_0xac1378(0x448)+_0x312407+'”的对话摘要**:\x0a'+_0x4e5e58+_0xac1378(0x450);try{const _0x3f5ee2=[{'role':_0xac1378(0xa4d),'content':_0xac1378(0x52c)}];let _0xd644c1=_0x294d56[_0xac1378(0xe53)](_0xac1378(0x742)),_0xe99295=_0x250668(_0x52744c,_0x79d83c,_0x1b0c62,_0x3f5ee2);const _0x1e1db5=_0xd644c1?await fetch(_0xe99295[_0xac1378(0xe52)],_0xe99295[_0xac1378(0x88a)]):await fetch(_0x294d56+_0xac1378(0x58b),{'method':_0xac1378(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0xac1378(0x236)+_0x79d83c},'body':JSON[_0xac1378(0xe3f)]({'model':_0x52744c,'messages':[{'role':_0xac1378(0x905),'content':_0x1b0c62},..._0x3f5ee2],'temperature':_0x3e7a1b[_0xac1378(0x11b4)][_0xac1378(0xa55)]||0.9})});if(!_0x1e1db5['ok']){const _0x2c0215=await _0x1e1db5[_0xac1378(0x6f8)]()[_0xac1378(0x1201)](()=>null),_0x4785c0=_0x2c0215?.[_0xac1378(0xc60)]?.[_0xac1378(0x854)]||_0x1e1db5[_0xac1378(0x132c)];throw new Error('API\x20错误:\x20'+_0x1e1db5[_0xac1378(0x69e)]+_0xac1378(0xc78)+_0x4785c0);}const _0x530dd3=await _0x1e1db5['json'](),_0xe59e28=getGeminiResponseText(_0x530dd3),_0x1ef3c5=_0xe59e28[_0xac1378(0x132a)](/(\[[\s\S]*\])/);if(!_0x1ef3c5||!_0x1ef3c5[0x0])throw new Error(_0xac1378(0x909)+_0xe59e28);const _0x518eed=_0x1ef3c5[0x0];let _0x41d38e;try{_0x41d38e=JSON[_0xac1378(0x1214)](_0x518eed);}catch(_0x4c9e5c){throw new Error(_0xac1378(0xc8c)+_0x4c9e5c[_0xac1378(0x854)]+_0xac1378(0xa91)+_0xe59e28);}if(!Array['isArray'](_0x41d38e))throw new Error(_0xac1378(0x11d6)+JSON[_0xac1378(0xe3f)](_0x41d38e));_0xf8f437[_0xac1378(0x5b6)]=_0x41d38e[_0xac1378(0xb96)](_0x32ffcf=>({'id':Date[_0xac1378(0x2b5)]()+Math[_0xac1378(0x95f)](),'title':_0x32ffcf[_0xac1378(0x1250)],'content':_0x32ffcf[_0xac1378(0x3ba)]})),await _0x4e1bbf[_0xac1378(0x999)][_0xac1378(0x4fa)](_0xf8f437),await _0x2c8f58();}catch(_0x106cb5){console[_0xac1378(0xc60)](_0xac1378(0xd2a),_0x106cb5),await _0x28974b(_0xac1378(0x129b),'无法生成备忘录，请检查API配置或稍后再试。\x0a错误:\x20'+_0x106cb5[_0xac1378(0x854)]);}}async function _0x4f52c4(){const _0x445cfc=_0x5a7792;if(!_0x10ae3d)return;const _0xb34da8=_0x3e7a1b[_0x445cfc(0x999)][_0x10ae3d];if(!_0xb34da8)return;await _0x28974b(_0x445cfc(0x2f7),_0x445cfc(0xa2)+_0xb34da8[_0x445cfc(0x6fc)]+_0x445cfc(0x4ab));const {proxyUrl:_0x2d9535,apiKey:_0x24c812,model:_0x184c53}=_0x3e7a1b[_0x445cfc(0xec0)];if(!_0x2d9535||!_0x24c812||!_0x184c53){alert('API未配置，无法生成内容。');return;}const _0x563272=_0x3e7a1b[_0x445cfc(0x3c2)][_0x445cfc(0x78c)]==='{{user}}'||!_0x3e7a1b[_0x445cfc(0x3c2)][_0x445cfc(0x78c)]?'用户':_0x3e7a1b[_0x445cfc(0x3c2)]['nickname'],_0x3bdcca=_0xb34da8[_0x445cfc(0x518)]&&_0xb34da8[_0x445cfc(0x518)][_0x445cfc(0x40f)]>0x0?_0xb34da8[_0x445cfc(0x518)]['map'](_0x2784ee=>_0x445cfc(0x56b)+_0x4942eb(_0x2784ee[_0x445cfc(0x8af)])+')\x20'+_0x2784ee[_0x445cfc(0x3ba)])[_0x445cfc(0xd22)]('\x0a'):'无',_0x1c8a10=_0xb34da8[_0x445cfc(0xcb3)][_0x445cfc(0xd50)]||0xa,_0x22226d=_0xb34da8[_0x445cfc(0x830)][_0x445cfc(0xdf5)](-_0x1c8a10)[_0x445cfc(0xb96)](_0x406aed=>(_0x406aed['role']===_0x445cfc(0xa4d)?_0x563272:_0xb34da8[_0x445cfc(0x6fc)])+':\x20'+String(_0x406aed[_0x445cfc(0x3ba)])[_0x445cfc(0x126f)](0x0,0x1e)+_0x445cfc(0x3cd))[_0x445cfc(0xd22)]('\x0a'),_0x4bde28=(_0xb34da8[_0x445cfc(0xcb3)][_0x445cfc(0xde4)]||[])[_0x445cfc(0xb96)](_0x31356a=>_0x3e7a1b[_0x445cfc(0x144)][_0x445cfc(0x137)](_0x188679=>_0x188679['id']===_0x31356a))[_0x445cfc(0x156)](Boolean)[_0x445cfc(0xb96)](_0x2c8959=>_0x445cfc(0x1272)+_0x2c8959[_0x445cfc(0x6fc)]+'》设定:\x0a'+_0x2c8959['content'][_0x445cfc(0x156)](_0x2a4995=>_0x2a4995[_0x445cfc(0x9b)])['map'](_0x29b4a7=>'-\x20'+_0x29b4a7[_0x445cfc(0x3ba)])[_0x445cfc(0xd22)]('\x0a'))[_0x445cfc(0xd22)](''),_0x1ee9c3=_0x5871dc(_0xb34da8,0x3,_0x445cfc(0x4b6)),_0x4dcb81=_0x5871dc(_0xb34da8,0x6,'hours'),_0x1ed661=_0x5871dc(_0xb34da8,0x9,_0x445cfc(0x4b6)),_0x6c73a3=_0x5871dc(_0xb34da8,0x1,'days'),_0x3bf397=_0x5871dc(_0xb34da8,0x3,_0x445cfc(0x82a)),_0x203aa9=_0x5871dc(_0xb34da8,0x7,_0x445cfc(0x82a));let _0x2ca0b2='';if(_0x1ee9c3||_0x4dcb81||_0x1ed661||_0x6c73a3||_0x3bf397||_0x203aa9){_0x2ca0b2+=_0x445cfc(0xd98);if(_0x1ee9c3)_0x2ca0b2+=_0x1ee9c3;if(_0x4dcb81)_0x2ca0b2+=_0x4dcb81;if(_0x1ed661)_0x2ca0b2+=_0x1ed661;if(_0x1ee9c3||_0x4dcb81||_0x1ed661)_0x2ca0b2+='\x0a';if(_0x6c73a3)_0x2ca0b2+=_0x6c73a3;if(_0x3bf397)_0x2ca0b2+=_0x3bf397;if(_0x203aa9)_0x2ca0b2+=_0x203aa9;}const _0x46612f=_0x445cfc(0x9d2)+_0xb34da8[_0x445cfc(0x6fc)]+_0x445cfc(0x11f6)+new Date()[_0x445cfc(0x5f8)]()+_0x445cfc(0xf07)+_0xb34da8['settings']['aiPersona']+_0x445cfc(0x7e5)+_0x3bdcca+'\x0a'+_0x4bde28+'\x0a'+_0x2ca0b2+_0x445cfc(0x448)+_0x563272+_0x445cfc(0x10be)+_0x22226d+_0x445cfc(0x268);try{const _0x24f67e=[{'role':_0x445cfc(0xa4d),'content':'请根据你的设定，生成你的高德地图足迹。'}];let _0x256cf8=_0x2d9535['includes'](_0x445cfc(0x742)),_0x367bf0=_0x250668(_0x184c53,_0x24c812,_0x46612f,_0x24f67e);const _0x4175d0=_0x256cf8?await fetch(_0x367bf0[_0x445cfc(0xe52)],_0x367bf0[_0x445cfc(0x88a)]):await fetch(_0x2d9535+_0x445cfc(0x58b),{'method':'POST','headers':{'Content-Type':_0x445cfc(0x7fe),'Authorization':'Bearer\x20'+_0x24c812},'body':JSON[_0x445cfc(0xe3f)]({'model':_0x184c53,'messages':[{'role':_0x445cfc(0x905),'content':_0x46612f},..._0x24f67e],'temperature':_0x3e7a1b[_0x445cfc(0x11b4)]['apiTemperature']||0.9})});if(!_0x4175d0['ok'])throw new Error(_0x445cfc(0x1fa)+_0x4175d0[_0x445cfc(0x132c)]);const _0x2646fb=await _0x4175d0[_0x445cfc(0x6f8)](),_0x4444dd=getGeminiResponseText(_0x2646fb),_0xd944d9=_0x4444dd['match'](/(\[[\s\S]*\])/);if(!_0xd944d9||!_0xd944d9[0x0])throw new Error(_0x445cfc(0x909)+_0x4444dd);const _0x20c500=_0xd944d9[0x0];let _0x2a8d83;try{_0x2a8d83=JSON[_0x445cfc(0x1214)](_0x20c500);}catch(_0x2f95d8){throw new Error(_0x445cfc(0xc8c)+_0x2f95d8[_0x445cfc(0x854)]+_0x445cfc(0xa91)+_0x4444dd);}_0xb34da8['simulatedAmapHistory']=_0x2a8d83,await _0x4e1bbf[_0x445cfc(0x999)][_0x445cfc(0x4fa)](_0xb34da8),await _0x44217f();}catch(_0x3319dd){console[_0x445cfc(0xc60)](_0x445cfc(0x1296),_0x3319dd),await _0x28974b(_0x445cfc(0x129b),_0x445cfc(0x750)+_0x3319dd[_0x445cfc(0x854)]);}}function _0x44217f(){const _0x4acdb8=_0x5a7792,_0x2e2aae=document['getElementById']('char-amap-list');_0x2e2aae[_0x4acdb8(0xc58)]='';if(!_0x10ae3d)return;const _0x467aa7=_0x3e7a1b[_0x4acdb8(0x999)][_0x10ae3d],_0x5db84b=_0x467aa7[_0x4acdb8(0x10dc)]||[];if(_0x5db84b[_0x4acdb8(0x40f)]===0x0){_0x2e2aae[_0x4acdb8(0xc58)]=_0x4acdb8(0x1113);return;}_0x5db84b[_0x4acdb8(0x103)](_0x497c0c=>{const _0x30c0b4=_0x4acdb8,_0x5d6dd7=document[_0x30c0b4(0x124e)](_0x30c0b4(0x479));_0x5d6dd7[_0x30c0b4(0x87d)]=_0x30c0b4(0x123b);let _0x11817d='';if(_0x497c0c[_0x30c0b4(0x242)]){const _0x2b4244='https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x497c0c[_0x30c0b4(0x242)]);_0x11817d='<div\x20class=\x22amap-item-photo\x22\x20style=\x22background-image:\x20url(\x27'+_0x2b4244+_0x30c0b4(0xed8)+_0x497c0c[_0x30c0b4(0x652)]+_0x30c0b4(0x99d);}const _0x55a59a=_0x497c0c['timestamp']?_0x4942eb(new Date(_0x497c0c['timestamp'])[_0x30c0b4(0x767)]()):'某个时间';_0x5d6dd7[_0x30c0b4(0xc58)]=_0x30c0b4(0x83f)+_0x497c0c[_0x30c0b4(0x1194)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-address\x22>'+_0x497c0c[_0x30c0b4(0x11da)]+_0x30c0b4(0x79d)+_0x497c0c['comment']['replace'](/\n/g,_0x30c0b4(0x917))+_0x30c0b4(0x137e)+_0x11817d+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amap-item-footer\x22>'+_0x55a59a+_0x30c0b4(0x7e4),_0x2e2aae[_0x30c0b4(0x99e)](_0x5d6dd7);});}async function _0x1fd3d2(){const _0x3f5ca9=_0x5a7792;if(!_0x10ae3d)return;const _0x5ea059=_0x3e7a1b[_0x3f5ca9(0x999)][_0x10ae3d];if(!_0x5ea059)return;await _0x28974b(_0x3f5ca9(0x2f7),'正在分析“'+_0x5ea059[_0x3f5ca9(0x6fc)]+'”的手机使用习惯...');const {proxyUrl:_0x45f663,apiKey:_0x284b20,model:_0x40bc7d}=_0x3e7a1b[_0x3f5ca9(0xec0)];if(!_0x45f663||!_0x284b20||!_0x40bc7d){alert(_0x3f5ca9(0xb6a));return;}const _0x47c06d=_0x3e7a1b[_0x3f5ca9(0x3c2)][_0x3f5ca9(0x78c)]===_0x3f5ca9(0x1028)||!_0x3e7a1b[_0x3f5ca9(0x3c2)]['nickname']?'用户':_0x3e7a1b[_0x3f5ca9(0x3c2)][_0x3f5ca9(0x78c)],_0x1bb8d6=_0x5ea059['longTermMemory']&&_0x5ea059[_0x3f5ca9(0x518)]['length']>0x0?_0x5ea059['longTermMemory'][_0x3f5ca9(0xb96)](_0x16b218=>'-\x20(记录于\x20'+_0x4942eb(_0x16b218[_0x3f5ca9(0x8af)])+')\x20'+_0x16b218['content'])[_0x3f5ca9(0xd22)]('\x0a'):'无',_0x120281=_0x5ea059['settings']['maxMemory']||0xa,_0x4d928a=_0x5ea059[_0x3f5ca9(0x830)]['slice'](-_0x120281)[_0x3f5ca9(0xb96)](_0x3b865a=>(_0x3b865a[_0x3f5ca9(0x931)]==='user'?_0x47c06d:_0x5ea059['name'])+':\x20'+String(_0x3b865a['content'])[_0x3f5ca9(0x126f)](0x0,0x1e)+_0x3f5ca9(0x3cd))[_0x3f5ca9(0xd22)]('\x0a'),_0x41e268=(_0x5ea059[_0x3f5ca9(0xcb3)]['linkedWorldBookIds']||[])[_0x3f5ca9(0xb96)](_0x470bde=>_0x3e7a1b[_0x3f5ca9(0x144)][_0x3f5ca9(0x137)](_0x389778=>_0x389778['id']===_0x470bde))[_0x3f5ca9(0x156)](Boolean)[_0x3f5ca9(0xb96)](_0x579613=>_0x3f5ca9(0x1272)+_0x579613[_0x3f5ca9(0x6fc)]+_0x3f5ca9(0xc4d)+_0x579613[_0x3f5ca9(0x3ba)]['filter'](_0x1cf5cb=>_0x1cf5cb['enabled'])[_0x3f5ca9(0xb96)](_0x5e069b=>'-\x20'+_0x5e069b[_0x3f5ca9(0x3ba)])[_0x3f5ca9(0xd22)]('\x0a'))['join'](''),_0x4c61b0=_0x5871dc(_0x5ea059,0x3,_0x3f5ca9(0x4b6)),_0x5133d5=_0x5871dc(_0x5ea059,0x6,_0x3f5ca9(0x4b6)),_0xc9d3f4=_0x5871dc(_0x5ea059,0x9,_0x3f5ca9(0x4b6)),_0x5ac1ce=_0x5871dc(_0x5ea059,0x1,_0x3f5ca9(0x82a)),_0xa6aea5=_0x5871dc(_0x5ea059,0x3,'days'),_0x120282=_0x5871dc(_0x5ea059,0x7,_0x3f5ca9(0x82a));let _0x1c6ee6='';if(_0x4c61b0||_0x5133d5||_0xc9d3f4||_0x5ac1ce||_0xa6aea5||_0x120282){_0x1c6ee6+=_0x3f5ca9(0xd98);if(_0x4c61b0)_0x1c6ee6+=_0x4c61b0;if(_0x5133d5)_0x1c6ee6+=_0x5133d5;if(_0xc9d3f4)_0x1c6ee6+=_0xc9d3f4;if(_0x4c61b0||_0x5133d5||_0xc9d3f4)_0x1c6ee6+='\x0a';if(_0x5ac1ce)_0x1c6ee6+=_0x5ac1ce;if(_0xa6aea5)_0x1c6ee6+=_0xa6aea5;if(_0x120282)_0x1c6ee6+=_0x120282;}const _0x54680b='\x0a#\x20你的任务\x0a你是一个虚拟生活模拟器。你的任务是扮演角色“'+_0x5ea059[_0x3f5ca9(0x6fc)]+_0x3f5ca9(0xd7e)+_0x5ea059[_0x3f5ca9(0xcb3)][_0x3f5ca9(0xbe5)]+_0x3f5ca9(0x7e5)+_0x1bb8d6+'\x0a'+_0x41e268+'\x0a'+_0x1c6ee6+_0x3f5ca9(0x448)+_0x47c06d+_0x3f5ca9(0x10be)+_0x4d928a+_0x3f5ca9(0xf78);try{const _0x1ad7d0=[{'role':_0x3f5ca9(0xa4d),'content':_0x3f5ca9(0xd6a)}];let _0x136df7=_0x45f663[_0x3f5ca9(0xe53)](_0x3f5ca9(0x742)),_0x5fa273=_0x250668(_0x40bc7d,_0x284b20,_0x54680b,_0x1ad7d0);const _0x258646=_0x136df7?await fetch(_0x5fa273['url'],_0x5fa273[_0x3f5ca9(0x88a)]):await fetch(_0x45f663+_0x3f5ca9(0x58b),{'method':_0x3f5ca9(0x2d1),'headers':{'Content-Type':_0x3f5ca9(0x7fe),'Authorization':_0x3f5ca9(0x236)+_0x284b20},'body':JSON[_0x3f5ca9(0xe3f)]({'model':_0x40bc7d,'messages':[{'role':'system','content':_0x54680b},..._0x1ad7d0],'temperature':_0x3e7a1b['globalSettings'][_0x3f5ca9(0xa55)]||0.9})});if(!_0x258646['ok'])throw new Error(_0x3f5ca9(0x1fa)+_0x258646['statusText']);const _0x362594=await _0x258646[_0x3f5ca9(0x6f8)](),_0xb469ed=getGeminiResponseText(_0x362594),_0x1d0a50=_0xb469ed['replace'](/^```json\s*/,'')[_0x3f5ca9(0x137f)](/```$/,''),_0xa5df9a=JSON[_0x3f5ca9(0x1214)](_0x1d0a50);_0x5ea059[_0x3f5ca9(0x699)]=_0xa5df9a,await _0x4e1bbf[_0x3f5ca9(0x999)][_0x3f5ca9(0x4fa)](_0x5ea059),await _0x1fab74();}catch(_0x235ea3){console['error'](_0x3f5ca9(0xd0a),_0x235ea3),await _0x28974b(_0x3f5ca9(0x129b),_0x3f5ca9(0xffb)+_0x235ea3['message']);}}function _0x1fab74(){const _0x1921c3=_0x5a7792,_0x3ae1e3=document[_0x1921c3(0x64f)](_0x1921c3(0xb0d));_0x3ae1e3[_0x1921c3(0xc58)]='';if(!_0x10ae3d)return;const _0x5abf6a=_0x3e7a1b[_0x1921c3(0x999)][_0x10ae3d],_0x4f3cd8=(_0x5abf6a[_0x1921c3(0x699)]||[])[_0x1921c3(0x102f)]((_0x1bd3b0,_0x1b2537)=>_0x1b2537[_0x1921c3(0x3d7)]-_0x1bd3b0['usageTimeMinutes']);if(_0x4f3cd8[_0x1921c3(0x40f)]===0x0){_0x3ae1e3['innerHTML']=_0x1921c3(0x1316);return;}_0x4f3cd8[_0x1921c3(0x103)](_0x1044d8=>{const _0xb2b7cf=_0x1921c3,_0x3f3e40=document[_0xb2b7cf(0x124e)](_0xb2b7cf(0x479));_0x3f3e40['className']='char-usage-item';const _0x5cd4ce=Math[_0xb2b7cf(0x1245)](_0x1044d8[_0xb2b7cf(0x3d7)]/0x3c),_0x36cf8a=_0x1044d8[_0xb2b7cf(0x3d7)]%0x3c;let _0x3a2521='';if(_0x5cd4ce>0x0)_0x3a2521+=_0x5cd4ce+'小时';if(_0x36cf8a>0x0)_0x3a2521+=_0x36cf8a+'分钟';if(!_0x3a2521)_0x3a2521=_0xb2b7cf(0x91a);const _0xd485a4=_0x1044d8[_0xb2b7cf(0x242)]||_0xb2b7cf(0x13e0)+_0x1044d8[_0xb2b7cf(0xdc6)]+_0xb2b7cf(0xa9f),_0x28abcc=_0xb2b7cf(0xb1f)+encodeURIComponent(_0xd485a4);_0x3f3e40[_0xb2b7cf(0xc58)]=_0xb2b7cf(0x531)+_0x28abcc+'\x22\x20class=\x22usage-item-icon\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22usage-item-name\x22>'+_0x1044d8[_0xb2b7cf(0xdc6)]+_0xb2b7cf(0xed9)+_0x1044d8[_0xb2b7cf(0x6b3)]+_0xb2b7cf(0x1384)+_0x3a2521+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x3ae1e3[_0xb2b7cf(0x99e)](_0x3f3e40);});}async function _0x50a62c(){const _0x31089e=_0x5a7792;if(!_0x10ae3d)return;const _0x466493=_0x3e7a1b[_0x31089e(0x999)][_0x10ae3d];if(!_0x466493)return;await _0x28974b(_0x31089e(0x2f7),_0x31089e(0x5ad)+_0x466493[_0x31089e(0x6fc)]+'”分享TA的私人歌单...');const {proxyUrl:_0x3aa645,apiKey:_0x5140a8,model:_0x933143}=_0x3e7a1b['apiConfig'];if(!_0x3aa645||!_0x5140a8||!_0x933143){alert('请先在API设置中配置好API信息。');return;}const _0x4386ad=_0x3e7a1b[_0x31089e(0x3c2)][_0x31089e(0x78c)]===_0x31089e(0x1028)||!_0x3e7a1b[_0x31089e(0x3c2)]['nickname']?'用户':_0x3e7a1b['qzoneSettings']['nickname'],_0xdcb0c5=_0x466493[_0x31089e(0x518)]&&_0x466493['longTermMemory']['length']>0x0?_0x466493[_0x31089e(0x518)][_0x31089e(0xb96)](_0x49e5c6=>_0x31089e(0x56b)+_0x4942eb(_0x49e5c6['timestamp'])+')\x20'+_0x49e5c6['content'])[_0x31089e(0xd22)]('\x0a'):'无',_0xbe4f8=_0x466493['settings']['maxMemory']||0xa,_0x17e91e=_0x466493['history'][_0x31089e(0xdf5)](-_0xbe4f8)[_0x31089e(0xb96)](_0x487821=>(_0x487821[_0x31089e(0x931)]===_0x31089e(0xa4d)?_0x4386ad:_0x466493[_0x31089e(0x6fc)])+':\x20'+String(_0x487821['content'])[_0x31089e(0x126f)](0x0,0x1e)+_0x31089e(0x3cd))[_0x31089e(0xd22)]('\x0a'),_0x1ed319=(_0x466493[_0x31089e(0xcb3)][_0x31089e(0xde4)]||[])[_0x31089e(0xb96)](_0x53861f=>_0x3e7a1b[_0x31089e(0x144)][_0x31089e(0x137)](_0x2f701e=>_0x2f701e['id']===_0x53861f))[_0x31089e(0x156)](Boolean)['map'](_0xb900f9=>'\x0a##\x20世界书《'+_0xb900f9[_0x31089e(0x6fc)]+_0x31089e(0xc4d)+_0xb900f9[_0x31089e(0x3ba)][_0x31089e(0x156)](_0xc47564=>_0xc47564[_0x31089e(0x9b)])[_0x31089e(0xb96)](_0x588a62=>'-\x20'+_0x588a62[_0x31089e(0x3ba)])[_0x31089e(0xd22)]('\x0a'))[_0x31089e(0xd22)](''),_0x560fc5=_0x31089e(0x2e5)+_0x466493[_0x31089e(0x6fc)]+_0x31089e(0xeb0)+_0x466493[_0x31089e(0xcb3)][_0x31089e(0xbe5)]+_0x31089e(0x7e5)+_0xdcb0c5+'\x0a'+_0x1ed319+_0x31089e(0x448)+_0x4386ad+_0x31089e(0x10be)+_0x17e91e+_0x31089e(0xcf2);try{const _0x18ed5a=[{'role':_0x31089e(0xa4d),'content':'请根据你的设定，生成你的歌单。'}];let _0x5a4dab=_0x3aa645[_0x31089e(0xe53)](_0x31089e(0x742)),_0xc195d9=_0x250668(_0x933143,_0x5140a8,_0x560fc5,_0x18ed5a);const _0x264d3b=_0x5a4dab?await fetch(_0xc195d9[_0x31089e(0xe52)],_0xc195d9[_0x31089e(0x88a)]):await fetch(_0x3aa645+'/v1/chat/completions',{'method':_0x31089e(0x2d1),'headers':{'Content-Type':_0x31089e(0x7fe),'Authorization':_0x31089e(0x236)+_0x5140a8},'body':JSON[_0x31089e(0xe3f)]({'model':_0x933143,'messages':[{'role':_0x31089e(0x905),'content':_0x560fc5},..._0x18ed5a],'temperature':_0x3e7a1b[_0x31089e(0x11b4)][_0x31089e(0xa55)]||0x1})});if(!_0x264d3b['ok'])throw new Error(_0x31089e(0x1fa)+_0x264d3b['statusText']);const _0x4bd0ab=await _0x264d3b[_0x31089e(0x6f8)](),_0x33f096=getGeminiResponseText(_0x4bd0ab),_0x20a1fd=_0x33f096['replace'](/^```json\s*/,'')[_0x31089e(0x137f)](/```$/,''),_0x519080=JSON[_0x31089e(0x1214)](_0x20a1fd);await _0x28974b('请稍候...','歌单已生成，正在从网络获取\x20'+_0x519080[_0x31089e(0x40f)]+_0x31089e(0xccb));const _0x4e9947=_0x519080['map'](async _0x306915=>{const _0x4ef2e3=_0x31089e;let _0x324afc=await _0x46d5f2(_0x306915[_0x4ef2e3(0x661)],_0x306915['artistName']);(!_0x324afc||_0x324afc[_0x4ef2e3(0x40f)]===0x0)&&(_0x324afc=await _0x46268f(_0x306915['songName']));if(_0x324afc[_0x4ef2e3(0x40f)]>0x0)return _0x24fad6(_0x324afc[0x0]);return console[_0x4ef2e3(0x1155)](_0x4ef2e3(0x1d4)+_0x306915[_0x4ef2e3(0x661)]+'\x20-\x20'+_0x306915[_0x4ef2e3(0xe4d)]+'”'),null;}),_0x3e5ba6=(await Promise[_0x31089e(0xfd7)](_0x4e9947))[_0x31089e(0x156)](Boolean);_0x466493[_0x31089e(0x1273)]=_0x3e5ba6,await _0x4e1bbf['chats'][_0x31089e(0x4fa)](_0x466493),await _0x472563();}catch(_0x389de5){console['error'](_0x31089e(0x269),_0x389de5),await _0x28974b(_0x31089e(0x129b),'无法生成歌单，请检查API配置或稍后再试。\x0a错误:\x20'+_0x389de5[_0x31089e(0x854)]);}}function _0x472563(){const _0x189b2d=_0x5a7792,_0xa155cd=document[_0x189b2d(0x64f)](_0x189b2d(0x85c));_0xa155cd[_0x189b2d(0xc58)]='';if(!_0x10ae3d)return;const _0x468352=_0x3e7a1b[_0x189b2d(0x999)][_0x10ae3d],_0x128c37=_0x468352['simulatedMusicPlaylist']||[];if(_0x128c37['length']===0x0){_0xa155cd[_0x189b2d(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>TA的歌单还是空的，<br>点击右上角刷新按钮生成一些歌曲吧！</p>';return;}_0x128c37['forEach']((_0x32691a,_0x3fcc57)=>{const _0x2edaf9=_0x189b2d,_0x21bfbb=document[_0x2edaf9(0x124e)](_0x2edaf9(0x479));_0x21bfbb['className']='char-music-item',_0x21bfbb['innerHTML']=_0x2edaf9(0xa8d)+_0x32691a[_0x2edaf9(0x844)]+_0x2edaf9(0x10bc)+_0x32691a[_0x2edaf9(0x6fc)]+_0x2edaf9(0x965)+_0x32691a[_0x2edaf9(0xb17)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x21bfbb[_0x2edaf9(0xf72)](_0x2edaf9(0x1080),()=>_0x3c8847(_0x32691a)),_0xa155cd['appendChild'](_0x21bfbb);});}let _0x742754={'currentPlaylist':[],'currentIndex':-0x1,'isPlaying':![],'playMode':_0x5a7792(0xf49),'lrcUpdateInterval':null,'parsedLyrics':[],'currentLyricIndex':-0x1};function _0x3c8847(_0x1f3b06){const _0x564ecb=_0x5a7792,_0x1ae53d=document[_0x564ecb(0x64f)](_0x564ecb(0x8a)),_0x395352=document[_0x564ecb(0x64f)]('char-music-player-modal');if(_0x742754[_0x564ecb(0x851)])clearInterval(_0x742754['lrcUpdateInterval']);_0x1ae53d['pause']();const _0xf5bbc5=_0x742754['currentPlaylist'][_0x564ecb(0x6a2)](_0x5761f5=>_0x5761f5['src']===_0x1f3b06[_0x564ecb(0xbe8)]);_0xf5bbc5>-0x1?_0x742754[_0x564ecb(0x409)]=_0xf5bbc5:(_0x742754[_0x564ecb(0x45b)]=[_0x1f3b06],_0x742754[_0x564ecb(0x409)]=0x0);document['getElementById']('char-music-player-title')['textContent']=_0x1f3b06[_0x564ecb(0x6fc)],document[_0x564ecb(0x64f)](_0x564ecb(0xc55))[_0x564ecb(0xee5)]=_0x1f3b06[_0x564ecb(0xb17)],document[_0x564ecb(0x64f)]('char-music-cover')[_0x564ecb(0xbe8)]=_0x1f3b06[_0x564ecb(0x844)],_0x742754[_0x564ecb(0xc35)]=_0x485f9f(_0x1f3b06[_0x564ecb(0x10b2)]||''),_0x41b4a5();if(_0x1f3b06[_0x564ecb(0x1102)]){const _0x47fff4=new Blob([_0x1f3b06['src']],{'type':_0x1f3b06[_0x564ecb(0x5db)]||_0x564ecb(0xc11)});_0x1ae53d[_0x564ecb(0xbe8)]=URL[_0x564ecb(0xb29)](_0x47fff4);}else _0x1ae53d['src']=_0x1f3b06[_0x564ecb(0xbe8)];_0x1ae53d[_0x564ecb(0x1190)]()[_0x564ecb(0x1201)](_0x43a91b=>console[_0x564ecb(0xc60)](_0x564ecb(0xd1d),_0x43a91b)),_0x1ae53d[_0x564ecb(0x250)]=()=>{const _0x4c13c4=_0x564ecb;document[_0x4c13c4(0x64f)]('char-music-total-time')['textContent']=_0x564c3c(_0x1ae53d['duration']),_0x742754[_0x4c13c4(0x851)]=setInterval(_0x45f470,0x1f4);},_0x395352['classList'][_0x564ecb(0xdda)](_0x564ecb(0x40a));}function _0xf0f9f3(){const _0x51d51d=_0x5a7792,_0x4be833=document[_0x51d51d(0x64f)](_0x51d51d(0xc70)),_0x418d02=document['getElementById'](_0x51d51d(0x8a));if(_0x742754['lrcUpdateInterval'])clearInterval(_0x742754[_0x51d51d(0x851)]);_0x418d02[_0x51d51d(0x6ef)](),_0x418d02[_0x51d51d(0xbe8)]='',_0x4be833[_0x51d51d(0x418)][_0x51d51d(0x1275)](_0x51d51d(0x40a)),_0x742754[_0x51d51d(0xad6)]=![],document['getElementById'](_0x51d51d(0x8de))[_0x51d51d(0x418)][_0x51d51d(0x1275)](_0x51d51d(0x59b));}function _0x45f470(){const _0x54d0a3=_0x5a7792,_0x994f58=document[_0x54d0a3(0x64f)](_0x54d0a3(0x8a));if(!_0x994f58[_0x54d0a3(0x25e)])return;const _0x1e4711=_0x994f58[_0x54d0a3(0x76)],_0xce2eaa=_0x994f58[_0x54d0a3(0x25e)];document[_0x54d0a3(0x64f)](_0x54d0a3(0x364))[_0x54d0a3(0x731)][_0x54d0a3(0x1123)]=_0x1e4711/_0xce2eaa*0x64+'%',document['getElementById'](_0x54d0a3(0x10ef))[_0x54d0a3(0xee5)]=_0x564c3c(_0x1e4711),_0xa5591e(_0x1e4711);}function _0x41b4a5(){const _0x270559=_0x5a7792,_0x287234=document['getElementById']('char-music-lyrics');_0x287234[_0x270559(0xc58)]='',_0x742754[_0x270559(0x1249)]=-0x1;if(!_0x742754['parsedLyrics']||_0x742754['parsedLyrics'][_0x270559(0x40f)]===0x0){_0x287234[_0x270559(0xc58)]=_0x270559(0x130d);return;}_0x742754[_0x270559(0xc35)][_0x270559(0x103)]((_0x41e716,_0x2afd8a)=>{const _0x4938dd=_0x270559,_0x15cb5d=document[_0x4938dd(0x124e)]('p');_0x15cb5d['textContent']=_0x41e716[_0x4938dd(0x673)],_0x15cb5d[_0x4938dd(0x12e1)]['index']=_0x2afd8a,_0x287234[_0x4938dd(0x99e)](_0x15cb5d);});}function _0xa5591e(_0x2826b5){const _0x27bbe3=_0x5a7792,_0xf940f9=_0x742754[_0x27bbe3(0xc35)];if(_0xf940f9[_0x27bbe3(0x40f)]===0x0)return;let _0x32ab18=-0x1;for(let _0x549d15=0x0;_0x549d15<_0xf940f9['length'];_0x549d15++){if(_0x2826b5>=_0xf940f9[_0x549d15]['time'])_0x32ab18=_0x549d15;else break;}if(_0x32ab18===_0x742754[_0x27bbe3(0x1249)])return;_0x742754[_0x27bbe3(0x1249)]=_0x32ab18;const _0x4c111b=document[_0x27bbe3(0x64f)]('char-music-lyrics'),_0x50d879=_0x4c111b['querySelectorAll']('p');_0x50d879['forEach'](_0x4458c9=>_0x4458c9[_0x27bbe3(0x418)][_0x27bbe3(0x1275)](_0x27bbe3(0x12ef)));if(_0x32ab18>-0x1){const _0x3bcd2c=_0x4c111b['querySelector'](_0x27bbe3(0x84c)+_0x32ab18+'\x22]');if(_0x3bcd2c){_0x3bcd2c[_0x27bbe3(0x418)][_0x27bbe3(0xdda)]('active');const _0x113224=_0x4c111b['clientHeight']/0x2-_0x3bcd2c[_0x27bbe3(0x1a4)]-_0x3bcd2c[_0x27bbe3(0xbb)]/0x2;_0x50d879[_0x27bbe3(0x103)](_0xbdac51=>{const _0x326fdc=_0x27bbe3;_0xbdac51['style'][_0x326fdc(0x70b)]=_0x326fdc(0x100e)+_0x113224+_0x326fdc(0x9a5);});}}}function _0x48070b(){const _0x93838a=_0x5a7792;if(_0x742754[_0x93838a(0x45b)]['length']===0x0)return;let _0x2b11c9;switch(_0x742754['playMode']){case _0x93838a(0x95f):_0x2b11c9=Math['floor'](Math[_0x93838a(0x95f)]()*_0x742754[_0x93838a(0x45b)][_0x93838a(0x40f)]);break;case _0x93838a(0x1341):_0x3c8847(_0x742754['currentPlaylist'][_0x742754[_0x93838a(0x409)]]);return;case _0x93838a(0xf49):default:_0x2b11c9=(_0x742754[_0x93838a(0x409)]+0x1)%_0x742754[_0x93838a(0x45b)]['length'];break;}_0x3c8847(_0x742754[_0x93838a(0x45b)][_0x2b11c9]);}function _0x273c77(){const _0x2d7c9e=_0x5a7792;if(_0x742754['currentPlaylist']['length']===0x0)return;const _0x23dd3e=(_0x742754[_0x2d7c9e(0x409)]-0x1+_0x742754[_0x2d7c9e(0x45b)][_0x2d7c9e(0x40f)])%_0x742754[_0x2d7c9e(0x45b)][_0x2d7c9e(0x40f)];_0x3c8847(_0x742754['currentPlaylist'][_0x23dd3e]);}function _0x5de360(){const _0x49316e=_0x5a7792,_0x3dc79a=[_0x49316e(0xf49),_0x49316e(0x95f),_0x49316e(0x1341)],_0x2bb620=_0x3dc79a[_0x49316e(0xac7)](_0x742754[_0x49316e(0xf71)]);_0x742754[_0x49316e(0xf71)]=_0x3dc79a[(_0x2bb620+0x1)%_0x3dc79a['length']],document['getElementById'](_0x49316e(0x7d3))[_0x49316e(0xee5)]={'order':'顺序','random':'随机','single':'单曲'}[_0x742754[_0x49316e(0xf71)]];}function _0x1048af(){const _0x3756e9=_0x5a7792,_0x2e8021=document['getElementById']('char-audio-player'),_0x94c275=document[_0x3756e9(0x64f)]('char-music-play-pause-btn'),_0x448d78=document[_0x3756e9(0x64f)](_0x3756e9(0x8de));_0x94c275[_0x3756e9(0xf72)](_0x3756e9(0x1080),()=>{const _0x25eab7=_0x3756e9;if(_0x2e8021[_0x25eab7(0x10b0)]){if(_0x742754[_0x25eab7(0x409)]>-0x1)_0x2e8021[_0x25eab7(0x1190)]();}else _0x2e8021[_0x25eab7(0x6ef)]();}),_0x2e8021[_0x3756e9(0xb0f)]=()=>{const _0x1e4892=_0x3756e9;_0x94c275[_0x1e4892(0xc58)]=_0x1e4892(0x203),_0x448d78[_0x1e4892(0x418)]['add'](_0x1e4892(0x59b)),_0x742754[_0x1e4892(0xad6)]=!![];},_0x2e8021[_0x3756e9(0x649)]=()=>{const _0x57f6e9=_0x3756e9;_0x94c275[_0x57f6e9(0xc58)]=_0x57f6e9(0x3c8),_0x448d78['classList']['remove'](_0x57f6e9(0x59b)),_0x742754[_0x57f6e9(0xad6)]=![];},_0x2e8021[_0x3756e9(0xeb7)]=()=>{const _0x5918e3=_0x3756e9;_0x448d78[_0x5918e3(0x418)][_0x5918e3(0x1275)](_0x5918e3(0x59b)),_0x742754[_0x5918e3(0xad6)]=![],_0x48070b();},document['getElementById'](_0x3756e9(0x8d9))[_0x3756e9(0xf72)](_0x3756e9(0x1080),_0x273c77),document[_0x3756e9(0x64f)](_0x3756e9(0xd1c))['addEventListener'](_0x3756e9(0x1080),_0x48070b),document[_0x3756e9(0x64f)]('char-music-mode-btn')[_0x3756e9(0xf72)](_0x3756e9(0x1080),_0x5de360),document[_0x3756e9(0x64f)](_0x3756e9(0x108))['addEventListener'](_0x3756e9(0x1080),_0xafa62d=>{const _0x3d1dc6=_0x3756e9;if(!_0x2e8021['duration'])return;const _0x3880d4=_0xafa62d[_0x3d1dc6(0xfd1)],_0x53b51c=_0xafa62d[_0x3d1dc6(0x5fc)];_0x2e8021[_0x3d1dc6(0x76)]=_0x53b51c/_0x3880d4[_0x3d1dc6(0x1347)]*_0x2e8021[_0x3d1dc6(0x25e)];});}async function _0x32b817(){const _0x25c076=_0x5a7792,_0x1369b8=document[_0x25c076(0x64f)]('douban-posts-list');_0x1369b8['innerHTML']='';const _0x2e8d13=await _0x4e1bbf[_0x25c076(0xf1c)][_0x25c076(0xe1d)]('timestamp')[_0x25c076(0x2f4)]()['toArray']();if(_0x2e8d13[_0x25c076(0x40f)]===0x0){_0x1369b8[_0x25c076(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20padding:\x2050px\x200;\x22>这里空空如也，<br>点击右上角刷新按钮，看看大家都在聊什么吧！</p>';return;}_0x2e8d13[_0x25c076(0x103)](_0x2fb92a=>{const _0x54e0b4=_0x25c076;let _0x144e47;const _0x1ea061=_0x2fb92a['authorOriginalName']?Object[_0x54e0b4(0xd6d)](_0x3e7a1b['chats'])['find'](_0x598956=>!_0x598956[_0x54e0b4(0x1167)]&&_0x598956['name']===_0x2fb92a['authorOriginalName']):null;if(_0x1ea061)_0x144e47=_0x1ea061[_0x54e0b4(0xcb3)][_0x54e0b4(0x93)];else{const _0x454b5b=Object[_0x54e0b4(0xd6d)](_0x3e7a1b[_0x54e0b4(0x999)])[_0x54e0b4(0x137)](_0x154639=>!_0x154639[_0x54e0b4(0x1167)]&&_0x154639[_0x54e0b4(0x6fc)]===_0x2fb92a[_0x54e0b4(0x5b7)]);if(_0x454b5b)_0x144e47=_0x454b5b['settings'][_0x54e0b4(0x93)];else _0x2fb92a[_0x54e0b4(0xa6b)]?_0x144e47=_0x54e0b4(0xb1f)+encodeURIComponent(_0x2fb92a[_0x54e0b4(0xa6b)]):_0x144e47=_0x54e358;}const _0x3d70fd=document[_0x54e0b4(0x124e)](_0x54e0b4(0x479));_0x3d70fd['className']='douban-post-item',_0x3d70fd['onclick']=()=>_0x51ed67(_0x2fb92a['id']),_0x3d70fd[_0x54e0b4(0xc58)]=_0x54e0b4(0x523)+_0x144e47+_0x54e0b4(0x105f)+_0x2fb92a[_0x54e0b4(0x5b7)]+_0x54e0b4(0x810)+_0x2fb92a[_0x54e0b4(0x1221)]+_0x54e0b4(0x180)+_0x2fb92a[_0x54e0b4(0x5be)]+_0x54e0b4(0x13bc)+_0x2fb92a[_0x54e0b4(0x3ba)]['replace'](/\n/g,_0x54e0b4(0x917))+_0x54e0b4(0xe45)+_0x2fb92a[_0x54e0b4(0xe6e)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span><svg\x20viewBox=\x220\x200\x201024\x201024\x22><path\x20d=\x22M853.333333\x2085.333333H170.666667c-46.933333\x200-85.333333\x2038.4-85.333334\x2085.333334v512c0\x2046.933333\x2038.4\x2085.333333\x2085.333334\x2085.333333h512l170.666667\x20170.666667V170.666667c0-46.933333-38.4-85.333333-85.333334-85.333334z\x20m-42.666666\x20554.666667H170.666667V170.666667h640v469.333333zM256\x20384h512v85.333333H256V384z\x20m0-170.666667h512v85.333334H256v-85.333334z\x22></path></svg>\x20'+_0x2fb92a['commentsCount']+_0x54e0b4(0xf5e)+_0x4942eb(_0x2fb92a[_0x54e0b4(0x8af)])+_0x54e0b4(0x480),_0x1369b8['appendChild'](_0x3d70fd);});}async function _0x2995c5(){const _0xdc83c5=_0x5a7792,_0x7d8199=_0x3e7a1b[_0xdc83c5(0x11b4)][_0xdc83c5(0x142)]||[];if(_0x7d8199[_0xdc83c5(0x40f)]===0x0){await _0x28974b(_0xdc83c5(0xd96),_0xdc83c5(0x1145));return;}await _0x28974b(_0xdc83c5(0x2f7),_0xdc83c5(0x956)+_0x7d8199[_0xdc83c5(0x40f)]+_0xdc83c5(0xb76));const {proxyUrl:_0x5ea37d,apiKey:_0x53b31b,model:_0x24a83a}=_0x3e7a1b[_0xdc83c5(0xec0)];if(!_0x5ea37d||!_0x53b31b||!_0x24a83a){alert(_0xdc83c5(0x1ce));return;}const _0x5d0087=new Set();_0x7d8199['forEach'](_0x33dff5=>{const _0x57bb04=_0xdc83c5,_0x98c3d8=_0x3e7a1b['chats'][_0x33dff5];_0x98c3d8&&_0x98c3d8['settings']['linkedWorldBookIds']&&_0x98c3d8['settings'][_0x57bb04(0xde4)][_0x57bb04(0x103)](_0xcc63c7=>_0x5d0087[_0x57bb04(0xdda)](_0xcc63c7));});let _0x43adee='';_0x5d0087[_0xdc83c5(0x9dd)]>0x0&&(_0x43adee+=_0xdc83c5(0x9f5),_0x5d0087[_0xdc83c5(0x103)](_0x48cda2=>{const _0x10009d=_0xdc83c5,_0xcd84b=_0x3e7a1b[_0x10009d(0x144)][_0x10009d(0x137)](_0x52a89e=>_0x52a89e['id']===_0x48cda2);if(_0xcd84b){const _0x1d0f9c=_0xcd84b[_0x10009d(0x3ba)][_0x10009d(0x156)](_0xd20e7e=>_0xd20e7e[_0x10009d(0x9b)]!==![])[_0x10009d(0xb96)](_0xc24856=>'-\x20'+_0xc24856[_0x10009d(0x3ba)])[_0x10009d(0xd22)]('\x0a');_0x1d0f9c&&(_0x43adee+=_0x10009d(0x39b)+_0xcd84b['name']+_0x10009d(0x1121)+_0x1d0f9c);}}));const _0x4bbef5=_0x3e7a1b[_0xdc83c5(0x144)]['find'](_0x86566d=>_0x86566d[_0xdc83c5(0x6fc)]==='豆瓣设定');let _0x3b5b0c='',_0x856169=[];_0x4bbef5&&_0x4bbef5[_0xdc83c5(0x3ba)][_0xdc83c5(0x103)](_0x4457fa=>{const _0x1fc464=_0xdc83c5;_0x4457fa[_0x1fc464(0x652)][_0x1fc464(0xe53)](_0x1fc464(0x768))&&(_0x3b5b0c+=_0x1fc464(0x9c0)+_0x4457fa['content']);if(_0x4457fa[_0x1fc464(0x652)][_0x1fc464(0xe53)]('NPC人设')){const _0x289bf1=_0x4457fa[_0x1fc464(0x3ba)][_0x1fc464(0x108c)]('\x0a');_0x289bf1['forEach'](_0x3b323c=>{const _0x6126a1=_0x1fc464,_0x32d49a=_0x3b323c[_0x6126a1(0x132a)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x32d49a&&_0x856169[_0x6126a1(0x13ee)]({'name':_0x32d49a[0x1][_0x6126a1(0x43a)](),'persona':_0x32d49a[0x2]['trim']()});});}});const _0x4b21a7=_0x3e7a1b['qzoneSettings'][_0xdc83c5(0x78c)]||'我',_0x248287=_0x7d8199['length']>0x0&&_0x3e7a1b[_0xdc83c5(0x999)][_0x7d8199[0x0]]?_0x3e7a1b['chats'][_0x7d8199[0x0]][_0xdc83c5(0xcb3)][_0xdc83c5(0x1047)]:'(未设置)';let _0x38f958='';_0x7d8199[_0xdc83c5(0x103)](_0xcb0a82=>{const _0x6b999c=_0xdc83c5,_0xc01e17=_0x3e7a1b[_0x6b999c(0x999)][_0xcb0a82];if(_0xc01e17){const _0x234ec4=_0xc01e17[_0x6b999c(0x518)]&&_0xc01e17['longTermMemory']['length']>0x0?_0xc01e17[_0x6b999c(0x518)][_0x6b999c(0xb96)](_0x4b13e8=>_0x4b13e8[_0x6b999c(0x3ba)])['join'](';\x20'):'无',_0x1aa869=_0xc01e17[_0x6b999c(0x830)][_0x6b999c(0xdf5)](-0xa)[_0x6b999c(0xb96)](_0x2b7dda=>(_0x2b7dda[_0x6b999c(0x931)]===_0x6b999c(0xa4d)?_0x4b21a7:_0xc01e17['name'])+':\x20'+String(_0x2b7dda['content'])[_0x6b999c(0x126f)](0x0,0x1e)+_0x6b999c(0x3cd))[_0x6b999c(0xd22)]('\x0a');_0x38f958+=_0x6b999c(0xd7d)+_0xc01e17[_0x6b999c(0x6fc)]+_0x6b999c(0x92e)+_0xc01e17[_0x6b999c(0xcb3)][_0x6b999c(0xbe5)]+_0x6b999c(0x1278)+_0x234ec4+_0x6b999c(0x74a)+_0x1aa869+'</recent_dialogue_with_user>\x0a</character>\x0a';}}),_0x856169[_0xdc83c5(0x103)](_0x1f17c5=>{const _0x420dac=_0xdc83c5;_0x38f958+=_0x420dac(0xd7d)+_0x1f17c5['name']+_0x420dac(0x92e)+_0x1f17c5[_0x420dac(0x324)]+_0x420dac(0xfc0);});const _0x59b2d7=new Date(),_0x2e34d7=_0x59b2d7[_0xdc83c5(0x2b4)](_0xdc83c5(0x6ec),{'dateStyle':_0xdc83c5(0xfd),'timeStyle':'short'}),_0x826c15=_0x3e7a1b[_0xdc83c5(0x11b4)][_0xdc83c5(0x2eb)]||0xc,_0x557e91=_0x3e7a1b[_0xdc83c5(0x11b4)][_0xdc83c5(0xae7)]||0x14,_0x452a22='\x0a#\x20你的任务\x0a你是一个虚拟社区内容生成器。你的任务是根据下面提供的【统一角色列表】，虚构出【'+_0x826c15+'到'+_0x557e91+_0xdc83c5(0x465)+_0x2e34d7+'**。\x0a\x20\x20\x20\x20-\x20\x20\x20你的帖子和评论内容【必须】自然地体现出对【当前真实时间】的感知。\x0a2.\x20\x20**【禁止扮演用户\x20(最最最高优先级！！！)】**:\x0a\x20\x20\x20\x20-\x20\x20\x20用户的昵称是“'+_0x4b21a7+_0xdc83c5(0xf3b)+_0x4b21a7+_0xdc83c5(0x4aa)+_0x3b5b0c+'\x0a'+_0x43adee+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0x2e34d7+_0xdc83c5(0x13dc)+_0x4b21a7+_0xdc83c5(0x7d5)+_0x248287+'\x0a\x0a#\x20统一角色列表\x20(你扮演的角色\x20+\x20路人NPC)\x0a'+_0x38f958+_0xdc83c5(0xc57);try{const _0x4cadf1=[{'role':'user','content':_0xdc83c5(0x6d8)}];let _0x325d26=_0x5ea37d[_0xdc83c5(0xe53)](_0xdc83c5(0x742)),_0x139dd=_0x250668(_0x24a83a,_0x53b31b,_0x452a22,_0x4cadf1);const _0x510ed4=_0x325d26?await fetch(_0x139dd['url'],_0x139dd[_0xdc83c5(0x88a)]):await fetch(_0x5ea37d+'/v1/chat/completions',{'method':_0xdc83c5(0x2d1),'headers':{'Content-Type':_0xdc83c5(0x7fe),'Authorization':_0xdc83c5(0x236)+_0x53b31b},'body':JSON[_0xdc83c5(0xe3f)]({'model':_0x24a83a,'messages':[{'role':_0xdc83c5(0x905),'content':_0x452a22},..._0x4cadf1],'temperature':_0x3e7a1b[_0xdc83c5(0x11b4)][_0xdc83c5(0xa55)]||0x1})});if(!_0x510ed4['ok'])throw new Error(_0xdc83c5(0x1fa)+_0x510ed4[_0xdc83c5(0x132c)]);const _0x554911=await _0x510ed4[_0xdc83c5(0x6f8)](),_0x3fd603=getGeminiResponseText(_0x554911),_0x4d5cc3=_0x3fd603['match'](/\[[\s\S]*\]/);if(!_0x4d5cc3)throw new Error(_0xdc83c5(0x909)+_0x3fd603);const _0xb522cc=JSON[_0xdc83c5(0x1214)](_0x4d5cc3[0x0]);await _0x4e1bbf[_0xdc83c5(0xf1c)]['clear'](),await _0x4e1bbf[_0xdc83c5(0xf1c)][_0xdc83c5(0x36f)](_0xb522cc[_0xdc83c5(0xb96)](_0x14f8ea=>({..._0x14f8ea,'timestamp':Date[_0xdc83c5(0x2b5)]()-Math[_0xdc83c5(0x95f)]()*0x186a0}))),await _0x32b817();}catch(_0x43c995){console[_0xdc83c5(0xc60)](_0xdc83c5(0x125d),_0x43c995),await _0x28974b(_0xdc83c5(0x129b),_0xdc83c5(0x433)+_0x43c995[_0xdc83c5(0x854)]);}}async function _0x51ed67(_0xd250a1){const _0x5781ac=_0x5a7792;_0xddd8ae(_0x5781ac(0x1180)),_0x169b3f=_0xd250a1;const _0x1608a9=await _0x4e1bbf['doubanPosts'][_0x5781ac(0x11fc)](_0xd250a1);if(!_0x1608a9){_0xddd8ae(_0x5781ac(0x4c1));return;}document[_0x5781ac(0x64f)](_0x5781ac(0x342))[_0x5781ac(0xee5)]=_0x5781ac(0x10ab);let _0x488012=_0x54e358,_0x4e9591=_0x1608a9[_0x5781ac(0x5b7)];const _0x2ae220=_0x1608a9[_0x5781ac(0xa0a)]?Object['values'](_0x3e7a1b['chats'])['find'](_0x266da4=>!_0x266da4['isGroup']&&_0x266da4[_0x5781ac(0x7de)]===_0x1608a9[_0x5781ac(0xa0a)]):null;if(_0x2ae220)_0x488012=_0x2ae220[_0x5781ac(0xcb3)]['aiAvatar'];else{const _0x6eb78b=Object[_0x5781ac(0xd6d)](_0x3e7a1b[_0x5781ac(0x999)])[_0x5781ac(0x137)](_0x389f31=>!_0x389f31[_0x5781ac(0x1167)]&&_0x389f31[_0x5781ac(0x6fc)]===_0x1608a9[_0x5781ac(0x5b7)]);if(_0x6eb78b)_0x488012=_0x6eb78b[_0x5781ac(0xcb3)][_0x5781ac(0x93)];else _0x1608a9[_0x5781ac(0xa6b)]&&(_0x488012=_0x5781ac(0xb1f)+encodeURIComponent(_0x1608a9[_0x5781ac(0xa6b)]));}document['getElementById'](_0x5781ac(0x112e))['src']=_0x488012,document[_0x5781ac(0x64f)](_0x5781ac(0x8d2))['textContent']=_0x4e9591,document[_0x5781ac(0x64f)](_0x5781ac(0x1085))[_0x5781ac(0xee5)]=_0x5781ac(0x33a)+_0x1608a9['groupName'],document[_0x5781ac(0x64f)](_0x5781ac(0xe1e))[_0x5781ac(0xee5)]=_0x1608a9[_0x5781ac(0x5be)],document['getElementById'](_0x5781ac(0xb35))[_0x5781ac(0xc58)]=_0x1608a9[_0x5781ac(0x3ba)][_0x5781ac(0x137f)](/\n/g,_0x5781ac(0x917)),document[_0x5781ac(0x64f)](_0x5781ac(0xae8))['src']=_0x3e7a1b[_0x5781ac(0x3c2)][_0x5781ac(0x1265)],document['getElementById'](_0x5781ac(0x11a0))[_0x5781ac(0xbed)]='';const _0x306fda=document['getElementById'](_0x5781ac(0x62e));_0x306fda['innerHTML']='';if(_0x1608a9[_0x5781ac(0xff)]&&_0x1608a9['comments'][_0x5781ac(0x40f)]>0x0){const _0x144aad=new Map();_0x1608a9[_0x5781ac(0xff)][_0x5781ac(0x103)](_0x55f45c=>{const _0x11497b=_0x5781ac;let _0x2b09b9=_0x54e358;const _0x4aa7c0=_0x3e7a1b[_0x11497b(0x3c2)][_0x11497b(0x78c)]||'我',_0x48d88a=_0x55f45c[_0x11497b(0x288)];if(_0x144aad['has'](_0x48d88a))_0x2b09b9=_0x144aad[_0x11497b(0x11fc)](_0x48d88a);else{if(_0x48d88a===_0x4aa7c0)_0x2b09b9=_0x3e7a1b[_0x11497b(0x3c2)][_0x11497b(0x1265)];else{if(_0x48d88a===_0x1608a9[_0x11497b(0x5b7)])_0x2b09b9=_0x488012;else{const _0x4641df=_0x55f45c[_0x11497b(0x7c1)]?Object[_0x11497b(0xd6d)](_0x3e7a1b[_0x11497b(0x999)])[_0x11497b(0x137)](_0x38986c=>!_0x38986c[_0x11497b(0x1167)]&&_0x38986c['originalName']===_0x55f45c[_0x11497b(0x7c1)]):null;if(_0x4641df)_0x2b09b9=_0x4641df[_0x11497b(0xcb3)][_0x11497b(0x93)];else{const _0x21f964=Object[_0x11497b(0xd6d)](_0x3e7a1b['chats'])['find'](_0x445c54=>!_0x445c54['isGroup']&&_0x445c54[_0x11497b(0x6fc)]===_0x48d88a);if(_0x21f964)_0x2b09b9=_0x21f964[_0x11497b(0xcb3)][_0x11497b(0x93)];else _0x55f45c[_0x11497b(0x597)]&&(_0x2b09b9=_0x11497b(0xb1f)+encodeURIComponent(_0x55f45c[_0x11497b(0x597)]));}}}_0x144aad[_0x11497b(0x125e)](_0x48d88a,_0x2b09b9);}const _0x5d1eb0=document[_0x11497b(0x124e)]('div');_0x5d1eb0[_0x11497b(0x87d)]='douban-comment-item',_0x5d1eb0['innerHTML']=_0x11497b(0x7b7)+_0x2b09b9+'\x22\x20class=\x22douban-comment-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-body\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22douban-comment-author\x22>'+_0x48d88a+_0x11497b(0x83e)+_0x55f45c[_0x11497b(0x673)][_0x11497b(0x137f)](/\n/g,_0x11497b(0x917))+_0x11497b(0x2e7),_0x306fda[_0x11497b(0x99e)](_0x5d1eb0);});}else _0x306fda[_0x5781ac(0xc58)]=_0x5781ac(0x5c5);const _0x52b03b=document[_0x5781ac(0x64f)](_0x5781ac(0x138e));if(_0x52b03b)_0x52b03b['scrollTop']=0x0;}async function _0x44ab68(){const _0x5bb6e3=_0x5a7792;if(!_0x169b3f)return;const _0x4ccbc4=document[_0x5bb6e3(0x64f)](_0x5bb6e3(0x11a0)),_0x4c3e6e=_0x4ccbc4[_0x5bb6e3(0xbed)][_0x5bb6e3(0x43a)]();if(!_0x4c3e6e)return;const _0x3a35c3=await _0x4e1bbf[_0x5bb6e3(0xf1c)][_0x5bb6e3(0x11fc)](_0x169b3f);if(!_0x3a35c3)return;!_0x3a35c3[_0x5bb6e3(0xff)]&&(_0x3a35c3['comments']=[]);const _0x2ed58a=_0x3e7a1b[_0x5bb6e3(0x3c2)][_0x5bb6e3(0x78c)]||'我';_0x3a35c3['comments'][_0x5bb6e3(0x13ee)]({'commenter':_0x2ed58a,'text':_0x4c3e6e}),_0x3a35c3['commentsCount']++,await _0x4e1bbf[_0x5bb6e3(0xf1c)][_0x5bb6e3(0x4fa)](_0x3a35c3),_0x4ccbc4[_0x5bb6e3(0xbed)]='',await _0x51ed67(_0x169b3f);}async function _0x218bb1(){const _0x50a084=_0x5a7792;if(!_0x169b3f)return;const _0x455bbe=_0x169b3f,_0x35a983=await _0x4e1bbf[_0x50a084(0xf1c)][_0x50a084(0x11fc)](_0x455bbe);if(!_0x35a983)return;const _0x171684=_0x35a983[_0x50a084(0xff)]&&_0x35a983[_0x50a084(0xff)]['slice'](-0x1)[0x0];if(!_0x171684){alert('还没有任何评论，无法等待回复。');return;}await _0x28974b(_0x50a084(0x2f7),_0x50a084(0x134e));try{const {proxyUrl:_0x1c303e,apiKey:_0x23300e,model:_0x4a80b6}=_0x3e7a1b[_0x50a084(0xec0)];if(!_0x1c303e||!_0x23300e||!_0x4a80b6)throw new Error(_0x50a084(0xb6a));const _0x38dd59=_0x3e7a1b[_0x50a084(0x3c2)][_0x50a084(0x78c)]||'我',_0x1e2827=_0x3e7a1b[_0x50a084(0x999)][Object[_0x50a084(0xc30)](_0x3e7a1b[_0x50a084(0x999)])[0x0]]?.['settings'][_0x50a084(0x1047)]||_0x50a084(0x9ef),_0x586312=new Map();_0x35a983['comments']&&_0x35a983[_0x50a084(0xff)]['forEach'](_0x34c05a=>{const _0x217573=_0x50a084,_0x4f3233=(_0x3e7a1b['globalSettings'][_0x217573(0x142)]||[])[_0x217573(0x26c)](_0x54f3d5=>_0x3e7a1b[_0x217573(0x999)][_0x54f3d5]?.[_0x217573(0x6fc)]===_0x34c05a[_0x217573(0x288)]);!_0x4f3233&&_0x34c05a[_0x217573(0x597)]&&_0x586312[_0x217573(0x125e)](_0x34c05a[_0x217573(0x288)],_0x34c05a[_0x217573(0x597)]);});let _0x2f3653='#\x20已有路人NPC头像指令\x20(必须遵守！)\x0a';_0x586312['size']>0x0?(_0x2f3653+=_0x50a084(0x1380),_0x586312[_0x50a084(0x103)]((_0x402de1,_0x2a46b3)=>{const _0x690fa9=_0x50a084;_0x2f3653+='-\x20**'+_0x2a46b3+_0x690fa9(0xa58)+_0x402de1+'\x22\x0a';})):_0x2f3653+=_0x50a084(0x77a);const _0x22ca73=_0x3e7a1b[_0x50a084(0x144)][_0x50a084(0x137)](_0x10bcb8=>_0x10bcb8[_0x50a084(0x6fc)]===_0x50a084(0x64e));let _0x4c83de=[];_0x22ca73&&_0x22ca73['content']['forEach'](_0x9bb6af=>{const _0x45d5fb=_0x50a084;if(_0x9bb6af[_0x45d5fb(0x652)][_0x45d5fb(0xe53)](_0x45d5fb(0xa9c))){const _0x1d5ee9=_0x9bb6af[_0x45d5fb(0x3ba)][_0x45d5fb(0x108c)]('\x0a');_0x1d5ee9[_0x45d5fb(0x103)](_0x595614=>{const _0x443f8b=_0x45d5fb,_0x115279=_0x595614[_0x443f8b(0x132a)](/- \*\*昵称\*\*:\s*(.*?)\s*\*\*人设\*\*:\s*(.*)/);_0x115279&&_0x4c83de[_0x443f8b(0x13ee)]({'name':_0x115279[0x1][_0x443f8b(0x43a)](),'persona':_0x115279[0x2][_0x443f8b(0x43a)]()});});}});let _0xc08347='';const _0x4f070e=_0x3e7a1b[_0x50a084(0x11b4)][_0x50a084(0x142)]||[];_0x4f070e['forEach'](_0x136bf3=>{const _0x29dcb7=_0x50a084,_0x5a03d5=_0x3e7a1b['chats'][_0x136bf3];if(_0x5a03d5){const _0x3b6c29=_0x5a03d5['longTermMemory']&&_0x5a03d5[_0x29dcb7(0x518)]['length']>0x0?_0x5a03d5[_0x29dcb7(0x518)][_0x29dcb7(0xb96)](_0x5ed714=>_0x5ed714[_0x29dcb7(0x3ba)])['join'](';\x20'):'无',_0x549193=_0x5a03d5[_0x29dcb7(0x830)][_0x29dcb7(0xdf5)](-0xa)['map'](_0x1bcdfb=>(_0x1bcdfb[_0x29dcb7(0x931)]===_0x29dcb7(0xa4d)?_0x38dd59:_0x5a03d5[_0x29dcb7(0x6fc)])+':\x20'+String(_0x1bcdfb[_0x29dcb7(0x3ba)])[_0x29dcb7(0x126f)](0x0,0x1e)+_0x29dcb7(0x3cd))[_0x29dcb7(0xd22)]('\x0a');_0xc08347+='\x0a-\x20'+_0x5a03d5['name']+':\x20'+_0x5a03d5[_0x29dcb7(0xcb3)][_0x29dcb7(0xbe5)][_0x29dcb7(0x126f)](0x0,0x32)+'...\x20[记忆:\x20'+_0x3b6c29+']\x20[最近对话:\x20'+_0x549193+']';}}),_0x4c83de[_0x50a084(0x103)](_0xf5fc5c=>{const _0x23f103=_0x50a084;_0xc08347+=_0x23f103(0xaa8)+_0xf5fc5c[_0x23f103(0x6fc)]+':\x20'+_0xf5fc5c[_0x23f103(0x324)];});const _0x514bae=new Date(),_0x568d74=_0x514bae[_0x50a084(0x2b4)](_0x50a084(0x6ec),{'dateStyle':_0x50a084(0xfd),'timeStyle':_0x50a084(0xf1)}),_0xb31f7c=_0x50a084(0x968)+_0x38dd59+_0x50a084(0x25f)+_0x568d74+_0x50a084(0x6d1)+_0x38dd59+_0x50a084(0x80b)+_0x38dd59+_0x50a084(0xddc)+_0x35a983[_0x50a084(0x5be)]+_0x50a084(0x989)+_0x35a983[_0x50a084(0x5b7)]+_0x50a084(0xc48)+_0x35a983['content'][_0x50a084(0x126f)](0x0,0x64)+_0x50a084(0xb39)+_0x35a983[_0x50a084(0xff)][_0x50a084(0xb96)](_0x28f2c6=>'-\x20'+_0x28f2c6[_0x50a084(0x288)]+':\x20'+_0x28f2c6[_0x50a084(0x673)])[_0x50a084(0xd22)]('\x0a')+'\x0a\x0a'+_0x2f3653+'\x0a\x0a#\x20当前情景\x0a-\x20**当前真实时间**:\x20'+_0x568d74+_0x50a084(0x4b8)+_0x38dd59+_0x50a084(0x7d5)+_0x1e2827+_0x50a084(0xb2f)+_0xc08347+_0x50a084(0x5b3),_0x350e86=[{'role':_0x50a084(0xa4d),'content':'请根据以上情景，生成新的评论。'}];let _0x4fe71f=_0x1c303e[_0x50a084(0xe53)](_0x50a084(0x742)),_0x7c890f=_0x250668(_0x4a80b6,_0x23300e,_0xb31f7c,_0x350e86);const _0x5b2ce6=_0x4fe71f?await fetch(_0x7c890f['url'],_0x7c890f[_0x50a084(0x88a)]):await fetch(_0x1c303e+'/v1/chat/completions',{'method':'POST','headers':{'Content-Type':_0x50a084(0x7fe),'Authorization':_0x50a084(0x236)+_0x23300e},'body':JSON[_0x50a084(0xe3f)]({'model':_0x4a80b6,'messages':[{'role':_0x50a084(0x905),'content':_0xb31f7c},..._0x350e86],'temperature':_0x3e7a1b[_0x50a084(0x11b4)]['apiTemperature']||0x1})});if(!_0x5b2ce6['ok'])throw new Error(_0x50a084(0x1fa)+_0x5b2ce6[_0x50a084(0x132c)]);const _0xab1bef=await _0x5b2ce6[_0x50a084(0x6f8)](),_0x4580d2=getGeminiResponseText(_0xab1bef),_0xdce05b=_0x4580d2['replace'](/^```json\s*/,'')['replace'](/```$/,''),_0x4f3bac=JSON['parse'](_0xdce05b);Array[_0x50a084(0x97e)](_0x4f3bac)&&_0x4f3bac[_0x50a084(0x40f)]>0x0&&(_0x35a983[_0x50a084(0xff)][_0x50a084(0x13ee)](..._0x4f3bac),_0x35a983[_0x50a084(0x383)]+=_0x4f3bac['length'],await _0x4e1bbf[_0x50a084(0xf1c)][_0x50a084(0x4fa)](_0x35a983)),await _0x51ed67(_0x455bbe),_0x516d41();}catch(_0x218c31){console[_0x50a084(0xc60)]('等待回复失败:',_0x218c31),await _0x28974b('操作失败',_0x50a084(0xbe3)+_0x218c31[_0x50a084(0x854)]);}}async function _0x3f3977(){const _0x1d5f7b=_0x5a7792,_0x457565=document[_0x1d5f7b(0x64f)](_0x1d5f7b(0x538)),_0x335afe=document['getElementById'](_0x1d5f7b(0x7bc));_0x335afe[_0x1d5f7b(0xc58)]='';const _0x540387=Object[_0x1d5f7b(0xd6d)](_0x3e7a1b[_0x1d5f7b(0x999)])[_0x1d5f7b(0x156)](_0x401165=>!_0x401165[_0x1d5f7b(0x1167)]),_0x5edf3a=new Set(_0x3e7a1b[_0x1d5f7b(0x11b4)][_0x1d5f7b(0x142)]||[]);_0x540387['length']===0x0?_0x335afe['innerHTML']=_0x1d5f7b(0xea2):_0x540387[_0x1d5f7b(0x103)](_0x4063e2=>{const _0xdb142b=_0x1d5f7b,_0x243e57=document[_0xdb142b(0x124e)](_0xdb142b(0x479));_0x243e57[_0xdb142b(0x87d)]=_0xdb142b(0x6e3),_0x243e57['innerHTML']=_0xdb142b(0xff1)+_0x4063e2['id']+'\x22\x20'+(_0x5edf3a[_0xdb142b(0x2a6)](_0x4063e2['id'])?'checked':'')+_0xdb142b(0x1200)+(_0x4063e2[_0xdb142b(0xcb3)]['aiAvatar']||_0x54e358)+_0xdb142b(0xabf)+_0x4063e2[_0xdb142b(0x6fc)]+_0xdb142b(0xd3b),_0x335afe[_0xdb142b(0x99e)](_0x243e57);}),_0x457565[_0x1d5f7b(0x418)]['add']('visible');}async function _0x2dbf68(){const _0x4ecc0e=_0x5a7792,_0x20b22c=document[_0x4ecc0e(0x233)]('#douban-cast-list\x20.douban-cast-checkbox:checked'),_0x154eaa=Array['from'](_0x20b22c)['map'](_0x5eeb62=>_0x5eeb62['dataset'][_0x4ecc0e(0x367)]);_0x3e7a1b[_0x4ecc0e(0x11b4)][_0x4ecc0e(0x142)]=_0x154eaa,await _0x4e1bbf[_0x4ecc0e(0x11b4)][_0x4ecc0e(0x4fa)](_0x3e7a1b['globalSettings']),document['getElementById'](_0x4ecc0e(0x538))[_0x4ecc0e(0x418)]['remove'](_0x4ecc0e(0x40a)),await _0x2995c5();}document[_0x5a7792(0x64f)](_0x5a7792(0x1020))[_0x5a7792(0xf72)]('click',_0x3f3977),document['getElementById'](_0x5a7792(0x10c0))[_0x5a7792(0xf72)]('click',()=>{const _0x911f2c=_0x5a7792;document[_0x911f2c(0x64f)](_0x911f2c(0x538))[_0x911f2c(0x418)][_0x911f2c(0x1275)](_0x911f2c(0x40a));}),document[_0x5a7792(0x64f)](_0x5a7792(0x155))[_0x5a7792(0xf72)](_0x5a7792(0x1080),_0x2dbf68),document['getElementById'](_0x5a7792(0x7bc))[_0x5a7792(0xf72)](_0x5a7792(0x1080),_0x1727bb=>{const _0x1fc5d5=_0x5a7792,_0x23a846=_0x1727bb[_0x1fc5d5(0xf5b)][_0x1fc5d5(0x2fc)](_0x1fc5d5(0x139));if(_0x23a846){const _0x1e33cc=_0x23a846['querySelector'](_0x1fc5d5(0x30e));_0x1e33cc&&_0x1727bb[_0x1fc5d5(0xf5b)]!==_0x1e33cc&&(_0x1e33cc[_0x1fc5d5(0xf1d)]=!_0x1e33cc['checked']);}});async function _0x34cf37(_0x21c9c3){const _0x5718da=_0x5a7792;if(!_0x21c9c3)return;const _0x16b6ee=await _0x54149f(_0x5718da(0xa0b),_0x5718da(0xcd1),{'confirmText':_0x5718da(0xc7e)});if(!_0x16b6ee)return;try{const _0x55b37d=await _0x21c9c3[_0x5718da(0x673)](),_0x5a7261=JSON[_0x5718da(0x1214)](_0x55b37d);if(!_0x5a7261[_0x5718da(0x6fe)]&&!_0x5a7261['globalCss']&&!_0x5a7261['appIcons'])throw new Error(_0x5718da(0xf55));Object[_0x5718da(0x27d)](_0x3e7a1b[_0x5718da(0x11b4)],_0x5a7261),await _0x4e1bbf[_0x5718da(0x11b4)][_0x5718da(0x4fa)](_0x3e7a1b['globalSettings']),_0x11d2f9(),_0x16a875(),_0x5dc542(),_0x5f4cf3(),_0x39cff1(_0x3e7a1b[_0x5718da(0x11b4)][_0x5718da(0xedb)]),_0x397027(_0x3e7a1b[_0x5718da(0x11b4)]['fontUrl']),_0x4e3634(),_0x320954(),_0x309ef1(),await _0x28974b(_0x5718da(0x583),_0x5718da(0x789));}catch(_0x3574fd){console['error'](_0x5718da(0x7c8),_0x3574fd),await _0x28974b(_0x5718da(0xae3),'文件解析或应用失败:\x20'+_0x3574fd[_0x5718da(0x854)]);}}async function _0x5cfb56(_0x2b1f54){const _0x9ad1b8=_0x5a7792;console[_0x9ad1b8(0x1081)](_0x9ad1b8(0x1211)+_0x2b1f54[_0x9ad1b8(0xc89)](0x1)+_0x9ad1b8(0xba1));const _0x314298=Object[_0x9ad1b8(0xd6d)](_0x3e7a1b[_0x9ad1b8(0x999)])[_0x9ad1b8(0x156)](_0x271d36=>!_0x271d36[_0x9ad1b8(0x1167)]&&_0x271d36[_0x9ad1b8(0xcb3)][_0x9ad1b8(0x11c3)]&&_0x271d36[_0x9ad1b8(0x55f)]?.[_0x9ad1b8(0x69e)]===_0x9ad1b8(0xfdd));if(_0x314298[_0x9ad1b8(0x40f)]===0x0){console[_0x9ad1b8(0x1081)]('没有配置为后台活跃的角色，跳过模拟。');return;}for(const _0x2307ae of _0x314298){const _0x4d0cc8=_0x2307ae[_0x9ad1b8(0xcb3)][_0x9ad1b8(0x963)]||0xf,_0x3a2976=_0x2307ae[_0x9ad1b8(0x11ea)]?(Date[_0x9ad1b8(0x2b5)]()-_0x2307ae[_0x9ad1b8(0x11ea)])/(0x3e8*0x3c):Infinity;_0x2b1f54>_0x4d0cc8&&_0x3a2976>_0x4d0cc8&&(Math[_0x9ad1b8(0x95f)]()<0.3&&(console[_0x9ad1b8(0x1081)](_0x9ad1b8(0x13a2)+_0x2307ae[_0x9ad1b8(0x6fc)]+_0x9ad1b8(0x13d9)),Math['random']()<0.7?await _0x42a425(_0x2307ae['id']):console[_0x9ad1b8(0x1081)](_0x9ad1b8(0x13a2)+_0x2307ae[_0x9ad1b8(0x6fc)]+_0x9ad1b8(0x39d))));}}function _0x46b53d(){const _0xd4a3ef=_0x5a7792;if(!_0x3e7a1b[_0xd4a3ef(0x777)])return;const _0xb155ac=_0x3e7a1b[_0xd4a3ef(0x999)][_0x3e7a1b['activeChatId']];document[_0xd4a3ef(0x64f)](_0xd4a3ef(0x1008))[_0xd4a3ef(0xbed)]='',document[_0xd4a3ef(0x64f)](_0xd4a3ef(0xb10))[_0xd4a3ef(0xbed)]='',document['getElementById'](_0xd4a3ef(0xc44))[_0xd4a3ef(0xc58)]=_0xd4a3ef(0x15a),_0xddd8ae(_0xd4a3ef(0x3d0));}async function _0x3ec414(){const _0x3c229d=_0x5a7792,_0x30f6f1=_0x3e7a1b[_0x3c229d(0x999)][_0x3e7a1b['activeChatId']];if(!_0x30f6f1)return;const _0x3bc243=document[_0x3c229d(0x64f)](_0x3c229d(0x1008))[_0x3c229d(0xbed)][_0x3c229d(0x43a)]()[_0x3c229d(0x36d)](),_0x2764a9=document[_0x3c229d(0x64f)](_0x3c229d(0xb10))[_0x3c229d(0xbed)];if(!_0x3bc243&&!_0x2764a9){alert(_0x3c229d(0xb3e));return;}let _0x11697a=_0x30f6f1[_0x3c229d(0x830)]['filter'](_0x26e382=>!_0x26e382[_0x3c229d(0x5cc)]);_0x3bc243&&(_0x11697a=_0x11697a['filter'](_0x13892e=>{const _0x3e2caf=_0x3c229d;let _0x27baf7='';if(typeof _0x13892e[_0x3e2caf(0x3ba)]===_0x3e2caf(0x1251))_0x27baf7=_0x13892e['content'];else{if(_0x13892e[_0x3e2caf(0xafc)]===_0x3e2caf(0xe76))_0x27baf7=_0x13892e[_0x3e2caf(0x3ba)];else{if(_0x13892e[_0x3e2caf(0xafc)]===_0x3e2caf(0x118)||_0x13892e[_0x3e2caf(0xafc)]==='user_photo')_0x27baf7=_0x13892e[_0x3e2caf(0x3ba)];else{if(_0x13892e[_0x3e2caf(0xafc)]===_0x3e2caf(0x9cb))_0x27baf7=(_0x13892e['dialogue']||'')+'\x20'+(_0x13892e[_0x3e2caf(0x9af)]||'');else _0x13892e['quote']&&(_0x27baf7=_0x13892e[_0x3e2caf(0x3ba)]);}}}return _0x27baf7[_0x3e2caf(0x36d)]()[_0x3e2caf(0xe53)](_0x3bc243);}));if(_0x2764a9){const _0x42a067=new Date(_0x2764a9),_0x46c98c=new Date(_0x42a067['setHours'](0x0,0x0,0x0,0x0))['getTime'](),_0x21ce65=new Date(_0x42a067[_0x3c229d(0x1204)](0x17,0x3b,0x3b,0x3e7))[_0x3c229d(0x767)]();_0x11697a=_0x11697a[_0x3c229d(0x156)](_0x1994ce=>_0x1994ce[_0x3c229d(0x8af)]>=_0x46c98c&&_0x1994ce[_0x3c229d(0x8af)]<=_0x21ce65);}await _0x10ec92(_0x11697a);}async function _0x10ec92(_0x24bc04){const _0xf4379b=_0x5a7792,_0x5f4903=document[_0xf4379b(0x64f)](_0xf4379b(0xc44)),_0x54ab02=_0x3e7a1b[_0xf4379b(0x999)][_0x3e7a1b[_0xf4379b(0x777)]];_0x5f4903[_0xf4379b(0xc58)]='';if(_0x24bc04[_0xf4379b(0x40f)]===0x0){_0x5f4903[_0xf4379b(0xc58)]=_0xf4379b(0x1390);return;}let _0x2a0617='';for(const _0x5bb997 of _0x24bc04){const _0xbcafc5=new Date(_0x5bb997[_0xf4379b(0x8af)]),_0xd249e5=_0xbcafc5['toLocaleDateString']();if(_0xd249e5!==_0x2a0617){const _0x2e35f2=document[_0xf4379b(0x124e)](_0xf4379b(0x479));_0x2e35f2['className']='date-separator',_0x2e35f2['textContent']=_0xf4379b(0xe73)+_0xbcafc5[_0xf4379b(0xf87)]()+'年'+(_0xbcafc5['getMonth']()+0x1)+'月'+_0xbcafc5[_0xf4379b(0x12e)]()+_0xf4379b(0x67d),_0x5f4903['appendChild'](_0x2e35f2),_0x2a0617=_0xd249e5;}const _0xa40ad0=await _0x3209f4(_0x5bb997,_0x54ab02);_0xa40ad0&&(_0xa40ad0[_0xf4379b(0x731)]['cursor']=_0xf4379b(0x7fb),_0xa40ad0[_0xf4379b(0xf72)]('click',()=>_0x3ac774(_0x5bb997[_0xf4379b(0x8af)])),_0x5f4903[_0xf4379b(0x99e)](_0xa40ad0));}}async function _0x3ac774(_0x8ee15c){const _0x414dc0=_0x5a7792,_0x3b50d5=_0x3e7a1b[_0x414dc0(0x777)];if(!_0x3b50d5)return;_0xddd8ae(_0x414dc0(0x9aa)),setTimeout(async()=>{const _0x4ad4dd=_0x414dc0,_0x561399=document[_0x4ad4dd(0x64f)](_0x4ad4dd(0x207)),_0x46d66f='.message-bubble[data-timestamp=\x22'+_0x8ee15c+'\x22]';let _0x1cc977=_0x561399[_0x4ad4dd(0x49c)](_0x46d66f),_0x27b45a=0x0;const _0x336477=0x14;while(!_0x1cc977&&_0x27b45a<_0x336477){const _0x12dde4=document['getElementById'](_0x4ad4dd(0xc22));if(_0x12dde4)console[_0x4ad4dd(0x1081)](_0x4ad4dd(0xe09)+(_0x27b45a+0x1)+')'),await _0x1696d2(),_0x1cc977=_0x561399[_0x4ad4dd(0x49c)](_0x46d66f),_0x27b45a++;else break;}_0xbe5c44(_0x8ee15c);},0xc8);}async function _0x368dca(){const _0x337660=_0x5a7792;document[_0x337660(0x64f)]('keyword-search-input')[_0x337660(0xbed)]='',document[_0x337660(0x64f)](_0x337660(0xb10))['value']='',await _0x10ec92(_0x3e7a1b[_0x337660(0x999)][_0x3e7a1b['activeChatId']][_0x337660(0x830)]['filter'](_0x45df96=>!_0x45df96[_0x337660(0x5cc)]));}async function _0x1b9477(_0x298f04=![],_0x3eedb5=null,_0x1db009=null){const _0x225aeb=_0x5a7792,_0x4588e5=document[_0x225aeb(0x64f)](_0x225aeb(0x831)),_0x2c4e63=document[_0x225aeb(0x64f)](_0x225aeb(0xc8f)),_0x55fb29=_0x3e7a1b[_0x225aeb(0x999)][_0x3e7a1b[_0x225aeb(0x777)]];_0x4588e5['innerHTML']='',_0x2c4e63['innerHTML']='';const _0x2e8354=await _0x4e1bbf['customAvatarFrames'][_0x225aeb(0x78f)](),_0xff86d5=[..._0x1f4fc7,..._0x2e8354];document[_0x225aeb(0x49c)](_0x225aeb(0x9b4))[_0x225aeb(0x731)][_0x225aeb(0x130)]=_0x298f04?_0x225aeb(0x1209):_0x225aeb(0x1026),document['getElementById'](_0x225aeb(0xe31))[_0x225aeb(0x731)][_0x225aeb(0x130)]=_0x225aeb(0xb37),document['getElementById']('my-frame-content')[_0x225aeb(0x731)][_0x225aeb(0x130)]='none',document[_0x225aeb(0x64f)](_0x225aeb(0xf94))[_0x225aeb(0x418)][_0x225aeb(0xdda)](_0x225aeb(0x12ef)),document[_0x225aeb(0x64f)]('my-frame-tab')[_0x225aeb(0x418)][_0x225aeb(0x1275)](_0x225aeb(0x12ef));if(_0x298f04)_0xff86d5['forEach'](_0x2e51dd=>{const _0x25d482=_0x225aeb,_0x2ac105=_0x4a39f9(_0x2e51dd,'my',_0x3eedb5);_0x2e51dd[_0x25d482(0xe52)]===_0x1db009&&_0x2ac105[_0x25d482(0x418)][_0x25d482(0xdda)](_0x25d482(0xbe6)),_0x4588e5[_0x25d482(0x99e)](_0x2ac105);});else{const _0x45cb8a=_0x55fb29[_0x225aeb(0xcb3)][_0x225aeb(0x93)]||_0x54e358,_0x7ec352=_0x55fb29[_0x225aeb(0xcb3)][_0x225aeb(0x96a)]||(_0x55fb29['isGroup']?_0x60cf2:_0x54e358);_0xff86d5[_0x225aeb(0x103)](_0x103802=>{const _0x9b3268=_0x225aeb,_0x523d18=_0x4a39f9(_0x103802,'ai',_0x45cb8a);if(_0x103802[_0x9b3268(0xe52)]===_0x84d9ce['ai'])_0x523d18[_0x9b3268(0x418)][_0x9b3268(0xdda)](_0x9b3268(0xbe6));_0x4588e5[_0x9b3268(0x99e)](_0x523d18);const _0x42d6e5=_0x4a39f9(_0x103802,'my',_0x7ec352);if(_0x103802[_0x9b3268(0xe52)]===_0x84d9ce['my'])_0x42d6e5['classList']['add']('selected');_0x2c4e63[_0x9b3268(0x99e)](_0x42d6e5);});}}function _0x4a39f9(_0x49d00c,_0x1beaea,_0x11e9ac){const _0x161207=_0x5a7792,_0x16f98f=document[_0x161207(0x124e)](_0x161207(0x479));_0x16f98f[_0x161207(0x87d)]=_0x161207(0x1267),_0x16f98f['dataset']['frameUrl']=_0x49d00c[_0x161207(0xe52)],_0x16f98f[_0x161207(0x1250)]=_0x49d00c['name'];const _0x365e25=typeof _0x49d00c['id']===_0x161207(0xef7),_0x262b03=_0x365e25?_0x161207(0xca0)+_0x49d00c['id']+_0x161207(0x42c):'';return _0x16f98f[_0x161207(0xc58)]=_0x161207(0xeb3)+_0x262b03+_0x161207(0x62d)+_0x11e9ac+_0x161207(0x15f)+(_0x49d00c[_0x161207(0xe52)]?_0x161207(0x86)+_0x49d00c[_0x161207(0xe52)]+_0x161207(0x1089):'')+_0x161207(0xf7e),_0x16f98f[_0x161207(0xf72)](_0x161207(0x1080),_0x251f76=>{const _0x2b1f81=_0x161207;if(_0x251f76['target'][_0x2b1f81(0x418)][_0x2b1f81(0xef6)](_0x2b1f81(0xb41)))return;if(_0x391510){if(_0x365e25){const _0x2be864=parseInt(_0x49d00c['id']);_0x16f98f[_0x2b1f81(0x418)][_0x2b1f81(0x5cf)](_0x2b1f81(0xbe6)),_0xd84f16[_0x2b1f81(0x2a6)](_0x2be864)?_0xd84f16['delete'](_0x2be864):_0xd84f16['add'](_0x2be864),_0x400475();}}else{_0x84d9ce[_0x1beaea]=_0x49d00c[_0x2b1f81(0xe52)];const _0x5e69ca=_0x1beaea==='ai'?document[_0x2b1f81(0x64f)](_0x2b1f81(0x831)):document[_0x2b1f81(0x64f)](_0x2b1f81(0xc8f));_0x5e69ca['querySelectorAll']('.frame-item')[_0x2b1f81(0x103)](_0x57ae3d=>_0x57ae3d[_0x2b1f81(0x418)]['remove'](_0x2b1f81(0xbe6))),_0x16f98f[_0x2b1f81(0x418)][_0x2b1f81(0xdda)]('selected');}}),_0x16f98f;}async function _0x350817(){const _0x63e6f6=_0x5a7792,_0x31aac2=document['getElementById'](_0x63e6f6(0xaf6)),_0x36a2c2=await new Promise(_0x13d53b=>{const _0x4393c4=_0x63e6f6,_0x4e299a=_0x1d64f1=>{const _0x6b594=_0x2bd6;_0x13d53b(_0x1d64f1[_0x6b594(0xf5b)]['files'][0x0]||null),_0x31aac2['removeEventListener'](_0x6b594(0x834),_0x4e299a);};_0x31aac2[_0x4393c4(0xf72)]('change',_0x4e299a,{'once':!![]}),_0x31aac2['click']();});if(!_0x36a2c2)return;const _0x5ca27b=await _0x41e3f8(_0x63e6f6(0x60d),_0x63e6f6(0x724));if(!_0x5ca27b||!_0x5ca27b[_0x63e6f6(0x43a)]())return;const _0x5c5323=await new Promise(_0x425ae8=>{const _0x291c9c=_0x63e6f6,_0x33952f=new FileReader();_0x33952f[_0x291c9c(0x139d)]=()=>_0x425ae8(_0x33952f['result']),_0x33952f['readAsDataURL'](_0x36a2c2);});await _0x4e1bbf[_0x63e6f6(0x297)][_0x63e6f6(0xdda)]({'name':_0x5ca27b[_0x63e6f6(0x43a)](),'url':_0x5c5323}),_0x1b9477(_0x21ae61);}async function _0x5b178d(){const _0x394a50=_0x5a7792,_0x4c3854=_0x394a50(0xad3),_0x38f9f3=await _0x41e3f8(_0x394a50(0x1329),_0x394a50(0xd32),'',_0x394a50(0x444),'<p\x20style=\x22font-size:12px;color:#888;\x22>'+_0x4c3854+_0x394a50(0x12de));if(!_0x38f9f3||!_0x38f9f3[_0x394a50(0x43a)]())return;const _0x235ecc=_0x38f9f3[_0x394a50(0x43a)]()['split']('\x0a'),_0x4df2dd=[];let _0x1ee081=0x0;for(const _0x596322 of _0x235ecc){const _0x327b68=_0x596322[_0x394a50(0x132a)](/^(.+?)[:：]\s*(https?:\/\/.+)$/);if(_0x327b68)_0x4df2dd[_0x394a50(0x13ee)]({'name':_0x327b68[0x1][_0x394a50(0x43a)](),'url':_0x327b68[0x2][_0x394a50(0x43a)]()});else _0x596322[_0x394a50(0x43a)]()&&_0x1ee081++;}_0x4df2dd[_0x394a50(0x40f)]>0x0&&(await _0x4e1bbf[_0x394a50(0x297)][_0x394a50(0x36f)](_0x4df2dd),_0x1b9477(_0x21ae61),await _0x28974b('导入成功',_0x394a50(0x51e)+_0x4df2dd[_0x394a50(0x40f)]+_0x394a50(0x1142))),_0x1ee081>0x0&&await _0x28974b(_0x394a50(0x5c7),'有\x20'+_0x1ee081+_0x394a50(0xb90));}async function _0x3c486f(_0x266b0e){const _0xa65f60=_0x5a7792,_0x403a2f=await _0x4e1bbf[_0xa65f60(0x297)][_0xa65f60(0x11fc)](_0x266b0e);if(!_0x403a2f)return;const _0x52668a=await _0x54149f(_0xa65f60(0x13d2),_0xa65f60(0xd10)+_0x403a2f['name']+'”\x20吗？',{'confirmButtonClass':_0xa65f60(0xeed)});_0x52668a&&(await _0x4e1bbf[_0xa65f60(0x297)]['delete'](_0x266b0e),_0x1b9477(_0x21ae61));}let _0x39cac0=0x0;const _0x544e4f=0x2;function _0x5a876e(){const _0x5df88b=_0x5a7792,_0x2034b6=document[_0x5df88b(0x64f)]('home-screen-pages-container'),_0x2a0b78=document['getElementById'](_0x5df88b(0x55c)),_0x356b5d=document['querySelectorAll']('.pagination-dot');let _0x3fac6e=0x0,_0x28ea70=0x0,_0x487403=0x0,_0x8f5fa2=![],_0x1c7757=!![];const _0x5cf5a3=()=>{const _0x45fcf2=_0x5df88b;_0x2a0b78[_0x45fcf2(0x731)][_0x45fcf2(0x70b)]=_0x45fcf2(0x817)+_0x39cac0*(0x64/_0x544e4f)+'%)',_0x356b5d[_0x45fcf2(0x103)]((_0x410b01,_0x2866f0)=>{const _0x5d0193=_0x45fcf2;_0x410b01[_0x5d0193(0x418)][_0x5d0193(0x5cf)](_0x5d0193(0x12ef),_0x2866f0===_0x39cac0);});},_0x40dc62=_0x1e1ecb=>{const _0x3cace8=_0x5df88b;_0x8f5fa2=!![],_0x1c7757=!![],_0x3fac6e=_0x1e1ecb[_0x3cace8(0xafc)][_0x3cace8(0xe53)](_0x3cace8(0xba))?_0x1e1ecb['pageX']:_0x1e1ecb['touches'][0x0][_0x3cace8(0xdb2)],_0x28ea70=_0x1e1ecb[_0x3cace8(0xafc)][_0x3cace8(0xe53)]('mouse')?_0x1e1ecb[_0x3cace8(0x1217)]:_0x1e1ecb[_0x3cace8(0x8ef)][0x0][_0x3cace8(0x1217)],_0x2a0b78[_0x3cace8(0x731)]['transition']='none';},_0x4c4939=_0x137191=>{const _0x190e63=_0x5df88b;if(!_0x8f5fa2)return;const _0x46ebef=_0x137191[_0x190e63(0xafc)][_0x190e63(0xe53)](_0x190e63(0xba))?_0x137191[_0x190e63(0x1217)]:_0x137191[_0x190e63(0x8ef)][0x0][_0x190e63(0x1217)];_0x487403=_0x137191[_0x190e63(0xafc)][_0x190e63(0xe53)](_0x190e63(0xba))?_0x137191[_0x190e63(0xdb2)]:_0x137191[_0x190e63(0x8ef)][0x0][_0x190e63(0xdb2)];const _0x1e060a=_0x487403-_0x3fac6e,_0x46dc9e=_0x46ebef-_0x28ea70;_0x1c7757&&(Math[_0x190e63(0x9cf)](_0x1e060a)>0xa||Math['abs'](_0x46dc9e)>0xa)&&(_0x1c7757=![]);if(Math[_0x190e63(0x9cf)](_0x1e060a)>Math[_0x190e63(0x9cf)](_0x46dc9e)){if(_0x137191['cancelable'])_0x137191[_0x190e63(0x8d1)]();_0x2a0b78[_0x190e63(0x731)]['transform']='translateX(calc(-'+_0x39cac0*(0x64/_0x544e4f)+'%\x20+\x20'+_0x1e060a+'px))';}},_0x1b3299=_0x4e5c3f=>{const _0x38c11c=_0x5df88b;if(!_0x8f5fa2)return;_0x8f5fa2=![],_0x2a0b78['style'][_0x38c11c(0xdc4)]='transform\x200.4s\x20cubic-bezier(0.4,\x200,\x200.2,\x201)';if(_0x1c7757){_0x5cf5a3();return;}const _0x5e4c65=_0x487403-_0x3fac6e;if(Math[_0x38c11c(0x9cf)](_0x5e4c65)>_0x2034b6[_0x38c11c(0x387)]/0x4){if(_0x5e4c65>0x0&&_0x39cac0>0x0)_0x39cac0--;else _0x5e4c65<0x0&&_0x39cac0<_0x544e4f-0x1&&_0x39cac0++;}_0x5cf5a3();};_0x2034b6[_0x5df88b(0xf72)](_0x5df88b(0x48d),_0x40dc62),_0x2034b6[_0x5df88b(0xf72)](_0x5df88b(0xa59),_0x4c4939),_0x2034b6[_0x5df88b(0xf72)](_0x5df88b(0x733),_0x1b3299),_0x2034b6[_0x5df88b(0xf72)](_0x5df88b(0xfa5),_0x1b3299),_0x2034b6['addEventListener']('touchstart',_0x40dc62,{'passive':![]}),_0x2034b6[_0x5df88b(0xf72)](_0x5df88b(0xe0d),_0x4c4939,{'passive':![]}),_0x2034b6['addEventListener'](_0x5df88b(0x6b2),_0x1b3299);}let _0x5c18e3=null;async function _0x3640c3(){await _0x1b0f29(),_0xddd8ae('preset-screen');}async function _0x1b0f29(){const _0x33bcc2=_0x5a7792,_0x4eba85=document['getElementById'](_0x33bcc2(0xe26)),_0x530573=document['getElementById'](_0x33bcc2(0x871));_0x4eba85[_0x33bcc2(0xc58)]='',_0x530573[_0x33bcc2(0xc58)]='';const [_0x272c2e,_0x1d4856]=await Promise[_0x33bcc2(0xfd7)]([_0x4e1bbf[_0x33bcc2(0x19c)]['toArray'](),_0x4e1bbf['presetCategories'][_0x33bcc2(0xe1d)](_0x33bcc2(0x6fc))[_0x33bcc2(0x78f)]()]);_0x3e7a1b['presets']=_0x272c2e;if(_0x272c2e[_0x33bcc2(0x40f)]===0x0){_0x530573[_0x33bcc2(0xc58)]=_0x33bcc2(0xdcf);return;}const _0x189766=document[_0x33bcc2(0x124e)](_0x33bcc2(0xcd));_0x189766[_0x33bcc2(0x87d)]=_0x33bcc2(0x941),_0x189766['textContent']='全部',_0x189766['dataset'][_0x33bcc2(0xcd3)]=_0x33bcc2(0xfd7),_0x4eba85[_0x33bcc2(0x99e)](_0x189766);const _0xe2d93e=document[_0x33bcc2(0x124e)]('div');_0xe2d93e[_0x33bcc2(0x87d)]=_0x33bcc2(0x138a),_0xe2d93e[_0x33bcc2(0x12e1)][_0x33bcc2(0xcd3)]='all',_0x530573[_0x33bcc2(0x99e)](_0xe2d93e),_0x1d4856['forEach'](_0x173bb1=>{const _0x111203=_0x33bcc2,_0x246327=document[_0x111203(0x124e)](_0x111203(0xcd));_0x246327['className']='world-book-tab',_0x246327[_0x111203(0xee5)]=_0x173bb1[_0x111203(0x6fc)],_0x246327['dataset'][_0x111203(0xcd3)]=String(_0x173bb1['id']),_0x4eba85[_0x111203(0x99e)](_0x246327);const _0x3d0936=document['createElement'](_0x111203(0x479));_0x3d0936[_0x111203(0x87d)]='world-book-category-pane',_0x3d0936[_0x111203(0x12e1)][_0x111203(0xcd3)]=String(_0x173bb1['id']),_0x530573[_0x111203(0x99e)](_0x3d0936);});const _0x40ece2=_0x272c2e[_0x33bcc2(0x26c)](_0x34e0b6=>!_0x34e0b6[_0x33bcc2(0xcd3)]);if(_0x40ece2){const _0x124996=document[_0x33bcc2(0x124e)]('button');_0x124996[_0x33bcc2(0x87d)]=_0x33bcc2(0xb89),_0x124996['textContent']=_0x33bcc2(0xaf0),_0x124996[_0x33bcc2(0x12e1)][_0x33bcc2(0xcd3)]=_0x33bcc2(0xf60),_0x4eba85[_0x33bcc2(0x99e)](_0x124996);const _0x20cc23=document['createElement'](_0x33bcc2(0x479));_0x20cc23['className']=_0x33bcc2(0xc2f),_0x20cc23[_0x33bcc2(0x12e1)][_0x33bcc2(0xcd3)]=_0x33bcc2(0xf60),_0x530573[_0x33bcc2(0x99e)](_0x20cc23);}_0x272c2e[_0x33bcc2(0x103)](_0x45e63e=>{const _0x1e4e52=_0x33bcc2,_0x57eeea=_0x1e4e52(0x67e)+_0x45e63e[_0x1e4e52(0x3ba)]['length']+_0x1e4e52(0xd02),_0x35078d=document[_0x1e4e52(0x124e)](_0x1e4e52(0x479));_0x35078d[_0x1e4e52(0x87d)]=_0x1e4e52(0x385),_0x35078d[_0x1e4e52(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-title\x22>'+_0x45e63e[_0x1e4e52(0x6fc)]+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22card-content-preview\x22>'+_0x57eeea+_0x1e4e52(0x9df);const _0x5ebcdb=()=>_0x268b3e(_0x45e63e['id']),_0x4a0920=async()=>{const _0x526b3f=_0x1e4e52,_0x4e36c9=await _0x54149f('删除预设','确定要删除《'+_0x45e63e[_0x526b3f(0x6fc)]+'》吗？',{'confirmButtonClass':_0x526b3f(0xeed)});_0x4e36c9&&(await _0x4e1bbf[_0x526b3f(0x19c)][_0x526b3f(0x3aa)](_0x45e63e['id']),_0x3e7a1b[_0x526b3f(0x19c)]=await _0x4e1bbf[_0x526b3f(0x19c)][_0x526b3f(0x78f)](),_0x1b0f29());};_0x35078d[_0x1e4e52(0xf72)](_0x1e4e52(0x1080),_0x5ebcdb),_0xb407a5(_0x35078d,_0x4a0920);const _0x12ea41=_0x35078d['cloneNode'](!![]);_0x12ea41[_0x1e4e52(0xf72)]('click',_0x5ebcdb),_0xb407a5(_0x12ea41,_0x4a0920),_0xe2d93e[_0x1e4e52(0x99e)](_0x12ea41);const _0x38e463=_0x45e63e['categoryId']?String(_0x45e63e['categoryId']):_0x1e4e52(0xf60),_0x23f062=_0x530573[_0x1e4e52(0x49c)](_0x1e4e52(0x226)+_0x38e463+'\x22]');_0x23f062&&_0x23f062[_0x1e4e52(0x99e)](_0x35078d);}),document[_0x33bcc2(0x233)]('#preset-tabs\x20.world-book-tab')[_0x33bcc2(0x103)](_0x7bf217=>{const _0x5494f7=_0x33bcc2;_0x7bf217[_0x5494f7(0xf72)](_0x5494f7(0x1080),()=>_0x30c278(_0x7bf217[_0x5494f7(0x12e1)]['categoryId']));});}function _0x30c278(_0x37a4e4){const _0x28a9d3=_0x5a7792;document[_0x28a9d3(0x233)]('#preset-tabs\x20.world-book-tab')[_0x28a9d3(0x103)](_0xb38187=>{const _0x1e4680=_0x28a9d3;_0xb38187['classList'][_0x1e4680(0x5cf)](_0x1e4680(0x12ef),_0xb38187[_0x1e4680(0x12e1)][_0x1e4680(0xcd3)]===_0x37a4e4);}),document[_0x28a9d3(0x233)](_0x28a9d3(0x93c))[_0x28a9d3(0x103)](_0x70f064=>{const _0x4e7c77=_0x28a9d3;_0x70f064[_0x4e7c77(0x418)][_0x4e7c77(0x5cf)](_0x4e7c77(0x12ef),_0x70f064[_0x4e7c77(0x12e1)]['categoryId']===_0x37a4e4);});}async function _0x268b3e(_0x16154a){const _0x34e5be=_0x5a7792;_0xddd8ae(_0x34e5be(0xf47)),_0x5c18e3=_0x16154a;try{const [_0xfa4a,_0x39a669]=await Promise[_0x34e5be(0xfd7)]([_0x4e1bbf[_0x34e5be(0x19c)][_0x34e5be(0x11fc)](_0x16154a),_0x4e1bbf[_0x34e5be(0xf22)][_0x34e5be(0x78f)]()]);if(!_0xfa4a){console['error']('错误：尝试打开一个不存在的预设，ID:',_0x16154a),await _0x28974b(_0x34e5be(0x196),'找不到这个预设的详细信息。'),_0xddd8ae(_0x34e5be(0x131));return;}setTimeout(()=>{const _0x48a92d=_0x34e5be;document[_0x48a92d(0x64f)](_0x48a92d(0xb49))[_0x48a92d(0xee5)]=_0xfa4a[_0x48a92d(0x6fc)],document[_0x48a92d(0x64f)]('preset-name-input')[_0x48a92d(0xbed)]=_0xfa4a[_0x48a92d(0x6fc)];const _0x524f12=document[_0x48a92d(0x64f)]('preset-category-select');_0x524f12[_0x48a92d(0xc58)]=_0x48a92d(0xab5),_0x39a669['forEach'](_0x5c48a6=>{const _0x3953a3=_0x48a92d,_0xcbef7c=document[_0x3953a3(0x124e)]('option');_0xcbef7c['value']=_0x5c48a6['id'],_0xcbef7c[_0x3953a3(0xee5)]=_0x5c48a6[_0x3953a3(0x6fc)];if(_0xfa4a[_0x3953a3(0xcd3)]===_0x5c48a6['id'])_0xcbef7c[_0x3953a3(0xbe6)]=!![];_0x524f12[_0x3953a3(0x99e)](_0xcbef7c);});const _0x207d55=document[_0x48a92d(0x64f)]('preset-entries-container');_0x207d55[_0x48a92d(0xc58)]='',Array[_0x48a92d(0x97e)](_0xfa4a['content'])&&_0xfa4a['content'][_0x48a92d(0x40f)]>0x0?_0xfa4a[_0x48a92d(0x3ba)]['forEach'](_0x555b4d=>{const _0x316469=_0x557bc5(_0x555b4d);_0x207d55['appendChild'](_0x316469);}):_0x207d55[_0x48a92d(0xc58)]='<p\x20style=\x22text-align:center;\x20color:\x20var(--text-secondary);\x20margin-top:\x2020px;\x22>还没有内容，点击下方按钮添加第一条吧！</p>';},0x32);}catch(_0x42fe98){console[_0x34e5be(0xc60)]('打开预设编辑器时发生严重错误:',_0x42fe98),await _0x28974b('加载失败','加载预设详情时发生错误:\x20'+_0x42fe98['message']),_0xddd8ae(_0x34e5be(0x131));}}function _0x557bc5(_0x7ebd16={'keys':[],'comment':'','content':'','enabled':!![]}){const _0x148db8=_0x5a7792,_0x17782b=document['createElement']('div');_0x17782b[_0x148db8(0x87d)]=_0x148db8(0x104a);const _0x2bf179=_0x7ebd16[_0x148db8(0x9b)]!==![]?'checked':'';_0x17782b['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20align-items:\x20center;\x20gap:\x2010px;\x20margin-bottom:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20class=\x22toggle-switch\x22\x20title=\x22启用/禁用此条目\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22entry-enabled-switch\x22\x20'+_0x2bf179+_0x148db8(0x12fa)+(_0x7ebd16[_0x148db8(0x652)]||'')+'\x22\x20placeholder=\x22例如：角色核心设定\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x22>关键词\x20(用英文逗号,分隔)</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20class=\x22entry-keys-input\x22\x20value=\x22'+(_0x7ebd16['keys']||[])[_0x148db8(0xd22)](',\x20')+'\x22\x20placeholder=\x22例如:\x20key1,\x20key2\x22\x20style=\x22padding:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20<!--\x20这里是全新的、带有“展开/收起”按钮的结构\x20-->\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22form-group\x22\x20style=\x22margin-bottom:\x200;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20style=\x22font-size:\x200.8em;\x20display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>内容\x20(点击右侧展开)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20type=\x22button\x22\x20class=\x22toggle-content-btn\x22>展开</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22entry-content-container\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20class=\x22entry-content-textarea\x22\x20rows=\x228\x22\x20style=\x22width:\x20100%;\x20font-size:\x2014px;\x22>'+(_0x7ebd16[_0x148db8(0x3ba)]||'')+_0x148db8(0x725),_0x17782b[_0x148db8(0x49c)](_0x148db8(0x7c3))[_0x148db8(0xf72)](_0x148db8(0x1080),()=>_0x17782b[_0x148db8(0x1275)]());const _0x493752=_0x17782b[_0x148db8(0x49c)](_0x148db8(0x4d0)),_0x51e9cf=_0x17782b[_0x148db8(0x49c)]('.entry-content-container');return _0x493752[_0x148db8(0xf72)](_0x148db8(0x1080),()=>{const _0x425976=_0x148db8,_0x44b079=_0x51e9cf['style'][_0x425976(0x130)]===_0x425976(0x1209);_0x51e9cf['style']['display']=_0x44b079?_0x425976(0xb37):'none',_0x493752[_0x425976(0xee5)]=_0x44b079?'收起':'展开';}),_0x17782b;}async function _0x28d0bc(){const _0xf0d54d=_0x5a7792;await _0x437816(),document[_0xf0d54d(0x49c)]('#group-management-modal\x20.modal-header\x20span')[_0xf0d54d(0xee5)]='管理预设分类',document['getElementById'](_0xf0d54d(0x13e9))['onclick']=_0x269827,document['getElementById'](_0xf0d54d(0x12a0))[_0xf0d54d(0x113a)]=_0x1b6487=>{const _0x3b7ba2=_0xf0d54d;_0x1b6487['target']['classList'][_0x3b7ba2(0xef6)]('delete-group-btn')&&_0x51dc05(parseInt(_0x1b6487['target'][_0x3b7ba2(0x12e1)]['id']));},document[_0xf0d54d(0x64f)](_0xf0d54d(0x93d))[_0xf0d54d(0x113a)]=()=>{const _0x369547=_0xf0d54d;document[_0x369547(0x64f)](_0x369547(0x6e5))['classList']['remove'](_0x369547(0x40a)),_0x1b0f29();},document['getElementById']('group-management-modal')[_0xf0d54d(0x418)][_0xf0d54d(0xdda)]('visible');}async function _0x437816(){const _0x5dfafd=_0x5a7792,_0x4ec2ea=document[_0x5dfafd(0x64f)]('existing-groups-list'),_0x2f3d87=await _0x4e1bbf[_0x5dfafd(0xf22)][_0x5dfafd(0x78f)]();_0x4ec2ea['innerHTML']='',_0x2f3d87[_0x5dfafd(0x40f)]===0x0&&(_0x4ec2ea[_0x5dfafd(0xc58)]=_0x5dfafd(0x820)),_0x2f3d87[_0x5dfafd(0x103)](_0xc3d65f=>{const _0x412879=_0x5dfafd,_0x2b3f18=document[_0x412879(0x124e)](_0x412879(0x479));_0x2b3f18[_0x412879(0x87d)]=_0x412879(0x6c3),_0x2b3f18['innerHTML']=_0x412879(0x34d)+_0xc3d65f[_0x412879(0x6fc)]+_0x412879(0x1266)+_0xc3d65f['id']+_0x412879(0x705),_0x4ec2ea[_0x412879(0x99e)](_0x2b3f18);});}async function _0x269827(){const _0x348e4f=_0x5a7792,_0x30b59b=document['getElementById'](_0x348e4f(0x9fa)),_0x5e144b=_0x30b59b[_0x348e4f(0xbed)][_0x348e4f(0x43a)]();if(!_0x5e144b)return alert(_0x348e4f(0x1b9));const _0x182d96=await _0x4e1bbf[_0x348e4f(0xf22)][_0x348e4f(0xec9)](_0x348e4f(0x6fc))['equals'](_0x5e144b)['first']();if(_0x182d96)return alert(_0x348e4f(0x1095)+_0x5e144b+_0x348e4f(0xc4e));await _0x4e1bbf['presetCategories'][_0x348e4f(0xdda)]({'name':_0x5e144b}),_0x30b59b[_0x348e4f(0xbed)]='',await _0x437816();}async function _0x51dc05(_0x369393){const _0x49c43d=_0x5a7792,_0x57306f=await _0x54149f(_0x49c43d(0x13d2),_0x49c43d(0xfd2),{'confirmButtonClass':'btn-danger'});_0x57306f&&(await _0x4e1bbf[_0x49c43d(0xf22)]['delete'](_0x369393),await _0x4e1bbf[_0x49c43d(0x19c)][_0x49c43d(0xec9)](_0x49c43d(0xcd3))['equals'](_0x369393)[_0x49c43d(0x140)]({'categoryId':null}),_0x3e7a1b[_0x49c43d(0x19c)]=await _0x4e1bbf[_0x49c43d(0x19c)]['toArray'](),await _0x437816());}async function _0x1ef119(_0x376327){const _0x3bb981=_0x5a7792,_0x6e34ac=_0x376327[_0x3bb981(0xf5b)]['files'][0x0];if(!_0x6e34ac)return;try{if(!_0x6e34ac[_0x3bb981(0x6fc)][_0x3bb981(0x720)](_0x3bb981(0xec)))throw new Error(_0x3bb981(0x889));const _0x38e214=await _0x6e34ac[_0x3bb981(0x673)](),_0x57803a=JSON['parse'](_0x38e214);await _0x10c1b9(_0x57803a,_0x6e34ac[_0x3bb981(0x6fc)]);}catch(_0xf20a57){console[_0x3bb981(0xc60)](_0x3bb981(0x8ad),_0xf20a57),await _0x28974b(_0x3bb981(0xae3),_0x3bb981(0x47e)+_0xf20a57[_0x3bb981(0x854)]);}finally{_0x376327[_0x3bb981(0xf5b)][_0x3bb981(0xbed)]=null;}}async function _0x10c1b9(_0x4362c0,_0x197bde){const _0xd758d0=_0x5a7792;let _0x1dee36=[];if(Array['isArray'](_0x4362c0[_0xd758d0(0x1206)])&&Array['isArray'](_0x4362c0[_0xd758d0(0x12e3)])&&_0x4362c0[_0xd758d0(0x12e3)][_0xd758d0(0x40f)]>0x0){console[_0xd758d0(0x1081)]('检测到\x20Tavern/SillyTavern\x20预设格式，将严格按照\x20prompt_order\x20排序。');const _0x44ed3e=new Map(_0x4362c0['prompts'][_0xd758d0(0xb96)](_0x5a095e=>[_0x5a095e['identifier'],_0x5a095e])),_0x19741b=_0x4362c0[_0xd758d0(0x12e3)][_0xd758d0(0x213)]((_0x27a1d7,_0x1fb702)=>_0x1fb702[_0xd758d0(0xf49)]&&_0x1fb702[_0xd758d0(0xf49)][_0xd758d0(0x40f)]>(_0x27a1d7['length']||0x0)?_0x1fb702['order']:_0x27a1d7,[]);_0x19741b&&_0x19741b[_0xd758d0(0x40f)]>0x0&&(_0x1dee36=_0x19741b['map'](_0x2222c7=>{const _0x1a9d8c=_0xd758d0,_0x510cba=_0x44ed3e[_0x1a9d8c(0x11fc)](_0x2222c7[_0x1a9d8c(0x256)]);if(_0x510cba)return{'keys':[],'comment':_0x510cba['name']||_0x1a9d8c(0x533),'content':_0x510cba[_0x1a9d8c(0x3ba)]||'','enabled':_0x2222c7[_0x1a9d8c(0x9b)]};return null;})[_0xd758d0(0x156)](Boolean));}else{if(_0x4362c0['entries']&&typeof _0x4362c0[_0xd758d0(0x1052)]===_0xd758d0(0x59a))console[_0xd758d0(0x1081)](_0xd758d0(0xe82)),Array[_0xd758d0(0x97e)](_0x4362c0[_0xd758d0(0xf49)])?(console[_0xd758d0(0x1081)](_0xd758d0(0x803)),_0x1dee36=_0x4362c0[_0xd758d0(0xf49)][_0xd758d0(0xb96)](_0x2bdf96=>_0x4362c0[_0xd758d0(0x1052)][_0x2bdf96])[_0xd758d0(0x156)](Boolean)['map'](_0x45e7ce=>({'keys':_0x45e7ce[_0xd758d0(0xf2f)]||[],'comment':_0x45e7ce[_0xd758d0(0x652)]||'无备注','content':_0x45e7ce['content']||'','enabled':!_0x45e7ce['disable']}))):(console[_0xd758d0(0x1155)](_0xd758d0(0x610)),_0x1dee36=Object[_0xd758d0(0xd6d)](_0x4362c0[_0xd758d0(0x1052)])[_0xd758d0(0xb96)](_0xdfc7c5=>({'keys':_0xdfc7c5[_0xd758d0(0xf2f)]||[],'comment':_0xdfc7c5['comment']||'无备注','content':_0xdfc7c5[_0xd758d0(0x3ba)]||'','enabled':!_0xdfc7c5[_0xd758d0(0x1c9)]})));else{if(Array[_0xd758d0(0x97e)](_0x4362c0[_0xd758d0(0x1206)]))console[_0xd758d0(0x1081)](_0xd758d0(0xb5)),_0x1dee36=_0x4362c0[_0xd758d0(0x1206)][_0xd758d0(0xb96)](_0x35beaf=>({'keys':[],'comment':_0x35beaf[_0xd758d0(0x6fc)]||_0xd758d0(0x533),'content':_0x35beaf[_0xd758d0(0x3ba)]||'','enabled':!![]}));else throw new Error(_0xd758d0(0x1162));}}_0x1dee36=_0x1dee36[_0xd758d0(0x156)](_0x2af380=>_0x2af380[_0xd758d0(0x3ba)]);if(_0x1dee36['length']===0x0){alert(_0xd758d0(0x11c1));return;}const _0xf1882b=_0x197bde['replace'](/\.json$/i,''),_0x17287c=await _0x41e3f8(_0xd758d0(0x8eb),_0xd758d0(0x8bf),_0xf1882b);if(!_0x17287c||!_0x17287c[_0xd758d0(0x43a)]()){alert('导入已取消，因为未提供名称。');return;}const _0x57f7e7={'id':'preset_'+Date[_0xd758d0(0x2b5)](),'name':_0x17287c[_0xd758d0(0x43a)](),'content':_0x1dee36,'categoryId':null};await _0x4e1bbf['presets'][_0xd758d0(0xdda)](_0x57f7e7),_0x3e7a1b[_0xd758d0(0x19c)][_0xd758d0(0x13ee)](_0x57f7e7),await _0x1b0f29(),await _0x28974b(_0xd758d0(0x5f2),_0xd758d0(0x786)+_0x17287c+'》。');}async function _0x41308c(_0x311a4a){const _0x5f276c=_0x5a7792,_0xe59242=document[_0x5f276c(0x64f)](_0x5f276c(0xee8));if(!_0xe59242)return;const _0x525505=_0x3e7a1b[_0x5f276c(0x19c)]||[];_0xe59242[_0x5f276c(0xc58)]='<option\x20value=\x22\x22>--\x20不使用预设\x20--</option>',_0x525505['forEach'](_0x45614c=>{const _0x2e2c0f=_0x5f276c,_0x17e197=document[_0x2e2c0f(0x124e)](_0x2e2c0f(0x1176));_0x17e197[_0x2e2c0f(0xbed)]=_0x45614c['id'],_0x17e197[_0x2e2c0f(0xee5)]=_0x45614c[_0x2e2c0f(0x6fc)],_0xe59242[_0x2e2c0f(0x99e)](_0x17e197);}),_0x311a4a[_0x5f276c(0xcb3)]['offlinePresetId']&&(_0xe59242['value']=_0x311a4a[_0x5f276c(0xcb3)][_0x5f276c(0x243)]);}function _0x2ad447(){const _0x2eafe3=_0x5a7792,_0xcb3b41=document['getElementById'](_0x2eafe3(0x591));if(!_0xcb3b41)return;_0xcb3b41[_0x2eafe3(0xc58)]='';let _0xbea0ae=_0x3e7a1b[_0x2eafe3(0x11b4)][_0x2eafe3(0x502)]||_0x170180;_0xbea0ae['forEach'](_0x5a171e=>{const _0x2d3d9b=_0x2eafe3,_0x4f661d=document[_0x2d3d9b(0x64f)](_0x5a171e);if(_0x4f661d){const _0x1f37a2=document[_0x2d3d9b(0x124e)](_0x2d3d9b(0x479));_0x1f37a2[_0x2d3d9b(0x87d)]='draggable-button-item',_0x1f37a2[_0x2d3d9b(0xf3a)]=!![],_0x1f37a2[_0x2d3d9b(0x12e1)][_0x2d3d9b(0x10ae)]=_0x5a171e,_0x1f37a2[_0x2d3d9b(0xc58)]=_0x4f661d['innerHTML'],_0xcb3b41[_0x2d3d9b(0x99e)](_0x1f37a2);}});}function _0x2b6172(){const _0x373742=_0x5a7792,_0x303999=document['getElementById'](_0x373742(0x591));if(!_0x303999)return;let _0x5822c6=null;const _0x3fdb8e=_0x49a9db=>{const _0xeafc1a=_0x373742,_0xa8837c=_0x49a9db[_0xeafc1a(0xf5b)][_0xeafc1a(0x2fc)](_0xeafc1a(0xc64));if(!_0xa8837c)return;_0x5822c6=_0xa8837c,_0x5822c6[_0xeafc1a(0x418)]['add'](_0xeafc1a(0xd13));if(_0x49a9db[_0xeafc1a(0x81e)])_0x49a9db[_0xeafc1a(0x8d1)]();},_0x228456=_0x279d5f=>{const _0x34e486=_0x373742;if(!_0x5822c6)return;const _0x3c57ea=_0x279d5f[_0x34e486(0xafc)][_0x34e486(0xe53)](_0x34e486(0xba))?_0x279d5f[_0x34e486(0x663)]:_0x279d5f['touches'][0x0][_0x34e486(0x663)],_0x2e0370=_0x52c44e(_0x303999,_0x3c57ea);_0x2e0370==null?_0x303999[_0x34e486(0x99e)](_0x5822c6):_0x303999[_0x34e486(0xf4a)](_0x5822c6,_0x2e0370);},_0x2ceb02=()=>{const _0x339d3b=_0x373742;if(!_0x5822c6)return;_0x5822c6['classList']['remove'](_0x339d3b(0xd13)),_0x5822c6=null,_0x1fe9ee();};_0x303999[_0x373742(0xf72)](_0x373742(0x48d),_0x3fdb8e),_0x303999[_0x373742(0xf72)](_0x373742(0x467),_0x3fdb8e,{'passive':![]}),_0x303999[_0x373742(0xf72)](_0x373742(0xa59),_0x228456),_0x303999['addEventListener']('touchmove',_0x228456,{'passive':![]}),_0x303999['addEventListener']('mouseup',_0x2ceb02),_0x303999['addEventListener'](_0x373742(0xfa5),_0x2ceb02),_0x303999['addEventListener'](_0x373742(0x6b2),_0x2ceb02);}function _0x52c44e(_0xfe0f24,_0x24a299){const _0x4466a2=_0x5a7792,_0x5e728d=[..._0xfe0f24[_0x4466a2(0x233)]('.draggable-button-item:not(.dragging)')];return _0x5e728d[_0x4466a2(0x213)]((_0x462583,_0xff6ae4)=>{const _0x16e6a9=_0x4466a2,_0x1c1ce9=_0xff6ae4['getBoundingClientRect'](),_0x209fc7=_0x24a299-_0x1c1ce9[_0x16e6a9(0xbbf)]-_0x1c1ce9['width']/0x2;return _0x209fc7<0x0&&_0x209fc7>_0x462583['offset']?{'offset':_0x209fc7,'element':_0xff6ae4}:_0x462583;},{'offset':Number[_0x4466a2(0x938)]})[_0x4466a2(0xe87)];}async function _0x1fe9ee(){const _0x38a258=_0x5a7792,_0x54fe7f=document['getElementById'](_0x38a258(0x591)),_0x5306b9=Array[_0x38a258(0xb3a)](_0x54fe7f[_0x38a258(0x233)](_0x38a258(0xc64)))[_0x38a258(0xb96)](_0x45c457=>_0x45c457[_0x38a258(0x12e1)][_0x38a258(0x10ae)]);_0x3e7a1b[_0x38a258(0x11b4)][_0x38a258(0x502)]=_0x5306b9,await _0x4e1bbf['globalSettings'][_0x38a258(0x4fa)](_0x3e7a1b[_0x38a258(0x11b4)]);}function _0x19109f(){const _0x2c8871=_0x5a7792,_0x14201e=_0x3e7a1b[_0x2c8871(0x11b4)][_0x2c8871(0x502)];if(!_0x14201e||!Array[_0x2c8871(0x97e)](_0x14201e)||_0x14201e['length']===0x0)return;const _0x16436a=document[_0x2c8871(0x64f)](_0x2c8871(0x11d9));if(!_0x16436a)return;_0x14201e[_0x2c8871(0x103)](_0x385b32=>{const _0x4afab3=_0x2c8871,_0x3699ef=document[_0x4afab3(0x64f)](_0x385b32);_0x3699ef&&_0x16436a[_0x4afab3(0x99e)](_0x3699ef);});}const _0x170180=[_0x5a7792(0x8aa),_0x5a7792(0x376),_0x5a7792(0xb54),_0x5a7792(0x1070),_0x5a7792(0xdeb),_0x5a7792(0x3eb),_0x5a7792(0x1015),'group-video-call-btn',_0x5a7792(0x1181),_0x5a7792(0xee0),'share-location-btn','gomoku-btn',_0x5a7792(0x130c),_0x5a7792(0x118c),_0x5a7792(0x41b),_0x5a7792(0xd21),_0x5a7792(0xaca),'show-announcement-board-btn',_0x5a7792(0x1215),'read-together-btn',_0x5a7792(0x934)];async function _0x12c8cf(){const _0x1c261f=_0x5a7792;_0x3e7a1b[_0x1c261f(0x11b4)][_0x1c261f(0x502)]=null,await _0x4e1bbf[_0x1c261f(0x11b4)][_0x1c261f(0x4fa)](_0x3e7a1b[_0x1c261f(0x11b4)]),_0x2ad447(),_0x19109f(),await _0x28974b('成功',_0x1c261f(0x373));}let _0x29bd9d=[],_0x3238af=[];function _0x513936(){const _0x17c62e=_0x5a7792,_0x138dfa=document['getElementById'](_0x17c62e(0xdec));_0x29bd9d=[],_0x3238af=[],_0x176d40(),document['getElementById'](_0x17c62e(0x11c))[_0x17c62e(0x731)]['display']='flex',document[_0x17c62e(0x64f)]('data-clear-step-2')['style'][_0x17c62e(0x130)]='none',_0x138dfa[_0x17c62e(0x418)][_0x17c62e(0xdda)](_0x17c62e(0x40a));}function _0x176d40(){const _0x4cfbab=_0x5a7792,_0x4aae09=document[_0x4cfbab(0x64f)]('data-clear-char-list');_0x4aae09['innerHTML']='';const _0x67623=document['createElement'](_0x4cfbab(0x479));_0x67623['className']='clear-posts-item',_0x67623[_0x4cfbab(0x12e1)][_0x4cfbab(0xe40)]=_0x4cfbab(0xa4d),_0x67623['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22checkbox\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+(_0x3e7a1b[_0x4cfbab(0x3c2)]['nickname']||'我')+_0x4cfbab(0xcc7),_0x4aae09['appendChild'](_0x67623),Object[_0x4cfbab(0xd6d)](_0x3e7a1b['chats'])[_0x4cfbab(0x103)](_0x824554=>{const _0xd5ca07=_0x4cfbab;if(!_0x824554[_0xd5ca07(0x1167)]){const _0x295656=document['createElement'](_0xd5ca07(0x479));_0x295656[_0xd5ca07(0x87d)]=_0xd5ca07(0xf65),_0x295656['dataset'][_0xd5ca07(0xe40)]=_0x824554['id'],_0x295656[_0xd5ca07(0xc58)]=_0xd5ca07(0xda5)+_0x824554[_0xd5ca07(0x6fc)]+_0xd5ca07(0x8c8),_0x4aae09[_0xd5ca07(0x99e)](_0x295656);}});}function _0x1485b7(){const _0x17983a=_0x5a7792,_0x1d64b2=document[_0x17983a(0x64f)](_0x17983a(0x972));_0x1d64b2['innerHTML']='';const _0x17fd24=[{'id':'chat','name':_0x17983a(0xf06),'description':'将清空选定角色的所有对话消息、曾用备注和你的昵称。'},{'id':_0x17983a(0x1220),'name':_0x17983a(0x592),'description':_0x17983a(0x4db)},{'id':'calls','name':_0x17983a(0xb84),'description':_0x17983a(0x7d4)},{'id':_0x17983a(0x10d6),'name':'心声','description':_0x17983a(0xc13)},{'id':_0x17983a(0x1125),'name':_0x17983a(0xa17),'description':_0x17983a(0x77b)},{'id':_0x17983a(0x1232),'name':'收藏','description':_0x17983a(0xed0)},{'id':_0x17983a(0x658),'name':_0x17983a(0x41c),'description':'将清空角色的相册、QQ、浏览器、淘宝、日记、备忘录等所有模拟手机数据。'}];_0x17fd24['forEach'](_0x38f1be=>{const _0x28ac51=_0x17983a,_0x19dc53=document[_0x28ac51(0x124e)](_0x28ac51(0x479));_0x19dc53['className']=_0x28ac51(0xf65),_0x19dc53[_0x28ac51(0x12e1)][_0x28ac51(0x1b7)]=_0x38f1be['id'],_0x19dc53[_0x28ac51(0xc58)]=_0x28ac51(0x5e0)+_0x38f1be[_0x28ac51(0x6fc)]+_0x28ac51(0x983)+_0x38f1be[_0x28ac51(0x9af)]+'</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20',_0x1d64b2['appendChild'](_0x19dc53);});}function _0x3a5e7a(){const _0x3d424e=_0x5a7792,_0x12ec76=document[_0x3d424e(0x233)](_0x3d424e(0x1252));if(_0x12ec76[_0x3d424e(0x40f)]===0x0){alert(_0x3d424e(0x5d3));return;}_0x29bd9d=Array[_0x3d424e(0xb3a)](_0x12ec76)[_0x3d424e(0xb96)](_0x512a8a=>_0x512a8a[_0x3d424e(0x12e1)][_0x3d424e(0xe40)]),_0x1485b7(),document[_0x3d424e(0x64f)](_0x3d424e(0x11c))[_0x3d424e(0x731)]['display']=_0x3d424e(0x1209),document[_0x3d424e(0x64f)]('data-clear-step-2')['style'][_0x3d424e(0x130)]=_0x3d424e(0x1026);}function _0x421fa5(){const _0x435d45=_0x5a7792;document['getElementById'](_0x435d45(0x21e))[_0x435d45(0x731)][_0x435d45(0x130)]=_0x435d45(0x1209),document[_0x435d45(0x64f)]('data-clear-step-1')[_0x435d45(0x731)]['display']=_0x435d45(0x1026),document[_0x435d45(0x233)](_0x435d45(0xf5f))['forEach'](_0x1b0592=>{const _0x20cf83=_0x435d45;_0x29bd9d[_0x20cf83(0xe53)](_0x1b0592['dataset'][_0x20cf83(0xe40)])&&_0x1b0592['classList']['add'](_0x20cf83(0xbe6));});}async function _0x4a8ed1(){const _0x3dfb29=_0x5a7792,_0x85291b=document['querySelectorAll'](_0x3dfb29(0x137c));if(_0x85291b[_0x3dfb29(0x40f)]===0x0){alert(_0x3dfb29(0x97a));return;}_0x3238af=Array[_0x3dfb29(0xb3a)](_0x85291b)['map'](_0x1fde5c=>_0x1fde5c[_0x3dfb29(0x12e1)][_0x3dfb29(0x1b7)]);const _0x148149=await _0x54149f('最后确认！',_0x3dfb29(0xa7c),{'confirmButtonClass':_0x3dfb29(0xeed),'confirmText':_0x3dfb29(0x13d2)});if(!_0x148149)return;await _0x28974b(_0x3dfb29(0x2f7),_0x3dfb29(0x8dc));try{await _0x4e1bbf[_0x3dfb29(0x62a)]('rw',_0x4e1bbf[_0x3dfb29(0x1a2)],async()=>{const _0x561cf4=_0x3dfb29;for(const _0x141ba0 of _0x29bd9d){for(const _0x5b028d of _0x3238af){if(_0x5b028d===_0x561cf4(0xc09)){if(_0x141ba0===_0x561cf4(0xa4d)){const _0x4cf8b8=await _0x4e1bbf[_0x561cf4(0x999)][_0x561cf4(0x78f)]();for(const _0x44e778 of _0x4cf8b8){_0x44e778[_0x561cf4(0x830)]=_0x44e778[_0x561cf4(0x830)][_0x561cf4(0x156)](_0x4c5107=>_0x4c5107['role']!=='user'),await _0x4e1bbf[_0x561cf4(0x999)][_0x561cf4(0x4fa)](_0x44e778);}}else{const _0x76232d=await _0x4e1bbf[_0x561cf4(0x999)]['get'](_0x141ba0);_0x76232d&&(_0x76232d['history']=[],_0x76232d[_0x561cf4(0x12d9)]=_0x561cf4(0x3cd),_0x76232d[_0x561cf4(0xb9d)]='...',Array['isArray'](_0x76232d[_0x561cf4(0x19e)])&&(_0x76232d[_0x561cf4(0x19e)]=[]),_0x76232d[_0x561cf4(0xcb3)]&&(_0x76232d['settings'][_0x561cf4(0x96f)]='我'),await _0x4e1bbf['chats'][_0x561cf4(0x4fa)](_0x76232d));}}if(_0x5b028d===_0x561cf4(0x1220)){const _0x58118a=_0x141ba0===_0x561cf4(0xa4d)?_0x561cf4(0xa4d):_0x141ba0;await _0x4e1bbf[_0x561cf4(0xaf9)]['where'](_0x561cf4(0x1188))['equals'](_0x58118a)[_0x561cf4(0x3aa)]();}_0x5b028d===_0x561cf4(0x239)&&_0x141ba0!==_0x561cf4(0xa4d)&&await _0x4e1bbf['callRecords'][_0x561cf4(0xec9)](_0x561cf4(0x367))[_0x561cf4(0x11cd)](_0x141ba0)[_0x561cf4(0x3aa)]();if(_0x5b028d===_0x561cf4(0x10d6)&&_0x141ba0!==_0x561cf4(0xa4d)){const _0x5570be=await _0x4e1bbf[_0x561cf4(0x999)]['get'](_0x141ba0);_0x5570be&&(_0x5570be['thoughtsHistory']=[],_0x5570be[_0x561cf4(0x12d9)]=_0x561cf4(0x3cd),_0x5570be[_0x561cf4(0xb9d)]=_0x561cf4(0x3cd),await _0x4e1bbf[_0x561cf4(0x999)][_0x561cf4(0x4fa)](_0x5570be));}if(_0x5b028d===_0x561cf4(0x1125)&&_0x141ba0!==_0x561cf4(0xa4d)){const _0x4ab244=await _0x4e1bbf[_0x561cf4(0x999)]['get'](_0x141ba0);_0x4ab244&&(_0x4ab244['longTermMemory']=[],await _0x4e1bbf[_0x561cf4(0x999)][_0x561cf4(0x4fa)](_0x4ab244));}_0x5b028d===_0x561cf4(0x1232)&&(_0x141ba0==='user'?(await _0x4e1bbf[_0x561cf4(0x1232)][_0x561cf4(0xec9)]('type')['equals']('qzone_post')[_0x561cf4(0x156)](_0x482212=>_0x482212['content'][_0x561cf4(0x1188)]===_0x561cf4(0xa4d))[_0x561cf4(0x3aa)](),await _0x4e1bbf['favorites'][_0x561cf4(0xec9)](_0x561cf4(0xafc))[_0x561cf4(0x11cd)](_0x561cf4(0x102b))[_0x561cf4(0x156)](_0x40e67b=>_0x40e67b[_0x561cf4(0x3ba)]['role']===_0x561cf4(0xa4d))[_0x561cf4(0x3aa)]()):(await _0x4e1bbf[_0x561cf4(0x1232)][_0x561cf4(0xec9)](_0x561cf4(0xafc))[_0x561cf4(0x11cd)]('chat_message')['and'](_0x382f0b=>_0x382f0b['chatId']===_0x141ba0)[_0x561cf4(0x3aa)](),await _0x4e1bbf[_0x561cf4(0x1232)][_0x561cf4(0xec9)]('type')[_0x561cf4(0x11cd)]('qzone_post')['filter'](_0x1694cc=>_0x1694cc[_0x561cf4(0x3ba)][_0x561cf4(0x1188)]===_0x141ba0)[_0x561cf4(0x3aa)](),await _0x4e1bbf[_0x561cf4(0x1232)][_0x561cf4(0xec9)](_0x561cf4(0xafc))['equals']('char_diary')[_0x561cf4(0x156)](_0x3a3046=>_0x3a3046['content'][_0x561cf4(0x3df)]===_0x141ba0)['delete'](),await _0x4e1bbf[_0x561cf4(0x1232)][_0x561cf4(0xec9)](_0x561cf4(0xafc))[_0x561cf4(0x11cd)]('char_browser_article')[_0x561cf4(0x156)](_0x433ef0=>_0x433ef0['content'][_0x561cf4(0x3df)]===_0x141ba0)[_0x561cf4(0x3aa)](),await _0x4e1bbf[_0x561cf4(0x1232)][_0x561cf4(0xec9)](_0x561cf4(0xafc))[_0x561cf4(0x11cd)]('char_memo')[_0x561cf4(0x156)](_0x48d42f=>_0x48d42f[_0x561cf4(0x3ba)]['characterId']===_0x141ba0)['delete']()));if(_0x5b028d===_0x561cf4(0x658)&&_0x141ba0!==_0x561cf4(0xa4d)){const _0x58a4e3=await _0x4e1bbf[_0x561cf4(0x999)][_0x561cf4(0x11fc)](_0x141ba0);_0x58a4e3&&(_0x58a4e3[_0x561cf4(0xbd1)]=[],_0x58a4e3[_0x561cf4(0xd17)]=[],_0x58a4e3['simulatedBrowserHistory']=[],_0x58a4e3[_0x561cf4(0x1ec)]=null,_0x58a4e3['simulatedAmapHistory']=[],_0x58a4e3[_0x561cf4(0x699)]=[],_0x58a4e3[_0x561cf4(0x1273)]=[],_0x58a4e3['diary']=[],_0x58a4e3[_0x561cf4(0x5b6)]=[],await _0x4e1bbf[_0x561cf4(0x999)]['put'](_0x58a4e3));}}}}),await _0x519e87(),await _0x21f6ea(),document[_0x3dfb29(0x64f)](_0x3dfb29(0xdec))['classList'][_0x3dfb29(0x1275)]('visible'),await _0x28974b(_0x3dfb29(0x111),_0x3dfb29(0xbe0));}catch(_0xc6f057){console['error'](_0x3dfb29(0x1a1),_0xc6f057),await _0x28974b(_0x3dfb29(0xa27),'操作失败:\x20'+_0xc6f057[_0x3dfb29(0x854)]);}}async function _0x18388a(_0x52364d,_0x4fe89d,_0x4b8476){const _0x5ee7cb=_0x5a7792,_0x2b7a59=_0x4b8476['querySelector'](_0x5ee7cb(0x8e9))[_0x5ee7cb(0x7e2)],_0x126f49=await _0x217169(_0x5ee7cb(0x1397)+_0x2b7a59+_0x5ee7cb(0xa41),[{'text':'📁\x20从本地上传','value':_0x5ee7cb(0x2a2)},{'text':_0x5ee7cb(0xe00),'value':_0x5ee7cb(0xe52)}]);let _0x2fdabb=null;if(_0x126f49===_0x5ee7cb(0x2a2))_0x2fdabb=await _0x44b2ac();else{if(_0x126f49==='url'){const _0x165b60=_0x4fe89d==='cphone'?_0x3e7a1b['globalSettings'][_0x5ee7cb(0x328)][_0x52364d]:_0x3e7a1b[_0x5ee7cb(0x11b4)][_0x5ee7cb(0xdaa)][_0x52364d],_0x1c07e3=_0x165b60[_0x5ee7cb(0x7d)](_0x5ee7cb(0xbb0)),_0x113ed8=_0x1c07e3?'':_0x165b60;_0x2fdabb=await _0x41e3f8('更换图标',_0x5ee7cb(0xed2),_0x113ed8,_0x5ee7cb(0xe52));}}if(_0x2fdabb&&_0x2fdabb['trim']()){const _0x5b5699=_0x2fdabb[_0x5ee7cb(0x43a)]();_0x4fe89d===_0x5ee7cb(0x658)?_0x3e7a1b['globalSettings'][_0x5ee7cb(0x328)][_0x52364d]=_0x5b5699:_0x3e7a1b['globalSettings'][_0x5ee7cb(0xdaa)][_0x52364d]=_0x5b5699,_0x4b8476[_0x5ee7cb(0x49c)](_0x5ee7cb(0x8e9))[_0x5ee7cb(0xbe8)]=_0x5b5699;}else _0x2fdabb!==null&&alert(_0x5ee7cb(0x1239));}async function _0xa3284(){const _0x3131eb=_0x5a7792,_0x31482a=await _0x54149f('确认压缩图片？',_0x3131eb(0xa1d),{'confirmButtonClass':_0x3131eb(0xeed),'confirmText':_0x3131eb(0x4f5)});if(!_0x31482a)return;await _0x28974b(_0x3131eb(0x2f7),_0x3131eb(0x903));let _0x58860f={'found':0x0,'compressed':0x0,'skipped':0x0,'originalSize':0x0,'newSize':0x0};try{console[_0x3131eb(0x1081)](_0x3131eb(0xca6));const _0x26eeba=[_0x3131eb(0x999),_0x3131eb(0x11b4),_0x3131eb(0x3c2),'userStickers',_0x3131eb(0x297)],_0x5114fe=[];for(const _0x674c23 of _0x26eeba){const _0x37e0cb=_0x4e1bbf[_0x3131eb(0x13ac)](_0x674c23),_0x938963=await _0x37e0cb['toArray']();_0x5114fe[_0x3131eb(0x13ee)]({'tableName':_0x674c23,'records':_0x938963});}console[_0x3131eb(0x1081)](_0x3131eb(0x4f3));for(const _0x244fc6 of _0x5114fe){for(const _0x2aa27a of _0x244fc6[_0x3131eb(0x12bb)]){await _0x2da5ad(_0x2aa27a,_0x58860f);}}console[_0x3131eb(0x1081)]('压缩步骤\x203/3:\x20正在将压缩后的数据写回数据库...'),await _0x4e1bbf[_0x3131eb(0x62a)]('rw',_0x26eeba,async()=>{const _0x2e7b02=_0x3131eb;for(const _0xd3694a of _0x5114fe){await _0x4e1bbf[_0x2e7b02(0x13ac)](_0xd3694a[_0x2e7b02(0x13a8)])[_0x2e7b02(0x1281)](_0xd3694a[_0x2e7b02(0x12bb)]);}});const _0x31e69c=_0x58860f[_0x3131eb(0xb16)]-_0x58860f['newSize'],_0x4bb4fa=_0x58860f[_0x3131eb(0xb16)]>0x0?(_0x31e69c/_0x58860f[_0x3131eb(0xb16)]*0x64)[_0x3131eb(0xc89)](0x2):0x0;await _0x28974b(_0x3131eb(0x10c7),'扫描完成！<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20共找到\x20'+_0x58860f[_0x3131eb(0x5c6)]+'\x20张本地图片<br>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20成功压缩\x20'+_0x58860f[_0x3131eb(0x113e)]+_0x3131eb(0x4e9)+_0x58860f[_0x3131eb(0x1069)]+_0x3131eb(0x35d)+(_0x31e69c/0x400/0x400)[_0x3131eb(0xc89)](0x2)+'\x20MB</strong>\x20(压缩率\x20'+_0x4bb4fa+_0x3131eb(0x11ac));}catch(_0x178869){console[_0x3131eb(0xc60)](_0x3131eb(0x6b7),_0x178869),await _0x28974b('压缩失败','操作失败:\x20'+_0x178869[_0x3131eb(0x854)]);}}function _0x17bc73(_0x1aee17,_0x590caa=''){const _0x311ffe=_0x5a7792;let _0x4310ba=0x0;for(const _0x352071 in _0x1aee17){if(_0x1aee17[_0x311ffe(0xed1)](_0x352071)){const _0x42c815=_0x1aee17[_0x352071];if(typeof _0x42c815==='string'&&_0x42c815[_0x311ffe(0x7d)](_0x311ffe(0xbb0))){const _0x1a9d9c=_0x590caa===_0x311ffe(0x11b4)&&(_0x352071==='wallpaper'||_0x352071===_0x311ffe(0xcbc)||_0x352071===_0x311ffe(0xcb4))||_0x590caa==='widgetData'||_0x590caa===_0x311ffe(0xcb3)&&_0x352071===_0x311ffe(0xc8b)||(_0x590caa==='appIcons'||_0x590caa==='cphoneAppIcons');!_0x1a9d9c&&(_0x4310ba+=_0x42c815['length']);}else typeof _0x42c815===_0x311ffe(0x59a)&&_0x42c815!==null&&(_0x4310ba+=_0x17bc73(_0x42c815,_0x352071));}}return _0x4310ba;}async function _0x15e3db(){const _0x453a71=_0x5a7792,_0x3a2b5f=document[_0x453a71(0x64f)](_0x453a71(0x5f9));if(!_0x3a2b5f)return;_0x3a2b5f[_0x453a71(0xc58)]=_0x453a71(0x132e);try{let _0x2ab78e=0x0;const _0x55827d=['chats','globalSettings',_0x453a71(0x3c2),_0x453a71(0xa8b),_0x453a71(0x297)];for(const _0x8c665c of _0x55827d){const _0x56cc75=_0x4e1bbf['table'](_0x8c665c);await _0x56cc75['each'](_0x323ad9=>{_0x2ab78e+=_0x17bc73(_0x323ad9);});}const _0x4f777b=(_0x2ab78e/0x400/0x400)[_0x453a71(0xc89)](0x2);_0x3a2b5f[_0x453a71(0xc58)]=_0x453a71(0xab3)+_0x4f777b+_0x453a71(0x20b);}catch(_0x109188){console[_0x453a71(0xc60)]('计算图片总大小时出错:',_0x109188),_0x3a2b5f[_0x453a71(0xc58)]=_0x453a71(0x86f);}}async function _0x2da5ad(_0x2068a9,_0x586693,_0x59a311=''){const _0x2ff0b7=_0x5a7792;for(const _0x249c0a in _0x2068a9){if(_0x2068a9['hasOwnProperty'](_0x249c0a)){const _0x8666ad=_0x2068a9[_0x249c0a];if(typeof _0x8666ad===_0x2ff0b7(0x1251)&&_0x8666ad[_0x2ff0b7(0x7d)]('data:image')){const _0x4c058a=_0x59a311===_0x2ff0b7(0x11b4)&&(_0x249c0a===_0x2ff0b7(0x6fe)||_0x249c0a==='cphoneWallpaper'||_0x249c0a==='globalChatBackground')||_0x59a311===_0x2ff0b7(0x9cc)||_0x59a311==='settings'&&_0x249c0a===_0x2ff0b7(0xc8b)||(_0x59a311===_0x2ff0b7(0xdaa)||_0x59a311==='cphoneAppIcons');if(_0x4c058a)continue;_0x586693[_0x2ff0b7(0x5c6)]++,_0x586693[_0x2ff0b7(0xb16)]+=_0x8666ad['length'];const _0x4d6af6=await _0x52c43b(_0x8666ad);_0x4d6af6&&_0x4d6af6!==_0x8666ad?(_0x2068a9[_0x249c0a]=_0x4d6af6,_0x586693[_0x2ff0b7(0x113e)]++,_0x586693[_0x2ff0b7(0x29b)]+=_0x4d6af6[_0x2ff0b7(0x40f)]):(_0x586693[_0x2ff0b7(0x1069)]++,_0x586693[_0x2ff0b7(0x29b)]+=_0x8666ad[_0x2ff0b7(0x40f)]);}else typeof _0x8666ad===_0x2ff0b7(0x59a)&&_0x8666ad!==null&&await _0x2da5ad(_0x8666ad,_0x586693,_0x249c0a);}}}function _0x52c43b(_0xc7a62,_0xc618d5={}){return new Promise(_0x37be91=>{const _0x2ac64e=_0x2bd6;if(!_0xc7a62['startsWith'](_0x2ac64e(0xbb0))){console['warn'](_0x2ac64e(0x629),_0xc7a62['substring'](0x0,0x32)+_0x2ac64e(0x3cd)),_0x37be91(_0xc7a62);return;}const _0x2458e3=_0xc618d5[_0x2ac64e(0x117b)]||0.5,_0x59c789=_0xc618d5[_0x2ac64e(0x771)]||0x320,_0x57494b=new Image();_0x57494b[_0x2ac64e(0x139d)]=()=>{const _0xc99962=_0x2ac64e;let _0x2c653e=_0x57494b['width'],_0xa340cc=_0x57494b[_0xc99962(0x877)];_0x2c653e>_0x59c789&&(_0xa340cc=Math[_0xc99962(0xb15)](_0x59c789/_0x2c653e*_0xa340cc),_0x2c653e=_0x59c789);const _0x25780=document[_0xc99962(0x124e)]('canvas');_0x25780['width']=_0x2c653e,_0x25780[_0xc99962(0x877)]=_0xa340cc;const _0x216247=_0x25780[_0xc99962(0x1370)]('2d');_0x216247[_0xc99962(0x10d4)](_0x57494b,0x0,0x0,_0x2c653e,_0xa340cc);const _0x47f6a1=_0x25780[_0xc99962(0x9cd)](_0xc99962(0xc4),_0x2458e3);_0x37be91(_0x47f6a1);},_0x57494b['onerror']=()=>{const _0x4867ac=_0x2ac64e;console[_0x4867ac(0x1155)](_0x4867ac(0x217),_0xc7a62[_0x4867ac(0x126f)](0x0,0x32)+_0x4867ac(0x3cd)),_0x37be91(_0xc7a62);},_0x57494b[_0x2ac64e(0xbe8)]=_0xc7a62;});}function _0x41993d(_0x2e5c44,_0x268b29){const _0x192b1d=_0x5a7792;if(!_0x2e5c44||!_0x268b29||typeof _0x2e5c44!=='string'||typeof _0x268b29!==_0x192b1d(0x1251))return 0x0;const _0x239f1e=_0x2e5c44[_0x192b1d(0x108c)]('.')[_0x192b1d(0xb96)](Number),_0x4ab01f=_0x268b29[_0x192b1d(0x108c)]('.')[_0x192b1d(0xb96)](Number),_0xc0e1bd=Math[_0x192b1d(0x804)](_0x239f1e['length'],_0x4ab01f[_0x192b1d(0x40f)]);for(let _0x3edd9e=0x0;_0x3edd9e<_0xc0e1bd;_0x3edd9e++){const _0xa56f70=_0x239f1e[_0x3edd9e]||0x0,_0x15d44c=_0x4ab01f[_0x3edd9e]||0x0;if(_0xa56f70>_0x15d44c)return 0x1;if(_0xa56f70<_0x15d44c)return-0x1;}return 0x0;}async function _0xa1a2f9(){const _0x2afa5b=_0x5a7792,_0x198cca='1.0';try{const _0x43bd09=await fetch('update-notice.html?_='+Date[_0x2afa5b(0x2b5)]());if(!_0x43bd09['ok']){console[_0x2afa5b(0x1155)](_0x2afa5b(0x116a));return;}const _0x517f2c=await _0x43bd09[_0x2afa5b(0x673)](),_0x45de96=document[_0x2afa5b(0x124e)](_0x2afa5b(0x479));_0x45de96[_0x2afa5b(0xc58)]=_0x517f2c;const _0x492d27=_0x45de96['querySelector'](_0x2afa5b(0xd4a));if(!_0x492d27){console[_0x2afa5b(0xc60)](_0x2afa5b(0x12a4));return;}const _0x355a92=_0x492d27[_0x2afa5b(0x12e1)][_0x2afa5b(0xf53)],_0x3d97ad=localStorage[_0x2afa5b(0x2f5)]('dismissedUpdateVersion');!_0x3d97ad||_0x41993d(_0x355a92,_0x3d97ad)>0x0?(console[_0x2afa5b(0x1081)](_0x2afa5b(0xc07)+_0x355a92+'\x20(已忽略版本:\x20'+(_0x3d97ad||'无')+')'),_0x2f87dc(_0x355a92,_0x492d27[_0x2afa5b(0xc58)])):console[_0x2afa5b(0x1081)]('当前通知版本\x20('+_0x355a92+_0x2afa5b(0xd78));}catch(_0x4a624f){console[_0x2afa5b(0xc60)](_0x2afa5b(0xbaf),_0x4a624f);}}function _0x2f87dc(_0x227477,_0x3c712d){const _0x2602fd=_0x5a7792,_0x27dd59=document['getElementById'](_0x2602fd(0x9ea)),_0x241a3c=document[_0x2602fd(0x64f)]('update-notice-body'),_0x5490e7=document[_0x2602fd(0x64f)](_0x2602fd(0x878)),_0x3d9d78=document['getElementById'](_0x2602fd(0xb6f));_0x241a3c[_0x2602fd(0xc58)]=_0x3c712d,_0x5490e7[_0x2602fd(0x113a)]=()=>{const _0x3510f4=_0x2602fd;_0x27dd59[_0x3510f4(0x418)]['remove'](_0x3510f4(0x40a));},_0x3d9d78[_0x2602fd(0x113a)]=()=>{const _0x33dbfa=_0x2602fd;localStorage['setItem'](_0x33dbfa(0x78b),_0x227477),_0x27dd59[_0x33dbfa(0x418)][_0x33dbfa(0x1275)](_0x33dbfa(0x40a)),console[_0x33dbfa(0x1081)](_0x33dbfa(0x3ed)+_0x227477);},_0x27dd59[_0x2602fd(0x418)][_0x2602fd(0xdda)](_0x2602fd(0x40a));}function _0x26367a(){const _0x1b4c58=_0x5a7792,_0x4e6b80=document[_0x1b4c58(0x64f)]('douban-settings-modal');document['getElementById']('douban-min-posts-input')['value']=_0x3e7a1b[_0x1b4c58(0x11b4)][_0x1b4c58(0x2eb)]||0xc,document[_0x1b4c58(0x64f)](_0x1b4c58(0xdd2))[_0x1b4c58(0xbed)]=_0x3e7a1b[_0x1b4c58(0x11b4)][_0x1b4c58(0xae7)]||0x14,_0x4e6b80[_0x1b4c58(0x418)]['add']('visible');}async function _0x30f901(){const _0x54fff3=_0x5a7792,_0x47c09a=document[_0x54fff3(0x64f)](_0x54fff3(0x536)),_0x2cb4e4=document[_0x54fff3(0x64f)](_0x54fff3(0xdd2)),_0x166413=parseInt(_0x47c09a[_0x54fff3(0xbed)]),_0x2b21e9=parseInt(_0x2cb4e4['value']);if(isNaN(_0x166413)||isNaN(_0x2b21e9)||_0x166413<0x1||_0x2b21e9<0x1){alert(_0x54fff3(0x1348));return;}if(_0x166413>_0x2b21e9){alert('最小帖子数不能大于最大帖子数！');return;}_0x3e7a1b[_0x54fff3(0x11b4)][_0x54fff3(0x2eb)]=_0x166413,_0x3e7a1b[_0x54fff3(0x11b4)][_0x54fff3(0xae7)]=_0x2b21e9,await _0x4e1bbf[_0x54fff3(0x11b4)]['put'](_0x3e7a1b['globalSettings']),document[_0x54fff3(0x64f)](_0x54fff3(0xdfc))['classList']['remove'](_0x54fff3(0x40a)),await _0x28974b(_0x54fff3(0x12e8),_0x54fff3(0x76d));}async function _0x24016a(_0x541e18){const _0x1ce7b0=_0x5a7792,_0x3a7a6b=document[_0x1ce7b0(0x64f)](_0x1ce7b0(0x85b)),_0x4a81c5=document[_0x1ce7b0(0x64f)](_0x1ce7b0(0xb47));_0x4a81c5[_0x1ce7b0(0xc58)]='';let _0x415030=[];if(_0x541e18===_0x1ce7b0(0x3fa)){const _0x1e35e1=Object[_0x1ce7b0(0xd6d)](_0x3e7a1b[_0x1ce7b0(0x999)])[_0x1ce7b0(0x156)](_0x29cea9=>!_0x29cea9[_0x1ce7b0(0x1167)]),_0x21da2f=await _0x4e1bbf[_0x1ce7b0(0xad7)][_0x1ce7b0(0x78f)]();_0x415030=[{'id':'user','name':_0x3e7a1b[_0x1ce7b0(0x3c2)][_0x1ce7b0(0x78c)]||'我','originalName':_0x3e7a1b['qzoneSettings'][_0x1ce7b0(0x78c)]||'我','avatar':_0x3e7a1b['qzoneSettings'][_0x1ce7b0(0x1265)],'type':_0x1ce7b0(0xa4d)},..._0x1e35e1['map'](_0x5022ca=>({'id':_0x5022ca['id'],'name':_0x5022ca[_0x1ce7b0(0x6fc)],'originalName':_0x5022ca[_0x1ce7b0(0x7de)],'avatar':_0x5022ca[_0x1ce7b0(0xcb3)][_0x1ce7b0(0x93)],'type':_0x1ce7b0(0x186)})),..._0x21da2f[_0x1ce7b0(0xb96)](_0x3d357b=>({'id':'npc_'+_0x3d357b['id'],'name':_0x3d357b[_0x1ce7b0(0x6fc)],'originalName':_0x3d357b[_0x1ce7b0(0x6fc)],'avatar':_0x3d357b['avatar'],'type':'npc'}))],_0x1d3b86[_0x1ce7b0(0x367)]=null;}else{const _0x5429c7=_0x3e7a1b['chats'][_0x3e7a1b['activeChatId']];if(!_0x5429c7||!_0x5429c7['isGroup'])return;_0x415030=[{'id':_0x1ce7b0(0xa4d),'name':_0x5429c7[_0x1ce7b0(0xcb3)][_0x1ce7b0(0x96f)]||'我','originalName':_0x3e7a1b[_0x1ce7b0(0x3c2)][_0x1ce7b0(0x78c)]||'我','avatar':_0x5429c7[_0x1ce7b0(0xcb3)][_0x1ce7b0(0x96a)],'type':_0x1ce7b0(0xa4d)},..._0x5429c7['members']['map'](_0x642416=>{const _0xc774dd=_0x1ce7b0,_0x3f3a03=_0x3e7a1b['chats'][_0x642416['id']],_0x513d37=_0x642416[_0xc774dd(0x1265)]||(_0x3f3a03?_0x3f3a03[_0xc774dd(0xcb3)][_0xc774dd(0x93)]:_0x480024);return{'id':_0x642416['id'],'name':_0x642416['groupNickname'],'originalName':_0x642416[_0xc774dd(0x7de)],'avatar':_0x513d37,'type':_0x642416['isNpc']?_0xc774dd(0x130e):_0xc774dd(0x186)};})],_0x1d3b86[_0x1ce7b0(0x367)]=_0x3e7a1b['activeChatId'];}_0x415030[_0x1ce7b0(0x103)](_0x3dcf08=>{const _0x410e93=_0x1ce7b0,_0x22c45e=document[_0x410e93(0x124e)](_0x410e93(0x479));_0x22c45e[_0x410e93(0x87d)]=_0x410e93(0x6e3),_0x22c45e[_0x410e93(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22werewolf-player-checkbox\x22\x20data-player-json=\x27'+JSON[_0x410e93(0xe3f)](_0x3dcf08)+'\x27\x20'+(_0x3dcf08['type']===_0x410e93(0xa4d)?_0x410e93(0x612):_0x410e93(0xf1d))+_0x410e93(0xef2)+_0x3dcf08[_0x410e93(0x1265)]+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x3dcf08[_0x410e93(0x6fc)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4a81c5[_0x410e93(0x99e)](_0x22c45e);}),_0x3a7a6b[_0x1ce7b0(0x418)][_0x1ce7b0(0xdda)](_0x1ce7b0(0x40a));}async function _0x2a8669(){const _0x58b035=_0x5a7792,_0x48869f=document[_0x58b035(0x233)](_0x58b035(0x865)),_0xc3a263=_0x48869f[_0x58b035(0x40f)];let _0x50ff80=[];if(_0xc3a263===0x6)_0x1d3b86['gameMode']='6p',_0x50ff80=['狼人','狼人','平民','平民',_0x58b035(0xc3a),'猎人'];else{if(_0xc3a263===0x9)_0x1d3b86[_0x58b035(0x1331)]='9p',_0x50ff80=['狼人','狼人','狼人','平民','平民','平民',_0x58b035(0xc3a),'女巫','猎人'];else{if(_0xc3a263===0xc)_0x1d3b86[_0x58b035(0x1331)]=_0x58b035(0xfe5),_0x50ff80=['狼人','狼人','狼人','狼人','平民','平民','平民','平民','预言家','女巫','猎人','守卫'];else{alert(_0x58b035(0x139b)+_0xc3a263+'\x20不支持。请选择6、9或12人。');return;}}}document['getElementById'](_0x58b035(0x85b))[_0x58b035(0x418)][_0x58b035(0x1275)](_0x58b035(0x40a)),await _0x28974b(_0x58b035(0x623),_0x58b035(0x134f));for(let _0x327d3a=_0x50ff80[_0x58b035(0x40f)]-0x1;_0x327d3a>0x0;_0x327d3a--){const _0xc82c4f=Math[_0x58b035(0x1245)](Math[_0x58b035(0x95f)]()*(_0x327d3a+0x1));[_0x50ff80[_0x327d3a],_0x50ff80[_0xc82c4f]]=[_0x50ff80[_0xc82c4f],_0x50ff80[_0x327d3a]];}const _0x8aa23e=Array[_0x58b035(0xb3a)](_0x48869f)[_0x58b035(0xb96)](_0x31f925=>JSON[_0x58b035(0x1214)](_0x31f925[_0x58b035(0x12e1)][_0x58b035(0x1059)]));_0x1d3b86[_0x58b035(0x119b)]=[];for(let _0x5c7812=0x0;_0x5c7812<_0x8aa23e[_0x58b035(0x40f)];_0x5c7812++){const _0x1dbbb6=_0x8aa23e[_0x5c7812],_0x13312d=_0x50ff80[_0x5c7812];let _0x1176b0=_0x58b035(0x2cb);if(_0x1dbbb6[_0x58b035(0xafc)]===_0x58b035(0x186)){const _0x4fe625=_0x3e7a1b[_0x58b035(0x999)][_0x1dbbb6['id']];_0x1176b0=_0x4fe625?_0x4fe625[_0x58b035(0xcb3)][_0x58b035(0xbe5)]:_0x58b035(0x6b6);}else{if(_0x1dbbb6['type']===_0x58b035(0x130e)){const _0x2bbdd5=await _0x4e1bbf[_0x58b035(0xad7)][_0x58b035(0x78f)](),_0x14d561=_0x2bbdd5[_0x58b035(0x137)](_0x106dc1=>'npc_'+_0x106dc1['id']===_0x1dbbb6['id']);_0x1176b0=_0x14d561?_0x14d561['persona']:_0x58b035(0x6a);}else{if(_0x1dbbb6[_0x58b035(0xafc)]==='user'){const _0x56955c=_0x1d3b86[_0x58b035(0x367)]?_0x3e7a1b['chats'][_0x1d3b86[_0x58b035(0x367)]]:null;_0x1176b0=_0x56955c?_0x56955c['settings'][_0x58b035(0x1047)]:'我是谁呀。';}}}const _0x4b695d={..._0x1dbbb6,'role':_0x13312d,'isAlive':!![],'character_persona':_0x1176b0};_0x13312d==='女巫'&&(_0x4b695d[_0x58b035(0x19b)]=![],_0x4b695d[_0x58b035(0x9e)]=![]),_0x13312d==='守卫'&&(_0x4b695d['lastGuardedId']=null),_0x1d3b86['players'][_0x58b035(0x13ee)](_0x4b695d);}_0x1d3b86[_0x58b035(0xb30)]=!![],_0x1d3b86['currentDay']=0x1,_0x1d3b86['currentPhase']=_0x58b035(0xdac),_0x1d3b86[_0x58b035(0xb02)]=[],_0x1d3b86[_0x58b035(0x5ed)]=[];const _0x53b615=_0x50ff80['reduce']((_0xe3c596,_0x1705ab)=>{return _0xe3c596[_0x1705ab]=(_0xe3c596[_0x1705ab]||0x0)+0x1,_0xe3c596;},{}),_0xb52bb8=Object['entries'](_0x53b615)['map'](([_0x456f13,_0x3ec80b])=>_0x456f13+'\x20x'+_0x3ec80b)[_0x58b035(0xd22)]('、');_0x580320(_0x58b035(0x10b5)+_0xc3a263+_0x58b035(0xef5)+_0xb52bb8+'。');const _0x1cccb6=_0x1d3b86[_0x58b035(0x119b)]['find'](_0x3daee7=>_0x3daee7['id']==='user');_0x711d33(),_0xddd8ae(_0x58b035(0xab7)),_0x1d663f(_0x1cccb6['role']);}function _0x711d33(){const _0x5f0b26=_0x5a7792,_0x4eb586=document['getElementById']('werewolf-player-grid');_0x4eb586['innerHTML']='';const _0x4b1d58=[..._0x1d3b86[_0x5f0b26(0x119b)]]['sort']((_0x561229,_0x43d9ea)=>_0x561229[_0x5f0b26(0xef8)]-_0x43d9ea[_0x5f0b26(0xef8)]);_0x4b1d58[_0x5f0b26(0x103)]((_0xf8efa8,_0x419c96)=>{const _0x3f0e41=_0x5f0b26,_0x310cc6=_0x1d3b86['players'][_0x3f0e41(0x6a2)](_0x41bf19=>_0x41bf19['id']===_0xf8efa8['id'])+0x1,_0x4eaaaa=document[_0x3f0e41(0x124e)](_0x3f0e41(0x479));_0x4eaaaa[_0x3f0e41(0x87d)]=_0x3f0e41(0x2da);if(!_0xf8efa8[_0x3f0e41(0xef8)])_0x4eaaaa[_0x3f0e41(0x418)][_0x3f0e41(0xdda)]('dead');_0x4eaaaa[_0x3f0e41(0xc58)]=_0x3f0e41(0xa8d)+_0xf8efa8['avatar']+'\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22player-name\x22>'+_0x310cc6+'.\x20'+_0xf8efa8[_0x3f0e41(0x6fc)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4eb586[_0x3f0e41(0x99e)](_0x4eaaaa);});const _0x183eb1=document[_0x5f0b26(0x64f)](_0x5f0b26(0x133b));_0x183eb1['innerHTML']='';for(let _0x4c8d25=0x1;_0x4c8d25<=_0x1d3b86[_0x5f0b26(0x443)];_0x4c8d25++){const _0x2737ab=[..._0x1d3b86[_0x5f0b26(0xb02)][_0x5f0b26(0x156)](_0x5392b2=>_0x5392b2[_0x5f0b26(0x976)]===_0x4c8d25),..._0x1d3b86['discussionLog']['filter'](_0xfa0269=>_0xfa0269[_0x5f0b26(0x976)]===_0x4c8d25)][_0x5f0b26(0x102f)]((_0x534095,_0x32da8d)=>(_0x534095['timestamp']||0x0)-(_0x32da8d[_0x5f0b26(0x8af)]||0x0));if(_0x2737ab[_0x5f0b26(0x40f)]>0x0){const _0x2b4402=document['createElement']('div');_0x2b4402[_0x5f0b26(0x87d)]=_0x5f0b26(0x25c),_0x2b4402[_0x5f0b26(0xee5)]=_0x5f0b26(0x890)+_0x4c8d25+_0x5f0b26(0x3b8),_0x2b4402[_0x5f0b26(0x731)][_0x5f0b26(0x42f)]=_0x5f0b26(0x395),_0x183eb1[_0x5f0b26(0x99e)](_0x2b4402),_0x2737ab['forEach'](_0x392b80=>{const _0x3bf1de=_0x5f0b26,_0x43d8b4=document[_0x3bf1de(0x124e)](_0x3bf1de(0x479));_0x43d8b4[_0x3bf1de(0x87d)]=_0x3bf1de(0xdd9)+_0x392b80[_0x3bf1de(0xafc)],_0x392b80[_0x3bf1de(0xafc)]==='dialogue'?_0x43d8b4[_0x3bf1de(0xc58)]='<span\x20class=\x22speaker\x22>'+_0x392b80[_0x3bf1de(0xf10)]+_0x3bf1de(0x435)+_0x392b80[_0x3bf1de(0x3ba)]:_0x43d8b4[_0x3bf1de(0xee5)]=_0x392b80[_0x3bf1de(0x3ba)],_0x183eb1[_0x3bf1de(0x99e)](_0x43d8b4);});}}_0x183eb1[_0x5f0b26(0xed7)]=_0x183eb1[_0x5f0b26(0x1ba)];const _0x5980fc={'start':_0x5f0b26(0xd2b),'night':'第'+_0x1d3b86[_0x5f0b26(0x443)]+_0x5f0b26(0x14a),'day':'第'+_0x1d3b86[_0x5f0b26(0x443)]+_0x5f0b26(0x975),'discussion':'第'+_0x1d3b86['currentDay']+'天\x20-\x20讨论','voting':'第'+_0x1d3b86[_0x5f0b26(0x443)]+'天\x20-\x20投票','gameover':_0x5f0b26(0xd81)};document[_0x5f0b26(0x64f)]('werewolf-game-title')[_0x5f0b26(0xee5)]='狼人杀\x20-\x20'+(_0x5980fc[_0x1d3b86[_0x5f0b26(0x49f)]]||_0x1d3b86[_0x5f0b26(0x49f)]);}function _0x1d663f(_0xaf2346){const _0x56a23b=_0x5a7792,_0x127773={'狼人':_0x56a23b(0x394),'平民':_0x56a23b(0x893),'预言家':_0x56a23b(0x78a),'猎人':'当你死亡时，你可以选择带走场上任意一名玩家。','女巫':_0x56a23b(0xe65),'守卫':'每晚可以守护一名玩家，使其免受狼人袭击。不能连续两晚守护同一个人。'};document[_0x56a23b(0x64f)]('werewolf-role-name')[_0x56a23b(0xee5)]=_0xaf2346,document[_0x56a23b(0x64f)](_0x56a23b(0x96))[_0x56a23b(0xee5)]=_0x127773[_0xaf2346]||_0x56a23b(0xb5d),document[_0x56a23b(0x64f)]('werewolf-role-modal')[_0x56a23b(0x418)]['add']('visible');}async function _0x3cd250(){const _0x585767=_0x5a7792;_0x1d3b86[_0x585767(0x49f)]='第'+_0x1d3b86[_0x585767(0x443)]+_0x585767(0x14a),_0x1d3b86['nightActions']={},_0x580320(_0x585767(0x2d0)),_0x711d33(),document['getElementById'](_0x585767(0x1a7))[_0x585767(0x731)][_0x585767(0x130)]='none',document[_0x585767(0x64f)](_0x585767(0x749))['style'][_0x585767(0x130)]='none',await new Promise(_0x18cd33=>setTimeout(_0x18cd33,0x5dc));const _0x4dadf1=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x137)](_0x3ed8eb=>_0x3ed8eb['role']==='守卫'&&_0x3ed8eb[_0x585767(0xef8)]);if(_0x4dadf1){_0x580320(_0x585767(0x608)),_0x711d33();let _0x22b448=null;if(_0x4dadf1['id']===_0x585767(0xa4d))_0x22b448=await _0x4356b1(_0x585767(0xe9e),_0x4dadf1[_0x585767(0x1ea)]);else{const _0x4ff16e=_0x1d3b86['players'][_0x585767(0x156)](_0x50a913=>_0x50a913[_0x585767(0xef8)]&&_0x50a913['id']!==_0x4dadf1[_0x585767(0x1ea)]);_0x4ff16e['length']>0x0&&(_0x22b448=_0x4ff16e[Math[_0x585767(0x1245)](Math[_0x585767(0x95f)]()*_0x4ff16e[_0x585767(0x40f)])]['id']);}_0x22b448&&(_0x1d3b86[_0x585767(0x458)]['guardedId']=_0x22b448,_0x4dadf1[_0x585767(0x1ea)]=_0x22b448),_0x580320(_0x585767(0xd11)),_0x711d33(),await new Promise(_0x54c8a0=>setTimeout(_0x54c8a0,0x5dc));}_0x580320(_0x585767(0x1197)),_0x711d33();const _0x57f3f9=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x156)](_0xd75e6=>_0xd75e6[_0x585767(0x931)]==='狼人'&&_0xd75e6['isAlive']),_0x4b3078=_0x57f3f9[_0x585767(0x26c)](_0x31748a=>_0x31748a['id']==='user');let _0x2c214e=null;_0x1d3b86[_0x585767(0x11aa)]=_0x585767(0x3b0);try{if(_0x4b3078)_0x580320(_0x585767(0x81a)),_0x711d33(),_0x2c214e=await _0x2165ec();else{if(_0x1d3b86[_0x585767(0x443)]===0x1){console[_0x585767(0x1081)]('第一夜，执行本地随机刀人逻辑...');const _0x10d1dc=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x156)](_0x228112=>_0x228112['isAlive']&&_0x228112['role']!=='狼人');_0x10d1dc[_0x585767(0x40f)]>0x0&&(_0x2c214e=_0x10d1dc[Math[_0x585767(0x1245)](Math[_0x585767(0x95f)]()*_0x10d1dc[_0x585767(0x40f)])]['id']);}else _0x2c214e=await _0x4f7800();}_0x1d3b86[_0x585767(0x11aa)]=null;}catch(_0x594306){console[_0x585767(0xc60)](_0x585767(0x3da),_0x594306),await _0x28974b(_0x585767(0x5b1),_0x585767(0x1382)),document['getElementById'](_0x585767(0x749))['style'][_0x585767(0x130)]=_0x585767(0xb37);return;}_0x1d3b86[_0x585767(0x458)]['killedId']=_0x2c214e,_0x580320(_0x585767(0xc6b)),_0x711d33(),await new Promise(_0x23f0d6=>setTimeout(_0x23f0d6,0x5dc));const _0x30cd7d=_0x1d3b86['players'][_0x585767(0x137)](_0x565adc=>_0x565adc[_0x585767(0x931)]==='女巫'&&_0x565adc['isAlive']);if(_0x30cd7d){_0x580320(_0x585767(0x2f8)),_0x711d33();const _0x44a70b=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x137)](_0x43a257=>_0x43a257['id']===_0x1d3b86['nightActions']['killedId']),_0x386def=_0x1d3b86[_0x585767(0x458)][_0x585767(0x51a)]===_0x1d3b86[_0x585767(0x458)]['killedId'],_0x2a54b3=_0x386def||!_0x44a70b?null:_0x44a70b;if(_0x30cd7d['id']===_0x585767(0xa4d)){let _0x332dba=await _0x339077(_0x2a54b3,_0x30cd7d);_0x332dba[_0x585767(0xe5d)]&&(_0x1d3b86['nightActions']['savedId']=_0x1d3b86[_0x585767(0x458)][_0x585767(0x51c)],_0x30cd7d['antidoteUsed']=!![]),_0x332dba[_0x585767(0xc68)]&&(_0x1d3b86[_0x585767(0x458)][_0x585767(0xa78)]=_0x332dba[_0x585767(0xc68)],_0x30cd7d[_0x585767(0x9e)]=!![]);}else{if(!_0x30cd7d[_0x585767(0x19b)]&&_0x2a54b3){let _0x3035a9=0x0;_0x1d3b86['currentDay']===0x1?_0x3035a9=0.3:_0x3035a9=0.8,console[_0x585767(0x1081)](_0x585767(0xa85)+_0x1d3b86['currentDay']+_0x585767(0x11b5)+_0x3035a9*0x64+'%'),Math[_0x585767(0x95f)]()<_0x3035a9?(console['log'](_0x585767(0x3fc)),_0x1d3b86[_0x585767(0x458)][_0x585767(0x681)]=_0x1d3b86[_0x585767(0x458)]['killedId'],_0x30cd7d['antidoteUsed']=!![]):console[_0x585767(0x1081)](_0x585767(0xccc));}if(!_0x1d3b86['nightActions'][_0x585767(0x681)]&&!_0x30cd7d[_0x585767(0x9e)]&&Math[_0x585767(0x95f)]()<0.5){const _0x4e888f=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x156)](_0x2ad1c4=>_0x2ad1c4[_0x585767(0xef8)]&&_0x2ad1c4['id']!==_0x1d3b86['nightActions'][_0x585767(0x51c)]);if(_0x4e888f[_0x585767(0x40f)]>0x0){const _0x29bb08=_0x4e888f[Math[_0x585767(0x1245)](Math[_0x585767(0x95f)]()*_0x4e888f['length'])];_0x1d3b86[_0x585767(0x458)]['poisonedId']=_0x29bb08['id'],_0x30cd7d[_0x585767(0x9e)]=!![],console[_0x585767(0x1081)](_0x585767(0x6a9)+_0x29bb08[_0x585767(0x6fc)]);}}}_0x580320(_0x585767(0xa46)),_0x711d33(),await new Promise(_0x1a42ee=>setTimeout(_0x1a42ee,0x5dc));}const _0x2d11aa=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x137)](_0x40128e=>_0x40128e[_0x585767(0x931)]===_0x585767(0xc3a)&&_0x40128e['isAlive']);if(_0x2d11aa){_0x580320(_0x585767(0x9ec)),_0x711d33();if(_0x2d11aa['id']===_0x585767(0xa4d)){const _0x4c6c2c=await _0x4356b1(_0x585767(0xd45)),_0x1bc18d=_0x1d3b86[_0x585767(0x119b)]['find'](_0x3d2fe6=>_0x3d2fe6['id']===_0x4c6c2c);if(_0x1bc18d){const _0x4959c4=_0x1bc18d[_0x585767(0x931)]==='狼人';await _0x28974b(_0x585767(0xa9b),_0x585767(0xfbe)+_0x1bc18d[_0x585767(0x6fc)]+_0x585767(0xca9)+(_0x4959c4?'狼人':'好人')),_0x1d3b86[_0x585767(0x458)][_0x585767(0x10b)]={'target':_0x4c6c2c,'result':_0x4959c4?'狼人':'好人'};}}else{const _0x58da65=_0x1d3b86[_0x585767(0x119b)][_0x585767(0x156)](_0x3f098a=>_0x3f098a[_0x585767(0xef8)]&&_0x3f098a['id']!==_0x2d11aa['id']);if(_0x58da65[_0x585767(0x40f)]>0x0){const _0x349293=_0x58da65[Math[_0x585767(0x1245)](Math['random']()*_0x58da65[_0x585767(0x40f)])];_0x1d3b86[_0x585767(0x458)][_0x585767(0x10b)]={'target':_0x349293['id'],'result':_0x349293['role']==='狼人'?'狼人':'好人'};}}_0x580320(_0x585767(0x9a2)),_0x711d33(),await new Promise(_0x4e2f78=>setTimeout(_0x4e2f78,0x5dc));}_0x3fcacd();}async function _0x3fcacd(){const _0x2ea9c4=_0x5a7792;_0x1d3b86[_0x2ea9c4(0x49f)]='第'+_0x1d3b86[_0x2ea9c4(0x443)]+_0x2ea9c4(0x975),_0x1d3b86[_0x2ea9c4(0x135f)]={},_0x580320(_0x2ea9c4(0x9d6));const {killedId:_0x32a1c0,guardedId:_0x4899d8,savedId:_0x5717a4,poisonedId:_0x4c0a63}=_0x1d3b86[_0x2ea9c4(0x458)],_0x466081=new Set();_0x32a1c0&&_0x32a1c0!==_0x4899d8&&_0x32a1c0!==_0x5717a4&&_0x466081[_0x2ea9c4(0xdda)](_0x32a1c0);_0x4c0a63&&_0x466081[_0x2ea9c4(0xdda)](_0x4c0a63);if(_0x466081['size']===0x0)_0x580320(_0x2ea9c4(0x40e));else for(const _0x5a15eb of _0x466081){const _0x151b78=_0x1d3b86[_0x2ea9c4(0x119b)][_0x2ea9c4(0x137)](_0xaba1b9=>_0xaba1b9['id']===_0x5a15eb);if(_0x151b78&&_0x151b78[_0x2ea9c4(0xef8)]){_0x151b78[_0x2ea9c4(0xef8)]=![],_0x580320(_0x2ea9c4(0x1007)+_0x151b78['name']+_0x2ea9c4(0x659));if(_0x151b78[_0x2ea9c4(0x931)]==='猎人'){_0x580320(_0x2ea9c4(0x12a1)),_0x711d33();let _0x6367c4=null;if(_0x151b78['id']===_0x2ea9c4(0xa4d))_0x6367c4=await _0x4356b1(_0x2ea9c4(0x355));else{const _0x2bbe0a=_0x1d3b86[_0x2ea9c4(0x119b)][_0x2ea9c4(0x156)](_0x445ef6=>_0x445ef6[_0x2ea9c4(0xef8)]&&_0x445ef6['id']!==_0x151b78['id']);_0x2bbe0a[_0x2ea9c4(0x40f)]>0x0&&(_0x6367c4=_0x2bbe0a[Math[_0x2ea9c4(0x1245)](Math['random']()*_0x2bbe0a['length'])]['id']);}const _0xdb9b2e=_0x1d3b86[_0x2ea9c4(0x119b)][_0x2ea9c4(0x137)](_0x2d6ec0=>_0x2d6ec0['id']===_0x6367c4);_0xdb9b2e&&(_0xdb9b2e[_0x2ea9c4(0xef8)]=![],_0x580320(_0x2ea9c4(0xffe)+_0xdb9b2e['name']+'。'));}}}_0x711d33();if(_0x546955())return;await _0x53f30b();}async function _0x53f30b(){const _0x3ff431=_0x5a7792;_0x580320('现在开始讨论，请各位玩家依次发言。'),_0x711d33();const {proxyUrl:_0x2a08e6,apiKey:_0x189f73,model:_0x1da00f}=_0x3e7a1b[_0x3ff431(0xec0)];if(!_0x2a08e6||!_0x189f73||!_0x1da00f){alert(_0x3ff431(0x524));return;}const _0x5b3185=_0x389a51();_0x1d3b86[_0x3ff431(0x11aa)]=_0x3ff431(0x2aa);try{await _0x28974b(_0x3ff431(0x96c),_0x3ff431(0x81));let _0x252ea3=_0x2a08e6[_0x3ff431(0xe53)]('generativelanguage'),_0x59cff9=[{'role':_0x3ff431(0xa4d),'content':'请所有AI角色根据你们的身份和人设开始发言。'}],_0x65a7ec=_0x250668(_0x1da00f,_0x189f73,_0x5b3185,_0x59cff9);const _0x2c2d89=_0x252ea3?await fetch(_0x65a7ec['url'],_0x65a7ec[_0x3ff431(0x88a)]):await fetch(_0x2a08e6+_0x3ff431(0x58b),{'method':'POST','headers':{'Content-Type':'application/json','Authorization':_0x3ff431(0x236)+_0x189f73},'body':JSON['stringify']({'model':_0x1da00f,'messages':[{'role':_0x3ff431(0x905),'content':_0x5b3185},..._0x59cff9],'temperature':_0x3e7a1b[_0x3ff431(0x11b4)][_0x3ff431(0xa55)]||0.95})});if(!_0x2c2d89['ok']){const _0x5b525d=await _0x2c2d89[_0x3ff431(0x6f8)]();throw new Error(_0x3ff431(0x1fa)+_0x5b525d[_0x3ff431(0xc60)][_0x3ff431(0x854)]);}const _0x5c9c85=await _0x2c2d89['json'](),_0x3139cf=getGeminiResponseText(_0x5c9c85),_0x375215=_0x3139cf[_0x3ff431(0x132a)](/(\[[\s\S]*\])/);if(!_0x375215)throw new Error(_0x3ff431(0xb42)+_0x3139cf);const _0x44bae6=JSON[_0x3ff431(0x1214)](_0x375215[0x0]);for(const _0x4ec109 of _0x44bae6){_0x4ec109[_0x3ff431(0xe2c)]&&_0x4ec109['dialogue']&&(_0x118d55(_0x4ec109[_0x3ff431(0xe2c)],_0x4ec109[_0x3ff431(0x344)]),_0x711d33(),await new Promise(_0x52737d=>setTimeout(_0x52737d,0x5dc+Math[_0x3ff431(0x95f)]()*0x7d0)));}_0x1d3b86[_0x3ff431(0x11aa)]=null;}catch(_0x503ee5){console['error'](_0x3ff431(0x183),_0x503ee5),await _0x28974b(_0x3ff431(0xa14),_0x3ff431(0x1358)+_0x503ee5[_0x3ff431(0x854)]),document['getElementById'](_0x3ff431(0x749))[_0x3ff431(0x731)][_0x3ff431(0x130)]=_0x3ff431(0xb37);return;}const _0xf85261=_0x1d3b86[_0x3ff431(0x119b)][_0x3ff431(0x137)](_0x52e3d7=>_0x52e3d7['id']===_0x3ff431(0xa4d)),_0xd6bde2=document['getElementById']('werewolf-action-bar'),_0x2e2eb6=document[_0x3ff431(0x64f)](_0x3ff431(0x5bd)),_0x43355b=document[_0x3ff431(0x64f)](_0x3ff431(0xbaa)),_0x157894=document[_0x3ff431(0x64f)](_0x3ff431(0x13bb));_0xd6bde2[_0x3ff431(0x731)][_0x3ff431(0x130)]='flex';if(_0xf85261&&_0xf85261[_0x3ff431(0xef8)]){_0x2e2eb6[_0x3ff431(0xee5)]='等待回应',_0x43355b[_0x3ff431(0xee5)]=_0x3ff431(0x452),_0x2e2eb6[_0x3ff431(0x731)]['display']=_0x3ff431(0xb37),_0x43355b['style'][_0x3ff431(0x130)]=_0x3ff431(0xb37),_0x157894[_0x3ff431(0x1b0)]=![],_0x157894[_0x3ff431(0x1323)]=_0x3ff431(0x1091),_0x157894[_0x3ff431(0x1218)]();const _0x51e636=_0x2e2eb6['cloneNode'](!![]);_0x2e2eb6[_0x3ff431(0x9be)][_0x3ff431(0x3d4)](_0x51e636,_0x2e2eb6),_0x51e636['addEventListener'](_0x3ff431(0x1080),_0x30d4a5);const _0x5e69b4=_0x43355b['cloneNode'](!![]);_0x43355b['parentNode'][_0x3ff431(0x3d4)](_0x5e69b4,_0x43355b),_0x5e69b4['addEventListener']('click',_0x182846);}else{_0x580320('你已经死亡，无法发言。请等待其他玩家发言结束。'),_0x711d33(),_0x2e2eb6['textContent']='继续讨论',_0x43355b[_0x3ff431(0xee5)]=_0x3ff431(0x101f),_0x2e2eb6[_0x3ff431(0x731)][_0x3ff431(0x130)]=_0x3ff431(0xb37),_0x43355b[_0x3ff431(0x731)][_0x3ff431(0x130)]=_0x3ff431(0xb37),_0x157894['disabled']=!![],_0x157894['placeholder']=_0x3ff431(0x369);const _0x107691=_0x2e2eb6['cloneNode'](!![]);_0x2e2eb6[_0x3ff431(0x9be)][_0x3ff431(0x3d4)](_0x107691,_0x2e2eb6),_0x107691[_0x3ff431(0xf72)](_0x3ff431(0x1080),_0x44ae9a);const _0x1ac964=_0x43355b[_0x3ff431(0xc66)](!![]);_0x43355b['parentNode'][_0x3ff431(0x3d4)](_0x1ac964,_0x43355b),_0x1ac964[_0x3ff431(0xf72)](_0x3ff431(0x1080),_0x176bda);}}function _0x389a51(){const _0x33c77c=_0x5a7792,_0x41ab5c=_0x1d3b86['players'][_0x33c77c(0x156)](_0x161d02=>_0x161d02['isAlive']),_0x275e9d=_0x1d3b86[_0x33c77c(0x119b)][_0x33c77c(0x137)](_0x1e5468=>_0x1e5468['id']==='user'),_0x191f21=_0x275e9d?_0x275e9d[_0x33c77c(0x6fc)]:'用户',_0x44bec8=_0x41ab5c['some'](_0x188c4f=>_0x188c4f['id']==='user');let _0x20be82=_0x33c77c(0xa53);_0x20be82+=_0x33c77c(0xce),_0x41ab5c[_0x33c77c(0x103)]((_0x322787,_0xa4f357)=>{const _0x30a276=_0x33c77c,_0x389bb4=_0x1d3b86['players'][_0x30a276(0x6a2)](_0x52d93d=>_0x52d93d['id']===_0x322787['id'])+0x1;let _0x461d1c='';const _0x176c97=_0x3e7a1b[_0x30a276(0x999)][_0x322787['id']];if(_0x176c97){const _0x180cb6=_0x41ab5c[_0x30a276(0x156)](_0x43d8d1=>_0x43d8d1['id']!==_0x322787['id']&&_0x3e7a1b[_0x30a276(0x999)][_0x43d8d1['id']]&&_0x3e7a1b['chats'][_0x43d8d1['id']]['groupId']===_0x176c97[_0x30a276(0xeb)]&&_0x176c97[_0x30a276(0xeb)]!==null)[_0x30a276(0xb96)](_0x2a41a9=>_0x2a41a9[_0x30a276(0x6fc)])['join']('、');_0x180cb6&&(_0x461d1c+=_0x30a276(0x5a5)+_0x180cb6+_0x30a276(0xe9b));}_0x322787['id']!==_0x30a276(0xa4d)&&(_0x461d1c+=_0x30a276(0xdae)+_0x191f21+_0x30a276(0xfc5));_0x20be82+=_0x30a276(0x726)+_0x389bb4+_0x30a276(0xbad)+_0x322787[_0x30a276(0x6fc)]+_0x30a276(0xe6c)+_0x322787[_0x30a276(0x7de)]+_0x30a276(0xd7f)+(_0x322787['id']==='user'?_0x30a276(0x7d9):_0x30a276(0xb0a))+_0x30a276(0x759)+_0x322787[_0x30a276(0xd6)]+'\x0a';if(_0x322787[_0x30a276(0xafc)]===_0x30a276(0x186)){const _0x4e603=_0x3e7a1b['chats'][_0x322787['id']];if(_0x4e603&&_0x4e603[_0x30a276(0x518)]&&_0x4e603[_0x30a276(0x518)][_0x30a276(0x40f)]>0x0){const _0x50f536=_0x4e603[_0x30a276(0x518)][_0x30a276(0xb96)](_0x2cc37b=>_0x2cc37b['content'])[_0x30a276(0xd22)](';\x20');_0x20be82+=_0x30a276(0x6d0)+_0x50f536+'\x0a';}}_0x461d1c&&(_0x20be82+=_0x30a276(0x40c)+_0x461d1c);});let _0x242d32='#\x20昨晚事件总结\x20(Night\x20Event\x20Summary)\x0a';_0x242d32+=_0x33c77c(0xbe4);const _0x2d9dd6=_0x1d3b86[_0x33c77c(0xb02)]['filter'](_0x3c55f3=>_0x3c55f3[_0x33c77c(0x3ba)][_0x33c77c(0xe53)]('死亡了')&&_0x3c55f3['day']===_0x1d3b86['currentDay']);_0x2d9dd6[_0x33c77c(0x40f)]===0x0?_0x242d32+=_0x33c77c(0xb4a):_0x2d9dd6[_0x33c77c(0x103)](_0x1b906c=>{const _0x4a55e1=_0x33c77c;_0x242d32+='-\x20'+_0x1b906c[_0x4a55e1(0x3ba)]+'\x0a';});let _0x174dfa=_0x33c77c(0x247);if(_0x1d3b86[_0x33c77c(0x443)]>0x1)for(let _0x319250=0x1;_0x319250<_0x1d3b86[_0x33c77c(0x443)];_0x319250++){_0x174dfa+='\x0a**---\x20第\x20'+_0x319250+'\x20天\x20---**\x0a';const _0x103f69=_0x1d3b86[_0x33c77c(0xb02)][_0x33c77c(0x156)](_0x7c1672=>_0x7c1672[_0x33c77c(0x976)]===_0x319250&&(_0x7c1672['content'][_0x33c77c(0xe53)]('死亡')||_0x7c1672[_0x33c77c(0x3ba)][_0x33c77c(0xe53)]('放逐')));_0x103f69[_0x33c77c(0x40f)]>0x0?_0x174dfa+='*事件*:\x20'+_0x103f69[_0x33c77c(0xb96)](_0x33928d=>_0x33928d[_0x33c77c(0x3ba)])['join']('\x20')+'\x0a':_0x174dfa+=_0x33c77c(0xf6b);const _0x2d36a8=_0x1d3b86[_0x33c77c(0x5ed)][_0x33c77c(0x156)](_0xc5ea78=>_0xc5ea78[_0x33c77c(0x976)]===_0x319250);_0x2d36a8[_0x33c77c(0x40f)]>0x0&&(_0x174dfa+=_0x33c77c(0x1aa)+_0x2d36a8[_0x33c77c(0xb96)](_0x5699d8=>'-\x20'+_0x5699d8[_0x33c77c(0xf10)]+':\x20'+_0x5699d8[_0x33c77c(0x3ba)])[_0x33c77c(0xd22)]('\x0a')+'\x0a');}else _0x174dfa+=_0x33c77c(0xd79);let _0x29c575=_0x33c77c(0xeaa);const _0x3cf14d=_0x1d3b86[_0x33c77c(0x5ed)]['filter'](_0x312da4=>_0x312da4[_0x33c77c(0x976)]===_0x1d3b86[_0x33c77c(0x443)]);_0x3cf14d[_0x33c77c(0x40f)]>0x0?_0x29c575+=_0x3cf14d[_0x33c77c(0xb96)](_0x54d0cc=>'-\x20**'+_0x54d0cc['speaker']+_0x33c77c(0x12ea)+_0x54d0cc['content'])['join']('\x0a'):_0x29c575+=_0x33c77c(0x581);let _0x29bd1f='\x0a#\x20【【【逻辑隔离与TGS三核思考\x20(最高优先级指令)】】】\x0a为了兼顾游戏逻辑和角色扮演，你【必须】在内部为【每一个AI角色】按顺序执行以下“三阶段思考”：\x0a\x0a##\x20阶段1：内部独立思考\x20(Internal\x20Monologue\x20Scratchpad)\x0a(这部分内容【绝对不能】出现在你最终的JSON输出中，这仅供你内部模拟使用)\x0a';_0x41ab5c[_0x33c77c(0x103)](_0x4ab1ce=>{const _0xbcdeba=_0x33c77c;if(_0x4ab1ce['id']!==_0xbcdeba(0xa4d)){const _0x15f37a=_0x1d3b86[_0xbcdeba(0x119b)][_0xbcdeba(0x6a2)](_0x3739b2=>_0x3739b2['id']===_0x4ab1ce['id'])+0x1;_0x29bd1f+='\x0a###\x20正在模拟\x20'+_0x15f37a+_0xbcdeba(0xbad)+_0x4ab1ce[_0xbcdeba(0x6fc)]+_0xbcdeba(0xbfe)+_0x4ab1ce['originalName']+')\x0a\x0a####\x20阶段\x20A：数据输入\x20(Data\x20Input)\x0a1.\x20\x20**我的秘密身份**:\x20我是【'+_0x4ab1ce['role']+_0xbcdeba(0xf92);let _0x59eb90='';if(_0x4ab1ce[_0xbcdeba(0x931)]==='狼人'){const _0x381df9=_0x1d3b86[_0xbcdeba(0x119b)][_0xbcdeba(0x156)](_0x3fa913=>_0x3fa913[_0xbcdeba(0x931)]==='狼人'&&_0x3fa913['id']!==_0x4ab1ce['id']&&_0x3fa913[_0xbcdeba(0xef8)])[_0xbcdeba(0xb96)](_0x48b017=>_0x48b017[_0xbcdeba(0x6fc)])['join']('、');_0x59eb90+='\x20\x20\x20\x20-\x20我的狼队友是：'+(_0x381df9||'无')+'\x0a';const _0x26bde9=_0x1d3b86[_0xbcdeba(0x119b)]['find'](_0x31f4ae=>_0x31f4ae['id']===_0x1d3b86[_0xbcdeba(0x458)][_0xbcdeba(0x51c)]);_0x59eb90+=_0xbcdeba(0x841)+(_0x26bde9?_0x26bde9['name']:'空刀')+'\x0a';}if(_0x4ab1ce['role']===_0xbcdeba(0xc3a)&&_0x1d3b86['nightActions']['prophetCheck']){const _0x5c05ed=_0x1d3b86[_0xbcdeba(0x119b)][_0xbcdeba(0x137)](_0x302094=>_0x302094['id']===_0x1d3b86[_0xbcdeba(0x458)]['prophetCheck'][_0xbcdeba(0xf5b)]);_0x59eb90+=_0xbcdeba(0x9b5)+_0x5c05ed[_0xbcdeba(0x6fc)]+'，TA的身份是：【'+_0x1d3b86['nightActions'][_0xbcdeba(0x10b)][_0xbcdeba(0x8f)]+'】\x0a';}if(_0x4ab1ce[_0xbcdeba(0x931)]==='女巫'){if(_0x1d3b86[_0xbcdeba(0x458)][_0xbcdeba(0x681)]){const _0x38afdd=_0x1d3b86[_0xbcdeba(0x119b)]['find'](_0x1373c7=>_0x1373c7['id']===_0x1d3b86['nightActions'][_0xbcdeba(0x681)]);_0x59eb90+=_0xbcdeba(0x1379)+_0x38afdd[_0xbcdeba(0x6fc)]+'。\x0a';}if(_0x1d3b86[_0xbcdeba(0x458)]['poisonedId']){const _0xc6d21d=_0x1d3b86['players']['find'](_0x1d5f2b=>_0x1d5f2b['id']===_0x1d3b86[_0xbcdeba(0x458)]['poisonedId']);_0x59eb90+='\x20\x20\x20\x20-\x20我昨晚用毒药毒了\x20'+_0xc6d21d[_0xbcdeba(0x6fc)]+'。\x0a';}_0x59eb90+=_0xbcdeba(0x573)+(_0x4ab1ce[_0xbcdeba(0x19b)]?_0xbcdeba(0xf7b):'未使用')+'\x0a',_0x59eb90+=_0xbcdeba(0x815)+(_0x4ab1ce[_0xbcdeba(0x9e)]?'已使用':_0xbcdeba(0xb71))+'\x0a';}if(_0x4ab1ce[_0xbcdeba(0x931)]==='守卫'){if(_0x1d3b86['nightActions'][_0xbcdeba(0x51a)]){const _0x508bdf=_0x1d3b86[_0xbcdeba(0x119b)]['find'](_0x33f38d=>_0x33f38d['id']===_0x1d3b86[_0xbcdeba(0x458)][_0xbcdeba(0x51a)]);_0x59eb90+=_0xbcdeba(0x31e)+_0x508bdf[_0xbcdeba(0x6fc)]+'。\x0a';}else _0x59eb90+='\x20\x20\x20\x20-\x20我昨晚空守了。\x0a';}_0x59eb90===''&&(_0x59eb90=_0xbcdeba(0x13d1));_0x29bd1f+=_0x59eb90,_0x29bd1f+=_0xbcdeba(0x127b)+_0x242d32[_0xbcdeba(0x137f)](/\n/g,'\x20')+_0xbcdeba(0xe43)+_0x29c575[_0xbcdeba(0x137f)](/\n/g,'\x20')+_0xbcdeba(0x7e0)+_0x4ab1ce[_0xbcdeba(0xd6)]+'\x0a\x20\x20\x20\x20-\x20**社交**:\x20\x0a';let _0x43c328='';const _0x555400=_0x3e7a1b['chats'][_0x4ab1ce['id']];if(_0x555400){const _0x477b8c=_0x41ab5c[_0xbcdeba(0x156)](_0x440a85=>_0x440a85['id']!==_0x4ab1ce['id']&&_0x3e7a1b[_0xbcdeba(0x999)][_0x440a85['id']]&&_0x3e7a1b[_0xbcdeba(0x999)][_0x440a85['id']][_0xbcdeba(0xeb)]===_0x555400[_0xbcdeba(0xeb)]&&_0x555400['groupId']!==null)[_0xbcdeba(0xb96)](_0x2f71cc=>_0x2f71cc['name'])['join']('、');_0x477b8c&&(_0x43c328+='\x20\x20\x20\x20\x20\x20-\x20'+_0x477b8c+_0xbcdeba(0x87c));}_0x4ab1ce['id']!==_0xbcdeba(0xa4d)&&(_0x43c328+=_0xbcdeba(0x1317)+_0x191f21+_0xbcdeba(0x1269)),_0x43c328===''&&(_0x43c328='\x20\x20\x20\x20\x20\x20-\x20我在此次游戏中没有特别的社交关系。\x0a'),_0x29bd1f+=_0x43c328,_0x29bd1f+='\x0a####\x20阶段\x20B：TGS\x20融合思考\x20(Task-Game-Social)\x0a1.\x20\x20**T\x20(Task\x20-\x20游戏任务)**:\x20基于我的身份和秘密，我的【逻辑目标】是\x20(例如：找出狼人\x20/\x20悍跳预言家\x20/\x20隐藏身份\x20/\x20保护队友\x20/\x20攻击'+_0x191f21+')。\x0a2.\x20\x20**G\x20(Game\x20-\x20游戏互动)**:\x20针对【今日讨论】中\x20'+(_0x3cf14d[_0xbcdeba(0x40f)]>0x0?_0xbcdeba(0x359):_0xbcdeba(0x85a))+_0xbcdeba(0xd31)+_0x191f21+'\x20被怀疑了，虽然我的逻辑也怀疑TA，但我的表演必须是维护TA的：“我不觉得'+_0x191f21+_0xbcdeba(0x1129)+_0x4ab1ce['role']+'，我的人设很'+_0x4ab1ce['character_persona'][_0xbcdeba(0x126f)](0x0,0x14)+_0xbcdeba(0x23b);}}),_0x29bd1f+=_0x33c77c(0x11f4);const _0x694dff=_0x33c77c(0x70c)+(_0x44bec8?_0x33c77c(0x2f3)+_0x191f21+')':_0x33c77c(0x66b)+_0x191f21+')')+_0x33c77c(0x6bc)+_0x20be82+_0x33c77c(0x899)+(_0x1d3b86[_0x33c77c(0x1331)]===_0x33c77c(0xfe5)?_0x33c77c(0x12e4):_0x33c77c(0x5da))+_0x33c77c(0x9d3)+_0x1d3b86[_0x33c77c(0x443)]+'\x20天的讨论环节。\x0a'+_0x242d32+_0x33c77c(0x8e6)+_0x41ab5c['map'](_0x3e0641=>_0x3e0641[_0x33c77c(0x6fc)]+'\x20('+(_0x3e0641['id']==='user'?'用户':'AI')+')')[_0x33c77c(0xd22)](',\x20')+'\x0a\x0a#\x20【【【角色策略指南\x20(至关重要！)】】】\x0a你【不是】一个单纯的游戏玩家，你是一个【有感情、有记忆、有社交关系】的角色。你在游戏中的所有发言和行为，都【必须】首先符合你的人设以及你与其他玩家的既有关系。\x0a-\x20**朋友**:\x20如果你和某个玩家是朋友，你应该在发言时倾向于保护TA，为TA的发言寻找合理解释，除非有确凿的证据。\x0a-\x20**敌人/情敌**:\x20如果你和某个玩家有矛盾，你可以借机在游戏中攻击TA，质疑TA的发言，甚至在你是狼人时优先刀掉TA。\x0a-\x20**恋人/暗恋对象**:\x20你会无条件地信任TA，保护TA，甚至愿意为TA牺牲。\x0a你的社交关系比游戏本身的胜负更重要！\x0a你的发言【必须】体现出高水平的、类似真人的策略博弈，而不是简单地陈述事实。\x0a\x0a###\x20**神职角色\x20(预言家,\x20女巫,\x20猎人,\x20守卫)\x20策略**\x0a1.\x20\x20**【隐藏优先！】**:\x20你的首要任务是活下去。**绝对不要**在第一天就轻易暴露自己的神职身份！这会让你立刻成为狼人的目标。\x0a2.\x20\x20**【暗示而非明示】**:\x20你应该用更委婉、更聪明的语言来传递信息，而不是直接说“我是预言家，我查了A”。\x0a\x20\x20\x20\x20*\x20**预言家可以说**:\x20“我对X玩家的身份有一些看法，我觉得他发言很阳光。”\x20或\x20“Y玩家的发言让我感到很不舒服，我把他列为重点怀疑对象。”\x0a\x20\x20\x20\x20*\x20**女巫可以说**:\x20“昨晚的信息很有趣，场上局势可能和大家想的不一样。”\x0a3.\x20\x20**【何时起跳？】**:\x20只有在以下【危急情况】下，你才应该考虑暴露自己的身份（俗称“起跳”）：\x0a\x20\x20\x20\x20*\x20**被投票时**:\x20当你即将被投票放逐时，必须起跳自证身份来求生。\x0a\x20\x20\x20\x20*\x20**关键信息**:\x20当你掌握了可以决定胜负的信息时（例如预言家查到了最后一个狼人）。\x0a\x20\x20\x20\x20*\x20**有人悍跳**:\x20当有狼人假扮你的身份时，你必须站出来与他对峙，争夺好人的信任。\x0a\x0a###\x20**狼人角色策略**\x0a1.\x20\x20**【积极伪装】**:\x20你需要扮演一个好人，最好是伪装成某个神职（俗称“悍跳”），来扰乱好人的判断，骗取他们的信任。\x0a2.\x20\x20**【制造混乱】**:\x20你的发言应该引导好人去怀疑其他无辜的好人。可以故意曲解别人的发言，或者制造逻辑陷阱。\x0a3.\x20\x20**【团队合作】**:\x20如果你的狼队友被怀疑，你应该想办法为他辩护，或者通过攻击其他玩家来转移焦点。\x0a\x0a###\x20**平民角色策略**\x0a1.\x20\x20**【逻辑为王】**:\x20你是场上的“法官”。你的核心任务是仔细倾听每个人的发言，找出其中的逻辑漏洞和矛盾之处。\x0a2.\x20\x20**【积极分析】**:\x20不要只是说“我不知道，我过了”。你应该大胆说出你的怀疑，并解释你的理由。例如：“A玩家说B是狼人，但是他的理由很牵强，所以我更怀疑A。”\x0a3.\x20\x20**【跟票与站边】**:\x20在你相信某位神职玩家后，你应该坚定地支持他，并号召其他好人一起投票给神职指认的狼人。\x0a\x0a#\x20其他核心指令\x20(必须遵守)\x0a1.\x20\x20**互动铁律**:\x20角色之间【必须】互相质疑、支持、分析【本轮已有发言】。你【绝对不能】无视\x20'+_0x191f21+_0x33c77c(0xff5)+_0x174dfa+_0x33c77c(0xb93)+_0x29c575+'\x0a\x0a'+_0x29bd1f+_0x33c77c(0x861);return _0x694dff;}function _0x586d6a(_0x11e4dc){const _0x414d92=_0x5a7792;let _0x4c6369='---\x20狼人杀对局完整复盘\x20---\x0a\x0a';const _0xd6abf8=_0x11e4dc[_0x414d92(0xb02)][_0x414d92(0x137)](_0x2c8b6a=>_0x2c8b6a['content'][_0x414d92(0xe53)]('胜利'))?.[_0x414d92(0x3ba)]||_0x414d92(0x134c);_0x4c6369+=_0x414d92(0x12f7)+_0xd6abf8+'\x0a\x0a',_0x4c6369+='###\x20玩家身份配置:\x0a',_0x11e4dc[_0x414d92(0x119b)][_0x414d92(0x103)](_0x517c30=>{const _0x419d27=_0x414d92,_0x1c0b09=_0x517c30[_0x419d27(0xef8)]?'存活':_0x419d27(0x1369);_0x4c6369+='-\x20'+_0x517c30['name']+':\x20'+_0x517c30[_0x419d27(0x931)]+'\x20('+_0x1c0b09+')\x0a';}),_0x4c6369+=_0x414d92(0x1236);for(let _0x38a337=0x1;_0x38a337<=_0x11e4dc['currentDay'];_0x38a337++){_0x4c6369+=_0x414d92(0x6ed)+_0x38a337+'\x20天\x20---**\x0a';const _0x51f1d2=_0x11e4dc[_0x414d92(0xb02)]['filter'](_0x463ffe=>_0x463ffe[_0x414d92(0x976)]===_0x38a337&&_0x463ffe[_0x414d92(0x3ba)][_0x414d92(0xe53)]('死亡'));if(_0x51f1d2[_0x414d92(0x40f)]>0x0)_0x4c6369+='**[夜晚]**\x20'+_0x51f1d2[_0x414d92(0xb96)](_0x38428f=>_0x38428f[_0x414d92(0x3ba)])[_0x414d92(0xd22)]('\x20')+'\x0a';else(_0x38a337>0x1||_0x38a337===0x1&&_0x11e4dc[_0x414d92(0x443)]>0x1)&&(_0x4c6369+=_0x414d92(0x576));const _0x453a04=_0x11e4dc[_0x414d92(0x5ed)][_0x414d92(0x156)](_0x57bf2d=>_0x57bf2d[_0x414d92(0x976)]===_0x38a337);_0x453a04['length']>0x0&&(_0x4c6369+=_0x414d92(0x702)+_0x453a04['map'](_0x44de9b=>'-\x20'+_0x44de9b['speaker']+':\x20'+_0x44de9b[_0x414d92(0x3ba)])[_0x414d92(0xd22)]('\x0a')+'\x0a');const _0x2fb910=_0x11e4dc[_0x414d92(0xb02)][_0x414d92(0x137)](_0x528bb1=>_0x528bb1[_0x414d92(0x976)]===_0x38a337&&_0x528bb1[_0x414d92(0x3ba)][_0x414d92(0xe53)](_0x414d92(0xa3d)));_0x2fb910&&(_0x4c6369+='**[投票结果]**\x20'+_0x2fb910[_0x414d92(0x3ba)]+'\x0a');}return _0x4c6369+=_0x414d92(0x1186),_0x4c6369;}async function _0x163423(_0x49d335){const _0x3c330d=_0x5a7792;let _0x5dbbc9=0x0;for(const _0x53a555 of _0x1d3b86['players']){if(_0x53a555[_0x3c330d(0xafc)]==='character'){const _0x53e9e6=_0x3e7a1b[_0x3c330d(0x999)][_0x53a555['id']];if(_0x53e9e6){const _0x5d1945={'content':_0x49d335,'timestamp':Date['now'](),'source':'werewolf_summary'};!_0x53e9e6[_0x3c330d(0x518)]&&(_0x53e9e6[_0x3c330d(0x518)]=[]),_0x53e9e6['longTermMemory'][_0x3c330d(0x13ee)](_0x5d1945),await _0x4e1bbf['chats'][_0x3c330d(0x4fa)](_0x53e9e6),_0x5dbbc9++;}}}return _0x5dbbc9;}async function _0x54429a(){const _0xbdd8da=_0x5a7792;if(!_0x1d3b86[_0xbdd8da(0xb30)]&&_0x1d3b86[_0xbdd8da(0x49f)]===_0xbdd8da(0x836)){await _0x28974b(_0xbdd8da(0x2f7),_0xbdd8da(0x30f));try{const _0x5b93ea=_0x586d6a(_0x1d3b86),_0xe4458e=await _0x163423(_0x5b93ea);await _0x28974b('成功',_0xbdd8da(0x2d7)+_0xe4458e+_0xbdd8da(0x101));}catch(_0x382fde){console[_0xbdd8da(0xc60)](_0xbdd8da(0x995),_0x382fde),await _0x28974b('失败',_0xbdd8da(0x856)+_0x382fde[_0xbdd8da(0x854)]);}}else alert(_0xbdd8da(0xb79));}async function _0x202bde(_0x123a6f){const _0x48d36c=_0x5a7792;_0x1d3b86[_0x48d36c(0xb30)]=![],_0x1d3b86[_0x48d36c(0x49f)]=_0x48d36c(0x836),_0x580320(_0x123a6f+_0x48d36c(0x7e9)),document[_0x48d36c(0x64f)](_0x48d36c(0x13e6))[_0x48d36c(0xee5)]=_0x123a6f+_0x48d36c(0x74);let _0x239b3b='';_0x123a6f==='好人'?_0x239b3b='所有狼人已被放逐，好人阵营获得了胜利！':_0x239b3b='狼人数量已达到胜利条件，狼人阵营获得了胜利！';const _0x52ea9a=document[_0x48d36c(0x64f)](_0x48d36c(0xa6c));_0x52ea9a[_0x48d36c(0xee5)]=_0x239b3b;const _0x442f03=document[_0x48d36c(0x64f)]('werewolf-role-reveal-list');_0x442f03['innerHTML']='';const _0x791a31=[..._0x1d3b86['players']][_0x48d36c(0x102f)]((_0x527fce,_0x78776d)=>{const _0x1a12d1=_0x48d36c,_0x3bc748=_0x1d3b86[_0x1a12d1(0x119b)]['findIndex'](_0x26e608=>_0x26e608['id']===_0x527fce['id']),_0x5dafec=_0x1d3b86[_0x1a12d1(0x119b)][_0x1a12d1(0x6a2)](_0x584eb9=>_0x584eb9['id']===_0x78776d['id']);return _0x3bc748-_0x5dafec;});_0x791a31['forEach']((_0x2b8bc5,_0x278a21)=>{const _0x5e4382=_0x48d36c,_0x7cb2ba=document[_0x5e4382(0x124e)](_0x5e4382(0x479));_0x7cb2ba['style'][_0x5e4382(0x42f)]=_0x5e4382(0x1e6);if(_0x278a21===_0x791a31[_0x5e4382(0x40f)]-0x1)_0x7cb2ba['style']['borderBottom']='none';const _0x4686c3=_0x2b8bc5[_0x5e4382(0x931)]==='狼人'?'#ff4d4d':_0x5e4382(0x60b);_0x7cb2ba['innerHTML']=_0x5e4382(0x531)+_0x2b8bc5[_0x5e4382(0x1265)]+'\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20margin-right:\x2012px;\x20filter:\x20'+(_0x2b8bc5['isAlive']?'none':_0x5e4382(0x7e1))+_0x5e4382(0xa5b)+(_0x2b8bc5[_0x5e4382(0xef8)]?'none':'line-through')+_0x5e4382(0x4e1)+(_0x278a21+0x1)+'.\x20'+_0x2b8bc5[_0x5e4382(0x6fc)]+_0x5e4382(0xfaa)+_0x4686c3+_0x5e4382(0x4e1)+_0x2b8bc5[_0x5e4382(0x931)]+_0x5e4382(0x6c4),_0x442f03[_0x5e4382(0x99e)](_0x7cb2ba);}),document[_0x48d36c(0x64f)](_0x48d36c(0xf03))[_0x48d36c(0x418)][_0x48d36c(0xdda)](_0x48d36c(0x40a));try{console[_0x48d36c(0x1081)](_0x48d36c(0x3d2));const _0x2b4ca8=_0x586d6a(_0x1d3b86),_0x534e58=await generateAndInjectWerewolfMemories(_0x2b4ca8);console[_0x48d36c(0x1081)](_0x48d36c(0xa0)+_0x534e58+_0x48d36c(0x1305));}catch(_0x365d97){console['error'](_0x48d36c(0x805),_0x365d97),_0x52ea9a&&(_0x52ea9a[_0x48d36c(0xc58)]+=_0x48d36c(0x852));}}function _0x580320(_0x6f86c3){const _0x5e9712=_0x5a7792;_0x1d3b86[_0x5e9712(0xb02)][_0x5e9712(0x13ee)]({'type':'system','content':_0x6f86c3,'timestamp':Date['now'](),'day':_0x1d3b86[_0x5e9712(0x443)]});}function _0x118d55(_0x59d557,_0x3df56f){const _0x43d657=_0x5a7792;_0x1d3b86[_0x43d657(0x5ed)][_0x43d657(0x13ee)]({'type':_0x43d657(0x344),'speaker':_0x59d557,'content':_0x3df56f,'timestamp':Date[_0x43d657(0x2b5)](),'day':_0x1d3b86[_0x43d657(0x443)]});}function _0x4356b1(_0x496a02){return new Promise(_0x2c3f93=>{const _0x3fe1d0=_0x2bd6,_0x58e56b=_0x3fe1d0(0xa22)+_0x496a02+_0x3fe1d0(0xb78),_0x2fa0c1=_0x3fe1d0(0xa22)+_0x496a02+_0x3fe1d0(0x21c);let _0x41ae70='';if(_0x496a02===_0x3fe1d0(0xd45))_0x41ae70=_0x3fe1d0(0x4c9);if(_0x496a02===_0x3fe1d0(0x355))_0x41ae70='confirm-hunter-shot-btn';if(_0x496a02===_0x3fe1d0(0xb61))_0x41ae70=_0x3fe1d0(0x442);const _0x1233d3=document[_0x3fe1d0(0x64f)](_0x58e56b),_0x489056=document['getElementById'](_0x2fa0c1),_0x13851d=document['getElementById'](_0x41ae70);_0x489056[_0x3fe1d0(0xc58)]='';let _0x355253=null;const _0x34f306=_0x1d3b86[_0x3fe1d0(0x119b)][_0x3fe1d0(0x156)](_0xcfd966=>_0xcfd966['isAlive']&&(_0x496a02==='hunter'||_0x496a02===_0x3fe1d0(0xb61)||_0xcfd966['id']!=='user'));_0x34f306[_0x3fe1d0(0x103)](_0x165a99=>{const _0x27d0ee=_0x3fe1d0,_0x5c2dab=document[_0x27d0ee(0x124e)](_0x27d0ee(0x479));_0x5c2dab[_0x27d0ee(0x87d)]=_0x27d0ee(0x6c6),_0x5c2dab['dataset']['id']=_0x165a99['id'],_0x5c2dab[_0x27d0ee(0xc58)]='<img\x20src=\x22'+_0x165a99['avatar']+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x165a99['name']+_0x27d0ee(0x120),_0x5c2dab['onclick']=()=>{const _0x124057=_0x27d0ee;_0x489056[_0x124057(0x233)](_0x124057(0x100))['forEach'](_0x100704=>_0x100704['classList'][_0x124057(0x1275)](_0x124057(0xbe6))),_0x5c2dab[_0x124057(0x418)][_0x124057(0xdda)]('selected'),_0x355253=_0x165a99['id'];},_0x489056[_0x27d0ee(0x99e)](_0x5c2dab);});const _0x416fd8=_0x13851d[_0x3fe1d0(0xc66)](!![]);_0x13851d[_0x3fe1d0(0x9be)]['replaceChild'](_0x416fd8,_0x13851d),_0x416fd8[_0x3fe1d0(0x113a)]=()=>{const _0x392c68=_0x3fe1d0;_0x355253?(_0x1233d3['classList'][_0x392c68(0x1275)](_0x392c68(0x40a)),_0x2c3f93(_0x355253)):alert(_0x392c68(0x50a));},_0x1233d3[_0x3fe1d0(0x418)][_0x3fe1d0(0xdda)]('visible');});}function _0x2165ec(){return new Promise(_0x303872=>{const _0xdc32b0=_0x2bd6,_0x5eb477=document[_0xdc32b0(0x64f)](_0xdc32b0(0x314)),_0x5dd1db=document[_0xdc32b0(0x64f)](_0xdc32b0(0x530)),_0x747729=document[_0xdc32b0(0x64f)](_0xdc32b0(0x77c)),_0x3a44df=_0x5eb477[_0xdc32b0(0x49c)](_0xdc32b0(0x631)),_0x28592e=_0x1d3b86[_0xdc32b0(0x119b)][_0xdc32b0(0x156)](_0x5c60e8=>_0x5c60e8['role']==='狼人'&&_0x5c60e8['isAlive']),_0x17074f=_0x28592e[_0xdc32b0(0x156)](_0x34e9d7=>_0x34e9d7['id']!==_0xdc32b0(0xa4d))[_0xdc32b0(0xb96)](_0x3cb191=>_0x3cb191[_0xdc32b0(0x6fc)])[_0xdc32b0(0xd22)]('、');_0x17074f?_0x3a44df[_0xdc32b0(0xc58)]=_0xdc32b0(0xf5c)+_0x17074f+_0xdc32b0(0xb2d):_0x3a44df[_0xdc32b0(0xee5)]='狼人请选择刀人对象';_0x5dd1db[_0xdc32b0(0xc58)]='';let _0x100343=null;const _0x303a57=_0x1d3b86['players']['filter'](_0x1f5f48=>_0x1f5f48[_0xdc32b0(0xef8)]&&_0x1f5f48[_0xdc32b0(0x931)]!=='狼人');_0x303a57[_0xdc32b0(0x103)](_0x2b4d40=>{const _0x4dfdd3=_0xdc32b0,_0x53ad17=document[_0x4dfdd3(0x124e)](_0x4dfdd3(0x479));_0x53ad17['className']=_0x4dfdd3(0x6c6),_0x53ad17['dataset']['id']=_0x2b4d40['id'],_0x53ad17[_0x4dfdd3(0xc58)]=_0x4dfdd3(0x86)+_0x2b4d40[_0x4dfdd3(0x1265)]+'\x22\x20class=\x22avatar\x22><span\x20class=\x22name\x22>'+_0x2b4d40[_0x4dfdd3(0x6fc)]+_0x4dfdd3(0x120),_0x53ad17['onclick']=()=>{const _0x2b2800=_0x4dfdd3;_0x5dd1db[_0x2b2800(0x233)]('.selected')[_0x2b2800(0x103)](_0x433dca=>_0x433dca['classList']['remove'](_0x2b2800(0xbe6))),_0x53ad17[_0x2b2800(0x418)][_0x2b2800(0xdda)]('selected'),_0x100343=_0x2b4d40['id'];},_0x5dd1db[_0x4dfdd3(0x99e)](_0x53ad17);});const _0x55783d=_0x747729[_0xdc32b0(0xc66)](!![]);_0x747729[_0xdc32b0(0x9be)]['replaceChild'](_0x55783d,_0x747729),_0x55783d['onclick']=()=>{const _0x15d924=_0xdc32b0;_0x100343?(_0x5eb477[_0x15d924(0x418)][_0x15d924(0x1275)]('visible'),_0x303872(_0x100343)):alert('请选择一个目标。');},_0x5eb477['classList'][_0xdc32b0(0xdda)]('visible');});}function _0x182846(){const _0x12ece5=_0x5a7792,_0x1a712e=_0x1d3b86[_0x12ece5(0x119b)][_0x12ece5(0x137)](_0x2fa658=>_0x2fa658['id']===_0x12ece5(0xa4d));if(!_0x1a712e||!_0x1a712e['isAlive'])return;const _0x256ff1=document[_0x12ece5(0x64f)]('werewolf-user-input'),_0x37e390=_0x256ff1['value']['trim']();_0x37e390&&(_0x118d55(_0x1a712e[_0x12ece5(0x6fc)],_0x37e390),_0x711d33()),document[_0x12ece5(0x64f)](_0x12ece5(0x1a7))[_0x12ece5(0x731)][_0x12ece5(0x130)]=_0x12ece5(0x1209),_0x256ff1['value']='',_0x176bda();}async function _0x44ae9a(){const _0x3b44a7=_0x5a7792;_0x580320(_0x3b44a7(0x1333)),_0x711d33();const _0x1dbad4=document[_0x3b44a7(0x64f)](_0x3b44a7(0x5bd));if(_0x1dbad4)_0x1dbad4[_0x3b44a7(0x1b0)]=!![];await _0x28974b(_0x3b44a7(0x96c),_0x3b44a7(0xf4));const {proxyUrl:_0x23b5a9,apiKey:_0x5df2a3,model:_0x2f6644}=_0x3e7a1b[_0x3b44a7(0xec0)];if(!_0x23b5a9||!_0x5df2a3||!_0x2f6644){alert(_0x3b44a7(0x524));return;}const _0x3d88d7=_0x389a51();try{let _0x2c186f=_0x23b5a9['includes'](_0x3b44a7(0x742)),_0x362eec=[{'role':_0x3b44a7(0xa4d),'content':_0x3b44a7(0xf8d)}],_0x4012d1=_0x250668(_0x2f6644,_0x5df2a3,_0x3d88d7,_0x362eec);const _0x56d22c=_0x2c186f?await fetch(_0x4012d1['url'],_0x4012d1[_0x3b44a7(0x88a)]):await fetch(_0x23b5a9+'/v1/chat/completions',{'method':_0x3b44a7(0x2d1),'headers':{'Content-Type':_0x3b44a7(0x7fe),'Authorization':_0x3b44a7(0x236)+_0x5df2a3},'body':JSON[_0x3b44a7(0xe3f)]({'model':_0x2f6644,'messages':[{'role':_0x3b44a7(0x905),'content':_0x3d88d7},..._0x362eec],'temperature':_0x3e7a1b[_0x3b44a7(0x11b4)][_0x3b44a7(0xa55)]||0.9})});if(!_0x56d22c['ok']){const _0x349815=await _0x56d22c[_0x3b44a7(0x6f8)]();throw new Error(_0x3b44a7(0x1fa)+_0x349815['error'][_0x3b44a7(0x854)]);}const _0x521b39=await _0x56d22c['json'](),_0x1b4ce9=getGeminiResponseText(_0x521b39),_0x5838a3=_0x1b4ce9[_0x3b44a7(0x132a)](/(\[[\s\S]*\])/);if(!_0x5838a3)throw new Error(_0x3b44a7(0x909)+_0x1b4ce9);const _0x176f30=JSON['parse'](_0x5838a3[0x0]);for(const _0x267619 of _0x176f30){_0x267619[_0x3b44a7(0xe2c)]&&_0x267619['dialogue']&&(_0x118d55(_0x267619[_0x3b44a7(0xe2c)],_0x267619[_0x3b44a7(0x344)]),_0x711d33(),await new Promise(_0x465ac8=>setTimeout(_0x465ac8,0x5dc+Math[_0x3b44a7(0x95f)]()*0x7d0)));}}catch(_0x571a0b){console[_0x3b44a7(0xc60)]('狼人杀AI回应生成失败:',_0x571a0b),await _0x28974b(_0x3b44a7(0xa14),_0x3b44a7(0xb70)+_0x571a0b[_0x3b44a7(0x854)]);}finally{if(_0x1dbad4)_0x1dbad4[_0x3b44a7(0x1b0)]=![];}}async function _0x30d4a5(){const _0x3672c1=_0x5a7792,_0x376fde=_0x1d3b86[_0x3672c1(0x119b)]['find'](_0x577199=>_0x577199['id']===_0x3672c1(0xa4d));if(!_0x376fde||!_0x376fde['isAlive']){console['warn'](_0x3672c1(0x12d6));return;}const _0x50512d=document[_0x3672c1(0x64f)](_0x3672c1(0x13bb)),_0xe4e1ab=_0x50512d[_0x3672c1(0xbed)]['trim']();if(!_0xe4e1ab){alert(_0x3672c1(0x1084));return;}_0x118d55(_0x376fde[_0x3672c1(0x6fc)],_0xe4e1ab),_0x711d33(),_0x50512d[_0x3672c1(0xbed)]='',await _0x28974b(_0x3672c1(0x96c),_0x3672c1(0x308));const {proxyUrl:_0x44a219,apiKey:_0x551b80,model:_0xe2f8d}=_0x3e7a1b[_0x3672c1(0xec0)];if(!_0x44a219||!_0x551b80||!_0xe2f8d){alert(_0x3672c1(0x524));return;}const _0x5d1cb1=_0x389a51();try{let _0x461aaa=_0x44a219['includes'](_0x3672c1(0x742)),_0x5c92c5=[{'role':_0x3672c1(0xa4d),'content':'现在，请所有AI角色针对刚刚的发言（特别是\x27'+_0x376fde['name']+_0x3672c1(0xb06)}],_0x1a37a8=_0x250668(_0xe2f8d,_0x551b80,_0x5d1cb1,_0x5c92c5);const _0xe783fe=_0x461aaa?await fetch(_0x1a37a8[_0x3672c1(0xe52)],_0x1a37a8[_0x3672c1(0x88a)]):await fetch(_0x44a219+_0x3672c1(0x58b),{'method':_0x3672c1(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0x3672c1(0x236)+_0x551b80},'body':JSON[_0x3672c1(0xe3f)]({'model':_0xe2f8d,'messages':[{'role':_0x3672c1(0x905),'content':_0x5d1cb1},..._0x5c92c5],'temperature':_0x3e7a1b[_0x3672c1(0x11b4)][_0x3672c1(0xa55)]||0.9})});if(!_0xe783fe['ok']){const _0x4f1ceb=await _0xe783fe[_0x3672c1(0x6f8)]();throw new Error(_0x3672c1(0x1fa)+_0x4f1ceb[_0x3672c1(0xc60)][_0x3672c1(0x854)]);}const _0x2d1025=await _0xe783fe[_0x3672c1(0x6f8)](),_0x5c61d6=getGeminiResponseText(_0x2d1025);let _0x364688;try{let _0x23e891=_0x5c61d6['replace'](/^```json\s*/,'')[_0x3672c1(0x137f)](/```$/,'')[_0x3672c1(0x43a)]();const _0x2e6561=_0x23e891[_0x3672c1(0xac7)]('['),_0x4db31b=_0x23e891['lastIndexOf'](']');if(_0x2e6561===-0x1||_0x4db31b===-0x1||_0x4db31b<_0x2e6561)throw new Error('AI返回的内容中未找到有效的JSON数组结构\x20(`[...]`)。');const _0x54bba2=_0x23e891[_0x3672c1(0x126f)](_0x2e6561,_0x4db31b+0x1);_0x364688=JSON[_0x3672c1(0x1214)](_0x54bba2);}catch(_0x58c335){if(_0x58c335[_0x3672c1(0x854)][_0x3672c1(0xe53)](_0x3672c1(0x98f))){console[_0x3672c1(0x1155)](_0x3672c1(0xb7f));const _0x50f3ee=_0x3e8f81=>{const _0x32a3ac=_0x3672c1;let _0x4503c1=![],_0x3930ac=![],_0x172a47='';for(let _0x31c936=0x0;_0x31c936<_0x3e8f81['length'];_0x31c936++){const _0x3e0cbe=_0x3e8f81[_0x31c936];if(_0x3930ac){_0x172a47+=_0x3e0cbe,_0x3930ac=![];continue;}if(_0x3e0cbe==='\x5c'){_0x172a47+=_0x3e0cbe,_0x3930ac=!![];continue;}if(_0x3e0cbe==='\x22'){_0x172a47+=_0x3e0cbe,_0x4503c1=!_0x4503c1;continue;}if(_0x4503c1){if(_0x3e0cbe==='\x0a')_0x172a47+='\x5cn';else{if(_0x3e0cbe==='\x0d')_0x172a47+='\x5cr';else{if(_0x3e0cbe==='\x09')_0x172a47+='\x5ct';else{if(_0x3e0cbe[_0x32a3ac(0x150)](0x0)<0x20)continue;else _0x172a47+=_0x3e0cbe;}}}}else _0x172a47+=_0x3e0cbe;}return _0x172a47;};let _0x2201ca=_0x5c61d6['replace'](/^```json\s*/,'')['replace'](/```$/,'')[_0x3672c1(0x43a)]();const _0x960b98=_0x50f3ee(_0x2201ca),_0x52154b=_0x960b98[_0x3672c1(0x132a)](/(\[[\s\S]*\])/);if(!_0x52154b)throw new Error(_0x3672c1(0x4ae));_0x364688=JSON[_0x3672c1(0x1214)](_0x52154b[0x0]);}else throw new Error(_0x3672c1(0xc8c)+_0x58c335[_0x3672c1(0x854)]+_0x3672c1(0xa91)+_0x5c61d6);}for(const _0x53e7f5 of _0x364688){_0x53e7f5['speaker_name']&&_0x53e7f5['dialogue']&&(_0x118d55(_0x53e7f5['speaker_name'],_0x53e7f5[_0x3672c1(0x344)]),_0x711d33(),await new Promise(_0x8ef43a=>setTimeout(_0x8ef43a,0x5dc+Math[_0x3672c1(0x95f)]()*0x7d0)));}}catch(_0x43a400){console['error'](_0x3672c1(0x101e),_0x43a400),await _0x28974b('AI\x20发言失败','错误:\x20'+_0x43a400['message']);}}async function _0x176bda(){const _0x20d0a0=_0x5a7792;_0x580320(_0x20d0a0(0x2ea)),_0x711d33(),_0x1d3b86[_0x20d0a0(0x9ad)]={};let _0x91ba79=null;_0x1d3b86[_0x20d0a0(0x11aa)]=_0x20d0a0(0x503);try{_0x91ba79=await _0xf6c7ce(),_0x91ba79&&_0x91ba79[_0x20d0a0(0x103)](_0x2b5ff1=>{const _0x1987be=_0x20d0a0,_0x5e9d09=_0x1d3b86['players'][_0x1987be(0x137)](_0x2d92ed=>_0x2d92ed['name']===_0x2b5ff1[_0x1987be(0x1092)]),_0x42533a=_0x1d3b86[_0x1987be(0x119b)][_0x1987be(0x137)](_0x2ceac0=>_0x2ceac0[_0x1987be(0x6fc)]===_0x2b5ff1[_0x1987be(0xd65)]);_0x5e9d09&&_0x5e9d09[_0x1987be(0xef8)]&&_0x42533a&&(_0x1d3b86[_0x1987be(0x9ad)][_0x5e9d09['name']]=_0x42533a[_0x1987be(0x6fc)]);}),_0x1d3b86[_0x20d0a0(0x11aa)]=null;}catch(_0xe796f3){console[_0x20d0a0(0xc60)](_0x20d0a0(0x55d),_0xe796f3),await _0x28974b('操作失败',_0x20d0a0(0xaa6)+_0xe796f3[_0x20d0a0(0x854)]),document['getElementById'](_0x20d0a0(0x749))[_0x20d0a0(0x731)][_0x20d0a0(0x130)]='block';return;}const _0xa30c04=_0x1d3b86[_0x20d0a0(0x119b)]['find'](_0x3cf660=>_0x3cf660['id']===_0x20d0a0(0xa4d));if(_0xa30c04&&_0xa30c04[_0x20d0a0(0xef8)]){_0x580320(_0x20d0a0(0x66c)),_0x711d33();const _0x37ab71=await _0x4356b1('vote'),_0x258f0d=_0x1d3b86[_0x20d0a0(0x119b)][_0x20d0a0(0x137)](_0x3388c4=>_0x3388c4['id']===_0x37ab71);_0x258f0d&&(_0x1d3b86[_0x20d0a0(0x9ad)][_0xa30c04[_0x20d0a0(0x6fc)]]=_0x258f0d[_0x20d0a0(0x6fc)]);}_0x34751a();}async function _0xf6c7ce(){const _0x34a216=_0x5a7792,{proxyUrl:_0x2ddb11,apiKey:_0x3a6b3c,model:_0x5966dd}=_0x3e7a1b[_0x34a216(0xec0)];if(!_0x2ddb11||!_0x3a6b3c||!_0x5966dd)return null;const _0x3b4441=_0x1d3b86[_0x34a216(0x119b)][_0x34a216(0x156)](_0x5f100a=>_0x5f100a[_0x34a216(0xef8)]&&_0x5f100a['id']!=='user'),_0x52674b=_0x1d3b86[_0x34a216(0x119b)][_0x34a216(0x156)](_0x4f6430=>_0x4f6430[_0x34a216(0xef8)])[_0x34a216(0xb96)](_0x3fe881=>_0x3fe881['name']);let _0x55e397=_0x389a51();_0x55e397+=_0x34a216(0x5cb)+_0x52674b['join'](',\x20')+_0x34a216(0x329);try{let _0x334cdb=_0x2ddb11['includes']('generativelanguage'),_0x129047=[{'role':_0x34a216(0xa4d),'content':'请所有AI角色开始投票。'}],_0x541e32=_0x250668(_0x5966dd,_0x3a6b3c,_0x55e397,_0x129047);const _0x59fcf5=_0x334cdb?await fetch(_0x541e32[_0x34a216(0xe52)],_0x541e32[_0x34a216(0x88a)]):await fetch(_0x2ddb11+_0x34a216(0x58b),{'method':_0x34a216(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0x34a216(0x236)+_0x3a6b3c},'body':JSON[_0x34a216(0xe3f)]({'model':_0x5966dd,'messages':[{'role':'system','content':_0x55e397},..._0x129047],'temperature':_0x3e7a1b['globalSettings'][_0x34a216(0xa55)]||0.8})});if(!_0x59fcf5['ok'])throw new Error((await _0x59fcf5[_0x34a216(0x6f8)]())[_0x34a216(0xc60)][_0x34a216(0x854)]);const _0x1469b5=await _0x59fcf5['json'](),_0x38d668=getGeminiResponseText(_0x1469b5);let _0x1df7e7=_0x38d668['replace'](/^```json\s*/,'')[_0x34a216(0x137f)](/```$/,'')[_0x34a216(0x43a)]();const _0x11afd5=_0x1df7e7[_0x34a216(0xac7)]('['),_0x1af053=_0x1df7e7[_0x34a216(0x6e1)](']');if(_0x11afd5===-0x1||_0x1af053===-0x1||_0x1af053<_0x11afd5)throw new Error(_0x34a216(0x1003));const _0x46c315=_0x1df7e7[_0x34a216(0x126f)](_0x11afd5,_0x1af053+0x1);try{const _0xfd4658=_0x46c315[_0x34a216(0x132a)](/(\[[\s\S]*?\])/g);if(_0xfd4658&&_0xfd4658['length']>0x0)return JSON[_0x34a216(0x1214)](_0xfd4658[_0xfd4658[_0x34a216(0x40f)]-0x1]);return JSON['parse'](_0x46c315);}catch(_0x23d60d){throw new Error('解析AI返回的投票JSON时出错:\x20'+_0x23d60d[_0x34a216(0x854)]+_0x34a216(0xa91)+_0x38d668);}}catch(_0x4c3bdc){console['error']('获取AI投票失败:',_0x4c3bdc);throw new Error(_0x34a216(0x937)+_0x4c3bdc[_0x34a216(0x854)]);}}function _0x34751a(){const _0x69148=_0x5a7792,_0x1ced88={},_0x3e8f96={};for(const _0x53f437 in _0x1d3b86[_0x69148(0x9ad)]){const _0x31fbed=_0x1d3b86['votes'][_0x53f437];_0x1ced88[_0x31fbed]=(_0x1ced88[_0x31fbed]||0x0)+0x1,!_0x3e8f96[_0x31fbed]&&(_0x3e8f96[_0x31fbed]=[]),_0x3e8f96[_0x31fbed][_0x69148(0x13ee)](_0x53f437);}let _0x13824c=0x0,_0x4f2597=[];for(const _0x6fcd71 in _0x1ced88){const _0x49fd38=_0x1ced88[_0x6fcd71];if(_0x49fd38>_0x13824c)_0x13824c=_0x49fd38,_0x4f2597=[_0x6fcd71];else _0x49fd38===_0x13824c&&_0x4f2597[_0x69148(0x13ee)](_0x6fcd71);}_0x580320(_0x69148(0xcb7));for(const _0x8e8f46 in _0x3e8f96){_0x580320(_0x8e8f46+'\x20('+_0x3e8f96[_0x8e8f46][_0x69148(0x40f)]+_0x69148(0xd9)+_0x3e8f96[_0x8e8f46][_0x69148(0xd22)]('、\x20'));}if(_0x4f2597[_0x69148(0x40f)]===0x1&&_0x13824c>0x0){const _0x265b5a=_0x1d3b86[_0x69148(0x119b)][_0x69148(0x137)](_0xb0f507=>_0xb0f507[_0x69148(0x6fc)]===_0x4f2597[0x0]);if(_0x265b5a){_0x265b5a['isAlive']=![],_0x580320(_0x265b5a[_0x69148(0x6fc)]+_0x69148(0xe61));if(_0x265b5a[_0x69148(0x931)]==='猎人'){}}}else _0x580320(_0x69148(0x540));_0x711d33();if(_0x546955())return;_0x1d3b86['currentDay']++,_0x3cd250();}async function _0x4f7800(){const _0x2f397e=_0x5a7792,{proxyUrl:_0x32d479,apiKey:_0x271486,model:_0x2cda03}=_0x3e7a1b['apiConfig'];if(!_0x32d479||!_0x271486||!_0x2cda03)return null;const _0x27a1fb=_0x1d3b86[_0x2f397e(0x119b)][_0x2f397e(0x156)](_0x4af5ea=>_0x4af5ea[_0x2f397e(0x931)]==='狼人'&&_0x4af5ea[_0x2f397e(0xef8)]),_0xcb2443=_0x1d3b86[_0x2f397e(0x119b)]['filter'](_0x24094f=>_0x24094f[_0x2f397e(0xef8)]&&_0x24094f[_0x2f397e(0x931)]!=='狼人'),_0x302da1=_0x2f397e(0x782)+_0x27a1fb[_0x2f397e(0xb96)](_0x2a305f=>_0x2a305f[_0x2f397e(0x6fc)])[_0x2f397e(0xd22)]('、\x20')+'\x0a-\x20**可以刀的玩家列表**:\x20'+_0xcb2443[_0x2f397e(0xb96)](_0x21737f=>_0x21737f[_0x2f397e(0x6fc)])[_0x2f397e(0xd22)]('、\x20')+_0x2f397e(0x96e)+_0x1d3b86[_0x2f397e(0x5ed)][_0x2f397e(0xb96)](_0x744ad8=>_0x744ad8[_0x2f397e(0xf10)]+':\x20'+_0x744ad8[_0x2f397e(0x3ba)])[_0x2f397e(0xd22)]('\x0a')+'\x0a\x0a现在，请做出你的决定。';try{let _0x3fde68=_0x32d479[_0x2f397e(0xe53)](_0x2f397e(0x742)),_0xa13108=[{'role':'user','content':_0x2f397e(0x894)}],_0x20d3d9=_0x250668(_0x2cda03,_0x271486,_0x302da1,_0xa13108);const _0x559dda=_0x3fde68?await fetch(_0x20d3d9[_0x2f397e(0xe52)],_0x20d3d9['data']):await fetch(_0x32d479+_0x2f397e(0x58b),{'method':_0x2f397e(0x2d1),'headers':{'Content-Type':'application/json','Authorization':_0x2f397e(0x236)+_0x271486},'body':JSON['stringify']({'model':_0x2cda03,'messages':[{'role':'system','content':_0x302da1},..._0xa13108],'temperature':_0x3e7a1b[_0x2f397e(0x11b4)][_0x2f397e(0xa55)]||0.8})});if(!_0x559dda['ok'])throw new Error((await _0x559dda[_0x2f397e(0x6f8)]())['error'][_0x2f397e(0x854)]);const _0x3a2e42=await _0x559dda['json'](),_0xa30516=getGeminiResponseText(_0x3a2e42),_0x45965f=_0xa30516['match'](/({[\s\S]*})/);if(!_0x45965f)throw new Error(_0x2f397e(0xd51));const _0x2e4fd5=JSON[_0x2f397e(0x1214)](_0x45965f[0x0]),_0x4a0cf8=_0x1d3b86[_0x2f397e(0x119b)]['find'](_0x545320=>_0x545320[_0x2f397e(0x6fc)]===_0x2e4fd5[_0x2f397e(0x53e)]);return _0x4a0cf8?_0x4a0cf8['id']:null;}catch(_0x39fd9b){return console['error'](_0x2f397e(0xfbf),_0x39fd9b),_0xcb2443[Math[_0x2f397e(0x1245)](Math[_0x2f397e(0x95f)]()*_0xcb2443[_0x2f397e(0x40f)])]['id'];}}function _0x339077(_0x1c2ef7,_0x5a2a53){return new Promise(_0x2c3152=>{const _0x175fb4=_0x2bd6,_0x592c4c=document[_0x175fb4(0x64f)](_0x175fb4(0x932)),_0x2e796b=document[_0x175fb4(0x64f)](_0x175fb4(0xb6d)),_0x22d17e=document['getElementById'](_0x175fb4(0xb05)),_0x2616f6=document[_0x175fb4(0x64f)](_0x175fb4(0x790)),_0x196587=document[_0x175fb4(0x64f)](_0x175fb4(0x3dc));_0x2e796b[_0x175fb4(0xc58)]='';const _0x1da885=_0x2616f6[_0x175fb4(0xc66)](!![]);_0x2616f6[_0x175fb4(0x9be)][_0x175fb4(0x3d4)](_0x1da885,_0x2616f6);const _0x13a2af=_0x196587['cloneNode'](!![]);_0x196587[_0x175fb4(0x9be)][_0x175fb4(0x3d4)](_0x13a2af,_0x196587),_0x1da885[_0x175fb4(0x731)]['display']=_0x175fb4(0xb37),_0x1da885[_0x175fb4(0x1b0)]=!![];let _0x2c7d25={'save':![],'poison':null},_0x2018e8=null;if(_0x1c2ef7&&!_0x5a2a53[_0x175fb4(0x19b)]){_0x22d17e[_0x175fb4(0xee5)]='昨晚\x20'+_0x1c2ef7[_0x175fb4(0x6fc)]+_0x175fb4(0x87);const _0x8556a4=document['createElement'](_0x175fb4(0xcd));_0x8556a4[_0x175fb4(0x87d)]=_0x175fb4(0x130b),_0x8556a4[_0x175fb4(0xee5)]='使用解药救TA',_0x8556a4[_0x175fb4(0x731)][_0x175fb4(0xcf0)]=_0x175fb4(0x8fe),_0x8556a4[_0x175fb4(0x113a)]=()=>{const _0x20cd08=_0x175fb4;_0x2c7d25[_0x20cd08(0xe5d)]=!![],_0x592c4c[_0x20cd08(0x418)][_0x20cd08(0x1275)](_0x20cd08(0x40a)),_0x2c3152(_0x2c7d25);},_0x2e796b['appendChild'](_0x8556a4);}else _0x1c2ef7?_0x22d17e[_0x175fb4(0xee5)]=_0x175fb4(0x1007)+_0x1c2ef7[_0x175fb4(0x6fc)]+_0x175fb4(0xbb5):_0x22d17e[_0x175fb4(0xee5)]=_0x175fb4(0x961);if(!_0x5a2a53['poisonUsed']){const _0x5c91b2=document[_0x175fb4(0x124e)]('p');_0x5c91b2[_0x175fb4(0xee5)]=_0x175fb4(0x84d),_0x5c91b2[_0x175fb4(0x731)][_0x175fb4(0x12be)]=_0x175fb4(0x7bd),_0x5c91b2[_0x175fb4(0x731)][_0x175fb4(0x57d)]=_0x175fb4(0x8fe),_0x2e796b['appendChild'](_0x5c91b2);const _0x18b694=_0x1d3b86[_0x175fb4(0x119b)][_0x175fb4(0x156)](_0x3f6ad0=>_0x3f6ad0[_0x175fb4(0xef8)]&&_0x3f6ad0['id']!==_0x1c2ef7?.['id']);_0x18b694['forEach'](_0x3740c1=>{const _0x51e9dd=_0x175fb4,_0x56b86e=document[_0x51e9dd(0x124e)](_0x51e9dd(0x479));_0x56b86e[_0x51e9dd(0x87d)]='werewolf-selection-item',_0x56b86e[_0x51e9dd(0x12e1)]['id']=_0x3740c1['id'],_0x56b86e[_0x51e9dd(0xc58)]=_0x51e9dd(0x86)+_0x3740c1[_0x51e9dd(0x1265)]+_0x51e9dd(0x43d)+_0x3740c1['name']+_0x51e9dd(0x120),_0x56b86e['onclick']=()=>{const _0x36d504=_0x51e9dd;_0x2e796b['querySelectorAll'](_0x36d504(0x100))[_0x36d504(0x103)](_0x26faa7=>_0x26faa7[_0x36d504(0x418)][_0x36d504(0x1275)]('selected')),_0x56b86e[_0x36d504(0x418)]['add']('selected'),_0x2018e8=_0x3740c1['id'],_0x1da885[_0x36d504(0x1b0)]=![];},_0x2e796b['appendChild'](_0x56b86e);});}_0x1da885['onclick']=()=>{const _0x276d1f=_0x175fb4;_0x2018e8&&(_0x2c7d25[_0x276d1f(0xc68)]=_0x2018e8,_0x592c4c['classList']['remove']('visible'),_0x2c3152(_0x2c7d25));},_0x13a2af[_0x175fb4(0x113a)]=()=>{const _0xe417a4=_0x175fb4;_0x592c4c['classList'][_0xe417a4(0x1275)](_0xe417a4(0x40a)),_0x2c3152(_0x2c7d25);},_0x592c4c[_0x175fb4(0x418)][_0x175fb4(0xdda)](_0x175fb4(0x40a));});}async function _0x3bd139(){const _0xab0e6b=_0x5a7792,_0x5e0a04=_0x1d3b86[_0xab0e6b(0x11aa)];if(!_0x5e0a04)return;document[_0xab0e6b(0x64f)](_0xab0e6b(0x749))[_0xab0e6b(0x731)][_0xab0e6b(0x130)]='none',await _0x28974b('请稍候...',_0xab0e6b(0x1184)+_0x5e0a04+'\x22操作...');switch(_0x5e0a04){case _0xab0e6b(0x3b0):await _0x3cd250();break;case _0xab0e6b(0x2aa):await _0x53f30b();break;case _0xab0e6b(0x503):await _0x176bda();break;}}function _0x546955(){const _0x501b5b=_0x5a7792,_0x171dd8=_0x1d3b86[_0x501b5b(0x119b)][_0x501b5b(0x156)](_0x5252f2=>_0x5252f2['isAlive']),_0x4f184d=_0x171dd8[_0x501b5b(0x156)](_0x551f2d=>_0x551f2d[_0x501b5b(0x931)]==='狼人'),_0x49b408=_0x171dd8[_0x501b5b(0x156)](_0x24eb6d=>['预言家','女巫','猎人','守卫']['includes'](_0x24eb6d[_0x501b5b(0x931)])),_0x422b1e=_0x171dd8[_0x501b5b(0x156)](_0x41807a=>_0x41807a[_0x501b5b(0x931)]==='平民');let _0x5ab6d4=null;if(_0x4f184d[_0x501b5b(0x40f)]===0x0)_0x5ab6d4='好人';else{if(_0x4f184d[_0x501b5b(0x40f)]>=_0x49b408[_0x501b5b(0x40f)]+_0x422b1e['length'])_0x5ab6d4='狼人';else _0x1d3b86[_0x501b5b(0x1331)]==='12p'?(_0x49b408[_0x501b5b(0x40f)]===0x0||_0x422b1e[_0x501b5b(0x40f)]===0x0)&&(_0x5ab6d4='狼人'):_0x49b408[_0x501b5b(0x40f)]===0x0&&_0x422b1e[_0x501b5b(0x40f)]===0x0&&(_0x5ab6d4='狼人');}if(_0x5ab6d4)return _0x202bde(_0x5ab6d4),!![];return![];}async function _0x2a38e0(){const _0x13d135=_0x5a7792,_0x422fc2=await _0x54149f(_0x13d135(0x12fe),_0x13d135(0x52e),{'confirmText':_0x13d135(0x8ea)});if(!_0x422fc2)return;await _0x28974b(_0x13d135(0x2f7),'正在扫描和修复数据...');try{const _0x1ed46d=await _0x4e1bbf[_0x13d135(0x999)][_0x13d135(0x78f)]();let _0x377dc6=0x0;for(const _0x5b9b9a of _0x1ed46d){let _0x566e89=![];!Array[_0x13d135(0x97e)](_0x5b9b9a[_0x13d135(0x830)])&&(_0x5b9b9a[_0x13d135(0x830)]=[],_0x566e89=!![]),(typeof _0x5b9b9a[_0x13d135(0xcb3)]!=='object'||_0x5b9b9a[_0x13d135(0xcb3)]===null)&&(_0x5b9b9a[_0x13d135(0xcb3)]={},_0x566e89=!![]),!_0x5b9b9a[_0x13d135(0x1167)]&&!_0x5b9b9a['originalName']&&(_0x5b9b9a[_0x13d135(0x7de)]=_0x5b9b9a[_0x13d135(0x6fc)],_0x566e89=!![]),typeof _0x5b9b9a[_0x13d135(0x13c0)]===_0x13d135(0x3a3)&&(_0x5b9b9a[_0x13d135(0x13c0)]=0x0,_0x566e89=!![]),!Array[_0x13d135(0x97e)](_0x5b9b9a[_0x13d135(0x518)])&&(_0x5b9b9a[_0x13d135(0x518)]=[],_0x566e89=!![]),_0x566e89&&(_0x377dc6++,console[_0x13d135(0x1081)](_0x13d135(0x120d)+_0x5b9b9a['name']+_0x13d135(0x12d)+_0x5b9b9a['id']+_0x13d135(0x672)),await _0x4e1bbf[_0x13d135(0x999)]['put'](_0x5b9b9a)),_0x3e7a1b[_0x13d135(0x999)][_0x5b9b9a['id']]=_0x5b9b9a;}_0x377dc6>0x0?(await _0x28974b(_0x13d135(0xabc),'成功检查并修复了\x20'+_0x377dc6+'\x20个角色的数据问题！\x0a\x0a聊天列表已为您刷新。'),await _0x21f6ea()):await _0x28974b(_0x13d135(0x10f4),'未发现任何需要修复的数据问题。');}catch(_0x37f0f2){console[_0x13d135(0xc60)]('数据检查与修复失败:',_0x37f0f2),await _0x28974b(_0x13d135(0x5b1),_0x13d135(0x58e)+_0x37f0f2['message']);}}function _0x429707(_0xc089fe,_0x28df4f=_0x5a7792(0x4ed)){const _0x154290=_0x5a7792;if(_0xc089fe[_0x154290(0x49c)](_0x154290(0xd27)))return;const _0x366bdb=document[_0x154290(0x124e)](_0x154290(0x479));_0x366bdb['className']=_0x154290(0xf0),_0x366bdb['innerHTML']=_0x154290(0xbc2),_0x28df4f===_0x154290(0x8da)?_0xc089fe['appendChild'](_0x366bdb):_0xc089fe[_0x154290(0x7f5)](_0x366bdb);}function _0x23b212(_0x20ab18){const _0x4497c6=_0x5a7792,_0x2ef37f=_0x20ab18[_0x4497c6(0x49c)](_0x4497c6(0xd27));_0x2ef37f&&_0x2ef37f['remove']();}async function _0x202980(){const _0x3a4091=_0x5a7792,_0x235bcc=document['getElementById'](_0x3a4091(0x18a)),_0x3a82f2=document[_0x3a4091(0x64f)](_0x3a4091(0x622)),_0x335128=document['getElementById'](_0x3a4091(0x3c3));_0x3a82f2[_0x3a4091(0xc58)]='',_0x335128[_0x3a4091(0xf1d)]=![];const _0x3557ff=await _0x4e1bbf[_0x3a4091(0x144)]['toArray']();_0x3557ff['length']===0x0?_0x3a82f2['innerHTML']=_0x3a4091(0x1177):_0x3557ff[_0x3a4091(0x103)](_0x4369f6=>{const _0x18a35d=_0x3a4091,_0x1dab88=document['createElement'](_0x18a35d(0x479));_0x1dab88[_0x18a35d(0x87d)]='clear-posts-item',_0x1dab88[_0x18a35d(0x12e1)][_0x18a35d(0xa06)]=_0x4369f6['id'],_0x1dab88[_0x18a35d(0xc58)]=_0x18a35d(0xda5)+_0x4369f6['name']+_0x18a35d(0xd3b),_0x3a82f2[_0x18a35d(0x99e)](_0x1dab88);}),_0x235bcc[_0x3a4091(0x418)][_0x3a4091(0xdda)](_0x3a4091(0x40a));}async function _0x85ed18(){const _0x35c963=_0x5a7792,_0x33fcb9=document['querySelectorAll'](_0x35c963(0x249));if(_0x33fcb9['length']===0x0){alert(_0x35c963(0xf0e));return;}const _0x562101=Array[_0x35c963(0xb3a)](_0x33fcb9)[_0x35c963(0xb96)](_0x5c66b4=>_0x5c66b4[_0x35c963(0x12e1)][_0x35c963(0xa06)]),_0x435c59=await _0x54149f('最后确认！',_0x35c963(0x1105)+_0x33fcb9[_0x35c963(0x40f)]+'\x20本世界书，并解除它们与所有角色的关联。此操作【不可恢复】！',{'confirmButtonClass':'btn-danger','confirmText':_0x35c963(0x13d2)});if(!_0x435c59)return;await _0x28974b(_0x35c963(0x2f7),_0x35c963(0x107d));try{await _0x4e1bbf['transaction']('rw',_0x4e1bbf[_0x35c963(0x144)],_0x4e1bbf[_0x35c963(0x999)],async()=>{const _0x5dc1a8=_0x35c963;await _0x4e1bbf[_0x5dc1a8(0x144)][_0x5dc1a8(0x303)](_0x562101);const _0x45a0bc=await _0x4e1bbf[_0x5dc1a8(0x999)]['toArray']();for(const _0x1f6a1d of _0x45a0bc){if(_0x1f6a1d[_0x5dc1a8(0xcb3)]&&Array['isArray'](_0x1f6a1d[_0x5dc1a8(0xcb3)][_0x5dc1a8(0xde4)])){const _0xc70c5e=_0x1f6a1d['settings'][_0x5dc1a8(0xde4)][_0x5dc1a8(0x40f)];_0x1f6a1d[_0x5dc1a8(0xcb3)][_0x5dc1a8(0xde4)]=_0x1f6a1d[_0x5dc1a8(0xcb3)]['linkedWorldBookIds']['filter'](_0x2f6a17=>!_0x562101[_0x5dc1a8(0xe53)](_0x2f6a17)),_0x1f6a1d[_0x5dc1a8(0xcb3)][_0x5dc1a8(0xde4)][_0x5dc1a8(0x40f)]<_0xc70c5e&&await _0x4e1bbf[_0x5dc1a8(0x999)][_0x5dc1a8(0x4fa)](_0x1f6a1d);}}}),_0x3e7a1b[_0x35c963(0x144)]=_0x3e7a1b[_0x35c963(0x144)]['filter'](_0x3e56cc=>!_0x562101[_0x35c963(0xe53)](_0x3e56cc['id'])),document[_0x35c963(0x64f)](_0x35c963(0x18a))[_0x35c963(0x418)][_0x35c963(0x1275)](_0x35c963(0x40a)),await _0x28974b(_0x35c963(0x121d),_0x33fcb9['length']+'\x20本世界书已成功删除。');}catch(_0x2e1950){console['error'](_0x35c963(0x114d),_0x2e1950),await _0x28974b(_0x35c963(0x8fb),'操作失败:\x20'+_0x2e1950['message']);}}function _0x47d29c(){const _0x1b5252=_0x5a7792;if(!_0x3e7a1b['activeChatId'])return;const _0x2a3c13=_0x3e7a1b['activeChatId'],_0x49df6c=document[_0x1b5252(0x64f)](_0x1b5252(0x322)),_0x3679aa=document[_0x1b5252(0x64f)](_0x1b5252(0x44b)),_0x37befb=document[_0x1b5252(0x64f)]('reading-restore-btn');let _0x5244d0=_0x2b4d16[_0x2a3c13];if(_0x5244d0&&_0x5244d0['isActive']){_0x5244d0[_0x1b5252(0x77d)]&&_0x1d3f0d();_0x49df6c[_0x1b5252(0x731)][_0x1b5252(0x130)]=_0x1b5252(0x1026);return;}_0x25349a(_0x2a3c13),_0x40ef2f(_0x2a3c13),_0x49df6c[_0x1b5252(0x731)][_0x1b5252(0x130)]=_0x1b5252(0x1026),_0x3679aa[_0x1b5252(0x418)][_0x1b5252(0x1275)](_0x1b5252(0x8dd)),_0x37befb[_0x1b5252(0x731)][_0x1b5252(0x130)]=_0x1b5252(0x1209);const _0x5c09ce=document[_0x1b5252(0x64f)]('phone-screen'),_0x549ec1=_0x3679aa[_0x1b5252(0x528)](),_0x445e06=(_0x5c09ce['clientHeight']-_0x549ec1[_0x1b5252(0x877)])/0x2,_0x66a04b=(_0x5c09ce['clientWidth']-_0x549ec1['width'])/0x2;_0x3679aa[_0x1b5252(0x731)]['top']=_0x445e06+'px',_0x3679aa['style']['left']=_0x66a04b+'px',_0x3679aa[_0x1b5252(0x731)][_0x1b5252(0x70b)]='';}function _0x25349a(_0x410ba2){const _0x50a95d=_0x5a7792;_0x2b4d16[_0x410ba2]={'isActive':!![],'isMinimized':![],'title':_0x50a95d(0xd26),'contentLines':[],'currentPage':0x0,'totalPages':0x0,'linesPerPage':0xf,'currentSnippet':''};}function _0xd3a24a(){const _0x44008a=_0x5a7792,_0x46f4c7=_0x3e7a1b[_0x44008a(0x777)];if(!_0x46f4c7||!_0x2b4d16[_0x46f4c7]||!_0x2b4d16[_0x46f4c7][_0x44008a(0xb30)])return;document['getElementById'](_0x44008a(0x322))['style'][_0x44008a(0x130)]=_0x44008a(0x1209),document[_0x44008a(0x64f)](_0x44008a(0x12bd))[_0x44008a(0x731)][_0x44008a(0x130)]=_0x44008a(0x1209),document[_0x44008a(0x64f)](_0x44008a(0x44b))[_0x44008a(0x418)][_0x44008a(0x1275)](_0x44008a(0x8dd)),_0x2b4d16[_0x46f4c7][_0x44008a(0xb30)]=![],console[_0x44008a(0x1081)](_0x44008a(0x822));}function _0x30cf74(){const _0x2d39ff=_0x5a7792,_0x23f6ae=_0x2b4d16[_0x3e7a1b[_0x2d39ff(0x777)]];if(!_0x23f6ae||!_0x23f6ae[_0x2d39ff(0xb30)]||_0x23f6ae[_0x2d39ff(0x77d)])return;_0x23f6ae[_0x2d39ff(0x77d)]=!![],document[_0x2d39ff(0x64f)](_0x2d39ff(0x44b))[_0x2d39ff(0x418)][_0x2d39ff(0xdda)](_0x2d39ff(0x8dd)),document[_0x2d39ff(0x64f)]('reading-restore-btn')[_0x2d39ff(0x731)][_0x2d39ff(0x130)]=_0x2d39ff(0x1026);}function _0x1d3f0d(){const _0x14a59d=_0x5a7792,_0x4a44ae=_0x2b4d16[_0x3e7a1b[_0x14a59d(0x777)]];if(!_0x4a44ae||!_0x4a44ae[_0x14a59d(0xb30)]||!_0x4a44ae[_0x14a59d(0x77d)])return;_0x4a44ae[_0x14a59d(0x77d)]=![],document[_0x14a59d(0x64f)]('reading-restore-btn')[_0x14a59d(0x731)][_0x14a59d(0x130)]='none',document[_0x14a59d(0x64f)](_0x14a59d(0x44b))[_0x14a59d(0x418)][_0x14a59d(0x1275)]('minimized');}function _0x5acbeb(_0x42ffab,_0xdf436d){const _0x468908=_0x5a7792;let _0x9c1b7c=0x0,_0x3c6533=0x0,_0x2edfe5=0x0,_0x261d03=0x0;const _0x543790=document[_0x468908(0x64f)]('phone-screen'),_0x23dba6=_0x9e52c=>{const _0x319eca=_0x468908;if(_0x9e52c[_0x319eca(0xf5b)][_0x319eca(0x2fc)](_0x319eca(0xcd)))return;if(_0x42ffab[_0x319eca(0x731)]['transform']){const _0x25126d=_0x42ffab['getBoundingClientRect'](),_0x27230a=_0x42ffab[_0x319eca(0x2ed)]['getBoundingClientRect']();_0x42ffab[_0x319eca(0x731)][_0x319eca(0x4ed)]=_0x25126d[_0x319eca(0x4ed)]-_0x27230a[_0x319eca(0x4ed)]+'px',_0x42ffab[_0x319eca(0x731)][_0x319eca(0xbbf)]=_0x25126d[_0x319eca(0xbbf)]-_0x27230a[_0x319eca(0xbbf)]+'px',_0x42ffab[_0x319eca(0x731)][_0x319eca(0x70b)]='';}_0x9e52c[_0x319eca(0x8d1)]();const _0x51aa1c=_0x9e52c[_0x319eca(0xafc)]===_0x319eca(0x467)?_0x9e52c[_0x319eca(0x8ef)][0x0]:_0x9e52c;_0x2edfe5=_0x51aa1c['clientX'],_0x261d03=_0x51aa1c['clientY'],document[_0x319eca(0xf72)]('mouseup',_0x58914f),document[_0x319eca(0xf72)]('mousemove',_0x399e1c),document[_0x319eca(0xf72)]('touchend',_0x58914f),document[_0x319eca(0xf72)](_0x319eca(0xe0d),_0x399e1c);},_0x399e1c=_0x28fde3=>{const _0x30f54b=_0x468908,_0x2121b7=_0x28fde3[_0x30f54b(0xafc)]===_0x30f54b(0xe0d)?_0x28fde3[_0x30f54b(0x8ef)][0x0]:_0x28fde3;_0x9c1b7c=_0x2edfe5-_0x2121b7[_0x30f54b(0x663)],_0x3c6533=_0x261d03-_0x2121b7['clientY'],_0x2edfe5=_0x2121b7[_0x30f54b(0x663)],_0x261d03=_0x2121b7['clientY'];let _0x176341=_0x42ffab[_0x30f54b(0x1a4)]-_0x3c6533,_0x540175=_0x42ffab[_0x30f54b(0x8fc)]-_0x9c1b7c;const _0xa63d25=_0x543790[_0x30f54b(0x84e)]-_0x42ffab[_0x30f54b(0xbb)]-0xa,_0x1ee8de=_0x543790[_0x30f54b(0x1347)]-_0x42ffab[_0x30f54b(0x387)]-0xa;_0x176341=Math[_0x30f54b(0x804)](0xa,Math[_0x30f54b(0x2de)](_0x176341,_0xa63d25)),_0x540175=Math[_0x30f54b(0x804)](0xa,Math[_0x30f54b(0x2de)](_0x540175,_0x1ee8de)),_0x42ffab['style'][_0x30f54b(0x4ed)]=_0x176341+'px',_0x42ffab[_0x30f54b(0x731)]['left']=_0x540175+'px';},_0x58914f=()=>{const _0x3ad3b5=_0x468908;document['removeEventListener']('mouseup',_0x58914f),document[_0x3ad3b5(0xd74)](_0x3ad3b5(0xa59),_0x399e1c),document[_0x3ad3b5(0xd74)](_0x3ad3b5(0x6b2),_0x58914f),document[_0x3ad3b5(0xd74)](_0x3ad3b5(0xe0d),_0x399e1c);};_0xdf436d[_0x468908(0xf72)]('mousedown',_0x23dba6),_0xdf436d[_0x468908(0xf72)]('touchstart',_0x23dba6);}function _0x40ef2f(_0x21ec17){const _0x3dcd6f=_0x5a7792,_0x4dc632=_0x2b4d16[_0x21ec17];if(!_0x4dc632)return;const _0x41cd12=document[_0x3dcd6f(0x64f)](_0x3dcd6f(0x8b1)),_0x26ca2f=document[_0x3dcd6f(0x64f)](_0x3dcd6f(0x95c)),_0x19c3a7=document[_0x3dcd6f(0x64f)](_0x3dcd6f(0x876)),_0x3e3d85=document['getElementById']('prev-page-btn'),_0x45a59f=document[_0x3dcd6f(0x64f)](_0x3dcd6f(0x1024));_0x41cd12[_0x3dcd6f(0xee5)]=_0x4dc632['title'];if(_0x4dc632[_0x3dcd6f(0xe84)][_0x3dcd6f(0x40f)]===0x0)_0x26ca2f[_0x3dcd6f(0xc58)]=_0x3dcd6f(0xc71),_0x4dc632[_0x3dcd6f(0xe9c)]=0x0,_0x4dc632[_0x3dcd6f(0x10a1)]=0x0;else{const _0x5a0daa=_0x4dc632[_0x3dcd6f(0x10a1)]*_0x4dc632[_0x3dcd6f(0x296)],_0x2950f8=_0x5a0daa+_0x4dc632[_0x3dcd6f(0x296)];_0x26ca2f['textContent']=_0x4dc632[_0x3dcd6f(0xe84)][_0x3dcd6f(0xdf5)](_0x5a0daa,_0x2950f8)[_0x3dcd6f(0xd22)]('\x0a');}_0x19c3a7[_0x3dcd6f(0xee5)]=_0x4dc632['currentPage']+0x1+_0x3dcd6f(0x28e)+_0x4dc632[_0x3dcd6f(0xe9c)],_0x3e3d85[_0x3dcd6f(0x1b0)]=_0x4dc632[_0x3dcd6f(0x10a1)]===0x0,_0x45a59f['disabled']=_0x4dc632[_0x3dcd6f(0x10a1)]>=_0x4dc632['totalPages']-0x1;}function _0x338bcc(){const _0x2e3b8d=_0x5a7792,_0x2f9c62=_0x2b4d16[_0x3e7a1b[_0x2e3b8d(0x777)]];_0x2f9c62&&_0x2f9c62[_0x2e3b8d(0x10a1)]<_0x2f9c62[_0x2e3b8d(0xe9c)]-0x1&&(_0x2f9c62[_0x2e3b8d(0x10a1)]++,_0x40ef2f(_0x3e7a1b[_0x2e3b8d(0x777)]),document[_0x2e3b8d(0x64f)]('reading-content')['scrollTop']=0x0,_0x19c324(_0x2f9c62['activeBookId'],_0x2f9c62[_0x2e3b8d(0x10a1)]));}async function _0x216da6(){const _0x5a4d73=_0x5a7792,_0xaa25b4=_0x2b4d16[_0x3e7a1b[_0x5a4d73(0x777)]];_0xaa25b4&&_0xaa25b4[_0x5a4d73(0x10a1)]>0x0&&(_0xaa25b4[_0x5a4d73(0x10a1)]--,_0x40ef2f(_0x3e7a1b['activeChatId']),document[_0x5a4d73(0x64f)]('reading-content')[_0x5a4d73(0xed7)]=0x0,await _0x19c324(_0xaa25b4[_0x5a4d73(0x1361)],_0xaa25b4[_0x5a4d73(0x10a1)]),await notifyAiOfPageTurn(_0x3e7a1b['activeChatId'],_0xaa25b4));}function _0x57c829(){const _0xcb57d6=_0x5a7792;document[_0xcb57d6(0x64f)](_0xcb57d6(0x7d2))[_0xcb57d6(0x1080)]();}async function _0x24af5c(_0x2e2efc){const _0x9bce26=_0x5a7792,_0x23f54f=new Uint8Array(_0x2e2efc);if(_0x23f54f[_0x9bce26(0x40f)]>=0x3&&_0x23f54f[0x0]===0xef&&_0x23f54f[0x1]===0xbb&&_0x23f54f[0x2]===0xbf)return console[_0x9bce26(0x1081)](_0x9bce26(0xedf)),new TextDecoder(_0x9bce26(0xf83))['decode'](_0x23f54f);if(_0x23f54f[_0x9bce26(0x40f)]>=0x2&&_0x23f54f[0x0]===0xff&&_0x23f54f[0x1]===0xfe)return console[_0x9bce26(0x1081)]('检测到\x20UTF-16\x20LE\x20BOM，使用\x20UTF-16\x20LE\x20解码。'),new TextDecoder(_0x9bce26(0x10fe))[_0x9bce26(0x8be)](_0x23f54f);if(_0x23f54f[_0x9bce26(0x40f)]>=0x2&&_0x23f54f[0x0]===0xfe&&_0x23f54f[0x1]===0xff)return console[_0x9bce26(0x1081)](_0x9bce26(0x837)),new TextDecoder(_0x9bce26(0xecf))['decode'](_0x23f54f);try{console[_0x9bce26(0x1081)](_0x9bce26(0x13af));const _0x3c3323=new TextDecoder(_0x9bce26(0xf83),{'fatal':!![]})[_0x9bce26(0x8be)](_0x23f54f);return console[_0x9bce26(0x1081)](_0x9bce26(0xac)),_0x3c3323;}catch(_0x2c1aab){console[_0x9bce26(0x1081)]('UTF-8\x20解码失败，将尝试\x20GBK\x20(ANSI)\x20解码...');try{const _0x2c6c48=new TextDecoder(_0x9bce26(0x54d))[_0x9bce26(0x8be)](_0x23f54f);return console['log'](_0x9bce26(0x72b)),_0x2c6c48;}catch(_0x1ab5f4){console[_0x9bce26(0xc60)](_0x9bce26(0x6c),_0x1ab5f4);throw new Error(_0x9bce26(0x1e7));}}}async function _0x23dd68(_0x4e9258){const _0x15cec4=_0x5a7792,_0x102ecb=_0x4e9258[_0x15cec4(0xf5b)]['files'][0x0];if(!_0x102ecb)return;try{const _0x401ed1=await _0x102ecb[_0x15cec4(0x119a)](),_0x419a2c=await _0x24af5c(_0x401ed1),_0x135949=_0x102ecb[_0x15cec4(0x6fc)][_0x15cec4(0x137f)](/\.txt$/i,''),_0x349d86=await _0x4e1bbf[_0x15cec4(0xf9)]['add']({'title':_0x135949,'content':_0x419a2c,'lastOpened':Date[_0x15cec4(0x2b5)]()});await _0x2d8a20(_0x349d86),document[_0x15cec4(0x64f)](_0x15cec4(0xce0))[_0x15cec4(0x418)][_0x15cec4(0xef6)]('visible')&&_0x4d5573();}catch(_0x6302f8){console[_0x15cec4(0xc60)]('导入书籍失败:',_0x6302f8),await _0x28974b('导入失败',_0x6302f8['message']);}finally{_0x4e9258[_0x15cec4(0xf5b)]['value']=null;}}async function _0x5e24ed(){const _0x4d6c4e=_0x5a7792,_0x2e2d04=_0x3e7a1b[_0x4d6c4e(0x777)];if(!_0x2e2d04)return;const _0x3e8c5d=_0x2b4d16[_0x2e2d04];if(!_0x3e8c5d||_0x3e8c5d['totalPages']<=0x1)return;const _0x4d129d=await _0x41e3f8(_0x4d6c4e(0x11a4),_0x4d6c4e(0x9d9)+_0x3e8c5d[_0x4d6c4e(0xe9c)]+')',_0x3e8c5d[_0x4d6c4e(0x10a1)]+0x1);if(_0x4d129d===null)return;const _0x59f390=parseInt(_0x4d129d);if(isNaN(_0x59f390)||_0x59f390<0x1||_0x59f390>_0x3e8c5d[_0x4d6c4e(0xe9c)]){alert(_0x4d6c4e(0x1be));return;}_0x3e8c5d['currentPage']=_0x59f390-0x1,_0x40ef2f(_0x2e2d04),_0x19c324(_0x3e8c5d['activeBookId'],_0x3e8c5d['currentPage']);}async function _0x19c324(_0x156f9e,_0x4cee2c){const _0x276c5d=_0x5a7792;if(!_0x156f9e)return;try{await _0x4e1bbf[_0x276c5d(0xf9)]['update'](_0x156f9e,{'currentPage':_0x4cee2c});}catch(_0x565ede){console['error'](_0x276c5d(0x10e5)+_0x156f9e+_0x276c5d(0x14d),_0x565ede);}}async function _0x338bcc(){const _0x545d31=_0x5a7792,_0x5d74cc=_0x2b4d16[_0x3e7a1b[_0x545d31(0x777)]];_0x5d74cc&&_0x5d74cc[_0x545d31(0x10a1)]<_0x5d74cc[_0x545d31(0xe9c)]-0x1&&(_0x5d74cc[_0x545d31(0x10a1)]++,_0x40ef2f(_0x3e7a1b[_0x545d31(0x777)]),document[_0x545d31(0x64f)]('reading-content')[_0x545d31(0xed7)]=0x0,await _0x19c324(_0x5d74cc[_0x545d31(0x1361)],_0x5d74cc['currentPage']),await notifyAiOfPageTurn(_0x3e7a1b[_0x545d31(0x777)],_0x5d74cc));}function _0x1344dc(_0x5594c7,_0x383ffb){const _0x17514e=_0x5a7792,_0x3f193f=_0x3e7a1b[_0x17514e(0x777)];if(!_0x3f193f)return;const _0x2a5bf4=_0x2b4d16[_0x3f193f];_0x2a5bf4['title']=_0x5594c7[_0x17514e(0x137f)](/\.txt$/i,''),_0x2a5bf4[_0x17514e(0xe84)]=_0x383ffb['split'](/\r\n?|\n/)['map'](_0x46443a=>_0x46443a['replace'](/ +/g,'\x20')),_0x2a5bf4[_0x17514e(0xe9c)]=Math['ceil'](_0x2a5bf4[_0x17514e(0xe84)]['length']/_0x2a5bf4[_0x17514e(0x296)]),_0x2a5bf4[_0x17514e(0x10a1)]=0x0,_0x40ef2f(_0x3f193f);}async function _0x42d773(){const _0x1f9933=_0x5a7792;document[_0x1f9933(0x64f)](_0x1f9933(0xf8c))['value']='',await _0x4d5573(),document[_0x1f9933(0x64f)](_0x1f9933(0xce0))[_0x1f9933(0x418)][_0x1f9933(0xdda)](_0x1f9933(0x40a));}async function _0x4d5573(_0x2ba538=''){const _0x363eda=_0x5a7792,_0x4cc5f9=document[_0x363eda(0x64f)](_0x363eda(0x72e));let _0x52ee24=await _0x4e1bbf['readingLibrary'][_0x363eda(0xe1d)](_0x363eda(0x10e9))['reverse']()[_0x363eda(0x78f)]();_0x4cc5f9[_0x363eda(0xc58)]='';_0x2ba538&&(_0x52ee24=_0x52ee24[_0x363eda(0x156)](_0x56b9df=>_0x56b9df[_0x363eda(0x1250)]['toLowerCase']()[_0x363eda(0xe53)](_0x2ba538[_0x363eda(0x36d)]())));if(_0x52ee24['length']===0x0){const _0x6a7b27=_0x2ba538?_0x363eda(0x2d6):_0x363eda(0x91f);_0x4cc5f9[_0x363eda(0xc58)]=_0x363eda(0x1f4)+_0x6a7b27+_0x363eda(0x12de);return;}_0x52ee24[_0x363eda(0x103)](_0x2af2ab=>{const _0x51febf=_0x363eda,_0x57a91f=document[_0x51febf(0x124e)](_0x51febf(0x479));_0x57a91f['className']='existing-group-item',_0x57a91f[_0x51febf(0xc58)]=_0x51febf(0x747)+_0x2af2ab['id']+'\x22>'+_0x2af2ab[_0x51febf(0x1250)]+_0x51febf(0xd35)+_0x2af2ab['id']+'\x22\x20title=\x22删除书籍\x22>×</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x4cc5f9['appendChild'](_0x57a91f);});}async function _0x2d8a20(_0x1631e3){const _0xccc251=_0x5a7792,_0x51c1cb=_0x3e7a1b[_0xccc251(0x777)];if(!_0x51c1cb)return;const _0x2544b3=await _0x4e1bbf[_0xccc251(0xf9)][_0xccc251(0x11fc)](_0x1631e3);if(!_0x2544b3){alert(_0xccc251(0x333));return;}await _0x4e1bbf[_0xccc251(0xf9)][_0xccc251(0x32e)](_0x1631e3,{'lastOpened':Date[_0xccc251(0x2b5)]()});const _0x58ce5b=_0x2b4d16[_0x51c1cb];_0x58ce5b[_0xccc251(0x1361)]=_0x1631e3,_0x58ce5b[_0xccc251(0x1250)]=_0x2544b3['title'],_0x58ce5b[_0xccc251(0xe84)]=_0x2544b3['content'][_0xccc251(0x108c)](/\r\n?|\n/)[_0xccc251(0xb96)](_0x210fec=>_0x210fec[_0xccc251(0x137f)](/ +/g,'\x20')),_0x58ce5b['totalPages']=Math[_0xccc251(0x124f)](_0x58ce5b[_0xccc251(0xe84)][_0xccc251(0x40f)]/_0x58ce5b[_0xccc251(0x296)]),_0x58ce5b[_0xccc251(0x10a1)]=_0x2544b3[_0xccc251(0x10a1)]||0x0,_0x40ef2f(_0x51c1cb),document['getElementById'](_0xccc251(0x95c))[_0xccc251(0xed7)]=0x0,document[_0xccc251(0x64f)]('reading-library-modal')[_0xccc251(0x418)][_0xccc251(0x1275)](_0xccc251(0x40a));}async function _0xa6e81d(_0x526c9a){const _0x1ddbca=_0x5a7792,_0x2c7e7b=await _0x4e1bbf[_0x1ddbca(0xf9)][_0x1ddbca(0x11fc)](_0x526c9a);if(!_0x2c7e7b)return;const _0x3e335d=await _0x54149f(_0x1ddbca(0x4f9),_0x1ddbca(0x115a)+_0x2c7e7b[_0x1ddbca(0x1250)]+_0x1ddbca(0x6ee),{'confirmButtonClass':_0x1ddbca(0xeed)});_0x3e335d&&(await _0x4e1bbf['readingLibrary']['delete'](_0x526c9a),await _0x4d5573());}function _0x1344dc(_0x15143f,_0x151aea){const _0x20133d=_0x5a7792,_0x217f58=_0x3e7a1b[_0x20133d(0x777)];if(!_0x217f58)return;const _0x106eae=_0x2b4d16[_0x217f58];_0x106eae[_0x20133d(0x1250)]=_0x15143f[_0x20133d(0x137f)](/\.txt$/i,''),_0x106eae[_0x20133d(0xe84)]=_0x151aea[_0x20133d(0x108c)](/\r\n?|\n/),_0x106eae[_0x20133d(0xe9c)]=Math[_0x20133d(0x124f)](_0x106eae['contentLines'][_0x20133d(0x40f)]/_0x106eae[_0x20133d(0x296)]),_0x106eae[_0x20133d(0x10a1)]=0x0,_0x40ef2f(_0x217f58);}function _0x5acbeb(_0x47d255,_0x261519){const _0xdb4885=_0x5a7792;let _0x4d49d8=0x0,_0xff19bc=0x0,_0x50892d=0x0,_0x7c8f35=0x0,_0x55fead=![],_0x54f68e=![];const _0x149630=document[_0xdb4885(0x64f)](_0xdb4885(0x4f8)),_0x3b6962=_0x4eae0c=>{const _0x75a7e9=_0xdb4885;if(_0x47d255!==_0x261519&&_0x4eae0c['target'][_0x75a7e9(0x2fc)](_0x75a7e9(0xcd)))return;_0x55fead=!![],_0x54f68e=![];const _0x34c489=_0x4eae0c[_0x75a7e9(0xafc)]===_0x75a7e9(0x467)?_0x4eae0c['touches'][0x0]:_0x4eae0c;_0x50892d=_0x34c489[_0x75a7e9(0x663)],_0x7c8f35=_0x34c489[_0x75a7e9(0xdcc)],_0x47d255[_0x75a7e9(0x731)][_0x75a7e9(0x4ed)]=_0x47d255[_0x75a7e9(0x1a4)]+'px',_0x47d255['style']['left']=_0x47d255[_0x75a7e9(0x8fc)]+'px',_0x47d255[_0x75a7e9(0x731)][_0x75a7e9(0x70b)]='',document[_0x75a7e9(0xf72)](_0x75a7e9(0x733),_0x3bc731),document['addEventListener'](_0x75a7e9(0xa59),_0x2a4046),document[_0x75a7e9(0xf72)](_0x75a7e9(0x6b2),_0x3bc731),document['addEventListener'](_0x75a7e9(0xe0d),_0x2a4046,{'passive':![]});},_0x2a4046=_0x51de07=>{const _0x3ccd1e=_0xdb4885;if(!_0x55fead)return;const _0x5e4d7e=_0x51de07[_0x3ccd1e(0xafc)]===_0x3ccd1e(0xe0d)?_0x51de07['touches'][0x0]:_0x51de07,_0x292297=_0x5e4d7e[_0x3ccd1e(0x663)]-_0x50892d,_0x346af9=_0x5e4d7e[_0x3ccd1e(0xdcc)]-_0x7c8f35;!_0x54f68e&&(Math[_0x3ccd1e(0x9cf)](_0x292297)>0x5||Math[_0x3ccd1e(0x9cf)](_0x346af9)>0x5)&&(_0x54f68e=!![]);_0x54f68e&&_0x51de07['cancelable']&&_0x51de07[_0x3ccd1e(0x8d1)]();_0x4d49d8=_0x50892d-_0x5e4d7e['clientX'],_0xff19bc=_0x7c8f35-_0x5e4d7e['clientY'],_0x50892d=_0x5e4d7e[_0x3ccd1e(0x663)],_0x7c8f35=_0x5e4d7e[_0x3ccd1e(0xdcc)];let _0x1583ea=_0x47d255[_0x3ccd1e(0x1a4)]-_0xff19bc,_0x58e0b3=_0x47d255[_0x3ccd1e(0x8fc)]-_0x4d49d8;const _0x478e4e=_0x149630[_0x3ccd1e(0x84e)]-_0x47d255[_0x3ccd1e(0xbb)]-0xa,_0x27d703=_0x149630[_0x3ccd1e(0x1347)]-_0x47d255['offsetWidth']-0xa;_0x1583ea=Math[_0x3ccd1e(0x804)](0xa,Math[_0x3ccd1e(0x2de)](_0x1583ea,_0x478e4e)),_0x58e0b3=Math[_0x3ccd1e(0x804)](0xa,Math[_0x3ccd1e(0x2de)](_0x58e0b3,_0x27d703)),_0x47d255['style'][_0x3ccd1e(0x4ed)]=_0x1583ea+'px',_0x47d255[_0x3ccd1e(0x731)][_0x3ccd1e(0xbbf)]=_0x58e0b3+'px';},_0x3bc731=()=>{const _0x266737=_0xdb4885;document[_0x266737(0xd74)](_0x266737(0x733),_0x3bc731),document[_0x266737(0xd74)]('mousemove',_0x2a4046),document[_0x266737(0xd74)](_0x266737(0x6b2),_0x3bc731),document['removeEventListener']('touchmove',_0x2a4046);if(!_0x55fead)return;_0x55fead=![],!_0x54f68e&&_0x47d255[_0x266737(0x1080)]();};_0x261519[_0xdb4885(0xf72)](_0xdb4885(0x48d),_0x3b6962),_0x261519[_0xdb4885(0xf72)](_0xdb4885(0x467),_0x3b6962,{'passive':![]});}function _0x30cf74(){const _0x4c1398=_0x5a7792,_0x5944c9=_0x2b4d16[_0x3e7a1b['activeChatId']];if(!_0x5944c9||!_0x5944c9['isActive'])return;document[_0x4c1398(0x64f)](_0x4c1398(0x44b))[_0x4c1398(0x418)][_0x4c1398(0xdda)](_0x4c1398(0x8dd)),document['getElementById'](_0x4c1398(0x12bd))[_0x4c1398(0x731)][_0x4c1398(0x130)]=_0x4c1398(0x1026),_0x5944c9[_0x4c1398(0x77d)]=!![];}function _0x1d3f0d(){const _0x370e06=_0x5a7792,_0x10c620=_0x2b4d16[_0x3e7a1b[_0x370e06(0x777)]];if(!_0x10c620||!_0x10c620[_0x370e06(0xb30)])return;document[_0x370e06(0x64f)](_0x370e06(0x12bd))[_0x370e06(0x731)][_0x370e06(0x130)]=_0x370e06(0x1209),document['getElementById'](_0x370e06(0x44b))[_0x370e06(0x418)][_0x370e06(0x1275)](_0x370e06(0x8dd)),_0x10c620[_0x370e06(0x77d)]=![];}function _0x189dd1(_0x12fdcd,_0x517ba9){let _0xd8f07;return function(..._0x5c1cdd){const _0x4d66d5=_0x2bd6,_0xac50dc=this;clearTimeout(_0xd8f07),_0xd8f07=setTimeout(()=>_0x12fdcd[_0x4d66d5(0xd93)](_0xac50dc,_0x5c1cdd),_0x517ba9);};}function _0x248ef3(_0x4c0964){const _0x488162=_0x5a7792,_0x2b7dfb=_0x2b4d16[_0x4c0964];if(!_0x2b7dfb||!_0x2b7dfb[_0x488162(0xb30)])return'';const _0xf7c790=_0x2b7dfb[_0x488162(0x1250)]||'未知书籍';let _0x1b6caa='',_0x586f29='';if(_0x2b7dfb[_0x488162(0xdd0)]&&_0x2b7dfb[_0x488162(0xdd0)][_0x488162(0x43a)]())_0x1b6caa=_0x2b7dfb[_0x488162(0xdd0)],_0x586f29=_0x488162(0x683);else{if(_0x2b7dfb['contentLines'][_0x488162(0x40f)]>0x0){const _0x3ca533=_0x2b7dfb[_0x488162(0x10a1)]*_0x2b7dfb[_0x488162(0x296)],_0x20fad1=_0x3ca533+_0x2b7dfb[_0x488162(0x296)];_0x1b6caa=_0x2b7dfb['contentLines'][_0x488162(0xdf5)](_0x3ca533,_0x20fad1)[_0x488162(0xd22)]('\x0a')[_0x488162(0x126f)](0x0,0xc8),_0x586f29='当前页内容摘要';}else _0x1b6caa=_0x488162(0x636),_0x586f29='内容';}return'\x0a\x20\x20\x20\x20-\x20**书名**:\x20《'+_0xf7c790+_0x488162(0xc67)+_0x586f29+_0x488162(0xa58)+_0x1b6caa+'...\x22\x0a\x20\x20\x20\x20#一起读书模式\x20|\x20行为铁律\x0a\x20\x20\x20\x201.\x20\x20**角色定位**:\x20你【不是】书中的任何角色，你是【你自己】('+(_0x3e7a1b['chats'][_0x4c0964]?.[_0x488162(0x7de)]||'AI角色')+_0x488162(0x556);}function _0x14ebcc(){const _0x39ec3=_0x5a7792,_0x35b69d=_0x3e7a1b[_0x39ec3(0x777)];if(!_0x35b69d||!_0x2b4d16[_0x35b69d])return;const _0x336dc7=_0x2b4d16[_0x35b69d],_0x2a7d3d=document[_0x39ec3(0x64f)]('reading-content'),_0x4067b0=_0x2a7d3d[_0x39ec3(0xed7)],_0x267a0b=_0x2a7d3d['clientHeight'],_0x3b0874=_0x4067b0+_0x267a0b,_0x563cc1=0xf*1.8,_0x5883c7=Math[_0x39ec3(0x1245)](_0x4067b0/_0x563cc1),_0x39d9d9=Math[_0x39ec3(0x124f)](_0x3b0874/_0x563cc1),_0x25f53a=_0x336dc7[_0x39ec3(0x10a1)]*_0x336dc7['linesPerPage']+_0x5883c7,_0x456540=_0x336dc7['currentPage']*_0x336dc7[_0x39ec3(0x296)]+_0x39d9d9;if(_0x25f53a<0x0||_0x25f53a>=_0x336dc7[_0x39ec3(0xe84)]['length'])return;const _0x2a1a2e=_0x336dc7['contentLines'][_0x39ec3(0xdf5)](Math[_0x39ec3(0x804)](0x0,_0x25f53a),Math['min'](_0x336dc7['contentLines']['length'],_0x456540))[_0x39ec3(0xd22)]('\x0a');_0x336dc7['currentSnippet']=_0x2a1a2e;}function _0x5b567f(){const _0x32edde=_0x5a7792,_0x4f4f9a=document[_0x32edde(0x64f)](_0x32edde(0xde3));if(_0x4f4f9a){const _0x25882e=_0x4f4f9a[_0x32edde(0x1190)]();_0x25882e!==undefined&&_0x25882e['then'](_0x2991f7=>{const _0x5865cf=_0x32edde;console['log'](_0x5865cf(0x13b4));})[_0x32edde(0x1201)](_0x4756b4=>{const _0x1253f5=_0x32edde;console[_0x1253f5(0x1155)]('无法自动播放静音音频（这在iOS首次加载时是正常现象）:',_0x4756b4);});}}function _0xb6bc2c(){const _0x5468e9=_0x5a7792,_0x247f87=document['getElementById'](_0x5468e9(0xde3));_0x247f87&&!_0x247f87[_0x5468e9(0x10b0)]&&(_0x247f87['pause'](),_0x247f87[_0x5468e9(0x76)]=0x0,console[_0x5468e9(0x1081)](_0x5468e9(0x1001)));}async function _0x4a611b(_0x57c4df){const _0x46ffef=_0x5a7792,_0x53e9fd=decodeURIComponent(_0x57c4df[_0x46ffef(0x12e1)][_0x46ffef(0x673)]),_0x4d7340=_0x57c4df['dataset'][_0x46ffef(0x434)],_0xf29270=_0x57c4df[_0x46ffef(0x49c)](_0x46ffef(0xebc)),_0x44a927=_0x57c4df[_0x46ffef(0x49c)](_0x46ffef(0x12c6)),_0x3d8cd9=document[_0x46ffef(0x64f)](_0x46ffef(0x1350));if(!_0x3d8cd9['paused']&&_0x3d8cd9['dataset'][_0x46ffef(0x870)]===_0x53e9fd&&_0x3d8cd9[_0x46ffef(0x12e1)]['currentVoiceId']===_0x4d7340){_0x3d8cd9[_0x46ffef(0x6ef)]();return;}_0x3d8cd9[_0x46ffef(0x6ef)](),document[_0x46ffef(0x233)](_0x46ffef(0xebc))[_0x46ffef(0x103)](_0x39f29e=>_0x39f29e['textContent']='▶');const _0x384ba4='tts_'+_0x4d7340+'_'+_0x53e9fd;let _0x2925b4=_0x3e7a1b[_0x46ffef(0xb4e)][_0x46ffef(0x11fc)](_0x384ba4);if(_0x2925b4){console[_0x46ffef(0x1081)](_0x46ffef(0x17b)),await _0x3f1f35(_0x2925b4[_0x46ffef(0xe52)],_0x2925b4[_0x46ffef(0xafc)],_0x53e9fd,_0x4d7340,_0x57c4df);return;}console['log'](_0x46ffef(0xfad));if(_0xf29270)_0xf29270[_0x46ffef(0x731)][_0x46ffef(0x130)]=_0x46ffef(0x1209);_0x44a927['style']['display']='block';const {minimaxGroupId:_0x402c76,minimaxApiKey:_0x7e449a}=_0x3e7a1b[_0x46ffef(0xec0)];if(!_0x402c76||!_0x7e449a){await _0x28974b(_0x46ffef(0xcf6),'请先在API设置中填写您的\x20Minimax\x20Group\x20ID\x20和\x20API\x20Key。'),_0x44a927['style']['display']=_0x46ffef(0x1209);if(_0xf29270)_0xf29270[_0x46ffef(0x731)][_0x46ffef(0x130)]=_0x46ffef(0x1026);return;}try{const _0x2b4fed=await fetch('https://api.minimax.chat/v1/text_to_speech?GroupId='+_0x402c76,{'method':'POST','headers':{'Authorization':_0x46ffef(0x236)+_0x7e449a,'Content-Type':_0x46ffef(0x7fe)},'body':JSON[_0x46ffef(0xe3f)]({'text':_0x53e9fd,'voice_id':_0x4d7340,'model':_0x3e7a1b[_0x46ffef(0xec0)][_0x46ffef(0x72c)]||'speech-01','speed':0x1,'vol':0x1,'pitch':0x0})});if(!_0x2b4fed['ok']){let _0xb3de24=_0x46ffef(0x646)+_0x2b4fed[_0x46ffef(0x69e)];try{const _0x399732=await _0x2b4fed[_0x46ffef(0x6f8)]();_0xb3de24=_0x399732[_0x46ffef(0xea7)]?.[_0x46ffef(0x11c0)]||JSON[_0x46ffef(0xe3f)](_0x399732);}catch(_0x3ec01d){_0xb3de24=await _0x2b4fed[_0x46ffef(0x673)]();}throw new Error(_0xb3de24);}const _0x477534=await _0x2b4fed[_0x46ffef(0x1231)](),_0x3c4737=URL['createObjectURL'](_0x477534);await _0x3f1f35(_0x3c4737,_0x477534['type'],_0x53e9fd,_0x4d7340,_0x57c4df);const _0x1c2e84=new FileReader();_0x1c2e84[_0x46ffef(0x6e6)]=function(){const _0x308d9b=_0x46ffef;_0x3e7a1b[_0x308d9b(0xb4e)][_0x308d9b(0x125e)](_0x384ba4,{'url':_0x1c2e84['result'],'type':_0x477534[_0x308d9b(0xafc)]}),console['log'](_0x308d9b(0x1183));},_0x1c2e84['readAsDataURL'](_0x477534);}catch(_0x3268a3){console[_0x46ffef(0xc60)](_0x46ffef(0x178),_0x3268a3),await _0x28974b(_0x46ffef(0x1b3),_0x46ffef(0xb70)+_0x3268a3[_0x46ffef(0x854)]);}finally{_0x44a927[_0x46ffef(0x731)][_0x46ffef(0x130)]='none';if(_0xf29270)_0xf29270['style'][_0x46ffef(0x130)]=_0x46ffef(0x1026);}}function _0x3f1f35(_0x6e7be2,_0x5b0cbc,_0x2ecb81,_0x469e44,_0x30b3d8){return new Promise((_0x45a924,_0x37f55)=>{const _0x49df60=_0x2bd6,_0x4167ad=document[_0x49df60(0x64f)]('tts-audio-player');_0x4167ad['src']=_0x6e7be2,_0x4167ad[_0x49df60(0xafc)]=_0x5b0cbc,_0x4167ad['dataset'][_0x49df60(0x870)]=_0x2ecb81,_0x4167ad[_0x49df60(0x12e1)][_0x49df60(0x6d4)]=_0x469e44;const _0x37a981=_0x4167ad[_0x49df60(0x1190)]();_0x37a981!==undefined&&_0x37a981[_0x49df60(0x102e)](()=>{const _0x3c5e5b=_0x49df60,_0x30ac43=_0x30b3d8[_0x3c5e5b(0x49c)](_0x3c5e5b(0xebc));if(_0x30ac43)_0x30ac43[_0x3c5e5b(0xee5)]='❚❚';_0x45a924();})[_0x49df60(0x1201)](_0x28b875=>{console['error']('音频播放失败:',_0x28b875),_0x37f55(_0x28b875);}),_0x4167ad[_0x49df60(0xeb7)]=()=>{const _0x19fc34=_0x49df60,_0x1cceda=_0x30b3d8[_0x19fc34(0x49c)](_0x19fc34(0xebc));if(_0x1cceda)_0x1cceda[_0x19fc34(0xee5)]='▶';},_0x4167ad['onpause']=()=>{const _0x2c740f=_0x49df60,_0x55c9a9=_0x30b3d8[_0x2c740f(0x49c)](_0x2c740f(0xebc));if(_0x55c9a9)_0x55c9a9[_0x2c740f(0xee5)]='▶';};});}function _0x17127f(_0x66c301){const _0x3cbce8=_0x5a7792,_0x3de05c=_0x66c301[_0x3cbce8(0x2fc)]('.message-bubble');if(!_0x3de05c)return;const _0x6a041a=_0x3de05c[_0x3cbce8(0x49c)]('.voice-transcript'),_0x4da751=decodeURIComponent(_0x66c301['dataset'][_0x3cbce8(0x673)]);_0x6a041a[_0x3cbce8(0x731)][_0x3cbce8(0x130)]===_0x3cbce8(0xb37)?_0x6a041a[_0x3cbce8(0x731)][_0x3cbce8(0x130)]='none':(_0x6a041a['textContent']=_0x4da751,_0x6a041a['style']['display']=_0x3cbce8(0xb37));}async function _0x4c2a55(){const _0x593f12=_0x5a7792;await _0x132902(),document[_0x593f12(0x64f)](_0x593f12(0x1246))[_0x593f12(0x418)][_0x593f12(0xdda)](_0x593f12(0x40a));}async function _0x132902(){const _0x30f327=_0x5a7792,_0x3f3bf8=document['getElementById'](_0x30f327(0x16a)),_0x2252df=await _0x4e1bbf[_0x30f327(0x135)][_0x30f327(0x78f)]();_0x3f3bf8[_0x30f327(0xc58)]='';if(_0x2252df[_0x30f327(0x40f)]===0x0){_0x3f3bf8[_0x30f327(0xc58)]=_0x30f327(0x820);return;}_0x2252df['forEach'](_0x49aa5f=>{const _0xac9a91=_0x30f327,_0x4b17c9=document['createElement'](_0xac9a91(0x479));_0x4b17c9['className']=_0xac9a91(0x6c3),_0x4b17c9[_0xac9a91(0xc58)]=_0xac9a91(0xda0)+_0x49aa5f[_0xac9a91(0x6fc)]+_0xac9a91(0xad4)+_0x49aa5f['id']+_0xac9a91(0xaac),_0x3f3bf8[_0xac9a91(0x99e)](_0x4b17c9);});}async function _0x126992(){const _0x1232db=_0x5a7792,_0x12c7f9=document[_0x1232db(0x64f)](_0x1232db(0x1149)),_0x453a24=_0x12c7f9['value']['trim']();if(!_0x453a24)return alert(_0x1232db(0x1b9));const _0x1f18d5=await _0x4e1bbf['shoppingCategories'][_0x1232db(0xec9)](_0x1232db(0x6fc))[_0x1232db(0x11cd)](_0x453a24)[_0x1232db(0x5dd)]();if(_0x1f18d5)return alert('分类\x20\x22'+_0x453a24+_0x1232db(0xc4e));await _0x4e1bbf[_0x1232db(0x135)][_0x1232db(0xdda)]({'name':_0x453a24}),_0x12c7f9[_0x1232db(0xbed)]='',await _0x132902();}async function _0x5d28ff(_0x177ccc){const _0x2fc6c1=_0x5a7792,_0x4d3653=await _0x54149f('确认删除',_0x2fc6c1(0x1157),{'confirmButtonClass':_0x2fc6c1(0xeed)});_0x4d3653&&(await _0x4e1bbf[_0x2fc6c1(0x135)][_0x2fc6c1(0x3aa)](_0x177ccc),await _0x4e1bbf['shoppingProducts'][_0x2fc6c1(0xec9)](_0x2fc6c1(0xcd3))['equals'](_0x177ccc)['modify']({'categoryId':null}),await _0x132902());}function _0x2a1e5c(_0x38119a={}){const _0x2373b4=_0x5a7792,_0x19afcf=document[_0x2373b4(0x64f)]('product-variations-container'),_0x158890=document[_0x2373b4(0x124e)]('div');return _0x158890['className']=_0x2373b4(0x98d),_0x158890[_0x2373b4(0xc58)]=_0x2373b4(0x1332)+(_0x38119a[_0x2373b4(0x6fc)]||'')+_0x2373b4(0x52a)+(_0x38119a['price']||'')+_0x2373b4(0x10af)+(_0x38119a[_0x2373b4(0xd07)]||_0x2373b4(0xfb4))+_0x2373b4(0xcdf),_0x158890[_0x2373b4(0x49c)]('.delete-block-btn')[_0x2373b4(0xf72)](_0x2373b4(0x1080),()=>_0x158890[_0x2373b4(0x1275)]()),_0x158890['querySelector']('.upload-variation-image-btn')[_0x2373b4(0xf72)](_0x2373b4(0x1080),()=>{const _0x1fcd7a=_0x2373b4;_0x158890[_0x1fcd7a(0x49c)](_0x1fcd7a(0xe0c))[_0x1fcd7a(0x1080)]();}),_0x158890[_0x2373b4(0x49c)](_0x2373b4(0xe0c))[_0x2373b4(0xf72)](_0x2373b4(0x834),_0x377d54=>{const _0x22689a=_0x2373b4,_0x2c0595=_0x377d54['target'][_0x22689a(0x91e)][0x0];if(_0x2c0595){const _0x32a18a=new FileReader();_0x32a18a[_0x22689a(0x139d)]=_0x3e4978=>{const _0x508188=_0x22689a;_0x158890['querySelector']('.variation-image-preview')[_0x508188(0xbe8)]=_0x3e4978[_0x508188(0xf5b)]['result'];},_0x32a18a[_0x22689a(0xb4)](_0x2c0595);}}),_0x19afcf[_0x2373b4(0x99e)](_0x158890),_0x158890;}async function _0x390e74(_0x2bb3d5){const _0x4ff5c3=_0x5a7792,_0x2ae636=await _0x4e1bbf[_0x4ff5c3(0x760)][_0x4ff5c3(0x11fc)](_0x2bb3d5);if(!_0x2ae636||!_0x2ae636[_0x4ff5c3(0x349)]||_0x2ae636[_0x4ff5c3(0x349)][_0x4ff5c3(0x40f)]===0x0)return;const _0x2f2706=document[_0x4ff5c3(0x64f)](_0x4ff5c3(0x2bd));document[_0x4ff5c3(0x64f)]('variation-product-image')['src']=_0x2ae636[_0x4ff5c3(0xd07)],document[_0x4ff5c3(0x64f)]('variation-product-name')[_0x4ff5c3(0xee5)]=_0x2ae636['name'];const _0xa909bb=document[_0x4ff5c3(0x64f)](_0x4ff5c3(0x935));_0xa909bb[_0x4ff5c3(0xc58)]='',_0x2ae636['variations'][_0x4ff5c3(0x103)]((_0x16a18c,_0x58f1e3)=>{const _0x47818f=_0x4ff5c3,_0x910b92=document[_0x47818f(0x124e)](_0x47818f(0x62b));_0x910b92[_0x47818f(0xafc)]='radio',_0x910b92[_0x47818f(0x6fc)]=_0x47818f(0x13e7),_0x910b92['id']='var-'+_0x2bb3d5+'-'+_0x58f1e3,_0x910b92['value']=_0x58f1e3,_0x910b92[_0x47818f(0x731)]['display']=_0x47818f(0x1209);if(_0x58f1e3===0x0)_0x910b92[_0x47818f(0xf1d)]=!![];const _0x4815a1=document[_0x47818f(0x124e)](_0x47818f(0x1287));_0x4815a1[_0x47818f(0xca8)]=_0x47818f(0x454)+_0x2bb3d5+'-'+_0x58f1e3,_0x4815a1[_0x47818f(0xee5)]=_0x16a18c['name'],_0x4815a1[_0x47818f(0x731)][_0x47818f(0x42f)]=_0x47818f(0xde7),_0xa909bb[_0x47818f(0x99e)](_0x910b92),_0xa909bb[_0x47818f(0x99e)](_0x4815a1);});const _0x75015c=()=>{const _0x2dfbcd=_0x4ff5c3,_0x21cc68=_0xa909bb['querySelector'](_0x2dfbcd(0xb7e));_0xa909bb[_0x2dfbcd(0x233)](_0x2dfbcd(0x1287))[_0x2dfbcd(0x103)](_0x158a4d=>{const _0xac3a62=_0x2dfbcd;_0x158a4d[_0xac3a62(0x731)][_0xac3a62(0x3bb)]=_0xac3a62(0xac8),_0x158a4d[_0xac3a62(0x731)][_0xac3a62(0x23c)]='#333',_0x158a4d[_0xac3a62(0x731)][_0xac3a62(0xfd6)]='white';});if(_0x21cc68){const _0x843bd4=_0xa909bb['querySelector'](_0x2dfbcd(0xc92)+_0x21cc68['id']+'\x22]');_0x843bd4[_0x2dfbcd(0x731)][_0x2dfbcd(0x3bb)]=_0x2dfbcd(0x255),_0x843bd4[_0x2dfbcd(0x731)]['color']=_0x2dfbcd(0x255),_0x843bd4[_0x2dfbcd(0x731)][_0x2dfbcd(0xfd6)]='#e7f3ff';const _0x30fd9f=_0x2ae636['variations'][parseInt(_0x21cc68[_0x2dfbcd(0xbed)])];document['getElementById'](_0x2dfbcd(0xf30))[_0x2dfbcd(0xee5)]='¥'+_0x30fd9f[_0x2dfbcd(0xd5b)]['toFixed'](0x2),_0x30fd9f[_0x2dfbcd(0xd07)]?document[_0x2dfbcd(0x64f)](_0x2dfbcd(0x1241))['src']=_0x30fd9f['imageUrl']:document[_0x2dfbcd(0x64f)]('variation-product-image')[_0x2dfbcd(0xbe8)]=_0x2ae636[_0x2dfbcd(0xd07)];}};_0xa909bb[_0x4ff5c3(0xf72)](_0x4ff5c3(0x834),_0x75015c),_0x75015c(),document[_0x4ff5c3(0x64f)]('variation-quantity-display')[_0x4ff5c3(0xee5)]='1';const _0x114af5=document['getElementById']('confirm-variation-selection-btn'),_0x18734f=_0x114af5[_0x4ff5c3(0xc66)](!![]);_0x114af5[_0x4ff5c3(0x9be)][_0x4ff5c3(0x3d4)](_0x18734f,_0x114af5),_0x18734f[_0x4ff5c3(0xf72)](_0x4ff5c3(0x1080),async()=>{const _0x18ef84=_0x4ff5c3,_0x1457d1=_0xa909bb[_0x18ef84(0x49c)]('input[name=\x22variation-select\x22]:checked'),_0x5d95f6=parseInt(document['getElementById'](_0x18ef84(0xb07))[_0x18ef84(0xee5)]);if(_0x1457d1){const _0x225fb7=_0x2ae636['variations'][parseInt(_0x1457d1[_0x18ef84(0xbed)])];await _0x2e14cf(_0x2bb3d5,_0x5d95f6,_0x225fb7),_0x2f2706[_0x18ef84(0x418)][_0x18ef84(0x1275)]('visible'),await _0x28974b('成功',_0x18ef84(0x31d));}}),_0x2f2706[_0x4ff5c3(0x418)][_0x4ff5c3(0xdda)](_0x4ff5c3(0x40a));}function _0x1900b0(){const _0x6542c5=_0x5a7792,_0x6c522d=document[_0x6542c5(0x64f)](_0x6542c5(0x89b));document['getElementById'](_0x6542c5(0x881))['value']=_0x3e7a1b[_0x6542c5(0x11b4)][_0x6542c5(0x10f)]||0x3,document[_0x6542c5(0x64f)](_0x6542c5(0xc0b))[_0x6542c5(0xbed)]=_0x3e7a1b['globalSettings']['shoppingProductCount']||0x8,_0x6c522d[_0x6542c5(0x418)][_0x6542c5(0xdda)](_0x6542c5(0x40a));}async function _0x183b4d(){const _0x27ce7d=_0x5a7792,_0x30684e=document['getElementById'](_0x27ce7d(0x881)),_0x2f9cc2=document[_0x27ce7d(0x64f)](_0x27ce7d(0xc0b)),_0x2187ce=parseInt(_0x30684e['value']),_0x18ab83=parseInt(_0x2f9cc2[_0x27ce7d(0xbed)]);if(isNaN(_0x2187ce)||isNaN(_0x18ab83)||_0x2187ce<0x1||_0x18ab83<0x1){alert(_0x27ce7d(0x1348));return;}_0x3e7a1b[_0x27ce7d(0x11b4)][_0x27ce7d(0x10f)]=_0x2187ce,_0x3e7a1b[_0x27ce7d(0x11b4)][_0x27ce7d(0x10ba)]=_0x18ab83,await _0x4e1bbf[_0x27ce7d(0x11b4)]['put'](_0x3e7a1b[_0x27ce7d(0x11b4)]),document['getElementById']('shopping-settings-modal')[_0x27ce7d(0x418)][_0x27ce7d(0x1275)]('visible'),await _0x28974b(_0x27ce7d(0x12e8),'购物中心生成设置已更新！');}async function _0x58a088(){const _0x4f36e0=_0x5a7792;if(!_0x3e7a1b[_0x4f36e0(0x777)]){await _0x28974b(_0x4f36e0(0x5b1),_0x4f36e0(0x1259));return;}const _0x2aa304=_0x3e7a1b['chats'][_0x3e7a1b[_0x4f36e0(0x777)]],_0x490af7=await _0x54149f('为“'+_0x2aa304[_0x4f36e0(0x6fc)]+_0x4f36e0(0xe9),'此操作将使用AI生成新的商品和分类，并【添加】到现有列表中。确定要继续吗？',{'confirmText':_0x4f36e0(0x6f7)});if(!_0x490af7)return;await _0x28974b('请稍候...',_0x4f36e0(0xfe4)+_0x2aa304[_0x4f36e0(0x6fc)]+_0x4f36e0(0x30a));const _0x402e6d=_0x3e7a1b['apiConfig'][_0x4f36e0(0x64b)]&&_0x3e7a1b['apiConfig'][_0x4f36e0(0x2d3)]&&_0x3e7a1b[_0x4f36e0(0xec0)][_0x4f36e0(0x31f)],{proxyUrl:_0x3ae107,apiKey:_0x1e84cc,model:_0x407a78}=_0x402e6d?{'proxyUrl':_0x3e7a1b[_0x4f36e0(0xec0)][_0x4f36e0(0x64b)],'apiKey':_0x3e7a1b[_0x4f36e0(0xec0)][_0x4f36e0(0x2d3)],'model':_0x3e7a1b['apiConfig']['secondaryModel']}:_0x3e7a1b['apiConfig'];if(!_0x3ae107||!_0x1e84cc||!_0x407a78){await _0x28974b(_0x4f36e0(0xba3),_0x4f36e0(0x1056));return;}const _0x38f253=_0x3e7a1b['globalSettings'][_0x4f36e0(0x10f)]||0x3,_0x4ed8b7=_0x3e7a1b[_0x4f36e0(0x11b4)]['shoppingProductCount']||0x8,_0x481658=await _0x4e1bbf[_0x4f36e0(0x135)]['toArray']();let _0x374d2='';_0x481658[_0x4f36e0(0x40f)]>0x0&&(_0x374d2='\x0a#\x20【分类复用铁律\x20(最高优先级！)】\x0a在为新商品指定分类时，你【必须】首先检查下面的“已有分类列表”。\x0a-\x20\x20\x20如果一个新商品可以被归入某个【已存在的分类】，你【必须】复用那个分类的名称，而不是创造一个相似的新分类！\x0a-\x20\x20\x20只有当你确定商品【绝对】不属于任何一个已有分类时，你才能创造一个新的分类名称。\x0a-\x20\x20\x20**已有分类列表**:\x20['+_0x481658[_0x4f36e0(0xb96)](_0x35d7f0=>'\x22'+_0x35d7f0[_0x4f36e0(0x6fc)]+'\x22')[_0x4f36e0(0xd22)](',\x20')+']\x0a');const _0x61c186=_0x3e7a1b[_0x4f36e0(0x3c2)][_0x4f36e0(0x78c)]||'我',_0x54e530=_0x2aa304[_0x4f36e0(0x518)]&&_0x2aa304[_0x4f36e0(0x518)][_0x4f36e0(0x40f)]>0x0?_0x2aa304['longTermMemory'][_0x4f36e0(0xb96)](_0x29f235=>_0x4f36e0(0x56b)+_0x4942eb(_0x29f235['timestamp'])+')\x20'+_0x29f235[_0x4f36e0(0x3ba)])[_0x4f36e0(0xd22)]('\x0a'):'无',_0x5330a6=_0x2aa304[_0x4f36e0(0x830)][_0x4f36e0(0xdf5)](-0xa)[_0x4f36e0(0xb96)](_0x164c72=>(_0x164c72[_0x4f36e0(0x931)]===_0x4f36e0(0xa4d)?_0x61c186:_0x2aa304[_0x4f36e0(0x6fc)])+':\x20'+String(_0x164c72['content'])[_0x4f36e0(0x126f)](0x0,0x1e)+'...')['join']('\x0a');let _0x2b56c9='';if(_0x2aa304[_0x4f36e0(0xcb3)][_0x4f36e0(0xde4)]&&_0x2aa304[_0x4f36e0(0xcb3)][_0x4f36e0(0xde4)][_0x4f36e0(0x40f)]>0x0){const _0x2187b1=_0x2aa304[_0x4f36e0(0xcb3)][_0x4f36e0(0xde4)]['map'](_0x56ee21=>{const _0xa1aa7c=_0x4f36e0,_0x87e098=_0x3e7a1b[_0xa1aa7c(0x144)][_0xa1aa7c(0x137)](_0x2c29d8=>_0x2c29d8['id']===_0x56ee21);if(!_0x87e098||!Array[_0xa1aa7c(0x97e)](_0x87e098[_0xa1aa7c(0x3ba)]))return'';const _0x190ff1=_0x87e098[_0xa1aa7c(0x3ba)][_0xa1aa7c(0x156)](_0x285a21=>_0x285a21[_0xa1aa7c(0x9b)]!==![])[_0xa1aa7c(0xb96)](_0x64b6a7=>'-\x20'+_0x64b6a7[_0xa1aa7c(0x3ba)])[_0xa1aa7c(0xd22)]('\x0a');return _0x190ff1?_0xa1aa7c(0x39b)+_0x87e098['name']+'》:\x0a'+_0x190ff1:'';})[_0x4f36e0(0x156)](Boolean)['join']('');_0x2187b1&&(_0x2b56c9=_0x4f36e0(0x1394)+_0x2187b1+'\x0a');}const _0xcf93a=_0x4f36e0(0xd48)+_0x2aa304['name']+'”量身打造一个专属的商品列表。\x0a\x0a#\x20核心规则\x0a1.\x20\x20**【角色定制(最高优先级)】**:\x20你生成的所有商品和分类【必须】深度绑定角色的性格、记忆和最近的对话。它们应该是角色会真正感兴趣、购买或制作的东西。\x0a2.\x20\x20**创造性与合理性**:\x20商品和分类必须合理且多样化。\x0a3.\x20\x20**格式铁律\x20(最高优先级)**:\x20\x0a\x20\x20\x20\x20-\x20你的回复【必须且只能】是一个【单一的JSON对象】。\x0a\x20\x20\x20\x20-\x20你的回复必须以\x20`{`\x20开始，并以\x20`}`\x20结束。\x0a\x20\x20\x20\x20-\x20【绝对禁止】在JSON对象前后添加任何多余的文字、解释或\x20markdown\x20标记。\x0a\x20\x20\x20\x20-\x20格式【必须】如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22categories\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22分类名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22products\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22name\x22:\x20\x22商品名称1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22price\x22:\x2099.80,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22这是商品的详细描述，不少于50字...\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22variations\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式1\x22,\x20\x22price\x22:\x20108.80,\x20\x22image_prompt\x22:\x20\x22款式1的图片【英文】关键词...\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22name\x22:\x20\x22款式2\x22,\x20\x22price\x22:\x20118.80,\x20\x22image_prompt\x22:\x20\x22款式2的图片【英文】关键词...\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22image_prompt\x22:\x20\x22商品主图的【英文】关键词,\x20风格为\x20realistic\x20product\x20photo,\x20high\x20quality,\x20on\x20a\x20clean\x20white\x20background\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a\x20\x20\x20\x20-\x20**categories**:\x20生成\x20'+_0x38f253+_0x4f36e0(0x13d8)+_0x4ed8b7+_0x4f36e0(0x37b)+_0x2aa304[_0x4f36e0(0x6fc)]+'\x0a-\x20**角色人设**:\x20'+_0x2aa304[_0x4f36e0(0xcb3)][_0x4f36e0(0xbe5)]+_0x4f36e0(0x8a2)+_0x54e530+'\x0a-\x20**世界书设定**:\x20'+_0x2b56c9+'\x0a'+_0x374d2+'\x0a-\x20**最近对话摘要**:\x0a'+_0x5330a6+_0x4f36e0(0x3f5)+_0x2aa304['name']+'”生成这组【与角色高度相关】的商品数据。';try{const _0x3f7f7f=[{'role':_0x4f36e0(0xa4d),'content':'请根据以上设定，生成商品数据。'}];let _0x5bc2eb=_0x3ae107[_0x4f36e0(0xe53)](_0x4f36e0(0x742)),_0x1fe08c=_0x250668(_0x407a78,_0x1e84cc,_0xcf93a,_0x3f7f7f);const _0x9ed630=_0x5bc2eb?await fetch(_0x1fe08c[_0x4f36e0(0xe52)],_0x1fe08c[_0x4f36e0(0x88a)]):await fetch(_0x3ae107+_0x4f36e0(0x58b),{'method':_0x4f36e0(0x2d1),'headers':{'Content-Type':'application/json','Authorization':'Bearer\x20'+_0x1e84cc},'body':JSON[_0x4f36e0(0xe3f)]({'model':_0x407a78,'messages':[{'role':_0x4f36e0(0x905),'content':_0xcf93a},..._0x3f7f7f],'temperature':_0x3e7a1b['globalSettings']['apiTemperature']||0.9})});if(!_0x9ed630['ok'])throw new Error(_0x4f36e0(0x1fa)+_0x9ed630['statusText']);const _0x349812=await _0x9ed630[_0x4f36e0(0x6f8)](),_0x548dc8=getGeminiResponseText(_0x349812),_0x127c36=_0x548dc8['match'](/({[\s\S]*})/);if(!_0x127c36)throw new Error('AI返回的内容中未找到有效的JSON对象。');const _0x5da10b=JSON[_0x4f36e0(0x1214)](_0x127c36[0x0]);if(!_0x5da10b['categories']||!Array['isArray'](_0x5da10b[_0x4f36e0(0xd0e)]))throw new Error(_0x4f36e0(0x12d4));await _0x4e1bbf['transaction']('rw',_0x4e1bbf[_0x4f36e0(0x760)],_0x4e1bbf[_0x4f36e0(0x135)],async()=>{const _0x376735=_0x4f36e0;for(const _0x9cc9e3 of _0x5da10b['categories']){let _0x5c6377;const _0x463bf8=await _0x4e1bbf[_0x376735(0x135)][_0x376735(0xec9)]('name')['equalsIgnoreCase'](_0x9cc9e3['name'])[_0x376735(0x5dd)]();_0x463bf8?_0x5c6377=_0x463bf8['id']:_0x5c6377=await _0x4e1bbf['shoppingCategories'][_0x376735(0xdda)]({'name':_0x9cc9e3['name']});const _0x75febb=_0x9cc9e3[_0x376735(0x1090)]['map'](_0x202e30=>{const _0x171c3c=_0x376735;return{'name':_0x202e30[_0x171c3c(0x6fc)],'price':_0x202e30[_0x171c3c(0xd5b)]||0x0,'description':_0x202e30[_0x171c3c(0x9af)]||'','imageUrl':_0x171c3c(0xb1f)+encodeURIComponent(_0x202e30[_0x171c3c(0x242)]),'variations':(_0x202e30[_0x171c3c(0x349)]||[])[_0x171c3c(0xb96)](_0x53b03c=>({..._0x53b03c,'imageUrl':'https://image.pollinations.ai/prompt/'+encodeURIComponent(_0x53b03c['image_prompt'])})),'categoryId':_0x5c6377};});_0x75febb[_0x376735(0x40f)]>0x0&&await _0x4e1bbf[_0x376735(0x760)]['bulkAdd'](_0x75febb);}}),activeShoppingCategoryId=_0x4f36e0(0xfd7),await _0x515ef1(),await _0x28974b(_0x4f36e0(0x107e),'为“'+_0x2aa304[_0x4f36e0(0x6fc)]+_0x4f36e0(0x235));}catch(_0x12ed0a){console[_0x4f36e0(0xc60)](_0x4f36e0(0xc1e),_0x12ed0a),await _0x28974b('生成失败',_0x4f36e0(0xbbb)+_0x12ed0a[_0x4f36e0(0x854)]);}}async function _0x22cd21(_0x3548e4){const _0x5b77cb=_0x5a7792,_0x18a513=document[_0x5b77cb(0x64f)](_0x3548e4);if(!_0x18a513)return;const _0x1e20ee=await _0x217169(_0x5b77cb(0x1187),[{'text':'📁\x20从本地上传','value':_0x5b77cb(0x2a2)},{'text':'🌐\x20使用网络URL','value':_0x5b77cb(0xe52)}]);let _0x281817=null;if(_0x1e20ee===_0x5b77cb(0x2a2))_0x281817=await _0x44b2ac();else _0x1e20ee==='url'&&(_0x281817=await _0x41e3f8(_0x5b77cb(0x1187),_0x5b77cb(0x13a4),_0x18a513[_0x5b77cb(0xbe8)],_0x5b77cb(0xe52)));if(_0x281817&&_0x281817[_0x5b77cb(0x43a)]()){const _0xdb3107=_0x281817[_0x5b77cb(0x43a)]();_0x18a513[_0x5b77cb(0xbe8)]=_0xdb3107,!_0x3e7a1b[_0x5b77cb(0x11b4)][_0x5b77cb(0x9cc)]&&(_0x3e7a1b[_0x5b77cb(0x11b4)][_0x5b77cb(0x9cc)]={}),_0x3e7a1b[_0x5b77cb(0x11b4)]['widgetData'][_0x3548e4]=_0xdb3107,await _0x4e1bbf[_0x5b77cb(0x11b4)][_0x5b77cb(0x4fa)](_0x3e7a1b[_0x5b77cb(0x11b4)]),await _0x28974b('成功',_0x5b77cb(0x311));}}window[_0x5a7792(0x704)]=_0x22cd21;async function _0x32ab55(){const _0x6c53db=_0x5a7792;if(!window[_0x6c53db(0x764)]){alert(_0x6c53db(0x1383));return;}await _0x28974b(_0x6c53db(0x4e0),_0x6c53db(0xd80));const _0x45858b=streamSaver[_0x6c53db(0xddd)](_0x6c53db(0xa8a)+new Date()[_0x6c53db(0x5f8)]()[_0x6c53db(0x108c)]('T')[0x0]+_0x6c53db(0xec)),_0x5721b=_0x45858b[_0x6c53db(0x72f)](),_0x5af164=new TextEncoder();try{await _0x5721b[_0x6c53db(0x214)](_0x5af164[_0x6c53db(0x1096)]('{\x0a\x22version\x22:\x203,\x0a\x22timestamp\x22:\x20'+Date[_0x6c53db(0x2b5)]()+_0x6c53db(0xf46)));const _0x15886d=await _0x4e1bbf[_0x6c53db(0x1a2)]['map'](_0xa9fc20=>_0xa9fc20[_0x6c53db(0x6fc)]);for(let _0x37ad8b=0x0;_0x37ad8b<_0x15886d[_0x6c53db(0x40f)];_0x37ad8b++){const _0x70f975=_0x15886d[_0x37ad8b],_0xc9e152=_0x4e1bbf[_0x6c53db(0x13ac)](_0x70f975);await _0x5721b['write'](_0x5af164[_0x6c53db(0x1096)]('\x22'+_0x70f975+'\x22:\x20[\x0a'));let _0x4fe333=!![];await _0xc9e152[_0x6c53db(0xf9e)](_0x4e5cc4=>{const _0x373b39=_0x6c53db;!_0x4fe333&&_0x5721b['write'](_0x5af164[_0x373b39(0x1096)](',\x0a')),_0x5721b[_0x373b39(0x214)](_0x5af164[_0x373b39(0x1096)](JSON[_0x373b39(0xe3f)](_0x4e5cc4))),_0x4fe333=![];}),await _0x5721b[_0x6c53db(0x214)](_0x5af164[_0x6c53db(0x1096)]('\x0a]')),_0x37ad8b<_0x15886d['length']-0x1&&await _0x5721b['write'](_0x5af164[_0x6c53db(0x1096)](',\x0a'));}await _0x5721b[_0x6c53db(0x214)](_0x5af164[_0x6c53db(0x1096)](_0x6c53db(0xd8e)));}catch(_0x24c6da){console[_0x6c53db(0xc60)]('流式导出过程中出错:',_0x24c6da),await _0x28974b(_0x6c53db(0xf17),'在写入文件流时发生错误:\x20'+_0x24c6da['message']);}finally{await _0x5721b[_0x6c53db(0x684)]();}}async function _0xbec9da(){const _0x34519f=_0x5a7792;await _0x28974b(_0x34519f(0x4e0),_0x34519f(0x4a3));try{const _0x3953fa={'version':0x3,'timestamp':Date[_0x34519f(0x2b5)](),'data':{}},_0x26f823=_0x4e1bbf[_0x34519f(0x1a2)][_0x34519f(0xb96)](_0x5b75ff=>_0x5b75ff['name']);for(const _0x30d1ae of _0x26f823){const _0x13b233=await _0x4e1bbf['table'](_0x30d1ae)['toArray']();_0x3953fa[_0x34519f(0x88a)][_0x30d1ae]=_0x13b233,console[_0x34519f(0x1081)](_0x34519f(0x7cf)+_0x30d1ae+',\x20记录数:\x20'+_0x13b233[_0x34519f(0x40f)]);}const _0x56bb2e=new Blob([JSON[_0x34519f(0xe3f)](_0x3953fa,null,0x2)],{'type':_0x34519f(0x7fe)}),_0x824f2=URL[_0x34519f(0xb29)](_0x56bb2e),_0x19512b=document[_0x34519f(0x124e)]('a');_0x19512b[_0x34519f(0x1210)]=_0x824f2,_0x19512b[_0x34519f(0x1134)]=_0x34519f(0xcab)+new Date()[_0x34519f(0x5f8)]()['split']('T')[0x0]+_0x34519f(0xec),_0x19512b['click'](),URL[_0x34519f(0x74f)](_0x824f2),await _0x28974b(_0x34519f(0x43f),_0x34519f(0x2cd));}catch(_0x4f7fdd){console[_0x34519f(0xc60)]('传统导出数据时出错:',_0x4f7fdd),await _0x28974b(_0x34519f(0xf17),_0x34519f(0xcba)+_0x4f7fdd['message']);}}function _0x1cc461(){const _0xea8f12=_0x5a7792,_0x1b52cc=Object[_0xea8f12(0xd6d)](_0x3e7a1b['chats'])[_0xea8f12(0x213)]((_0x5bfdd4,_0x4d5222)=>{if(_0x4d5222['id']===_0x3e7a1b['activeChatId'])return _0x5bfdd4;return _0x5bfdd4+(_0x4d5222['unreadCount']||0x0);},0x0),_0x3ff966=_0x511de0||0x0,_0x175251=_0x1b52cc+_0x3ff966,_0x3da650=document['getElementById'](_0xea8f12(0xaae));if(!_0x3da650)return;let _0x272cd2=_0x3da650['querySelector']('.unread-indicator');!_0x272cd2&&(_0x272cd2=document[_0xea8f12(0x124e)](_0xea8f12(0xd84)),_0x272cd2['className']='unread-indicator',_0x3da650[_0xea8f12(0x99e)](_0x272cd2));let _0x1001a5=_0x3da650[_0xea8f12(0x49c)](_0xea8f12(0x571));_0x1001a5&&_0x1001a5['remove'](),_0x175251>0x0?(_0x272cd2[_0xea8f12(0xee5)]=_0x175251>0x63?_0xea8f12(0x13cf):_0x175251,_0x272cd2[_0xea8f12(0x731)][_0xea8f12(0x130)]=_0xea8f12(0xb37),_0x272cd2[_0xea8f12(0x731)][_0xea8f12(0xe85)]='20',_0x272cd2[_0xea8f12(0x731)][_0xea8f12(0x70b)]=_0xea8f12(0x105e)):_0x272cd2[_0xea8f12(0x731)]['display']=_0xea8f12(0x1209);}async function _0x5cde27(_0x249d42){const _0x479e21=_0x5a7792,_0x4e9697=_0x249d42===_0x479e21(0xf60)?{'id':'uncategorized','name':_0x479e21(0xaf0)}:await _0x4e1bbf[_0x479e21(0xd8d)][_0x479e21(0x11fc)](_0x249d42);if(!_0x4e9697){console[_0x479e21(0xc60)]('无法为不存在的分类打开绑定模态框:',_0x249d42);return;}const _0x4d8738=document['getElementById']('sticker-binding-modal'),_0x2a5b01=document[_0x479e21(0x64f)]('sticker-binding-chat-list'),_0x281955=_0x4d8738[_0x479e21(0x49c)](_0x479e21(0x631));_0x2a5b01[_0x479e21(0xc58)]='',_0x281955['textContent']='将分类\x20“'+_0x4e9697['name']+'”\x20绑定到...';const _0x53bc4c=Object[_0x479e21(0xd6d)](_0x3e7a1b[_0x479e21(0x999)])[_0x479e21(0x102f)]((_0x3f34fe,_0xadd721)=>_0x3f34fe[_0x479e21(0x6fc)][_0x479e21(0x107)](_0xadd721[_0x479e21(0x6fc)],_0x479e21(0x6ec)));_0x53bc4c[_0x479e21(0x103)](_0x390403=>{const _0x41314b=_0x479e21,_0x875aee=Array['isArray'](_0x390403[_0x41314b(0xcb3)]?.[_0x41314b(0x15d)])&&_0x390403[_0x41314b(0xcb3)]['stickerCategoryIds'][_0x41314b(0xe53)](_0x249d42),_0x4fef56=document[_0x41314b(0x124e)](_0x41314b(0x479));_0x4fef56[_0x41314b(0x87d)]=_0x41314b(0x6e3),_0x4fef56['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20class=\x22sticker-binding-checkbox\x22\x20data-chat-id=\x22'+_0x390403['id']+'\x22\x20'+(_0x875aee?_0x41314b(0xf1d):'')+_0x41314b(0xd2)+(_0x390403[_0x41314b(0x1167)]?_0x390403['settings'][_0x41314b(0x63a)]:_0x390403[_0x41314b(0xcb3)][_0x41314b(0x93)]||_0x54e358)+'\x22\x20class=\x22avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22name\x22>'+_0x390403[_0x41314b(0x6fc)]+_0x41314b(0xd82),_0x2a5b01['appendChild'](_0x4fef56);}),document['getElementById'](_0x479e21(0x9d4))[_0x479e21(0x113a)]=()=>_0x490fbb(_0x249d42),document[_0x479e21(0x64f)](_0x479e21(0x1e5))[_0x479e21(0x113a)]=()=>_0x4d8738['classList'][_0x479e21(0x1275)]('visible'),_0x4d8738[_0x479e21(0x418)][_0x479e21(0xdda)]('visible');}async function _0x490fbb(_0x3c445d){const _0x274f03=_0x5a7792,_0x10ef2c=new Set(Array['from'](document[_0x274f03(0x233)](_0x274f03(0x136f)))['map'](_0x134fd4=>_0x134fd4[_0x274f03(0x12e1)][_0x274f03(0x367)])),_0x16e5df=[];for(const _0x154441 in _0x3e7a1b[_0x274f03(0x999)]){const _0x448a81=_0x3e7a1b['chats'][_0x154441];!Array[_0x274f03(0x97e)](_0x448a81[_0x274f03(0xcb3)][_0x274f03(0x15d)])&&(_0x448a81[_0x274f03(0xcb3)]['stickerCategoryIds']=[]);const _0x558e80=_0x448a81[_0x274f03(0xcb3)][_0x274f03(0x15d)][_0x274f03(0xe53)](_0x3c445d),_0x38dfaa=_0x10ef2c[_0x274f03(0x2a6)](_0x154441);if(_0x558e80&&!_0x38dfaa)_0x448a81[_0x274f03(0xcb3)][_0x274f03(0x15d)]=_0x448a81['settings'][_0x274f03(0x15d)]['filter'](_0x33a674=>_0x33a674!==_0x3c445d),_0x16e5df[_0x274f03(0x13ee)](_0x448a81);else!_0x558e80&&_0x38dfaa&&(_0x448a81['settings'][_0x274f03(0x15d)][_0x274f03(0x13ee)](_0x3c445d),_0x16e5df[_0x274f03(0x13ee)](_0x448a81));}_0x16e5df[_0x274f03(0x40f)]>0x0&&(await _0x4e1bbf[_0x274f03(0x999)][_0x274f03(0x1281)](_0x16e5df),await _0x28974b(_0x274f03(0x12e8),_0x274f03(0x886))),document[_0x274f03(0x64f)]('sticker-binding-modal')[_0x274f03(0x418)][_0x274f03(0x1275)](_0x274f03(0x40a));}function _0x5530dc(_0x284dd7){const _0xa64968=_0x5a7792;if(!_0x284dd7||!_0x284dd7[_0xa64968(0xcb3)][_0xa64968(0x15d)]||_0x284dd7['settings'][_0xa64968(0x15d)][_0xa64968(0x40f)]===0x0)return'';const _0x25ae8a=_0x284dd7[_0xa64968(0xcb3)][_0xa64968(0x15d)];let _0x8dfa41=[];const _0x450bf2=new Set();_0x25ae8a[_0xa64968(0x103)](_0x1021c3=>{const _0x26f164=_0xa64968;let _0x16cdc7;_0x1021c3==='uncategorized'?_0x16cdc7=_0x3e7a1b[_0x26f164(0xa8b)][_0x26f164(0x156)](_0xaf8f50=>!_0xaf8f50['categoryId']):_0x16cdc7=_0x3e7a1b[_0x26f164(0xa8b)]['filter'](_0x22b137=>_0x22b137[_0x26f164(0xcd3)]===_0x1021c3),_0x16cdc7[_0x26f164(0x103)](_0x17191f=>{const _0x3e46ab=_0x26f164;!_0x450bf2[_0x3e46ab(0x2a6)](_0x17191f[_0x3e46ab(0x6fc)])&&(_0x8dfa41[_0x3e46ab(0x13ee)](_0x17191f),_0x450bf2[_0x3e46ab(0xdda)](_0x17191f[_0x3e46ab(0x6fc)]));});});if(_0x8dfa41['length']===0x0)return'';const _0x40fce9=_0x8dfa41['map'](_0x2fbeae=>'-\x20'+_0x2fbeae[_0xa64968(0x6fc)])['join']('\x0a');return'\x0a#\x20可用表情包\x20(优先使用)\x0a-\x20请根据当前情景和你的情绪，从列表中【选择一个最合适的】表情含义来使用\x20\x22sticker\x22\x20指令。尽量让你的表情丰富多样，避免重复。\x0a'+_0x40fce9+'\x0a';}function _0x2beb71(_0x5475b1){const _0x5d1d0c=_0x5a7792;if(!_0x5475b1||!_0x5475b1[_0x5d1d0c(0x1167)])return'';let _0xf86f3b='\x0a#\x20可用表情包\x20(优先使用)\x0a每个AI角色都被设置了专属表情包，在需要发送表情时，他们应该【优先】从自己的专属列表中选择。尽量让你的表情丰富多样，避免重复。\x0a',_0x2b3bd5=![];return _0x5475b1[_0x5d1d0c(0x5d4)][_0x5d1d0c(0x103)](_0x29f97c=>{const _0x50ee4a=_0x5d1d0c;if(_0x29f97c['id']===_0x50ee4a(0xa4d))return;const _0x5546d8=_0x3e7a1b['chats'][_0x29f97c['id']];if(_0x5546d8&&_0x5546d8['settings'][_0x50ee4a(0x15d)]&&_0x5546d8[_0x50ee4a(0xcb3)][_0x50ee4a(0x15d)][_0x50ee4a(0x40f)]>0x0){const _0x18d83c=_0x5546d8['settings'][_0x50ee4a(0x15d)];let _0x3bb428=[];const _0x5a8c19=new Set();_0x18d83c['forEach'](_0x417d05=>{const _0x4ed466=_0x50ee4a;let _0x217fdf;_0x417d05==='uncategorized'?_0x217fdf=_0x3e7a1b[_0x4ed466(0xa8b)][_0x4ed466(0x156)](_0x262327=>!_0x262327[_0x4ed466(0xcd3)]):_0x217fdf=_0x3e7a1b[_0x4ed466(0xa8b)][_0x4ed466(0x156)](_0xebea59=>_0xebea59[_0x4ed466(0xcd3)]===_0x417d05),_0x217fdf[_0x4ed466(0x103)](_0x47fede=>{const _0x9ae3e6=_0x4ed466;!_0x5a8c19['has'](_0x47fede[_0x9ae3e6(0x6fc)])&&(_0x3bb428[_0x9ae3e6(0x13ee)](_0x47fede),_0x5a8c19[_0x9ae3e6(0xdda)](_0x47fede[_0x9ae3e6(0x6fc)]));});}),_0x3bb428[_0x50ee4a(0x40f)]>0x0&&(_0x2b3bd5=!![],_0xf86f3b+=_0x50ee4a(0x726)+_0x29f97c[_0x50ee4a(0x287)]+_0x50ee4a(0xbfe)+_0x29f97c[_0x50ee4a(0x7de)]+')\x20的可用表情:\x0a',_0xf86f3b+=_0x3bb428[_0x50ee4a(0xb96)](_0x4ed5a2=>'-\x20'+_0x4ed5a2[_0x50ee4a(0x6fc)])[_0x50ee4a(0xd22)]('\x0a'));}}),_0x2b3bd5?_0xf86f3b:'';}function _0x37e99e(_0x53374b){const _0x5931d3=_0x5a7792;if(!_0x53374b)return 0x0;return Math['ceil'](_0x53374b[_0x5931d3(0x40f)]/1.5);}async function _0x1b87ab(){const _0xb274e1=_0x5a7792;if(!_0x3e7a1b[_0xb274e1(0x777)])return 0x0;const _0x22d7e3=_0x3e7a1b[_0xb274e1(0x999)][_0x3e7a1b['activeChatId']];if(!_0x22d7e3)return 0x0;const _0x1d46d0=parseInt(document['getElementById'](_0xb274e1(0xdb1))[_0xb274e1(0xbed)])||0xa,_0x471b6e=parseInt(document[_0xb274e1(0x64f)]('linked-memory-count')[_0xb274e1(0xbed)])||0xa,_0x457ee2=document[_0xb274e1(0x64f)](_0xb274e1(0x101b))[_0xb274e1(0xf1d)],_0x2beba2=document[_0xb274e1(0x64f)](_0xb274e1(0xcac))['value'],_0x4d53e9=document[_0xb274e1(0x64f)](_0xb274e1(0x97b))[_0xb274e1(0xbed)];let _0x217af6='';const _0x5e3110=Array[_0xb274e1(0xb3a)](document['querySelectorAll']('#world-book-checkboxes-container\x20input:checked'))[_0xb274e1(0xb96)](_0xb7fc7=>_0xb7fc7[_0xb274e1(0xbed)][_0xb274e1(0x137f)]('book_',''));if(_0x5e3110[_0xb274e1(0x40f)]>0x0){const _0x52c033=_0x5e3110['map'](_0xf2b986=>{const _0x4fbb8a=_0xb274e1,_0x2cb280=_0x3e7a1b[_0x4fbb8a(0x144)]['find'](_0x128b71=>_0x128b71['id']===_0xf2b986);if(!_0x2cb280||!Array[_0x4fbb8a(0x97e)](_0x2cb280[_0x4fbb8a(0x3ba)]))return'';return _0x2cb280[_0x4fbb8a(0x3ba)][_0x4fbb8a(0x156)](_0xa0fc66=>_0xa0fc66[_0x4fbb8a(0x9b)]!==![])[_0x4fbb8a(0xb96)](_0x1dd0c4=>_0x1dd0c4[_0x4fbb8a(0x3ba)])['join']('\x0a');})[_0xb274e1(0x156)](Boolean)['join']('\x0a');_0x217af6+=_0x52c033;}_0x22d7e3['longTermMemory']&&_0x22d7e3[_0xb274e1(0x518)][_0xb274e1(0x40f)]>0x0&&(_0x217af6+=_0x22d7e3['longTermMemory'][_0xb274e1(0xb96)](_0x29227d=>_0x29227d['content'])[_0xb274e1(0xd22)]('\x0a'));const _0x48a28a=document[_0xb274e1(0x64f)](_0xb274e1(0xe7d))['checked'];if(_0x48a28a){const _0x3f19ff=Array[_0xb274e1(0xb3a)](document['querySelectorAll'](_0xb274e1(0x1ef)))[_0xb274e1(0xb96)](_0x113379=>_0x113379[_0xb274e1(0xbed)]);for(const _0x303e1b of _0x3f19ff){const _0x4fb818=_0x3e7a1b[_0xb274e1(0x999)][_0x303e1b];_0x4fb818&&_0x4fb818[_0xb274e1(0x830)][_0xb274e1(0x40f)]>0x0&&(_0x217af6+=_0x4fb818[_0xb274e1(0x830)][_0xb274e1(0xdf5)](-_0x471b6e)[_0xb274e1(0xb96)](_0x2d8e32=>String(_0x2d8e32[_0xb274e1(0x3ba)]))['join']('\x0a'));}}_0x22d7e3[_0xb274e1(0x1167)]?_0x22d7e3[_0xb274e1(0x5d4)][_0xb274e1(0x103)](_0x59eb85=>{const _0x502ad5=_0xb274e1;_0x217af6+=_0x59eb85[_0x502ad5(0x324)];}):_0x217af6+=_0x2beba2;_0x217af6+=_0x4d53e9,_0x217af6+=_0x5530dc(_0x22d7e3);_0x22d7e3[_0xb274e1(0x1167)]&&(_0x217af6+=_0x2beb71(_0x22d7e3));if(!_0x22d7e3['isGroup']&&_0x457ee2){const _0x1053e8=document['getElementById'](_0xb274e1(0xee8))['value'];if(_0x1053e8){const _0xbb52dc=_0x3e7a1b[_0xb274e1(0x19c)][_0xb274e1(0x137)](_0x24e2b3=>_0x24e2b3['id']===_0x1053e8);_0xbb52dc&&(_0x217af6+=_0xbb52dc[_0xb274e1(0x3ba)][_0xb274e1(0x156)](_0x2bc36b=>_0x2bc36b[_0xb274e1(0x9b)]!==![])[_0xb274e1(0xb96)](_0x1cc3ad=>_0x1cc3ad[_0xb274e1(0x3ba)])['join']('\x0a'));}}const _0x50c041=_0x22d7e3[_0xb274e1(0x830)]['slice'](-_0x1d46d0);return _0x217af6+=_0x50c041[_0xb274e1(0xb96)](_0x2251d1=>{const _0x32c820=_0xb274e1;if(typeof _0x2251d1[_0x32c820(0x3ba)]===_0x32c820(0x1251))return _0x2251d1[_0x32c820(0x3ba)];if(Array['isArray'](_0x2251d1[_0x32c820(0x3ba)]))return _0x2251d1[_0x32c820(0x3ba)][_0x32c820(0xb96)](_0x315839=>_0x315839['text'])[_0x32c820(0xd22)]('\x20');return'';})[_0xb274e1(0xd22)]('\x0a'),_0x37e99e(_0x217af6);}const _0x3fe71e=_0x189dd1(async()=>{const _0x46aec7=_0x5a7792,_0x252726=document[_0x46aec7(0x64f)]('token-count-display');if(!_0x252726)return;_0x252726[_0x46aec7(0xc58)]='\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-label\x22>正在计算...</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22token-count-value\x22>--</span>\x0a\x20\x20\x20\x20';try{const _0x4fda8c=await _0x1b87ab();_0x252726[_0x46aec7(0xc58)]=_0x46aec7(0x21f)+_0x4fda8c+_0x46aec7(0xb87);}catch(_0x584585){console['error']('Token\x20calculation\x20error:',_0x584585),_0x252726[_0x46aec7(0xc58)]=_0x46aec7(0x4b2);}},0x12c);async function _0x11db7f(){const _0x48ab24=_0x5a7792,_0x3a8a28=document[_0x48ab24(0x64f)](_0x48ab24(0xcee));_0x3a8a28[_0x48ab24(0xc58)]='',_0x15f3ec=[],_0x544cb0=0x0,_0x4614b0=![];const _0x484f32=[];try{const _0x4959cb=await _0x4e1bbf['chats']['toArray']();for(const _0x14c45a of _0x4959cb){_0x14c45a[_0x48ab24(0x830)]&&_0x14c45a['history'][_0x48ab24(0x40f)]>0x0&&_0x14c45a[_0x48ab24(0x830)][_0x48ab24(0x103)](_0x20054a=>{const _0x3b03cc=_0x48ab24;_0x20054a[_0x3b03cc(0xafc)]===_0x3b03cc(0x13df)&&_0x20054a[_0x3b03cc(0xd07)]&&_0x484f32[_0x3b03cc(0x13ee)]({'sourceType':'chat','imageUrl':_0x20054a['imageUrl'],'prompt':_0x20054a[_0x3b03cc(0x1381)]||_0x20054a['fullPrompt']||_0x3b03cc(0x794),'chatId':_0x14c45a['id'],'msgTimestamp':_0x20054a[_0x3b03cc(0x8af)]});});}}catch(_0x182684){console[_0x48ab24(0xc60)]('扫描聊天记录失败:',_0x182684);}try{const _0x2085e8=await _0x4e1bbf['qzonePosts'][_0x48ab24(0x78f)]();_0x2085e8['forEach'](_0x57904a=>{const _0x334256=_0x48ab24;if(_0x57904a[_0x334256(0xafc)]===_0x334256(0x13df)){const _0x278f96=_0x57904a[_0x334256(0x1191)]||(_0x57904a[_0x334256(0xd07)]?[_0x57904a['imageUrl']]:[]),_0x57c097=Array[_0x334256(0x97e)](_0x57904a['prompt'])?_0x57904a[_0x334256(0x1381)]:[_0x57904a['prompt']||_0x334256(0x794)];_0x278f96[_0x334256(0x103)]((_0xf76487,_0x3eb6ac)=>{const _0x478b9a=_0x334256;_0x484f32[_0x478b9a(0x13ee)]({'sourceType':_0x478b9a(0x1220),'imageUrl':_0xf76487,'prompt':_0x57c097[_0x3eb6ac]||_0x57c097[0x0],'postId':_0x57904a['id'],'imageIndex':_0x3eb6ac});});}});}catch(_0x5e0735){console[_0x48ab24(0xc60)](_0x48ab24(0x37d),_0x5e0735);}_0x15f3ec=_0x484f32['sort']((_0x5b7edd,_0x2156ae)=>(_0x2156ae['msgTimestamp']||_0x2156ae['postId']||0x0)-(_0x5b7edd[_0x48ab24(0xd54)]||_0x5b7edd[_0x48ab24(0x6c2)]||0x0)),_0x15f3ec[_0x48ab24(0x40f)]===0x0?_0x3a8a28['innerHTML']=_0x48ab24(0x420):_0x36404a(),document['getElementById']('nai-gallery-panel')[_0x48ab24(0x418)][_0x48ab24(0xdda)](_0x48ab24(0x40a));}function _0x1fb0be(_0x1bd702){const _0x3c79fe=_0x5a7792,_0x189ed5=document['getElementById'](_0x3c79fe(0xcee));if(_0x1bd702[_0x3c79fe(0x40f)]===0x0&&_0x544cb0===0x0){_0x189ed5[_0x3c79fe(0xc58)]=_0x3c79fe(0x420);return;}const _0x54a2cd=document['createDocumentFragment']();_0x1bd702[_0x3c79fe(0x103)]((_0xffc57b,_0x188efc)=>{const _0x4976a1=_0x3c79fe,_0x228d70=document[_0x4976a1(0x124e)](_0x4976a1(0x479));_0x228d70['className']=_0x4976a1(0x7ec),_0x228d70['title']=_0xffc57b[_0x4976a1(0x1381)];const _0x377ec1=_0xffc57b['sourceType']+'_'+(_0xffc57b['chatId']||_0xffc57b['postId'])+'_'+(_0xffc57b[_0x4976a1(0xd54)]||_0xffc57b['imageIndex']);_0x228d70['dataset'][_0x4976a1(0xf2f)]=_0x377ec1,_0x228d70[_0x4976a1(0x12e1)]['imageUrl']=_0xffc57b[_0x4976a1(0xd07)],_0x228d70[_0x4976a1(0x12e1)][_0x4976a1(0x1381)]=_0xffc57b[_0x4976a1(0x1381)],_0x228d70['innerHTML']='\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22nai-image-container\x22\x20style=\x22background-image:\x20url('+_0xffc57b[_0x4976a1(0xd07)]+_0x4976a1(0xc21)+_0xffc57b[_0x4976a1(0x1381)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20',_0x54a2cd[_0x4976a1(0x99e)](_0x228d70);}),_0x189ed5[_0x3c79fe(0x99e)](_0x54a2cd);}async function _0x36404a(){const _0x42f5d5=_0x5a7792;if(_0x4614b0||_0x544cb0>=_0x15f3ec[_0x42f5d5(0x40f)])return;_0x4614b0=!![];const _0x477ab0=document['getElementById'](_0x42f5d5(0xcee));_0x429707(_0x477ab0,_0x42f5d5(0x8da)),setTimeout(()=>{const _0x4ad7fa=_0x42f5d5,_0x390fb6=_0x15f3ec['slice'](_0x544cb0,_0x544cb0+_0x5b0b36);_0x23b212(_0x477ab0),_0x390fb6[_0x4ad7fa(0x40f)]>0x0&&(_0x1fb0be(_0x390fb6),_0x544cb0+=_0x390fb6['length']),_0x4614b0=![];},0x1f4);}function _0x34cd5c(){const _0x2ff6c5=_0x5a7792;_0x282190=!_0x282190;const _0x2ff43d=document[_0x2ff6c5(0x64f)](_0x2ff6c5(0xcee)),_0x20b8b8=document[_0x2ff6c5(0x64f)](_0x2ff6c5(0x2ff)),_0x30c566=document[_0x2ff6c5(0x64f)](_0x2ff6c5(0x1235)),_0x2dc2e7=document['getElementById'](_0x2ff6c5(0x6c0));_0x2ff43d[_0x2ff6c5(0x418)][_0x2ff6c5(0x5cf)](_0x2ff6c5(0xeea),_0x282190),_0x282190?(_0x20b8b8[_0x2ff6c5(0xee5)]='完成',_0x30c566['style'][_0x2ff6c5(0x130)]='flex',_0x22ae70['clear'](),_0x2dc2e7[_0x2ff6c5(0xf1d)]=![],_0xa2e645()):(_0x20b8b8[_0x2ff6c5(0xee5)]='管理',_0x30c566[_0x2ff6c5(0x731)]['display']=_0x2ff6c5(0x1209),_0x2ff43d[_0x2ff6c5(0x233)](_0x2ff6c5(0x618))['forEach'](_0x136006=>_0x136006[_0x2ff6c5(0x418)][_0x2ff6c5(0x1275)](_0x2ff6c5(0xbe6))));}function _0xa2e645(){const _0x34d187=_0x5a7792,_0x3befe3=document[_0x34d187(0x64f)](_0x34d187(0x114b)),_0x585aaa=document[_0x34d187(0x64f)](_0x34d187(0x555)),_0xba760c=_0x22ae70[_0x34d187(0x9dd)];if(_0x3befe3)_0x3befe3['textContent']=_0x34d187(0x83c)+_0xba760c+')';if(_0x585aaa)_0x585aaa[_0x34d187(0xee5)]=_0x34d187(0xe6b)+_0xba760c+')';}function _0x2abc41(_0x527cec){const _0x5a6254=_0x5a7792,_0x3b3dc0=_0x527cec[_0x5a6254(0xf5b)][_0x5a6254(0x2fc)]('.nai-gallery-item');if(!_0x3b3dc0)return;const _0x4c7344=_0x3b3dc0[_0x5a6254(0x12e1)][_0x5a6254(0xf2f)],_0x29c0f9=_0x3b3dc0['dataset']['imageUrl'],_0x334f73=_0x3b3dc0[_0x5a6254(0x12e1)]['prompt'];if(_0x527cec[_0x5a6254(0xf5b)][_0x5a6254(0x2fc)](_0x5a6254(0xf74))){_0x527cec['stopPropagation'](),_0x235a22(_0x29c0f9,_0x334f73);return;}if(_0x527cec['target'][_0x5a6254(0x2fc)]('.nai-gallery-delete-btn')){_0x527cec[_0x5a6254(0x61c)](),_0x412392(new Set([_0x4c7344]));return;}if(_0x282190)_0x3b3dc0[_0x5a6254(0x418)][_0x5a6254(0x5cf)](_0x5a6254(0xbe6)),_0x22ae70[_0x5a6254(0x2a6)](_0x4c7344)?_0x22ae70['delete'](_0x4c7344):_0x22ae70[_0x5a6254(0xdda)](_0x4c7344),_0xa2e645();else{const _0x2519f8=_0x5a6254(0x11b7),_0x1ab72a=_0x5a6254(0x5fe)+_0x29c0f9+_0x5a6254(0x1268);_0x28974b(_0x2519f8,_0x1ab72a);}}async function _0x19ced9(){const _0x35aafa=_0x5a7792,_0x1a1f63=_0x22ae70;if(_0x1a1f63['size']===0x0){alert(_0x35aafa(0x9f6));return;}if(typeof JSZip===_0x35aafa(0x3a3)||!window[_0x35aafa(0x764)]){await _0x28974b('下载失败',_0x35aafa(0x6df));return;}await _0x28974b(_0x35aafa(0x2f7),_0x35aafa(0xa25)+_0x1a1f63[_0x35aafa(0x9dd)]+_0x35aafa(0x4e7));const _0x1fec99=new JSZip();let _0x44394e=0x0;const _0x3f2112=[];_0x1a1f63[_0x35aafa(0x103)](_0x5d062d=>{const _0x52a6a1=_0x35aafa,_0x8aef9e=document['querySelector']('.nai-gallery-item[data-key=\x22'+_0x5d062d+'\x22]');if(!_0x8aef9e)return;const _0x37e115=_0x8aef9e['dataset'][_0x52a6a1(0xd07)],_0x3e5f9b=_0x8aef9e['dataset']['prompt'],_0x3add7d=_0x3b1c72(_0x3e5f9b),_0x95fda9=((async()=>{const _0x5a1872=_0x52a6a1;try{let _0x37bb70;if(_0x37e115['startsWith']('data:')){const _0x446a6a=await fetch(_0x37e115);_0x37bb70=await _0x446a6a[_0x5a1872(0x1231)]();}else{let _0x1877fb;try{_0x1877fb=await fetch(_0x37e115,{'mode':_0x5a1872(0xfb0)});if(!_0x1877fb['ok'])throw new Error(_0x5a1872(0x5b9));}catch(_0x12d98a){console[_0x5a1872(0x1155)](_0x5a1872(0x5a6),_0x12d98a[_0x5a1872(0x854)]);const _0x3457c7=_0x4c8f8e();let _0x5b88d4=_0x3457c7[_0x5a1872(0x7b9)]==='custom'?_0x3457c7[_0x5a1872(0x5c3)]:_0x3457c7[_0x5a1872(0x7b9)];if(!_0x5b88d4||_0x5b88d4==='')_0x5b88d4=_0x5a1872(0x64c);const _0x3422af=_0x5b88d4+encodeURIComponent(_0x37e115);_0x1877fb=await fetch(_0x3422af);}if(!_0x1877fb['ok'])throw new Error(_0x5a1872(0xa80)+_0x1877fb['status']);_0x37bb70=await _0x1877fb[_0x5a1872(0x1231)]();}_0x1fec99[_0x5a1872(0xb2b)](_0x3add7d,_0x37bb70,{'binary':!![]});}catch(_0xecfe8e){console[_0x5a1872(0xc60)]('下载图片失败:\x20'+_0x37e115,_0xecfe8e),_0x44394e++;}})());_0x3f2112[_0x52a6a1(0x13ee)](_0x95fda9);}),await Promise[_0x35aafa(0xfd7)](_0x3f2112);if(_0x44394e===_0x1a1f63['size']){await _0x28974b(_0x35aafa(0x80d),_0x35aafa(0x44f));return;}await _0x28974b('打包中...',_0x35aafa(0x3e7));try{const _0x9b6aac=streamSaver[_0x35aafa(0xddd)](_0x35aafa(0x46d)+Date['now']()+_0x35aafa(0x421)),_0xa694b2=_0x1fec99[_0x35aafa(0xc54)]({'type':'blob','streamFiles':!![]}),_0x106126=new ReadableStream({'start'(_0x3f41d6){const _0x3d55c9=_0x35aafa;_0xa694b2['on'](_0x3d55c9(0x88a),_0x281bb6=>{const _0x3133fa=_0x3d55c9;_0x3f41d6[_0x3133fa(0xdc0)](_0x281bb6);})['on'](_0x3d55c9(0x129f),()=>{const _0x238371=_0x3d55c9;console[_0x238371(0x1081)](_0x238371(0x875)),_0x3f41d6[_0x238371(0x684)]();})['on']('error',_0x2d66fb=>{const _0x20715e=_0x3d55c9;console[_0x20715e(0xc60)](_0x20715e(0x112f),_0x2d66fb),_0x3f41d6[_0x20715e(0xc60)](_0x2d66fb);})[_0x3d55c9(0xaee)]();}});await _0x106126[_0x35aafa(0x4c4)](_0x9b6aac),_0x44394e>0x0&&_0x28974b(_0x35aafa(0x379),_0x35aafa(0x5d8)+(_0x1a1f63[_0x35aafa(0x9dd)]-_0x44394e)+_0x35aafa(0x8d6)+_0x44394e+_0x35aafa(0x1c2));}catch(_0x123fcd){console[_0x35aafa(0xc60)]('流式下载ZIP失败:',_0x123fcd),await _0x28974b('流式下载失败',_0x35aafa(0xc52)+_0x123fcd[_0x35aafa(0x854)]);}}async function _0x412392(_0x549bea=null){const _0x1e94b7=_0x5a7792,_0x4ca15f=_0x549bea||_0x22ae70;if(_0x4ca15f['size']===0x0)return;const _0x2875ef=await _0x54149f(_0x1e94b7(0x13d2),_0x1e94b7(0xb34)+_0x4ca15f[_0x1e94b7(0x9dd)]+_0x1e94b7(0x3b9),{'confirmButtonClass':_0x1e94b7(0xeed)});if(!_0x2875ef)return;await _0x28974b(_0x1e94b7(0x2f7),'正在执行删除操作...');let _0x258ccd=0x0;const _0x475ead=new Map(),_0x4b33c3=new Set(),_0x3fe22c=new Map(),_0x22e678=new Set();for(const _0x46b71e of _0x4ca15f){if(_0x46b71e[_0x1e94b7(0x7d)]('qzone_')){const _0x187430=_0x46b71e['split']('_'),_0xcbb89e=parseInt(_0x187430[0x1]);!isNaN(_0xcbb89e)&&_0x22e678[_0x1e94b7(0xdda)](_0xcbb89e);}}const _0x43e5ac=new Map();if(_0x22e678[_0x1e94b7(0x9dd)]>0x0){const _0x457cb9=await _0x4e1bbf[_0x1e94b7(0xaf9)][_0x1e94b7(0xec9)]('id')[_0x1e94b7(0x4a0)](Array[_0x1e94b7(0xb3a)](_0x22e678))[_0x1e94b7(0x78f)]();_0x457cb9['forEach'](_0x27e78d=>_0x43e5ac[_0x1e94b7(0x125e)](_0x27e78d['id'],_0x27e78d));}for(const _0x4f61df of _0x4ca15f){const _0x5bc094=_0x4f61df[_0x1e94b7(0x108c)]('_');if(_0x5bc094[_0x1e94b7(0x40f)]<0x3){console['warn'](_0x1e94b7(0x1027),_0x4f61df);continue;}const _0x54c375=_0x5bc094[0x0],_0x4f227a=_0x5bc094[_0x1e94b7(0xa90)](),_0x12b332=_0x5bc094[_0x1e94b7(0xdf5)](0x1)[_0x1e94b7(0xd22)]('_');if(_0x54c375===_0x1e94b7(0xc09)){const _0x3de895=_0x12b332,_0xce43cb=parseInt(_0x4f227a);if(!_0x475ead['has'](_0x3de895)){const _0x1e17f0=await _0x4e1bbf[_0x1e94b7(0x999)][_0x1e94b7(0x11fc)](_0x3de895);if(_0x1e17f0)_0x475ead[_0x1e94b7(0x125e)](_0x3de895,_0x1e17f0);else{console[_0x1e94b7(0x1155)]('未找到\x20chatID:\x20'+_0x3de895+_0x1e94b7(0x98a));continue;}}const _0x122188=_0x475ead[_0x1e94b7(0x11fc)](_0x3de895);if(_0x122188&&_0x122188['history']){const _0x4cc85c=_0x122188[_0x1e94b7(0x830)]['length'];_0x122188['history']=_0x122188['history'][_0x1e94b7(0x156)](_0x48b87d=>_0x48b87d[_0x1e94b7(0x8af)]!==_0xce43cb),_0x122188[_0x1e94b7(0x830)][_0x1e94b7(0x40f)]<_0x4cc85c&&(_0x258ccd++,_0x475ead['set'](_0x3de895,_0x122188));}}else{if(_0x54c375===_0x1e94b7(0x1220)){const _0x163b22=parseInt(_0x12b332),_0xf2fa67=parseInt(_0x4f227a),_0x451fb7=_0x3fe22c[_0x1e94b7(0x11fc)](_0x163b22)||_0x43e5ac[_0x1e94b7(0x11fc)](_0x163b22);if(!_0x451fb7){console[_0x1e94b7(0x1155)](_0x1e94b7(0x674)+_0x163b22+_0x1e94b7(0x98a));continue;}const _0x1bbe84=_0x451fb7[_0x1e94b7(0x1191)]||(_0x451fb7[_0x1e94b7(0xd07)]?[_0x451fb7[_0x1e94b7(0xd07)]]:[]);if(_0x1bbe84[_0x1e94b7(0x40f)]<=0x1)_0x4b33c3[_0x1e94b7(0xdda)](_0x163b22),_0x3fe22c[_0x1e94b7(0x2a6)](_0x163b22)&&_0x3fe22c[_0x1e94b7(0x3aa)](_0x163b22);else{const _0x3849f0=_0x1bbe84[_0xf2fa67];_0x451fb7[_0x1e94b7(0x1191)]=_0x451fb7[_0x1e94b7(0x1191)][_0x1e94b7(0x156)](_0x5cf971=>_0x5cf971!==_0x3849f0),_0x451fb7[_0x1e94b7(0x1381)]&&Array[_0x1e94b7(0x97e)](_0x451fb7[_0x1e94b7(0x1381)])&&_0x451fb7[_0x1e94b7(0x1381)][_0xf2fa67]&&_0x451fb7[_0x1e94b7(0x1381)][_0x1e94b7(0x10f9)](_0xf2fa67,0x1),_0x451fb7[_0x1e94b7(0xd07)]=_0x451fb7['imageUrls'][0x0]||null,_0x3fe22c[_0x1e94b7(0x125e)](_0x163b22,_0x451fb7);}_0x258ccd++;}}}try{await _0x4e1bbf[_0x1e94b7(0x62a)]('rw',_0x4e1bbf['chats'],_0x4e1bbf[_0x1e94b7(0xaf9)],async()=>{const _0x4b3963=_0x1e94b7;_0x475ead[_0x4b3963(0x9dd)]>0x0&&await _0x4e1bbf[_0x4b3963(0x999)][_0x4b3963(0x1281)](Array[_0x4b3963(0xb3a)](_0x475ead[_0x4b3963(0xd6d)]())),_0x3fe22c[_0x4b3963(0x9dd)]>0x0&&await _0x4e1bbf[_0x4b3963(0xaf9)]['bulkPut'](Array[_0x4b3963(0xb3a)](_0x3fe22c[_0x4b3963(0xd6d)]())),_0x4b33c3['size']>0x0&&await _0x4e1bbf['qzonePosts'][_0x4b3963(0x303)](Array['from'](_0x4b33c3));}),_0x34cd5c(),await _0x11db7f(),await _0x28974b(_0x1e94b7(0x121d),_0x1e94b7(0xfd0)+_0x258ccd+_0x1e94b7(0xbc0)),document['getElementById'](_0x1e94b7(0x9aa))[_0x1e94b7(0x418)][_0x1e94b7(0xef6)](_0x1e94b7(0x12ef))&&_0x4817d1(_0x3e7a1b[_0x1e94b7(0x777)]),document[_0x1e94b7(0x64f)]('qzone-screen')[_0x1e94b7(0x418)][_0x1e94b7(0xef6)](_0x1e94b7(0x12ef))&&_0x40e6dd();}catch(_0x4a0b46){console[_0x1e94b7(0xc60)](_0x1e94b7(0xfdf),_0x4a0b46),await _0x28974b('删除失败',_0x1e94b7(0x549)+_0x4a0b46['message']);}}function _0x3b1c72(_0x2578d7){const _0xcba606=_0x5a7792,_0x58f10=_0x2578d7||'NAI_Image';let _0x5a4a2c=_0x58f10[_0xcba606(0x137f)](/[^a-zA-Z0-9\u4e00-\u9fa5\s]/g,'_')[_0xcba606(0x137f)](/\s+/g,'_')[_0xcba606(0x126f)](0x0,0x1e);!_0x5a4a2c&&(_0x5a4a2c=_0xcba606(0xc7b));const _0x56a075=new Date()[_0xcba606(0x5f8)]()[_0xcba606(0x137f)](/[-:]/g,'')[_0xcba606(0x137f)]('T','_')[_0xcba606(0x108c)]('.')[0x0];return _0x5a4a2c+'_'+_0x56a075+_0xcba606(0xcc4);}async function _0x2677fb(){const _0x412b05=_0x5a7792;initLanguage();async function _0x2a4d45(_0x4c4853){const _0x3eca53=_0x2bd6;if(!_0x4c4853)return;try{const _0x109324=await _0x4c4853[_0x3eca53(0x673)](),_0x547082=JSON[_0x3eca53(0x1214)](_0x109324);if(_0x547082[_0x3eca53(0xafc)]===_0x3eca53(0x17f))console[_0x3eca53(0x1081)](_0x3eca53(0xe5c)),await _0x10da6d(_0x547082);else{if(_0x547082['entries']&&typeof _0x547082['entries']===_0x3eca53(0x59a))console[_0x3eca53(0x1081)]('检测到\x20Tavern\x20AI\x20世界书文件，执行兼容导入...'),await _0x38b035(_0x547082,_0x4c4853[_0x3eca53(0x6fc)]);else throw new Error(_0x3eca53(0x615));}}catch(_0x1a5128){console['error']('导入世界书时出错:',_0x1a5128),await _0x28974b(_0x3eca53(0xae3),_0x3eca53(0xde)+_0x1a5128[_0x3eca53(0x854)]);}}async function _0x38b035(_0x1b797c,_0x30db38){const _0x112cc=_0x2bd6,_0x13e950=_0x30db38['replace'](/\.json$/i,''),_0x484c77=await _0x41e3f8(_0x112cc(0xbdd),'请为这本设定集命名：',_0x13e950);if(!_0x484c77||!_0x484c77[_0x112cc(0x43a)]()){alert(_0x112cc(0xf8a));return;}const _0x29a4dc=Object[_0x112cc(0xd6d)](_0x1b797c[_0x112cc(0x1052)])[_0x112cc(0xb96)](_0x3772c3=>{const _0x40de0f=_0x112cc;return{'keys':_0x3772c3[_0x40de0f(0xf2f)]||[],'comment':_0x3772c3[_0x40de0f(0x652)]||_0x40de0f(0x497),'content':_0x3772c3[_0x40de0f(0x3ba)]||'','enabled':!_0x3772c3['disable']};})[_0x112cc(0x156)](_0x4cdde3=>_0x4cdde3[_0x112cc(0x3ba)]);if(_0x29a4dc[_0x112cc(0x40f)]===0x0){alert('这个\x20Tavern\x20AI\x20世界书中没有找到任何有效的条目。');return;}const _0x3308d5={'id':_0x112cc(0x734)+Date['now'](),'name':_0x484c77[_0x112cc(0x43a)](),'content':_0x29a4dc,'categoryId':null};await _0x4e1bbf[_0x112cc(0x144)]['add'](_0x3308d5),_0x3e7a1b['worldBooks'][_0x112cc(0x13ee)](_0x3308d5),await _0x511a09(),await _0x28974b('导入成功！',_0x112cc(0xe34)+_0x484c77+'》。');}async function _0x2e0b82(){const _0x2c7262=_0x2bd6;try{const _0x4e2ad5=await _0x4e1bbf[_0x2c7262(0x144)][_0x2c7262(0x78f)](),_0x591d8f=await _0x4e1bbf[_0x2c7262(0x10bb)][_0x2c7262(0x78f)]();if(_0x4e2ad5[_0x2c7262(0x40f)]===0x0&&_0x591d8f['length']===0x0){alert(_0x2c7262(0x104b));return;}const _0x2d7f5e={'type':_0x2c7262(0x17f),'version':0x1,'timestamp':Date[_0x2c7262(0x2b5)](),'books':_0x4e2ad5,'categories':_0x591d8f},_0x2d76f2=new Blob([JSON[_0x2c7262(0xe3f)](_0x2d7f5e,null,0x2)],{'type':_0x2c7262(0x7fe)}),_0x1dd46f=URL[_0x2c7262(0xb29)](_0x2d76f2),_0x33b95b=document['createElement']('a');_0x33b95b['href']=_0x1dd46f,_0x33b95b[_0x2c7262(0x1134)]=_0x2c7262(0xe98)+new Date()[_0x2c7262(0x5f8)]()[_0x2c7262(0x108c)]('T')[0x0]+_0x2c7262(0xec),_0x33b95b['click'](),URL['revokeObjectURL'](_0x1dd46f),await _0x28974b(_0x2c7262(0x43f),_0x2c7262(0x126c));}catch(_0xfdd3f4){console['error'](_0x2c7262(0xa09),_0xfdd3f4),await _0x28974b(_0x2c7262(0xf17),_0x2c7262(0xcba)+_0xfdd3f4[_0x2c7262(0x854)]);}}async function _0x10da6d(_0x1ba1b3){const _0x2f19ce=_0x2bd6;try{if(_0x1ba1b3['type']!==_0x2f19ce(0x17f)||!_0x1ba1b3[_0x2f19ce(0x11d3)])throw new Error('文件格式不正确，这不是一个有效的世界书备份文件。');const _0x540e36=await _0x54149f(_0x2f19ce(0xe0),_0x2f19ce(0x51f),{'confirmButtonClass':_0x2f19ce(0xeed),'confirmText':'确认覆盖'});if(!_0x540e36)return;await _0x4e1bbf['transaction']('rw',_0x4e1bbf[_0x2f19ce(0x144)],_0x4e1bbf['worldBookCategories'],async()=>{const _0x35be9b=_0x2f19ce;await _0x4e1bbf[_0x35be9b(0x144)][_0x35be9b(0x1057)](),await _0x4e1bbf[_0x35be9b(0x10bb)]['clear'](),Array['isArray'](_0x1ba1b3['books'])&&await _0x4e1bbf['worldBooks'][_0x35be9b(0x1281)](_0x1ba1b3[_0x35be9b(0x11d3)]),Array['isArray'](_0x1ba1b3[_0x35be9b(0xd0e)])&&await _0x4e1bbf[_0x35be9b(0x10bb)]['bulkPut'](_0x1ba1b3[_0x35be9b(0xd0e)]);}),_0x3e7a1b[_0x2f19ce(0x144)]=await _0x4e1bbf[_0x2f19ce(0x144)][_0x2f19ce(0x78f)](),await _0x511a09(),await _0x28974b(_0x2f19ce(0x583),'世界书数据已成功恢复！');}catch(_0x4dc007){console[_0x2f19ce(0xc60)](_0x2f19ce(0x5df),_0x4dc007),await _0x28974b(_0x2f19ce(0xae3),_0x2f19ce(0xde)+_0x4dc007[_0x2f19ce(0x854)]);}}const _0x48b5b6=localStorage['getItem'](_0x412b05(0x700));if(_0x48b5b6){const _0x417c2f=(Date['now']()-parseInt(_0x48b5b6))/(0x3e8*0x3c);_0x417c2f>0x5&&_0x5cfb56(_0x417c2f);}_0x1048af(),window[_0x412b05(0xe8f)]=_0xddd8ae,window[_0x412b05(0x11e4)]=_0x111c32,window['handleListenTogetherClick']=_0x1819d1,window[_0x412b05(0x685)]=_0x3342b4,window[_0x412b05(0x85f)]=_0x2208c6,window[_0x412b05(0xd04)]=_0x30fea4,window['openCharWallet']=_0xe6af39,window[_0x412b05(0x70e)]=_0x47f3f4,window['openNpcEditor']=_0x228ec3;const _0x2ef5b7=document['createElement'](_0x412b05(0x479));_0x2ef5b7['id']=_0x412b05(0x874),_0x2ef5b7[_0x412b05(0xc58)]='<button\x20id=\x22delete-selected-stickers-btn\x22>删除\x20(0)</button>',document[_0x412b05(0x64f)]('sticker-panel')[_0x412b05(0x99e)](_0x2ef5b7);const _0x9d74b8=document[_0x412b05(0x124e)]('style');_0x9d74b8['id']=_0x412b05(0x544),document[_0x412b05(0x798)]['appendChild'](_0x9d74b8),_0x146c2e[_0x412b05(0xaab)]=document[_0x412b05(0x64f)](_0x412b05(0xe01)),_0x146c2e['gridEl']=document['getElementById'](_0x412b05(0x8bb));const _0x8f18dc=localStorage['getItem'](_0x412b05(0xae6))||_0x412b05(0xa4c);_0x2f9ff9(_0x8f18dc);const _0x20a6b9=document[_0x412b05(0x124e)](_0x412b05(0x731));_0x20a6b9['id']=_0x412b05(0xa02),document[_0x412b05(0x798)][_0x412b05(0x99e)](_0x20a6b9);const _0x3db33c=document[_0x412b05(0x124e)](_0x412b05(0x731));_0x3db33c['id']=_0x412b05(0xa64),document[_0x412b05(0x798)]['appendChild'](_0x3db33c),_0x1f54e5('','#chat-messages','custom-bubble-style'),_0x1f54e5('',_0x412b05(0x12dc),_0x412b05(0xa64)),window[_0x412b05(0x11e4)]=_0x111c32,window[_0x412b05(0xe8f)]=_0xddd8ae,window[_0x412b05(0x979)]=_0x21f6ea,window['renderApiSettingsProxy']=_0x1f482e,window[_0x412b05(0x8f5)]=_0x309ef1,window[_0x412b05(0x257)]=_0x511a09,await _0x519e87(),_0x4e3634(),await _0x571467(),_0x39cff1(_0x3e7a1b[_0x412b05(0x11b4)][_0x412b05(0xedb)]);const _0x154015=parseInt(localStorage[_0x412b05(0x2f5)](_0x412b05(0xbb7)))||0x0;_0x1baa80(_0x154015);_0x3e7a1b[_0x412b05(0x11b4)]&&_0x3e7a1b['globalSettings'][_0x412b05(0x1185)]&&_0x397027(_0x3e7a1b['globalSettings'][_0x412b05(0x1185)]);_0x26350e(),setInterval(_0x26350e,0x3e8*0x1e),_0x11d2f9(),_0x9e440c(),_0x5dc542(),_0x320954(),document[_0x412b05(0x64f)](_0x412b05(0xaf))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x47cfd7=>{const _0x59ba90=_0x412b05;_0x47cfd7[_0x59ba90(0xf5b)][_0x59ba90(0x418)]['contains'](_0x59ba90(0x9b8))&&_0x1cde7a(_0x47cfd7[_0x59ba90(0xf5b)][_0x59ba90(0x12e1)][_0x59ba90(0xcd3)]);}),document[_0x412b05(0x64f)](_0x412b05(0x126e))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x537fb5(null)),document[_0x412b05(0x64f)](_0x412b05(0x4a2))['addEventListener'](_0x412b05(0x1080),()=>{const _0x9b34d5=_0x412b05;document['getElementById']('rule-editor-modal')[_0x9b34d5(0x418)][_0x9b34d5(0x1275)](_0x9b34d5(0x40a));}),document[_0x412b05(0x64f)]('save-rule-btn')['addEventListener']('click',_0x441f4b),document[_0x412b05(0x64f)](_0x412b05(0x118c))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x1c8742=_0x412b05;if(_0x3e7a1b['activeChatId']&&!_0x3e7a1b[_0x1c8742(0x999)][_0x3e7a1b[_0x1c8742(0x777)]]['isGroup']){const _0x4cf972=_0x3e7a1b[_0x1c8742(0x999)][_0x3e7a1b[_0x1c8742(0x777)]];_0x4601ee(_0x4cf972['id'],_0x4cf972['originalName']);}});let _0x29591f=null;function _0x4d2630(_0x1050c7){const _0x3834a4=_0x412b05;_0x29591f=_0x1050c7;const _0x67e822=_0x3e7a1b['chats'][_0x3e7a1b[_0x3834a4(0x777)]],_0x28f743=_0x67e822[_0x3834a4(0xb1d)][_0x3834a4(0x137)](_0x142bdc=>_0x142bdc['id']===_0x1050c7);if(!_0x28f743)return;const _0x39b119=document[_0x3834a4(0x64f)](_0x3834a4(0x498));_0x39b119[_0x3834a4(0xee5)]=_0x28f743[_0x3834a4(0x9b6)]?'取消置顶':_0x3834a4(0x560),document[_0x3834a4(0x64f)](_0x3834a4(0x103b))[_0x3834a4(0x418)][_0x3834a4(0xdda)]('visible');}async function _0x2cdbcf(){const _0x2628b7=_0x412b05;if(!_0x29591f)return;const _0x5f2eb7=_0x3e7a1b[_0x2628b7(0x999)][_0x3e7a1b['activeChatId']],_0x31aa94=_0x5f2eb7[_0x2628b7(0xb1d)][_0x2628b7(0x137)](_0x5d840c=>_0x5d840c['id']===_0x29591f);_0x31aa94&&(_0x31aa94[_0x2628b7(0x9b6)]=!_0x31aa94[_0x2628b7(0x9b6)],await _0x4e1bbf[_0x2628b7(0x999)]['put'](_0x5f2eb7),_0x25d9f7()),document[_0x2628b7(0x64f)](_0x2628b7(0x103b))[_0x2628b7(0x418)][_0x2628b7(0x1275)](_0x2628b7(0x40a));}async function _0x170308(){const _0x4af97c=_0x412b05;if(!_0x29591f)return;const _0x4d1dcf=await _0x54149f(_0x4af97c(0x13d2),_0x4af97c(0x1077),{'confirmButtonClass':_0x4af97c(0xeed)});if(_0x4d1dcf){const _0x3b0e67=_0x3e7a1b[_0x4af97c(0x999)][_0x3e7a1b['activeChatId']];_0x3b0e67[_0x4af97c(0xb1d)]=_0x3b0e67[_0x4af97c(0xb1d)][_0x4af97c(0x156)](_0x3de331=>_0x3de331['id']!==_0x29591f),await _0x4e1bbf[_0x4af97c(0x999)][_0x4af97c(0x4fa)](_0x3b0e67),_0x25d9f7();}document[_0x4af97c(0x64f)]('announcement-actions-modal')[_0x4af97c(0x418)][_0x4af97c(0x1275)](_0x4af97c(0x40a));}document[_0x412b05(0x64f)](_0x412b05(0x157))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x516d41),document['getElementById'](_0x412b05(0x970))[_0x412b05(0xf72)]('click',_0x211786=>{const _0xf88db2=_0x412b05;if(_0x211786[_0xf88db2(0xf5b)]===_0x4e1ce9)_0x516d41();}),document['getElementById'](_0x412b05(0x12c1))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x2f9a5a=_0x412b05,_0x5178ab=await _0x217169(_0x2f9a5a(0xdb6),[{'text':_0x2f9a5a(0x1042),'value':_0x2f9a5a(0x182)},{'text':_0x2f9a5a(0x1324),'value':_0x2f9a5a(0x1231)}]);if(_0x5178ab===_0x2f9a5a(0x182))_0x32ab55();else _0x5178ab===_0x2f9a5a(0x1231)&&_0xbec9da();}),document[_0x412b05(0x64f)](_0x412b05(0x962))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3e70b9),document['getElementById'](_0x412b05(0x101b))[_0x412b05(0xf72)](_0x412b05(0x834),_0x324ca1=>{const _0x3c28fb=_0x412b05;document[_0x3c28fb(0x64f)](_0x3c28fb(0xc5a))[_0x3c28fb(0x731)][_0x3c28fb(0x130)]=_0x324ca1['target']['checked']?_0x3c28fb(0xb37):_0x3c28fb(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0x6c7))[_0x412b05(0xf72)]('click',()=>document[_0x412b05(0x64f)]('import-data-input')['click']()),document[_0x412b05(0x64f)](_0x412b05(0x78))[_0x412b05(0xf72)](_0x412b05(0x834),_0x3cb1cb=>{const _0x3b5156=_0x412b05;document[_0x3b5156(0x64f)](_0x3b5156(0x54a))['style'][_0x3b5156(0x130)]=_0x3cb1cb[_0x3b5156(0xf5b)][_0x3b5156(0xf1d)]?_0x3b5156(0xb37):_0x3b5156(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0xddb))[_0x412b05(0xf72)](_0x412b05(0x834),_0x169626=>_0x11afde(_0x169626['target'][_0x412b05(0x91e)][0x0])),document[_0x412b05(0x64f)]('import-card-input')['addEventListener'](_0x412b05(0x834),_0x5c828a),document[_0x412b05(0x64f)](_0x412b05(0xaae))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3a7874=_0x412b05;_0x34b644={},_0x1f54e5('','#chat-messages','custom-bubble-style'),_0x1f54e5('',_0x3a7874(0x12dc),'preview-bubble-style'),_0x5ec8b6(),_0x3e7a1b[_0x3a7874(0x777)]=null,_0xddd8ae(_0x3a7874(0xbb6));}),document[_0x412b05(0x64f)]('add-chat-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x1ec68c=_0x412b05,_0x4f44af=await _0x217169(_0x1ec68c(0x3f7),[{'text':'手动创建角色','value':'manual'},{'text':_0x1ec68c(0x29a),'value':_0x1ec68c(0x948)}]);if(_0x4f44af===_0x1ec68c(0x417)){const _0x3f46e6=await _0x41e3f8(_0x1ec68c(0x5a1),_0x1ec68c(0x1288));if(!_0x3f46e6||!_0x3f46e6['trim']())return;const _0x4bbaae=await _0x41e3f8('创建新聊天\x20(第2/2步)',_0x1ec68c(0xea3));if(!_0x4bbaae||!_0x4bbaae[_0x1ec68c(0x43a)]())return;const _0x3ff021=_0x1ec68c(0x1356)+Date[_0x1ec68c(0x2b5)](),_0x890d21={'id':_0x3ff021,'name':_0x3f46e6['trim'](),'originalName':_0x4bbaae[_0x1ec68c(0x43a)](),'isGroup':![],'isPinned':![],'unreadCount':0x0,'relationship':{'status':_0x1ec68c(0xfdd),'blockedTimestamp':null,'applicationReason':''},'status':{'text':'在线','lastUpdate':Date[_0x1ec68c(0x2b5)](),'isBusy':![]},'settings':{'aiPersona':_0x1ec68c(0x34f),'myPersona':_0x1ec68c(0xd09),'myNickname':'我','maxMemory':0xa,'aiAvatar':_0x54e358,'myAvatar':_0x54e358,'background':'','theme':'default','fontSize':0xd,'customCss':'','linkedWorldBookIds':[],'aiAvatarLibrary':[],'myAvatarLibrary':[],'enableBackgroundActivity':!![],'actionCooldownMinutes':0xf,'enableTimePerception':!![],'isOfflineMode':![],'offlineMinLength':0x64,'offlineMaxLength':0x12c,'offlinePresetId':null,'timeZone':_0x1ec68c(0xe77)},'history':[],'musicData':{'totalTime':0x0},'longTermMemory':[],'thoughtsHistory':[]};_0x3e7a1b[_0x1ec68c(0x999)][_0x3ff021]=_0x890d21,await _0x4e1bbf[_0x1ec68c(0x999)][_0x1ec68c(0x4fa)](_0x890d21),_0x21f6ea();}else _0x4f44af==='import_card'&&document[_0x1ec68c(0x64f)]('import-card-input')[_0x1ec68c(0x1080)]();}),document['getElementById'](_0x412b05(0x2c9))['addEventListener'](_0x412b05(0x1080),_0x20ce3f),document['getElementById'](_0x412b05(0x7ac))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>document[_0x412b05(0x64f)](_0x412b05(0x1000))['classList'][_0x412b05(0x1275)](_0x412b05(0x40a))),document['getElementById'](_0x412b05(0x13ae))[_0x412b05(0xf72)]('click',_0x41132d),document['getElementById'](_0x412b05(0xf73))[_0x412b05(0xf72)]('click',_0x1819d1),document['getElementById'](_0x412b05(0xdb0))['addEventListener'](_0x412b05(0x1080),()=>_0x19d084(!![])),document[_0x412b05(0x64f)](_0x412b05(0xc53))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x22c00a),document['getElementById']('music-play-pause-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3b97ea),document[_0x412b05(0x64f)](_0x412b05(0x428))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2a1ec3),document[_0x412b05(0x64f)](_0x412b05(0xb67))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x51a9dd),document[_0x412b05(0x64f)](_0x412b05(0x655))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1f653),document[_0x412b05(0x64f)]('music-playlist-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x164525=_0x412b05;_0x36d83c(),document['getElementById'](_0x164525(0x1261))[_0x164525(0x418)]['add']('visible');}),document[_0x412b05(0x64f)]('close-playlist-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>document[_0x412b05(0x64f)](_0x412b05(0x1261))[_0x412b05(0x418)]['remove'](_0x412b05(0x40a))),document[_0x412b05(0x64f)]('add-song-url-btn')[_0x412b05(0xf72)]('click',_0xf1652f),document[_0x412b05(0x64f)](_0x412b05(0x4bf))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>document[_0x412b05(0x64f)](_0x412b05(0x120a))['click']()),document[_0x412b05(0x64f)]('local-song-upload-input')[_0x412b05(0xf72)]('change',_0x5703ac),document['getElementById'](_0x412b05(0x697))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x25ead9=>{const _0x459411=_0x412b05,_0x238b95=_0x25ead9[_0x459411(0xf5b)],_0xa1f4a6=parseInt(_0x238b95[_0x459411(0x12e1)][_0x459411(0xf84)]);if(isNaN(_0xa1f4a6))return;if(_0x238b95['classList'][_0x459411(0xef6)](_0x459411(0xff2)))_0x2d7836(_0xa1f4a6);else{if(_0x238b95[_0x459411(0x418)]['contains'](_0x459411(0xa1f)))_0x5a42e4(_0xa1f4a6);else{if(_0x238b95['classList'][_0x459411(0xef6)]('bg-btn'))_0x273afd(_0xa1f4a6);else _0x238b95[_0x459411(0x418)]['contains']('delete-track-btn')&&_0x24f2bd(_0xa1f4a6);}}}),_0x51e4a1[_0x412b05(0xf72)](_0x412b05(0x353),()=>{const _0x3d8f95=_0x412b05;document[_0x3d8f95(0x64f)]('vinyl-view')[_0x3d8f95(0x418)][_0x3d8f95(0x1275)](_0x3d8f95(0x59b)),_0x2a1ec3();});const _0x3eb56f=document[_0x412b05(0x64f)](_0x412b05(0xe72));document[_0x412b05(0x64f)]('send-btn')[_0x412b05(0xf72)]('click',()=>{const _0x5720da=_0x412b05;_0x5b567f();const _0x2dc1b1=_0x3eb56f['value'][_0x5720da(0x43a)]();if(!_0x2dc1b1||!_0x3e7a1b[_0x5720da(0x777)])return;const _0x197917=_0x3e7a1b[_0x5720da(0x999)][_0x3e7a1b[_0x5720da(0x777)]],_0x45b13a={'role':'user','content':_0x2dc1b1,'timestamp':Date[_0x5720da(0x2b5)]()};_0x170cc3&&(_0x45b13a[_0x5720da(0x2fa)]=_0x170cc3),_0x3c7e84(_0x45b13a,_0x197917),((async()=>{const _0x2f6fbd=_0x5720da;_0x197917[_0x2f6fbd(0x830)]['push'](_0x45b13a),await _0x4e1bbf[_0x2f6fbd(0x999)]['put'](_0x197917),_0x21f6ea();})()),_0x3eb56f[_0x5720da(0xbed)]='',_0x3eb56f[_0x5720da(0x731)][_0x5720da(0x877)]='auto',_0x3eb56f[_0x5720da(0x1218)](),_0x34ff23();}),document['getElementById']('wait-reply-btn')['addEventListener'](_0x412b05(0x1080),_0x20a638),_0x3eb56f['addEventListener'](_0x412b05(0x8c),_0x25009d=>{const _0xc18c6a=_0x412b05;_0x25009d[_0xc18c6a(0xf2f)]===_0xc18c6a(0xd9d)&&!_0x25009d[_0xc18c6a(0xb6c)]&&(_0x25009d[_0xc18c6a(0x8d1)](),document[_0xc18c6a(0x64f)](_0xc18c6a(0xc9a))[_0xc18c6a(0x1080)]());}),document[_0x412b05(0x64f)](_0x412b05(0x18f))[_0x412b05(0xf72)]('change',async _0x41f5d7=>{const _0x208209=_0x412b05,_0x50434=_0x41f5d7['target'][_0x208209(0x91e)][0x0];if(_0x50434){const _0x51d352=await new Promise((_0x533af7,_0x1b0ccf)=>{const _0x593467=_0x208209,_0x5f532a=new FileReader();_0x5f532a[_0x593467(0x139d)]=()=>_0x533af7(_0x5f532a[_0x593467(0x8f)]),_0x5f532a[_0x593467(0x36b)]=()=>_0x1b0ccf(_0x5f532a[_0x593467(0xc60)]),_0x5f532a[_0x593467(0xb4)](_0x50434);});_0x1ebe35=_0x51d352,_0x309ef1();}}),document[_0x412b05(0x64f)](_0x412b05(0x4cc))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x41c36e=_0x412b05;_0x1ebe35&&(_0x3e7a1b[_0x41c36e(0x11b4)][_0x41c36e(0x6fe)]=_0x1ebe35),_0x3e7a1b[_0x41c36e(0x11b4)][_0x41c36e(0xedb)]=document['getElementById'](_0x41c36e(0x1b6))['value']['trim'](),_0x3e7a1b['globalSettings'][_0x41c36e(0xe5f)]=document[_0x41c36e(0x64f)]('notification-sound-url-input')[_0x41c36e(0xbed)][_0x41c36e(0x43a)](),_0x3e7a1b[_0x41c36e(0x11b4)][_0x41c36e(0x390)]=document[_0x41c36e(0x64f)](_0x41c36e(0x46e))[_0x41c36e(0xf1d)],await _0x4e1bbf['globalSettings'][_0x41c36e(0x4fa)](_0x3e7a1b[_0x41c36e(0x11b4)]),_0x11d2f9(),_0x16a875(),_0x1ebe35=null,_0x5dc542(),_0x5f4cf3(),_0x39cff1(_0x3e7a1b[_0x41c36e(0x11b4)][_0x41c36e(0xedb)]),_0x4e3634(),alert(_0x41c36e(0x1385)),_0xddd8ae(_0x41c36e(0xd89));});const _0x4609c4=document[_0x412b05(0x64f)](_0x412b05(0x476));_0x4609c4[_0x412b05(0xf72)](_0x412b05(0x11e0),()=>{const {scrollTop:_0x2311bc,scrollHeight:_0x3ef253,clientHeight:_0xae4bd4}=_0x4609c4;_0x3ef253-_0x2311bc-_0xae4bd4<_0xae4bd4&&(!_0x522181&&_0x1c672d());}),document[_0x412b05(0x64f)](_0x412b05(0x5dc))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x22832a=_0x412b05;_0x3e7a1b[_0x22832a(0xec0)][_0x22832a(0x9ca)]=document[_0x22832a(0x64f)](_0x22832a(0x981))['value'][_0x22832a(0x43a)](),_0x3e7a1b[_0x22832a(0xec0)][_0x22832a(0x76c)]=document[_0x22832a(0x64f)](_0x22832a(0x4d5))[_0x22832a(0xbed)]['trim'](),_0x3e7a1b[_0x22832a(0xec0)]['model']=document[_0x22832a(0x64f)](_0x22832a(0x739))[_0x22832a(0xbed)],_0x3e7a1b[_0x22832a(0xec0)][_0x22832a(0x2d8)]=document['getElementById'](_0x22832a(0x28f))[_0x22832a(0xbed)][_0x22832a(0x43a)](),_0x3e7a1b[_0x22832a(0xec0)][_0x22832a(0xd1)]=document['getElementById'](_0x22832a(0xb09))[_0x22832a(0xbed)][_0x22832a(0x43a)](),_0x3e7a1b['apiConfig'][_0x22832a(0x72c)]=document[_0x22832a(0x64f)](_0x22832a(0xca1))['value'],_0x3e7a1b['apiConfig'][_0x22832a(0x64b)]=document[_0x22832a(0x64f)](_0x22832a(0x111d))[_0x22832a(0xbed)][_0x22832a(0x43a)](),_0x3e7a1b[_0x22832a(0xec0)]['secondaryApiKey']=document[_0x22832a(0x64f)](_0x22832a(0x11ed))[_0x22832a(0xbed)]['trim'](),_0x3e7a1b[_0x22832a(0xec0)][_0x22832a(0x31f)]=document[_0x22832a(0x64f)](_0x22832a(0x8e5))[_0x22832a(0xbed)],await _0x4e1bbf[_0x22832a(0xec0)][_0x22832a(0x4fa)](_0x3e7a1b[_0x22832a(0xec0)]);const _0x3b608c=document[_0x22832a(0x64f)](_0x22832a(0x4e5)),_0x163429=document[_0x22832a(0x64f)](_0x22832a(0x651)),_0x54ed29=document[_0x22832a(0x64f)](_0x22832a(0xc7f));_0x3e7a1b[_0x22832a(0x11b4)][_0x22832a(0x11c3)]=_0x3b608c['checked'],_0x3e7a1b[_0x22832a(0x11b4)][_0x22832a(0xd5)]=parseInt(_0x163429[_0x22832a(0xbed)])||0x3c,_0x3e7a1b[_0x22832a(0x11b4)][_0x22832a(0xf61)]=parseFloat(_0x54ed29[_0x22832a(0xbed)])||0x1,_0x3e7a1b[_0x22832a(0x11b4)][_0x22832a(0xc83)]=document[_0x22832a(0x64f)]('enable-ai-drawing-switch')['checked'],_0x3e7a1b['globalSettings'][_0x22832a(0xd63)]=parseInt(document[_0x22832a(0x64f)](_0x22832a(0xce5))['value'])||0x32,_0x3e7a1b[_0x22832a(0x11b4)][_0x22832a(0x1107)]=parseInt(document[_0x22832a(0x64f)](_0x22832a(0xa54))[_0x22832a(0xbed)])||0x1e,_0x3e7a1b[_0x22832a(0x11b4)]['apiTemperature']=parseFloat(document[_0x22832a(0x64f)]('api-temperature-slider')[_0x22832a(0xbed)]),await _0x4e1bbf['globalSettings'][_0x22832a(0x4fa)](_0x3e7a1b[_0x22832a(0x11b4)]),_0x239b1c();_0x3e7a1b[_0x22832a(0x11b4)]['enableBackgroundActivity']?(_0x26a3f0(),console['log']('后台活动模拟已启动，间隔:\x20'+_0x3e7a1b[_0x22832a(0x11b4)][_0x22832a(0xd5)]+'秒')):console[_0x22832a(0x1081)]('后台活动模拟已停止。');const _0x3b2aa1=document[_0x22832a(0x64f)]('novelai-switch')['checked'],_0x15ba00=document['getElementById'](_0x22832a(0xa21))[_0x22832a(0xbed)],_0x4e8926=document[_0x22832a(0x64f)](_0x22832a(0x427))[_0x22832a(0xbed)][_0x22832a(0x43a)]();localStorage[_0x22832a(0xd39)](_0x22832a(0x13aa),_0x3b2aa1),localStorage[_0x22832a(0xd39)](_0x22832a(0xa21),_0x15ba00),localStorage[_0x22832a(0xd39)](_0x22832a(0x427),_0x4e8926),alert('所有API与后台设置已保存!');});const _0x54f7cb=document[_0x412b05(0x64f)](_0x412b05(0x4d5));_0x54f7cb['addEventListener'](_0x412b05(0x1218),_0x23f848=>{const _0xc11bd5=_0x412b05;_0x23f848['target'][_0xc11bd5(0xacd)](_0xc11bd5(0xafc),'text');}),_0x54f7cb['addEventListener'](_0x412b05(0x6f5),_0x456718=>{const _0x2d9c51=_0x412b05;_0x456718[_0x2d9c51(0xf5b)][_0x2d9c51(0xacd)](_0x2d9c51(0xafc),_0x2d9c51(0x1378));});async function _0x315f38(_0xeda3c,_0x63318d,_0x5690bd){const _0x28cbc8=_0x412b05,_0x3e9342=document[_0x28cbc8(0x64f)](_0xeda3c)[_0x28cbc8(0xbed)]['trim'](),_0x40952f=document[_0x28cbc8(0x64f)](_0x63318d)[_0x28cbc8(0xbed)][_0x28cbc8(0x43a)]();if(!_0x3e9342||!_0x40952f)return alert(_0x28cbc8(0xe05));try{let _0x315691=_0x3e9342===GEMINI_API_URL;const _0xaf493d=await fetch(_0x315691?GEMINI_API_URL+_0x28cbc8(0xd34)+getRandomValue(_0x40952f):_0x3e9342+'/v1/models',_0x315691?undefined:{'headers':{'Authorization':'Bearer\x20'+_0x40952f}});if(!_0xaf493d['ok'])throw new Error('无法获取模型列表');const _0x352dca=await _0xaf493d['json']();let _0x3fad11=_0x315691?_0x352dca['models'][_0x28cbc8(0xb96)](_0x44de47=>({'id':_0x44de47[_0x28cbc8(0x6fc)][_0x28cbc8(0x108c)]('/')[0x1]||_0x44de47[_0x28cbc8(0x6fc)]})):_0x352dca[_0x28cbc8(0x88a)];const _0x5c74ea=document['getElementById'](_0x5690bd);_0x5c74ea['innerHTML']='';const _0x4f7d00=_0x5690bd===_0x28cbc8(0x739)?_0x3e7a1b['apiConfig'][_0x28cbc8(0xd90)]:_0x3e7a1b['apiConfig'][_0x28cbc8(0x31f)];_0x3fad11['forEach'](_0x385c7a=>{const _0x53a98c=_0x28cbc8,_0x58f910=document[_0x53a98c(0x124e)](_0x53a98c(0x1176));_0x58f910[_0x53a98c(0xbed)]=_0x385c7a['id'],_0x58f910['textContent']=_0x385c7a['id'];if(_0x385c7a['id']===_0x4f7d00)_0x58f910[_0x53a98c(0xbe6)]=!![];_0x5c74ea[_0x53a98c(0x99e)](_0x58f910);}),alert(_0x28cbc8(0x173));}catch(_0x259c94){alert(_0x28cbc8(0x755)+_0x259c94[_0x28cbc8(0x854)]);}}document[_0x412b05(0x64f)](_0x412b05(0x9c9))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3c308e=_0x412b05;_0x315f38(_0x3c308e(0x981),_0x3c308e(0x4d5),_0x3c308e(0x739));}),document['getElementById'](_0x412b05(0x7da))[_0x412b05(0xf72)]('click',()=>{const _0x21072a=_0x412b05;_0x315f38(_0x21072a(0x111d),_0x21072a(0x11ed),_0x21072a(0x8e5));}),document[_0x412b05(0x64f)]('add-world-book-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x3b59d4=_0x412b05,_0x194a7e=await _0x41e3f8(_0x3b59d4(0x11f1),_0x3b59d4(0xd1e));if(_0x194a7e&&_0x194a7e[_0x3b59d4(0x43a)]()){const _0x3e4cc7={'id':_0x3b59d4(0x734)+Date[_0x3b59d4(0x2b5)](),'name':_0x194a7e[_0x3b59d4(0x43a)](),'content':''};await _0x4e1bbf[_0x3b59d4(0x144)]['add'](_0x3e4cc7),_0x3e7a1b['worldBooks']['push'](_0x3e4cc7),_0x511a09(),_0x1d54a3(_0x3e4cc7['id']);}}),document['getElementById']('save-world-book-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x287f40=_0x412b05;if(!_0x59a97d)return;const _0x3aa019=_0x3e7a1b[_0x287f40(0x144)][_0x287f40(0x137)](_0x2982c4=>_0x2982c4['id']===_0x59a97d);if(!_0x3aa019)return;const _0x48cf95=document[_0x287f40(0x64f)](_0x287f40(0x919))[_0x287f40(0xbed)]['trim']();if(!_0x48cf95){alert(_0x287f40(0xe58));return;}_0x3aa019['name']=_0x48cf95;const _0x118a34=document[_0x287f40(0x64f)](_0x287f40(0x6c1))[_0x287f40(0xbed)];_0x3aa019[_0x287f40(0xcd3)]=_0x118a34?parseInt(_0x118a34):null;const _0x290fae=document[_0x287f40(0x64f)](_0x287f40(0x10e8)),_0x42cadf=_0x290fae[_0x287f40(0x233)](_0x287f40(0x1363)),_0x3ed023=[];_0x42cadf[_0x287f40(0x103)](_0x52fdd6=>{const _0x351d64=_0x287f40,_0x3db7fa=_0x52fdd6[_0x351d64(0x49c)](_0x351d64(0xa7d))[_0x351d64(0xbed)][_0x351d64(0x43a)](),_0x5a880d=_0x52fdd6['querySelector'](_0x351d64(0x2ba))[_0x351d64(0xbed)]['trim'](),_0x1458be=_0x52fdd6['querySelector'](_0x351d64(0xd60))[_0x351d64(0xf1d)];_0x5a880d&&_0x3ed023[_0x351d64(0x13ee)]({'comment':_0x52fdd6[_0x351d64(0x49c)]('.entry-comment-input')[_0x351d64(0xbed)][_0x351d64(0x43a)](),'keys':_0x3db7fa?_0x3db7fa['split'](',')['map'](_0x1bb2a2=>_0x1bb2a2[_0x351d64(0x43a)]())[_0x351d64(0x156)](_0x4ce214=>_0x4ce214):[],'content':_0x5a880d,'enabled':_0x1458be});}),_0x3aa019[_0x287f40(0x3ba)]=_0x3ed023,await _0x4e1bbf[_0x287f40(0x144)][_0x287f40(0x4fa)](_0x3aa019),document[_0x287f40(0x64f)](_0x287f40(0xc0a))['textContent']=_0x48cf95,_0x59a97d=null,_0xddd8ae('world-book-screen'),await _0x511a09();}),document['getElementById'](_0x412b05(0x207))[_0x412b05(0xf72)](_0x412b05(0x1080),async _0x37205f=>{const _0x3adcef=_0x412b05,_0x41caa8=_0x37205f['target'][_0x3adcef(0x2fc)](_0x3adcef(0xd6c));if(_0x41caa8){const _0x50f5ca=_0x3e7a1b[_0x3adcef(0x999)][_0x3e7a1b[_0x3adcef(0x777)]];if(!_0x50f5ca)return;_0x17127f(_0x41caa8);const _0x335082=_0x41caa8[_0x3adcef(0x2fc)]('.message-bubble'),_0x470102=_0x335082?_0x335082[_0x3adcef(0x49c)](_0x3adcef(0x68e)):null;if(_0x41caa8[_0x3adcef(0x12e1)][_0x3adcef(0x434)]&&_0x470102&&_0x470102['style'][_0x3adcef(0x130)]===_0x3adcef(0xb37)){if(_0x50f5ca[_0x3adcef(0x1167)]){console[_0x3adcef(0x1081)](_0x3adcef(0x1355));return;}if(_0x50f5ca[_0x3adcef(0xcb3)][_0x3adcef(0x112)]===![]){console[_0x3adcef(0x1081)]('“'+_0x50f5ca[_0x3adcef(0x6fc)]+_0x3adcef(0xfa3));return;}_0x4a611b(_0x41caa8);}return;}const _0x21f3b3=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)](_0x3adcef(0x1207));if(_0x21f3b3){const _0x2d929c=_0x21f3b3['closest'](_0x3adcef(0x114f));if(_0x2d929c){const _0x18703d=parseInt(_0x2d929c[_0x3adcef(0x12e1)][_0x3adcef(0x8af)]);if(!isNaN(_0x18703d)){_0x9aac99(_0x18703d);return;}}}const _0x1ae8c6=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)]('.waimai-user-actions\x20button');if(_0x1ae8c6){const _0x3f8c48=_0x1ae8c6[_0x3adcef(0x2fc)](_0x3adcef(0x114f));if(_0x3f8c48){const _0x4f7864=parseInt(_0x3f8c48[_0x3adcef(0x12e1)][_0x3adcef(0x8af)]),_0x4abbc3=_0x1ae8c6[_0x3adcef(0x12e1)][_0x3adcef(0xf4c)];if(!isNaN(_0x4f7864)&&_0x4abbc3){await _0x2fd72f(_0x4f7864,_0x4abbc3);return;}}}const _0x56f309=_0x37205f['target']['closest'](_0x3adcef(0x17d));if(_0x56f309){const _0x10ef45=parseInt(_0x56f309[_0x3adcef(0x12e1)][_0x3adcef(0x6c2)]);if(!isNaN(_0x10ef45)){const _0x1aea2c=await _0x4e1bbf[_0x3adcef(0xaf9)][_0x3adcef(0x11fc)](_0x10ef45);if(_0x1aea2c){let _0x16ccd8='';const _0x51c7c3=_0x1aea2c['authorId']===_0x3adcef(0xa4d)?_0x3e7a1b[_0x3adcef(0x3c2)][_0x3adcef(0x78c)]:_0x3e7a1b[_0x3adcef(0x999)][_0x1aea2c['authorId']]?.[_0x3adcef(0x6fc)]||_0x3adcef(0xe8);if(_0x1aea2c['type']===_0x3adcef(0x103d))_0x16ccd8=_0x1aea2c[_0x3adcef(0x3ba)];else{_0x16ccd8=_0x1aea2c[_0x3adcef(0x66e)]||'';if(_0x1aea2c['imageUrl'])_0x16ccd8+='\x0a[图片]';if(_0x1aea2c[_0x3adcef(0x1150)])_0x16ccd8+=_0x3adcef(0x229)+_0x1aea2c[_0x3adcef(0x1150)]+']';}_0x28974b(_0x3adcef(0x33a)+_0x51c7c3+'\x20的已删除动态',_0x16ccd8[_0x3adcef(0x137f)](/\n/g,_0x3adcef(0x917)));}else _0x28974b('提示',_0x3adcef(0x10d1));}return;}const _0x397d06=_0x37205f[_0x3adcef(0xf5b)]['closest'](_0x3adcef(0x118f));if(_0x397d06){const _0x4bb2cf=_0x397d06['dataset'][_0x3adcef(0x9af)];if(_0x4bb2cf)_0x28974b(_0x3adcef(0x11bb),_0x4bb2cf);return;}const _0x1da786=_0x37205f[_0x3adcef(0xf5b)]['closest'](_0x3adcef(0xa71));if(_0x1da786&&_0x1da786[_0x3adcef(0x12e1)][_0x3adcef(0x8fd)]){const _0x23f989=parseInt(_0x1da786['dataset'][_0x3adcef(0x8fd)]);!isNaN(_0x23f989)&&_0xbe5c44(_0x23f989);}const _0xc2e2e9=_0x37205f['target']['closest'](_0x3adcef(0x111b));if(_0xc2e2e9){const _0x10154c=_0xc2e2e9['closest'](_0x3adcef(0x114f));_0x10154c&&_0x5c9470(parseInt(_0x10154c['dataset'][_0x3adcef(0x8af)]));}const _0x200801=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)](_0x3adcef(0x408));if(_0x200801){const _0x185245=_0x200801[_0x3adcef(0x2fc)]('.message-bubble');if(_0x185245&&_0x185245['dataset'][_0x3adcef(0x8af)]){const _0x5dbe1c=parseInt(_0x185245[_0x3adcef(0x12e1)][_0x3adcef(0x8af)]);_0x326b59(_0x5dbe1c);}}const _0x3603a1=_0x37205f[_0x3adcef(0xf5b)]['closest'](_0x3adcef(0xa79));if(_0x3603a1){const _0x5896e5=parseInt(_0x3603a1[_0x3adcef(0x12e1)]['pollTimestamp']);if(isNaN(_0x5896e5))return;const _0x26c6b7=_0x37205f['target'][_0x3adcef(0x2fc)](_0x3adcef(0x982));if(_0x26c6b7&&!_0x3603a1[_0x3adcef(0x418)][_0x3adcef(0xef6)](_0x3adcef(0x9a0))){_0x47a317(_0x5896e5,_0x26c6b7[_0x3adcef(0x12e1)][_0x3adcef(0x1176)]);return;}const _0x2d44f6=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)]('.poll-action-btn');if(_0x2d44f6){_0x3603a1['classList'][_0x3adcef(0xef6)](_0x3adcef(0x9a0))?_0x19d3ac(_0x5896e5):_0x3b9a7e(_0x5896e5);return;}_0x3603a1[_0x3adcef(0x418)][_0x3adcef(0xef6)](_0x3adcef(0x9a0))&&_0x19d3ac(_0x5896e5);}const _0x35003c=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)]('.recalled-message-placeholder');if(_0x35003c){const _0x2dff0a=_0x3e7a1b[_0x3adcef(0x999)][_0x3e7a1b[_0x3adcef(0x777)]],_0x5e8dc1=_0x35003c['closest'](_0x3adcef(0xad2));if(_0x2dff0a&&_0x5e8dc1){const _0x49c325=parseInt(_0x5e8dc1[_0x3adcef(0x12e1)][_0x3adcef(0x8af)]),_0x42856c=_0x2dff0a[_0x3adcef(0x830)]['find'](_0x2ebdb5=>_0x2ebdb5[_0x3adcef(0x8af)]===_0x49c325);if(_0x42856c&&_0x42856c[_0x3adcef(0x52f)]){let _0x4091ec='';const _0x4d048e=_0x42856c[_0x3adcef(0x52f)];_0x4d048e[_0x3adcef(0xc0f)]==='text'?_0x4091ec='原文:\x20\x22'+_0x4d048e[_0x3adcef(0x13a3)]+'\x22':_0x4091ec=_0x3adcef(0xc23)+_0x4d048e[_0x3adcef(0xc0f)]+_0x3adcef(0x3e1),_0x28974b(_0x3adcef(0x25d),_0x4091ec);}}}const _0x380a9c=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)](_0x3adcef(0x489));if(_0x380a9c&&_0x380a9c[_0x3adcef(0x2fc)](_0x3adcef(0x1116))){const _0x530802=parseInt(_0x380a9c['dataset'][_0x3adcef(0x8af)]);_0x42be7a(_0x530802);}const _0x462ec1=_0x37205f[_0x3adcef(0xf5b)][_0x3adcef(0x2fc)](_0x3adcef(0x114f));if(_0x462ec1&&_0x462ec1[_0x3adcef(0x418)][_0x3adcef(0xef6)]('ai')&&_0x462ec1[_0x3adcef(0x418)][_0x3adcef(0xef6)](_0x3adcef(0xf9b))&&_0x462ec1['dataset'][_0x3adcef(0x69e)]===_0x3adcef(0x8ee)){const _0x3386e6=parseInt(_0x462ec1[_0x3adcef(0x12e1)][_0x3adcef(0x8af)]);!isNaN(_0x3386e6)&&_0x268b16(_0x3386e6);}});const _0xd5cc4a=document[_0x412b05(0x64f)](_0x412b05(0x201)),_0x25f86e=document[_0x412b05(0x49c)](_0x412b05(0xe54)),_0x540949=document[_0x412b05(0x64f)](_0x412b05(0x138c));function _0x4f9cb4(){const _0x234ad0=_0x412b05,_0x11315c=_0x540949[_0x234ad0(0x233)](_0x234ad0(0x1106)),_0x3e5c00=document[_0x234ad0(0x49c)](_0x234ad0(0xaea));if(_0x11315c[_0x234ad0(0x40f)]===0x0)_0x3e5c00['textContent']=_0x234ad0(0xa2c);else{if(_0x11315c[_0x234ad0(0x40f)]>0x2)_0x3e5c00[_0x234ad0(0xee5)]='已选择\x20'+_0x11315c[_0x234ad0(0x40f)]+_0x234ad0(0x82c);else{const _0x5e42e3=Array[_0x234ad0(0xb3a)](_0x11315c)[_0x234ad0(0xb96)](_0x551c83=>{const _0x53dc9f=_0x234ad0;return _0x551c83[_0x53dc9f(0xc42)][_0x53dc9f(0xee5)][_0x53dc9f(0x43a)]();});_0x3e5c00[_0x234ad0(0xee5)]=_0x5e42e3[_0x234ad0(0xd22)](',\x20');}}}_0x25f86e[_0x412b05(0xf72)](_0x412b05(0x1080),_0x463ff2=>{const _0x72e981=_0x412b05;_0x463ff2[_0x72e981(0x61c)](),_0x540949[_0x72e981(0x418)][_0x72e981(0x5cf)]('visible'),_0x25f86e['classList'][_0x72e981(0x5cf)](_0x72e981(0x9e9));}),document[_0x412b05(0x64f)](_0x412b05(0x138c))[_0x412b05(0xf72)](_0x412b05(0x834),_0x4f9cb4),window[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2ac817=>{const _0x98522c=_0x412b05;!document[_0x98522c(0x49c)](_0x98522c(0x48b))[_0x98522c(0xef6)](_0x2ac817['target'])&&(_0x540949[_0x98522c(0x418)]['remove'](_0x98522c(0x40a)),_0x25f86e[_0x98522c(0x418)]['remove'](_0x98522c(0x9e9)));}),document['getElementById']('chat-settings-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x533792=_0x412b05;_0x1e1ae9();if(!_0x3e7a1b[_0x533792(0x777)])return;const _0x43dbf5=_0x3e7a1b[_0x533792(0x999)][_0x3e7a1b['activeChatId']],_0x1d45b9=_0x43dbf5[_0x533792(0x1167)],_0x1815e5=document[_0x533792(0x64f)](_0x533792(0xd36));!_0x1d45b9&&_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x13b)]&&_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x13b)][_0x533792(0x40f)]>0x0?_0x1815e5[_0x533792(0x731)][_0x533792(0x130)]='block':_0x1815e5['style'][_0x533792(0x130)]=_0x533792(0x1209);document[_0x533792(0x64f)]('chat-name-group')['style'][_0x533792(0x130)]='block',document[_0x533792(0x64f)](_0x533792(0xfab))[_0x533792(0x731)]['display']=_0x533792(0xb37),document[_0x533792(0x64f)](_0x533792(0x177))[_0x533792(0x731)][_0x533792(0x130)]=_0x533792(0xb37),document[_0x533792(0x64f)](_0x533792(0x1196))[_0x533792(0x731)]['display']=_0x1d45b9?_0x533792(0xb37):_0x533792(0x1209),document[_0x533792(0x64f)](_0x533792(0xe6))[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?_0x533792(0x1209):'block',document['getElementById'](_0x533792(0x3ad))[_0x533792(0x731)]['display']=_0x1d45b9?_0x533792(0xb37):_0x533792(0x1209),document[_0x533792(0x64f)](_0x533792(0x2ad))[_0x533792(0x731)]['display']=_0x1d45b9?_0x533792(0xb37):_0x533792(0x1209),document[_0x533792(0x64f)](_0x533792(0xdb4))['style'][_0x533792(0x130)]=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document[_0x533792(0x64f)]('ai-avatar-group')[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document[_0x533792(0x64f)](_0x533792(0xe5e))[_0x533792(0x731)]['display']=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document[_0x533792(0x64f)](_0x533792(0xc76))[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?'none':_0x533792(0xb37),document[_0x533792(0x64f)](_0x533792(0x908))[_0x533792(0x731)]['display']=_0x1d45b9?_0x533792(0x1209):'block',document['getElementById'](_0x533792(0x1112))[_0x533792(0x731)]['display']=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document['getElementById'](_0x533792(0x692))[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document[_0x533792(0x64f)]('ai-cooldown-group')[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document['getElementById'](_0x533792(0xb3c))[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?'block':_0x533792(0x1209),document[_0x533792(0x64f)]('chat-name-input')[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0x6fc)],document['getElementById'](_0x533792(0x97b))[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)]['myPersona'],document[_0x533792(0x64f)](_0x533792(0x4d2))[_0x533792(0xbe8)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x96a)]||(_0x1d45b9?_0x60cf2:_0x54e358),document[_0x533792(0x64f)](_0x533792(0xdb1))[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0xd50)],document[_0x533792(0x64f)]('linked-memory-count')[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)]['linkedMemoryCount']||0xa;const _0x17de90=document[_0x533792(0x64f)](_0x533792(0x630)),_0x336509=document[_0x533792(0x64f)](_0x533792(0x5bc));_0x43dbf5[_0x533792(0xcb3)][_0x533792(0xc8b)]?(_0x17de90[_0x533792(0xbe8)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0xc8b)],_0x17de90['style']['display']=_0x533792(0xb37),_0x336509['style'][_0x533792(0x130)]=_0x533792(0x946)):(_0x17de90['style'][_0x533792(0x130)]='none',_0x336509['style']['display']='none');document[_0x533792(0x64f)](_0x533792(0x9dc))[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?_0x533792(0x1209):_0x533792(0xb37),document['getElementById']('single-char-background-activity-group')[_0x533792(0x731)][_0x533792(0x130)]=_0x1d45b9?'none':_0x533792(0xb37),document[_0x533792(0x64f)](_0x533792(0x160))['style'][_0x533792(0x130)]=_0x1d45b9?_0x533792(0xb37):_0x533792(0x1209);const _0x111bdd=document[_0x533792(0x64f)]('time-perception-toggle'),_0x406e34=document[_0x533792(0x64f)]('time-zone-group');_0x111bdd[_0x533792(0xf1d)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x35f)],_0x406e34[_0x533792(0x731)][_0x533792(0x130)]=_0x111bdd[_0x533792(0xf1d)]?_0x533792(0xb37):_0x533792(0x1209);const _0x3406a9=document[_0x533792(0x64f)]('time-zone-select'),_0x410f46=Intl[_0x533792(0x12fb)](_0x533792(0xd4e));_0x3406a9['innerHTML']='',_0x410f46[_0x533792(0x103)](_0x505e14=>{const _0x55f6c3=_0x533792,_0x60bc50=document[_0x55f6c3(0x124e)](_0x55f6c3(0x1176));_0x60bc50['value']=_0x505e14,_0x60bc50['textContent']=_0x505e14,_0x3406a9[_0x55f6c3(0x99e)](_0x60bc50);}),_0x3406a9[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)]['timeZone']||_0x533792(0xe77);if(_0x1d45b9)document[_0x533792(0x64f)](_0x533792(0x215))[_0x533792(0xf1d)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x11c3)],document[_0x533792(0x64f)](_0x533792(0x1304))[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x96f)]||'',document['getElementById']('group-avatar-preview')['src']=_0x43dbf5['settings'][_0x533792(0x63a)]||_0x9bc039,document['getElementById'](_0x533792(0xf4d))['value']=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x963)]||0xa,document[_0x533792(0x64f)](_0x533792(0x368))['style']['display']=_0x533792(0x1209),_0x210291(_0x43dbf5[_0x533792(0x5d4)]);else{document[_0x533792(0x64f)](_0x533792(0x368))['style'][_0x533792(0x130)]=_0x533792(0xb37),document[_0x533792(0x64f)]('char-background-activity-switch')[_0x533792(0xf1d)]=_0x43dbf5['settings'][_0x533792(0x11c3)],document[_0x533792(0x64f)](_0x533792(0x1083))[_0x533792(0xf1d)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x117f)];const _0x151fe9=document[_0x533792(0x64f)](_0x533792(0x101b)),_0x440303=document[_0x533792(0x64f)](_0x533792(0xc5a)),_0x34964a=document['getElementById'](_0x533792(0x811)),_0x49c75c=document[_0x533792(0x64f)](_0x533792(0xe14));_0x151fe9['checked']=_0x43dbf5[_0x533792(0xcb3)]['isOfflineMode']||![],_0x440303[_0x533792(0x731)]['display']=_0x151fe9[_0x533792(0xf1d)]?_0x533792(0xb37):'none',_0x34964a[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x414)]||0x64,_0x49c75c[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)]['offlineMaxLength']||0x12c,await _0x41308c(_0x43dbf5),document[_0x533792(0x64f)](_0x533792(0x415))['value']=_0x43dbf5[_0x533792(0x7de)],document['getElementById']('ai-voice-id-input')[_0x533792(0xbed)]=_0x43dbf5['settings'][_0x533792(0xd4)]||'',document['getElementById'](_0x533792(0x762))[_0x533792(0xf1d)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x112)]!==![],document[_0x533792(0x64f)](_0x533792(0xcac))[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)]['aiPersona'],document[_0x533792(0x64f)]('ai-avatar-preview')[_0x533792(0xbe8)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x93)]||_0x54e358,document[_0x533792(0x64f)]('my-nickname-input')[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x96f)]||'我',document[_0x533792(0x64f)](_0x533792(0x883))[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x963)]||0xa;const _0x390079=document[_0x533792(0x64f)](_0x533792(0xcc2));_0x390079[_0x533792(0xc58)]=_0x533792(0xd92);const _0xb4226b=await _0x4e1bbf[_0x533792(0xc1a)][_0x533792(0x78f)]();_0xb4226b['forEach'](_0x36a40e=>{const _0x11cf33=_0x533792,_0x4535ba=document[_0x11cf33(0x124e)]('option');_0x4535ba[_0x11cf33(0xbed)]=_0x36a40e['id'],_0x4535ba[_0x11cf33(0xee5)]=_0x36a40e[_0x11cf33(0x6fc)];if(_0x43dbf5['groupId']===_0x36a40e['id'])_0x4535ba['selected']=!![];_0x390079['appendChild'](_0x4535ba);});const _0x4b3a23=_0x43dbf5[_0x533792(0xcb3)]['lyricsPosition']||{'vertical':_0x533792(0x4ed),'horizontal':_0x533792(0x7bd),'offset':0xa};document[_0x533792(0x64f)](_0x533792(0xf69))['value']=_0x4b3a23['vertical'],document[_0x533792(0x64f)](_0x533792(0x92c))[_0x533792(0xbed)]=_0x4b3a23[_0x533792(0x69)],document[_0x533792(0x64f)]('lyrics-offset-input')[_0x533792(0xbed)]=_0x4b3a23['offset'];}const _0x3f55a8=document[_0x533792(0x64f)](_0x533792(0x138c));_0x3f55a8[_0x533792(0xc58)]='';const [_0x1b17cb,_0x419ad1]=await Promise[_0x533792(0xfd7)]([_0x4e1bbf[_0x533792(0x10bb)][_0x533792(0x78f)](),_0x4e1bbf[_0x533792(0x144)][_0x533792(0x78f)]()]),_0x1c10d1=new Set(_0x43dbf5[_0x533792(0xcb3)][_0x533792(0xde4)]||[]);if(_0x419ad1[_0x533792(0x40f)]===0x0)_0x3f55a8['innerHTML']=_0x533792(0x1192);else{_0x1b17cb[_0x533792(0x103)](_0x1abf27=>{const _0x597127=_0x533792,_0x12ed49=_0x419ad1[_0x597127(0x156)](_0x5bfaf5=>_0x5bfaf5['categoryId']===_0x1abf27['id']);if(_0x12ed49[_0x597127(0x40f)]>0x0){const _0x41f2d5=document[_0x597127(0x124e)]('h4');_0x41f2d5[_0x597127(0xee5)]=_0x1abf27[_0x597127(0x6fc)],_0x41f2d5[_0x597127(0x731)]['cssText']=_0x597127(0x4e2),_0x3f55a8['appendChild'](_0x41f2d5),_0x12ed49[_0x597127(0x103)](_0x525325=>{const _0xf05021=_0x597127,_0x2fe4b0=_0x1c10d1[_0xf05021(0x2a6)](_0x525325['id']),_0x7ef7cc=document[_0xf05021(0x124e)](_0xf05021(0x1287));_0x7ef7cc['innerHTML']=_0xf05021(0x12dd)+_0x525325['id']+'\x22\x20'+(_0x2fe4b0?'checked':'')+'>\x20'+_0x525325['name'],_0x3f55a8[_0xf05021(0x99e)](_0x7ef7cc);});}});const _0xecf4b9=_0x419ad1['filter'](_0x3e13bc=>!_0x3e13bc['categoryId']);if(_0xecf4b9[_0x533792(0x40f)]>0x0){const _0xf50fac=document['createElement']('h4');_0xf50fac[_0x533792(0xee5)]='未分类',_0xf50fac[_0x533792(0x731)]['cssText']=_0x533792(0x106),_0x3f55a8[_0x533792(0x99e)](_0xf50fac),_0xecf4b9[_0x533792(0x103)](_0x31eaf8=>{const _0x43e810=_0x533792,_0x4c99e1=_0x1c10d1[_0x43e810(0x2a6)](_0x31eaf8['id']),_0x368766=document[_0x43e810(0x124e)](_0x43e810(0x1287));_0x368766[_0x43e810(0xc58)]=_0x43e810(0x12dd)+_0x31eaf8['id']+'\x22\x20'+(_0x4c99e1?_0x43e810(0xf1d):'')+'>\x20'+_0x31eaf8[_0x43e810(0x6fc)],_0x3f55a8['appendChild'](_0x368766);});}}_0x4f9cb4();const _0x3f07d1=document['getElementById']('link-memory-toggle'),_0x3a3355=document[_0x533792(0x64f)](_0x533792(0xa1e)),_0x41ab8a=document['getElementById']('linked-chats-checkboxes-container'),_0xe94d0c=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x4d8)]||[];_0x3f07d1[_0x533792(0xf1d)]=_0xe94d0c[_0x533792(0x40f)]>0x0,_0x3a3355[_0x533792(0x731)][_0x533792(0x130)]=_0x3f07d1['checked']?_0x533792(0xb37):'none',_0x41ab8a['innerHTML']='',Object['values'](_0x3e7a1b[_0x533792(0x999)])[_0x533792(0x103)](_0x1ba301=>{const _0x27a0b3=_0x533792;if(_0x1ba301['id']===_0x43dbf5['id'])return;const _0x5b8160=_0xe94d0c[_0x27a0b3(0xe53)](_0x1ba301['id']),_0x52417a=_0x1ba301[_0x27a0b3(0x1167)]?_0x27a0b3(0x743):'[私聊]',_0x184a03=document[_0x27a0b3(0x124e)](_0x27a0b3(0x1287));_0x184a03[_0x27a0b3(0xc58)]=_0x27a0b3(0xeb4)+_0x1ba301['id']+'\x22\x20'+(_0x5b8160?_0x27a0b3(0xf1d):'')+'>\x20'+_0x52417a+'\x20'+_0x1ba301[_0x27a0b3(0x6fc)],_0x41ab8a[_0x27a0b3(0x99e)](_0x184a03);});function _0x59e1b1(){const _0x2c32f5=_0x533792,_0x4bd8c7=_0x41ab8a[_0x2c32f5(0x233)]('input:checked'),_0x2893b2=_0x3a3355[_0x2c32f5(0x49c)]('.selected-options-text');if(_0x4bd8c7[_0x2c32f5(0x40f)]===0x0)_0x2893b2[_0x2c32f5(0xee5)]=_0x2c32f5(0xa2c);else _0x4bd8c7[_0x2c32f5(0x40f)]>0x2?_0x2893b2[_0x2c32f5(0xee5)]=_0x2c32f5(0x4a7)+_0x4bd8c7[_0x2c32f5(0x40f)]+'\x20项':_0x2893b2['textContent']=Array['from'](_0x4bd8c7)[_0x2c32f5(0xb96)](_0x14b61d=>_0x14b61d['parentElement']['textContent'][_0x2c32f5(0x43a)]())[_0x2c32f5(0xd22)](',\x20');}_0x59e1b1(),_0x3f07d1[_0x533792(0xf72)](_0x533792(0x834),()=>{const _0x961f0c=_0x533792;_0x3a3355[_0x961f0c(0x731)][_0x961f0c(0x130)]=_0x3f07d1['checked']?_0x961f0c(0xb37):_0x961f0c(0x1209);});const _0x5b5c9a=_0x3a3355[_0x533792(0x49c)](_0x533792(0xca4)),_0x39e77a=_0x5b5c9a[_0x533792(0xc66)](!![]);_0x5b5c9a[_0x533792(0x9be)]['replaceChild'](_0x39e77a,_0x5b5c9a),_0x39e77a[_0x533792(0xf72)](_0x533792(0x1080),_0x2b337d=>{const _0x201b49=_0x533792;_0x2b337d['stopPropagation'](),_0x41ab8a[_0x201b49(0x418)][_0x201b49(0x5cf)]('visible'),_0x39e77a[_0x201b49(0x418)]['toggle'](_0x201b49(0x9e9));}),_0x41ab8a['addEventListener'](_0x533792(0x834),_0x59e1b1);const _0x271406=document[_0x533792(0x49c)](_0x533792(0x35c)+(_0x43dbf5[_0x533792(0xcb3)][_0x533792(0xb3d)]||_0x533792(0xf5d))+'\x22]');if(_0x271406)_0x271406[_0x533792(0xf1d)]=!![];const _0x15cddf=document[_0x533792(0x64f)](_0x533792(0x4d1));_0x15cddf['value']=_0x43dbf5['settings'][_0x533792(0xf5a)]||0xd,document['getElementById'](_0x533792(0x27a))['textContent']=_0x15cddf[_0x533792(0xbed)]+'px';const _0x205dc1=document[_0x533792(0x64f)](_0x533792(0x13a0));_0x205dc1[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0xacb)]||'',_0x29eae3(),document[_0x533792(0x64f)]('auto-memory-toggle')[_0x533792(0xf1d)]=_0x43dbf5['settings']['enableAutoMemory']||![],document[_0x533792(0x64f)]('auto-memory-interval')[_0x533792(0xbed)]=_0x43dbf5[_0x533792(0xcb3)][_0x533792(0x10e2)]||0x14,setTimeout(()=>{const _0x21077a=_0x533792;_0x3fe71e();const _0x36dda4=[_0x21077a(0xcac),_0x21077a(0x97b),_0x21077a(0xdb1),_0x21077a(0x121c),'auto-memory-toggle',_0x21077a(0x653),_0x21077a(0x101b),'offline-min-length-input',_0x21077a(0xe14),_0x21077a(0xee8)];_0x36dda4[_0x21077a(0x103)](_0x461c50=>{const _0x3dafbe=_0x21077a,_0x44c86c=document[_0x3dafbe(0x64f)](_0x461c50);_0x44c86c&&_0x44c86c[_0x3dafbe(0xf72)](_0x3dafbe(0x62b),_0x3fe71e);}),document[_0x21077a(0x64f)](_0x21077a(0x138c))[_0x21077a(0xf72)](_0x21077a(0x834),_0x3fe71e),document[_0x21077a(0x64f)](_0x21077a(0xc3))['addEventListener']('change',_0x3fe71e),document[_0x21077a(0x64f)](_0x21077a(0xe7d))[_0x21077a(0xf72)](_0x21077a(0x834),_0x3fe71e);},0x64),_0xddd8ae(_0x533792(0x30b));});function _0x210291(_0x28756a){const _0x300a36=_0x412b05,_0x13f140=document[_0x300a36(0x64f)](_0x300a36(0x48e));_0x13f140[_0x300a36(0xc58)]='',_0x28756a[_0x300a36(0x103)](_0x51669f=>{const _0x23463d=_0x300a36,_0x1dd1e2=document[_0x23463d(0x124e)](_0x23463d(0x479));_0x1dd1e2['className']=_0x23463d(0x6aa),_0x1dd1e2[_0x23463d(0x12e1)]['memberId']=_0x51669f['id'];const _0x46b3f8=_0x51669f[_0x23463d(0x1265)]||(_0x3e7a1b[_0x23463d(0x999)][_0x51669f['id']]?_0x3e7a1b[_0x23463d(0x999)][_0x51669f['id']][_0x23463d(0xcb3)][_0x23463d(0x93)]:_0x480024);_0x1dd1e2[_0x23463d(0xc58)]=_0x23463d(0x86)+_0x46b3f8+_0x23463d(0xa7b)+_0x51669f['groupNickname']+'\x22><div\x20class=\x22member-name\x22>'+_0x51669f[_0x23463d(0x287)]+'</div>',_0x1dd1e2['addEventListener'](_0x23463d(0x1080),()=>_0x235ae6(_0x51669f['id'])),_0x13f140[_0x23463d(0x99e)](_0x1dd1e2);});}document['getElementById'](_0x412b05(0x121a))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x5c79af=_0x412b05;if(!_0x246a68)return;const _0x445ad0=_0x3e7a1b[_0x5c79af(0x999)][_0x3e7a1b[_0x5c79af(0x777)]],_0x38d7f1=_0x445ad0[_0x5c79af(0x5d4)][_0x5c79af(0x137)](_0xf9cde3=>_0xf9cde3['id']===_0x246a68);if(!_0x38d7f1)return;const _0x37f883=document[_0x5c79af(0x64f)](_0x5c79af(0x154))[_0x5c79af(0xbed)][_0x5c79af(0x43a)]();if(!_0x37f883){alert(_0x5c79af(0x626));return;}_0x38d7f1['groupNickname']=_0x37f883,_0x38d7f1[_0x5c79af(0x324)]=document[_0x5c79af(0x64f)](_0x5c79af(0xd77))['value'];const _0x101e64=document[_0x5c79af(0x64f)](_0x5c79af(0xfd5))['src'];_0x38d7f1[_0x5c79af(0x1265)]=_0x101e64;const _0x19bb85=_0x3e7a1b['chats'][_0x38d7f1['id']];_0x19bb85&&(_0x19bb85[_0x5c79af(0xcb3)][_0x5c79af(0x93)]=_0x101e64,await _0x4e1bbf['chats'][_0x5c79af(0x4fa)](_0x19bb85)),await _0x4e1bbf['chats'][_0x5c79af(0x4fa)](_0x445ad0),_0x210291(_0x445ad0[_0x5c79af(0x5d4)]),document[_0x5c79af(0x64f)](_0x5c79af(0x13ef))[_0x5c79af(0x418)]['remove'](_0x5c79af(0x40a)),_0x246a68=null;});function _0x235ae6(_0x3572ff){const _0x5941c3=_0x412b05;_0x246a68=_0x3572ff;const _0x465272=_0x3e7a1b[_0x5941c3(0x999)][_0x3e7a1b['activeChatId']],_0x3d51bf=_0x465272[_0x5941c3(0x5d4)][_0x5941c3(0x137)](_0x280760=>_0x280760['id']===_0x3572ff);if(!_0x3d51bf)return;document['getElementById'](_0x5941c3(0x154))['value']=_0x3d51bf[_0x5941c3(0x287)],document['getElementById'](_0x5941c3(0xd77))[_0x5941c3(0xbed)]=_0x3d51bf[_0x5941c3(0x324)];const _0x2daa3a=_0x3d51bf[_0x5941c3(0x1265)]||(_0x3e7a1b[_0x5941c3(0x999)][_0x3d51bf['id']]?_0x3e7a1b[_0x5941c3(0x999)][_0x3d51bf['id']]['settings']['aiAvatar']:_0x480024);document[_0x5941c3(0x64f)]('member-avatar-preview')['src']=_0x2daa3a,document['getElementById'](_0x5941c3(0x13ef))[_0x5941c3(0x418)][_0x5941c3(0xdda)](_0x5941c3(0x40a));}document[_0x412b05(0x64f)](_0x412b05(0xe0b))['addEventListener']('click',()=>{const _0x23f210=_0x412b05;document['getElementById'](_0x23f210(0x13ef))[_0x23f210(0x418)][_0x23f210(0x1275)]('visible'),_0x246a68=null;}),document[_0x412b05(0x64f)]('save-member-settings-btn')['addEventListener'](_0x412b05(0x1080),async()=>{const _0x588181=_0x412b05;if(!_0x246a68)return;const _0x46c897=_0x3e7a1b[_0x588181(0x999)][_0x3e7a1b[_0x588181(0x777)]],_0x5d8e8c=_0x46c897[_0x588181(0x5d4)][_0x588181(0x137)](_0x280de9=>_0x280de9['id']===_0x246a68);if(!_0x5d8e8c)return;const _0x2e3724=document[_0x588181(0x64f)](_0x588181(0x154))[_0x588181(0xbed)][_0x588181(0x43a)]();if(!_0x2e3724){alert('群昵称不能为空！');return;}_0x5d8e8c[_0x588181(0x287)]=_0x2e3724,_0x5d8e8c[_0x588181(0x324)]=document[_0x588181(0x64f)](_0x588181(0xd77))[_0x588181(0xbed)];const _0x7ab3a0=document[_0x588181(0x64f)](_0x588181(0xfd5))[_0x588181(0xbe8)];_0x5d8e8c[_0x588181(0x1265)]=_0x7ab3a0;const _0x1862b5=_0x3e7a1b[_0x588181(0x999)][_0x5d8e8c['id']];_0x1862b5&&(_0x1862b5[_0x588181(0xcb3)][_0x588181(0x93)]=_0x7ab3a0,await _0x4e1bbf[_0x588181(0x999)][_0x588181(0x4fa)](_0x1862b5)),await _0x4e1bbf[_0x588181(0x999)][_0x588181(0x4fa)](_0x46c897),_0x210291(_0x46c897[_0x588181(0x5d4)]),document[_0x588181(0x64f)](_0x588181(0x13ef))['classList'][_0x588181(0x1275)](_0x588181(0x40a)),_0x246a68=null;}),document[_0x412b05(0x64f)](_0x412b05(0x1338))[_0x412b05(0xf72)]('click',()=>{const _0x304147=_0x412b05;document[_0x304147(0x64f)](_0x304147(0x1254))[_0x304147(0xf1d)]=!![];}),document[_0x412b05(0x64f)](_0x412b05(0x127))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x5a2d3c=_0x412b05;if(!_0x3e7a1b[_0x5a2d3c(0x777)])return;const _0x1f5606=_0x3e7a1b['chats'][_0x3e7a1b[_0x5a2d3c(0x777)]],_0x430d61=_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x1ed)]||![],_0xcd055=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0xb44))['value'][_0x5a2d3c(0x43a)]();if(!_0xcd055)return alert('备注名/群名不能为空！');if(!_0x1f5606[_0x5a2d3c(0x1167)]&&_0xcd055!==_0x1f5606['name']){if(!_0x1f5606[_0x5a2d3c(0x19e)])_0x1f5606[_0x5a2d3c(0x19e)]=[];if(!_0x1f5606[_0x5a2d3c(0x19e)][_0x5a2d3c(0xe53)](_0x1f5606[_0x5a2d3c(0x6fc)]))_0x1f5606[_0x5a2d3c(0x19e)][_0x5a2d3c(0x13ee)](_0x1f5606[_0x5a2d3c(0x6fc)]);}_0x1f5606[_0x5a2d3c(0x6fc)]=_0xcd055;const _0x398578=document['querySelector']('input[name=\x22theme-select\x22]:checked');_0x1f5606['settings'][_0x5a2d3c(0xb3d)]=_0x398578?_0x398578[_0x5a2d3c(0xbed)]:_0x5a2d3c(0xf5d),_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0xf5a)]=parseInt(document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x4d1))[_0x5a2d3c(0xbed)]),_0x1f5606['settings'][_0x5a2d3c(0xacb)]=document[_0x5a2d3c(0x64f)]('custom-css-input')[_0x5a2d3c(0xbed)]['trim'](),_0x1f5606['settings'][_0x5a2d3c(0x1047)]=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x97b))['value'],_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x96a)]=document[_0x5a2d3c(0x64f)]('my-avatar-preview')['src'],_0x1f5606['settings'][_0x5a2d3c(0xd50)]=parseInt(document['getElementById'](_0x5a2d3c(0xdb1))[_0x5a2d3c(0xbed)])||0xa,_0x1f5606['settings'][_0x5a2d3c(0x86d)]=parseInt(document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x121c))['value'])||0xa;const _0x374b77=document[_0x5a2d3c(0x233)](_0x5a2d3c(0x5a0)),_0x2e244d=[];_0x374b77[_0x5a2d3c(0x103)](_0x3e5298=>{const _0x37f529=_0x5a2d3c;_0x3e5298[_0x37f529(0xbed)]['startsWith']('book_')&&_0x2e244d[_0x37f529(0x13ee)](_0x3e5298[_0x37f529(0xbed)][_0x37f529(0x137f)](_0x37f529(0xbbe),''));}),_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0xde4)]=_0x2e244d;const _0x1a2095=document['getElementById'](_0x5a2d3c(0xe7d))[_0x5a2d3c(0xf1d)];if(_0x1a2095){const _0x2e9630=document[_0x5a2d3c(0x233)](_0x5a2d3c(0x1ef));_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x4d8)]=Array[_0x5a2d3c(0xb3a)](_0x2e9630)['map'](_0x2c420b=>_0x2c420b[_0x5a2d3c(0xbed)]);}else _0x1f5606['settings'][_0x5a2d3c(0x4d8)]=[];_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x1141)]=document[_0x5a2d3c(0x64f)]('auto-memory-toggle')[_0x5a2d3c(0xf1d)],_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x10e2)]=parseInt(document[_0x5a2d3c(0x64f)]('auto-memory-interval')[_0x5a2d3c(0xbed)])||0x14,_0x1f5606[_0x5a2d3c(0xcb3)]['enableTimePerception']=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x78))[_0x5a2d3c(0xf1d)],_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0xd4e)]=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x514))[_0x5a2d3c(0xbed)];if(_0x1f5606[_0x5a2d3c(0x1167)])_0x1f5606[_0x5a2d3c(0xcb3)]['enableBackgroundActivity']=document['getElementById'](_0x5a2d3c(0x215))['checked'],_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x96f)]=document['getElementById'](_0x5a2d3c(0x1304))[_0x5a2d3c(0xbed)][_0x5a2d3c(0x43a)](),_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x63a)]=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x9f2))[_0x5a2d3c(0xbe8)],_0x1f5606[_0x5a2d3c(0xcb3)]['actionCooldownMinutes']=parseInt(document[_0x5a2d3c(0x64f)]('group-action-cooldown-input')['value'])||0xa;else{_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x11c3)]=document['getElementById'](_0x5a2d3c(0x1270))[_0x5a2d3c(0xf1d)];const _0x5eea93=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x101b))[_0x5a2d3c(0xf1d)];_0x1f5606['settings'][_0x5a2d3c(0x1ed)]=_0x5eea93;if(_0x430d61===!![]&&_0x5eea93===![]){const _0x263b07={'role':_0x5a2d3c(0x905),'content':'[系统指令：模式已切换！你现在回到了线上聊天模式。你的回复【必须】严格遵守线上模式的JSON数组格式，例如\x20[{\x22type\x22:\x20\x22text\x22,\x20\x22content\x22:\x20\x22你好\x22}]]','timestamp':Date[_0x5a2d3c(0x2b5)](),'isHidden':!![]};_0x1f5606[_0x5a2d3c(0x830)][_0x5a2d3c(0x13ee)](_0x263b07),console[_0x5a2d3c(0x1081)](_0x5a2d3c(0x3a4));}_0x1f5606[_0x5a2d3c(0xcb3)]['injectLatestThought']=document[_0x5a2d3c(0x64f)]('inject-thought-toggle')[_0x5a2d3c(0xf1d)],_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x414)]=parseInt(document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x811))[_0x5a2d3c(0xbed)])||0x64,_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x253)]=parseInt(document[_0x5a2d3c(0x64f)](_0x5a2d3c(0xe14))['value'])||0x12c,_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x243)]=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0xee8))[_0x5a2d3c(0xbed)]||null;const _0x1cfa8c=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x415))[_0x5a2d3c(0xbed)][_0x5a2d3c(0x43a)]();if(!_0x1cfa8c)return alert('对方本名不能为空！');_0x1f5606[_0x5a2d3c(0x7de)]=_0x1cfa8c,_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0xbe5)]=document['getElementById'](_0x5a2d3c(0xcac))['value'],_0x1f5606[_0x5a2d3c(0xcb3)]['minimaxVoiceId']=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x12b2))[_0x5a2d3c(0xbed)][_0x5a2d3c(0x43a)](),_0x1f5606['settings']['enableTts']=document[_0x5a2d3c(0x64f)]('enable-tts-switch')[_0x5a2d3c(0xf1d)],_0x1f5606['settings'][_0x5a2d3c(0x93)]=document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x545))[_0x5a2d3c(0xbe8)],_0x1f5606['settings'][_0x5a2d3c(0x96f)]=document[_0x5a2d3c(0x64f)]('my-nickname-input')[_0x5a2d3c(0xbed)][_0x5a2d3c(0x43a)]()||'我',_0x1f5606['settings']['actionCooldownMinutes']=parseInt(document['getElementById'](_0x5a2d3c(0x883))[_0x5a2d3c(0xbed)])||0xa,_0x1f5606[_0x5a2d3c(0xcb3)][_0x5a2d3c(0x96b)]={'vertical':document[_0x5a2d3c(0x64f)](_0x5a2d3c(0xf69))['value'],'horizontal':document[_0x5a2d3c(0x64f)](_0x5a2d3c(0x92c))[_0x5a2d3c(0xbed)],'offset':parseInt(document[_0x5a2d3c(0x64f)](_0x5a2d3c(0xa6a))[_0x5a2d3c(0xbed)])||0xa};const _0x1a3434=document['getElementById'](_0x5a2d3c(0xcc2))[_0x5a2d3c(0xbed)];_0x1f5606[_0x5a2d3c(0xeb)]=_0x1a3434?parseInt(_0x1a3434):null;}await _0x4e1bbf['chats'][_0x5a2d3c(0x4fa)](_0x1f5606),!_0x1f5606['isGroup']&&(await _0x4ee9d7(_0x1f5606),await _0x303d26(_0x1f5606)),_0x227ea7(_0x1f5606),_0x1f54e5(_0x1f5606['settings'][_0x5a2d3c(0xacb)],_0x5a2d3c(0x5ab),_0x5a2d3c(0xa02)),_0xddd8ae(_0x5a2d3c(0x9aa)),_0x4817d1(_0x3e7a1b[_0x5a2d3c(0x777)]),_0x21f6ea();}),document['getElementById'](_0x412b05(0x30b))[_0x412b05(0xf72)]('click',_0x5bd39c=>{const _0x119d0f=_0x412b05;_0x5bd39c['target']['classList'][_0x119d0f(0xef6)](_0x119d0f(0x2fb))&&_0x4cc18d(_0x119d0f(0xc09));}),document[_0x412b05(0x64f)]('member-settings-modal')['addEventListener'](_0x412b05(0x1080),_0x122273=>{const _0x46e2ff=_0x412b05;_0x122273[_0x46e2ff(0xf5b)][_0x46e2ff(0x418)][_0x46e2ff(0xef6)]('change-frame-btn')&&_0x4cc18d(_0x46e2ff(0xa75));});const _0x50a37b=document[_0x412b05(0x64f)](_0x412b05(0x957)),_0x5d7b39=document[_0x412b05(0x64f)](_0x412b05(0xf94)),_0x5a8451=document['getElementById'](_0x412b05(0xd24)),_0x4f51ec=document[_0x412b05(0x64f)]('ai-frame-content'),_0x4354e8=document[_0x412b05(0x64f)](_0x412b05(0xbe1));document[_0x412b05(0x64f)]('save-frame-settings-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0xda4eb0),document[_0x412b05(0x64f)](_0x412b05(0x124c))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x50c6a1=_0x412b05;_0x50a37b[_0x50c6a1(0x418)][_0x50c6a1(0x1275)](_0x50c6a1(0x40a)),_0x21ae61=![];}),_0x5d7b39[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5e4ce9=_0x412b05;_0x5d7b39[_0x5e4ce9(0x418)][_0x5e4ce9(0xdda)](_0x5e4ce9(0x12ef)),_0x5a8451['classList'][_0x5e4ce9(0x1275)](_0x5e4ce9(0x12ef)),_0x4f51ec[_0x5e4ce9(0x731)][_0x5e4ce9(0x130)]=_0x5e4ce9(0xb37),_0x4354e8[_0x5e4ce9(0x731)]['display']=_0x5e4ce9(0x1209);}),_0x5a8451[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2909eb=_0x412b05;_0x5a8451['classList'][_0x2909eb(0xdda)](_0x2909eb(0x12ef)),_0x5d7b39[_0x2909eb(0x418)][_0x2909eb(0x1275)](_0x2909eb(0x12ef)),_0x4354e8[_0x2909eb(0x731)][_0x2909eb(0x130)]=_0x2909eb(0xb37),_0x4f51ec['style'][_0x2909eb(0x130)]=_0x2909eb(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0x3be))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x27760a=_0x412b05;if(!_0x3e7a1b['activeChatId'])return;const _0x37ec8d=_0x3e7a1b[_0x27760a(0x999)][_0x3e7a1b['activeChatId']],_0x3b5d93=await _0x54149f('清空聊天记录',_0x27760a(0x10c),{'confirmButtonClass':'btn-danger'});_0x3b5d93&&(_0x37ec8d[_0x27760a(0x830)]=[],_0x37ec8d[_0x27760a(0x12d9)]=_0x27760a(0x3cd),_0x37ec8d[_0x27760a(0xb9d)]=_0x27760a(0x3cd),await _0x4e1bbf['chats'][_0x27760a(0x4fa)](_0x37ec8d),_0x4817d1(_0x3e7a1b[_0x27760a(0x777)]),_0x21f6ea(),_0xd5cc4a[_0x27760a(0x418)][_0x27760a(0x1275)](_0x27760a(0x40a)));});const _0x965cb3=(_0x28b30c,_0xcb4d0)=>{const _0x1664fc=_0x412b05;document[_0x1664fc(0x64f)](_0x28b30c)[_0x1664fc(0xf72)](_0x1664fc(0x834),async _0x58dc08=>{const _0x56ab94=_0x1664fc,_0xf287d4=_0x58dc08['target'][_0x56ab94(0x91e)][0x0];if(_0xf287d4){const _0x423a3d=await new Promise((_0x35b88e,_0x5d6e73)=>{const _0x160b6d=_0x56ab94,_0x3b36be=new FileReader();_0x3b36be[_0x160b6d(0x139d)]=()=>_0x35b88e(_0x3b36be[_0x160b6d(0x8f)]),_0x3b36be['onerror']=()=>_0x5d6e73(_0x3b36be[_0x160b6d(0xc60)]),_0x3b36be['readAsDataURL'](_0xf287d4);});_0xcb4d0(_0x423a3d),_0x58dc08[_0x56ab94(0xf5b)]['value']=null;}});};_0x965cb3(_0x412b05(0xb77),_0x4ae82e=>document['getElementById'](_0x412b05(0x545))[_0x412b05(0xbe8)]=_0x4ae82e),_0x965cb3(_0x412b05(0x237),_0xe55984=>document[_0x412b05(0x64f)](_0x412b05(0x4d2))[_0x412b05(0xbe8)]=_0xe55984),_0x965cb3(_0x412b05(0xd9a),_0x1cb685=>document[_0x412b05(0x64f)](_0x412b05(0x9f2))['src']=_0x1cb685),_0x965cb3('member-avatar-input',_0xc5bc37=>document[_0x412b05(0x64f)](_0x412b05(0xfd5))[_0x412b05(0xbe8)]=_0xc5bc37),_0x965cb3(_0x412b05(0xdf8),_0x2c8afd=>{const _0x42e6ff=_0x412b05;if(_0x3e7a1b[_0x42e6ff(0x777)]){_0x3e7a1b[_0x42e6ff(0x999)][_0x3e7a1b[_0x42e6ff(0x777)]][_0x42e6ff(0xcb3)][_0x42e6ff(0xc8b)]=_0x2c8afd;const _0x1943ee=document['getElementById']('bg-preview');_0x1943ee[_0x42e6ff(0xbe8)]=_0x2c8afd,_0x1943ee[_0x42e6ff(0x731)][_0x42e6ff(0x130)]='block',document['getElementById']('remove-bg-btn')[_0x42e6ff(0x731)]['display']=_0x42e6ff(0x946);}}),_0x965cb3(_0x412b05(0x1311),_0x299346=>document[_0x412b05(0x64f)]('preset-avatar-preview')['src']=_0x299346),document['getElementById']('remove-bg-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5a2421=_0x412b05;if(_0x3e7a1b['activeChatId']){_0x3e7a1b[_0x5a2421(0x999)][_0x3e7a1b[_0x5a2421(0x777)]][_0x5a2421(0xcb3)][_0x5a2421(0xc8b)]='';const _0x3c9047=document['getElementById'](_0x5a2421(0x630));_0x3c9047['src']='',_0x3c9047['style'][_0x5a2421(0x130)]=_0x5a2421(0x1209),document[_0x5a2421(0x64f)](_0x5a2421(0x5bc))['style'][_0x5a2421(0x130)]='none';}});const _0x492b22=document[_0x412b05(0x64f)]('sticker-panel');document[_0x412b05(0x64f)]('open-sticker-panel-btn')['addEventListener'](_0x412b05(0x1080),()=>{const _0x43e3ae=_0x412b05,_0x53d0ae=_0x3e7a1b[_0x43e3ae(0x999)][_0x3e7a1b['activeChatId']];_0x53d0ae&&_0x53d0ae[_0x43e3ae(0xcb3)][_0x43e3ae(0x1ff)]?_0x110329=_0x53d0ae[_0x43e3ae(0xcb3)][_0x43e3ae(0x1ff)]:_0x110329=_0x43e3ae(0xfd7),_0x8ea9d0(),_0x492b22[_0x43e3ae(0x418)][_0x43e3ae(0xdda)](_0x43e3ae(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x17c))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x492b22[_0x412b05(0x418)][_0x412b05(0x1275)](_0x412b05(0x40a))),document[_0x412b05(0x64f)](_0x412b05(0x114))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x283da4),document[_0x412b05(0x64f)]('upload-sticker-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>document[_0x412b05(0x64f)]('sticker-upload-input')[_0x412b05(0x1080)]()),document[_0x412b05(0x64f)](_0x412b05(0x10d8))[_0x412b05(0xf72)](_0x412b05(0x834),async _0x3f4931=>{const _0x5ca2e5=_0x412b05,_0x464e27=_0x3f4931[_0x5ca2e5(0xf5b)][_0x5ca2e5(0x91e)][0x0];if(!_0x464e27)return;const _0x49bb61=new FileReader();_0x49bb61[_0x5ca2e5(0xb4)](_0x464e27),_0x49bb61[_0x5ca2e5(0x139d)]=async()=>{const _0x29b35a=_0x5ca2e5,_0x275b21=_0x49bb61[_0x29b35a(0x8f)],_0x107803=await _0x41e3f8(_0x29b35a(0xe68),_0x29b35a(0xc10));if(_0x107803&&_0x107803[_0x29b35a(0x43a)]()){const _0x120f4c={'id':_0x29b35a(0xaa5)+Date[_0x29b35a(0x2b5)](),'url':_0x275b21,'name':_0x107803['trim'](),'categoryId':_0x110329!==_0x29b35a(0xfd7)&&_0x110329!=='uncategorized'?_0x110329:null};await _0x4e1bbf[_0x29b35a(0xa8b)][_0x29b35a(0xdda)](_0x120f4c),_0x3e7a1b['userStickers'][_0x29b35a(0x13ee)](_0x120f4c),_0x8ea9d0();}else{if(_0x107803!==null)alert('表情名不能为空！');}},_0x3f4931[_0x5ca2e5(0xf5b)][_0x5ca2e5(0xbed)]=null;}),document[_0x412b05(0x64f)](_0x412b05(0xb54))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>document['getElementById'](_0x412b05(0x399))[_0x412b05(0x1080)]()),document[_0x412b05(0x64f)]('image-upload-input')[_0x412b05(0xf72)](_0x412b05(0x834),async _0x543da9=>{const _0x32fb62=_0x412b05,_0x18647d=_0x543da9['target'][_0x32fb62(0x91e)][0x0];if(!_0x18647d||!_0x3e7a1b[_0x32fb62(0x777)])return;const _0x18b851=new FileReader();_0x18b851[_0x32fb62(0x139d)]=async _0x53cfdd=>{const _0x147d37=_0x32fb62,_0x1e9f71=_0x53cfdd['target'][_0x147d37(0x8f)],_0x374cda=_0x3e7a1b[_0x147d37(0x999)][_0x3e7a1b[_0x147d37(0x777)]],_0x476747={'role':_0x147d37(0xa4d),'content':[{'type':_0x147d37(0x6da),'image_url':{'url':_0x1e9f71}}],'timestamp':Date['now']()};_0x374cda[_0x147d37(0x830)]['push'](_0x476747),await _0x4e1bbf[_0x147d37(0x999)][_0x147d37(0x4fa)](_0x374cda),_0x3c7e84(_0x476747,_0x374cda),_0x21f6ea();},_0x18b851['readAsDataURL'](_0x18647d),_0x543da9[_0x32fb62(0xf5b)]['value']=null;}),document[_0x412b05(0x64f)](_0x412b05(0xdeb))['addEventListener']('click',async()=>{const _0x162120=_0x412b05;if(!_0x3e7a1b[_0x162120(0x777)])return;const _0x19e7f3=await _0x41e3f8('发送语音','请输入你想说的内容：');if(_0x19e7f3&&_0x19e7f3[_0x162120(0x43a)]()){const _0x215d7a=_0x3e7a1b[_0x162120(0x999)][_0x3e7a1b['activeChatId']],_0x198927={'role':_0x162120(0xa4d),'type':'voice_message','content':_0x19e7f3[_0x162120(0x43a)](),'timestamp':Date[_0x162120(0x2b5)]()};_0x215d7a[_0x162120(0x830)][_0x162120(0x13ee)](_0x198927),await _0x4e1bbf[_0x162120(0x999)][_0x162120(0x4fa)](_0x215d7a),_0x3c7e84(_0x198927,_0x215d7a),_0x21f6ea();}}),document['getElementById']('send-photo-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x514c05=_0x412b05;if(!_0x3e7a1b[_0x514c05(0x777)])return;const _0x8f367d=await _0x41e3f8(_0x514c05(0x8d4),'请用文字描述您要发送的照片：');if(_0x8f367d&&_0x8f367d[_0x514c05(0x43a)]()){const _0x567de8=_0x3e7a1b[_0x514c05(0x999)][_0x3e7a1b[_0x514c05(0x777)]],_0x511b84={'role':_0x514c05(0xa4d),'type':_0x514c05(0xb11),'content':_0x8f367d['trim'](),'timestamp':Date[_0x514c05(0x2b5)]()};_0x567de8[_0x514c05(0x830)][_0x514c05(0x13ee)](_0x511b84),await _0x4e1bbf[_0x514c05(0x999)]['put'](_0x567de8),_0x3c7e84(_0x511b84,_0x567de8),_0x21f6ea();}});const _0x3c95d8=document[_0x412b05(0x64f)]('waimai-request-modal');document[_0x412b05(0x64f)](_0x412b05(0x3eb))[_0x412b05(0xf72)]('click',()=>{const _0x4547bd=_0x412b05;_0x3c95d8[_0x4547bd(0x418)]['add'](_0x4547bd(0x40a));}),_0x3c95d8['addEventListener'](_0x412b05(0x1080),_0x58df7e=>{const _0x2c0d23=_0x412b05;_0x58df7e['target']===_0x3c95d8&&_0x3c95d8[_0x2c0d23(0x418)][_0x2c0d23(0x1275)](_0x2c0d23(0x40a));}),document['getElementById']('waimai-order-for-ai-btn')['addEventListener'](_0x412b05(0x1080),_0xf8f04a),document[_0x412b05(0x64f)]('waimai-confirm-btn')[_0x412b05(0xf72)]('click',async()=>{const _0x3ee4de=_0x412b05;if(!_0x3e7a1b['activeChatId'])return;const _0x47886f=document[_0x3ee4de(0x64f)]('waimai-product-info'),_0x411e46=document[_0x3ee4de(0x64f)](_0x3ee4de(0xf33)),_0x3acaec=_0x47886f['value'][_0x3ee4de(0x43a)](),_0x3bf06=parseFloat(_0x411e46[_0x3ee4de(0xbed)]);if(!_0x3acaec||isNaN(_0x3bf06)||_0x3bf06<=0x0){alert(_0x3ee4de(0xe62));return;}const _0x319bd8=_0x3e7a1b[_0x3ee4de(0x999)][_0x3e7a1b[_0x3ee4de(0x777)]],_0x1f8c9d=Date[_0x3ee4de(0x2b5)](),_0x2a65b6=_0x319bd8[_0x3ee4de(0x1167)]?_0x319bd8[_0x3ee4de(0xcb3)][_0x3ee4de(0x96f)]||'我':'我',_0xcd0e04={'role':'user','senderName':_0x2a65b6,'type':'waimai_request','productInfo':_0x3acaec,'amount':_0x3bf06,'status':_0x3ee4de(0x8ee),'countdownEndTime':_0x1f8c9d+0xf*0x3c*0x3e8,'timestamp':_0x1f8c9d};_0x319bd8['history'][_0x3ee4de(0x13ee)](_0xcd0e04),await _0x4e1bbf[_0x3ee4de(0x999)][_0x3ee4de(0x4fa)](_0x319bd8),_0x3c7e84(_0xcd0e04,_0x319bd8),_0x21f6ea(),_0x47886f['value']='',_0x411e46[_0x3ee4de(0xbed)]='',_0x3c95d8[_0x3ee4de(0x418)][_0x3ee4de(0x1275)]('visible');}),document[_0x412b05(0x64f)](_0x412b05(0x39e))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x27eef7),document[_0x412b05(0x64f)](_0x412b05(0xa04))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x268c1c),document['getElementById']('add-persona-preset-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x192f3f),document[_0x412b05(0x64f)](_0x412b05(0x58c))['addEventListener'](_0x412b05(0x1080),_0x449a89),document['getElementById']('save-persona-preset-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x341cd1),document[_0x412b05(0x64f)]('preset-action-edit')['addEventListener'](_0x412b05(0x1080),_0x46010a),document[_0x412b05(0x64f)](_0x412b05(0x1037))[_0x412b05(0xf72)]('click',_0x1e456a),document[_0x412b05(0x64f)](_0x412b05(0xbd6))[_0x412b05(0xf72)]('click',_0x20f906),document['getElementById'](_0x412b05(0xbc5))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5ec8b6),document[_0x412b05(0x64f)]('selection-soft-delete-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x4be321=_0x412b05;if(_0x3b4859[_0x4be321(0x9dd)]===0x0)return;const _0x255a34=await _0x54149f(_0x4be321(0x75c),_0x4be321(0x107c)+_0x3b4859[_0x4be321(0x9dd)]+_0x4be321(0x5e4),{'confirmButtonClass':'btn-danger'});if(_0x255a34){const _0x50ca21=_0x3e7a1b[_0x4be321(0x999)][_0x3e7a1b[_0x4be321(0x777)]];let _0x22411d=[];for(const _0xd970ea of _0x3b4859){const _0x2d3364=_0x50ca21[_0x4be321(0x830)][_0x4be321(0x137)](_0x251304=>_0x251304[_0x4be321(0x8af)]===_0xd970ea);_0x2d3364&&_0x2d3364[_0x4be321(0xafc)]===_0x4be321(0xcde)&&_0x22411d[_0x4be321(0x13ee)](_0x4be321(0xfe1)+_0x2d3364[_0x4be321(0x3c7)]+_0x4be321(0x16b)+_0x2d3364[_0x4be321(0x8af)]+')');}_0x50ca21[_0x4be321(0x830)]=_0x50ca21['history'][_0x4be321(0x156)](_0x566307=>!_0x3b4859[_0x4be321(0x2a6)](_0x566307[_0x4be321(0x8af)]));let _0x9e5f04='一些之前的消息已被用户删除。';_0x22411d[_0x4be321(0x40f)]>0x0&&(_0x9e5f04+='\x20其中包括以下投票：'+_0x22411d[_0x4be321(0xd22)]('；')+'。');_0x9e5f04+=_0x4be321(0xe6d);const _0x4ff0a9={'role':_0x4be321(0x905),'content':_0x4be321(0x122f)+_0x9e5f04+']','timestamp':Date['now'](),'isHidden':!![]};_0x50ca21[_0x4be321(0x830)][_0x4be321(0x13ee)](_0x4ff0a9),await _0x4e1bbf[_0x4be321(0x999)][_0x4be321(0x4fa)](_0x50ca21),_0x4817d1(_0x3e7a1b['activeChatId']),_0x21f6ea();}}),document[_0x412b05(0x64f)]('selection-erase-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x186f4a=_0x412b05;if(_0x3b4859[_0x186f4a(0x9dd)]===0x0)return;const _0x23e1f6=await _0x54149f(_0x186f4a(0x825),_0x186f4a(0xa0f)+_0x3b4859[_0x186f4a(0x9dd)]+_0x186f4a(0xd52),{'confirmButtonClass':_0x186f4a(0xeed),'confirmText':_0x186f4a(0x470)});if(_0x23e1f6){const _0x2efa24=_0x3e7a1b['chats'][_0x3e7a1b[_0x186f4a(0x777)]];_0x2efa24['history']=_0x2efa24[_0x186f4a(0x830)]['filter'](_0x59c99d=>!_0x3b4859[_0x186f4a(0x2a6)](_0x59c99d[_0x186f4a(0x8af)])),await _0x4e1bbf[_0x186f4a(0x999)][_0x186f4a(0x4fa)](_0x2efa24),_0x4817d1(_0x3e7a1b[_0x186f4a(0x777)]),_0x21f6ea();}});const _0x9b6824=document[_0x412b05(0x64f)](_0x412b05(0xd18));_0x9b6824[_0x412b05(0xf72)]('input',()=>_0x397027(_0x9b6824[_0x412b05(0xbed)]['trim'](),!![])),document['getElementById'](_0x412b05(0x335))[_0x412b05(0xf72)]('click',async()=>{const _0x101f67=_0x412b05,_0x3d9efc=_0x9b6824[_0x101f67(0xbed)][_0x101f67(0x43a)]();if(!_0x3d9efc){alert('请输入有效的字体URL。');return;}_0x397027(_0x3d9efc,![]),_0x3e7a1b[_0x101f67(0x11b4)][_0x101f67(0x1185)]=_0x3d9efc,await _0x4e1bbf['globalSettings']['put'](_0x3e7a1b['globalSettings']),alert(_0x101f67(0x906));}),document[_0x412b05(0x64f)](_0x412b05(0x72))['addEventListener'](_0x412b05(0x1080),_0x128bda),document['querySelectorAll'](_0x412b05(0x2a8))[_0x412b05(0x103)](_0x2807ff=>{const _0x4f4dca=_0x412b05;_0x2807ff['addEventListener'](_0x4f4dca(0x1080),()=>_0x5983f6(_0x2807ff['dataset'][_0x4f4dca(0x33d)]));}),document['getElementById'](_0x412b05(0x955))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x5983f6(_0x412b05(0x476))),document[_0x412b05(0x64f)](_0x412b05(0x12e5))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x170ce0=_0x412b05,_0x3adbcf=await _0x41e3f8(_0x170ce0(0x25a),'请输入新的昵称',_0x3e7a1b['qzoneSettings'][_0x170ce0(0x78c)]);_0x3adbcf&&_0x3adbcf[_0x170ce0(0x43a)]()&&(_0x3e7a1b['qzoneSettings'][_0x170ce0(0x78c)]=_0x3adbcf[_0x170ce0(0x43a)](),await _0x4532bc(),_0x5eba8e());}),document[_0x412b05(0x64f)](_0x412b05(0x7d8))[_0x412b05(0xf72)]('click',()=>document['getElementById'](_0x412b05(0x5f6))[_0x412b05(0x1080)]()),document[_0x412b05(0x64f)]('qzone-banner-container')['addEventListener'](_0x412b05(0x1080),()=>document[_0x412b05(0x64f)](_0x412b05(0xd4f))[_0x412b05(0x1080)]()),document['getElementById'](_0x412b05(0x5f6))[_0x412b05(0xf72)](_0x412b05(0x834),async _0x52c576=>{const _0x583784=_0x412b05,_0x2134e5=_0x52c576['target'][_0x583784(0x91e)][0x0];if(_0x2134e5){const _0x5ba8d6=await new Promise(_0x42a13f=>{const _0x3e1259=new FileReader();_0x3e1259['onload']=()=>_0x42a13f(_0x3e1259['result']),_0x3e1259['readAsDataURL'](_0x2134e5);});_0x3e7a1b['qzoneSettings'][_0x583784(0x1265)]=_0x5ba8d6,await _0x4532bc(),_0x5eba8e();}_0x52c576[_0x583784(0xf5b)]['value']=null;}),document['getElementById']('qzone-banner-input')[_0x412b05(0xf72)](_0x412b05(0x834),async _0x219842=>{const _0x304d40=_0x412b05,_0x519600=_0x219842[_0x304d40(0xf5b)]['files'][0x0];if(_0x519600){const _0x3939d0=await new Promise(_0x477fed=>{const _0x18dfdb=_0x304d40,_0x2588f4=new FileReader();_0x2588f4[_0x18dfdb(0x139d)]=()=>_0x477fed(_0x2588f4[_0x18dfdb(0x8f)]),_0x2588f4[_0x18dfdb(0xb4)](_0x519600);});_0x3e7a1b['qzoneSettings'][_0x304d40(0xcdc)]=_0x3939d0,await _0x4532bc(),_0x5eba8e();}_0x219842[_0x304d40(0xf5b)][_0x304d40(0xbed)]=null;}),document['getElementById']('create-shuoshuo-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x3800bd=_0x412b05;_0x55c36e();const _0x48e33a=document[_0x3800bd(0x64f)](_0x3800bd(0xd28));_0x48e33a[_0x3800bd(0x12e1)][_0x3800bd(0x7b3)]=_0x3800bd(0x103d),_0x48e33a[_0x3800bd(0x49c)](_0x3800bd(0xcd2))[_0x3800bd(0x731)][_0x3800bd(0x130)]=_0x3800bd(0x1209),_0x48e33a[_0x3800bd(0x49c)](_0x3800bd(0x113d))['style'][_0x3800bd(0x130)]=_0x3800bd(0x1209),_0x48e33a[_0x3800bd(0x49c)](_0x3800bd(0xee6))[_0x3800bd(0x731)][_0x3800bd(0x130)]=_0x3800bd(0x1209),_0x48e33a['querySelector'](_0x3800bd(0x913))[_0x3800bd(0x1323)]=_0x3800bd(0xf29);const _0x15ad9c=document[_0x3800bd(0x64f)](_0x3800bd(0x68f));_0x15ad9c[_0x3800bd(0xc58)]='';const _0x57c25a=await _0x4e1bbf[_0x3800bd(0xc1a)][_0x3800bd(0x78f)]();_0x57c25a[_0x3800bd(0x40f)]>0x0?_0x57c25a[_0x3800bd(0x103)](_0x40f2c3=>{const _0x4a034e=_0x3800bd,_0x4b1547=document[_0x4a034e(0x124e)](_0x4a034e(0x1287));_0x4b1547[_0x4a034e(0x731)]['display']=_0x4a034e(0xb37),_0x4b1547[_0x4a034e(0xc58)]=_0x4a034e(0x6a7)+_0x40f2c3['id']+_0x4a034e(0x9b3)+_0x40f2c3['name'],_0x15ad9c[_0x4a034e(0x99e)](_0x4b1547);}):_0x15ad9c[_0x3800bd(0xc58)]=_0x3800bd(0x595),_0x48e33a[_0x3800bd(0x418)][_0x3800bd(0xdda)](_0x3800bd(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x11fa))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x1ef861=_0x412b05;_0x55c36e();const _0x500043=document[_0x1ef861(0x64f)]('create-post-modal');_0x500043[_0x1ef861(0x12e1)][_0x1ef861(0x7b3)]='complex',_0x500043['querySelector']('.post-mode-switcher')[_0x1ef861(0x731)][_0x1ef861(0x130)]=_0x1ef861(0x1026),_0x500043[_0x1ef861(0x49c)](_0x1ef861(0x113d))[_0x1ef861(0x418)][_0x1ef861(0xdda)](_0x1ef861(0x12ef)),_0x500043[_0x1ef861(0x49c)](_0x1ef861(0xee6))[_0x1ef861(0x418)][_0x1ef861(0x1275)](_0x1ef861(0x12ef)),_0x500043[_0x1ef861(0x49c)]('#post-public-text')[_0x1ef861(0x1323)]=_0x1ef861(0x53a);const _0x2b11af=document[_0x1ef861(0x64f)]('post-visibility-groups');_0x2b11af[_0x1ef861(0xc58)]='';const _0x55d38d=await _0x4e1bbf[_0x1ef861(0xc1a)][_0x1ef861(0x78f)]();_0x55d38d[_0x1ef861(0x40f)]>0x0?_0x55d38d[_0x1ef861(0x103)](_0x268340=>{const _0xbf5b6a=_0x1ef861,_0x5decf4=document[_0xbf5b6a(0x124e)](_0xbf5b6a(0x1287));_0x5decf4[_0xbf5b6a(0x731)]['display']=_0xbf5b6a(0xb37),_0x5decf4[_0xbf5b6a(0xc58)]='<input\x20type=\x22checkbox\x22\x20name=\x22visibility_group\x22\x20value=\x22'+_0x268340['id']+_0xbf5b6a(0x9b3)+_0x268340[_0xbf5b6a(0x6fc)],_0x2b11af[_0xbf5b6a(0x99e)](_0x5decf4);}):_0x2b11af[_0x1ef861(0xc58)]=_0x1ef861(0x595),_0x500043[_0x1ef861(0x418)][_0x1ef861(0xdda)](_0x1ef861(0x40a));}),document['getElementById'](_0x412b05(0xeab))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x2b0d17=_0x412b05;await _0x5aa836(),_0xddd8ae(_0x2b0d17(0x5ce));}),document[_0x412b05(0x64f)](_0x412b05(0xc3b))[_0x412b05(0xf72)]('click',()=>{const _0x4485df=_0x412b05;_0xddd8ae('chat-list-screen'),_0x5983f6(_0x4485df(0x3dd));}),document[_0x412b05(0x64f)](_0x412b05(0x821))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x51cad0=_0x412b05;_0x3e7a1b[_0x51cad0(0x1360)]=null,_0xddd8ae(_0x51cad0(0x5ce));}),document['getElementById'](_0x412b05(0x1f1))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>document[_0x412b05(0x64f)](_0x412b05(0x1144))[_0x412b05(0x1080)]()),document[_0x412b05(0x64f)](_0x412b05(0x1144))[_0x412b05(0xf72)](_0x412b05(0x834),async _0x2ed276=>{const _0x4b59eb=_0x412b05;if(!_0x3e7a1b[_0x4b59eb(0x1360)])return;const _0x5486a5=_0x2ed276[_0x4b59eb(0xf5b)]['files'];if(!_0x5486a5[_0x4b59eb(0x40f)])return;const _0x424a29=await _0x4e1bbf[_0x4b59eb(0x2d5)][_0x4b59eb(0x11fc)](_0x3e7a1b[_0x4b59eb(0x1360)]);for(const _0x247217 of _0x5486a5){const _0x4d5779=await new Promise(_0x4af6db=>{const _0x4ab902=_0x4b59eb,_0x588571=new FileReader();_0x588571['onload']=()=>_0x4af6db(_0x588571[_0x4ab902(0x8f)]),_0x588571[_0x4ab902(0xb4)](_0x247217);});await _0x4e1bbf[_0x4b59eb(0x5c4)][_0x4b59eb(0xdda)]({'albumId':_0x3e7a1b[_0x4b59eb(0x1360)],'url':_0x4d5779,'createdAt':Date[_0x4b59eb(0x2b5)]()});}const _0x552bfd=await _0x4e1bbf['qzonePhotos']['where'](_0x4b59eb(0xa6e))[_0x4b59eb(0x11cd)](_0x3e7a1b[_0x4b59eb(0x1360)])[_0x4b59eb(0xe7c)](),_0x4cc980={'photoCount':_0x552bfd};if(!_0x424a29[_0x4b59eb(0x736)]||_0x424a29[_0x4b59eb(0x41a)]['includes'](_0x4b59eb(0x1323))){const _0x3ce447=await _0x4e1bbf['qzonePhotos'][_0x4b59eb(0xec9)](_0x4b59eb(0xa6e))[_0x4b59eb(0x11cd)](_0x3e7a1b[_0x4b59eb(0x1360)])[_0x4b59eb(0x5dd)]();if(_0x3ce447)_0x4cc980[_0x4b59eb(0x41a)]=_0x3ce447['url'];}await _0x4e1bbf[_0x4b59eb(0x2d5)][_0x4b59eb(0x32e)](_0x3e7a1b[_0x4b59eb(0x1360)],_0x4cc980),await _0x32cb48(),await _0x5aa836(),_0x2ed276[_0x4b59eb(0xf5b)][_0x4b59eb(0xbed)]=null,alert(_0x4b59eb(0x71b));}),document[_0x412b05(0x64f)](_0x412b05(0x464))[_0x412b05(0xf72)](_0x412b05(0x1080),async _0x38f727=>{const _0x18ae70=_0x412b05,_0x18f6a9=_0x38f727[_0x18ae70(0xf5b)][_0x18ae70(0x2fc)](_0x18ae70(0xff7)),_0x5bcede=_0x38f727[_0x18ae70(0xf5b)]['closest']('.photo-thumb');if(_0x18f6a9){_0x38f727[_0x18ae70(0x61c)]();const _0x136b1b=parseInt(_0x18f6a9['dataset'][_0x18ae70(0x131c)]),_0x534ed4=await _0x54149f(_0x18ae70(0x292),_0x18ae70(0x110b),{'confirmButtonClass':_0x18ae70(0xeed)});if(_0x534ed4){const _0x34c764=await _0x4e1bbf[_0x18ae70(0x5c4)][_0x18ae70(0x11fc)](_0x136b1b);if(!_0x34c764)return;await _0x4e1bbf['qzonePhotos'][_0x18ae70(0x3aa)](_0x136b1b);const _0x4c2121=await _0x4e1bbf[_0x18ae70(0x2d5)][_0x18ae70(0x11fc)](_0x3e7a1b['activeAlbumId']),_0x51be7d=(_0x4c2121[_0x18ae70(0x736)]||0x1)-0x1,_0x285bc7={'photoCount':_0x51be7d};if(_0x4c2121[_0x18ae70(0x41a)]===_0x34c764[_0x18ae70(0xe52)]){const _0x44a6e0=await _0x4e1bbf[_0x18ae70(0x5c4)][_0x18ae70(0xec9)](_0x18ae70(0xa6e))[_0x18ae70(0x11cd)](_0x3e7a1b[_0x18ae70(0x1360)])[_0x18ae70(0x5dd)]();_0x285bc7[_0x18ae70(0x41a)]=_0x44a6e0?_0x44a6e0['url']:_0x18ae70(0x707);}await _0x4e1bbf[_0x18ae70(0x2d5)][_0x18ae70(0x32e)](_0x3e7a1b['activeAlbumId'],_0x285bc7),await _0x32cb48(),await _0x5aa836(),alert(_0x18ae70(0x7f2));}}else _0x5bcede&&_0xbbb814(_0x5bcede[_0x18ae70(0xbe8)]);}),document[_0x412b05(0x64f)](_0x412b05(0x785))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1c8f63),document[_0x412b05(0x64f)](_0x412b05(0x3e4))['addEventListener'](_0x412b05(0x1080),_0x26d54b),document[_0x412b05(0x64f)]('photo-viewer-prev-btn')[_0x412b05(0xf72)]('click',_0x245c75),document['addEventListener'](_0x412b05(0x4b9),_0x4462c8=>{const _0x5e213c=_0x412b05;if(!_0xc70aa2[_0x5e213c(0xb68)])return;if(_0x4462c8[_0x5e213c(0xf2f)]===_0x5e213c(0xef0))_0x26d54b();else{if(_0x4462c8[_0x5e213c(0xf2f)]===_0x5e213c(0x11f3))_0x245c75();else _0x4462c8[_0x5e213c(0xf2f)]==='Escape'&&_0x1c8f63();}}),document[_0x412b05(0x64f)](_0x412b05(0x202))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x3873c7=_0x412b05,_0x1689bc=await _0x41e3f8(_0x3873c7(0x9ce),'请输入相册名称');if(_0x1689bc&&_0x1689bc[_0x3873c7(0x43a)]()){const _0x3b31c6={'name':_0x1689bc[_0x3873c7(0x43a)](),'coverUrl':_0x3873c7(0x707),'photoCount':0x0,'createdAt':Date[_0x3873c7(0x2b5)]()};await _0x4e1bbf[_0x3873c7(0x2d5)][_0x3873c7(0xdda)](_0x3b31c6),await _0x5aa836(),alert(_0x3873c7(0x117e)+_0x1689bc+_0x3873c7(0xe86));}else _0x1689bc!==null&&alert(_0x3873c7(0xdcd));}),document[_0x412b05(0x64f)](_0x412b05(0x75d))[_0x412b05(0xf72)]('click',()=>document[_0x412b05(0x64f)](_0x412b05(0xd28))[_0x412b05(0x418)][_0x412b05(0x1275)](_0x412b05(0x40a))),document['getElementById'](_0x412b05(0xf58))['addEventListener'](_0x412b05(0x1080),()=>document['getElementById'](_0x412b05(0x735))['click']()),document[_0x412b05(0x64f)](_0x412b05(0x735))[_0x412b05(0xf72)](_0x412b05(0x834),_0x215742=>{const _0x24b544=_0x412b05,_0x26dac9=_0x215742[_0x24b544(0xf5b)][_0x24b544(0x91e)][0x0];if(_0x26dac9){const _0x4ba61b=new FileReader();_0x4ba61b[_0x24b544(0x139d)]=_0x372c93=>{const _0x2238c7=_0x24b544;document[_0x2238c7(0x64f)](_0x2238c7(0x104))[_0x2238c7(0xbe8)]=_0x372c93[_0x2238c7(0xf5b)][_0x2238c7(0x8f)],document[_0x2238c7(0x64f)](_0x2238c7(0xdb9))[_0x2238c7(0x418)][_0x2238c7(0xdda)](_0x2238c7(0x40a)),document['getElementById'](_0x2238c7(0x105b))[_0x2238c7(0x731)][_0x2238c7(0x130)]=_0x2238c7(0xb37);},_0x4ba61b[_0x24b544(0xb4)](_0x26dac9);}}),document['getElementById']('post-use-url-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x18f25d=_0x412b05,_0x3055fb=await _0x41e3f8(_0x18f25d(0xa9e),_0x18f25d(0x60a),'',_0x18f25d(0xe52));_0x3055fb&&(document[_0x18f25d(0x64f)](_0x18f25d(0x104))[_0x18f25d(0xbe8)]=_0x3055fb,document['getElementById'](_0x18f25d(0xdb9))[_0x18f25d(0x418)][_0x18f25d(0xdda)](_0x18f25d(0x40a)),document[_0x18f25d(0x64f)](_0x18f25d(0x105b))[_0x18f25d(0x731)][_0x18f25d(0x130)]=_0x18f25d(0xb37));}),document[_0x412b05(0x64f)](_0x412b05(0x283))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x55c36e());const _0x566125=document['getElementById'](_0x412b05(0x10a)),_0x2ab926=document[_0x412b05(0x64f)](_0x412b05(0x6ab)),_0x3ce935=document[_0x412b05(0x64f)]('image-mode-content'),_0x115dd6=document[_0x412b05(0x64f)](_0x412b05(0x8ae));_0x566125[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5528c9=_0x412b05;_0x566125[_0x5528c9(0x418)][_0x5528c9(0xdda)](_0x5528c9(0x12ef)),_0x2ab926[_0x5528c9(0x418)][_0x5528c9(0x1275)](_0x5528c9(0x12ef)),_0x3ce935['classList'][_0x5528c9(0xdda)]('active'),_0x115dd6[_0x5528c9(0x418)][_0x5528c9(0x1275)]('active');}),_0x2ab926[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x89dcb3=_0x412b05;_0x2ab926[_0x89dcb3(0x418)][_0x89dcb3(0xdda)](_0x89dcb3(0x12ef)),_0x566125[_0x89dcb3(0x418)][_0x89dcb3(0x1275)](_0x89dcb3(0x12ef)),_0x115dd6['classList'][_0x89dcb3(0xdda)](_0x89dcb3(0x12ef)),_0x3ce935['classList'][_0x89dcb3(0x1275)](_0x89dcb3(0x12ef));}),document['getElementById']('confirm-create-post-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x926943=_0x412b05,_0x5b6ca9=document['getElementById'](_0x926943(0xd28)),_0x5a9c63=_0x5b6ca9[_0x926943(0x12e1)][_0x926943(0x7b3)],_0x33410b=document[_0x926943(0x49c)](_0x926943(0x13f0))[_0x926943(0xbed)];let _0x2d4593=null;_0x33410b===_0x926943(0x108d)&&(_0x2d4593=Array[_0x926943(0xb3a)](document[_0x926943(0x233)](_0x926943(0xece)))[_0x926943(0xb96)](_0x4f1db9=>parseInt(_0x4f1db9[_0x926943(0xbed)])));let _0x35fa64={};const _0x192e7f={'timestamp':Date['now'](),'authorId':_0x926943(0xa4d),'visibleGroupIds':_0x2d4593};if(_0x5a9c63===_0x926943(0x103d)){const _0x18348c=document[_0x926943(0x64f)](_0x926943(0xec4))[_0x926943(0xbed)][_0x926943(0x43a)]();if(!_0x18348c){alert('说说内容不能为空哦！');return;}_0x35fa64={..._0x192e7f,'type':_0x926943(0x103d),'content':_0x18348c};}else{const _0xe3ef16=document[_0x926943(0x64f)](_0x926943(0xec4))['value'][_0x926943(0x43a)](),_0x148b3e=document[_0x926943(0x64f)]('image-mode-content')[_0x926943(0x418)][_0x926943(0xef6)](_0x926943(0x12ef));if(_0x148b3e){const _0x4dd2b2=document[_0x926943(0x64f)](_0x926943(0x104))[_0x926943(0xbe8)],_0x181109=document['getElementById']('post-image-description')[_0x926943(0xbed)]['trim']();if(!_0x4dd2b2||!(_0x4dd2b2[_0x926943(0x7d)]('http')||_0x4dd2b2[_0x926943(0x7d)](_0x926943(0x1b8)))){alert(_0x926943(0x6d6));return;}if(!_0x181109){alert(_0x926943(0x978));return;}_0x35fa64={..._0x192e7f,'type':_0x926943(0x3d9),'publicText':_0xe3ef16,'imageUrl':_0x4dd2b2,'imageDescription':_0x181109};}else{const _0x2ac985=document[_0x926943(0x64f)](_0x926943(0x8cd))[_0x926943(0xbed)][_0x926943(0x43a)]();if(!_0x2ac985){alert(_0x926943(0x5cd));return;}_0x35fa64={..._0x192e7f,'type':_0x926943(0x351),'publicText':_0xe3ef16,'hiddenContent':_0x2ac985};}}const _0x5c88fe=await _0x4e1bbf['qzonePosts'][_0x926943(0xdda)](_0x35fa64);let _0x15201a=_0x35fa64[_0x926943(0x3ba)]||_0x35fa64[_0x926943(0x66e)]||_0x35fa64['imageDescription']||_0x35fa64[_0x926943(0x1150)]||_0x926943(0x6bf);_0x15201a=_0x15201a[_0x926943(0x126f)](0x0,0x32)+(_0x15201a['length']>0x32?_0x926943(0x3cd):'');for(const _0x1eea0b in _0x3e7a1b[_0x926943(0x999)]){const _0x54f697=_0x3e7a1b[_0x926943(0x999)][_0x1eea0b];if(_0x54f697['isGroup'])continue;let _0x164b0e=![];const _0x7ec345=_0x35fa64[_0x926943(0xb80)];if(!_0x7ec345||_0x7ec345[_0x926943(0x40f)]===0x0)_0x164b0e=!![];else _0x54f697[_0x926943(0xeb)]&&_0x7ec345[_0x926943(0xe53)](_0x54f697[_0x926943(0xeb)])&&(_0x164b0e=!![]);if(_0x164b0e){const _0x2862b7={'role':'system','content':_0x926943(0xe03)+_0x5c88fe+')，内容摘要是：“'+_0x15201a+_0x926943(0x87a),'timestamp':Date[_0x926943(0x2b5)](),'isHidden':!![]};_0x54f697[_0x926943(0x830)][_0x926943(0x13ee)](_0x2862b7),await _0x4e1bbf[_0x926943(0x999)][_0x926943(0x4fa)](_0x54f697);}}await _0x40e6dd(),_0x5b6ca9['classList'][_0x926943(0x1275)](_0x926943(0x40a)),alert(_0x926943(0x6b9));});const _0x5f4cd2=document[_0x412b05(0x64f)]('qzone-posts-list');let _0xe5526c={'isDragging':![],'startX':0x0,'startY':0x0,'currentX':0x0,'activeContainer':null,'swipeDirection':null,'isClick':!![]};function _0x10f9d7(_0x103e10=null){const _0x1ce837=_0x412b05;document[_0x1ce837(0x233)]('.qzone-post-container')['forEach'](_0xfd3125=>{const _0x5dee4d=_0x1ce837;_0xfd3125!==_0x103e10&&_0xfd3125[_0x5dee4d(0x49c)](_0x5dee4d(0xace))[_0x5dee4d(0x418)][_0x5dee4d(0x1275)](_0x5dee4d(0xca2));});}async function _0x55ce0c(_0x3d97d4){const _0x9f4e6e=_0x412b05;_0x3d97d4[_0x9f4e6e(0x61c)]();const _0x57a26f=_0x3d97d4[_0x9f4e6e(0xf5b)],_0xe6d1ac=_0x57a26f[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x4c3));if(_0xe6d1ac){const _0x3a5270=_0xe6d1ac['closest']('.qzone-post-container'),_0x4d4c91=parseInt(_0x3a5270[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x6c2)]),_0x3b1a70=parseInt(_0xe6d1ac[_0x9f4e6e(0x12e1)]['commentIndex']);if(isNaN(_0x4d4c91)||isNaN(_0x3b1a70))return;const _0xa87fbc=_0x10d3d6[_0x9f4e6e(0x137)](_0x5c3f84=>_0x5c3f84['id']===_0x4d4c91);if(!_0xa87fbc||!_0xa87fbc[_0x9f4e6e(0xff)]||!_0xa87fbc[_0x9f4e6e(0xff)][_0x3b1a70])return;const _0x2a9802=_0xa87fbc['comments'][_0x3b1a70],_0x58c69d=await _0x54149f(_0x9f4e6e(0x9c3),_0x9f4e6e(0x10db),{'confirmButtonClass':'btn-danger'});if(_0x58c69d){_0xa87fbc[_0x9f4e6e(0xff)]['splice'](_0x3b1a70,0x1),await _0x4e1bbf[_0x9f4e6e(0xaf9)][_0x9f4e6e(0x32e)](_0x4d4c91,{'comments':_0xa87fbc[_0x9f4e6e(0xff)]});if(_0x2a9802&&_0x2a9802['commenterName']===_0x3e7a1b['qzoneSettings'][_0x9f4e6e(0x78c)]){console[_0x9f4e6e(0x1081)]('用户删除了自己的评论，开始清理AI记忆...');const _0x291c96=new Set();_0xa87fbc['authorId']!==_0x9f4e6e(0xa4d)&&_0x291c96[_0x9f4e6e(0xdda)](_0xa87fbc[_0x9f4e6e(0x1188)]);if(_0x2a9802[_0x9f4e6e(0xe51)]){const _0x18337e=Object['values'](_0x3e7a1b[_0x9f4e6e(0x999)])[_0x9f4e6e(0x137)](_0xd43ba5=>_0xd43ba5[_0x9f4e6e(0x7de)]===_0x2a9802[_0x9f4e6e(0xe51)]);_0x18337e&&_0x291c96[_0x9f4e6e(0xdda)](_0x18337e['id']);}const _0x5b7b4e=(_0xa87fbc[_0x9f4e6e(0x66e)]||_0xa87fbc['content']||'')[_0x9f4e6e(0x126f)](0x0,0x1e),_0x50c1e2=_0x3e7a1b[_0x9f4e6e(0x3c2)][_0x9f4e6e(0x78c)];let _0x5cedf3;const _0x5896b6=_0x3e7a1b[_0x9f4e6e(0xa8b)][_0x9f4e6e(0x137)](_0x2a1a09=>_0x2a1a09[_0x9f4e6e(0xe52)]===_0x2a9802['text']);if(_0x5896b6)_0x5cedf3=_0x9f4e6e(0x21d)+_0x50c1e2+_0x9f4e6e(0x122d)+_0x5b7b4e+_0x9f4e6e(0xeca)+_0x5896b6[_0x9f4e6e(0x6fc)]+'”。';else{if(_0x2a9802['replyTo']){const _0x28db9f=_0x5784e3(_0x2a9802[_0x9f4e6e(0xe51)]);_0x5cedf3=_0x9f4e6e(0x21d)+_0x50c1e2+'\x27刚刚在你的动态“'+_0x5b7b4e+_0x9f4e6e(0xcbb)+_0x28db9f+'\x27的评论，内容是：“'+_0x2a9802[_0x9f4e6e(0x673)]+'”。';}else _0x5cedf3='用户\x27'+_0x50c1e2+_0x9f4e6e(0x73a)+_0x5b7b4e+_0x9f4e6e(0x11f)+_0x2a9802['text']+'”。';}const _0x109738=_0x9f4e6e(0x122f)+_0x5cedf3+'请你对此作出回应。]';for(const _0x1bd48c of _0x291c96){const _0x245904=_0x3e7a1b[_0x9f4e6e(0x999)][_0x1bd48c];if(_0x245904){const _0x2ca05c=_0x245904['history'][_0x9f4e6e(0x40f)];_0x245904[_0x9f4e6e(0x830)]=_0x245904[_0x9f4e6e(0x830)][_0x9f4e6e(0x156)](_0x4b530d=>!(_0x4b530d[_0x9f4e6e(0x5cc)]&&_0x4b530d[_0x9f4e6e(0x931)]===_0x9f4e6e(0x905)&&_0x4b530d[_0x9f4e6e(0x3ba)]===_0x109738)),_0x245904[_0x9f4e6e(0x830)][_0x9f4e6e(0x40f)]<_0x2ca05c&&(console['log'](_0x9f4e6e(0xa81)+_0x245904[_0x9f4e6e(0x6fc)]+_0x9f4e6e(0x13b2)),await _0x4e1bbf[_0x9f4e6e(0x999)][_0x9f4e6e(0x4fa)](_0x245904));}}}await _0x2e523e(_0x4d4c91);}return;}const _0x1bd07c=_0x57a26f[_0x9f4e6e(0x2fc)](_0x9f4e6e(0xbde));if(_0x1bd07c){const _0x483788=_0x1bd07c[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x1071));if(!_0x483788)return;const _0x31f319=parseInt(_0x483788[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x6c2)]);_0x146c2e[_0x9f4e6e(0xb68)]&&_0x146c2e[_0x9f4e6e(0x3af)]===_0x31f319?_0x42f08a():_0x203acf(_0x31f319,_0x1bd07c);return;}const _0x37bc1b=_0x57a26f['closest'](_0x9f4e6e(0x153));if(_0x37bc1b){const _0x1f1cff=parseInt(_0x37bc1b['dataset']['postId']),_0x5a7a3a=_0x37bc1b[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x7c1)],_0x539699=_0x37bc1b[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x7f1)];if(!_0x5a7a3a||!_0x539699||_0x5a7a3a===_0x3e7a1b[_0x9f4e6e(0x3c2)][_0x9f4e6e(0x78c)]){_0x3ead3d(_0x37bc1b[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x1071)));return;}_0x46c8df={'postId':_0x1f1cff,'replyToName':_0x5a7a3a,'replyToDisplayName':_0x539699};const _0x2ce281=_0x37bc1b[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x1071)),_0x3d0e0=_0x2ce281[_0x9f4e6e(0x49c)](_0x9f4e6e(0x272));_0x3d0e0[_0x9f4e6e(0x1323)]=_0x9f4e6e(0x2d4)+_0x539699+':',_0x3d0e0[_0x9f4e6e(0x1218)]();return;}if(_0x57a26f[_0x9f4e6e(0x418)][_0x9f4e6e(0xef6)](_0x9f4e6e(0xa1b))){const _0x263135=_0x57a26f[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x1071));if(_0x263135&&_0x263135[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x6c2)])_0x3a5b4d(parseInt(_0x263135[_0x9f4e6e(0x12e1)]['postId']));return;}if(_0x57a26f['tagName']===_0x9f4e6e(0x7bf)&&_0x57a26f[_0x9f4e6e(0x12e1)]['hiddenText']){_0x28974b('图片内容',_0x57a26f[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x11e7)][_0x9f4e6e(0x137f)](/<br>/g,'\x0a'));return;}const _0x380d0e=_0x57a26f[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x1071));if(!_0x380d0e)return;const _0x275ad6=parseInt(_0x380d0e[_0x9f4e6e(0x12e1)][_0x9f4e6e(0x6c2)]);if(isNaN(_0x275ad6))return;if(_0x57a26f[_0x9f4e6e(0x2fc)]('.qzone-post-delete-action')){const _0x5d845a=await _0x54149f(_0x9f4e6e(0x366),_0x9f4e6e(0x402),{'confirmButtonClass':_0x9f4e6e(0xeed)});_0x5d845a&&(_0x380d0e['style'][_0x9f4e6e(0xdc4)]=_0x9f4e6e(0xa9),_0x380d0e[_0x9f4e6e(0x731)]['transform']=_0x9f4e6e(0x105e),_0x380d0e[_0x9f4e6e(0x731)][_0x9f4e6e(0x131a)]='0',setTimeout(async()=>{const _0x3c6f5b=_0x9f4e6e;await _0x4e1bbf['qzonePosts'][_0x3c6f5b(0x3aa)](_0x275ad6);const _0x307c20=_0x3c6f5b(0xfc6)+_0x275ad6+')';for(const _0x5e0f88 in _0x3e7a1b['chats']){const _0x552cdb=_0x3e7a1b[_0x3c6f5b(0x999)][_0x5e0f88],_0x3ccd90=_0x552cdb[_0x3c6f5b(0x830)][_0x3c6f5b(0x40f)];_0x552cdb[_0x3c6f5b(0x830)]=_0x552cdb[_0x3c6f5b(0x830)][_0x3c6f5b(0x156)](_0x429fb3=>!(_0x429fb3[_0x3c6f5b(0x931)]==='system'&&_0x429fb3[_0x3c6f5b(0x3ba)][_0x3c6f5b(0xe53)](_0x307c20)));if(_0x552cdb[_0x3c6f5b(0x830)][_0x3c6f5b(0x40f)]<_0x3ccd90)await _0x4e1bbf[_0x3c6f5b(0x999)][_0x3c6f5b(0x4fa)](_0x552cdb);}await _0x40e6dd(),alert(_0x3c6f5b(0xc7c));},0x12c));return;}const _0x144f8f=_0x57a26f[_0x9f4e6e(0x2fc)]('.action-icon');if(_0x144f8f){if(_0x144f8f[_0x9f4e6e(0x418)][_0x9f4e6e(0xef6)](_0x9f4e6e(0xe5a))){_0x31ae81(_0x275ad6);return;}if(_0x144f8f[_0x9f4e6e(0x418)][_0x9f4e6e(0xef6)](_0x9f4e6e(0x6f0))){const _0x4eec6c=_0x10d3d6[_0x9f4e6e(0x137)](_0x1110df=>_0x1110df['id']===_0x275ad6);if(!_0x4eec6c)return;if(!_0x4eec6c[_0x9f4e6e(0x940)])_0x4eec6c['likes']=[];const _0x58121b=_0x3e7a1b[_0x9f4e6e(0x3c2)][_0x9f4e6e(0x78c)],_0x12a325=_0x4eec6c[_0x9f4e6e(0x940)][_0x9f4e6e(0xac7)](_0x58121b);_0x12a325>-0x1?_0x4eec6c[_0x9f4e6e(0x940)][_0x9f4e6e(0x10f9)](_0x12a325,0x1):(_0x4eec6c['likes'][_0x9f4e6e(0x13ee)](_0x58121b),_0x144f8f[_0x9f4e6e(0x418)]['add'](_0x9f4e6e(0x205)),_0x144f8f[_0x9f4e6e(0xf72)](_0x9f4e6e(0xf86),()=>_0x144f8f[_0x9f4e6e(0x418)][_0x9f4e6e(0x1275)](_0x9f4e6e(0x205)),{'once':!![]})),await _0x4e1bbf[_0x9f4e6e(0xaf9)][_0x9f4e6e(0x32e)](_0x275ad6,{'likes':_0x4eec6c[_0x9f4e6e(0x940)]}),await _0x2e523e(_0x275ad6);}if(_0x144f8f['classList'][_0x9f4e6e(0xef6)](_0x9f4e6e(0x1048))){const _0x157294=await _0x4e1bbf[_0x9f4e6e(0x1232)]['where']({'type':_0x9f4e6e(0x5e8),'content.id':_0x275ad6})[_0x9f4e6e(0x5dd)]();if(_0x157294)await _0x4e1bbf['favorites']['delete'](_0x157294['id']),await _0x28974b('提示',_0x9f4e6e(0x73f));else{const _0x2c5fcc=await _0x4e1bbf[_0x9f4e6e(0xaf9)][_0x9f4e6e(0x11fc)](_0x275ad6);_0x2c5fcc&&(await _0x4e1bbf[_0x9f4e6e(0x1232)]['add']({'type':'qzone_post','content':_0x2c5fcc,'timestamp':Date[_0x9f4e6e(0x2b5)]()}),await _0x28974b('提示',_0x9f4e6e(0xb28)));}await _0x2e523e(_0x275ad6);}return;}const _0x5db9c1=_0x57a26f[_0x9f4e6e(0x2fc)](_0x9f4e6e(0x958));if(_0x5db9c1){const _0x400743=_0x380d0e['querySelector'](_0x9f4e6e(0x272)),_0x34c354=_0x400743[_0x9f4e6e(0xbed)]['trim']();if(!_0x34c354)return alert(_0x9f4e6e(0x4ac));const _0x237bae=_0x10d3d6[_0x9f4e6e(0x137)](_0x4ad953=>_0x4ad953['id']===_0x275ad6);if(!_0x237bae)return;if(!_0x237bae[_0x9f4e6e(0xff)])_0x237bae['comments']=[];const _0x3ef53f={'commenterName':_0x3e7a1b[_0x9f4e6e(0x3c2)]['nickname'],'text':_0x34c354,'timestamp':Date[_0x9f4e6e(0x2b5)](),'replyTo':_0x46c8df&&_0x46c8df[_0x9f4e6e(0x6c2)]===_0x275ad6?_0x46c8df[_0x9f4e6e(0xba9)]:null};_0x237bae[_0x9f4e6e(0xff)][_0x9f4e6e(0x13ee)](_0x3ef53f),await _0x4e1bbf[_0x9f4e6e(0xaf9)][_0x9f4e6e(0x32e)](_0x275ad6,{'comments':_0x237bae[_0x9f4e6e(0xff)]});let _0x5e4ef2=(_0x237bae[_0x9f4e6e(0x66e)]||_0x237bae[_0x9f4e6e(0x3ba)]||'')[_0x9f4e6e(0x126f)](0x0,0x1e);const _0x3aec35=_0x3e7a1b[_0x9f4e6e(0x3c2)]['nickname'],_0xd6fe36=new Set();if(_0x237bae[_0x9f4e6e(0x1188)]!==_0x9f4e6e(0xa4d))_0xd6fe36['add'](_0x237bae[_0x9f4e6e(0x1188)]);if(_0x3ef53f[_0x9f4e6e(0xe51)]&&_0x3ef53f[_0x9f4e6e(0xe51)]!==_0x3aec35){const _0x28db6f=Object[_0x9f4e6e(0xd6d)](_0x3e7a1b[_0x9f4e6e(0x999)])[_0x9f4e6e(0x137)](_0x1c55bf=>_0x1c55bf['originalName']===_0x3ef53f[_0x9f4e6e(0xe51)]);if(_0x28db6f)_0xd6fe36[_0x9f4e6e(0xdda)](_0x28db6f['id']);}for(const _0x4aae2f of _0xd6fe36){const _0x4210f2=_0x3e7a1b[_0x9f4e6e(0x999)][_0x4aae2f];if(_0x4210f2&&!_0x4210f2[_0x9f4e6e(0x1167)]){const _0x2e4650=_0x3e7a1b[_0x9f4e6e(0xa8b)]['find'](_0x170b9a=>_0x170b9a[_0x9f4e6e(0xe52)]===_0x34c354);let _0x1f12aa=_0x2e4650?'用户\x27'+_0x3aec35+_0x9f4e6e(0x122d)+_0x5e4ef2+_0x9f4e6e(0xeca)+_0x2e4650[_0x9f4e6e(0x6fc)]+'”。':_0x3ef53f[_0x9f4e6e(0xe51)]?'用户\x27'+_0x3aec35+_0x9f4e6e(0x122d)+_0x5e4ef2+_0x9f4e6e(0xcbb)+_0x46c8df[_0x9f4e6e(0xba0)]+'\x27的评论，内容是：“'+_0x34c354+'”。':_0x9f4e6e(0x21d)+_0x3aec35+_0x9f4e6e(0x73a)+_0x5e4ef2+_0x9f4e6e(0x11f)+_0x34c354+'”。';const _0x534c04={'role':_0x9f4e6e(0x905),'content':_0x9f4e6e(0x122f)+_0x1f12aa+_0x9f4e6e(0x1124),'timestamp':Date[_0x9f4e6e(0x2b5)](),'isHidden':!![]};_0x4210f2[_0x9f4e6e(0x830)][_0x9f4e6e(0x13ee)](_0x534c04),await _0x4e1bbf['chats']['put'](_0x4210f2);}}_0x400743['value']='',_0x3ead3d(_0x380d0e),await _0x2e523e(_0x275ad6);return;}}const _0x5eab31=_0x533380=>{const _0x39210a=_0x412b05,_0x1073aa=_0x533380['target'];if(_0x1073aa['closest'](_0x39210a(0xe90)))return;const _0x3d73b2=_0x533380[_0x39210a(0xf5b)][_0x39210a(0x2fc)](_0x39210a(0x1071));if(!_0x3d73b2)return;_0x10f9d7(_0x3d73b2),_0xe5526c[_0x39210a(0x3b1)]=_0x3d73b2,_0xe5526c[_0x39210a(0xb51)]=!![],_0xe5526c[_0x39210a(0x5e6)]=!![],_0xe5526c[_0x39210a(0xbda)]=null,_0xe5526c[_0x39210a(0xe56)]=_0x533380[_0x39210a(0xafc)][_0x39210a(0xe53)](_0x39210a(0xba))?_0x533380[_0x39210a(0xdb2)]:_0x533380[_0x39210a(0x8ef)][0x0][_0x39210a(0xdb2)],_0xe5526c[_0x39210a(0xe29)]=_0x533380[_0x39210a(0xafc)][_0x39210a(0xe53)]('mouse')?_0x533380['pageY']:_0x533380[_0x39210a(0x8ef)][0x0][_0x39210a(0x1217)],_0xe5526c['activeContainer'][_0x39210a(0x49c)](_0x39210a(0xace))[_0x39210a(0x731)][_0x39210a(0xdc4)]=_0x39210a(0x1209),document[_0x39210a(0xf72)](_0x39210a(0xa59),_0x11c7ee),document[_0x39210a(0xf72)](_0x39210a(0x733),_0x2c3e2c),document[_0x39210a(0xf72)](_0x39210a(0xe0d),_0x11c7ee,{'passive':![]}),document['addEventListener']('touchend',_0x2c3e2c);},_0x11c7ee=_0x120f8c=>{const _0x4c3a35=_0x412b05;if(!_0xe5526c['isDragging']||!_0xe5526c[_0x4c3a35(0x3b1)])return;const _0x4313c2=_0x120f8c[_0x4c3a35(0xafc)]['includes']('mouse')?_0x120f8c[_0x4c3a35(0xdb2)]:_0x120f8c[_0x4c3a35(0x8ef)][0x0][_0x4c3a35(0xdb2)],_0x33f4cc=_0x120f8c[_0x4c3a35(0xafc)][_0x4c3a35(0xe53)](_0x4c3a35(0xba))?_0x120f8c[_0x4c3a35(0x1217)]:_0x120f8c[_0x4c3a35(0x8ef)][0x0]['pageY'],_0x54c2de=_0x4313c2-_0xe5526c[_0x4c3a35(0xe56)],_0x43603e=_0x33f4cc-_0xe5526c['startY'];_0xe5526c[_0x4c3a35(0x5e6)]&&(Math[_0x4c3a35(0x9cf)](_0x54c2de)>0x5||Math[_0x4c3a35(0x9cf)](_0x43603e)>0x5)&&(_0xe5526c[_0x4c3a35(0x5e6)]=![]);!_0xe5526c[_0x4c3a35(0xbda)]&&(Math[_0x4c3a35(0x9cf)](_0x54c2de)>Math['abs'](_0x43603e)?_0xe5526c['swipeDirection']='horizontal':_0xe5526c[_0x4c3a35(0xbda)]=_0x4c3a35(0x11b0));if(_0xe5526c[_0x4c3a35(0xbda)]===_0x4c3a35(0x69)){_0x120f8c[_0x4c3a35(0x8d1)](),_0xe5526c[_0x4c3a35(0x907)]=_0x4313c2;let _0x597633=Math[_0x4c3a35(0x2de)](0x0,Math[_0x4c3a35(0x804)](-0x5a,_0x54c2de));_0xe5526c[_0x4c3a35(0x3b1)][_0x4c3a35(0x49c)](_0x4c3a35(0xace))[_0x4c3a35(0x731)][_0x4c3a35(0x70b)]=_0x4c3a35(0x83)+_0x597633+_0x4c3a35(0x9a5);}},_0x2c3e2c=_0xc95228=>{const _0x3dd6e7=_0x412b05;document['removeEventListener'](_0x3dd6e7(0xa59),_0x11c7ee),document[_0x3dd6e7(0xd74)]('mouseup',_0x2c3e2c),document[_0x3dd6e7(0xd74)](_0x3dd6e7(0xe0d),_0x11c7ee),document[_0x3dd6e7(0xd74)](_0x3dd6e7(0x6b2),_0x2c3e2c);if(!_0xe5526c[_0x3dd6e7(0xb51)]||!_0xe5526c[_0x3dd6e7(0x3b1)])return;const _0x34e33b=_0xe5526c[_0x3dd6e7(0x3b1)][_0x3dd6e7(0x49c)](_0x3dd6e7(0xace));_0x34e33b[_0x3dd6e7(0x731)]['transition']='transform\x200.3s\x20ease';if(_0xe5526c['swipeDirection']==='horizontal'&&!_0xe5526c['isClick']){const _0x2427b2=_0xc95228[_0x3dd6e7(0xafc)][_0x3dd6e7(0xe53)](_0x3dd6e7(0x6b2))?_0xc95228[_0x3dd6e7(0x109f)][0x0]['pageX']:_0xc95228['pageX'],_0x446ad1=_0x2427b2-_0xe5526c['startX'];_0x446ad1<-0x28?_0x34e33b[_0x3dd6e7(0x418)]['add']('swiped'):_0x34e33b['classList'][_0x3dd6e7(0x1275)]('swiped');}_0x34e33b[_0x3dd6e7(0x731)][_0x3dd6e7(0x70b)]='',_0xe5526c[_0x3dd6e7(0xb51)]=![],_0xe5526c[_0x3dd6e7(0x3b1)]=null,_0xe5526c[_0x3dd6e7(0xbda)]=null,_0xe5526c['isClick']=!![];};_0x5f4cd2[_0x412b05(0xf72)](_0x412b05(0x1080),_0x55ce0c),_0x5f4cd2[_0x412b05(0xf72)](_0x412b05(0x48d),_0x5eab31),_0x5f4cd2['addEventListener']('touchstart',_0x5eab31,{'passive':!![]}),_0x5f4cd2[_0x412b05(0xf72)](_0x412b05(0x1080),_0x16e626=>{const _0x37e53f=_0x412b05;_0x16e626[_0x37e53f(0xf5b)]&&_0x16e626[_0x37e53f(0xf5b)]['id']===_0x37e53f(0x73)&&_0xc395();}),document['getElementById'](_0x412b05(0x332))['addEventListener'](_0x412b05(0x1080),()=>{const _0x4ed3d3=_0x412b05;_0x3e7a1b['activeChatId']&&_0x5ac5c5(_0x3e7a1b[_0x4ed3d3(0x777)]);}),document['getElementById'](_0x412b05(0x44e))['addEventListener'](_0x412b05(0x834),_0x278a1f),document[_0x412b05(0x64f)]('save-api-preset-btn')[_0x412b05(0xf72)]('click',_0x112f1f),document[_0x412b05(0x64f)](_0x412b05(0x318))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x230be6),document[_0x412b05(0x64f)](_0x412b05(0xeb2))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2f51a5=_0x412b05,_0x2c0c44=document['getElementById'](_0x2f51a5(0x10e8));_0x2c0c44[_0x2f51a5(0x49c)]('p')&&(_0x2c0c44[_0x2f51a5(0xc58)]='');const _0x1a78ce=_0x20cd0b();_0x2c0c44[_0x2f51a5(0x99e)](_0x1a78ce),_0x1a78ce['querySelector'](_0x2f51a5(0x2ba))[_0x2f51a5(0x1218)]();}),document[_0x412b05(0x64f)](_0x412b05(0xcbe))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x545e0a),document['getElementById']('thoughts-history-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4142e2=>{const _0x5856a6=_0x412b05;_0x4142e2[_0x5856a6(0xf5b)]&&_0x4142e2['target']['id']===_0x5856a6(0x279)&&_0x2b08a1();}),document['getElementById'](_0x412b05(0x13bf))['addEventListener']('click',_0x56d2c2),document[_0x412b05(0x64f)](_0x412b05(0x1039))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1ec9a4),document[_0x412b05(0x64f)](_0x412b05(0xee7))['addEventListener'](_0x412b05(0x1080),_0xf9c843=>{const _0x4549a2=_0x412b05;_0xf9c843[_0x4549a2(0xf5b)]['id']===_0x4549a2(0xee7)&&_0xf9c843[_0x4549a2(0xf5b)][_0x4549a2(0x418)]['remove'](_0x4549a2(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x1372))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4a4ef4),document[_0x412b05(0x64f)](_0x412b05(0xcb))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x48fd44),document[_0x412b05(0x64f)](_0x412b05(0x955))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x5983f6('messages-view')),document[_0x412b05(0x64f)](_0x412b05(0xa98))[_0x412b05(0xf72)]('click',()=>_0x5983f6(_0x412b05(0x476)));const _0x2f3e6a=document[_0x412b05(0x64f)](_0x412b05(0xf76)),_0x2d1418=document['getElementById'](_0x412b05(0x766));_0x2f3e6a[_0x412b05(0xf72)](_0x412b05(0x62b),()=>{const _0x2e8094=_0x412b05,_0x7297e4=_0x2f3e6a['value'][_0x2e8094(0x43a)]()[_0x2e8094(0x36d)]();_0x2d1418[_0x2e8094(0x731)][_0x2e8094(0x130)]=_0x7297e4?_0x2e8094(0xb37):_0x2e8094(0x1209);if(!_0x7297e4){_0x1dbcf8(allFavoriteItems);return;}const _0x55d950=allFavoriteItems['filter'](_0x4e651b=>{const _0x32b355=_0x2e8094;let _0x44439b='',_0x572c60='';if(_0x4e651b[_0x32b355(0xafc)]===_0x32b355(0x5e8)){const _0x8f5b8b=_0x4e651b['content'];_0x44439b+=(_0x8f5b8b['publicText']||'')+'\x20'+(_0x8f5b8b[_0x32b355(0x3ba)]||'');if(_0x8f5b8b[_0x32b355(0x1188)]===_0x32b355(0xa4d))_0x572c60=_0x3e7a1b[_0x32b355(0x3c2)][_0x32b355(0x78c)];else _0x3e7a1b[_0x32b355(0x999)][_0x8f5b8b[_0x32b355(0x1188)]]&&(_0x572c60=_0x3e7a1b['chats'][_0x8f5b8b[_0x32b355(0x1188)]]['name']);}else{if(_0x4e651b[_0x32b355(0xafc)]===_0x32b355(0x102b)){const _0x2f1e51=_0x4e651b[_0x32b355(0x3ba)];typeof _0x2f1e51[_0x32b355(0x3ba)]===_0x32b355(0x1251)&&(_0x44439b=_0x2f1e51[_0x32b355(0x3ba)]);const _0x1b7c94=_0x3e7a1b[_0x32b355(0x999)][_0x4e651b[_0x32b355(0x367)]];_0x1b7c94&&(_0x2f1e51['role']===_0x32b355(0xa4d)?_0x572c60=_0x1b7c94[_0x32b355(0x1167)]?_0x1b7c94[_0x32b355(0xcb3)][_0x32b355(0x96f)]||'我':'我':_0x572c60=_0x1b7c94[_0x32b355(0x1167)]?_0x2f1e51[_0x32b355(0x133d)]:_0x1b7c94[_0x32b355(0x6fc)]);}}return _0x44439b[_0x32b355(0x36d)]()[_0x32b355(0xe53)](_0x7297e4)||_0x572c60[_0x32b355(0x36d)]()[_0x32b355(0xe53)](_0x7297e4);});_0x1dbcf8(_0x55d950);}),_0x2d1418[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2ebf26=_0x412b05;_0x2f3e6a[_0x2ebf26(0xbed)]='',_0x2d1418[_0x2ebf26(0x731)]['display']='none',_0x1dbcf8(allFavoriteItems),_0x2f3e6a[_0x2ebf26(0x1218)]();}),document[_0x412b05(0x64f)](_0x412b05(0x334))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x306afb=_0x412b05;if(_0x3b4859['size']===0x0)return;const _0x1af417=_0x3e7a1b[_0x306afb(0x999)][_0x3e7a1b[_0x306afb(0x777)]];if(!_0x1af417)return;const _0x2c82b0=[],_0x1f5a46=[..._0x3b4859];for(const _0x1ba74b of _0x1f5a46){const _0x5be2c0=await _0x4e1bbf[_0x306afb(0x1232)][_0x306afb(0xec9)]('originalTimestamp')['equals'](_0x1ba74b)[_0x306afb(0x5dd)]();if(!_0x5be2c0){const _0xd230db=_0x1af417['history'][_0x306afb(0x137)](_0x4de854=>_0x4de854[_0x306afb(0x8af)]===_0x1ba74b);_0xd230db&&_0x2c82b0[_0x306afb(0x13ee)]({'type':_0x306afb(0x102b),'content':_0xd230db,'chatId':_0x3e7a1b[_0x306afb(0x777)],'timestamp':Date['now'](),'originalTimestamp':_0xd230db[_0x306afb(0x8af)]});}}_0x2c82b0[_0x306afb(0x40f)]>0x0?(await _0x4e1bbf[_0x306afb(0x1232)][_0x306afb(0x36f)](_0x2c82b0),allFavoriteItems=await _0x4e1bbf[_0x306afb(0x1232)][_0x306afb(0xe1d)]('timestamp')[_0x306afb(0x2f4)]()[_0x306afb(0x78f)](),await _0x28974b(_0x306afb(0x11cb),'已成功收藏\x20'+_0x2c82b0[_0x306afb(0x40f)]+'\x20条消息。')):await _0x28974b('提示','选中的消息均已收藏过。'),_0x5ec8b6();});const _0x171650=document[_0x412b05(0x64f)](_0x412b05(0x398)),_0x1b3c40=document[_0x412b05(0x64f)](_0x412b05(0xc15)),_0xe5d1b3=document[_0x412b05(0x64f)]('favorites-action-bar'),_0x2f2cbf=document['getElementById'](_0x412b05(0x7c)),_0x32a719=document[_0x412b05(0x64f)](_0x412b05(0x10d7));_0x171650[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3fe4f1=_0x412b05;_0x3dfde5=!_0x3dfde5,_0x1b3c40[_0x3fe4f1(0x418)][_0x3fe4f1(0x5cf)](_0x3fe4f1(0x2c5),_0x3dfde5),_0x3dfde5?(_0x171650[_0x3fe4f1(0xee5)]='完成',_0xe5d1b3[_0x3fe4f1(0x731)]['display']=_0x3fe4f1(0xb37),_0x2f2cbf[_0x3fe4f1(0x731)][_0x3fe4f1(0x130)]='none',_0x32a719['style'][_0x3fe4f1(0xf2b)]=_0x3fe4f1(0x56a)):(_0x171650[_0x3fe4f1(0xee5)]='编辑',_0xe5d1b3[_0x3fe4f1(0x731)]['display']=_0x3fe4f1(0x1209),_0x2f2cbf[_0x3fe4f1(0x731)][_0x3fe4f1(0x130)]='flex',_0x32a719[_0x3fe4f1(0x731)][_0x3fe4f1(0xf2b)]='',_0x3ee2b5[_0x3fe4f1(0x1057)](),document['querySelectorAll'](_0x3fe4f1(0x519))[_0x3fe4f1(0x103)](_0x381ce0=>_0x381ce0[_0x3fe4f1(0x418)][_0x3fe4f1(0x1275)](_0x3fe4f1(0xbe6))),document[_0x3fe4f1(0x64f)](_0x3fe4f1(0xcd9))[_0x3fe4f1(0xee5)]=_0x3fe4f1(0xb08));}),document[_0x412b05(0x64f)](_0x412b05(0x10d7))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5a7f56=>{const _0x20d5bb=_0x412b05,_0x1755e3=_0x5a7f56[_0x20d5bb(0xf5b)],_0x10ebba=_0x1755e3[_0x20d5bb(0x2fc)](_0x20d5bb(0xfaf));if(_0x1755e3['tagName']===_0x20d5bb(0x7bf)&&_0x1755e3[_0x20d5bb(0x12e1)]['hiddenText']){const _0x23d38c=_0x1755e3[_0x20d5bb(0x12e1)][_0x20d5bb(0x11e7)];_0x28974b('图片内容',_0x23d38c[_0x20d5bb(0x137f)](/<br>/g,'\x0a'));return;}if(!_0x3dfde5)return;if(!_0x10ebba)return;const _0x195b23=parseInt(_0x10ebba['dataset'][_0x20d5bb(0xd69)]);if(isNaN(_0x195b23))return;_0x3ee2b5[_0x20d5bb(0x2a6)](_0x195b23)?(_0x3ee2b5[_0x20d5bb(0x3aa)](_0x195b23),_0x10ebba['classList'][_0x20d5bb(0x1275)](_0x20d5bb(0xbe6))):(_0x3ee2b5[_0x20d5bb(0xdda)](_0x195b23),_0x10ebba[_0x20d5bb(0x418)][_0x20d5bb(0xdda)](_0x20d5bb(0xbe6))),document[_0x20d5bb(0x64f)](_0x20d5bb(0xcd9))['textContent']=_0x20d5bb(0x83c)+_0x3ee2b5[_0x20d5bb(0x9dd)]+')';}),document[_0x412b05(0x64f)](_0x412b05(0xcd9))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x14f58c=_0x412b05;if(_0x3ee2b5[_0x14f58c(0x9dd)]===0x0)return;const _0xc7bc66=await _0x54149f('确认删除',_0x14f58c(0xc8a)+_0x3ee2b5[_0x14f58c(0x9dd)]+_0x14f58c(0x13b9),{'confirmButtonClass':'btn-danger'});if(_0xc7bc66){const _0x40c96c=[..._0x3ee2b5];await _0x4e1bbf['favorites'][_0x14f58c(0x303)](_0x40c96c),await _0x28974b(_0x14f58c(0x121d),_0x14f58c(0xedd)),allFavoriteItems=allFavoriteItems[_0x14f58c(0x156)](_0x44b216=>!_0x40c96c[_0x14f58c(0xe53)](_0x44b216['id'])),_0x1dbcf8(allFavoriteItems),_0x171650[_0x14f58c(0x1080)]();}});_0x3e7a1b['globalSettings']['enableBackgroundActivity']&&(_0x26a3f0(),console[_0x412b05(0x1081)]('后台活动模拟已自动启动。'));document[_0x412b05(0x233)](_0x412b05(0x4a6))['forEach'](_0x56a648=>{const _0x1daddd=_0x412b05;_0x56a648[_0x1daddd(0xf72)](_0x1daddd(0x834),_0x29eae3);});const _0x1bfb4e=document['getElementById']('font-size-slider');_0x1bfb4e[_0x412b05(0xf72)](_0x412b05(0x62b),()=>{const _0xba60f0=_0x412b05;document[_0xba60f0(0x64f)]('font-size-value')['textContent']=_0x1bfb4e[_0xba60f0(0xbed)]+'px',_0x29eae3();});const _0x34af1e=document[_0x412b05(0x64f)](_0x412b05(0x13a0));_0x34af1e['addEventListener'](_0x412b05(0x62b),_0x29eae3),document[_0x412b05(0x64f)]('reset-theme-btn')['addEventListener'](_0x412b05(0x1080),()=>{const _0x5c9317=_0x412b05;document['getElementById'](_0x5c9317(0x1254))[_0x5c9317(0xf1d)]=!![],_0x29eae3();}),document[_0x412b05(0x64f)](_0x412b05(0x6c8))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0xe3fe71=_0x412b05;document[_0xe3fe71(0x64f)](_0xe3fe71(0x13a0))[_0xe3fe71(0xbed)]='',_0x29eae3();}),document[_0x412b05(0x64f)]('lyrics-vertical-pos')[_0x412b05(0xf72)](_0x412b05(0x834),_0x29eae3),document[_0x412b05(0x64f)](_0x412b05(0x92c))[_0x412b05(0xf72)]('change',_0x29eae3),document[_0x412b05(0x64f)]('lyrics-offset-input')[_0x412b05(0xf72)](_0x412b05(0x62b),_0x29eae3),document['querySelectorAll'](_0x412b05(0x8b9))[_0x412b05(0x103)](_0x4aa389=>{const _0x558e42=_0x412b05;_0x4aa389['addEventListener'](_0x558e42(0x834),function(){const _0x29c96b=_0x558e42,_0x243976=document[_0x29c96b(0x64f)](_0x29c96b(0x68f));this[_0x29c96b(0xbed)]===_0x29c96b(0x108d)||this[_0x29c96b(0xbed)]===_0x29c96b(0xd2c)?_0x243976[_0x29c96b(0x731)][_0x29c96b(0x130)]=_0x29c96b(0xb37):_0x243976['style'][_0x29c96b(0x130)]=_0x29c96b(0x1209);});}),document['getElementById'](_0x412b05(0x120c))[_0x412b05(0xf72)]('click',_0x211af4),document[_0x412b05(0x64f)]('close-group-manager-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x52e9b7=_0x412b05;document[_0x52e9b7(0x64f)](_0x52e9b7(0x6e5))[_0x52e9b7(0x418)][_0x52e9b7(0x1275)](_0x52e9b7(0x40a));const _0x2a6d23=document[_0x52e9b7(0x64f)](_0x52e9b7(0x11c4));document[_0x52e9b7(0x64f)](_0x52e9b7(0x201))['classList']['contains'](_0x52e9b7(0x40a))&&_0x2a6d23[_0x52e9b7(0x1080)]();}),document[_0x412b05(0x64f)](_0x412b05(0x13e9))[_0x412b05(0xf72)]('click',_0x279c58),document['getElementById'](_0x412b05(0x12a0))['addEventListener'](_0x412b05(0x1080),_0x3cd76e=>{const _0x12994e=_0x412b05;if(_0x3cd76e[_0x12994e(0xf5b)][_0x12994e(0x418)][_0x12994e(0xef6)](_0x12994e(0xfb1))){const _0x5a355d=parseInt(_0x3cd76e[_0x12994e(0xf5b)]['dataset']['id']);_0x32869a(_0x5a355d);}}),document[_0x412b05(0x64f)](_0x412b05(0x5f1))['addEventListener'](_0x412b05(0x1080),_0x4a722d),document[_0x412b05(0x64f)](_0x412b05(0x95))[_0x412b05(0xf72)]('click',_0x4f5854),document['getElementById'](_0x412b05(0x737))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xedb5e6),document[_0x412b05(0x64f)]('recall-message-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3d2e1a),document[_0x412b05(0x64f)](_0x412b05(0x11a7))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x347aa7=_0x5096e4;_0x4a722d(),_0x347aa7&&_0x23c2e7(_0x347aa7);}),document[_0x412b05(0x64f)](_0x412b05(0x207))[_0x412b05(0xf72)]('click',_0x3301d5=>{const _0x4b1add=_0x412b05,_0x104376=_0x3301d5[_0x4b1add(0xf5b)][_0x4b1add(0x2fc)](_0x4b1add(0x114f));if(!_0x104376)return;if(_0x104376[_0x4b1add(0x418)][_0x4b1add(0xef6)]('ai')&&_0x104376[_0x4b1add(0x418)]['contains'](_0x4b1add(0xf9b))&&_0x104376[_0x4b1add(0x12e1)][_0x4b1add(0x69e)]==='pending'){const _0x1c622d=parseInt(_0x104376['dataset']['timestamp']);!isNaN(_0x1c622d)&&_0x268b16(_0x1c622d);}}),document[_0x412b05(0x64f)](_0x412b05(0x990))['addEventListener']('click',()=>_0x2c9f3b(_0x412b05(0x352))),document[_0x412b05(0x64f)](_0x412b05(0x115c))[_0x412b05(0xf72)]('click',()=>_0x2c9f3b('declined')),document['getElementById'](_0x412b05(0x13d7))[_0x412b05(0xf72)]('click',_0x5e89d0),document[_0x412b05(0x64f)]('edit-post-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5e82d8),document[_0x412b05(0x64f)](_0x412b05(0x512))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x6c2020),document['getElementById'](_0x412b05(0xd00))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x204624),document[_0x412b05(0x64f)](_0x412b05(0x105a))[_0x412b05(0xf72)]('click',()=>{const _0xd96dda=_0x412b05;_0xddd8ae(_0xd96dda(0xbb6));}),document[_0x412b05(0x64f)]('contact-picker-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x47aabb=>{const _0x1d5013=_0x412b05,_0x2739f5=_0x47aabb['target'][_0x1d5013(0x2fc)](_0x1d5013(0x139));if(!_0x2739f5)return;const _0x44690e=_0x2739f5[_0x1d5013(0x12e1)]['contactId'];_0x2739f5['classList'][_0x1d5013(0x5cf)]('selected'),_0x3c5979[_0x1d5013(0x2a6)](_0x44690e)?_0x3c5979[_0x1d5013(0x3aa)](_0x44690e):_0x3c5979[_0x1d5013(0xdda)](_0x44690e),_0x2ecf66();}),document[_0x412b05(0x64f)](_0x412b05(0x7c9))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{_0x583985();}),document[_0x412b05(0x64f)]('back-from-member-management')[_0x412b05(0xf72)]('click',()=>{const _0x48ee7a=_0x412b05;_0xddd8ae(_0x48ee7a(0x9aa)),document[_0x48ee7a(0x64f)](_0x48ee7a(0x11c4))[_0x48ee7a(0x1080)]();}),document['getElementById']('member-management-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2ee063=>{const _0x1fc627=_0x412b05;_0x2ee063[_0x1fc627(0xf5b)]['classList']['contains'](_0x1fc627(0x1cc))&&_0x2705f2(_0x2ee063[_0x1fc627(0xf5b)][_0x1fc627(0x12e1)][_0x1fc627(0x2c8)]);}),document[_0x412b05(0x64f)](_0x412b05(0x350))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x51343f=_0x412b05,_0x5a051d=document[_0x51343f(0x64f)](_0x51343f(0xb8d)),_0x102f97=_0x5a051d[_0x51343f(0xc66)](!![]);_0x5a051d[_0x51343f(0x9be)][_0x51343f(0x3d4)](_0x102f97,_0x5a051d),_0x102f97[_0x51343f(0xf72)](_0x51343f(0x1080),_0x1921c2),await _0x211ff8();}),document[_0x412b05(0x64f)]('create-new-member-btn')['addEventListener']('click',_0x4dd112),document[_0x412b05(0x64f)](_0x412b05(0x1015))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1c8477),document['getElementById'](_0x412b05(0x6b5))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1c8477),document[_0x412b05(0x64f)]('hang-up-btn')[_0x412b05(0xf72)]('click',_0x56cd92),document[_0x412b05(0x64f)](_0x412b05(0xafe))[_0x412b05(0xf72)]('click',()=>{const _0x220feb=_0x412b05;_0x42b67f[_0x220feb(0x7f0)]=![],_0xddd8ae(_0x220feb(0x9aa));}),document[_0x412b05(0x64f)](_0x412b05(0x11a1))['addEventListener'](_0x412b05(0x1080),_0x132a18),document[_0x412b05(0x64f)](_0x412b05(0x599))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x1b9db8=_0x412b05;_0x1d1d7f();const _0x472813=_0x3e7a1b['chats'][_0x42b67f[_0x1b9db8(0x777)]];if(!_0x472813)return;if(_0x42b67f[_0x1b9db8(0xeee)]){_0x42b67f['isUserParticipating']=![];const _0x283c40={'role':'system','content':'[系统提示：用户拒绝了通话邀请，但你们可以自己开始。请你们各自决策是否加入。]','timestamp':Date[_0x1b9db8(0x2b5)](),'isHidden':!![]};_0x472813[_0x1b9db8(0x830)][_0x1b9db8(0x13ee)](_0x283c40),await _0x4e1bbf[_0x1b9db8(0x999)]['put'](_0x472813),await _0x20a638();}else{const _0x48222c={'role':_0x1b9db8(0xa4d),'content':_0x1b9db8(0x57a),'timestamp':Date['now']()};_0x472813[_0x1b9db8(0x830)]['push'](_0x48222c),await _0x4e1bbf[_0x1b9db8(0x999)][_0x1b9db8(0x4fa)](_0x472813),_0xddd8ae(_0x1b9db8(0x9aa)),_0x3c7e84(_0x48222c,_0x472813),_0x20a638();}_0x42b67f[_0x1b9db8(0x7f0)]=![];}),document[_0x412b05(0x64f)](_0x412b05(0x758))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x2a2d39=_0x412b05;_0x1d1d7f(),_0x42b67f[_0x2a2d39(0xc50)]='ai',_0x42b67f[_0x2a2d39(0xed6)]=!![],_0x42b67f[_0x2a2d39(0x777)]=_0x3e7a1b['activeChatId'];if(_0x42b67f['isGroupCall']){const _0x446649=_0x3e7a1b['chats'][_0x42b67f[_0x2a2d39(0x777)]],_0x58475e=_0x446649[_0x2a2d39(0x5d4)][_0x2a2d39(0x137)](_0x5d2c49=>_0x5d2c49[_0x2a2d39(0x6fc)]===_0x42b67f['callRequester']);_0x58475e?_0x42b67f[_0x2a2d39(0x90f)]=[_0x58475e]:_0x42b67f[_0x2a2d39(0x90f)]=[];}_0xa524bc();}),document[_0x412b05(0x64f)](_0x412b05(0xa92))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x11ee45=_0x412b05;if(!_0x42b67f['isActive'])return;const _0x24377f=document[_0x11ee45(0x49c)]('.participant-avatar-wrapper[data-participant-id=\x22user\x22]\x20.participant-avatar');_0x24377f&&_0x24377f[_0x11ee45(0x418)][_0x11ee45(0xdda)]('speaking');const _0x4a857f=await _0x41e3f8('你说',_0x11ee45(0x91));_0x24377f&&_0x24377f['classList'][_0x11ee45(0x1275)](_0x11ee45(0x6ba)),_0x4a857f&&_0x4a857f[_0x11ee45(0x43a)]()&&_0x58fc54(_0x4a857f[_0x11ee45(0x43a)]());}),document[_0x412b05(0x49c)](_0x412b05(0xde9))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x1ce089=_0x412b05;_0x3dfde5&&document[_0x1ce089(0x64f)](_0x1ce089(0x398))['click'](),_0x5983f6(_0x1ce089(0xbf1)),_0x5bff46();}),document['getElementById'](_0x412b05(0xe60))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x5983f6('messages-view')),document[_0x412b05(0x64f)](_0x412b05(0x97))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x545d72=_0x412b05,_0x319fe2=document[_0x545d72(0x64f)]('countdown-title-input')['value'][_0x545d72(0x43a)](),_0x51a2c2=document[_0x545d72(0x64f)](_0x545d72(0xfc3))[_0x545d72(0xbed)];if(!_0x319fe2||!_0x51a2c2){alert(_0x545d72(0xa3));return;}const _0x34e199=new Date(_0x51a2c2);if(isNaN(_0x34e199)||_0x34e199<=new Date()){alert(_0x545d72(0x45e));return;}const _0x5d0e2c={'authorId':_0x545d72(0xa4d),'description':_0x319fe2,'timestamp':Date[_0x545d72(0x2b5)](),'type':_0x545d72(0x110),'targetDate':_0x34e199[_0x545d72(0x767)]()};await _0x4e1bbf['memories'][_0x545d72(0xdda)](_0x5d0e2c),document[_0x545d72(0x64f)]('create-countdown-modal')[_0x545d72(0x418)]['remove'](_0x545d72(0x40a)),_0x5bff46();}),document['getElementById'](_0x412b05(0xdf3))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x216560=_0x412b05;if(!_0x3e7a1b[_0x216560(0x777)]||_0x3e7a1b[_0x216560(0x999)][_0x3e7a1b[_0x216560(0x777)]][_0x216560(0x1167)])return;const _0x235d1a=_0x3e7a1b[_0x216560(0x999)][_0x3e7a1b[_0x216560(0x777)]],_0x31fe05=await _0x54149f(_0x216560(0xfae),_0x216560(0xb65)+_0x235d1a[_0x216560(0x6fc)]+'”吗？拉黑后您将无法向其发送消息，直到您将Ta移出黑名单，或等待Ta重新申请好友。',{'confirmButtonClass':_0x216560(0xeed)});if(_0x31fe05){_0x235d1a[_0x216560(0x55f)][_0x216560(0x69e)]=_0x216560(0x770),_0x235d1a['relationship'][_0x216560(0x338)]=Date[_0x216560(0x2b5)]();const _0x2ff4d6={'role':_0x216560(0x905),'content':_0x216560(0xfe2),'timestamp':Date[_0x216560(0x2b5)]()+0x1,'isHidden':!![]};_0x235d1a[_0x216560(0x830)][_0x216560(0x13ee)](_0x2ff4d6),await _0x4e1bbf[_0x216560(0x999)][_0x216560(0x4fa)](_0x235d1a),document[_0x216560(0x64f)](_0x216560(0x201))[_0x216560(0x418)][_0x216560(0x1275)](_0x216560(0x40a)),_0x4817d1(_0x3e7a1b['activeChatId']),_0x21f6ea();}}),document[_0x412b05(0x64f)](_0x412b05(0x13ce))[_0x412b05(0xf72)](_0x412b05(0x1080),async _0x367b03=>{const _0x39f451=_0x412b05,_0x53feb6=_0x3e7a1b[_0x39f451(0x999)][_0x3e7a1b[_0x39f451(0x777)]];if(!_0x53feb6)return;if(_0x367b03[_0x39f451(0xf5b)]['id']===_0x39f451(0x92a)){alert('正在手动触发好友申请流程，请稍后...\x0a如果API调用成功，将弹出提示。如果失败，也会有错误提示。如果长时间无反应，说明AI可能决定暂时不申请。'),await _0x4a68ca(_0x53feb6['id']),_0x4817d1(_0x53feb6['id']);return;}if(_0x367b03[_0x39f451(0xf5b)]['id']===_0x39f451(0x520)){_0x53feb6[_0x39f451(0x55f)][_0x39f451(0x69e)]='friend',_0x53feb6[_0x39f451(0x55f)][_0x39f451(0x338)]=null;const _0x30dd4e={'role':_0x39f451(0x905),'content':'[系统提示：用户刚刚解除了对你的拉黑。现在你们可以重新开始对话了。]','timestamp':Date[_0x39f451(0x2b5)](),'isHidden':!![]};_0x53feb6[_0x39f451(0x830)][_0x39f451(0x13ee)](_0x30dd4e),await _0x4e1bbf[_0x39f451(0x999)][_0x39f451(0x4fa)](_0x53feb6),_0x4817d1(_0x53feb6['id']),_0x21f6ea(),_0x20a638();}else{if(_0x367b03[_0x39f451(0xf5b)]['id']==='accept-friend-btn'){_0x53feb6['relationship'][_0x39f451(0x69e)]='friend',_0x53feb6[_0x39f451(0x55f)][_0x39f451(0x2e8)]='';const _0x32f354={'role':_0x39f451(0x905),'type':_0x39f451(0xac1),'content':_0x39f451(0xb14)+_0x53feb6['name']+_0x39f451(0xdaf),'timestamp':Date[_0x39f451(0x2b5)]()};_0x53feb6['history'][_0x39f451(0x13ee)](_0x32f354);const _0x27a689={'role':_0x39f451(0x12c3),'senderName':_0x53feb6[_0x39f451(0x6fc)],'content':'太好了！我们又可以聊天啦！','timestamp':Date[_0x39f451(0x2b5)]()+0x1};_0x53feb6['history'][_0x39f451(0x13ee)](_0x27a689),await _0x4e1bbf['chats'][_0x39f451(0x4fa)](_0x53feb6),_0x4817d1(_0x53feb6['id']),_0x21f6ea();}else{if(_0x367b03[_0x39f451(0xf5b)]['id']===_0x39f451(0x8d5))_0x53feb6[_0x39f451(0x55f)]['status']='blocked_by_user',_0x53feb6['relationship'][_0x39f451(0x338)]=Date['now'](),_0x53feb6[_0x39f451(0x55f)][_0x39f451(0x2e8)]='',await _0x4e1bbf['chats']['put'](_0x53feb6),_0x4817d1(_0x53feb6['id']);else{if(_0x367b03[_0x39f451(0xf5b)]['id']===_0x39f451(0x42d)){const _0x1ab20d=await _0x41e3f8(_0x39f451(0x2e9),'请输入你想对“'+_0x53feb6[_0x39f451(0x6fc)]+'”说的申请理由：','我们和好吧！');_0x1ab20d!==null&&(_0x53feb6['relationship'][_0x39f451(0x69e)]=_0x39f451(0x943),_0x53feb6[_0x39f451(0x55f)]['applicationReason']=_0x1ab20d,await _0x4e1bbf[_0x39f451(0x999)][_0x39f451(0x4fa)](_0x53feb6),_0x4817d1(_0x53feb6['id']),_0x21f6ea(),_0x20a638());}}}}}),document['getElementById']('transfer-btn')[_0x412b05(0xf72)]('click',_0x42e362),document['getElementById'](_0x412b05(0x6f1))[_0x412b05(0xf72)]('click',()=>{const _0x5a7e50=_0x412b05;document['getElementById'](_0x5a7e50(0xd44))['classList'][_0x5a7e50(0x1275)](_0x5a7e50(0x40a));}),document['getElementById'](_0x412b05(0xe7))[_0x412b05(0xf72)]('click',_0x3e2365),document[_0x412b05(0x64f)]('send-direct-packet-btn')[_0x412b05(0xf72)]('click',_0x1950ee);const _0xbfc520=document[_0x412b05(0x64f)](_0x412b05(0x240)),_0x582e16=document['getElementById'](_0x412b05(0xda3)),_0x136ba6=document[_0x412b05(0x64f)](_0x412b05(0x139c)),_0x3c5d35=document[_0x412b05(0x64f)](_0x412b05(0x6a0));_0xbfc520[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3d1187=_0x412b05;_0xbfc520[_0x3d1187(0x418)][_0x3d1187(0xdda)]('active'),_0x582e16[_0x3d1187(0x418)][_0x3d1187(0x1275)]('active'),_0x136ba6[_0x3d1187(0x731)][_0x3d1187(0x130)]=_0x3d1187(0xb37),_0x3c5d35['style'][_0x3d1187(0x130)]=_0x3d1187(0x1209);}),_0x582e16[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x257d92=_0x412b05;_0x582e16['classList'][_0x257d92(0xdda)]('active'),_0xbfc520[_0x257d92(0x418)][_0x257d92(0x1275)](_0x257d92(0x12ef)),_0x3c5d35[_0x257d92(0x731)][_0x257d92(0x130)]=_0x257d92(0xb37),_0x136ba6[_0x257d92(0x731)][_0x257d92(0x130)]=_0x257d92(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0x9c1))[_0x412b05(0xf72)](_0x412b05(0x62b),_0x305783=>{const _0x358f82=_0x412b05,_0x15cc3e=parseFloat(_0x305783['target'][_0x358f82(0xbed)])||0x0;document[_0x358f82(0x64f)](_0x358f82(0x13d0))['textContent']='¥\x20'+_0x15cc3e[_0x358f82(0xc89)](0x2);}),document[_0x412b05(0x64f)](_0x412b05(0x985))[_0x412b05(0xf72)](_0x412b05(0x62b),_0x4a49ea=>{const _0x599569=_0x412b05,_0xf8ab5e=parseFloat(_0x4a49ea[_0x599569(0xf5b)][_0x599569(0xbed)])||0x0;document['getElementById'](_0x599569(0xd5f))[_0x599569(0xee5)]='¥\x20'+_0xf8ab5e[_0x599569(0xc89)](0x2);}),document['getElementById']('chat-messages')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x11419d=>{const _0x43084b=_0x412b05,_0xa2b367=_0x11419d[_0x43084b(0xf5b)][_0x43084b(0x2fc)]('.red-packet-card');if(!_0xa2b367)return;const _0x408f45=_0xa2b367[_0x43084b(0x2fc)](_0x43084b(0x114f));if(!_0x408f45||!_0x408f45[_0x43084b(0x12e1)][_0x43084b(0x8af)])return;const _0x5ba8ad=parseInt(_0x408f45[_0x43084b(0x12e1)][_0x43084b(0x8af)]);_0x326b59(_0x5ba8ad);}),document[_0x412b05(0x64f)](_0x412b05(0x1181))[_0x412b05(0xf72)]('click',_0x3fd58b),document[_0x412b05(0x64f)]('add-poll-option-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4b9f2d),document[_0x412b05(0x64f)](_0x412b05(0x1f9))[_0x412b05(0xf72)]('click',()=>{const _0x45e42f=_0x412b05;document[_0x45e42f(0x64f)](_0x45e42f(0x103a))[_0x45e42f(0x418)][_0x45e42f(0x1275)]('visible');}),document[_0x412b05(0x64f)](_0x412b05(0x2df))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x51b63f),document['getElementById'](_0x412b05(0x207))['addEventListener'](_0x412b05(0x1080),_0x44d2ed=>{const _0x2c36d3=_0x412b05,_0x1875ca=_0x44d2ed[_0x2c36d3(0xf5b)][_0x2c36d3(0x2fc)](_0x2c36d3(0xa79));if(!_0x1875ca)return;const _0x578430=parseInt(_0x1875ca[_0x2c36d3(0x12e1)]['pollTimestamp']);if(isNaN(_0x578430))return;const _0x1a8fd3=_0x44d2ed['target'][_0x2c36d3(0x2fc)](_0x2c36d3(0x982));if(_0x1a8fd3&&!_0x1875ca['classList'][_0x2c36d3(0xef6)](_0x2c36d3(0x9a0))){_0x47a317(_0x578430,_0x1a8fd3[_0x2c36d3(0x12e1)][_0x2c36d3(0x1176)]);return;}const _0x4e4ff5=_0x44d2ed['target'][_0x2c36d3(0x2fc)]('.poll-action-btn');if(_0x4e4ff5){_0x1875ca[_0x2c36d3(0x418)]['contains'](_0x2c36d3(0x9a0))?_0x19d3ac(_0x578430):_0x3b9a7e(_0x578430);return;}_0x1875ca[_0x2c36d3(0x418)][_0x2c36d3(0xef6)](_0x2c36d3(0x9a0))&&_0x19d3ac(_0x578430);}),document[_0x412b05(0x64f)]('manage-ai-avatar-library-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5ee89d),document['getElementById'](_0x412b05(0x263))[_0x412b05(0xf72)]('click',()=>_0x54c83c('ai')),document[_0x412b05(0x64f)](_0x412b05(0x2e1))['addEventListener']('click',()=>_0x54c83c(_0x412b05(0xa40))),document['getElementById'](_0x412b05(0xe88))[_0x412b05(0xf72)]('click',_0x41d758),document[_0x412b05(0x64f)](_0x412b05(0x537))['addEventListener'](_0x412b05(0x1080),()=>{const _0x2c24dc=_0x412b05;document[_0x2c24dc(0x64f)](_0x2c24dc(0xb12))[_0x2c24dc(0x1080)]();}),document['getElementById'](_0x412b05(0xb12))['addEventListener'](_0x412b05(0x834),_0x5d8aeb),document[_0x412b05(0x64f)](_0x412b05(0x175))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5cf6e2),document[_0x412b05(0x64f)](_0x412b05(0x60c))[_0x412b05(0xf72)]('click',_0x507536),document[_0x412b05(0x64f)](_0x412b05(0xf1e))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x34c172),document['getElementById'](_0x412b05(0x1fe))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2062cf=_0x412b05;document['getElementById'](_0x2062cf(0x67f))[_0x2062cf(0x1080)]();}),document[_0x412b05(0x64f)](_0x412b05(0x67f))['addEventListener'](_0x412b05(0x834),_0x1ac667),document['getElementById'](_0x412b05(0x15e))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1cbee8),document[_0x412b05(0x64f)](_0x412b05(0x10a0))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4c2240=>{const _0x2d80cd=_0x412b05;if(_0x4c2240['target'][_0x2d80cd(0x418)]['contains'](_0x2d80cd(0xb7d))){const _0x13c5ab=_0x4c2240[_0x2d80cd(0xf5b)][_0x2d80cd(0x2fc)]('.icon-setting-item'),_0x53f05a=_0x13c5ab[_0x2d80cd(0x12e1)][_0x2d80cd(0x221)];_0x53f05a&&_0x18388a(_0x53f05a,_0x2d80cd(0x403),_0x13c5ab);}}),document[_0x412b05(0x64f)](_0x412b05(0x207))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x8ea85f=>{const _0x5d3d4e=_0x412b05,_0x34070d=_0x8ea85f[_0x5d3d4e(0xf5b)][_0x5d3d4e(0x2fc)]('.link-share-card');if(_0x34070d){const _0x56d786=parseInt(_0x34070d[_0x5d3d4e(0x12e1)][_0x5d3d4e(0x8af)]);!isNaN(_0x56d786)&&_0xbc6d58(_0x56d786);}}),document[_0x412b05(0x64f)](_0x412b05(0x816))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x362c69=_0x412b05;_0xddd8ae(_0x362c69(0x9aa));}),_0x146c2e[_0x412b05(0xaab)]['addEventListener'](_0x412b05(0x1080),async _0x56245c=>{const _0x213a03=_0x412b05,_0x1acf7d=_0x56245c['target'][_0x213a03(0x2fc)]('.sticker-item');if(_0x1acf7d&&_0x146c2e['activePostId']!==null){const _0x21a8ad=_0x1acf7d[_0x213a03(0x731)][_0x213a03(0x4d6)]['slice'](0x5,-0x2),_0x59801=_0x3e7a1b[_0x213a03(0xa8b)]['find'](_0x13dc12=>_0x13dc12[_0x213a03(0xe52)]===_0x21a8ad);_0x59801?await _0x1cebda(_0x146c2e['activePostId'],_0x59801):console[_0x213a03(0x1155)]('在动态评论区点击了表情，但在表情库中未找到对象:',_0x21a8ad);}}),document[_0x412b05(0xf72)](_0x412b05(0x1080),_0x313e2a=>{const _0x2750eb=_0x412b05;_0x146c2e['isOpen']&&!_0x146c2e[_0x2750eb(0xaab)]['contains'](_0x313e2a[_0x2750eb(0xf5b)])&&!_0x313e2a[_0x2750eb(0xf5b)]['closest'](_0x2750eb(0xbde))&&_0x42f08a();}),document[_0x412b05(0x64f)](_0x412b05(0xee0))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x39a3ff),document[_0x412b05(0x64f)]('cancel-share-link-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5619b3=_0x412b05;document[_0x5619b3(0x64f)](_0x5619b3(0xfa2))[_0x5619b3(0x418)]['remove'](_0x5619b3(0x40a));}),document[_0x412b05(0x64f)]('confirm-share-link-btn')[_0x412b05(0xf72)]('click',_0x1a37b8),document[_0x412b05(0x64f)](_0x412b05(0x1c7))[_0x412b05(0xf72)](_0x412b05(0x834),_0x377800),document['getElementById'](_0x412b05(0x1ca))['addEventListener']('click',_0x4fd2ec),document['getElementById'](_0x412b05(0xeb9))['addEventListener'](_0x412b05(0x1080),_0x2868c5),document[_0x412b05(0x64f)](_0x412b05(0x3a2))['addEventListener']('click',()=>{const _0x48cbb3=_0x412b05;_0xddd8ae(_0x48cbb3(0xbb6));}),document[_0x412b05(0x64f)]('call-history-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x75121c=>{const _0x4cd787=_0x412b05,_0x137246=_0x75121c[_0x4cd787(0xf5b)]['closest'](_0x4cd787(0xb9f));_0x137246&&_0x137246[_0x4cd787(0x12e1)]['recordId']&&_0x33f10f(parseInt(_0x137246['dataset'][_0x4cd787(0x806)]));}),document[_0x412b05(0x64f)]('close-call-transcript-btn')[_0x412b05(0xf72)]('click',()=>{const _0x1e2f56=_0x412b05;document[_0x1e2f56(0x64f)](_0x1e2f56(0xc65))[_0x1e2f56(0x418)][_0x1e2f56(0x1275)](_0x1e2f56(0x40a));}),document[_0x412b05(0x64f)]('chat-header-status')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5b14a4),document[_0x412b05(0x64f)](_0x412b05(0x11b6))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{_0x3b4859['size']>0x0&&_0xba611b();}),document['getElementById'](_0x412b05(0x926))['addEventListener']('click',_0x37a758),document[_0x412b05(0x64f)](_0x412b05(0x1f3))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x250bec=_0x412b05,_0x47b74c=_0x3e7a1b['chats'][_0x3e7a1b[_0x250bec(0x777)]],_0xff716a=Array[_0x250bec(0xb3a)](document[_0x250bec(0x233)](_0x250bec(0x132d)))[_0x250bec(0xb96)](_0x4ad0d0=>_0x4ad0d0[_0x250bec(0x12e1)][_0x250bec(0x367)]);if(_0xff716a['length']===0x0){alert(_0x250bec(0xaef));return;}const _0x482b6d=[],_0x5abcf1=[..._0x3b4859]['sort']((_0x505397,_0x2a87a8)=>_0x505397-_0x2a87a8);for(const _0x473843 of _0x5abcf1){const _0x54fbb1=_0x47b74c[_0x250bec(0x830)][_0x250bec(0x137)](_0x21f5f7=>_0x21f5f7[_0x250bec(0x8af)]===_0x473843);_0x54fbb1&&_0x482b6d['push'](_0x54fbb1);}const _0x159277={'role':'user','senderName':_0x47b74c[_0x250bec(0x1167)]?_0x47b74c[_0x250bec(0xcb3)][_0x250bec(0x96f)]||'我':'我','type':_0x250bec(0x132),'timestamp':Date[_0x250bec(0x2b5)](),'payload':{'sourceChatName':_0x47b74c[_0x250bec(0x6fc)],'title':'来自“'+_0x47b74c[_0x250bec(0x6fc)]+'”的聊天记录','sharedHistory':_0x482b6d}};for(const _0x32dc45 of _0xff716a){const _0x3aa2dd=_0x3e7a1b[_0x250bec(0x999)][_0x32dc45];_0x3aa2dd&&(_0x3aa2dd[_0x250bec(0x830)][_0x250bec(0x13ee)](_0x159277),await _0x4e1bbf['chats']['put'](_0x3aa2dd));}document[_0x250bec(0x64f)](_0x250bec(0x1137))['classList'][_0x250bec(0x1275)]('visible'),_0x5ec8b6(),await _0x28974b(_0x250bec(0x25b),_0x250bec(0x5e2)+_0xff716a[_0x250bec(0x40f)]+'\x20个会话中。'),_0x21f6ea();}),document[_0x412b05(0x64f)](_0x412b05(0x6de))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x4a83d4=_0x412b05;document[_0x4a83d4(0x64f)](_0x4a83d4(0x1137))['classList'][_0x4a83d4(0x1275)](_0x4a83d4(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x207))['addEventListener'](_0x412b05(0x1080),_0x531dd1=>{const _0x44e85b=_0x412b05,_0x4abf9e=_0x531dd1[_0x44e85b(0xf5b)][_0x44e85b(0x2fc)](_0x44e85b(0xd08));if(_0x4abf9e&&_0x4abf9e[_0x44e85b(0x2fc)](_0x44e85b(0x1116))){const _0x4869a3=parseInt(_0x4abf9e[_0x44e85b(0x12e1)][_0x44e85b(0x8af)]);_0x42be7a(_0x4869a3);}}),document[_0x412b05(0x64f)]('close-shared-history-viewer-btn')['addEventListener'](_0x412b05(0x1080),()=>{const _0x51cfde=_0x412b05;document[_0x51cfde(0x64f)]('shared-history-viewer-modal')[_0x51cfde(0x418)][_0x51cfde(0x1275)]('visible');});async function _0x42be7a(_0x425b1){const _0x1e038d=_0x412b05,_0x4552ea=_0x3e7a1b[_0x1e038d(0x999)][_0x3e7a1b[_0x1e038d(0x777)]];if(!_0x4552ea)return;const _0x1427a1=_0x4552ea['history'][_0x1e038d(0x137)](_0x3edde6=>_0x3edde6[_0x1e038d(0x8af)]===_0x425b1);if(!_0x1427a1){console[_0x1e038d(0xc60)](_0x1e038d(0xfff),_0x425b1),await _0x28974b(_0x1e038d(0x1328),_0x1e038d(0x1086));return;}if(_0x1427a1[_0x1e038d(0xafc)]==='share_link'){_0xbc6d58(_0x425b1);return;}if(_0x1427a1['type']===_0x1e038d(0x132)){if(!_0x1427a1[_0x1e038d(0x1035)]||!_0x1427a1[_0x1e038d(0x1035)][_0x1e038d(0x29e)]){console['error']('聊天记录分享卡片数据损坏:',_0x1427a1),await _0x28974b(_0x1e038d(0x1328),'分享的聊天记录已损坏。');return;}}else{console[_0x1e038d(0xc60)](_0x1e038d(0x55a),_0x1427a1[_0x1e038d(0xafc)]),await _0x28974b(_0x1e038d(0x1328),_0x1e038d(0x1c1));return;}const _0x536e1a=document[_0x1e038d(0x64f)](_0x1e038d(0xad1)),_0x43ffd0=document['getElementById'](_0x1e038d(0xb8c)),_0x312cc2=document['getElementById']('shared-history-viewer-content');_0x43ffd0[_0x1e038d(0xee5)]=_0x1427a1[_0x1e038d(0x1035)][_0x1e038d(0x1250)],_0x312cc2['innerHTML']='';const _0x2d5fa7=document['createDocumentFragment'](),_0x341fec=Object[_0x1e038d(0xd6d)](_0x3e7a1b['chats'])[_0x1e038d(0x137)](_0x92924b=>_0x92924b[_0x1e038d(0x6fc)]===_0x1427a1['payload'][_0x1e038d(0x125a)])||_0x4552ea;for(const _0x20582f of _0x1427a1[_0x1e038d(0x1035)]['sharedHistory']){const _0x529235=await _0x3209f4(_0x20582f,_0x341fec);_0x529235&&_0x2d5fa7[_0x1e038d(0x99e)](_0x529235);}_0x312cc2[_0x1e038d(0x99e)](_0x2d5fa7),_0x536e1a[_0x1e038d(0x418)]['add'](_0x1e038d(0x40a));}_0x51e4a1['addEventListener'](_0x412b05(0x625),_0x11fbd9),_0x51e4a1['addEventListener'](_0x412b05(0x6ef),()=>{const _0x411e8d=_0x412b05;_0x1c083c[_0x411e8d(0xb30)]&&(_0x1c083c[_0x411e8d(0xad6)]=![],_0x320333());}),_0x51e4a1[_0x412b05(0xf72)](_0x412b05(0x1190),()=>{const _0x3f27cd=_0x412b05;_0x1c083c['isActive']&&(_0x1c083c[_0x3f27cd(0xad6)]=!![],_0x320333());}),document[_0x412b05(0x64f)](_0x412b05(0x697))[_0x412b05(0xf72)](_0x412b05(0x1080),async _0x4ee15e=>{const _0x593d40=_0x412b05,_0x51540f=_0x4ee15e[_0x593d40(0xf5b)],_0x1dd3c8=_0x51540f[_0x593d40(0x2fc)]('.album-art-btn');if(_0x1dd3c8){const _0x50dcaf=parseInt(_0x1dd3c8['dataset']['index']);!isNaN(_0x50dcaf)&&await _0x2d7836(_0x50dcaf);return;}const _0xfb16c1=_0x51540f[_0x593d40(0x2fc)](_0x593d40(0xc27));if(_0xfb16c1){const _0x58a4d2=parseInt(_0xfb16c1[_0x593d40(0x12e1)][_0x593d40(0xf84)]);if(isNaN(_0x58a4d2))return;await _0x5a42e4(_0x58a4d2);return;}const _0x1ea747=_0x51540f[_0x593d40(0x2fc)](_0x593d40(0x2f9));if(_0x1ea747){const _0x1efcaf=parseInt(_0x1ea747[_0x593d40(0x12e1)][_0x593d40(0xf84)]);if(isNaN(_0x1efcaf))return;const _0x490d87=_0x1c083c[_0x593d40(0x11ce)][_0x1efcaf],_0x3c6f8c=await _0x54149f('删除歌曲',_0x593d40(0x16d)+_0x490d87[_0x593d40(0x6fc)]+_0x593d40(0x6ee));_0x3c6f8c&&_0x24f2bd(_0x1efcaf);return;}const _0x18a5cb=_0x51540f['closest'](_0x593d40(0xcf5));if(_0x18a5cb){const _0x414ace=_0x18a5cb[_0x593d40(0x2fc)](_0x593d40(0x801)),_0x504010=Array[_0x593d40(0xb3a)](_0x414ace['parentElement']['children'])[_0x593d40(0xac7)](_0x414ace);_0x504010>-0x1&&_0x465c43(_0x504010);}}),document['querySelector'](_0x412b05(0xa5e))['addEventListener'](_0x412b05(0x1080),_0x458271=>{const _0x51888e=_0x412b05;if(!_0x51e4a1[_0x51888e(0x25e)])return;const _0x1723be=_0x458271[_0x51888e(0xfd1)],_0x5bdf07=_0x1723be[_0x51888e(0x1347)],_0x30dd78=_0x458271[_0x51888e(0x5fc)];_0x51e4a1[_0x51888e(0x76)]=_0x30dd78/_0x5bdf07*_0x51e4a1['duration'];}),document['getElementById'](_0x412b05(0x207))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x141a91=>{const _0x465714=_0x412b05,_0x17ae63=_0x141a91[_0x465714(0xf5b)]['closest']('.recalled-message-placeholder');if(_0x17ae63){const _0x5d6b21=_0x3e7a1b['chats'][_0x3e7a1b[_0x465714(0x777)]],_0x544bac=_0x17ae63[_0x465714(0x2fc)]('.message-wrapper');if(_0x5d6b21&&_0x544bac){const _0x77334b=parseInt(_0x544bac[_0x465714(0x12e1)]['timestamp']),_0x28a904=_0x5d6b21[_0x465714(0x830)][_0x465714(0x137)](_0x2c3637=>_0x2c3637[_0x465714(0x8af)]===_0x77334b);if(_0x28a904&&_0x28a904[_0x465714(0x52f)]){let _0x568c36='';const _0x585f45=_0x28a904[_0x465714(0x52f)];switch(_0x585f45['originalType']){case'text':_0x568c36=_0x465714(0xf1b)+_0x585f45[_0x465714(0x13a3)]+'\x22';break;case _0x465714(0xb11):case _0x465714(0x118):case _0x465714(0x351):_0x568c36=_0x465714(0xe8b)+_0x585f45[_0x465714(0x13a3)]+'\x22';break;case'voice_message':_0x568c36=_0x465714(0x439)+_0x585f45[_0x465714(0x13a3)]+'\x22';break;case _0x465714(0xefb):_0x568c36='[表情]\x20含义:\x20\x22'+(_0x585f45['originalMeaning']||'(无)')+_0x465714(0x4bc)+_0x585f45['originalContent'];break;case _0x465714(0xcda):_0x568c36=_0x465714(0xc6a);break;default:_0x568c36=_0x465714(0xc23)+_0x585f45['originalType']+']类型的消息。\x0a内容:\x20'+JSON['stringify'](_0x585f45[_0x465714(0x13a3)]);break;}_0x28974b(_0x465714(0x25d),_0x568c36);}}}}),document['getElementById'](_0x412b05(0x13ad))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1dd65),document['getElementById'](_0x412b05(0xc7a))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2eb879=_0x412b05;document['getElementById'](_0x2eb879(0xb63))[_0x2eb879(0x418)][_0x2eb879(0x1275)](_0x2eb879(0x40a)),_0x511a09();}),document[_0x412b05(0x64f)](_0x412b05(0x600))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x518fe7),document[_0x412b05(0x64f)](_0x412b05(0x584))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3d995a=>{const _0x51858f=_0x412b05;if(_0x3d995a['target']['classList'][_0x51858f(0xef6)]('delete-group-btn')){const _0x122199=parseInt(_0x3d995a[_0x51858f(0xf5b)]['dataset']['id']);_0x17d874(_0x122199);}}),document[_0x412b05(0x64f)]('repost-cancel-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x36deb5),document[_0x412b05(0x64f)](_0x412b05(0xcc1))['addEventListener'](_0x412b05(0x1080),_0x2c8887),document['getElementById'](_0x412b05(0x598))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x110873),document[_0x412b05(0x64f)](_0x412b05(0xd71))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x34ff23),document[_0x412b05(0x64f)](_0x412b05(0x108b))['addEventListener'](_0x412b05(0x62b),_0x4d2d34=>{const _0x2d4b08=_0x412b05;if(!_0x4d2d34['target'][_0x2d4b08(0xf3e)]('.comment-input'))return;const _0x37c1e9=_0x4d2d34[_0x2d4b08(0xf5b)],_0x326562=_0x37c1e9[_0x2d4b08(0x2fc)](_0x2d4b08(0x1071));if(!_0x326562)return;const _0x5d717f=_0x326562[_0x2d4b08(0x49c)]('.at-mention-popup'),_0x494cd9=_0x37c1e9[_0x2d4b08(0xbed)],_0x3d10a2=_0x494cd9[_0x2d4b08(0x132a)](/@([\p{L}\w]*)$/u);if(_0x3d10a2){const _0x2093aa=new Set(),_0x1bc1bb=_0x326562[_0x2d4b08(0x49c)](_0x2d4b08(0x5a2))?.['textContent'];if(_0x1bc1bb)_0x2093aa['add'](_0x1bc1bb);_0x326562[_0x2d4b08(0x233)](_0x2d4b08(0xd57))[_0x2d4b08(0x103)](_0x429d2d=>{const _0x350b76=_0x2d4b08;_0x2093aa[_0x350b76(0xdda)](_0x429d2d[_0x350b76(0xee5)][_0x350b76(0x137f)](':',''));}),_0x2093aa[_0x2d4b08(0x3aa)](_0x3e7a1b[_0x2d4b08(0x3c2)][_0x2d4b08(0x78c)]),_0x5d717f['innerHTML']='';if(_0x2093aa[_0x2d4b08(0x9dd)]>0x0){const _0xe6ed69=_0x3d10a2[0x1];_0x2093aa[_0x2d4b08(0x103)](_0x449189=>{const _0x493791=_0x2d4b08;if(_0x449189[_0x493791(0x36d)]()['includes'](_0xe6ed69[_0x493791(0x36d)]())){const _0x11216c=document['createElement'](_0x493791(0x479));_0x11216c[_0x493791(0x87d)]=_0x493791(0x9ff),_0x11216c[_0x493791(0xee5)]=_0x449189,_0x11216c[_0x493791(0xf72)]('mousedown',_0x57a95c=>{const _0x377325=_0x493791;_0x57a95c['preventDefault']();const _0x2747ba=_0x494cd9[_0x377325(0x126f)](0x0,_0x3d10a2[_0x377325(0xf84)])+('@'+_0x449189+'\x20');_0x37c1e9[_0x377325(0xbed)]=_0x2747ba,_0x5d717f['style'][_0x377325(0x130)]=_0x377325(0x1209),_0x37c1e9[_0x377325(0x1218)]();}),_0x5d717f[_0x493791(0x99e)](_0x11216c);}}),_0x5d717f[_0x2d4b08(0x731)]['display']=_0x5d717f[_0x2d4b08(0x507)][_0x2d4b08(0x40f)]>0x0?_0x2d4b08(0xb37):'none';}else _0x5d717f[_0x2d4b08(0x731)][_0x2d4b08(0x130)]=_0x2d4b08(0x1209);}else _0x5d717f['style'][_0x2d4b08(0x130)]='none';}),document[_0x412b05(0x64f)](_0x412b05(0x108b))[_0x412b05(0xf72)](_0x412b05(0x49d),_0x26bc0b=>{const _0x2e6d10=_0x412b05;if(_0x26bc0b[_0x2e6d10(0xf5b)][_0x2e6d10(0xf3e)](_0x2e6d10(0x272))){const _0x2aaa8b=_0x26bc0b[_0x2e6d10(0xf5b)][_0x2e6d10(0x2fc)](_0x2e6d10(0x1071));if(_0x2aaa8b){const _0x384032=_0x2aaa8b['querySelector'](_0x2e6d10(0x696));_0x384032&&setTimeout(()=>{const _0x2f8028=_0x2e6d10;_0x384032[_0x2f8028(0x731)]['display']=_0x2f8028(0x1209);},0xc8);}}});const _0x1200f9=document[_0x412b05(0x64f)]('chat-input'),_0x571702=document[_0x412b05(0x64f)](_0x412b05(0xc2));_0x1200f9['addEventListener'](_0x412b05(0x62b),()=>{const _0x5a01ca=_0x412b05;if(!_0x3e7a1b[_0x5a01ca(0x777)]||!_0x3e7a1b[_0x5a01ca(0x999)][_0x3e7a1b[_0x5a01ca(0x777)]]['isGroup']){_0x571702[_0x5a01ca(0x731)]['display']=_0x5a01ca(0x1209);return;}const _0x493b79=_0x3e7a1b[_0x5a01ca(0x999)][_0x3e7a1b[_0x5a01ca(0x777)]],_0x4d7b7c=_0x1200f9[_0x5a01ca(0xbed)],_0x37ed3c=_0x4d7b7c[_0x5a01ca(0x132a)](/@([\p{L}\w]*)$/u);if(_0x37ed3c){const _0x163dac=_0x493b79['settings'][_0x5a01ca(0x96f)]||'我',_0xb5e7c3=_0x493b79[_0x5a01ca(0x5d4)][_0x5a01ca(0xb96)](_0x3e6f74=>_0x3e6f74[_0x5a01ca(0x287)])['filter'](_0x45f2e8=>_0x45f2e8!==_0x163dac);_0x571702[_0x5a01ca(0xc58)]='';if(_0xb5e7c3['length']>0x0){const _0x58b733=_0x37ed3c[0x1];_0xb5e7c3[_0x5a01ca(0x103)](_0x59a139=>{const _0x2ee92e=_0x5a01ca;if(_0x59a139[_0x2ee92e(0x36d)]()[_0x2ee92e(0xe53)](_0x58b733[_0x2ee92e(0x36d)]())){const _0x4d8a2a=document[_0x2ee92e(0x124e)](_0x2ee92e(0x479));_0x4d8a2a['className']='at-mention-item',_0x4d8a2a[_0x2ee92e(0xee5)]=_0x59a139,_0x4d8a2a['addEventListener']('mousedown',_0x9dcb9e=>{const _0x58b806=_0x2ee92e;_0x9dcb9e[_0x58b806(0x8d1)]();const _0x1c192d=_0x4d7b7c[_0x58b806(0x126f)](0x0,_0x37ed3c[_0x58b806(0xf84)])+('@'+_0x59a139+'\x20');_0x1200f9[_0x58b806(0xbed)]=_0x1c192d,_0x571702[_0x58b806(0x731)][_0x58b806(0x130)]='none',_0x1200f9['focus']();}),_0x571702[_0x2ee92e(0x99e)](_0x4d8a2a);}}),_0x571702[_0x5a01ca(0x731)][_0x5a01ca(0x130)]=_0x571702[_0x5a01ca(0x507)][_0x5a01ca(0x40f)]>0x0?'block':'none';}else _0x571702[_0x5a01ca(0x731)][_0x5a01ca(0x130)]=_0x5a01ca(0x1209);}else _0x571702[_0x5a01ca(0x731)]['display']=_0x5a01ca(0x1209);}),_0x1200f9['addEventListener']('blur',()=>{setTimeout(()=>{const _0x48019f=_0x2bd6;_0x571702['style'][_0x48019f(0x130)]=_0x48019f(0x1209);},0xc8);}),document['getElementById'](_0x412b05(0xcc6))['addEventListener'](_0x412b05(0x1080),_0x492665),document[_0x412b05(0x64f)](_0x412b05(0xdfe))['addEventListener'](_0x412b05(0x1080),_0x25d9f7),document[_0x412b05(0x64f)](_0x412b05(0xf44))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x51afe9=_0x412b05;document[_0x51afe9(0x64f)](_0x51afe9(0x1f2))[_0x51afe9(0x418)][_0x51afe9(0x1275)](_0x51afe9(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x510))[_0x412b05(0xf72)]('click',_0x41b17d=>{const _0x525ea8=_0x412b05;if(_0x41b17d[_0x525ea8(0xf5b)][_0x525ea8(0x418)]['contains'](_0x525ea8(0x902))){const _0x5d9650=_0x41b17d[_0x525ea8(0xf5b)]['dataset']['annoId'];_0x5d9650&&_0x4d2630(_0x5d9650);}}),document[_0x412b05(0x64f)](_0x412b05(0x498))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2cdbcf),document['getElementById'](_0x412b05(0xecc))[_0x412b05(0xf72)]('click',_0x170308),document['getElementById'](_0x412b05(0x94e))['addEventListener'](_0x412b05(0x1080),()=>{const _0x3fd9f8=_0x412b05;document[_0x3fd9f8(0x64f)](_0x3fd9f8(0x103b))[_0x3fd9f8(0x418)][_0x3fd9f8(0x1275)](_0x3fd9f8(0x40a));}),document[_0x412b05(0x64f)]('reset-global-css-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x4ad804=_0x412b05;document['getElementById'](_0x4ad804(0x1b6))[_0x4ad804(0xbed)]='';}),document[_0x412b05(0x64f)](_0x412b05(0x1012))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2c3c67),document[_0x412b05(0x64f)]('memory-screen-back-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5f366b=_0x412b05;_0xddd8ae(_0x5f366b(0x9aa));}),document[_0x412b05(0x64f)](_0x412b05(0x360))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x21f789),document[_0x412b05(0x64f)](_0x412b05(0x26f))[_0x412b05(0xf72)]('click',_0x186147),document[_0x412b05(0x64f)](_0x412b05(0x53f))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x475512=>{const _0x1821d7=_0x412b05,_0x158b32=_0x475512[_0x1821d7(0xf5b)]['closest']('.edit-memory-btn');if(_0x158b32){_0x44a669(_0x158b32[_0x1821d7(0x12e1)][_0x1821d7(0x1188)],parseInt(_0x158b32[_0x1821d7(0x12e1)]['memoryTimestamp']));return;}const _0x3c0bff=_0x475512['target']['closest'](_0x1821d7(0xa44));if(_0x3c0bff){_0x3b5ff8(_0x3c0bff[_0x1821d7(0x12e1)]['authorId'],parseInt(_0x3c0bff[_0x1821d7(0x12e1)][_0x1821d7(0xd86)]));return;}}),document[_0x412b05(0x64f)](_0x412b05(0x1011))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4d834e),document[_0x412b05(0x64f)](_0x412b05(0x312))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x476258);const _0xa6f1a8=document['getElementById'](_0x412b05(0x8f9));_0xa6f1a8['addEventListener']('mousemove',_0x3008d4),_0xa6f1a8['addEventListener']('mouseout',()=>_0x4d13d0(_0x3e7a1b[_0x412b05(0x777)])),_0xa6f1a8[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2cc8c6),document[_0x412b05(0x64f)](_0x412b05(0xa15))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x58581d=_0x412b05;document['getElementById']('countdown-title-input')[_0x58581d(0xbed)]='',document[_0x58581d(0x64f)]('countdown-date-input')['value']='',document[_0x58581d(0x64f)](_0x58581d(0x134d))[_0x58581d(0x418)][_0x58581d(0xdda)](_0x58581d(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x3d1))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x89775a=_0x412b05;document['getElementById'](_0x89775a(0x134d))['classList'][_0x89775a(0x1275)](_0x89775a(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x60e))['addEventListener'](_0x412b05(0x1080),_0xef7f6a),document['getElementById'](_0x412b05(0xaf1))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2e461a),document['getElementById'](_0x412b05(0xab6))[_0x412b05(0xf72)]('click',_0x39f1ef),document['getElementById'](_0x412b05(0x41b))['addEventListener']('click',_0xaa49c5),document['getElementById'](_0x412b05(0xdb7))['addEventListener'](_0x412b05(0x1080),()=>{const _0x909bcc=_0x412b05;document[_0x909bcc(0x64f)](_0x909bcc(0x316))[_0x909bcc(0x418)][_0x909bcc(0x1275)]('visible');}),document['getElementById']('save-ai-response-editor-btn')['addEventListener'](_0x412b05(0x1080),_0x137e47),document['getElementById'](_0x412b05(0x2cf))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x58f341=_0x412b05,_0x3392f8=document['getElementById'](_0x58f341(0xdf6)),_0x36c7cc=_0x4b129f(_0x58f341(0x39c));_0x3392f8['appendChild'](_0x36c7cc),_0x36c7cc[_0x58f341(0x49c)](_0x58f341(0x444))[_0x58f341(0x1218)]();}),document[_0x412b05(0x64f)](_0x412b05(0xac4))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2d4a49),document[_0x412b05(0x64f)]('close-my-avatar-library-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x41e336),document[_0x412b05(0x64f)](_0x412b05(0x285))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x588e4e),document[_0x412b05(0x64f)](_0x412b05(0x4ba))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3015ac=_0x412b05;document[_0x3015ac(0x64f)](_0x3015ac(0xc85))[_0x3015ac(0x1080)]();}),document['getElementById']('my-avatar-upload-input')[_0x412b05(0xf72)](_0x412b05(0x834),_0x3425b9),document[_0x412b05(0x64f)](_0x412b05(0x648))['addEventListener']('click',async()=>{const _0x5ec633=_0x412b05,_0x30d6d9='请按照以下格式粘贴，一行一个：\x0a\x0a焦虑\x202a9wte.jpeg\x0a大惊失色\x20or8qf4.png\x0a没有灵感\x20njwujh.jpeg',_0x1b5f2b=await _0x41e3f8(_0x5ec633(0x10ed),_0x30d6d9,'','textarea');_0x1b5f2b&&_0x1b5f2b[_0x5ec633(0x43a)]()&&await _0x1912cb(_0x1b5f2b);}),document[_0x412b05(0x64f)]('open-shopping-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3ebb10),document[_0x412b05(0x64f)]('shopping-back-btn')['addEventListener'](_0x412b05(0x1080),()=>_0xddd8ae('chat-interface-screen')),document['getElementById'](_0x412b05(0x666))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3815ca),document[_0x412b05(0x64f)](_0x412b05(0x721))[_0x412b05(0xf72)]('click',_0x3ebb10),document[_0x412b05(0x64f)](_0x412b05(0xafb))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xb6e78),document[_0x412b05(0x64f)](_0x412b05(0x95b))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x400019=_0x412b05;document[_0x400019(0x64f)](_0x400019(0x431))[_0x400019(0x418)]['remove'](_0x400019(0x40a));}),document[_0x412b05(0x64f)]('manage-products-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2e2425=_0x412b05;_0x369182=!_0x369182;const _0x4ceef1=document[_0x2e2425(0x64f)](_0x2e2425(0xa52)),_0x24b7c9=document[_0x2e2425(0x64f)](_0x2e2425(0xd62)),_0x349cb0=document[_0x2e2425(0x64f)](_0x2e2425(0x3c0));_0x4ceef1[_0x2e2425(0x731)]['color']=_0x369182?_0x2e2425(0x255):_0x2e2425(0x115),_0x369182?(_0x24b7c9[_0x2e2425(0x731)][_0x2e2425(0x130)]='flex',_0x349cb0[_0x2e2425(0x731)]['paddingBottom']=_0x2e2425(0x56a)):(_0x24b7c9[_0x2e2425(0x731)][_0x2e2425(0x130)]=_0x2e2425(0x1209),_0x349cb0['style'][_0x2e2425(0xf2b)]='',_0x352161[_0x2e2425(0x1057)](),document['querySelectorAll'](_0x2e2425(0x1094))[_0x2e2425(0x103)](_0x3c14f0=>_0x3c14f0[_0x2e2425(0x418)][_0x2e2425(0x1275)]('selected')),document[_0x2e2425(0x64f)](_0x2e2425(0xf51))['textContent']=_0x2e2425(0xb08),document['getElementById'](_0x2e2425(0xdb8))[_0x2e2425(0xf1d)]=![]),_0x515ef1(),_0x5201ec();}),document[_0x412b05(0x64f)](_0x412b05(0x1d6))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x459d2d=_0x412b05;_0x369182?_0x309cfe(null):alert(_0x459d2d(0xddf));}),document[_0x412b05(0x64f)](_0x412b05(0x3c0))[_0x412b05(0xf72)](_0x412b05(0x1080),async _0x4d5111=>{const _0x42389a=_0x412b05,_0x5c09e0=_0x4d5111[_0x42389a(0xf5b)][_0x42389a(0x2fc)](_0x42389a(0x1eb));if(!_0x5c09e0)return;const _0x88910=parseInt(_0x5c09e0[_0x42389a(0x12e1)]['id']);if(isNaN(_0x88910))return;if(_0x369182){if(_0x4d5111[_0x42389a(0xf5b)]['classList'][_0x42389a(0xef6)](_0x42389a(0xae2))){_0x309cfe(_0x88910);return;}if(_0x4d5111[_0x42389a(0xf5b)]['classList'][_0x42389a(0xef6)](_0x42389a(0x2a1))){const _0x4a1078=await _0x4e1bbf[_0x42389a(0x760)]['get'](_0x88910);if(!_0x4a1078)return;const _0x1eff28=await _0x54149f('删除商品','确定要永久删除商品\x20“'+_0x4a1078[_0x42389a(0x6fc)]+_0x42389a(0x2dc),{'confirmButtonClass':_0x42389a(0xeed)});_0x1eff28&&(await _0x4e1bbf[_0x42389a(0x760)]['delete'](_0x88910),await _0x515ef1(),alert('商品已删除。'));return;}_0x5c09e0[_0x42389a(0x418)][_0x42389a(0x5cf)](_0x42389a(0xbe6));_0x352161[_0x42389a(0x2a6)](_0x88910)?_0x352161['delete'](_0x88910):_0x352161['add'](_0x88910);document[_0x42389a(0x64f)](_0x42389a(0xf51))[_0x42389a(0xee5)]=_0x42389a(0x83c)+_0x352161[_0x42389a(0x9dd)]+')';return;}if(_0x4d5111['target'][_0x42389a(0x418)][_0x42389a(0xef6)](_0x42389a(0xdd3))){const _0x2d162a=await _0x4e1bbf[_0x42389a(0x760)][_0x42389a(0x11fc)](_0x88910);_0x2d162a['variations']&&_0x2d162a[_0x42389a(0x349)][_0x42389a(0x40f)]>0x0?_0x390e74(_0x88910):(await _0x2e14cf(_0x88910),await _0x28974b('成功',_0x42389a(0x31d)));return;}_0x5c09e0[_0x42389a(0xef6)](_0x4d5111[_0x42389a(0xf5b)])&&console[_0x42389a(0x1081)](_0x42389a(0xe9a)+_0x88910);}),document[_0x412b05(0x64f)]('cart-items-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2dd568=>{const _0x2a5b52=_0x412b05,_0x48f7bc=_0x2dd568['target'];_0x48f7bc[_0x2a5b52(0x418)][_0x2a5b52(0xef6)]('decrease-qty-btn')&&_0x833f93(parseInt(_0x48f7bc[_0x2a5b52(0x12e1)]['id']),-0x1),_0x48f7bc[_0x2a5b52(0x418)]['contains'](_0x2a5b52(0xbee))&&_0x833f93(parseInt(_0x48f7bc[_0x2a5b52(0x12e1)]['id']),0x1),_0x48f7bc[_0x2a5b52(0x418)][_0x2a5b52(0xef6)](_0x2a5b52(0xaec))&&_0x45393a();}),document[_0x412b05(0x64f)](_0x412b05(0x12af))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x51e5a6=_0x412b05;if(_0x1ac43d[_0x51e5a6(0x40f)]===0x0)return;const _0x33b82d=await _0x54149f(_0x51e5a6(0x9ac),_0x51e5a6(0x711));_0x33b82d&&(_0x1ac43d=[],_0x2b0736(),_0x3e2fbb());}),document[_0x412b05(0x64f)](_0x412b05(0xee4))['addEventListener']('change',function(_0x1bfc7d){const _0x59b904=_0x412b05;document['querySelectorAll']('.cart-item-checkbox')[_0x59b904(0x103)](_0x32969e=>{const _0x422894=_0x59b904;_0x32969e[_0x422894(0xf1d)]=_0x1bfc7d[_0x422894(0xf5b)][_0x422894(0xf1d)];}),_0x45393a();}),document['getElementById'](_0x412b05(0x11bf))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x557e1f=_0x412b05;document['getElementById'](_0x557e1f(0x94c))[_0x557e1f(0x418)]['remove'](_0x557e1f(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0xe7a))['addEventListener']('click',_0x3f95c0),document[_0x412b05(0x64f)]('product-image-input')[_0x412b05(0xf72)](_0x412b05(0x834),_0x3a60cf=>{const _0x30ff83=_0x412b05,_0x2c965d=_0x3a60cf[_0x30ff83(0xf5b)][_0x30ff83(0x91e)][0x0];if(_0x2c965d){const _0x3f08b9=new FileReader();_0x3f08b9[_0x30ff83(0x139d)]=_0x1fc60c=>{const _0x223522=_0x30ff83;document[_0x223522(0x64f)](_0x223522(0x7b6))[_0x223522(0xbe8)]=_0x1fc60c[_0x223522(0xf5b)]['result'];},_0x3f08b9[_0x30ff83(0xb4)](_0x2c965d);}}),document[_0x412b05(0x64f)]('chat-messages')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x54de2b=>{const _0x501b04=_0x412b05,_0x18cf4e=_0x54de2b[_0x501b04(0xf5b)]['closest'](_0x501b04(0x111b));if(_0x18cf4e){const _0x371eff=_0x18cf4e[_0x501b04(0x2fc)](_0x501b04(0x114f));_0x371eff&&_0x5c9470(parseInt(_0x371eff[_0x501b04(0x12e1)][_0x501b04(0x8af)]));}}),document[_0x412b05(0x64f)](_0x412b05(0x910))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x1da1ad=_0x412b05;document[_0x1da1ad(0x64f)](_0x1da1ad(0x10a8))[_0x1da1ad(0x418)][_0x1da1ad(0x1275)](_0x1da1ad(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x500))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x2dc770=_0x412b05,_0x2bf7f7=Array[_0x2dc770(0xb3a)](document[_0x2dc770(0x233)](_0x2dc770(0x80c)))['map'](_0x5583d2=>_0x5583d2[_0x2dc770(0x12e1)][_0x2dc770(0xce7)]);if(_0x2bf7f7[_0x2dc770(0x40f)]===0x0){alert(_0x2dc770(0xc25));return;}const _0x78d779=_0x1ac43d[_0x2dc770(0x156)](_0x3f7283=>document[_0x2dc770(0x49c)]('.cart-item-checkbox[data-id=\x22'+_0x3f7283['productId']+'\x22]:checked'));await _0x38d949(_0x78d779,_0x2bf7f7),document[_0x2dc770(0x64f)](_0x2dc770(0x10a8))[_0x2dc770(0x418)][_0x2dc770(0x1275)](_0x2dc770(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x39f))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x185c96=>{const _0x8b25d8=_0x412b05,_0xb6388f=_0x185c96[_0x8b25d8(0xf5b)][_0x8b25d8(0x2fc)](_0x8b25d8(0x139));_0xb6388f&&_0xb6388f['classList'][_0x8b25d8(0x5cf)](_0x8b25d8(0xbe6));}),document[_0x412b05(0x64f)](_0x412b05(0x330))[_0x412b05(0xf72)](_0x412b05(0x834),function(_0x22d31d){const _0x4f0196=_0x412b05,_0x23330d=_0x22d31d[_0x4f0196(0xf5b)][_0x4f0196(0xf1d)];document['querySelectorAll'](_0x4f0196(0x2b6))[_0x4f0196(0x103)](_0x32c996=>{const _0x150c2d=_0x4f0196;_0x32c996[_0x150c2d(0x418)][_0x150c2d(0x5cf)](_0x150c2d(0xbe6),_0x23330d);});}),document[_0x412b05(0x64f)](_0x412b05(0xd21))[_0x412b05(0xf72)]('click',_0x3fb80a),document[_0x412b05(0x64f)]('regenerate-call-btn')[_0x412b05(0xf72)]('click',_0x532436),document['getElementById'](_0x412b05(0xaca))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2a53bc),document[_0x412b05(0x64f)](_0x412b05(0xb9b))[_0x412b05(0xf72)]('click',()=>{const _0x51b0c2=_0x412b05,_0x42a61b=document[_0x51b0c2(0x64f)](_0x51b0c2(0xc4a)),_0x5d9b27=document[_0x51b0c2(0x64f)](_0x51b0c2(0x128a))[_0x51b0c2(0xbed)]['trim']()||_0x294cf9;_0x42a61b[_0x51b0c2(0xbe8)]=_0x5d9b27,_0x42a61b['play']()['catch'](_0x1bd136=>alert('播放失败，请检查URL是否正确或浏览器是否支持该格式。'));}),document[_0x412b05(0x64f)](_0x412b05(0x371))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5efba7=_0x412b05;document['getElementById'](_0x5efba7(0x128a))['value']='',alert('已重置为默认提示音，点击“保存所有外观设置”后生效。');}),document[_0x412b05(0x64f)](_0x412b05(0xd89))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x21ec13=>{const _0x86df13=_0x412b05,_0x2407e=_0x21ec13[_0x86df13(0xf5b)];_0x2407e[_0x86df13(0x418)][_0x86df13(0xef6)](_0x86df13(0x109c))&&_0x141062(_0x2407e),_0x2407e[_0x86df13(0x418)]['contains'](_0x86df13(0x4dd))&&_0x145e8e(_0x2407e);}),document[_0x412b05(0x64f)](_0x412b05(0x904))['addEventListener'](_0x412b05(0x1080),_0x43ea06),document[_0x412b05(0x64f)](_0x412b05(0x44c))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x49b901=_0x412b05;document[_0x49b901(0x64f)](_0x49b901(0x896))[_0x49b901(0x418)][_0x49b901(0x1275)](_0x49b901(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x904))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x43ea06),document['getElementById']('cancel-music-search-btn')['addEventListener']('click',()=>{const _0x2b1c2c=_0x412b05;document[_0x2b1c2c(0x64f)](_0x2b1c2c(0x896))[_0x2b1c2c(0x418)][_0x2b1c2c(0x1275)](_0x2b1c2c(0x40a));}),document[_0x412b05(0x64f)]('select-all-music-search')[_0x412b05(0xf72)](_0x412b05(0x834),function(_0x54abf4){const _0x175319=_0x412b05;document[_0x175319(0x233)](_0x175319(0xbdc))[_0x175319(0x103)](_0x1770cc=>{const _0x3198c6=_0x175319;_0x1770cc[_0x3198c6(0xf1d)]=_0x54abf4[_0x3198c6(0xf5b)]['checked'];});}),document['getElementById'](_0x412b05(0x11b2))[_0x412b05(0xf72)]('click',_0x5527ef=>{const _0xffb14e=_0x412b05,_0x365cfe=_0x5527ef[_0xffb14e(0xf5b)][_0xffb14e(0x2fc)](_0xffb14e(0x6a3));if(_0x365cfe){const _0x33b0db=_0x365cfe[_0xffb14e(0x49c)](_0xffb14e(0x1006));_0x33b0db&&(_0x5527ef['target']!==_0x33b0db&&(_0x33b0db['checked']=!_0x33b0db[_0xffb14e(0xf1d)]));}}),document[_0x412b05(0x64f)](_0x412b05(0x1d1))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x1ab3d4=_0x412b05,_0x4a35b0=document[_0x1ab3d4(0x233)](_0x1ab3d4(0xad0));if(_0x4a35b0[_0x1ab3d4(0x40f)]===0x0){alert(_0x1ab3d4(0x99));return;}document[_0x1ab3d4(0x64f)](_0x1ab3d4(0x896))['classList']['remove']('visible'),await _0x28974b(_0x1ab3d4(0x2f7),_0x1ab3d4(0x76a)+_0x4a35b0[_0x1ab3d4(0x40f)]+_0x1ab3d4(0xb8e));const _0x54af89=Array[_0x1ab3d4(0xb3a)](_0x4a35b0)[_0x1ab3d4(0xb96)](_0x8dc76c=>JSON[_0x1ab3d4(0x1214)](_0x8dc76c[_0x1ab3d4(0x2fc)](_0x1ab3d4(0x6a3))['dataset'][_0x1ab3d4(0x898)]));let _0x4fec61=0x0,_0x4e6d45=[];const _0x3521bb=_0x54af89[_0x1ab3d4(0xb96)](_0x56fbfa=>_0x24fad6(_0x56fbfa)),_0x42c3b7=await Promise['all'](_0x3521bb);_0x42c3b7[_0x1ab3d4(0x103)]((_0x4db322,_0x5b11bc)=>{const _0x3cf6b0=_0x1ab3d4;_0x4db322?(_0x1c083c['playlist'][_0x3cf6b0(0x13ee)](_0x4db322),_0x4fec61++):_0x4e6d45[_0x3cf6b0(0x13ee)](_0x54af89[_0x5b11bc][_0x3cf6b0(0x6fc)]);});_0x4fec61>0x0&&(await _0x16961a(),_0x36d83c(),_0x1c083c['currentIndex']===-0x1&&(_0x1c083c['currentIndex']=_0x1c083c[_0x1ab3d4(0x11ce)][_0x1ab3d4(0x40f)]-_0x4fec61,_0x320333()));let _0x2ee12b=_0x1ab3d4(0xdf2)+_0x4fec61+_0x1ab3d4(0x2f0);_0x4e6d45[_0x1ab3d4(0x40f)]>0x0&&(_0x2ee12b+='\x0a\x0a'+_0x4e6d45[_0x1ab3d4(0x40f)]+_0x1ab3d4(0x37a)+_0x4e6d45['join']('\x0a-\x20')),await _0x28974b(_0x1ab3d4(0x1203),_0x2ee12b);}),document[_0x412b05(0x64f)]('music-visual-container')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2cb217=_0x412b05;document['getElementById'](_0x2cb217(0xc80))[_0x2cb217(0x418)][_0x2cb217(0x5cf)](_0x2cb217(0x7ab));}),document[_0x412b05(0x64f)](_0x412b05(0x904))['addEventListener'](_0x412b05(0x1080),_0x43ea06),document[_0x412b05(0x64f)](_0x412b05(0x44c))[_0x412b05(0xf72)]('click',()=>{const _0x39655c=_0x412b05;document[_0x39655c(0x64f)](_0x39655c(0x896))[_0x39655c(0x418)]['remove'](_0x39655c(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x11b2))[_0x412b05(0xf72)]('click',_0x1dc54a=>{const _0x5bf91a=_0x412b05,_0x122051=_0x1dc54a[_0x5bf91a(0xf5b)][_0x5bf91a(0x2fc)](_0x5bf91a(0x6a3));if(_0x122051&&_0x122051[_0x5bf91a(0x12e1)][_0x5bf91a(0x898)]){const _0x212931=JSON[_0x5bf91a(0x1214)](_0x122051['dataset'][_0x5bf91a(0x898)]);handleSearchResultClick(_0x212931);}}),document[_0x412b05(0x64f)]('cleanup-songs-btn')['addEventListener']('click',_0x1a37ab),document[_0x412b05(0x64f)](_0x412b05(0x1387))['addEventListener'](_0x412b05(0x1080),_0x4c9730),document[_0x412b05(0x64f)](_0x412b05(0x1019))['addEventListener'](_0x412b05(0x1080),_0x3c5735),document['getElementById'](_0x412b05(0x85e))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x50d454),document['getElementById'](_0x412b05(0x46e))[_0x412b05(0xf72)](_0x412b05(0x834),()=>{const _0xcc6832=_0x412b05;_0x3e7a1b[_0xcc6832(0x11b4)][_0xcc6832(0x390)]=document[_0xcc6832(0x64f)](_0xcc6832(0x46e))[_0xcc6832(0xf1d)],_0x4e3634();}),document[_0x412b05(0x64f)](_0x412b05(0x12f8))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x33f749),document[_0x412b05(0x64f)](_0x412b05(0x17a))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x49489a=_0x412b05;document[_0x49489a(0x64f)](_0x49489a(0x6ea))[_0x49489a(0x418)]['remove'](_0x49489a(0x40a));}),document['getElementById'](_0x412b05(0xc38))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x19af58),document[_0x412b05(0x64f)](_0x412b05(0x391))[_0x412b05(0xf72)]('click',_0x507230=>{const _0x348a5f=_0x412b05,_0xf343b9=_0x507230[_0x348a5f(0xf5b)][_0x348a5f(0x2fc)](_0x348a5f(0x8a3));_0xf343b9&&_0xf343b9[_0x348a5f(0x418)]['toggle'](_0x348a5f(0xbe6));}),document[_0x412b05(0x64f)](_0x412b05(0x9d))['addEventListener'](_0x412b05(0x834),async _0x4b6452=>{const _0x45fb40=_0x412b05,_0x31f7a9=_0x4b6452['target'][_0x45fb40(0x91e)][0x0];if(_0x31f7a9){const _0x31b4f2=await new Promise(_0x2af5c6=>{const _0x3570ef=_0x45fb40,_0x35e747=new FileReader();_0x35e747[_0x3570ef(0x139d)]=()=>_0x2af5c6(_0x35e747[_0x3570ef(0x8f)]),_0x35e747[_0x3570ef(0xb4)](_0x31f7a9);});_0x3e7a1b[_0x45fb40(0x11b4)][_0x45fb40(0xcb4)]=_0x31b4f2,_0x309ef1();}_0x4b6452[_0x45fb40(0xf5b)][_0x45fb40(0xbed)]=null;}),document[_0x412b05(0x64f)](_0x412b05(0x12ad))['addEventListener'](_0x412b05(0x1080),()=>{const _0x400b2d=_0x412b05;_0x3e7a1b[_0x400b2d(0x11b4)][_0x400b2d(0xcb4)]='',_0x309ef1();}),document[_0x412b05(0x64f)]('save-wallpaper-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x52b6eb=_0x412b05;_0x1ebe35&&(_0x3e7a1b[_0x52b6eb(0x11b4)][_0x52b6eb(0x6fe)]=_0x1ebe35),_0x3e7a1b[_0x52b6eb(0x11b4)][_0x52b6eb(0xedb)]=document[_0x52b6eb(0x64f)]('global-css-input')[_0x52b6eb(0xbed)][_0x52b6eb(0x43a)](),_0x3e7a1b[_0x52b6eb(0x11b4)][_0x52b6eb(0xe5f)]=document[_0x52b6eb(0x64f)](_0x52b6eb(0x128a))[_0x52b6eb(0xbed)][_0x52b6eb(0x43a)](),_0x3e7a1b[_0x52b6eb(0x11b4)][_0x52b6eb(0x390)]=document[_0x52b6eb(0x64f)](_0x52b6eb(0x46e))['checked'],await _0x4e1bbf[_0x52b6eb(0x11b4)][_0x52b6eb(0x4fa)](_0x3e7a1b[_0x52b6eb(0x11b4)]),_0x11d2f9(),_0x1ebe35=null,_0x5dc542(),_0x39cff1(_0x3e7a1b['globalSettings'][_0x52b6eb(0xedb)]),_0x4e3634(),alert(_0x52b6eb(0x1385)),_0xddd8ae(_0x52b6eb(0xd89));}),document[_0x412b05(0x64f)](_0x412b05(0x1ae))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x478580=_0x412b05,_0xea741=await _0x41e3f8(_0x478580(0xe8e),_0x478580(0x7dd),'',_0x478580(0xe52));if(_0xea741&&_0xea741[_0x478580(0x43a)]())_0x3e7a1b[_0x478580(0x11b4)][_0x478580(0xcb4)]=_0xea741[_0x478580(0x43a)](),_0x309ef1();else _0xea741!==null&&alert(_0x478580(0x12d3));}),document[_0x412b05(0x64f)]('upload-ephone-bg-url-btn')['addEventListener'](_0x412b05(0x1080),async()=>{const _0x48bff2=_0x412b05,_0x539107=await _0x41e3f8(_0x48bff2(0x8ec),_0x48bff2(0xe20),'',_0x48bff2(0xe52));if(_0x539107&&_0x539107[_0x48bff2(0x43a)]())_0x1ebe35=_0x539107['trim'](),_0x309ef1();else _0x539107!==null&&alert(_0x48bff2(0x12d3));}),document['getElementById'](_0x412b05(0xb8b))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x316db5=_0x412b05,_0x5b7df6=await _0x41e3f8(_0x316db5(0x11fd),_0x316db5(0xa36),'','url');if(_0x5b7df6&&_0x5b7df6['trim']())_0x3e7a1b['globalSettings'][_0x316db5(0xcbc)]=_0x5b7df6['trim'](),_0x309ef1();else _0x5b7df6!==null&&alert(_0x316db5(0x12d3));}),document[_0x412b05(0x64f)]('remove-ephone-bg-btn')['addEventListener']('click',()=>{const _0x23a9a6=_0x412b05;_0x1ebe35=null,_0x3e7a1b[_0x23a9a6(0x11b4)]['wallpaper']='',_0x309ef1();}),document[_0x412b05(0x64f)](_0x412b05(0x264))['addEventListener'](_0x412b05(0x1080),()=>{const _0x46b327=_0x412b05;_0x3e7a1b[_0x46b327(0x11b4)]['cphoneWallpaper']='',_0x309ef1();}),document[_0x412b05(0x64f)]('css-preset-select')[_0x412b05(0xf72)](_0x412b05(0x834),_0x22b9f2),document[_0x412b05(0x64f)](_0x412b05(0x12cb))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xb60f61),document[_0x412b05(0x64f)](_0x412b05(0x123d))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x13a8ca),document['getElementById'](_0x412b05(0x1d5))[_0x412b05(0xf72)](_0x412b05(0x834),_0x3b28d9),document[_0x412b05(0x64f)](_0x412b05(0xfbd))[_0x412b05(0xf72)]('click',_0x32da0b),document[_0x412b05(0x64f)]('delete-font-preset-btn')[_0x412b05(0xf72)]('click',_0x1fe802),document[_0x412b05(0x64f)](_0x412b05(0x326))[_0x412b05(0xf72)](_0x412b05(0x834),_0x222103),document[_0x412b05(0x64f)](_0x412b05(0x846))['addEventListener'](_0x412b05(0x1080),_0x2ce3ab),document[_0x412b05(0x64f)]('delete-theme-preset-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3d0697),document[_0x412b05(0x64f)](_0x412b05(0xf2e))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x33e846),document[_0x412b05(0x64f)]('close-sticker-category-manager-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0xb1c221=_0x412b05;document[_0xb1c221(0x64f)]('sticker-category-manager-modal')[_0xb1c221(0x418)][_0xb1c221(0x1275)]('visible'),_0x8ea9d0();}),document['getElementById'](_0x412b05(0x98b))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x6753ea),document[_0x412b05(0x64f)]('existing-sticker-categories-list')['addEventListener'](_0x412b05(0x1080),_0x2b241a=>{const _0x19ef4c=_0x412b05;if(_0x2b241a[_0x19ef4c(0xf5b)][_0x19ef4c(0x418)]['contains'](_0x19ef4c(0xfb1))){const _0xc802a5=parseInt(_0x2b241a[_0x19ef4c(0xf5b)][_0x19ef4c(0x12e1)]['id']);_0x1410bb(_0xc802a5);}}),document[_0x412b05(0x64f)](_0x412b05(0x1013))['addEventListener'](_0x412b05(0x1080),_0x19c07a=>{const _0x523eb0=_0x412b05;if(_0x19c07a[_0x523eb0(0xf5b)]['classList'][_0x523eb0(0xef6)](_0x523eb0(0x10c8))){const _0x2f4152=_0x19c07a[_0x523eb0(0xf5b)][_0x523eb0(0x12e1)][_0x523eb0(0xcd3)],_0x2eb2f7=_0x2f4152!==_0x523eb0(0xfd7)&&_0x2f4152!==_0x523eb0(0xf60)?parseInt(_0x2f4152):_0x2f4152;_0x3defe2(_0x2eb2f7);}}),document[_0x412b05(0x64f)]('select-all-stickers-checkbox')[_0x412b05(0xf72)](_0x412b05(0x834),_0x46631d),document['getElementById'](_0x412b05(0x77f))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1ad24e),document[_0x412b05(0x64f)](_0x412b05(0xa8))['addEventListener'](_0x412b05(0x1080),()=>{const _0x11f9ad=_0x412b05;document['getElementById'](_0x11f9ad(0x511))[_0x11f9ad(0x1080)]();}),document[_0x412b05(0x64f)](_0x412b05(0x511))[_0x412b05(0xf72)](_0x412b05(0x834),_0x676da6=>{const _0x17fac6=_0x412b05,_0x5766c8=_0x676da6[_0x17fac6(0xf5b)]['files'][0x0];_0x5766c8&&_0x2ad236(_0x5766c8),_0x676da6[_0x17fac6(0xf5b)][_0x17fac6(0xbed)]=null;}),document[_0x412b05(0x64f)](_0x412b05(0x7cb))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x5668c6()),document[_0x412b05(0x64f)](_0x412b05(0x715))[_0x412b05(0xf72)]('click',()=>openDiaryEditor()),document['getElementById']('favorite-diary-btn')['addEventListener'](_0x412b05(0x1080),_0x4b56ba),document[_0x412b05(0x64f)](_0x412b05(0xcfb))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4c8f46),document['getElementById'](_0x412b05(0x2b2))[_0x412b05(0xf72)]('click',_0x30eb37),document[_0x412b05(0x64f)](_0x412b05(0x10d0))['addEventListener'](_0x412b05(0x1080),async()=>{const _0x77eaad=_0x412b05;_0x28974b(_0x77eaad(0xc02),'正在生成新的模拟聊天记录，并同时让角色思考如何与你继续对话...');try{await Promise['all']([_0x2103cb(),_0x3d91c8()]),console['log'](_0x77eaad(0x70f));}catch(_0x2d8c13){console['error'](_0x77eaad(0x3b3),_0x2d8c13),await _0x28974b(_0x77eaad(0x5b1),_0x77eaad(0xe41)+_0x2d8c13['message']);}}),document[_0x412b05(0x64f)]('char-chat-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4037ea=>{const _0x4eb1f0=_0x412b05,_0x3996fa=_0x4037ea[_0x4eb1f0(0xf5b)][_0x4eb1f0(0x2fc)]('.chat-list-item');if(_0x3996fa&&_0x3996fa[_0x4eb1f0(0x12e1)][_0x4eb1f0(0xa83)]){const _0x34f765=parseInt(_0x3996fa['dataset'][_0x4eb1f0(0xa83)]);!isNaN(_0x34f765)&&_0x2d6914(_0x34f765);}}),document[_0x412b05(0x64f)](_0x412b05(0xf40))['addEventListener'](_0x412b05(0x1080),()=>{_0xdfc697('char-qq-screen');});const _0x38077d=document[_0x412b05(0x64f)]('char-conversation-messages'),_0x40cead=()=>{const _0x3b93b0=_0x412b05;if(_0x3b731f!==_0x3b93b0(0x744))return;if(_0x38077d['scrollTop']<0x1&&!_0x302616){const _0x3c7367=_0x3e7a1b['chats'][_0x10ae3d]?.[_0x3b93b0(0x830)][_0x3b93b0(0x40f)]||0x0;_0x3c7367>_0x257fa1&&_0x5a25b3();}};_0x38077d[_0x412b05(0xf72)](_0x412b05(0x11e0),_0x40cead),document[_0x412b05(0x64f)](_0x412b05(0xa7a))['addEventListener'](_0x412b05(0x1080),()=>{const _0x284be2=_0x412b05;alert(_0x284be2(0x218));}),document[_0x412b05(0x64f)]('regenerate-char-album-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x172c8c),document[_0x412b05(0x64f)](_0x412b05(0xb66))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xdde4a8=>{const _0xeeb9bf=_0x412b05,_0x3bd7ab=_0xdde4a8[_0xeeb9bf(0xf5b)]['closest']('.char-photo-item');if(_0x3bd7ab&&_0x3bd7ab['dataset'][_0xeeb9bf(0x9af)]){const _0x54345f=_0x3bd7ab[_0xeeb9bf(0x12e1)][_0xeeb9bf(0x9af)];_0x28974b('照片详情',_0x54345f[_0xeeb9bf(0x137f)](/\n/g,_0xeeb9bf(0x917)));}}),document[_0x412b05(0x64f)](_0x412b05(0x3f4))[_0x412b05(0xf72)]('click',_0x551f53),document[_0x412b05(0x64f)](_0x412b05(0xe44))['addEventListener'](_0x412b05(0x1080),_0x1c0173),document[_0x412b05(0x64f)](_0x412b05(0xa4e))['addEventListener'](_0x412b05(0x1080),_0x431121=>{const _0x18e1c2=_0x412b05,_0x215848=_0x431121[_0x18e1c2(0xf5b)][_0x18e1c2(0x2fc)](_0x18e1c2(0x1bb));if(_0x215848&&_0x215848[_0x18e1c2(0x12e1)]['reason']){const _0x2cc488=_0x215848['dataset'][_0x18e1c2(0x35a)];_0x28974b(_0x18e1c2(0x3e8),_0x2cc488[_0x18e1c2(0x137f)](/\n/g,_0x18e1c2(0x917)));}}),window[_0x412b05(0xaa7)]=_0xe6af39,document['getElementById'](_0x412b05(0x11ef))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x55ca61),document[_0x412b05(0x64f)]('char-memo-detail-back-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0xdfc697(_0x412b05(0x13e3))),document[_0x412b05(0x64f)](_0x412b05(0x136))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x499be8),document[_0x412b05(0x64f)](_0x412b05(0x715))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x19fde0),document[_0x412b05(0x64f)](_0x412b05(0x6b4))['addEventListener'](_0x412b05(0x1080),()=>_0xdfc697(_0x412b05(0xab1))),document[_0x412b05(0x64f)]('regenerate-char-amap-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4f52c4),document['getElementById'](_0x412b05(0x12b5))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1fd3d2),document[_0x412b05(0x64f)](_0x412b05(0x505))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x50a62c),document[_0x412b05(0x64f)](_0x412b05(0x10b7))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xf0f9f3),document[_0x412b05(0x64f)](_0x412b05(0xcb0))['addEventListener'](_0x412b05(0x1080),_0x2995c5),document[_0x412b05(0x64f)](_0x412b05(0xcb0))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2995c5),document[_0x412b05(0x64f)]('douban-detail-back-btn')[_0x412b05(0xf72)]('click',()=>_0xddd8ae(_0x412b05(0x4c1))),document[_0x412b05(0x64f)](_0x412b05(0x1292))[_0x412b05(0xf72)]('click',_0x44ab68),document[_0x412b05(0x64f)](_0x412b05(0x494))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x218bb1),document[_0x412b05(0x64f)](_0x412b05(0x139e))[_0x412b05(0xf72)](_0x412b05(0x834),async _0xb0ada8=>{const _0x7ebd59=_0x412b05,_0x3773cf=_0xb0ada8['target'][_0x7ebd59(0x91e)][0x0];if(_0x3773cf){const _0x2facf4=await new Promise(_0x46c853=>{const _0x4b1dc1=_0x7ebd59,_0x474880=new FileReader();_0x474880[_0x4b1dc1(0x139d)]=()=>_0x46c853(_0x474880[_0x4b1dc1(0x8f)]),_0x474880[_0x4b1dc1(0xb4)](_0x3773cf);});_0x3e7a1b[_0x7ebd59(0x11b4)]['cphoneWallpaper']=_0x2facf4,_0x309ef1();}}),document[_0x412b05(0x64f)](_0x412b05(0x93a))['addEventListener'](_0x412b05(0x1080),_0xb24d=>{const _0x1530f2=_0x412b05;if(_0xb24d[_0x1530f2(0xf5b)][_0x1530f2(0x418)][_0x1530f2(0xef6)](_0x1530f2(0xb7d))){const _0x360409=_0xb24d['target'][_0x1530f2(0x2fc)](_0x1530f2(0x110d)),_0x263832=_0x360409['dataset'][_0x1530f2(0x221)];_0x263832&&_0x18388a(_0x263832,_0x1530f2(0x658),_0x360409);}}),document[_0x412b05(0x64f)](_0x412b05(0x8a1))[_0x412b05(0xf72)]('click',()=>{const _0x5e091d=_0x412b05;document[_0x5e091d(0x64f)](_0x5e091d(0xa84))[_0x5e091d(0x1080)]();}),document[_0x412b05(0x64f)]('import-appearance-input')[_0x412b05(0xf72)](_0x412b05(0x834),_0x1955ba=>{const _0xc7fb2d=_0x412b05,_0x511347=_0x1955ba[_0xc7fb2d(0xf5b)][_0xc7fb2d(0x91e)][0x0];_0x511347&&_0x34cf37(_0x511347),_0x1955ba[_0xc7fb2d(0xf5b)]['value']=null;}),document[_0x412b05(0xf72)](_0x412b05(0x116b),()=>{const _0x4d3e62=_0x412b05;document[_0x4d3e62(0x127d)]===_0x4d3e62(0xb7a)&&(localStorage[_0x4d3e62(0xd39)](_0x4d3e62(0x700),Date['now']()),console[_0x4d3e62(0x1081)](_0x4d3e62(0x1234)));}),document['getElementById'](_0x412b05(0xb58))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2e0b82),document[_0x412b05(0x64f)]('import-world-book-btn')[_0x412b05(0xf72)]('click',()=>{const _0x2caca5=_0x412b05;document['getElementById'](_0x2caca5(0xa93))['click']();}),document[_0x412b05(0x64f)]('import-world-book-input')['addEventListener'](_0x412b05(0x834),_0x5b16ae=>{const _0x5802cf=_0x412b05,_0x36b89d=_0x5b16ae[_0x5802cf(0xf5b)][_0x5802cf(0x91e)][0x0];_0x36b89d&&_0x2a4d45(_0x36b89d),_0x5b16ae[_0x5802cf(0xf5b)][_0x5802cf(0xbed)]=null;}),document[_0x412b05(0x64f)](_0x412b05(0x9b2))[_0x412b05(0xf72)](_0x412b05(0x834),async _0x190764=>{const _0x1027bb=_0x412b05,_0x572895=_0x190764[_0x1027bb(0xf5b)][_0x1027bb(0xf1d)];_0x3e7a1b[_0x1027bb(0x11b4)][_0x1027bb(0xc83)]=_0x572895,await _0x4e1bbf['globalSettings']['put'](_0x3e7a1b[_0x1027bb(0x11b4)]);const _0x2162b4=document[_0x1027bb(0x49c)](_0x1027bb(0xbc));if(_0x2162b4)switch(_0x2162b4['id']){case _0x1027bb(0x9aa):_0x4817d1(_0x3e7a1b[_0x1027bb(0x777)]);break;case _0x1027bb(0xbb6):if(document[_0x1027bb(0x64f)](_0x1027bb(0x3dd))[_0x1027bb(0x418)][_0x1027bb(0xef6)]('active'))_0x40e6dd();if(document[_0x1027bb(0x64f)](_0x1027bb(0xc15))[_0x1027bb(0x418)][_0x1027bb(0xef6)](_0x1027bb(0x12ef)))_0x2ff98d();break;case _0x1027bb(0x4c1):_0x32b817();break;case _0x1027bb(0x1180):_0x51ed67(_0x169b3f);break;case _0x1027bb(0xed5):const _0x3dd224=document[_0x1027bb(0x49c)]('.char-screen.active');if(_0x3dd224)switch(_0x3dd224['id']){case'char-album-screen':_0x314a4a();break;case'char-taobao-screen':_0x59a86c();break;case'char-browser-article-screen':const _0x280754=_0x3e7a1b[_0x1027bb(0x999)][_0x10ae3d],_0x3f2979=_0x280754[_0x1027bb(0x1064)]||[],_0x300d30=_0x3f2979[_0x1027bb(0x40f)]>0x0?_0x3f2979['length']-0x1:0x0;_0x466c7d(_0x3f2979[_0x300d30]);break;case _0x1027bb(0x1193):_0x1fab74();break;case _0x1027bb(0x118d):_0x4cdae1();break;case _0x1027bb(0x20d):const _0x268f31=document['querySelector'](_0x1027bb(0x120e))?.[_0x1027bb(0x12e1)]['conversationIndex']||0x0;_0x2d6914(parseInt(_0x268f31));break;}break;}_0x28974b(_0x1027bb(0xa0d),'AI生图功能已'+(_0x572895?'开启':'关闭')+'。');}),document[_0x412b05(0x64f)](_0x412b05(0xb0c))['addEventListener']('click',_0x46b53d),document['getElementById']('search-history-back-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x235c61=_0x412b05;_0xddd8ae(_0x235c61(0x30b));}),document[_0x412b05(0x64f)]('execute-search-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3ec414),document[_0x412b05(0x64f)](_0x412b05(0x8b8))['addEventListener'](_0x412b05(0x1080),_0x368dca),document[_0x412b05(0x64f)](_0x412b05(0xb9a))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x350817),document[_0x412b05(0x64f)](_0x412b05(0xfc4))['addEventListener'](_0x412b05(0x1080),_0x5b178d),document[_0x412b05(0x49c)]('#avatar-frame-modal\x20.modal-body')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x33a945=>{const _0x1a1dc8=_0x412b05;if(_0x33a945[_0x1a1dc8(0xf5b)][_0x1a1dc8(0x418)][_0x1a1dc8(0xef6)](_0x1a1dc8(0xb41))){const _0xdd59bc=parseInt(_0x33a945[_0x1a1dc8(0xf5b)][_0x1a1dc8(0x12e1)]['id']);!isNaN(_0xdd59bc)&&_0x3c486f(_0xdd59bc);}}),_0x5a876e(),window[_0x412b05(0x71c)]=_0x3640c3,document['getElementById']('add-preset-btn')['addEventListener'](_0x412b05(0x1080),async()=>{const _0x3579ca=_0x412b05,_0x423c2d=await _0x41e3f8(_0x3579ca(0x6e),_0x3579ca(0x58a));if(_0x423c2d&&_0x423c2d[_0x3579ca(0x43a)]()){const _0x844aaa={'id':_0x3579ca(0xbf8)+Date['now'](),'name':_0x423c2d['trim'](),'content':[]};await _0x4e1bbf[_0x3579ca(0x19c)]['add'](_0x844aaa),await _0x1b0f29(),_0x268b3e(_0x844aaa['id']);}}),document['getElementById']('manage-preset-categories-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x28d0bc),document[_0x412b05(0x64f)]('add-preset-entry-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x1bb90d=_0x412b05,_0x467d7b=document[_0x1bb90d(0x64f)](_0x1bb90d(0xe2));_0x467d7b[_0x1bb90d(0x49c)]('p')&&(_0x467d7b[_0x1bb90d(0xc58)]='');const _0x1d78b0=_0x557bc5();_0x467d7b[_0x1bb90d(0x99e)](_0x1d78b0),_0x1d78b0['querySelector']('.entry-content-textarea')['focus']();}),document[_0x412b05(0x64f)](_0x412b05(0x1139))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x375a38=_0x412b05;if(!_0x5c18e3)return;const _0x361629=await _0x4e1bbf['presets'][_0x375a38(0x11fc)](_0x5c18e3);if(!_0x361629)return;const _0x5a53b6=document[_0x375a38(0x64f)]('preset-name-input')['value']['trim']();if(!_0x5a53b6){alert(_0x375a38(0x532));return;}_0x361629['name']=_0x5a53b6,_0x361629[_0x375a38(0xcd3)]=parseInt(document[_0x375a38(0x64f)](_0x375a38(0x493))['value'])||null;const _0x1b32b0=document[_0x375a38(0x64f)](_0x375a38(0xe2)),_0xe2fc59=_0x1b32b0['querySelectorAll'](_0x375a38(0x1363)),_0x47348a=[];_0xe2fc59[_0x375a38(0x103)](_0x304a2e=>{const _0x5b7a25=_0x375a38,_0x80d618=_0x304a2e[_0x5b7a25(0x49c)](_0x5b7a25(0x2ba))[_0x5b7a25(0xbed)][_0x5b7a25(0x43a)]();_0x80d618&&_0x47348a['push']({'comment':_0x304a2e[_0x5b7a25(0x49c)]('.entry-comment-input')['value'][_0x5b7a25(0x43a)](),'keys':(_0x304a2e[_0x5b7a25(0x49c)](_0x5b7a25(0xa7d))['value']['trim']()||'')[_0x5b7a25(0x108c)](',')[_0x5b7a25(0xb96)](_0x3414b8=>_0x3414b8[_0x5b7a25(0x43a)]())[_0x5b7a25(0x156)](Boolean),'content':_0x80d618,'enabled':_0x304a2e['querySelector'](_0x5b7a25(0xd60))[_0x5b7a25(0xf1d)]});}),_0x361629['content']=_0x47348a,await _0x4e1bbf['presets'][_0x375a38(0x4fa)](_0x361629),_0x5c18e3=null,_0xddd8ae(_0x375a38(0x131)),await _0x1b0f29();}),document[_0x412b05(0x64f)](_0x412b05(0xf08))[_0x412b05(0xf72)]('click',()=>{const _0x18926a=_0x412b05;document[_0x18926a(0x64f)](_0x18926a(0x10dd))['click']();}),document[_0x412b05(0x64f)]('import-preset-input')[_0x412b05(0xf72)](_0x412b05(0x834),_0x1ef119),document['getElementById'](_0x412b05(0x123c))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x12c8cf),document[_0x412b05(0x64f)](_0x412b05(0x808))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x513936),document['getElementById'](_0x412b05(0x687))['addEventListener'](_0x412b05(0x1080),()=>{const _0x55ddba=_0x412b05;document[_0x55ddba(0x64f)]('data-clear-wizard-modal')['classList'][_0x55ddba(0x1275)](_0x55ddba(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0xe95))['addEventListener'](_0x412b05(0x1080),_0x3a5e7a),document['getElementById'](_0x412b05(0xf8))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x421fa5),document[_0x412b05(0x64f)](_0x412b05(0x12f3))[_0x412b05(0xf72)]('click',()=>{const _0x17fce1=_0x412b05;document[_0x17fce1(0x64f)](_0x17fce1(0xdec))[_0x17fce1(0x418)][_0x17fce1(0x1275)](_0x17fce1(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x34c))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4a8ed1),document[_0x412b05(0x64f)](_0x412b05(0xdec))['addEventListener']('click',_0x4cc676=>{const _0x55f1d1=_0x412b05,_0x211385=_0x4cc676['target'][_0x55f1d1(0x2fc)]('.clear-posts-item');_0x211385&&(_0x4cc676['stopPropagation'](),_0x211385[_0x55f1d1(0x418)][_0x55f1d1(0x5cf)](_0x55f1d1(0xbe6)));}),document['getElementById']('data-clear-wizard-modal')[_0x412b05(0xf72)](_0x412b05(0x834),_0x3a3ab4=>{const _0x17b490=_0x412b05;if(_0x3a3ab4[_0x17b490(0xf5b)]['id']===_0x17b490(0xd99)){const _0x5f0395=_0x3a3ab4[_0x17b490(0xf5b)]['checked'];document['querySelectorAll'](_0x17b490(0xf5f))[_0x17b490(0x103)](_0x461a7e=>{const _0x4fed64=_0x17b490;_0x461a7e[_0x4fed64(0x418)]['toggle'](_0x4fed64(0xbe6),_0x5f0395);});}else{if(_0x3a3ab4['target']['id']===_0x17b490(0x116)){const _0x194d4d=_0x3a3ab4[_0x17b490(0xf5b)][_0x17b490(0xf1d)];document[_0x17b490(0x233)](_0x17b490(0x1274))[_0x17b490(0x103)](_0x35093c=>{const _0x5a0872=_0x17b490;_0x35093c['classList']['toggle'](_0x5a0872(0xbe6),_0x194d4d);});}}}),document[_0x412b05(0x64f)](_0x412b05(0x993))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xa3284),document['getElementById']('copy-message-btn')[_0x412b05(0xf72)]('click',_0xedb5e6),document[_0x412b05(0x64f)](_0x412b05(0xd7c))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x1e21e3),document['getElementById'](_0x412b05(0x614))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3f3575=_0x412b05;_0x5983f6(_0x3f3575(0x476));}),document['getElementById']('add-npc-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x228ec3(null)),document[_0x412b05(0x64f)]('save-npc-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x19887e),document[_0x412b05(0x64f)]('cancel-npc-editor-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x24a005=_0x412b05;document['getElementById'](_0x24a005(0xa7e))[_0x24a005(0x418)][_0x24a005(0x1275)](_0x24a005(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0x5c1))['addEventListener']('change',_0x257062=>{const _0x4e3686=_0x412b05,_0x56e7b0=_0x257062[_0x4e3686(0xf5b)][_0x4e3686(0x91e)][0x0];if(_0x56e7b0){const _0x234c7d=new FileReader();_0x234c7d[_0x4e3686(0x139d)]=_0x5d7c64=>{const _0x5309e5=_0x4e3686;document['getElementById'](_0x5309e5(0x9bf))[_0x5309e5(0xbe8)]=_0x5d7c64[_0x5309e5(0xf5b)]['result'];},_0x234c7d[_0x4e3686(0xb4)](_0x56e7b0);}}),document['getElementById'](_0x412b05(0x13ce))['addEventListener'](_0x412b05(0x1080),_0x3f7272=>{const _0x43d7ca=_0x412b05;if(_0x3f7272[_0x43d7ca(0xf5b)]['id']==='spectator-reroll-btn')_0x55b560();else _0x3f7272[_0x43d7ca(0xf5b)]['id']===_0x43d7ca(0x521)&&_0xaa49c5();}),_0xb407a5(document[_0x412b05(0x64f)](_0x412b05(0xc80)),()=>{const _0x428645=_0x412b05;_0x1c083c[_0x428645(0x409)]>-0x1&&_0x2d7836(_0x1c083c['currentIndex']);}),document['getElementById'](_0x412b05(0x13b8))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x26367a),document[_0x412b05(0x64f)](_0x412b05(0x826))['addEventListener'](_0x412b05(0x1080),_0x30f901),document[_0x412b05(0x64f)](_0x412b05(0x799))[_0x412b05(0xf72)]('click',()=>{const _0x398d2f=_0x412b05;document['getElementById'](_0x398d2f(0xdfc))['classList'][_0x398d2f(0x1275)]('visible');}),document[_0x412b05(0x64f)](_0x412b05(0x60f))[_0x412b05(0xf72)]('input',_0x27424b=>{const _0x14cdea=_0x412b05,_0x29dbad=_0x27424b[_0x14cdea(0xf5b)][_0x14cdea(0xbed)]['toLowerCase'](),_0x254bb1=document[_0x14cdea(0x64f)](_0x14cdea(0x514));for(const _0x4faefa of _0x254bb1[_0x14cdea(0x590)]){const _0x417ebd=_0x4faefa[_0x14cdea(0xee5)]['toLowerCase']();_0x417ebd['includes'](_0x29dbad)?_0x4faefa[_0x14cdea(0x731)][_0x14cdea(0x130)]='':_0x4faefa[_0x14cdea(0x731)][_0x14cdea(0x130)]=_0x14cdea(0x1209);}}),window[_0x412b05(0x1d7)]=_0x24016a,document[_0x412b05(0x64f)]('werewolf-game-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x24016a(_0x412b05(0xa40))),document[_0x412b05(0x64f)](_0x412b05(0xcea))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x32558c=_0x412b05;document[_0x32558c(0x64f)](_0x32558c(0x85b))[_0x32558c(0x418)][_0x32558c(0x1275)](_0x32558c(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0xf80))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2a8669),document['getElementById']('werewolf-role-confirm-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5f5558=_0x412b05;document[_0x5f5558(0x64f)](_0x5f5558(0xf09))[_0x5f5558(0x418)][_0x5f5558(0x1275)](_0x5f5558(0x40a)),_0x3cd250();}),document[_0x412b05(0x64f)](_0x412b05(0xf3c))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x210f38=_0x412b05,_0x24775c=await _0x54149f(_0x210f38(0x7be),_0x210f38(0x621),{'confirmButtonClass':_0x210f38(0xeed)});_0x24775c&&(_0x1d3b86[_0x210f38(0xb30)]=![],_0xddd8ae(_0x1d3b86[_0x210f38(0x367)]?'chat-interface-screen':_0x210f38(0xd89)));}),document[_0x412b05(0x64f)](_0x412b05(0xfce))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5f0a8f=_0x412b05;document[_0x5f0a8f(0x64f)](_0x5f0a8f(0xf03))[_0x5f0a8f(0x418)][_0x5f0a8f(0x1275)](_0x5f0a8f(0x40a)),_0xddd8ae(_0x1d3b86['chatId']?_0x5f0a8f(0xbb6):_0x5f0a8f(0xd89));}),document[_0x412b05(0x64f)](_0x412b05(0x26d))['addEventListener']('click',()=>{const _0x476389=_0x412b05;document[_0x476389(0x64f)](_0x476389(0x314))['classList'][_0x476389(0x1275)](_0x476389(0x40a));}),document[_0x412b05(0x64f)](_0x412b05(0xcea))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x2db828=_0x412b05;document[_0x2db828(0x64f)]('werewolf-lobby-modal')[_0x2db828(0x418)][_0x2db828(0x1275)](_0x2db828(0x40a));}),document[_0x412b05(0x64f)]('werewolf-retry-btn')[_0x412b05(0xf72)]('click',_0x3bd139),document['getElementById'](_0x412b05(0xa43))['addEventListener']('click',_0x54429a),document['getElementById'](_0x412b05(0xad8))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2a38e0),document[_0x412b05(0x64f)](_0x412b05(0xb85))[_0x412b05(0xf72)]('click',_0x202980),document['getElementById']('cancel-delete-world-books-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x453a83=_0x412b05;document['getElementById'](_0x453a83(0x18a))['classList'][_0x453a83(0x1275)]('visible');}),document['getElementById'](_0x412b05(0xc6e))['addEventListener'](_0x412b05(0x1080),_0x85ed18),document['getElementById'](_0x412b05(0x18a))[_0x412b05(0xf72)]('click',_0x827e84=>{const _0x29f4b1=_0x412b05,_0x12e702=_0x827e84[_0x29f4b1(0xf5b)][_0x29f4b1(0x2fc)](_0x29f4b1(0x8a3));_0x12e702&&_0x12e702['classList'][_0x29f4b1(0x5cf)]('selected');if(_0x827e84[_0x29f4b1(0xf5b)]['id']==='select-all-world-books-for-clear'){const _0x248583=_0x827e84['target'][_0x29f4b1(0xf1d)];document[_0x29f4b1(0x233)](_0x29f4b1(0x274))[_0x29f4b1(0x103)](_0x2de64f=>{_0x2de64f['classList']['toggle']('selected',_0x248583);});}}),document['getElementById'](_0x412b05(0xb6b))[_0x412b05(0xf72)](_0x412b05(0x62b),()=>{_0x8ea9d0(![]);}),document[_0x412b05(0x64f)](_0x412b05(0x1013))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x2e4f7e=>{const _0x1707d0=_0x412b05;if(_0x2e4f7e[_0x1707d0(0xf5b)]['classList'][_0x1707d0(0xef6)](_0x1707d0(0x10c8))){const _0x4a7eb4=_0x2e4f7e[_0x1707d0(0xf5b)][_0x1707d0(0x12e1)][_0x1707d0(0xcd3)],_0x1e7294=_0x4a7eb4!=='all'&&_0x4a7eb4!=='uncategorized'?parseInt(_0x4a7eb4):_0x4a7eb4;document['getElementById'](_0x1707d0(0xb6b))[_0x1707d0(0xbed)]='',_0x3defe2(_0x1e7294);}});const _0x31dca8=document[_0x412b05(0x64f)](_0x412b05(0x207));_0x31dca8['addEventListener'](_0x412b05(0x11e0),()=>{const _0x4d096d=_0x412b05;if(_0x31dca8['scrollTop']<0x1&&!_0x267436){const _0x38d61e=_0x3e7a1b[_0x4d096d(0x999)][_0x3e7a1b[_0x4d096d(0x777)]]?.[_0x4d096d(0x830)][_0x4d096d(0x40f)]||0x0;_0x38d61e>_0x10081e&&_0x1696d2();}});const _0x44663d=document[_0x412b05(0x64f)]('thoughts-history-list');_0x44663d[_0x412b05(0xf72)](_0x412b05(0x11e0),()=>{const _0x25b8e3=_0x412b05,{scrollTop:_0x50021e,scrollHeight:_0x40ae42,clientHeight:_0x48ae06}=_0x44663d;if(_0x40ae42-_0x50021e<=_0x48ae06+0x32&&!_0x3ca822){const _0x113d47=_0x3e7a1b[_0x25b8e3(0x999)][_0x3e7a1b[_0x25b8e3(0x777)]]?.[_0x25b8e3(0x7ea)][_0x25b8e3(0x40f)]||0x0;_0x113d47>_0x502e19&&_0x2b08a1();}});const _0x12ff21=document[_0x412b05(0x49c)](_0x412b05(0xa57));_0x12ff21[_0x412b05(0xf72)](_0x412b05(0x11e0),()=>{const {scrollTop:_0x4192a5,scrollHeight:_0x47b771,clientHeight:_0x188ace}=_0x12ff21;_0x47b771-_0x4192a5<=_0x188ace+0x64&&!_0x3a7ca4&&(_0x10d3d6['length']>_0x2bcd5c&&_0xc395());});const _0x15d5a3=document[_0x412b05(0x64f)](_0x412b05(0xcee));_0x15d5a3['addEventListener'](_0x412b05(0x11e0),()=>{const _0x435b49=_0x412b05,{scrollTop:_0x126f48,scrollHeight:_0xab9f88,clientHeight:_0x270b6a}=_0x15d5a3;_0xab9f88-_0x126f48<=_0x270b6a+0x64&&!_0x4614b0&&(_0x15f3ec[_0x435b49(0x40f)]>_0x544cb0&&_0x36404a());}),document[_0x412b05(0x64f)](_0x412b05(0x761))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x47d29c);const _0x1573e0=document[_0x412b05(0x64f)](_0x412b05(0x12bd));_0x5acbeb(_0x1573e0,_0x1573e0),document[_0x412b05(0x64f)](_0x412b05(0x6b))[_0x412b05(0xf72)](_0x412b05(0x1080),_0xd3a24a),document[_0x412b05(0x64f)]('open-reading-library-btn')['addEventListener'](_0x412b05(0x1080),_0x42d773),document[_0x412b05(0x64f)]('next-page-btn')[_0x412b05(0xf72)]('click',_0x338bcc),document[_0x412b05(0x64f)]('prev-page-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x216da6),document[_0x412b05(0x64f)](_0x412b05(0x7d2))[_0x412b05(0xf72)](_0x412b05(0x834),_0x23dd68),document[_0x412b05(0x64f)](_0x412b05(0xbb2))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x30cf74),document['getElementById']('reading-restore-btn')['addEventListener']('click',_0x1d3f0d),_0x5acbeb(document[_0x412b05(0x64f)](_0x412b05(0x44b)),document[_0x412b05(0x49c)](_0x412b05(0x541))),document[_0x412b05(0x64f)](_0x412b05(0x22a))[_0x412b05(0xf72)]('click',_0x42d773),document[_0x412b05(0x64f)](_0x412b05(0x10c5))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x47bcdd=_0x412b05;document[_0x47bcdd(0x64f)](_0x47bcdd(0xce0))['classList'][_0x47bcdd(0x1275)]('visible');}),document['getElementById']('import-new-book-btn-header')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x57c829),document[_0x412b05(0x64f)](_0x412b05(0x72e))[_0x412b05(0xf72)]('click',_0x5c085a=>{const _0x230eb1=_0x412b05,_0x5387e8=_0x5c085a[_0x230eb1(0xf5b)];if(_0x5387e8[_0x230eb1(0x418)]['contains']('group-name')){const _0x33fcb7=parseInt(_0x5387e8[_0x230eb1(0x12e1)][_0x230eb1(0xa06)]);_0x2d8a20(_0x33fcb7);}else{if(_0x5387e8[_0x230eb1(0x418)][_0x230eb1(0xef6)](_0x230eb1(0xfb1))){const _0x20aae1=parseInt(_0x5387e8[_0x230eb1(0x12e1)][_0x230eb1(0xa06)]);_0xa6e81d(_0x20aae1);}}}),document['getElementById']('page-indicator')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x5e24ed),document['getElementById'](_0x412b05(0xf8c))[_0x412b05(0xf72)]('input',_0x2a0fc4=>{const _0x20d6e3=_0x412b05;_0x4d5573(_0x2a0fc4[_0x20d6e3(0xf5b)][_0x20d6e3(0xbed)]);});const _0xd2874b=_0x189dd1(_0x14ebcc,0x12c);document[_0x412b05(0x64f)]('reading-content')[_0x412b05(0xf72)](_0x412b05(0x11e0),_0xd2874b),document['getElementById'](_0x412b05(0x12ff))[_0x412b05(0xf72)](_0x412b05(0x62b),_0x255cd8=>{const _0x60f63c=_0x412b05;document[_0x60f63c(0x64f)](_0x60f63c(0x2cc))['textContent']=_0x255cd8[_0x60f63c(0xf5b)]['value'];});const _0x3e1847=document['getElementById'](_0x412b05(0x476));_0x3e1847[_0x412b05(0xf72)](_0x412b05(0x11e0),()=>{const {scrollTop:_0x546c33,scrollHeight:_0x40cbe3,clientHeight:_0x242304}=_0x3e1847;_0x40cbe3-_0x546c33<=_0x242304+0x96&&!_0x522181&&_0x1c672d();}),document[_0x412b05(0x64f)](_0x412b05(0x5a3))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x4c2a55),document['getElementById'](_0x412b05(0xee))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x490429=_0x412b05;document['getElementById']('product-category-manager-modal')['classList']['remove'](_0x490429(0x40a)),_0x309cfe(_0x500637);}),document[_0x412b05(0x64f)]('add-new-product-category-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x126992),document[_0x412b05(0x64f)](_0x412b05(0x16a))[_0x412b05(0xf72)]('click',_0x2f55d5=>{const _0x260c5e=_0x412b05;_0x2f55d5[_0x260c5e(0xf5b)][_0x260c5e(0x418)][_0x260c5e(0xef6)](_0x260c5e(0xfb1))&&_0x5d28ff(parseInt(_0x2f55d5['target'][_0x260c5e(0x12e1)]['id']));}),document[_0x412b05(0x64f)](_0x412b05(0x92f))['addEventListener'](_0x412b05(0x1080),()=>_0x2a1e5c()),document['getElementById'](_0x412b05(0xe3b))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5d734f=_0x412b05;document[_0x5d734f(0x64f)](_0x5d734f(0x2bd))[_0x5d734f(0x418)][_0x5d734f(0x1275)](_0x5d734f(0x40a));}),document[_0x412b05(0x64f)]('variation-decrease-qty')['addEventListener'](_0x412b05(0x1080),()=>{const _0x5233ba=_0x412b05,_0x290a00=document[_0x5233ba(0x64f)]('variation-quantity-display');let _0x4c2580=parseInt(_0x290a00['textContent']);if(_0x4c2580>0x1)_0x290a00['textContent']=_0x4c2580-0x1;}),document['getElementById'](_0x412b05(0x3bd))['addEventListener'](_0x412b05(0x1080),()=>{const _0xae014=_0x412b05,_0x2ab42a=document[_0xae014(0x64f)](_0xae014(0xb07));_0x2ab42a[_0xae014(0xee5)]=parseInt(_0x2ab42a['textContent'])+0x1;}),document[_0x412b05(0x64f)](_0x412b05(0xfdc))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x3ff5fa=>{const _0x2405f6=_0x412b05;if(_0x3ff5fa[_0x2405f6(0xf5b)]['classList'][_0x2405f6(0xef6)](_0x2405f6(0xc84))){const _0x6cfc89=_0x3ff5fa['target'][_0x2405f6(0x12e1)][_0x2405f6(0xcd3)]===_0x2405f6(0xfd7)?_0x2405f6(0xfd7):parseInt(_0x3ff5fa[_0x2405f6(0xf5b)]['dataset'][_0x2405f6(0xcd3)]);_0x31800a(_0x6cfc89);}}),document[_0x412b05(0x64f)](_0x412b05(0xf37))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x58a088),document[_0x412b05(0x64f)]('shopping-settings-btn')[_0x412b05(0xf72)]('click',_0x1900b0),document[_0x412b05(0x64f)]('save-shopping-settings-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x183b4d),document[_0x412b05(0x64f)](_0x412b05(0x9db))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x4a71eb=_0x412b05;document[_0x4a71eb(0x64f)](_0x4a71eb(0x89b))[_0x4a71eb(0x418)]['remove'](_0x4a71eb(0x40a));}),document['getElementById'](_0x412b05(0xdb8))['addEventListener'](_0x412b05(0x834),_0x1fc920=>{const _0x432fd0=_0x412b05,_0x2d9ec5=_0x1fc920[_0x432fd0(0xf5b)]['checked'],_0x5593be=document[_0x432fd0(0x233)]('#product-grid\x20.product-item');_0x5593be['forEach'](_0x29a361=>{const _0x1c3046=_0x432fd0,_0x1cff35=parseInt(_0x29a361[_0x1c3046(0x12e1)]['id']);_0x29a361[_0x1c3046(0x418)][_0x1c3046(0x5cf)](_0x1c3046(0xbe6),_0x2d9ec5),_0x2d9ec5?_0x352161[_0x1c3046(0xdda)](_0x1cff35):_0x352161['delete'](_0x1cff35);}),document['getElementById'](_0x432fd0(0xf51))[_0x432fd0(0xee5)]=_0x432fd0(0x83c)+_0x352161[_0x432fd0(0x9dd)]+')';}),document[_0x412b05(0x64f)]('delete-selected-products-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{const _0x467e92=_0x412b05;if(_0x352161[_0x467e92(0x9dd)]===0x0){alert(_0x467e92(0x27f));return;}const _0x856faf=await _0x54149f(_0x467e92(0x13d2),'确定要永久删除选中的\x20'+_0x352161[_0x467e92(0x9dd)]+_0x467e92(0x8b6),{'confirmButtonClass':_0x467e92(0xeed)});_0x856faf&&(await _0x4e1bbf['shoppingProducts'][_0x467e92(0x303)]([..._0x352161]),document[_0x467e92(0x64f)](_0x467e92(0xa52))[_0x467e92(0x1080)](),await _0x515ef1(),await _0x28974b('成功','选中的商品已成功删除。'));}),document[_0x412b05(0x64f)](_0x412b05(0x529))[_0x412b05(0xf72)](_0x412b05(0x834),_0x1f55e8),document['getElementById'](_0x412b05(0xf25))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x37232c),document[_0x412b05(0x64f)](_0x412b05(0xe71))['addEventListener'](_0x412b05(0x1080),_0x2327a9),document[_0x412b05(0x64f)]('novelai-switch')[_0x412b05(0xf72)](_0x412b05(0x834),_0x462813=>{const _0x5b88aa=_0x412b05,_0xa31008=document[_0x5b88aa(0x64f)](_0x5b88aa(0x12b3));_0xa31008[_0x5b88aa(0x731)]['display']=_0x462813[_0x5b88aa(0xf5b)]['checked']?_0x5b88aa(0xb37):_0x5b88aa(0x1209);}),document['getElementById'](_0x412b05(0x35b))[_0x412b05(0xf72)](_0x412b05(0x1080),function(){const _0x483765=_0x412b05,_0x1a420e=document[_0x483765(0x64f)](_0x483765(0x427));_0x1a420e[_0x483765(0xafc)]===_0x483765(0x1378)?(_0x1a420e[_0x483765(0xafc)]=_0x483765(0x673),this['textContent']='😌'):(_0x1a420e['type']=_0x483765(0x1378),this[_0x483765(0xee5)]='🧐');}),document[_0x412b05(0x64f)](_0x412b05(0xcb9))[_0x412b05(0xf72)]('click',()=>{const _0x2447b6=_0x412b05;_0x3fe515(),document[_0x2447b6(0x64f)]('novelai-settings-modal')['style'][_0x2447b6(0x130)]='flex';}),document[_0x412b05(0x64f)](_0x412b05(0x4da))['addEventListener'](_0x412b05(0x834),_0x5331a2=>{const _0x25d18b=_0x412b05,_0x48f4bb=document[_0x25d18b(0x64f)](_0x25d18b(0x1099));_0x5331a2[_0x25d18b(0xf5b)]['value']===_0x25d18b(0xea0)?_0x48f4bb['style'][_0x25d18b(0x130)]=_0x25d18b(0xb37):_0x48f4bb[_0x25d18b(0x731)][_0x25d18b(0x130)]='none';}),document['getElementById'](_0x412b05(0x11b9))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x474d0d=_0x412b05;document[_0x474d0d(0x64f)](_0x474d0d(0xdca))['style']['display']=_0x474d0d(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0xb45))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x557421=_0x412b05;_0x3593e9(),document[_0x557421(0x64f)](_0x557421(0xdca))[_0x557421(0x731)][_0x557421(0x130)]=_0x557421(0x1209),alert('NovelAI设置已保存！');}),document[_0x412b05(0x64f)]('reset-nai-settings-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x288cb8=_0x412b05;confirm(_0x288cb8(0x407))&&_0x34a2e3();}),document[_0x412b05(0x64f)]('novelai-test-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x51fa58=_0x412b05,_0x46bd9d=document[_0x51fa58(0x64f)](_0x51fa58(0x427))[_0x51fa58(0xbed)]['trim']();if(!_0x46bd9d){alert(_0x51fa58(0x960));return;}document[_0x51fa58(0x64f)](_0x51fa58(0x4f2))[_0x51fa58(0x731)][_0x51fa58(0x130)]='flex',document['getElementById'](_0x51fa58(0x1036))['style'][_0x51fa58(0x130)]=_0x51fa58(0x1209),document['getElementById']('nai-test-error')['style'][_0x51fa58(0x130)]=_0x51fa58(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0xac9))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x13d3ff=_0x412b05;document[_0x13d3ff(0x64f)](_0x13d3ff(0x4f2))[_0x13d3ff(0x731)][_0x13d3ff(0x130)]=_0x13d3ff(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0xb00))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x130b5b=_0x412b05;document[_0x130b5b(0x64f)](_0x130b5b(0x4f2))[_0x130b5b(0x731)]['display']=_0x130b5b(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0x12e6))[_0x412b05(0xf72)](_0x412b05(0x1080),async()=>{await _0x13d0f6();}),document['getElementById'](_0x412b05(0x513))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3c7480=_0x412b05,_0x15810b=document[_0x3c7480(0x64f)](_0x3c7480(0x10c2)),_0x10e465=document[_0x3c7480(0x124e)]('a');_0x10e465[_0x3c7480(0x1210)]=_0x15810b[_0x3c7480(0xbe8)],_0x10e465[_0x3c7480(0x1134)]=_0x3c7480(0xc5e)+Date[_0x3c7480(0x2b5)]()+_0x3c7480(0xcc4),_0x10e465[_0x3c7480(0x1080)]();}),document[_0x412b05(0x64f)](_0x412b05(0xefc))[_0x412b05(0xf72)]('click',()=>{const _0x13e000=_0x412b05;if(!_0x3e7a1b['activeChatId'])return;const _0x313ce8=_0x3e7a1b['chats'][_0x3e7a1b[_0x13e000(0x777)]],_0x2f36c6=_0x313ce8[_0x13e000(0xcb3)]['naiSettings']||{'promptSource':_0x13e000(0x905),'characterPositivePrompt':'','characterNegativePrompt':''};document[_0x13e000(0x64f)](_0x13e000(0x13bd))[_0x13e000(0xbed)]=_0x2f36c6[_0x13e000(0x1bc)]||'',document[_0x13e000(0x64f)](_0x13e000(0xaba))[_0x13e000(0xbed)]=_0x2f36c6['characterNegativePrompt']||'',document[_0x13e000(0x64f)](_0x13e000(0xdee))['style']['display']=_0x13e000(0x1026);}),document[_0x412b05(0x64f)](_0x412b05(0x927))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x5b3ec1=_0x412b05;document[_0x5b3ec1(0x64f)]('character-nai-prompts-modal')[_0x5b3ec1(0x731)][_0x5b3ec1(0x130)]=_0x5b3ec1(0x1209);}),document[_0x412b05(0x64f)](_0x412b05(0x139a))[_0x412b05(0xf72)]('click',async()=>{const _0x4a9bb3=_0x412b05;if(!_0x3e7a1b['activeChatId'])return;const _0xb7647c=_0x3e7a1b[_0x4a9bb3(0x999)][_0x3e7a1b[_0x4a9bb3(0x777)]];!_0xb7647c[_0x4a9bb3(0xcb3)][_0x4a9bb3(0x765)]&&(_0xb7647c[_0x4a9bb3(0xcb3)][_0x4a9bb3(0x765)]={'promptSource':_0x4a9bb3(0x905)}),_0xb7647c[_0x4a9bb3(0xcb3)][_0x4a9bb3(0x765)][_0x4a9bb3(0x1bc)]=document[_0x4a9bb3(0x64f)](_0x4a9bb3(0x13bd))[_0x4a9bb3(0xbed)][_0x4a9bb3(0x43a)](),_0xb7647c['settings'][_0x4a9bb3(0x765)][_0x4a9bb3(0xbf5)]=document[_0x4a9bb3(0x64f)](_0x4a9bb3(0xaba))[_0x4a9bb3(0xbed)][_0x4a9bb3(0x43a)](),console['log'](_0x4a9bb3(0x809)),console[_0x4a9bb3(0x1081)](_0x4a9bb3(0xf8f),_0xb7647c[_0x4a9bb3(0xcb3)]['naiSettings'][_0x4a9bb3(0x1bc)]),console[_0x4a9bb3(0x1081)](_0x4a9bb3(0x4c2),_0xb7647c[_0x4a9bb3(0xcb3)][_0x4a9bb3(0x765)][_0x4a9bb3(0xbf5)]),console['log']('\x20\x20\x20promptSource:',_0xb7647c['settings'][_0x4a9bb3(0x765)]['promptSource']),await _0x4e1bbf[_0x4a9bb3(0x999)][_0x4a9bb3(0x4fa)](_0xb7647c),document['getElementById']('character-nai-prompts-modal')[_0x4a9bb3(0x731)][_0x4a9bb3(0x130)]=_0x4a9bb3(0x1209),alert(_0x4a9bb3(0x57b));}),document[_0x412b05(0x64f)]('reset-character-nai-prompts-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3ae3d8=_0x412b05;confirm(_0x3ae3d8(0xb57))&&(document[_0x3ae3d8(0x64f)](_0x3ae3d8(0x13bd))['value']='',document[_0x3ae3d8(0x64f)](_0x3ae3d8(0xaba))['value']='');}),document[_0x412b05(0x64f)](_0x412b05(0x384))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0xb561dd=_0x412b05;if(!_0x3e7a1b[_0xb561dd(0x777)])return;const _0x11d213=_0x3e7a1b[_0xb561dd(0x999)][_0x3e7a1b[_0xb561dd(0x777)]],_0x547d08=_0x11d213[_0xb561dd(0xcb3)][_0xb561dd(0x765)]||{'promptSource':'system','characterPositivePrompt':'','characterNegativePrompt':''};document[_0xb561dd(0x64f)](_0xb561dd(0x13bd))[_0xb561dd(0xbed)]=_0x547d08[_0xb561dd(0x1bc)]||'',document['getElementById'](_0xb561dd(0xaba))['value']=_0x547d08['characterNegativePrompt']||'',document[_0xb561dd(0x64f)](_0xb561dd(0xdee))['style'][_0xb561dd(0x130)]=_0xb561dd(0x1026);}),document[_0x412b05(0x64f)](_0x412b05(0x1344))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x135c1f),document['getElementById'](_0x412b05(0xbcb))[_0x412b05(0xf72)](_0x412b05(0x834),_0x3ad3b7),document['getElementById'](_0x412b05(0x12eb))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x502f64),document[_0x412b05(0x64f)](_0x412b05(0xe8d))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x36fea9),document[_0x412b05(0x64f)]('char-wallet-back-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3cf307=_0x412b05;_0xdfc697(_0x3cf307(0x12f9));}),document[_0x412b05(0x64f)]('sticker-binding-chat-list')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x234cf3=>{const _0x58e988=_0x412b05,_0x57693a=_0x234cf3[_0x58e988(0xf5b)][_0x58e988(0x2fc)]('.contact-picker-item');if(_0x57693a){const _0x106971=_0x57693a[_0x58e988(0x49c)](_0x58e988(0x22b));_0x106971&&_0x234cf3['target']!==_0x106971&&(_0x106971['checked']=!_0x106971['checked']);}});const _0x3d0e74=document[_0x412b05(0x64f)](_0x412b05(0x1013));_0xb407a5(_0x3d0e74,_0x23041c=>{const _0x4f9700=_0x412b05,_0x1f5fd4=_0x23041c[_0x4f9700(0xf5b)][_0x4f9700(0x2fc)](_0x4f9700(0xee3));if(_0x1f5fd4){_0x23041c[_0x4f9700(0x8d1)]();const _0x31ddfe=_0x1f5fd4[_0x4f9700(0x12e1)]['categoryId'];if(_0x31ddfe===_0x4f9700(0xfd7)){_0x28974b('提示','“全部”分类无法被绑定。');return;}const _0x4ece2f=_0x31ddfe==='uncategorized'?_0x4f9700(0xf60):parseInt(_0x31ddfe);_0x5cde27(_0x4ece2f);}}),document[_0x412b05(0x64f)](_0x412b05(0x934))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x11db7f),document['getElementById'](_0x412b05(0x169))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>{const _0x3ec07d=_0x412b05;document['getElementById'](_0x3ec07d(0x7d0))[_0x3ec07d(0x418)][_0x3ec07d(0x1275)](_0x3ec07d(0x40a));}),document[_0x412b05(0x64f)]('manage-nai-gallery-btn')[_0x412b05(0xf72)](_0x412b05(0x1080),_0x34cd5c),document[_0x412b05(0x64f)](_0x412b05(0xcee))[_0x412b05(0xf72)](_0x412b05(0x1080),_0x538d4b=>{_0x2abc41(_0x538d4b);}),document[_0x412b05(0x64f)](_0x412b05(0x6c0))['addEventListener'](_0x412b05(0x834),_0x1cb9df=>{const _0x373550=_0x412b05,_0x58e598=_0x1cb9df[_0x373550(0xf5b)][_0x373550(0xf1d)];document['querySelectorAll'](_0x373550(0x9b9))[_0x373550(0x103)](_0x34e4c5=>{const _0x27bae0=_0x373550;_0x34e4c5[_0x27bae0(0x418)]['toggle'](_0x27bae0(0xbe6),_0x58e598);const _0x52a8a=_0x34e4c5[_0x27bae0(0x12e1)][_0x27bae0(0xf2f)];_0x58e598?_0x22ae70['add'](_0x52a8a):_0x22ae70[_0x27bae0(0x3aa)](_0x52a8a);}),_0xa2e645();}),document[_0x412b05(0x64f)](_0x412b05(0x555))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x19ced9()),document[_0x412b05(0x64f)](_0x412b05(0x114b))[_0x412b05(0xf72)](_0x412b05(0x1080),()=>_0x412392()),_0xa1a2f9(),_0xddd8ae(_0x412b05(0xd89));}_0x2677fb();});
